.head 0 +  Application Description: Работа с СЕП НБУ (MIK 30-08-2000) vss
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000320100 002C000000020000 0003000000000000 001C020000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D06000000075769 6E646F77730C7370
0080: 6C5F4C6F636B446F 63730D4368696C64 2057696E646F7773 0374626C07436F6C
00A0: 756D6E7305444154 5F41
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533031342E 6170640C5C424152
00E0: 5339385C42494E5C 0C5C424152533938 5C42494E5C000001 01011D513A5C4241
0100: 525339385C4C4942 524152595C424152 533031352E61706C 1D513A5C42415253
0120: 39385C4C49425241 52595C4241525330 31352E646C6C1D51 3A5C424152533938
0140: 5C4C494252415259 5C42415253303135 2E61706300000101 01
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: xsalimg.APL
.head 2 -  File Include: xsalspl.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: DocWis6.apl
.head 2 -  File Include: vtsplit.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Service.apd
.head 2 -  File Include: Xsalcpt.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: hh:mm dd/MM
.head 3 -  Date/Time: hhhh:mm dd/MM
.head 3 -  Date/Time: hhhh:mm dd/MM/
.head 3 -  Date/Time: dd.MM.yyyy hhhh:mm 
.head 3 -  Date/Time: dd.MM.yyyy
.head 3 -  Date/Time: dd/MM/yy
.head 3 -  Date/Time: mm:ss dd/MM/yy
.head 3 -  Date/Time: hhhh:mm dd/MM/yy
.head 2 +  External Functions
.head 3 +  Library name: IctBob.Dll
.head 4 +  Function: llopen
.head 5 -  Description: открытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: llcreat
.head 5 -  Description: создание файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: llclose
.head 5 -  Description: закрытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 4 +  Function: llread
.head 5 -  Description: чтение файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: UINT
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  String: LPVOID
.head 6 -  Number: UINT
.head 4 +  Function: llwrite
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: UINT
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  String: LPCSTR
.head 6 -  Number: UINT
.head 4 +  Function: lllseek
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: LONG
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  Number: LONG
.head 6 -  Number: INT
.head 4 +  Function: llstr2str
.head 5 -  Description: преобразование строки HEXtoBIN
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 6 -  Receive String: LPVOID
.head 6 -  Number: ULONG
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: MSG_QUIT_Q_R_U_Sure = 'Вы действительно хотите сквитовать выбраный файл СЭП? '
.head 4 -  String: MSG_DEL_Q_R_U_Sure = 'Вы действительно хотите удалить выбраные записи?'
.head 4 -  String: MSG_DEL_Q_R_U_SureEx = 'Вы действительно хотите удалить выбраный файл СЭП? '
.head 4 -  String: MTR_LOGFILE_OK='mentor_o.'
.head 4 -  String: MTR_LOGFILE_BAD='mentor_b.'
.head 4 -  ! !
.head 4 -  Number: MTR_LOG_Accept=1
.head 4 -  Number: MTR_LOG_Reject=0
.head 4 -  !
.head 4 -  String: ApdNum   =  '14'
.head 4 -  String: ApdVer   =  '126'
.head 4 -  ! История изменений:
.head 4 -  ! 01 12-12-01  MIK     Положил начало контролю версий
.head 4 -  ! 02 12-12-01  STA     Просмот лимитов (для начальников)
.head 4 -  ! 03 17-12-01  MOM     Лочит tzapros для "підтвердження висновків"
.head 4 -  ! 04 18-12-01  MIK     Сортировка и суммирование в "управлении К/С"
.head 4 -  ! 05 20-12-01  MIK     В "приеме висновків" ошибочно показывало блокированные документы
.head 4 -  ! 06 11-01-02  MIK+STA Транз пл по 3 мод разрешено до выяснения.
.head 4 -  ! 07 17-01-02  MIK     Переставил NLSALT в Разборе 902
.head 4 -  ! 08 23-01-02  MIK     В просмотре файлов СЭП не было видно >100 файлов
.head 4 -  ! 09 06-03-02  MIK     управляем видом помещения в К2 из параметров (список б/c)
.head 4 -  ! 10 06-03-02  MIK     вместе с удалением незакв $B удаляем и бух модель
.head 4 -  ! 11 18-03-02  MIK     "Ресурс" в управлении К/C, "Ручное формирование файлов СЄП"
                       (для 3 мод тоже)
.head 4 -  ! 12 26-03-02  MIK     Внешний фильтр в Управлении КС (вместо списка блокировок)
.head 4 -  ! 13 27-03-02  MIK     Перенесли Разбор картотеки запросов из procapi
.head 4 -  ! 14 05-04-02  ANNY    Добавлен идентификатор того, кто сделал возврат док-та отправителю
.head 4 -  ! 15 09-04-02  MIK     Раскрасил признак закрытого счета в Разборе 902
.head 4 -  ! 16 16-04-02  MIK     Не проставлялось ОКПО при зачислении с "невыясненных"
.head 4 -  ! 17 25-04-02  MIK     Разбор картотеки запросов изменил иконки
.head 4 -  ! 18 08-05-02  MIK     Исправил внесенную ошибку с датой в разборе с невыясненных
.head 4 -  ! 19 13-06-02  MIK     Закрыл "Ручное формирование файлов СЄП"
                       для локальных банковских дат
.head 4 -  ! 20 24-06-02  MIK     Предупреждение при переподписании файла $A другим ключем
.head 4 -  ! 21 13-12-02  MIK     Еще раз закрыл "Ручное формирование файлов СЄП"
                       для лок банковских дат
.head 4 -  ! 22 11-03-03  MIK     Добавил параметр РЕФ для бизнас-правил и ссылку на исх докум
                       для 902
.head 4 -  ! 23 20-05-03  MIK     В сумму заблок документов берем только платежи DK=(0,1)
.head 4 -  ! 24 13-06-03  MIK     В разборе невыясненных насильно платим по факту 901
                       в реж "зачислить"
.head 4 -  ! 25 20-06-03  MIK     Сделал возврат непринятых СЕП в BMRS для АВАЛя
.head 4 -  ! 26 07-07-03  MIK     Сделал "запити по реквізитах документа"
                       (в "Деб запросах" и в "Разборе невыясненных")
.head 4 -  ! 27 20-08-03  MIK     Доработал "запити по реквізитах документа" по замечаниям НБУ
.head 4 -  ! 28 26-08-03  MIK     Еще раз ужесточил контроль "запитів по реквізитах документа"
.head 4 -  ! 29 09-09-03  MIK     Сделал "звездочки" и отчеты в "запитах"ю исправил некот ошибки
.head 4 -  ! 30 11-09-03  MIK     Исправил ошибку в стороне А в ответах на запросы
.head 4 -  ! 31 29-12-03  MIK     Добавил парамеры для возврата непринятых СЕП в BMRS для АВАЛя
.head 4 -  ! 32 29-12-03  MIK     Сделал показ даты ввода докуиента в Упр.КС по параметру UPR_PDAT
.head 4 -  ! 33 03-03-04  MIK     Закрыл кнопку "Удовлетворить запрос" при strPar01='1'
.head 4 -  ! 34 16-06-04  MIK     1) Переброска запросов между исполнителями.
                       2) Причина помещения на 902 - в operw
.head 4 -  ! 35 25-08-04  MIK     Сопроводка по доходным счетам при удовлетворении запросов в КАЗНАЧ
.head 4 -  ! 36 13-10-04  MIK     Сделал возможность дробления суммы невыясненных
.head 4 -  ! 37 17-12-04  MIK     Закрыл кнопку по формированию запросов допреквизитов
                       для внутр платежей по модели 3
.head 4 -  ! 38 18-01-05  MIK     Исправил заполнение поля datp в запросах на уточнение реквизитов
.head 4 -  ! 39 04-02-05  MIK     Добавил "пазлы" в разбор невыясненных, убрал ЛОК документа,
                       если просто вышли
.head 4 -  ! 40 07-02-05  MIK     Добавил дату-время помещения на невыясненные
.head 4 -  ! 41 09-02-05  MIK     Упорядочил открытие кнопки помещения на невыясненные для своих док
.head 4 -  ! 42 09-03-05  MIK     Исправил внесенную ошибку подсчета суммы заблокированных документов
.head 4 -  ! 43 22-03-05  MIK     При закрытой кнопке для невыясненных помещала на невыясн
                       в режиме ВСЕ ПО КОДУ
.head 4 -  ! 44 05-03-05  MIK     Сделел внешний фильтр для "разбор невыясненных"
.head 4 -  ! 45 28-04-05  MIK     Исправил проверку даты документа (TRUNC)
                       в разборе запросов на уточнение реквизитов
.head 4 -  ! 46 29-04-05  MIK     Изменил удаление из REF_LST, чтоб использовался индекс
.head 4 -  ! 47 15-06-05  MIK     Исправил ошибку colID_NAME is defined more then one form
                       в dlg_Reason
.head 4 -  ! 48 04-07-05  MIK     Сделал возможность повторной отправки
                       запросов и ответов на уточнение допреквизитов
.head 4 -  ! 49 26-07-05  MIK     Добавил параметр для кода транзакции
                       для удовлетворения дебетовых запросов
                       Sel014(hWndMDI,4,1,'0,XXX','mfoa<>:TZ.sBankMfo AND tzapros.isp=:TZ.nIsp')
.head 4 -  ! 50 29-07-05  Mom     Убрал формирование квитанций для ATBU на принятие ВИСНОВКОВ в
                       картотеку, поступивших по системе "КЛИЕНТ КАЗНАЧЕЙСТВА ->
                       КАЗНАЧЕЙСТВО" (чтобы ATBU не "заваливалась")
.head 4 -  ! 51 16-08-05  MIK     При зачислении с невыясненных чтоб не портить назначение платежа 
                       перенес реквизиты плательщика в допреквизит
.head 4 -  ! 52 07-10-05  MIK     Сделал итоги по файлам СЕП, отметку контролера, возврат запросов,
                       просмотр счетов в BMRS
.head 4 -  ! 53 02-11-05  MIK     Исправил неточность с параметром запрета использования кнопки "удовл Деб Запр"
.head 4 -  ! 54 24-11-05  MIK     При повторной посылке запроса на уточнение добавил слово ПОВТОРНО
.head 4 -  ! 55 24-11-05  MIK     Управление коррсчетом не работало при начальных с БИСами
.head 4 -  ! 56 20-12-05  MIK     Мультивалютный "Разбор невыясненных"
.head 4 -  ! 57 20-12-05  MIK     Для мультивалютной ВПС изменил сортировку валют в "Информации о файлах"
.head 4 -  ! 58 04-02-06  MIK     Исправил ошибку при нажатии "крестика" при выборе причины расформирования
.head 4 -  ! 59 16-02-06  MIK     Исправил внесенную ошибку: Не показывала сумму на невыясненных
.head 4 -  ! 60 05-04-06  MIK     Мультивалютные инф запросы
.head 4 -  ! 61 10-04-06  MIK     В УпрКС исправил ошибку при разблокировке БИС (цепляла прошлые года)
.head 4 -  ! 62 11-04-06  MIK     Терялось поле drec(#C) в разборе невыясненных
.head 4 -  ! 63 06-05-06  MIK     1) Добавил ГлобПараметр OKP902=Y/N; 2) При снятии деб.запросов, ставим визу
.head 4 -  ! 64 10-05-06  MIK     При флаге 'V', разбор невыясненных работает отдельно по каждой валюте
.head 4 -  ! 65 14-06-06  MIK     В "разборе невыясненных" по кнопке "вернуть" лепим БИСы в OPERW
.head 4 -  ! 66 16-06-06  MIK     В "разборе невыясненных" по кнопке "зачислить" ставим NOS_A(для SWIFT) в OPERW
.head 4 -  ! 67 03-08-06  MIK     По просьбе НБУ, в "разборе невыясненных": 
                       "на улицу"-"название клиента", внутри-название счета 3720.
.head 4 -  ! 68 26-09-06  MIK     В ручном формировании файлов исключил документы для ССП.
.head 4 -  ! 69 18-10-06  SERG    В ручном формировании файлов запросы по ARC_RRP, ZAG_B переписаны с учетом новой индексации
		       Выборка Ресурса переписана с исп. представления v_accounts_proc (patchk18.sql)
.head 4 -  ! 70 24-10-06  MIK     Исправил Танину выборку nazn из Accounts для АВАЛЯ
.head 4 -  ! 71 27-10-06  MIK     Сделал работу с БИС через поле rec_g в rec_que
.head 4 -  ! 72 30-10-06  MIK     Вилучення незаквитованого файла не чистила TZAPROS
.head 4 -  ! 73 05-12-06  MIK     Убрал удаление из REF_LST, при возврате документа.
.head 4 -  ! 74 11-01-07  MIK     При params(LST92) работает зачисление на отдельные счета по кодам блокировки
.head 4 -  ! 75 16-01-07  NATA    Блокированные документы СЭП: Вернуть отправителю: сначала BACKR, потом put_nos
.head 4 -  ! 76 30-01-07  MIK     Добавил выполнение связанной операции при помещении не невыясненные по коду блк.
.head 4 -  ! 77 22-03-07  MIK     Прибрав хінти з управління К/Р
.head 4 -  ! 78 11-04-07  MIK     В розборі запитів зробив можливість закривати кнопки через переметрі виклику
.head 4 -  ! 79 15-05-07  MIK     При params(NAM902) завжди використовуємо НАЗВУ рахунку нез"ясованих-Y, стандарт-N
.head 4 -  ! 80 16-05-07  MIK     1) Дозволено розбір нез"ясов. 2) Виправив помилку поля dat_a для посланих запитів
.head 4 -  ! 81 17-05-07  MIK     Розширив діагностику при неспівпаданні отриманого запиту на уточнення й документу
.head 4 -  ! 82 19-09-07  MIK     Виправив логіку створення бізнес-правил:"при збоях коректування Bp_rrp - процедура не створюється
.head 4 -  ! 83 06-11-07  MIK     Показувати код блокування в розборі нез"ясованих
.head 4 -  ! 84 08-11-07  MIK     Не працювала "Історія установки лімітів прямим учасникам"
.head 4 -  ! 85 22-11-07  MIK     Для Ощадбанка зробив sos=8 при зарахуванні на нез"ясовані, та новий вибор транзитів
.head 4 -  ! 86 28-11-07  MIK     Для Ощадбанка переробив установку лімітів філіям по Мод3
.head 4 -  ! 87 13-11-07  MIK     Для Ощадбанка виправив вирах. поля ресурс та вибір вал.рах для нез"яс при CLRTRN  
.head 4 -  ! 88 13-01-08  MIK     При поверненні з нез"ясованих з невірним допрекв., він преносився, і давав помилку
.head 4 -  ! 89 01-02-08  MIK     Заложил версию для Finacle - НадраБанк
.head 4 -  ! 90 18-02-08  MIK     Добавил Печать таблицы в Упр.КС и исправил фокус в Невыясненных
.head 4 -  ! 91 11-04-08  MIK     Виправив формат дати в УпрКС та встановив max 2000 рядків 
.head 4 -  ! 92 23-10-08  MIK     В ордер по зарахуванні нез"ясованих поставив уточнене окпо (#!)
.head 4 -  ! 93 12-01-09  MIK     В ордер по зарахуванні нез"ясованих поставив уточнене окпо при уточнениии счета(#+)
.head 4 -  ! 94 21-03-09  MIK     В упрКС зробив монохромну відмітку
.head 4 -  ! 95 21-04-09  MIK     В "Инф про файли СЕП" зробив обробку пля zag_b.k_er
.head 4 -  ! 96 14-05-09  MIK(*ANNY*) Добавив можливість виклику ф-ії призначення платежу при поверненні коштів (params-NAZ902)
.head 4 -  ! 97 06-06-09  MIK     В "Нез"ясовані" розфарбував колонку ОКПО для направильних
.head 4 -  ! 98 19-10-09  MIK     Для БанкМастер замінив виклик процедури sep2bmrs
.head 4 -  ! 99 03-11-09  MIK     В упр КС по правій миші на рах відправника показує назву кліїнта
.head 4 -  ! 100 14-01-10  MIK    В нез"ясованих зробив групове зарахування на альтернативний рах
.head 4 -  ! 101 26-02-10  MIK    В нез"ясованих при поверненні платнику не вказувало код причини в допрекв.
.head 4 -  ! 102 08-02-11  MIK    В нез"ясованих поставив відмітку для док, що лежать >3 днів.
.head 4 -  ! 103 09-03-11  MIK    В нез"ясованих та управлінні КР зробив копіювання допреквізитів 
.head 4 -  ! 104 31-05-11  MIK    В "Управлінні КР" вилучення повідомлень, та групові опреції в "Інформація про файли СЕП"
.head 4 -  ! 105 25-08-11  MIK    В "Управлінні КР" завжди відкрита кнопка "нез"ячован" при params SHW92 
.head 4 -  ! 106 25-08-11  MIK    В Інформація про файли кнгопки вкл/викл через par1, Відм "нез"ячован" робоча дата лежать >3 днів
.head 4 -  ! 107 17-10-11  MIK    Обробка #ф в Підтвердженні висновків з районів
.head 4 -  ! 108 27-10-11  MIK    Переставив спочатку pay_bck, а потім BACKR, щоб ловити причину повернень
.head 4 -  ! 109 02-11-11  MIK    При зарахуванні по Альт. рах. беремо ОКПО альтернативне
.head 4 -  ! 110 05-03-12  MIK    Додав в запити на уточнення рекв Фф
.head 4 -  ! 111 21-05-12  MIK    Додав перенаправлення в SWIFT замість СЕП
.head 4 -  ! 112 30-08-12  MIK    Підправив виклик PAYTT для зарахування на нез"ясовані по списку
.head 4 -  ! 113 24-09-12  MIK    Додав зовнішній фильтр для висновків по казначейству
.head 4 -  ! 114 05-10-12  MIK    Зробив сховану можливість перепідписання документа в ARC_RRP по Ctl-Alt-S
.head 4 -  ! 115 18-10-12  MIK    Тепер використання пакеджа bars_sqnc для НБУ по параметру SQNC=1, решта-без змін
.head 4 -  ! 116 16-11-12  MIK    В упрКС при параметрі TECHPASS завжди запитуємо ТехПароль
.head 4 -  ! 117 21-12-12  MIK    Похінтив упр.кр та розбір запитів, щоб не залежало від статистики 
.head 4 -  ! 118 27-12-12  MIK    Дозволено переформовувати файли $A для otm=2 також
.head 4 -  ! 119 29-12-12  MIK    Не зараховувало достроково по даті валютування при SOS0
.head 4 -  ! 120 10-01-13  MIK    Прибрав хінти бо збивалося на CARTESAN
.head 4 -  ! 121 18-02-13  MIK    По par 'WEB_PAY0'=1 Есть управление оплатой WEB
.head 4 -  ! 122 14-03-13  MIK    Подправил вызов процедуры SetP для управления оплатой WEB
.head 4 -  ! 123 22-03-13  MIK    Відкрив кнопку "переформувати" для otm=2
.head 4 -  ! 124 23-09-14  MIK    В упрКС додав показ тобо по правій миші на рахА
.head 4 -  ! 125 30-12-14  MIK    В інф о файлах додав можливість вилучення $B ВПС для ДКСУ
.head 4 -  ! 126 02-03-15  MIK    При поверненнях з нез"ясованих для 0000000000 переносим серію-номер паспорта
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 4225867403
0000: 3800000019000000 0000000000000000 020000020000000D 010000E0010D0000
0020: 00FF3F1A01BA0001 00FFFF
.enddata
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hWin3
.head 3 -  Window Handle: hWin4
.head 3 -  Window Handle: hWin5
.head 3 -  Window Handle: hWin7
.head 3 -  Window Handle: hWin8
.head 3 -  Window Handle: hWin9
.head 3 -  Window Handle: hWin10
.head 3 -  Window Handle: hWin11
.head 3 -  Window Handle: hWin12
.head 3 -  Number: nFetchRes
.head 3 -  Number: nBackKvit	! Флаг формирования квитанции D при сторнировании документа
.head 3 -  String: strPathD
.head 3 -  ! !
.head 3 -  File Handle: hMtrFile
.head 3 -  ! !
.head 3 -  String: strSql
.head 3 -  String: strValue
.head 3 -  ! !
.head 3 -  Boolean: bRollback
.head 3 -  ! !
.head 3 -  Number: nReasonId
.head 3 -  String: sReason
.head 3 -  Boolean: bApdInited
.head 2 +  Internal Functions
.head 3 +  Function: Sel014	! __exported
.head 4 -  Description: Bars014_Selector
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini014()
.head 5 +  Select Case nMode
.head 6 +  Case 0   ! Ручное формирование файлов СЭП  $A
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0=SalCreateWindow(splSepFiles,hWndParent,nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( splSepFiles )
.head 7 -  Break
.head 6 +  Case 1   ! Управление коррсчетом (новое)
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(spl_LockDocs, hWndParent, nPar, SalStrToNumber(SalStrMidX(strPar01,0,1)),
                            SalStrToNumber(SalStrMidX(strPar01,1,1)), SalStrToNumber(SalStrMidX(strPar01,2,1)),
                            SalStrToNumber(SalStrMidX(strPar01,3,1)), strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(spl_LockDocs)
.head 7 -  Break
.head 6 +  Case 2   ! Разбор невыясненных сумм
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2=SalCreateWindow(splT902,hWndParent,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( splT902 )
.head 7 -  Break
.head 6 +  Case 3   ! Установка лимитов филиалам по модели 1
.head 7 +  ! If not IsWindow(hWin3)
.head 8 -                                                                 Set hWin3=SalCreateWindow( tblSetLimMod1,hWndParent)
.head 7 -  Call SalMessageBox( "Функцію замінено на Sel014(hWndMDI,9,0,'','')", 'Увага', MB_IconHand )
.head 7 +  ! Else
.head 8 -                                                                 Call SalBringWindowToTop ( tblSetLimMod1 )
.head 7 -  Break
.head 6 +  Case 4   ! Картотека запросов из СЭП (приехала с procapi)
.head 7 +  If not IsWindow(hWin4)
.head 8 -  Set hWin4=SalCreateWindow(TZ,hWndParent,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( TZ )
.head 7 -  Break
.head 6 +  Case 5   ! Просмотр/манипулирование файлами СЭП
.head 7 +  If not IsWindow(hWin5)
.head 8 -  Set hWin5=SalCreateWindow(tblFilesSep,hWndParent,nPar,strPar01)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( tblFilesSep )
.head 7 -  Break
.head 6 +  Case 6   ! Редактирование бизнес-правил
.head 7 -  Call SalModalDialog( dlg_Rules, hWndParent )
.head 7 -  Break
.head 6 +  Case 7   ! Верификация ответного провода,
           заблокированного по коду strPar01,
           nPar=0 - по любому исполнителю
           nPar=1 - User = isp счета
.head 7 +  If not IsWindow(hWin7)
.head 8 -  Set hWin7=SalCreateWindow(VRO,hWndParent,nPar,strPar01)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( VRO )
.head 7 -  Break
.head 6 +  Case 8   ! Разбор заявок клиентов в картотеку 2
.head 7 +  If not IsWindow(hWin8)
.head 8 -  Set hWin8 = SalCreateWindow(tblVisnovki, hWndParent,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(tblVisnovki)
.head 7 -  Break
.head 6 +  Case 9   ! Установка лимитов для прямых участников (ANNY - 05.10.2001)
.head 7 +  If not IsWindow(hWin9)
.head 8 -  Set hWin9=SalCreateWindow(tbl_SetLims, hWndParent, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( tbl_SetLims )
.head 7 -  Break
.head 6 +  Case 10  ! История Установки лимитов для одного МФО
.head 7 +  If not IsWindow(hWin10)
.head 8 -  Set hWin10=SalCreateWindow(tbl_SetLimsI, hWndParent, nPar,strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( tbl_SetLimsI )
.head 7 -  Break
.head 6 +  Case 11  ! Документы СЕП с ненаступившей датой валютирования
.head 7 +  If not IsWindow(hWin11)
.head 8 -  Set hWin11=SalCreateWindow(splTDVal,hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( splTDVal )
.head 7 -  Break
.head 6 +  Case 12  ! ИПС
.head 7 +  If not IsWindow(hWin12)
.head 8 -  Set hWin12 = SalCreateWindow(tblIPS, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin12)
.head 7 -  Break
.head 5 -  Return TRUE
.head 3 +  Function: Ini014
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  ! Формировать квитанцию D?
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  Set nBackKvit = SalGetProfileInt(INI_ElektroKlients, 'NOKK_BackKvit', 0, GetIniFileName())
.head 6 -  Call SalGetProfileString(INI_ElektroKlients, 'NOKK_DPath', GetPrnDir(), strPathD, GetIniFileName())
.head 6 -  !
.head 6 -  ! Инициализация LNG-файла
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars014.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Call DocWisInit('frmDoc.')
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: ShowApdVersion
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strText
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strText, 160 )
.head 5 -  Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
.head 5 -  Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
.head 3 +  Function: ps_grc
.head 4 -  Description: Ручная квитовка файлов процессинга
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: nRetCode
.head 5 -  String: strTT
.head 5 -  String: strFn
.head 5 -  Date/Time: dFileDateTime
.head 5 -  Number: nN
.head 5 -  Number: nSdb
.head 5 -  Number: nSkr
.head 5 -  Number: nError
.head 5 -  Number: nDetail
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strFileDateTime
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +  If not SqlPLSQLCommand(hSql(), "sep.ps_grc(nRetCode,
   strTT,strFn,dFileDateTime,nN,nSdb,nSkr,nError,
   nDetail,NUMBER_Null,0,DATETIME_Null,STRING_Null)")
.head 8 -  Break
.head 6 +  Else
.head 7 -  Set strFileDateTime =
    SalFmtFormatDateTime(dFileDateTime,
    'yyyy-MM-dd hhhh:mm')
.head 7 +  If not SqlRetrieve(hSql(), "informix.ps_grc", ':strTT,
   :strFn,:strFileDateTime,:nN,:nSdb,:nSkr,:nError,
   :nDetail', ':nRetCode')
.head 8 -  Break
.head 7 +  If not SqlExecute(hSql())
.head 8 -  Break
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Break
.head 6 -  Return TRUE
.head 5 -  Call SqlRollbackEx(hSql(), 'Неуспех при ps_grc')
.head 5 -  Return FALSE
.head 3 +  Function: p_kwt
.head 4 -  Description: Отметить строку arc_rrp кодом блокировки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: nRetCode
.head 5 -  String: strFn
.head 5 -  Date/Time: dFileDateTime
.head 5 -  Number: nRec
.head 5 -  Number: nError
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strFileDateTime
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +  If not SqlPLSQLCommand(hSql(), "sep.p_kwt(nRetCode,
   strFn,dFileDateTime,nRec,nError)")
.head 8 -  Break
.head 6 +  Else
.head 7 -  Set strFileDateTime=SalFmtFormatDateTime(dFileDateTime,'yyyy-MM-dd hhhh:mm')
.head 7 +  If not SqlRetrieve(hSql(),"informix.p_kwt",':strFn,:strFileDateTime,:nRec,:nError',':nRetCode')
.head 8 -  Break
.head 7 +  If not SqlExecute (hSql())
.head 8 -  Break
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Break
.head 6 -  Return TRUE
.head 5 -  Call SqlRollbackEx(hSql(),'Неуспех при p_kwt')
.head 5 -  Return FALSE
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 3 +  Form Window Class: cGenericTableSpl0
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Yes
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  11.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 6.655"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 32
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cSplitterWindow
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.427"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  Pushbutton: pbIns
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 15
.head 7 -  Class: ctb_pbInsert
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.133"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Вставить новую запись'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Insert, 0, 0)
.head 6 +  Pushbutton: pbDel
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 16
.head 7 -  Class: ctb_pbDelete
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.583"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Пометить/Снять пометку на удаление'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Delete, 0, 0)
.head 6 +  Pushbutton: pbRefresh
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 17
.head 7 -  Class: ctb_pbRefresh
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.033"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Перечитать записи в таблице'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 +  Pushbutton: pbUpdate
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 18
.head 7 -  Class: ctb_pbUpdate
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.483"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Сохранить значения в базе данных'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 29143
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 19
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  1.983"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  1.983"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Pushbutton: pbSearch
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 20
.head 7 -  Class: ctb_pbSearch
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.083"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Поиск по значению первичного ключа'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Search, 0, 0)
.head 6 +  Pushbutton: pbFilter
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 21
.head 7 -  Class: ctb_pbFilter
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.533"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Установить фильтр...'
.head 8 +  On SAM_Click
.head 9 +  If SetQueryFilter(tbl.cF)
.head 10 -  Call SalPostMsg(tbl, UM_Populate, 0, 0)
.head 6 +  Pushbutton: pbDetails
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 31
.head 7 -  Class: ctb_pbDetail
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.983"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Подробная информация для строки таблицы'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_DoubleClick, 0, 0)
.head 6 +  Pushbutton: pbPrint
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 22
.head 7 -  Class: ctb_pbPrint
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   3.433"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F5
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Печать таблицы'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Print, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 29144
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 23
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  3.933"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  3.933"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Pushbutton: pbExit
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 25
.head 7 -  Class: ctb_pbCancel
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   4.083"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Esc
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Завершить работу'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Close, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 29145
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 26
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  4.633"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  4.633"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 4 +  Contents
.head 5 +  Child Table: tbl
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 28
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.233"
.head 8 -  Top:    0.06"
.head 8 -  Width:  5.5"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 1.107"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  View: Table
.head 7 -  Allow Row Sizing? No
.head 7 -  Lines Per Row: Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: Default
.head 7 -  Discardable? No
.head 6 -  Contents
.head 6 +  Functions
.head 7 +  Function: GetFirstEditableColumn
.head 8 -  Description: Получить первую редактируюмую колонку
.head 8 +  Returns
.head 9 -  Window Handle:
.head 8 +  Parameters
.head 9 -  Window Handle: hWndTbl
.head 8 -  Static Variables
.head 8 +  Local variables
.head 9 -  Number: nCol
.head 9 -  Window Handle: hWndCol
.head 8 +  Actions
.head 9 -  Set nCol=1
.head 9 +  Loop
.head 10 -  Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol, COL_GetPos)
.head 10 +  If hWndCol=hWndNULL
.head 11 -  Break
.head 10 +  If SalTblQueryColumnFlags(hWndCol, COL_Editable) AND
SalIsWindowVisible(hWndCol)
.head 11 -  Break
.head 10 -  Set nCol=nCol+1
.head 9 -  Return hWndCol
.head 6 +  Window Variables
.head 7 -  Window Handle: hCol
.head 7 -  !
.head 7 -  : cCstTab1
.head 8 -  Class: cABSTab
.head 7 -  : cMain
.head 8 -  Class: cABSConnect
.head 7 -  : cF
.head 8 -  Class: cGenFilter
.head 7 -  : cQ
.head 8 -  Class: cGenQuery
.head 7 -  String: strDSql
.head 6 +  Message Actions
.head 7 +  On UM_Create
.head 8 +  If nTabInstance1
.head 9 -  Call cCstTab1.Init(hWndItem, nTabInstance1, GetUserLoginName(), NOT fNoReposition1)
.head 7 +  On UM_Insert
.head 8 +  If NOT SalTblAnyRows(hWndForm, ROW_New, 0)
.head 9 -  Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
.head 8 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
.head 8 -  Set hCol = GetFirstEditableColumn(hWndForm)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
.head 7 +  On UM_Delete
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 9 +  Else
.head 10 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 7 +  On UM_Populate
.head 8 +  If strSqlPopulate != ''
.head 9 +  If fFilterAtStart
.head 10 -  Call SetQueryFilter(cF)
.head 10 -  Set fFilterAtStart = NOT fFilterAtStart
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 9 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 9 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 9 -  Call SalTblSetContext(hWndForm, 0)
.head 9 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  On UM_Update
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
.head 8 +  If strSqlDelete != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlDelete))
.head 9 -  Call SalTblDoDeletes(hWndForm, cMain.hSql(), ROW_MarkDeleted)
.head 8 +  If strSqlInsert != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlInsert))
.head 9 -  Call SalTblDoInserts(hWndForm, cMain.hSql(), TRUE)
.head 8 +  If strSqlUpdate != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlUpdate))
.head 9 -  Call SalTblDoUpdates(hWndForm, cMain.hSql(), TRUE)
.head 8 -  Call SqlCommit(cMain.hSql())
.head 8 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 +  On UM_DoubleClick
.head 8 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_DoubleClick, wParam, lParam)
.head 7 +  On SAM_ContextMenu
.head 8 +  If nFlags & GT_ReadOnly
.head 9 -  Call SalTrackPopupMenu(hWndForm, 'popupEditP', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 8 +  Else
.head 9 -  Call SalTrackPopupMenu(hWndForm, 'popupEditF', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 7 +  On SAM_EndCellTab
.head 8 -  Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
.head 8 -  Return TRUE
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  Call SalTblSortRows(hWndForm,SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), TBL_SortIncreasing)
.head 7 +  On SAM_CornerClick
.head 8 +  If nTabInstance1
.head 9 -  Call SetTblColumnStatus( hWndItem, cCstTab1 )
.head 7 +  On WM_Paint
.head 8 -  Call cCstTab1.MarkTableAsCustomisable(  )
.head 7 +  On SAM_Destroy
.head 8 -  Call cCstTab1.Destructor(  )
.head 5 +  Multiline Field: ml
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 32
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  String Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Border? Yes
.head 7 -  Word Wrap? Yes
.head 7 -  Vertical Scroll? Yes
.head 7 -  Window Location and Size
.head 8 -  Left:   0.383"
.head 8 -  Top:    3.095"
.head 8 -  Width:  5.5"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 1.107"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Default
.head 7 -  Background Color: 3D Face Color
.head 6 -  Message Actions
.head 5 +  Custom Control: ccSplitter
.head 6 -  Class Child Ref Key: 1
.head 6 -  Class ChildKey: 1
.head 6 -  Class: cSplitterWindow
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  DLL Name:
.head 7 -  MS Windows Class Name:
.head 7 -  Style:  Class Default
.head 7 -  ExStyle:  Class Default
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.0"
.head 8 -  Top:    2.571"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Etched Border? Class Default
.head 7 -  Hollow? Class Default
.head 7 -  Vertical Scroll? Class Default
.head 7 -  Horizontal Scroll? Class Default
.head 7 -  Tab Stop? Class Default
.head 7 -  Tile To Parent? Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  DLL Settings
.head 6 -  Message Actions
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  ! Параметры класса:
.head 5 -  ! NB: описание переменных -- аналогично cGenericTable (см.!)
.head 5 -  Number: nFlags
.head 5 -  String: strSqlPopulate
.head 5 -  String: strSqlInsert
.head 5 -  String: strSqlDelete
.head 5 -  String: strSqlUpdate
.head 5 -  String: strFilterTblName ! Имя основной таблицы для фильтра
.head 5 -  String: strTitleAux
.head 5 -  String: strPrintFileName ! Имя файла печати (без путей)
.head 5 -  Boolean: fFilterAtStart  ! Начинать население таблицы с фильтра
.head 5 -  Number: nTabInstance1    ! Номер варианта таблицы 1 для динамической настройки
.head 5 -  Boolean: fNoReposition1  ! Не использовать настройку положения колонок для таб 1
.head 5 -  ! Внутренние переменные:
.head 5 -  Number: nRow
.head 5 -  String: strOldTitle
.head 4 +  Functions
.head 5 +  Function: ReturnValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number: nRes
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 999
.head 5 +  Function: ReInitQueryString
.head 6 -  Description: Переинициализировать служебные SQL строки
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If strSqlPopulate != ''
.head 8 -  Call tbl.cQ.Init(strSqlPopulate)
.head 4 +  Message Actions
.head 5 +  On UM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SetWindowFont(hWndForm)
.head 6 -  !
.head 6 -  Call XConnectGetParams(tbl.cMain)
.head 6 +  If NOT tbl.cMain.Connect()
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 6 -  !
.head 6 -  Call XSalTooltipSetUserDefault()
.head 6 -  Call SaveInfoToLog(MSG_Invoke() || strTitleAux)
.head 6 +  If strTitleAux != ''
.head 7 -  Call SalGetWindowText(hWndForm, strOldTitle, 256)
.head 7 -  Call SalSetWindowText(hWndForm, strOldTitle || ': [' || strTitleAux || ']')
.head 6 -  !
.head 6 +  If strFilterTblName != ''
.head 7 -  Call tbl.cF.Init(strFilterTblName, strFilterTblName)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbFilter)
.head 6 -  !
.head 6 +  If strSqlPopulate != ''
.head 7 -  Call tbl.cQ.Init(strSqlPopulate)
.head 6 +  If nFlags & GT_NoIns
.head 7 -  Call SalDisableWindow(pbIns)
.head 6 +  If nFlags & GT_NoDel
.head 7 -  Call SalDisableWindow(pbDel)
.head 6 +  If nFlags & GT_NoUpd
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 6 +  ! If nFlags & GT_NoRet
.head 7 -                                                                 Call SalDisableWindow(pbOk)
.head 6 -  ! *** Indicate that child windows haven't been created yet
.head 6 -  Set m_fCreateComplete = FALSE
.head 6 -  ! *** Make form invisble to eliminate flicker during create
.head 6 -  Call SalHideWindow(hWndForm)
.head 6 -  Return TRUE
.head 5 +  On SAM_CreateComplete
.head 6 -  ! *** Indicate that all child windows are now created
.head 6 -  Set m_fCreateComplete = TRUE
.head 6 -  ! *** Invoke function to assign initial child panes
.head 6 -  Call ..AssociateChildren()
.head 6 -  !
.head 6 -  ! *** Make form visible and cause it to be drawn
.head 6 -  Call SalShowWindow(hWndForm)
.head 6 -  Call SalUpdateWindow(hWndForm)
.head 6 -  !
.head 6 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 -  On UM_DoubleClick
.head 5 +  On UM_Print
.head 6 +  If strPrintFileName
.head 7 -  Call SalGetWindowText(tbl, strOldTitle, 100)
.head 7 -  Call TablePrint(tbl, strOldTitle, GetPrnDir() || '\\' || strPrintFileName, '')
.head 5 +  On UM_Search
.head 6 -  Call TblFindString(tbl,  DFIND_First)
.head 5 +  On UM_Close
.head 6 +  If SalTblAnyRows(tbl, ROW_Edited | ROW_MarkDeleted | ROW_New, 0)
.head 7 -  Call SalMessageBeep(MB_IconQuestion)
.head 7 +  If SalMessageBox('В таблице присутсвуют несохраненные изменения. Игнорировать их?',
'Внимание!', MB_IconQuestion | MB_YesNo) != IDYES
.head 8 -  Return FALSE
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 +  On SAM_Destroy
.head 6 +  If tbl.cMain.IsConnected()
.head 7 -  Call tbl.cMain.Disconnect()
.head 6 -  Call SaveInfoToLog('Выход из диалога: ' || strTitleAux)
.head 3 +  Form Window Class: cGenericTableSpl1
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Yes
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Normal
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  12.314"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 7.385"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 34
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.427"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  Pushbutton: pbIns
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 15
.head 7 -  Class: ctb_pbInsert
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.133"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Вставить новую запись'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Insert, 0, 0)
.head 6 +  Pushbutton: pbDel
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 16
.head 7 -  Class: ctb_pbDelete
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.583"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Пометить/Снять пометку на удаление'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Delete, 0, 0)
.head 6 +  Pushbutton: pbRefresh
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 17
.head 7 -  Class: ctb_pbRefresh
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.033"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Перечитать записи в таблице'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 +  Pushbutton: pbUpdate
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 18
.head 7 -  Class: ctb_pbUpdate
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.483"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Сохранить значения в базе данных'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 49168
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 19
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  1.983"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  1.983"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Pushbutton: pbSearch
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 20
.head 7 -  Class: ctb_pbSearch
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.083"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Поиск по значению первичного ключа'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Search, 0, 0)
.head 6 +  Pushbutton: pbFilter
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 21
.head 7 -  Class: ctb_pbFilter
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.533"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Установить фильтр...'
.head 8 +  On SAM_Click
.head 9 +  If SetQueryFilter(tbl.cF)
.head 10 -  Call SalPostMsg(tbl, UM_Populate, 0, 0)
.head 6 +  Pushbutton: pbDetails
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 31
.head 7 -  Class: ctb_pbDetail
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.983"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Подробная информация для строки таблицы'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(tbl, UM_DoubleClick, 0, 0)
.head 6 +  Pushbutton: pbPrint
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 22
.head 7 -  Class: ctb_pbPrint
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   3.433"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F5
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Печать таблицы'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Print, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 49169
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 23
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  3.933"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  3.933"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Pushbutton: pbExit
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 25
.head 7 -  Class: ctb_pbCancel
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   4.083"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Esc
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = 'Завершить работу'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg(hWndForm, UM_Close, 0, 0)
.head 6 -  Line
.head 7 -  Resource Id: 49170
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 26
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  4.633"
.head 8 -  Begin Y:  0.417"
.head 8 -  End X:  4.633"
.head 8 -  End Y:  0.0"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 4 +  Contents
.head 5 +  Child Table: tbl
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 28
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.1"
.head 8 -  Top:    0.083"
.head 8 -  Width:  11.986"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 2.573"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  View: Table
.head 7 -  Allow Row Sizing? No
.head 7 -  Lines Per Row: Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: Default
.head 7 -  Discardable? No
.head 6 -  Contents
.head 6 +  Functions
.head 7 +  Function: GetFirstEditableColumn
.head 8 -  Description: Получить первую редактируюмую колонку
.head 8 +  Returns
.head 9 -  Window Handle:
.head 8 +  Parameters
.head 9 -  Window Handle: hWndTbl
.head 8 -  Static Variables
.head 8 +  Local variables
.head 9 -  Number: nCol
.head 9 -  Window Handle: hWndCol
.head 8 +  Actions
.head 9 -  Set nCol=1
.head 9 +  Loop
.head 10 -  Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol, COL_GetPos)
.head 10 +  If hWndCol=hWndNULL
.head 11 -  Break
.head 10 +  If SalTblQueryColumnFlags(hWndCol, COL_Editable) AND
SalIsWindowVisible(hWndCol)
.head 11 -  Break
.head 10 -  Set nCol=nCol+1
.head 9 -  Return hWndCol
.head 6 +  Window Variables
.head 7 -  Window Handle: hCol
.head 7 -  !
.head 7 -  : cCstTab1
.head 8 -  Class: cABSTab
.head 7 -  : cMain
.head 8 -  Class: cABSConnect
.head 7 -  : cF
.head 8 -  Class: cGenFilter
.head 7 -  : cQ
.head 8 -  Class: cGenQuery
.head 7 -  String: strDSql
.head 7 -  Boolean: bSortOrd
.head 6 +  Message Actions
.head 7 +  On UM_Create
.head 8 +  If nTabInstance1
.head 9 -  Call cCstTab1.Init(hWndItem, nTabInstance1, GetUserLoginName(), NOT fNoReposition1)
.head 8 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 7 +  On UM_Insert
.head 8 +  If NOT SalTblAnyRows(hWndForm, ROW_New, 0)
.head 9 -  Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
.head 8 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
.head 8 -  Set hCol = GetFirstEditableColumn(hWndForm)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
.head 7 +  On UM_Delete
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 9 +  Else
.head 10 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 7 +  On UM_Populate
.head 8 +  If strSqlPopulate != ''
.head 9 +  If fFilterAtStart
.head 10 -  Call SetQueryFilter(cF)
.head 10 -  Set fFilterAtStart = NOT fFilterAtStart
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 9 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 9 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 9 -  Call SalTblSetContext(hWndForm, 0)
.head 9 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  On UM_Update
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
.head 8 +  If strSqlDelete != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlDelete))
.head 9 -  Call SalTblDoDeletes(hWndForm, cMain.hSql(), ROW_MarkDeleted)
.head 8 +  If strSqlInsert != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlInsert))
.head 9 -  Call SalTblDoInserts(hWndForm, cMain.hSql(), TRUE)
.head 8 +  If strSqlUpdate != ''
.head 9 -  Call SqlPrepare(cMain.hSql(), T(strSqlUpdate))
.head 9 -  Call SalTblDoUpdates(hWndForm, cMain.hSql(), TRUE)
.head 8 -  Call SqlCommit(cMain.hSql())
.head 8 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 +  On UM_DoubleClick
.head 8 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_DoubleClick, wParam, lParam)
.head 7 +  On SAM_ContextMenu
.head 8 +  If nFlags & GT_ReadOnly
.head 9 -  Call SalTrackPopupMenu(hWndForm, 'popupEditP', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 8 +  Else
.head 9 -  Call SalTrackPopupMenu(hWndForm, 'popupEditF', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 7 +  On SAM_EndCellTab
.head 8 -  Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
.head 8 -  Return TRUE
.head 7 +  ! On SAM_CaptionDoubleClick
.head 8 -  Call SalTblSortRows(hWndForm,SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), TBL_SortIncreasing)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 8 -  Set bSortOrd = not bSortOrd
.head 8 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 7 +  On SAM_CornerClick
.head 8 +  If nTabInstance1
.head 9 -  Call SetTblColumnStatus( hWndItem, cCstTab1 )
.head 7 +  On WM_Paint
.head 8 -  Call cCstTab1.MarkTableAsCustomisable(  )
.head 7 +  On SAM_Destroy
.head 8 -  Call cCstTab1.Destructor(  )
.head 5 +  Custom Control: ccSplitter
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 33
.head 6 -  Class: cXSalHSplitter
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  DLL Name: XSal2_32.dll
.head 7 -  MS Windows Class Name: XSal:Splitter32
.head 7 -  Style:  0x00000000
.head 7 -  ExStyle:  0x00000000
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Default
.head 8 -  Top:    Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Yes
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Etched Border? No
.head 7 -  Hollow? Yes
.head 7 -  Vertical Scroll? No
.head 7 -  Horizontal Scroll? No
.head 7 -  Tab Stop? None
.head 7 -  Tile To Parent? Yes
.head 7 -  Font Name: Arial
.head 7 -  Font Size: 10
.head 7 -  Font Enhancement: Italic
.head 7 -  Text Color: Default
.head 7 -  Background Color: Dark Aqua
.head 7 -  DLL Settings
.head 6 -  Message Actions
.head 5 +  Multiline Field: ml
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 32
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  String Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Border? Yes
.head 7 -  Word Wrap? Yes
.head 7 -  Vertical Scroll? Yes
.head 7 -  Window Location and Size
.head 8 -  Left:   0.086"
.head 8 -  Top:    3.49"
.head 8 -  Width:  11.986"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 2.573"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Default
.head 7 -  Background Color: 3D Face Color
.head 6 -  Message Actions
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  ! Параметры класса:
.head 5 -  ! NB: описание переменных -- аналогично cGenericTable (см.!)
.head 5 -  Number: nFlags
.head 5 -  String: strSqlPopulate
.head 5 -  String: strSqlInsert
.head 5 -  String: strSqlDelete
.head 5 -  String: strSqlUpdate
.head 5 -  String: strFilterTblName ! Имя основной таблицы для фильтра
.head 5 -  String: strTitleAux
.head 5 -  String: strPrintFileName ! Имя файла печати (без путей)
.head 5 -  Boolean: fFilterAtStart  ! Начинать население таблицы с фильтра
.head 5 -  Number: nTabInstance1    ! Номер варианта таблицы 1 для динамической настройки
.head 5 -  Boolean: fNoReposition1  ! Не использовать настройку положения колонок для таб 1
.head 5 -  ! Внутренние переменные:
.head 5 -  Number: nRow
.head 5 -  String: strOldTitle
.head 5 -  ! ! ! Координаты и размер окна
.head 5 -  Number: nWinX
.head 5 -  Number: nWinY
.head 5 -  Number: nWinW
.head 5 -  Number: nWinH
.head 4 +  Functions
.head 5 +  Function: ReturnValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number: nRes
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 999
.head 5 +  Function: ReInitQueryString
.head 6 -  Description: Переинициализировать служебные SQL строки
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If strSqlPopulate != ''
.head 8 -  Call tbl.cQ.Init(strSqlPopulate)
.head 4 +  Message Actions
.head 5 +  On UM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SetWindowFont(hWndForm)
.head 6 -  !
.head 6 -  Call XConnectGetParams(tbl.cMain)
.head 6 +  If NOT tbl.cMain.Connect()
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 6 -  !
.head 6 -  Call XSalTooltipSetUserDefault()
.head 6 -  Call SaveInfoToLog(MSG_Invoke() || strTitleAux)
.head 6 +  If strTitleAux != ''
.head 7 -  Call SalGetWindowText(hWndForm, strOldTitle, 256)
.head 7 -  Call SalSetWindowText(hWndForm, strOldTitle || ': [' || strTitleAux || ']')
.head 6 -  !
.head 6 +  If strFilterTblName != ''
.head 7 -  Call tbl.cF.Init(strFilterTblName, strFilterTblName)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbFilter)
.head 6 -  !
.head 6 +  If strSqlPopulate != ''
.head 7 -  Call tbl.cQ.Init(strSqlPopulate)
.head 6 +  If nFlags & GT_NoIns
.head 7 -  Call SalDisableWindow(pbIns)
.head 6 +  If nFlags & GT_NoDel
.head 7 -  Call SalDisableWindow(pbDel)
.head 6 +  If nFlags & GT_NoUpd
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call ccSplitter.setBarPosition( 750 )
.head 6 -  Call ccSplitter.setTopFrame( tbl )
.head 6 -  Call ccSplitter.setBottomFrame( ml )
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 +  If strFilterTblName
.head 7 -  Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
.head 6 +  Else
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 5 -  On UM_DoubleClick
.head 5 +  On UM_Print
.head 6 +  If strPrintFileName
.head 7 -  Call SalGetWindowText(tbl, strOldTitle, 100)
.head 7 -  Call TablePrint(tbl, strOldTitle, GetPrnDir() || '\\' || strPrintFileName, '')
.head 5 +  On UM_Search
.head 6 -  Call TblFindString(tbl,  DFIND_First)
.head 5 +  On UM_Close
.head 6 +  If SalTblAnyRows(tbl, ROW_Edited | ROW_MarkDeleted | ROW_New, 0)
.head 7 -  Call SalMessageBeep(MB_IconQuestion)
.head 7 +  If SalMessageBox('В таблице присутсвуют несохраненные изменения. Игнорировать их?',
'Внимание!', MB_IconQuestion | MB_YesNo) != IDYES
.head 8 -  Return FALSE
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 +  On SAM_Destroy
.head 6 +  If tbl.cMain.IsConnected()
.head 7 -  Call tbl.cMain.Disconnect()
.head 6 -  Call SaveInfoToLog('Выход из диалога: ' || strTitleAux)
.head 3 +  Functional Class: cDocAlt
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRefDoc
.head 5 -  ! Number: nK2Ref
.head 5 -  ! String: sK2Nls9
.head 5 -  ! String: sK2NlsK
.head 4 +  Functions
.head 5 +  Function: iDoc
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cDoc.m_nPyD=0   ! Запретить оплату по факт остатку
.head 7 -  Return cDoc.iDoc()
.head 5 +  Function: oDoc
.head 6 -  Description: Оплатить документ с
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sErrTxt
.head 6 +  Actions
.head 7 +  While TRUE
.head 8 -  Call SqlPrepareAndExecute(hSql(),"SELECT ref INTO :nFetchRes FROM t902 WHERE ref=:nRefDoc FOR UPDATE OF ref NOWAIT")
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set sErrTxt='Невозможно получить доступ к Реф.'||Str(nRefDoc)
.head 9 -  Break
.head 8 +  If cDoc.oDoc()
.head 9 -  ! Set cDocW.m_nDk=nDk0
.head 9 -  ! Set cDocW.A.S=nSdocA
.head 9 -  ! Set cDocW.B.S=nSdocB
.head 9 +  If cDocW.m_sTT='901'
.head 10 +  If not SqlPLSQLCommand(hSql(),
   "DynTT(cDoc.m_nFlg,cDoc.m_nRef,cDoc.m_dDatV1,
     cDoc.m_nDk,cDoc.A.Kv,cDoc.A.Nls,cDoc.A.S,cDoc.B.Kv,cDoc.B.Nls,cDoc.B.S)")
.head 11 -  Set sErrTxt='Невозможно выполнить связанную операцию для '||cDoc.m_sTT
.head 11 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(), "DELETE FROM t902 WHERE ref=:nRefDoc")
.head 10 -  Set sErrTxt='Невозможно удалить Реф.'||Str(nRefDoc)||' из T902'
.head 10 -  Break
.head 9 +  If cDoc.m_nRef=nRefDoc
.head 10 +  If not cDoc.Pay(2,cDoc.m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 11 -  Set sErrTxt = 'Неуспех при фактической оплате 9'
.head 11 -  Break
.head 9 +  Else
.head 10 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:cDoc.m_nRef,'REF92',:nRefDoc)")
.head 11 -  Set sErrTxt=' Невозможно вставить TAG REF92 в OPERW'
.head 11 -  Break
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
.head 7 -  Return FALSE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cCalendar
.head 2 -  Application Actions
.head 1 +  Form Window: spl_LockDocs  ! 01 новый опер
.head 2 -  Class: cGenericTableSpl1
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Блокированние документы СЕП
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.27"
.head 4 -  Top:    0.358"
.head 4 -  Width:  16.057"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Блокированные документы СЭП
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.646"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbReject
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_OUT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If GetGlobalOptionEx('TECHPASS') OR not GetGlobalOptionEx('VISASIGN') ! ЭЦП на визе нету ?
.head 8 +  If not ShowInputPassword() ! спросить технологический пароль
.head 9 -  Return FALSE
.head 7 +  If cbOnSumm and dfBoundSum = 0
.head 8 -  Return MessageInfoEx('Не указана сумма Блокируемых документов СЭП !')
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Вернуть отмеченные документы СЭП ?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 +  If not SalModalDialog(dlg_Reason, hWndForm)
.head 9 -  Return FALSE
.head 8 -  Call LockSepDocs(0)
.head 7 +  Else
.head 8 +  If MessageQuestion('Вернуть все документы СЭП с кодом блокировки: ' || Str(tbl.BLK) || ' ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 +  If not SalModalDialog(dlg_Reason, hWndForm)
.head 9 -  Return FALSE
.head 8 -  Call LockSepDocs(nBlk)
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вернуть отправителю'
.head 4 +  Pushbutton: pbAccept
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If GetGlobalOptionEx('TECHPASS') OR (not GetGlobalOptionEx('VISASIGN') and not bPutSignMode)
! ЭЦП на визе нету и не надо подписывать документы для Сбербанка?
.head 8 +  If not ShowInputPassword() ! спросить технологический пароль
.head 9 -  Return FALSE
.head 7 +  If cbOnSumm And dfBoundSum = 0
.head 8 -  Return MessageInfoEx('Не указана сумма принимаемых документов СЭП!')
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Разблокировать отмеченные документы СЭП?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 +  If not UnlockSepDocs(tbl, 0)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If MessageQuestion('Разблокировать все документы СЭП с кодом блокировки: ' || Str(tbl.BLK) || ' ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 +  If not UnlockSepDocs(tbl, nBlk)
.head 9 -  Return FALSE
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Разблокировать'
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb902
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\RELATION.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If GetGlobalOptionEx('TECHPASS') OR not GetGlobalOptionEx( 'VISASIGN' ) ! ЭЦП на визе нету ?
.head 8 +  If not ShowInputPassword()  ! спросить технологический пароль
.head 9 -  Return FALSE
.head 7 +  If cbOnSumm And dfBoundSum = 0
.head 8 -  Return MessageInfoEx('Не указана сумма принимаемых до выяснения документов СЭП!')
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Принять отмеченные документы СЭП <<До выяснения>>?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 -  Call UnlockSepDocsTo902(tbl, 0)
.head 7 +  Else
.head 8 +  If MessageQuestion('Принять отмеченные документы СЭП <<До выяснения>> с кодом блокировки: ' || Str(tbl.BLK) ||' ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 -  Call UnlockSepDocsTo902(tbl, nBlk)
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Принять <<До выяснения>>'
.head 4 -  Line
.head 5 -  Resource Id: 49171
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49172
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49173
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  0.573"
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Check Box: cbAllWithCode
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: По коду
.head 5 -  Window Location and Size
.head 6 -  Left:   4.814"
.head 6 -  Top:    0.094"
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cbAllWithCode
.head 8 -  Set cbOnSumm = FALSE
.head 8 -  Call SalDisableWindow(dfBoundSum)
.head 6 +  On VTM_KeyDown
.head 7 +  If wParam = VK_S
.head 8 +  If (VisGetKeyState(VK_Alt) & KS_Down) 
and (VisGetKeyState(VK_Control) & KS_Down)
.head 9 -  Call SalSendMsg(pbResign, SAM_Click, 0, 0)
.head 4 +  Check Box: cbOnSumm
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: На сумму
.head 5 -  Window Location and Size
.head 6 -  Left:   4.814"
.head 6 -  Top:    0.323"
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cbOnSumm
.head 8 -  Call SalEnableWindow(dfBoundSum)
.head 8 -  Set cbAllWithCode = FALSE
.head 7 +  Else
.head 8 -  Call SalDisableWindow(dfBoundSum)
.head 4 +  Data Field: dfBoundSum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.086"
.head 7 -  Top:    0.073"
.head 7 -  Width:  1.45"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dfBoundSum = 0
.head 7 -  Call SalDisableWindow(dfBoundSum)
.head 4 -  !
.head 4 -  Background Text: Док.:
.head 5 -  Resource Id: 49177
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.186"
.head 6 -  Top:    0.094"
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfAllNum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.814"
.head 7 -  Top:    0.094"
.head 7 -  Width:  0.85"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfAllSum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.671"
.head 7 -  Top:    0.094"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Отм.:
.head 5 -  Resource Id: 49174
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.186"
.head 6 -  Top:    0.344"
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfNumSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.814"
.head 7 -  Top:    0.344"
.head 7 -  Width:  0.85"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfSumSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.671"
.head 7 -  Top:    0.344"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfResurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 11
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.086"
.head 7 -  Top:    0.323"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If bMisys or bFinacle
.head 8 -  Call SalHideWindow( hWndItem )
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT sum(decode(tip,'TNB',-ostc-lim,-ostc))
     INTO   :nTmpL00
     FROM   v_accounts_proc
     WHERE  kv=980 and p_tip in ('N00'" || IifS(GetGlobalOptionEx('CLRTRN'), '', ",'TNB'") ||
            IifS(GetBankModel(), ",'L00','TUR'", '') || ")")
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set nTmpL00 = 0
.head 8 -  Set dfResurs = nTmpL00 / 100
.head 8 +  If nTmpL00 < 0
.head 9 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_Red)
.head 9 -  Call SalColorSet(dfResursN, COLOR_IndexWindowText, COLOR_Red)
.head 8 +  Else
.head 9 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue)
.head 8 -  Set dfResursN = 'Ресурс'
.head 4 +  Data Field: dfResursN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.686"
.head 7 -  Top:    0.094"
.head 7 -  Width:  1.333"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.2"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold-Underline
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbConditionBlk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.486"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlg_Rules, hWndForm)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотреть БИЗНЕС-ПРАВИЛА'
.head 4 +  Pushbutton: pbMisysBal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.466"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\misys.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinMis)
.head 8 -  Set hWinMis = SalCreateWindow(tblMisysAcc, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (tblMisysAcc)
.head 6 +  On SAM_Create
.head 7 +  If bMisys
.head 8 -  Call SalShowWindow(hWndItem)
.head 8 -  Set strTip = "Справка по счетам BMRS"
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 4 +  Pushbutton: pbTerrorist
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.966"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\QUERY.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SqlPLSQLCommand(hSql(), "p_istr(tbl.NAM_A || ' '|| tbl.NAM_B || ' ' || tbl.NAZN, nFMOtm)")
.head 7 +  If nFMOtm
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT SUBSTR(c1||'. '||c6||' '||c7||' '||c8||' '||c9,1,250)
     FROM   finmon_reft
     WHERE  rownum=1 and c1=:nFMOtm
     INTO   :sTmp")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call MessageInfo(SalStrTrimX('Документ призупинений за схожістю з особою зі списку терористів. Запис № -' ||
     sTmp))
.head 7 +  Else
.head 8 -  Call MessageErrorEx('Нет в списке террористов')
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Проверить в списке террористов"
.head 7 +  ! If bFinMon
.head 8 -  Call SalShowWindow(hWndItem)
.head 7 +  ! Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 4 +  Option Button: obTimer
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.983"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Clock.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obTimer
.head 8 -  Call SalTimerSet(spl_LockDocs, TIMER_ID1, 65535)
.head 7 +  Else
.head 8 -  Call SalTimerKill(spl_LockDocs, TIMER_ID1)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obTimer, 'Вы', 'В') ||'ключить пересканирование')
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 -  Line
.head 5 -  Resource Id: 49179
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  12.386"
.head 6 -  Begin Y:  0.573"
.head 6 -  End X:  12.386"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalGetWindowLoc ( pb902, nX1, nY1 )
.head 7 -  Call SalSetWindowLoc ( hWndItem, nX1, nY1 )
.head 7 -  Set strTip = 'Вилучити запит'
.head 6 +  On SAM_Click
.head 7 +  If GetGlobalOptionEx('TECHPASS') OR not GetGlobalOptionEx('VISASIGN') ! ЭЦП на визе нету ?
.head 8 +  If not ShowInputPassword() ! спросить технологический пароль
.head 9 -  Return FALSE
.head 7 +  If cbOnSumm and dfBoundSum = 0
.head 8 -  Return MessageInfoEx('Не указана сумма Блокируемых документов СЭП !')
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Удалить отмеченные сообщения ?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 -  Call DelZap(0)
.head 7 +  Else
.head 8 +  If MessageQuestion('Удалить все сообщения с кодом блокировки: ' || Str(tbl.BLK) || ' ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 -  Call DelZap(nBlk)
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbSwift
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTBANK.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If bSwift
.head 8 -  Call SalShowWindow(hWndItem)
.head 8 -  Set strTip = 'Відправити через SWIFT'
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Перенаправити через SWIFT ?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 -  Call ToSwift(0)
.head 7 +  Else
.head 8 +  If MessageQuestion('Перенаправити всі документи з кодом ' || Str(tbl.BLK) || ' через SWIFT ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 -  Call ToSwift(nBlk)
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 +  Option Button: obStopW
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.486"
.head 6 -  Top:    0.24"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\horse2.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalGetWindowLoc ( pbSwift, nX1, nY1 )
.head 7 -  Call SalSetWindowLoc ( hWndItem, nX1, nY1 )
.head 7 +  If bWebPay and fAllowChanges
.head 8 -  Call SalShowWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If obStopW
.head 8 -  Call SqlPLSQLCommand(hSql(), "gl.setp('WEBPAY','N',STRING_Null)")
.head 7 +  Else
.head 8 -  Call SqlPLSQLCommand(hSql(), "gl.setp('WEBPAY','Y',STRING_Null)")
.head 7 -  ! If GetWebPayFlag()='N' AND obStopW
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obStopW,'Відкрити WEB оплату','Закрити оплату WEB'))
.head 6 +  ! On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Pushbutton: pbResign
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not cbAllWithCode
.head 8 +  If MessageQuestion('Перепідписати документ ключем '||GetIdOper()||' ?') != IDYES
.head 9 -  Return FALSE
.head 8 +  If cbOnSumm
.head 9 +  If not SelectDocs()
.head 10 -  Return FALSE
.head 8 -  Call ReSign(0)
.head 7 +  Else
.head 8 +  If MessageQuestion('Перепідписати всі документи з кодом ' || Str(tbl.BLK) ||' ключем '||GetIdOper()||' ?') != IDYES
.head 9 -  Return FALSE
.head 8 -  Set nBlk = tbl.BLK
.head 8 +  If not SelectDocsWithBlk()
.head 9 -  Return FALSE
.head 8 -  Call ReSign(nBlk)
.head 7 -  Call SetObjectStateEx()
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 +  Check Box: cbChooseForAllStp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Всі СТП
.head 5 -  Window Location and Size
.head 6 -  Left:   14.2"
.head 6 -  Top:    0.25"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(tbl, nRow)
.head 8 -  Set tbl.PRTY = cbChooseForAllStp
.head 8 -  Call SalSendMsg( tbl.PRTY, SAM_AnyEdit, 0, 0)
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  13.886"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: PDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Время
поступл
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 16
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BLK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код бло-
кировки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО банка
Плательщика
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
Плательщика
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.56"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_RbuttonUp
.head 8 +  If not (bMisys or bFinacle) and MFOA=aMfo
.head 9 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT c.okpo||' '||c.nmk||'('||a.tobo||')'
     INTO   :sNmk
     FROM   customer c,accounts a
     WHERE  a.rnk=c.rnk AND a.kv=:tbl.KV and a.nls=:tbl.NLSA")
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 10 -  Call XSalTooltipShow(hWndForm, 'Клієнт: ' || PutCrLf() || sNmk)
.head 10 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 8 -  Return FALSE
.head 7 +  On SAM_Create
.head 8 +  If bMisys or bFinacle
.head 9 -  Call SalDisableWindow(hWndItem)
.head 8 +  Else
.head 9 -  Call SalEnableWindow(hWndItem)
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = MyValue
.head 7 +  On SAM_AnyEdit
.head 8 -  Set MyValue = sTmp
.head 5 +  Column: NAM_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
Плательщика
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.486"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дб
Кр
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО банка
Получателя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
Получателя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.56"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_B
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
Получателя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата платежного
документа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FINGER
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FN_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
файла
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 12
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата файла
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REC_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REC_A
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BIS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ID_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КОД
А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ID_B
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КОД
Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRTY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
срочности
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE arc_rrp
   SET    prty=:tbl.PRTY
   WHERE  rec=:tbl.ID and blk=:tbl.BLK")
.head 9 -  Call SqlCommit(hSql())
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalMessageBox('Ошибка модификации ARC_RRP.PRTY', 'Ошибка', MB_Ok|MB_IconStop)
.head 5 +  Column: OTM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отметка
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: NA
.head 5 -  String: NB
.head 5 -  String: NZ
.head 5 -  ! String: strK_er
.head 5 -  : cQDoc
.head 6 -  Class: cGenQuery
.head 5 -  Boolean: bSortOrd
.head 5 -  Boolean: bRes
.head 5 -  Date/Time: dPDat
.head 5 -  Number: nRow
.head 5 -  Number: nCurRow
.head 5 -  Number: nMinRow
.head 5 -  Number: nMaxRow
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If strAddCond
.head 7 -  Set strAddCond = strAddCond || ' AND '
.head 6 +  ! If bMisys or bFinacle
.head 7 -  Set strSql = '
    SELECT /*+ INDEX (arc_rrp XPK_ARC_RRP) */
           arc_rrp.mfoa,arc_rrp.mfob,arc_rrp.nlsa,arc_rrp.nlsb,arc_rrp.nam_a,arc_rrp.nam_b,arc_rrp.s/100,
           arc_rrp.kv,arc_rrp.dk,arc_rrp.nazn,arc_rrp.data,arc_rrp.rec,arc_rrp.blk,1,arc_rrp.ref,arc_rrp.fn_a,
           arc_rrp.dat_a,arc_rrp.rec_a,arc_rrp.bis,arc_rrp.vob,arc_rrp.nd, arc_rrp.ref_a,arc_rrp.id_a,arc_rrp.id_b,
           rec_que.otm
    INTO   :tbl.MFOA,:tbl.MFOB,:tbl.NLSA,:tbl.NLSB, :tbl.NAM_A, :tbl.NAM_B,:tbl.S,   :tbl.KV,   :tbl.DK,
           :tbl.NAZN,:tbl.DATD,:tbl.ID,  :tbl.BLK,  :tbl.FINGER,:tbl.REF,  :tbl.FN_A,:tbl.DAT_A,:tbl.REC_A,
           :tbl.BIS, :tbl.VOB, :tbl.ND,  :tbl.REF_A,:tbl.ID_A,  :tbl.ID_B, :tbl.PRTY,:tbl.OTM
    FROM   rec_que, arc_rrp
    WHERE  ' || strAddCond || ' arc_rrp.rec=rec_que.rec
    ORDER BY arc_rrp.blk'
.head 6 -  ! Else
.head 6 +  If bPdat
.head 7 -  Set strSql = '
    SELECT arc_rrp.mfoa,arc_rrp.mfob,arc_rrp.nlsa,arc_rrp.nlsb,arc_rrp.nam_a,arc_rrp.nam_b,arc_rrp.s/100,arc_rrp.kv,
           arc_rrp.dk,arc_rrp.nazn,arc_rrp.data,arc_rrp.rec,arc_rrp.blk,1 n,arc_rrp.ref,arc_rrp.fn_a,arc_rrp.dat_a,
           arc_rrp.rec_a,arc_rrp.bis,arc_rrp.vob,arc_rrp.nd, arc_rrp.ref_a,arc_rrp.id_a,arc_rrp.id_b,
           NVL(arc_rrp.prty,0) prty,oper.PDAT,rec_que.otm
    FROM   rec_que, arc_rrp, oper
    WHERE  ' || strAddCond || ' arc_rrp.rec=rec_que.rec and arc_rrp.ref=oper.ref(+) 
    ORDER BY arc_rrp.blk 
    INTO   :tbl.MFOA,:tbl.MFOB,:tbl.NLSA,:tbl.NLSB, :tbl.NAM_A, :tbl.NAM_B,:tbl.S,   :tbl.KV,   :tbl.DK,
           :tbl.NAZN,:tbl.DATD,:tbl.ID,  :tbl.BLK,  :tbl.FINGER,:tbl.REF,  :tbl.FN_A,:tbl.DAT_A,:tbl.REC_A,
           :tbl.BIS, :tbl.VOB, :tbl.ND,  :tbl.REF_A,:tbl.ID_A,  :tbl.ID_B, :tbl.PRTY,:dPDat,    :tbl.OTM'
.head 6 +  Else
.head 7 -  Set strSql = '
    SELECT arc_rrp.mfoa,arc_rrp.mfob,arc_rrp.nlsa,arc_rrp.nlsb,arc_rrp.nam_a,arc_rrp.nam_b,arc_rrp.s/100,arc_rrp.kv,
           arc_rrp.dk,arc_rrp.nazn,arc_rrp.data,arc_rrp.rec,arc_rrp.blk,1 n,arc_rrp.ref,arc_rrp.fn_a,arc_rrp.dat_a,
           arc_rrp.rec_a,arc_rrp.bis,arc_rrp.vob,arc_rrp.nd, arc_rrp.ref_a,arc_rrp.id_a,arc_rrp.id_b,
           NVL(arc_rrp.prty,0) prty,rec_que.otm
    FROM   rec_que, arc_rrp
    WHERE  ' || strAddCond || ' arc_rrp.rec=rec_que.rec 
    ORDER BY arc_rrp.blk 
    INTO   :tbl.MFOA,:tbl.MFOB,:tbl.NLSA,:tbl.NLSB, :tbl.NAM_A, :tbl.NAM_B,:tbl.S,   :tbl.KV,   :tbl.DK,
           :tbl.NAZN,:tbl.DATD,:tbl.ID,  :tbl.BLK,  :tbl.FINGER,:tbl.REF,  :tbl.FN_A,:tbl.DAT_A,:tbl.REC_A,
           :tbl.BIS, :tbl.VOB, :tbl.ND,  :tbl.REF_A,:tbl.ID_A,  :tbl.ID_B, :tbl.PRTY,:tbl.OTM'
.head 6 -  Call cQDoc.Init(T(strSql))
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call WaitCursorOn()
.head 6 -  Call GetSumAndCountDocs()
.head 6 -  Call SetObjectState()
.head 6 -  Set dfAllNum = 0
.head 6 -  Set dfAllSum = 0
.head 6 -  Call SalSendMsg(dfResurs,SAM_Create, 0, 0)
.head 6 -  Set strSql = T(cQDoc.GetFullSQLString(cF))
.head 6 -  Call SalTblPopulate(tbl, hSql(), strSql, TBL_FillAll)
.head 6 -  ! Установить на старое место
.head 6 -  Call SalTblQueryScroll(tbl, nTmp, nMinRow, nMaxRow)
.head 6 +  If nCurRow > nMaxRow
.head 7 -  Set nCurRow = nMaxRow
.head 6 -  Call SalTblSetContext(tbl, nCurRow)
.head 6 -  Call SalTblSetRowFlags(tbl, nCurRow, ROW_Selected, TRUE)
.head 6 -  Call SalTblSetFocusRow(tbl, nCurRow)
.head 6 -  Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
.head 6 -  !
.head 6 +  If bWebPay
.head 7 -  Set obStopW=(GetWebPayFlag()='N')
.head 6 -  !
.head 6 -  Call WaitCursorOff()
.head 5 +  On SAM_FetchRowDone
.head 6 +  If not GetGlobalOption('SEP$A') = 'MANUAL' ! показать отметку
.head 7 +  If bOtmMono
.head 8 -  Call SalTblSetRowFlags(tbl, lParam, ROW_New, OTM)
.head 7 +  Else
.head 8 -  Call XSalTblSetRowBackColor(tbl, lParam, IifN(OTM=1, COLOR_LightPeriwinkle, COLOR_White))
.head 6 -  Set dfAllNum = dfAllNum + 1
.head 6 +  If tbl.DK = 0 or tbl.DK = 1
.head 7 -  Set dfAllSum = dfAllSum + tbl.S
.head 6 +  If dPDat
.head 7 -  Set tbl.PDAT = Right('0' || SalFmtFormatDateTime(dPDat, 'dd.MM.yyyy'), 10) || ' ' || Right('0' ||
    SalFmtFormatDateTime(dPDat, 'hhhh:mm'), 5)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call DocViewContents(hWndMDI, tbl.ID)
.head 5 -  On SAM_ContextMenu ! не удалять
.head 5 +  On WM_LbuttonUp
.head 6 -  Set dfNumSelect = SalTblColumnSum(tbl, 15, ROW_Selected, 0)
.head 6 -  Set dfSumSelect = SalTblColumnSum(tbl, 8, ROW_Selected, 0)
.head 6 -  Call SetObjectState()
.head 5 +  On WM_RbuttonUp
.head 6 +  If not GetGlobalOption('SEP$A') = 'MANUAL'
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblFetchRow(tbl, nRow)
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE rec_que
   SET    otm=1-otm
   WHERE  rec=:tbl.ID")
.head 9 -  Set OTM=1-OTM
.head 9 +  If bOtmMono
.head 10 -  Call SalTblSetRowFlags(tbl, nRow, ROW_New, OTM)
.head 9 +  Else
.head 10 -  Call XSalTblSetRowBackColor(tbl, nRow, IifN(OTM=1, COLOR_LightPeriwinkle, COLOR_White))
.head 9 -  Call SqlCommitEx(hSql(), 'Пометка документа СЭП: ' || Str(tbl.ID))
.head 7 -  Call SqlRollback(hSql())
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SetObjectState()
.head 6 -  Set ml = 'Отправитель:     МФО: ' || tbl.MFOA || ' , Счет: ' || tbl.NLSA || PutCrLf() || PadR(tbl.NAM_A,38) ||
    PutCrLf() || PutCrLf() || ' Получатель:     МФО: ' || tbl.MFOB || ' , Счет: ' || tbl.NLSB || PutCrLf()
.head 6 +  ! If tbl.MFOA != aMfo and tbl.MFOB = aMfo
.head 7 +  If not bMisys and not bFinacle
.head 8 +  If SqlPrepareAndExecute( hSqlAux2(), "
   SELECT nms
   into   :sNms
   from   accounts
   where  kv=:tbl.KV and nls=:tbl.NLSB") and SqlFetchNext(hSqlAux2(), nFetchRes)
.head 9 -  Set ml = ml || "в док: " || PadR(tbl.NAM_B,38) || PutCrLf() || "в АБС: " || sNms || PutCrLf()
.head 6 -  ! Else
.head 6 -  Set ml = ml || PadR(tbl.NAM_B,38) || PutCrLf() 
.head 6 -  Set ml = ml || PutCrLf() || 'Назначение платежа:' || PutCrLf() || tbl.NAZN
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Set sErrorTxt = ''
.head 6 +  If tbl.BLK
.head 7 -  Call SqlPrepareAndExecute(hSql(),
    "SELECT k_er||' '||n_er INTO :sErrorTxt
       FROM s_er   
      WHERE LPAD(:tbl.BLK,4,'0') = k_er")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
    'SELECT name
       FROM bp_rrp
       INTO :sErrorTxt
      WHERE rule=:tbl.BLK and fa=1')
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set sErrorTxt = 'Бізнес правило № ' || Str(tbl.BLK) || IifS(Len(sErrorTxt)>0, ' (' || sErrorTxt || ')', '')
.head 6 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 6 -  Call XSalTooltipShow(hWndForm, sErrorTxt)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 5 +  On SAM_KillFocus
.head 6 -  Set nCurRow = SalTblQueryContext(tbl)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_S
.head 7 +  If (VisGetKeyState(VK_Alt) & KS_Down) 
and (VisGetKeyState(VK_Control) & KS_Down)
.head 8 -  Call SalSendMsg(pbResign, SAM_Click, 0, 0)
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 33
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? Tab
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Multiline Field: ml
.head 4 -  Class Child Ref Key: 32
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  13.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SetObjectState
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If dfAllNum
.head 6 -  Call SalEnableWindow(pbReject)
.head 6 -  Call SalEnableWindow(pbAccept)
.head 6 -  Call SalEnableWindow(pb902)
.head 6 -  Call SalEnableWindow(pbDetails)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(pbReject)
.head 6 -  Call SalDisableWindow(pbAccept)
.head 6 -  Call SalDisableWindow(pb902)
.head 6 -  Call SalDisableWindow(pbDetails)
.head 5 +  If fAllowChanges
.head 6 +  If tbl.DK = 1 or tbl.DK = 0
.head 7 -  Call SalShowWindow(pb902)
.head 7 -  Call SalHideWindow(pbDel)
.head 6 +  Else
.head 7 -  Call SalShowWindow(pbDel)
.head 7 -  Call SalHideWindow(pb902)
.head 6 +  If tbl.MFOA = aMfo
.head 7 -  Call SalEnableWindow(pbReject)
.head 7 +  If bShow902
.head 8 -  Call SalEnableWindow(pb902)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pb902)
.head 7 +  If bSwift AND tbl.MFOB != aMfo
.head 8 -  Call SalEnableWindow(pbSwift)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pbSwift)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbReject)
.head 7 -  Call SalDisableWindow(pbSwift)
.head 7 +  If tbl.DK = 1 or tbl.DK = 0
.head 8 -  Call SalEnableWindow(pb902)
.head 8 -  Call SalDisableWindow(pbDel)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(pbDel)
.head 8 -  Call SalDisableWindow(pb902)
.head 5 +  If tbl.BLK = 131313 ! Пойман террорист
.head 6 -  Call SalShowWindow(pbTerrorist)
.head 5 +  Else
.head 6 -  Call SalHideWindow(pbTerrorist)
.head 5 -  Set cbAllWithCode = FALSE
.head 5 -  Set cbOnSumm = FALSE
.head 3 +  Function: SetObjectStateEx
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalDisableWindow(pbReject)
.head 5 -  Call SalDisableWindow(pbAccept)
.head 5 -  Call SalDisableWindow(pb902)
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Call SalDisableWindow(pbSwift)
.head 5 -  Set cbAllWithCode = FALSE
.head 5 -  Set cbOnSumm = FALSE
.head 3 +  Function: GetSumAndCountDocs
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfNumSelect = 0
.head 5 -  Set dfSumSelect = 0
.head 3 +  Function: SelectDocs
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  Set nSumDocs = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Call SalTblClearSelection(tbl)
.head 5 -  Call WaitCursorOn()
.head 5 +  While SalTblFindNextRow(tbl, nRow, 0, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If (nSumDocs+tbl.S) <= dfBoundSum
.head 7 -  Call SalTblSetRowFlags(tbl, nRow, ROW_Selected, TRUE)
.head 7 -  Set nSumDocs = nSumDocs + tbl.S
.head 6 +  Else
.head 7 -  Break
.head 6 -  Call SalTblSetRowFlags(tbl, nRow, ROW_Selected, TRUE)
.head 5 -  Call WaitCursorOff()
.head 5 -  Set dfNumSelect = 0
.head 5 -  Set dfSumSelect = 0
.head 5 -  Set dfNumSelect = SalTblColumnSum(tbl, 15, ROW_Selected, 0)
.head 5 -  Set dfSumSelect = SalTblColumnSum(tbl, 8, ROW_Selected, 0)
.head 5 +  If MessageQuestion('Вибрано документів СЕП на суму:  ' || SalNumberToStrX(dfSumSelect, 2) || '  Продовжити?') != IDYES
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: SelectDocsWithBlk
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  Set nSumDocs = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Call SalTblClearSelection(tbl)
.head 5 -  Call WaitCursorOn()
.head 5 +  While SalTblFindNextRow(tbl, nRow, 0, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If tbl.BLK = nBlk
.head 7 +  If cbOnSumm
.head 8 +  If (nSumDocs+tbl.S) <= dfBoundSum
.head 9 -  Call SalTblSetRowFlags(tbl, nRow, ROW_Selected, TRUE)
.head 9 -  Set nSumDocs = nSumDocs + tbl.S
.head 8 +  Else
.head 9 -  Break
.head 7 -  Call SalTblSetRowFlags(tbl, nRow, ROW_Selected, TRUE)
.head 5 -  Call WaitCursorOff()
.head 5 -  Set dfNumSelect = 0
.head 5 -  Set dfSumSelect = 0
.head 5 -  Set dfNumSelect = SalTblColumnSum(tbl, 15, ROW_Selected, 0)
.head 5 -  Set dfSumSelect = SalTblColumnSum(tbl, 8, ROW_Selected, 0)
.head 5 +  If MessageQuestion('Вибрано документів СЕП на суму:  ' || SalNumberToStrX(dfSumSelect, 2) || '  Продовжити?') != IDYES
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: UnlockSepDocs
.head 4 -  Description: Разблокировать документы СЭП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTable
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  Number: nRow
.head 5 -  ! String: strKeyId
.head 5 -  String: szIDO
.head 5 -  Number: nDBUserID ! ID юзера БД
.head 5 -  Number: nRecNum  ! rec документа из arc_rrp
.head 5 -  Number: nRes
.head 5 -  Number: nDK
.head 5 -  Number: nSUM
.head 5 -  String: szNAZN
.head 5 -  String: szD_REC
.head 5 -  String: szNAZNK
.head 5 -  String: szNAZNS
.head 5 -  Number: nBIS
.head 5 -  Boolean: b131313
.head 4 +  Actions
.head 5 +  If fVisaSign AND nSepVisa = 0
.head 6 -  Call MessageErrorEx('Не указано значение SEPVISA в таблице PARAMS!')
.head 6 -  Return FALSE
.head 5 -  Set b131313 = FALSE
.head 5 -  !
.head 5 -  Call WaitCursorOn()
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  ! главный цикл
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If tbl.BLK = 131313 ! Пойман террорист
.head 7 -  Set b131313 = TRUE
.head 6 +  Else
.head 7 -  Set strRec = Str(tbl.ID)
.head 7 -  ! Лочим запись чтоб другие на схватили
.head 7 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT rec
     INTO   :nFetchRes
     FROM   arc_rrp
     WHERE  rec=:tbl.ID and blk=:tbl.BLK
     FOR UPDATE OF blk NOWAIT")
.head 7 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx('Невозможно получить доступ к REC.' || strRec)
.head 8 -  Break
.head 7 -  ! -- internal digital sign check --
.head 7 +  If fVisaSign and GetSignOn() != 0 and tbl.REF and not bPutSignMode ! Проверка подписи n-1
.head 8 -  ! Проверить подпись !
.head 8 +  If NOT cDoc.SetDocR(tbl.REF, TRUE)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 8 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 9 +  If not cDoc.cDocInt(99, nSepVisa)
.head 10 +  Select Case cDoc.m_nSignErrType
.head 11 +  Case 1
.head 12 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 12 -  Break
.head 11 +  Case 2
.head 12 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 12 -  Break
.head 11 +  Default
.head 12 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 12 -  Break
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 +  If not cDoc.CheckDocSign('CUR', nSepVisa)
.head 10 +  Select Case cDoc.m_nSignErrType
.head 11 +  Case 1
.head 12 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 12 -  Break
.head 11 +  Case 2
.head 12 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 12 -  Break
.head 11 +  Default
.head 12 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 12 -  Break
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 7 -  ! -- internal digital sign check --
.head 7 -  !
.head 7 -  Set strSql = 'UPDATE arc_rrp SET blk='
.head 7 +  If bPutSignMode ! надо подписать сам документ (для Сбербанка)?
.head 8 -  ! код блокировки ставим NULL для повторного прохождения бизнес-правил
.head 8 -  Set strSql = strSql || 'NULL'
.head 7 +  Else
.head 8 -  Set strSql = strSql || '0'
.head 7 -  Set strSql = strSql || ' WHERE fn_b IS NULL AND '
.head 7 +  If tbl.BIS
.head 8 -  Set strSql = strSql || ' bis>0 AND rec IN (SELECT rec FROM rec_que WHERE rec_g=:tbl.ID AND rec_g IS NOT NULL)'
.head 7 +  Else
.head 8 -  Set strSql = strSql || ' rec=:tbl.ID'
.head 7 +  If not SqlPrepareAndExecute(hSql(), strSql)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Break
.head 7 -  ! -- put internal digital sign --
.head 7 +  If fVisaSign and GetSignOn() != 0 and tbl.REF and not bPutSignMode ! подпись n
.head 8 -  ! Наложить подпись  !
.head 8 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 9 +  If cDoc.sDocInt(99, nSepVisa)
.head 10 +  If not cDoc.PutVis(nSepVisa, 2)
.head 11 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось записать визу!')
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Break
.head 9 +  Else
.head 10 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось подписать визу!')
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Break
.head 8 +  Else
.head 9 +  If not cDoc.sDocVisa()
.head 10 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось подписать визу!')
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Break
.head 9 +  Else
.head 10 -  ! Записать в OPER_VISA !
.head 10 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    chk=rtrim(chk) || '" || sChk || "'
   WHERE  ref=:tbl.REF")
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Break
.head 10 -  Call SqlSetLongBindDatatype(5, BLOB_BYTE)
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status,keyid,sign)
   VALUES (:tbl.REF,sysdate,:nUserId,:nSepVisa,2,:strKeyId,:cDoc.m_lsSign)')
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Break
.head 7 +  Else If not fVisaSign and tbl.REF and not bPutSignMode ! не накладывать ЭЦП на визу
.head 8 -  ! Записать в OPER_VISA !
.head 8 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    chk=rtrim(chk) || '" || sChk || "'
   WHERE  ref=:tbl.REF")
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Break
.head 8 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status)
   VALUES (:tbl.REF,sysdate,:nUserId,:nSepVisa,2)')
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Break
.head 7 +  Else If bPutSignMode and GetSignOn() != 0 and tbl.REF ! надо подписать сам документ (для Сбербанка)?
.head 8 -  ! доработать наложение ЭЦП на строки БИС
.head 8 -  ! Наложить подпись !
.head 8 +  If not cDoc.SetDocR(tbl.REF, TRUE)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Break
.head 8 -  Set cDoc.m_nBis = tbl.BIS
.head 8 -  Set szIDO = GetIdOper()
.head 8 -  Set cDoc.m_sOperId = szIDO
.head 8 +  If not cDoc.sDoc()
.head 9 -  Call SaveErrorToLog('Не удалось подписать документ, REF=' || SalNumberToStrX(tbl.REF, 0) || ', REC=' ||
     SalNumberToStrX(tbl.ID, 0))
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 8 -  ! Call Debug('szIDO=' || szIDO)
.head 8 -  ! Call Debug('cDoc.m_lsSign=' || cDoc.m_lsSign)
.head 8 -  ! Call DebugN(tbl.REC_A)
.head 8 -  ! модифицируем arc_rrp(id_o,sign)
.head 8 -  Call SqlSetLongBindDatatype(2, BLOB_BYTE)
.head 8 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE arc_rrp
   SET    id_o=:szIDO,sign=:cDoc.m_lsSign
   WHERE  rec=:tbl.ID')
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SaveErrorToLog('Error update arc_rrp REF=' || SalNumberToStrX(tbl.REF, 0) || ', REC=' ||
     SalNumberToStrX(tbl.ID, 0))
.head 9 -  Break
.head 8 -  ! модифицируем oper(id_o,sign,userid)
.head 8 -  ! ВАЖНО: выставить userid человека, наложившего ЭЦП
.head 8 -  Set nDBUserID = GetUserId()
.head 8 -  Call SqlSetLongBindDatatype(2, BLOB_BYTE)
.head 8 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE oper
   SET    id_o=:szIDO,sign=:cDoc.m_lsSign,userid=:nDBUserID
   WHERE  ref=:tbl.REF')
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SaveErrorToLog('Error update oper REF=' || SalNumberToStrX(tbl.REF, 0))
.head 9 -  Break
.head 8 -  ! Call Debug('BIS=' || SalNumberToStrX(tbl.BIS, 0))
.head 8 +  If tbl.BIS > 0 ! Есть строки БИС ?
.head 9 -  ! Call Debug('Есть строки БИС')
.head 9 -  ! надо их подписать
.head 9 -  ! в строках БИС (если сравнить с основной строкой)
  отличаются след. реквизиты:
  dk, s, nazn, d_rec, naznk, nazns, bis
.head 9 +  If not SqlPrepareAndExecute(hSql(), '
   SELECT rec,dk,s,nazn,d_rec,naznk,nazns,bis
   INTO   :nRecNum,:nDK,:nSUM,:szNAZN,:szD_REC,:szNAZNK,:szNAZNS,:nBIS
   FROM   arc_rrp
   WHERE  fn_a=:tbl.FN_A and dat_a=:tbl.DAT_A and bis>1 and rec_a-bis=' || Str(tbl.REC_A-tbl.BIS) || ' AND
          ref IS NULL
   ORDER BY bis
   FOR UPDATE OF id_o,sign NOWAIT')
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SaveErrorToLog('Error SELECT FROM ARC_RRP')
.head 10 -  Break
.head 9 +  While SqlFetchNext(hSql(), nRes)
.head 10 -  ! устанавливаем переменные БИС-строки
.head 10 -  Set cDoc.m_nDk = nDK
.head 10 -  Set cDoc.A.S = nSUM
.head 10 +  If GetGlobalOptionEx('SEPNUM') = 2
.head 11 -  Set cDoc.m_sNazn = szNAZN
.head 11 -  Set cDoc.m_sDrec = szD_REC
.head 11 -  Set cDoc.m_sNaznk = szNAZNK
.head 11 -  Set cDoc.m_sNazns = szNAZNS
.head 10 +  Else
.head 11 -  Set cDoc.m_sNazn = StrDosToWinX(szNAZN)
.head 11 -  Set cDoc.m_sDrec = StrDosToWinX(szD_REC)
.head 11 -  Set cDoc.m_sNaznk = StrDosToWinX(szNAZNK)
.head 11 -  Set cDoc.m_sNazns = StrDosToWinX(szNAZNS)
.head 10 -  Set cDoc.m_nBis = nBIS
.head 10 -  ! Call Debug('BIS=' || SalNumberToStrX(nBIS, 0))
.head 10 +  If not cDoc.sDoc()
.head 11 -  Call SaveErrorToLog('Не удалось подписать документ, REF=' || SalNumberToStrX(tbl.REF, 0) || ', REC=' ||
     SalNumberToStrX(nRecNum, 0))
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Return FALSE
.head 10 -  ! модифицируем arc_rrp(id_o,sign)
.head 10 -  Call SqlSetLongBindDatatype(2, BLOB_BYTE)
.head 10 +  If not SqlPrepareAndExecute(hSqlAux(), '
   UPDATE arc_rrp
   SET    id_o=:szIDO,sign=:cDoc.m_lsSign
   WHERE  rec=:nRecNum')
.head 11 -  Call SqlRollback(hSqlAux())
.head 11 -  Call SaveErrorToLog('Error update arc_rrp REF=' || SalNumberToStrX(tbl.REF, 0) || ', REC=' ||
     SalNumberToStrX(nRecNum, 0))
.head 11 -  Break
.head 9 -  ! Call Debug('FETCH_RES='|| SalNumberToStrX(nRes, 0))
.head 9 +  If FETCH_EOF != nRes
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SaveErrorToLog('Error FETCH from ARC_RRP')
.head 10 -  Break
.head 7 -  ! -- put internal digital sign --
.head 7 +  If not SqlCommitEx(hSql(), 'Разблокирование документа СЭП: ' || strRec)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Break
.head 7 -  !
.head 7 -  Call SaveFInfoToLog('Док # (' || strRec || ') - РАЗБЛОКИРОВАН')
.head 7 -  Call MtrLogOpen(TRUE, tbl.BLK)
.head 7 -  Call MtrLogWrite(MTR_LOG_Accept, tbl.MFOA, tbl.NLSA, tbl.MFOB, tbl.NLSB, tbl.S, tbl.DK, tbl.NAZN, tbl.BLK, strRec)
.head 7 -  Call MtrLogClose()
.head 7 -  Set dfNumSelect = dfNumSelect - 1
.head 7 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 5 -  ! Set nRow = TBL_MinRow
.head 5 +  ! While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblDeleteRow(tbl, nRow, TBL_Adjust)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 5 +  If b131313
.head 6 -  Call SalMessageBox('Документы с кодом 131313 могут разблокировать только ответственные лица по Фин. Мониторингу!',
     'Сообщение', 0)
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: UnlockSepDocsTo902
.head 4 -  Description: Разблокировать документы СЭП до выяснения (MIK)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTable
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  Number: nRow
.head 5 -  Number: nErr
.head 5 -  Number: nSos
.head 5 -  ! String: strKeyId
.head 5 -  String: sMode
.head 5 -  String: sTTadd
.head 5 -  String: sSadd
.head 5 -  String: sS2add
.head 5 -  Number: nSA
.head 5 -  Number: nSB
.head 5 -  ! Long String: lsSIGN
.head 4 +  Actions
.head 5 +  If fVisaSign AND nSepVisa = 0
.head 6 -  Call MessageErrorEx('Не указано значение SEPVISA в таблице PARAMS!')
.head 6 -  Return FALSE
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If (tbl.MFOA != aMfo) or (tbl.MFOA = aMfo and bShow902)
.head 7 -  Set sErrTxt = '' ! STRING_Null
.head 7 -  Set strRec = Str(tbl.ID)
.head 7 +  If tbl.DK = 0 or tbl.DK = 1
.head 8 +  If not bMisys
.head 9 -  Call GetT00_902(tbl.MFOA, tbl.DK, tbl.KV, tbl.BLK, sTmp, sNls, sTTadd)
.head 7 +  Else
.head 8 -  Call MessageErrorEx('Неплатежный документ <<До выяснения>> - не помещаем. Зап:' || strRec)
.head 8 -  Break
.head 7 -  Call WaitCursorOn()
.head 7 +  While TRUE
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
'SELECT rec INTO :nFetchRes
   FROM arc_rrp
  WHERE rec=:tbl.ID and blk=:tbl.BLK
    FOR UPDATE OF blk NOWAIT')
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set sErrTxt = 'Невозможно получить доступ к REC #' || strRec
.head 9 -  Break
.head 8 +  If bMisys
.head 9 -  Set sTmp = '. Зараховано по Б/П № ' || Str(tbl.BLK)
.head 9 +  If tbl.BLK = 1111
.head 10 -  Set sMode = '1'
.head 9 +  Else
.head 10 -  Set sMode = '2'
.head 9 +  If SqlPLSQLCommand(hSql(), "sep.sep2bmrs(sMode,tbl.ID,tbl.MFOA,tbl.NLSA,tbl.MFOB,tbl.NLSB,tbl.DK,tbl.S*100,6,
   tbl.ND,980,tbl.DATD,dDat,tbl.NAM_A,tbl.NAM_B,tbl.NAZN,sTmp,tbl.ID_B,tbl.ID_A,tbl.REF_A,dDat,tbl.BIS,tbl.FN_A,
   tbl.REC_A,nErr)")
.head 10 +  If nErr = 0
.head 11 +  If tbl.BIS
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE arc_rrp
   SET    ref=:cDoc.m_nRef,dat_b=:dDat,sos=5,blk=0
   WHERE  fn_b IS NULL and bis>0 and rec IN (SELECT rec
                                             FROM   rec_que
                                             WHERE  rec_g=:tbl.ID and rec_g IS NOT NULL)')
.head 13 -  Set sErrTxt = 'Невозможно отметить в arc_rrp (BIS)'
.head 13 -  Break
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   rec_que
   WHERE  rec_g=:tbl.ID and rec_g IS NOT NULL')
.head 13 -  Set sErrTxt = 'Невозможно удалить из rec_que (BIS)'
.head 13 -  Break
.head 11 +  Else
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE arc_rrp
   SET    ref=:cDoc.m_nRef,dat_b=:dDat,sos=5,blk=0
   WHERE  rec=:tbl.ID and fn_b IS NULL')
.head 13 -  Set sErrTxt = 'Невозможно отметить в arc_rrp'
.head 13 -  Break
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   rec_que
   WHERE  rec=:tbl.ID')
.head 13 -  Set sErrTxt = 'Невозможно удалить из rec_que'
.head 13 -  Break
.head 11 +  If not SqlCommit(hSql())
.head 12 -  Set sErrTxt = 'Невозможно выполнить COMMIT'
.head 12 -  Break
.head 11 -  Call SaveFInfoToLog('Док #' || tbl.ND || '(' || strRec || ') - до ВЫЯСНЕНИЯ')
.head 11 -  Break
.head 10 +  Else
.head 11 -  Set sErrTxt = 'Ош. ' || Str(nErr) || ' при вызове sep2bmrs, невозможно принять до выяснения'
.head 11 -  Break
.head 9 +  Else
.head 10 -  Set sErrTxt = 'Ош.при вызове sep2bmrs'
.head 10 -  Break
.head 8 -  Else If bFinacle
.head 8 +  Else
.head 9 -  ! -- internal digital sign check --
.head 9 +  If fVisaSign and GetSignOn() != 0 and tbl.REF ! Проверка подписи n-1
.head 10 -  ! Проверить подпись !
.head 10 +  If not cDoc.SetDocR(tbl.REF, FALSE)
.head 11 -  Set sErrTxt = 'Ошибка при вызове SetDocR(' || SalNumberToStrX(tbl.REF, 0) || ')'
.head 11 -  Break
.head 10 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 11 +  If not cDoc.cDocInt(99, nSepVisa)
.head 12 +  Select Case cDoc.m_nSignErrType
.head 13 +  Case 1
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Case 2
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Default
.head 14 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 14 -  Break
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Return FALSE
.head 10 +  Else
.head 11 +  If not cDoc.CheckDocSign('CUR', 0)
.head 12 +  Select Case cDoc.m_nSignErrType
.head 13 +  Case 1
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Case 2
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Default
.head 14 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 14 -  Break
.head 9 -  ! -- internal digital sign check --
.head 9 +  If GetGlobalOptionEx('CLRTRN') and tbl.KV=980
.head 10 -  Set nSos = 8
.head 9 +  Else
.head 10 -  Set nSos = 5
.head 9 -  Call cDoc.SetDoc(tbl.REF, 'R01', tbl.DK, tbl.VOB, tbl.ND, tbl.DATD, dDat, dDat, dDat, sTmp, tbl.NAM_A, tbl.MFOA,
     '', tbl.KV, tbl.S*100, tbl.ID_A, sNls, tbl.NAM_B, tbl.MFOB, '', tbl.KV, tbl.S*100, tbl.ID_B, tbl.NAZN, '',
     GetIdOper(), '', NUMBER_Null, 0)
.head 9 -  ! Call Debug(sTmp)
.head 9 +  If cDoc.oDoc()
.head 10 +  If sTTadd
.head 11 -  Call SqlPrepareAndExecute(hSql(),
    "SELECT s,s2 INTO :sSadd,:sS2add
       FROM tts
      WHERE tt=:sTTadd")
.head 11 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 12 -  Set sErrTxt = 'Не описана операция '|| sTTadd 
.head 12 -  Break
.head 11 +  If not OurTranS(nSA, sSadd, cDoc.m_nRef, tbl.NLSA, tbl.MFOA, tbl.KV, tbl.S*100, tbl.NLSB, tbl.MFOB, tbl.KV, tbl.S*100)
.head 12 -  Set sErrTxt = 'Ошибка вычисления формулы суммы '|| sSadd
.head 12 -  Break
.head 11 +  If not OurTranS(nSB, sS2add, cDoc.m_nRef, tbl.NLSA, tbl.MFOA, tbl.KV, tbl.S*100, tbl.NLSB, tbl.MFOB, tbl.KV, tbl.S*100)
.head 12 -  Set sErrTxt = 'Ошибка вычисления формулы суммы '|| sS2add
.head 12 -  Break
.head 11 +  If not cDoc.PayTT(1, cDoc.m_nRef, cDoc.m_dDatV1, sTTadd, cDoc.m_nDk, cDoc.A.Kv, tbl.NLSA, nSA,cDoc.B.Kv, tbl.NLSB,nSB)
.head 12 -  Set sErrTxt = 'Неуспешная оплата связанной транзакции ' || sTTadd
.head 12 -  Break
.head 10 +  If bSuspR
.head 11 +  If not SqlPrepareAndExecute(hSql(),
 "INSERT INTO operw (ref,tag,value)
  VALUES (:cDoc.m_nRef,'RES92',(SELECT '"||Str(tbl.BLK)||"'||TRIM(name)
                                  FROM (SELECT nvl(trim(name),'- Бізнес правило') name
                                          FROM bp_rrp
                                         WHERE rule=:tbl.BLK
                                         UNION ALL
                                        SELECT trim(n_er)
                                          FROM s_er
                                         WHERE TRIM(k_er)=SUBSTR('0000'||:tbl.BLK,-4)
                                         UNION ALL
                                        SELECT '- Бізнес правило'
                                          FROM dual
                                         ORDER BY 1 DESC)
                                  WHERE ROWNUM=1))")
.head 12 -  Set sErrTxt = 'Невозможно вставить в OPERW'
.head 12 -  Break
.head 10 +  If bSuspBis
.head 11 -  ! Call Debug(Str(tbl.ID)||','||Str(cDoc.m_nRef))
.head 11 +  If not SqlPLSQLCommand(hSql(),"sep.bis2ref(tbl.ID,cDoc.m_nRef)")
.head 12 -  Set sErrTxt = 'Невозможно вставить в OPERW (bis)'
.head 12 -  Break
.head 10 +  If tbl.BIS
.head 11 +  If not SqlPrepareAndExecute(hSql(), 
  'UPDATE arc_rrp
      SET ref=:cDoc.m_nRef,dat_b=:dDat,sos=:nSos,blk=0
    WHERE fn_b IS NULL and bis>0 
      AND rec IN (SELECT rec FROM rec_que WHERE rec_g=:tbl.ID and rec_g IS NOT NULL)')
.head 12 -  Set sErrTxt = 'Невозможно отметить в arc_rrp (BIS)'
.head 12 -  Break
.head 11 +  If not SqlPrepareAndExecute(hSql(),
  'DELETE FROM rec_que WHERE  rec_g=:tbl.ID and rec_g IS NOT NULL')
.head 12 -  Set sErrTxt = 'Невозможно удалить из rec_que (BIS)'
.head 12 -  Break
.head 10 +  Else
.head 11 +  If not SqlPrepareAndExecute(hSql(), 
  'UPDATE arc_rrp
      SET ref=:cDoc.m_nRef,dat_b=:dDat,sos=:nSos,blk=0
    WHERE rec=:tbl.ID and fn_b IS NULL')
.head 12 -  Set sErrTxt = 'Невозможно отметить в arc_rrp'
.head 12 -  Break
.head 11 +  If not SqlPrepareAndExecute(hSql(),
  'DELETE FROM rec_que WHERE  rec=:tbl.ID')
.head 12 -  Set sErrTxt = 'Невозможно удалить из rec_que'
.head 12 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), IifS(bBlk902,
 'INSERT INTO t902 (ref,rec,blk) VALUES (:cDoc.m_nRef,:tbl.ID,:tbl.BLK)',
 'INSERT INTO t902 (ref,rec) VALUES (:cDoc.m_nRef,:tbl.ID)'))
.head 11 -  Set sErrTxt = 'Невозможно вставить в t902'
.head 11 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), 
  'UPDATE oper
      SET (nlsa,nlsb,d_rec,id_o,sign)=
  (SELECT nlsa,nlsb,d_rec,id_o,sign FROM arc_rrp WHERE rec=:tbl.ID)
    WHERE ref=:cDoc.m_nRef')
.head 11 -  Set sErrTxt = 'Невозможно обновить OPER'
.head 11 -  Break
.head 10 -  ! -- put internal digital sign  --
.head 10 +  If fVisaSign and GetSignOn() != 0 and cDoc.m_nRef ! подпись n
.head 11 -  ! Наложить подпись !
.head 11 +  If not cDoc.SetDocR(cDoc.m_nRef, TRUE)
.head 12 -  Set sErrTxt = 'Ошибка при вызове SetDocR(' || SalNumberToStrX(tbl.REF, 0) || ')'
.head 12 -  Break
.head 11 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 12 +  If cDoc.sDocInt(99, nSepVisa)
.head 13 +  If not cDoc.PutVis(nSepVisa, 2)
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось записать визу!')
.head 14 -  Call SqlRollback(hSql())
.head 14 -  Break
.head 12 +  Else
.head 13 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось подписать визу!')
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Break
.head 11 +  Else
.head 12 +  If not cDoc.sDocVisa()
.head 13 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось подписать визу!')
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Return FALSE
.head 12 -  ! Записать в OPER_VISA !
.head 12 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    chk=rtrim(chk) || '" || sChk || "'
   WHERE  ref=:cDoc.m_nRef")
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Break
.head 12 -  Call SqlSetLongBindDatatype(5, BLOB_BYTE)
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status,keyid,sign)
   VALUES (:cDoc.m_nRef,sysdate,:nUserId,:nSepVisa,2,:strKeyId,:cDoc.m_lsSign)')
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Break
.head 10 +  Else If not fVisaSign and cDoc.m_nRef
.head 11 -  ! Записать в OPER_VISA !
.head 11 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    chk=rtrim(chk) || '" || sChk || "'
   WHERE  ref=:cDoc.m_nRef")
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Break
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status)
   VALUES (:cDoc.m_nRef,sysdate,:nUserId,:nSepVisa,2)')
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Break
.head 10 -  ! -- put internal digital sign --
.head 10 +  If not SqlCommit(hSql())
.head 11 -  Set sErrTxt = 'Невозможно выполнить COMMIT'
.head 11 -  Break
.head 10 -  Call SaveFInfoToLog('Док #' || Str(cDoc.m_nRef) || '(' || strRec || ') - до ВЫЯСНЕНИЯ')
.head 10 -  Break
.head 9 +  Else
.head 10 -  Set sErrTxt = 'Ош. оплаты при помещении до выяснения'
.head 10 -  Break
.head 8 -  Break
.head 7 +  If sErrTxt
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx(sErrTxt || '. Зап:' || strRec)
.head 7 -  Call WaitCursorOff()
.head 7 -  Call MtrLogOpen(TRUE, tbl.BLK)
.head 7 -  Call MtrLogWrite(MTR_LOG_Accept,tbl.MFOA,tbl.NLSA,tbl.MFOB,tbl.NLSB,tbl.S,tbl.DK,tbl.NAZN,tbl.BLK,strRec)
.head 7 -  Call MtrLogClose()
.head 6 -  Set dfNumSelect = dfNumSelect - 1
.head 6 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblDeleteRow(tbl, nRow, TBL_Adjust)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: LockSepDocs
.head 4 -  Description: Вернуть документы СЭП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  String: strRef
.head 5 -  String: sTmp
.head 5 -  Number: nRow
.head 5 -  Number: nErr
.head 5 -  ! Number: nUserId
.head 5 -  ! String: strKeyId
.head 5 -  ! String: sChk
.head 5 -  String: sNls
.head 5 -  String: sMfo
.head 5 -  String: sNlsp
.head 5 -  Number: nS
.head 5 -  String: sNd
.head 5 -  String: sText1
.head 5 -  String: sPond
.head 5 -  String: sNaex
.head 5 -  String: sNaimp
.head 5 -  Number: nEom
.head 5 -  String: sSab0
.head 5 -  String: sOper
.head 5 -  String: AMFO
.head 4 +  Actions
.head 5 +  If nReasonId > 0
.head 6 +  If fVisaSign and nSepVisa = 0
.head 7 -  Call MessageErrorEx('Не указано значение SEPVISA в таблице PARAMS!')
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblFetchRow(tbl, nRow)
.head 7 +  If tbl.MFOA = aMfo
.head 8 -  Set strRec = Str(tbl.ID)
.head 8 -  Set strRef = Str(tbl.REF)
.head 8 -  Set sTmp = SalStrTrimX(Left('Повернено.' || sReason, 160))
.head 8 -  Call WaitCursorOn()
.head 8 -  Set sErrTxt = '' ! STRING_Null
.head 8 +  While TRUE ! Средства - возвращаем, документ блокируем
.head 9 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT rec
     INTO   :nFetchRes
     FROM   arc_rrp
     WHERE  rec=:tbl.ID and blk=:tbl.BLK
     FOR UPDATE OF blk NOWAIT")
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set sErrTxt = 'Невозможно получить доступ к REC.' || strRec
.head 10 -  Break
.head 9 -  ! -- internal digital sign check --
.head 9 +  If fVisaSign and GetSignOn() != 0 and tbl.REF ! Проверка подписи n-1
.head 10 -  ! Проверить подпись !
.head 10 -  Call cDoc.SetDocR(tbl.REF, TRUE)
.head 10 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 11 +  If not cDoc.cDocInt(99, nSepVisa)
.head 12 +  Select Case cDoc.m_nSignErrType
.head 13 +  Case 1
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Case 2
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Default
.head 14 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 14 -  Break
.head 12 +  If IDNO = SalMessageBox('Внутренняя ЭЦП неверна. Продолжить возврат документа?', 'Возврат документа',
   MB_YesNo)
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Return FALSE
.head 10 +  Else
.head 11 +  If not cDoc.CheckDocSign('CUR', 0)
.head 12 +  Select Case cDoc.m_nSignErrType
.head 13 +  Case 1
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Case 2
.head 14 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) ||
     ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.REF, 0) || ']!')
.head 14 -  Break
.head 13 +  Default
.head 14 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || '-Нерасчетный код возврата!')
.head 14 -  Break
.head 9 -  ! -- internal digital sign check --
.head 9 +  If bMisys
.head 10 -  Set sTmp = 'Rejected by SEP interface. Errcode ' || Str(tbl.BLK)
.head 10 +  If not SqlPLSQLCommand(hSql(), "sep.sep2bmrs('R',tbl.ID,tbl.MFOB,tbl.NLSB,tbl.MFOA,tbl.NLSA,tbl.DK,tbl.S*100,
   6,tbl.ND,980,tbl.DATD,dDat,tbl.NAM_B,tbl.NAM_A,sTmp,'',tbl.ID_B,tbl.ID_A,tbl.REF_A,dDat,0,'',NUMBER_Null,
   nErr)")
.head 11 -  Set sErrTxt = 'Ош.при вызове sep2bmrs'
.head 11 -  Break
.head 10 +  If nErr > 0
.head 11 -  Set sErrTxt = 'Ош. ' || Str(nErr) ||' при вызове sep2bmrs, невозможно вернуть документ'
.head 11 -  Break
.head 9 -  Else If bFinacle
.head 9 +  Else
.head 10 +  If tbl.REF
.head 11 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   operw (ref,tag,value)
   VALUES (:tbl.REF,'BACKR',:sTmp)")
.head 12 -  Set sErrTxt = 'Невозможно вставить в OPERW'
.head 12 -  Break
.head 11 +  If not Pay_Bck(tbl.REF, 5, '')
.head 12 -  Set sErrTxt = 'Ош.при вызове pay_bck'
.head 12 -  Break
.head 11 +  If not SqlPLSQLCommand(hSql(), "chk.put_nos(tbl.REF,nSepVisa)")
.head 12 -  Set sErrTxt = 'Ош.при вызове chk.put_nos()'
.head 12 -  Break
.head 9 -  ! Убрали этот атавизм
.head 9 +  ! If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   bp_back (rec_in,rec_out,id,userid)
   VALUES (:tbl.ID,:tbl.ID,:nReasonId,USER_ID)')
.head 10 -   Set sErrTxt = 'Невозможно вставить в bp_back'
.head 10 -   Break 
.head 9 +  If tbl.BIS
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE arc_rrp
   SET    blk=-1
   WHERE fn_b IS NULL and bis>0 and rec IN (SELECT rec
                                            FROM   rec_que
                                            WHERE  rec_g=:tbl.ID and rec_g IS NOT NULL)')
.head 11 -  Set sErrTxt = 'Невозможно отметить в arc_rrp (BIS)'
.head 11 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   rec_que
   WHERE  rec_g=:tbl.ID and rec_g IS NOT NULL')
.head 11 -  Set sErrTxt = 'Невозможно удалить из rec_que (BIS)'
.head 11 -  Break
.head 9 +  Else
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   UPDATE arc_rrp
   SET    blk=-1
   WHERE  rec=:tbl.ID and fn_b IS NULL')
.head 11 -  Set sErrTxt = 'Невозможно отметить в arc_rrp'
.head 11 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   rec_que
   WHERE  rec=:tbl.ID')
.head 11 -  Set sErrTxt = 'Невозможно удалить из rec_que'
.head 11 -  Break
.head 9 +  ! If not SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   ref_lst
   WHERE  (DATD,ND,MFOA,NLSA,MFOB,NLSB,S) IN (SELECT DATD,ND,MFOA,NLSA,MFOB,NLSB,S
                                              FROM   arc_rrp
                                              WHERE rec=:tbl.ID)')
.head 10 -  Set sErrTxt = 'Невозможно удалить из ref_lst'
.head 10 -  Break 
.head 9 -  ! -- put internal digital sign --
.head 9 +  If fVisaSign and GetSignOn() != 0 and tbl.REF ! подпись n
.head 10 -  ! Наложить подпись !
.head 10 +  If GetGlobalOption('INTSIGN') = '2' ! новая внутрення подпись
.head 11 +  If cDoc.sDocInt(99, nSepVisa)
.head 12 +  If not cDoc.PutVis(nSepVisa, 3)
.head 13 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось записать визу!')
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Break
.head 11 +  Else
.head 12 -  Call SaveErrorToLog('Виза группы ' || SalNumberToStrX(nSepVisa, 0) || ': Не удалось подписать визу!')
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Break
.head 10 +  Else
.head 11 +  If not cDoc.sDocVisa()
.head 12 -  Call SaveErrorToLog('Виза группы ' || Str(nSepVisa) || ': Не удалось подписать визу!')
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Break
.head 11 -  ! Записать в OPER_VISA !
.head 11 -  Call SqlSetLongBindDatatype(5, BLOB_BYTE)
.head 11 -  !
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status,keyid,sign)
   VALUES (:tbl.REF,sysdate,:nUserId,:nSepVisa,3,:strKeyId,:cDoc.m_lsSign)')
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Break
.head 9 +  Else If not fVisaSign and tbl.REF
.head 10 -  ! Записать в OPER_VISA !
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO   oper_visa (ref,dat,userid,groupid,status)
   VALUES (:tbl.REF,sysdate,:nUserId,:nSepVisa,3)')
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Break
.head 9 -  ! -- put internal digital sign --
.head 9 +  If GetGlobalOption('KL_BOB') = '0'
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   SELECT k.nls,k.mfo,k.nlsp,k.naimp,k.s,k.nd,k.text1,k.pond,k.naex,k.eom
   INTO   :sNls,:sMfo,:sNlsp,:sNaimp,:nS,:sNd,:sText1,:sPond,:sNaex,:nEom
   FROM   oper o, klp k
   WHERE  o.ref=:tbl.REF and k.ref=o.ref') and SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Set sSab0 = Subs(sNaex, 3, 4)
.head 11 -  Set sOper = Right(Str(10000+nEom), 4)
.head 11 -  Set AMFO = GetBankMfo()
.head 11 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   klpoow (sab,oper,mfoa,nlsa,mfob,nlsb,namb,s,nd,nazn,pond,prwo,nfia,tip)
   VALUES (:sSab0,:sOper,:AMFO,:sNls,:sMfo,:sNlsp,:sNaimp,:nS,:sNd,:sText1,:sPond,:sTmp,:sNaex,'W')") or
   not SqlPrepareAndExecute(hSql(), "
   UPDATE klp
   SET    fl=9
   WHERE  ref=:tbl.REF")
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Set sErrTxt = 'Ошибка формирования возврата по КЛИЕНТ-БАНК'
.head 12 -  Break
.head 9 +  If not SqlCommit(hSql())
.head 10 -  Set sErrTxt = 'Невозможно выполнить COMMIT'
.head 10 -  Break
.head 9 -  ! Формируем файл-квитанцию D, если нужно
.head 9 +  If nBackKvit
.head 10 +  If not KvitD(tbl.REF, strPathD)
.head 11 -  Set sErrTxt = 'Ошибка формирования квитанции D'
.head 11 -  Break
.head 9 -  !
.head 9 +  If (Left(GetBankMfo(), 1) = '8' or GetGlobalOption('NBUBANK') = '1') and
   Subs(tbl.FN_A, 3, 4) != ''
.head 10 +  If not Back2MonKB(sBackDocPath, Subs(tbl.FN_A, 3, 4), tbl.VOB, tbl.S*100, tbl.ND, tbl.NLSA, tbl.MFOA,
   tbl.NLSB, tbl.MFOB, '', tbl.NAM_B, tbl.NAZN, sReason, tbl.REF_A)
.head 11 -  Set sErrTxt = 'Невозможно создать квитанцию о возврате на ' || Subs(tbl.FN_A, 3, 4)
.head 11 -  Break
.head 9 -  Call SaveFInfoToLog('Док #' || strRef || '(' || strRec || ') ВОЗВРАЩЕН. (BLK=' || Str(tbl.BLK) || ')')
.head 9 -  Set bRollback = FALSE
.head 9 -  Break
.head 8 +  If sErrTxt
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call MessageErrorEx(sErrTxt || '. Док #:' || strRef)
.head 8 -  Call WaitCursorOff()
.head 8 -  Call MtrLogOpen(FALSE, tbl.BLK)
.head 8 -  Call MtrLogWrite(MTR_LOG_Reject, tbl.MFOA, tbl.NLSA, tbl.MFOB, tbl.NLSB, tbl.S, tbl.DK, tbl.NAZN, tbl.BLK, strRec)
.head 8 -  Call MtrLogClose()
.head 7 -  Set dfNumSelect = dfNumSelect - 1
.head 7 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 6 -  ! Set bDel = TRUE ! для Do details
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblDeleteRow(tbl, nRow, TBL_Adjust)
.head 7 -  Call SalTblFetchRow(tbl, nRow)
.head 6 -  ! Set bDel = FALSE
.head 6 -  Call WaitCursorOff()
.head 6 -  Return TRUE
.head 3 +  Function: DelZap   ! Удалить запрос
.head 4 -  Description: Удалить запрос
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  String: strRef
.head 5 -  String: sTmp
.head 5 -  Number: nRow
.head 5 -  Number: nErr
.head 5 -  ! Number: nUserId
.head 5 -  ! String: strKeyId
.head 5 -  ! String: sChk
.head 5 -  String: sNls
.head 5 -  String: sMfo
.head 5 -  String: sNlsp
.head 5 -  Number: nS
.head 5 -  String: sNd
.head 5 -  String: sText1
.head 5 -  String: sPond
.head 5 -  String: sNaex
.head 5 -  String: sNaimp
.head 5 -  Number: nEom
.head 5 -  String: sSab0
.head 5 -  String: sOper
.head 5 -  String: AMFO
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If tbl.DK = 2 or tbl.DK = 3
.head 7 -  Set strRec = Str(tbl.ID)
.head 7 -  Set strRef = Str(tbl.REF)
.head 7 -  Set sTmp = SalStrTrimX(Left('Вилучено. Код блокування: ' || Str(tbl.BLK), 160))
.head 7 -  Call WaitCursorOn()
.head 7 -  Set sErrTxt = '' ! STRING_Null
.head 7 +  While TRUE ! Средства - возвращаем, документ блокируем
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT rec INTO :nFetchRes FROM arc_rrp 
  WHERE rec=:tbl.ID and blk=:tbl.BLK 
  FOR UPDATE OF blk NOWAIT")
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sErrTxt = 'Невозможно получить доступ к REC.' || strRec
.head 9 -  Break
.head 8 +  If tbl.BIS
.head 9 +  If not SqlPrepareAndExecute(hSql(),
'UPDATE arc_rrp SET blk=-1 WHERE fn_b IS NULL AND bis>0 
    AND rec IN (SELECT rec FROM rec_que WHERE rec_g=:tbl.ID and rec_g IS NOT NULL)')
.head 10 -  Set sErrTxt = 'Невозможно отметить в arc_rrp (BIS)'
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 'DELETE FROM rec_que WHERE rec_g=:tbl.ID and rec_g IS NOT NULL')
.head 10 -  Set sErrTxt = 'Невозможно удалить из rec_que (BIS)'
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 'DELETE FROM tzapros WHERE rec_g=:tbl.ID and rec_g IS NOT NULL')
.head 10 -  Set sErrTxt = 'Невозможно удалить из tzapros (BIS)'
.head 10 -  Break
.head 8 +  Else
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 'UPDATE arc_rrp SET blk=-1 WHERE rec=:tbl.ID and fn_b IS NULL')
.head 10 -  Set sErrTxt = 'Невозможно отметить в arc_rrp'
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 'DELETE FROM rec_que WHERE rec=:tbl.ID')
.head 10 -  Set sErrTxt = 'Невозможно удалить из rec_que'
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 'DELETE FROM tzapros WHERE rec=:tbl.ID')
.head 10 -  Set sErrTxt = 'Невозможно удалить из tzapros'
.head 10 -  Break
.head 8 +  If not SqlCommit(hSql())
.head 9 -  Set sErrTxt = 'Невозможно выполнить COMMIT'
.head 9 -  Break
.head 8 -  Call SaveFInfoToLog('Док #' || strRef || '(' || strRec || ') Вилучено. (BLK=' || Str(tbl.BLK) || ')')
.head 8 -  Set bRollback = FALSE
.head 8 -  Break
.head 7 +  If sErrTxt
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx(sErrTxt || '. Док #:' || strRef)
.head 7 -  Call WaitCursorOff()
.head 7 -  Call MtrLogOpen(FALSE, tbl.BLK)
.head 7 -  Call MtrLogWrite(MTR_LOG_Reject, tbl.MFOA, tbl.NLSA, tbl.MFOB, tbl.NLSB, tbl.S, tbl.DK, tbl.NAZN, tbl.BLK, strRec)
.head 7 -  Call MtrLogClose()
.head 6 -  Set dfNumSelect = dfNumSelect - 1
.head 6 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblDeleteRow(tbl, nRow, TBL_Adjust)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: ToSwift  ! Направить в свифт
.head 4 -  Description: На свифт
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  String: strRef
.head 5 -  String: sTmp
.head 5 -  Number: nRow
.head 5 -  Number: nErr
.head 5 -  ! Number: nUserId
.head 5 -  ! String: strKeyId
.head 5 -  ! String: sChk
.head 5 -  String: sNls
.head 5 -  String: sMfo
.head 5 -  String: sNlsp
.head 5 -  Number: nS
.head 5 -  String: sNd
.head 5 -  String: sText1
.head 5 -  String: sPond
.head 5 -  String: sNaex
.head 5 -  String: sNaimp
.head 5 -  Number: nEom
.head 5 -  String: sSab0
.head 5 -  String: sOper
.head 5 -  String: AMFO
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 6 +  If tbl.DK = 1
.head 7 -  Set strRec = Str(tbl.ID)
.head 7 -  Set strRef = Str(tbl.REF)
.head 7 -  Set sTmp = SalStrTrimX(Left('На SWIFT. Код блокування: ' || Str(tbl.BLK), 160))
.head 7 -  Call WaitCursorOn()
.head 7 -  Set sErrTxt = '' ! STRING_Null
.head 7 +  While TRUE !  Платим на свіфтовий транзит
.head 8 +  If not SqlPLSQLCommand(hSql(), "sep.sep2swt(tbl.ID)")
.head 9 -  Set sErrTxt = 'Невозможно получить доступ к REC.' || strRec
.head 9 -  Break
.head 8 +  If not SqlCommit(hSql())
.head 9 -  Set sErrTxt = 'Невозможно выполнить COMMIT'
.head 9 -  Break
.head 8 -  Call SaveFInfoToLog('Док #' || strRef || '(' || strRec || ') на SWIFT. (BLK=' || Str(tbl.BLK) || ')')
.head 8 -  Set bRollback = FALSE
.head 8 -  Break
.head 7 +  If sErrTxt
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx(sErrTxt || '. Док #:' || strRef)
.head 7 -  Call WaitCursorOff()
.head 6 -  Set dfNumSelect = dfNumSelect - 1
.head 6 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblDeleteRow(tbl, nRow, TBL_Adjust)
.head 6 -  Call SalTblFetchRow(tbl, nRow)
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: ReSign   ! Переподписать
.head 4 -  Description: Скрытая переподписалка на всякий случай
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  String: sErrTxt
.head 5 -  ! cDoc: cDoc
.winattr class :
.head 6 -  Class: cDoc
.end
.head 5 -  Number: nWaitSign
.head 5 -  ! String: sSql
.head 5 -  Long String: sSql 
.head 4 +  Actions
.head 5 -  Call SalTimerKill(hWndMDI, 6)
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set cDoc.m_sOperId=GetIdOper()
.head 5 -  Set nWaitSign = GetWaitSign()
.head 5 -  Set g_nTim = IifN(nWaitSign<=0, 5, nWaitSign) ! 5
.head 5 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext( tbl, nRow )
.head 6 -  Call SalTblSetFocusRow(tbl, nRow )
.head 6 -  ! Лочим запись чтоб другие на схватили :cDoc.m_sOperId
.head 6 -  Set sSql="SELECT rec,ref,mfoa,nlsa,nam_a,id_a,
                 mfob,nlsb,nam_b,id_b,
          dk,s,vob,nd,kv,datd,datp,nazn,d_rec,naznk,nazns,ref_a,bis
   INTO :cDoc.m_nRec,:cDoc.m_nRef,
        :cDoc.A.Bank,:cDoc.A.Nls,:cDoc.A.Nam,:cDoc.A.Okpo,
        :cDoc.B.Bank,:cDoc.B.Nls,:cDoc.B.Nam,:cDoc.B.Okpo,
        :cDoc.m_nDk, :cDoc.A.S,:cDoc.m_nVob,:cDoc.m_sNd,:cDoc.A.Kv,
        :cDoc.m_dDatD,:cDoc.m_dDatP,
        :cDoc.m_sNazn,:cDoc.m_sDrec,:cDoc.m_sNaznk,:cDoc.m_sNazns,
        :cDoc.m_sRef_A,:cDoc.m_nBis
   FROM arc_rrp 
  WHERE "||
IifS(tbl.BIS>0,
" bis>0 AND rec IN (SELECT rec FROM rec_que WHERE rec_g=:tbl.ID AND rec_g IS NOT NULL)",
" rec=:tbl.ID")||
" FOR UPDATE OF id_o,sign,blk NOWAIT "
.head 6 +  If SqlPrepareAndExecute(hSqlAux2(), sSql)
.head 7 +  While SqlFetchNext(hSqlAux2(),nFetchRes)
.head 8 +  If not cDoc.sDoc()
.head 9 -  Set sErrTxt = 'Не вдалося підписати документ'
.head 9 -  Break
.head 8 +  If not SqlSetLongBindDatatype(1, BLOB_BYTE)
.head 9 -  Set sErrTxt = 'Неможливо відмітити в arc_rrp'
.head 9 -  Break
.head 8 +  If not SqlPrepareAndExecute(hSql(),
 "UPDATE arc_rrp SET sign=:cDoc.m_lsSign,id_o=:cDoc.m_sOperId,blk=0 WHERE rec=:cDoc.m_nRec")
.head 9 -  Set sErrTxt = 'Неможливо відмітити в arc_rrp'
.head 9 -  Break
.head 6 +  Else
.head 7 -  Set sErrTxt = 'Не удалось получить доступ к rec#||Str(tbl.ID)'
.head 6 +  If sErrTxt
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call MessageErrorEx(sErrTxt || '. Rec #:' || Str(tbl.ID))
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SaveFInfoToLog('Док #' || Str(tbl.ID) || ' перепідписано. (Key=' || cDoc.m_sOperId || ')')
.head 6 -  Set dfNumSelect = dfNumSelect - 1
.head 6 -  Set dfSumSelect = dfSumSelect - tbl.S
.head 5 -  Call WaitCursorOff()
.head 5 -  Call MessageInfoEx('Готово.')
.head 5 -  Return TRUE
.head 3 +  Function: MtrLogOpen
.head 4 -  Description: Открыть LOG-файл контроля работы Контроллера банка
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 5 -  Number: nBlk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If nMode = TRUE
.head 6 -  Set strFileName = GetLogDir() || '\\' || MTR_LOGFILE_OK || Right('000' || Str(nBlk), 3)
.head 5 +  Else
.head 6 -  Set strFileName = GetLogDir() || '\\' || MTR_LOGFILE_BAD || Right('000' || Str(nBlk), 3)
.head 5 +  If not SalFileOpen(hMtrFile, strFileName, OF_Exist)
.head 6 -  Call SalFileOpen(hMtrFile, strFileName, OF_Create | OF_Text | OF_Write | OF_Append | OF_Share_Deny_None)
.head 5 +  Else
.head 6 -  Call SalFileOpen(hMtrFile, strFileName, OF_Text | OF_Write | OF_Append | OF_Share_Deny_None)
.head 3 +  Function: MtrLogWrite
.head 4 -  Description: Сохраняет информацию в LOG-файле контроля работы Контроллера банка
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nWorkMode
.head 5 -  String: strMFOA
.head 5 -  String: strNLSA
.head 5 -  String: strMFOB
.head 5 -  String: strNLSB
.head 5 -  Number: nS
.head 5 -  Number: nDK
.head 5 -  String: strNAZN
.head 5 -  Number: nBLK
.head 5 -  String: strRec
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTmpStr
.head 4 +  Actions
.head 5 +  If GetGlobalOptionEx('SEPNUM') = 2
.head 6 -  Set strTmpStr = SalFmtFormatDateTime(SalDateCurrent(), ddMMyy() || ' hhh:mm:ss') || ' ' || strUserLogin || ' ' ||
    'Код блокировки документа: ' || Str(nBLK) || ' ' || ' Входящий: ' || strRec
.head 6 -  Call SalFilePutStr(hMtrFile, strTmpStr)
.head 6 -  Set strTmpStr = '     МФО А  : ' || strMFOA || '     МФО Б  : ' || strMFOB || '     Сумма: ' ||
    SalNumberToStrX(nS, 2)
.head 6 -  Call SalFilePutStr(hMtrFile, strTmpStr)
.head 6 -  Set strTmpStr = '     Счет А: ' || Right(Spac(16) || strNLSA, 16) || ' Счет Б: ' || Right(Spac(16) || strNLSB, 16) ||
    ' Дб/Кр: ' || Str(nDK)
.head 6 -  Call SalFilePutStr(hMtrFile, strTmpStr)
.head 6 -  Set strTmpStr = '     Назначение: ' || strNAZN
.head 6 -  Call SalFilePutStr(hMtrFile, strTmpStr)
.head 6 +  If nWorkMode = MTR_LOG_Reject
.head 7 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT reason
     FROM   Bp_reason
     INTO   :strTmpStr
     WHERE  id=:nReasonId'))
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set strTmpStr = '     Причина возврата: ' || strTmpStr
.head 7 -  Call SalFilePutStr(hMtrFile, strTmpStr)
.head 5 +  Else
.head 6 -  Set strTmpStr = SalFmtFormatDateTime(SalDateCurrent(), ddMMyy() || ' hhh:mm:ss') || ' ' || strUserLogin || ' ' ||
    'Код блокировки документа: ' || Str(nBLK) || ' ' || ' Входящий: ' || strRec
.head 6 -  Call SalFilePutStr(hMtrFile, StrWinToDosX(strTmpStr))
.head 6 -  Set strTmpStr = '     МФО А  : ' || strMFOA || '     МФО Б  : ' || strMFOB || '     Сумма: ' || SalNumberToStrX(nS, 2)  
.head 6 -  Call SalFilePutStr(hMtrFile, StrWinToDosX(strTmpStr))
.head 6 -  Set strTmpStr = '     Счет А: ' || Right(Spac(16) || strNLSA, 16) || ' Счет Б: ' || Right(Spac(16) || strNLSB, 16) ||
    ' Дб/Кр: ' || Str(nDK)
.head 6 -  Call SalFilePutStr(hMtrFile, StrWinToDosX(strTmpStr))
.head 6 -  Set strTmpStr = '     Назначение: ' || strNAZN
.head 6 -  Call SalFilePutStr(hMtrFile, StrWinToDosX(strTmpStr))
.head 6 +  If nWorkMode = MTR_LOG_Reject
.head 7 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT reason
     FROM   Bp_reason
     INTO   :strTmpStr
     WHERE  id=:nReasonId'))
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set strTmpStr = '     Причина возврата: ' || strTmpStr
.head 7 -  Call SalFilePutStr(hMtrFile, StrWinToDosX(strTmpStr))
.head 3 +  Function: MtrLogClose
.head 4 -  Description: Закрыть LOG-файл контроля работы Контроллера банка
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalFileClose(hMtrFile)
.head 3 +  Function: Back2MonKB
.head 4 -  Description: создание файла возвращенных документов КБ
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sPath
.head 5 -  String: sSAB
.head 5 -  Number: nVOB
.head 5 -  Number: nS
.head 5 -  String: sND
.head 5 -  String: sNLSA
.head 5 -  String: sMFOA
.head 5 -  String: sNLSB
.head 5 -  String: sMFOB
.head 5 -  String: sKOKB
.head 5 -  String: sKORR
.head 5 -  String: sNAZN
.head 5 -  String: sPRWO
.head 5 -  String: sPOND
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFileName
.head 5 -  File Handle: fH
.head 5 -  String: sBuffer
.head 5 -  Boolean: bNBU
.head 5 -  File Handle: hB014
.head 5 -  Number: nI
.head 4 +  Actions
.head 5 -  Set bNBU = GetGlobalOption('NBUBANK')='1'
.head 5 -  ! если есть файл ATBU_TEH.TMP, и его НЕЛЬЗЯ удалить, ЖДАТЬ, значит работает ATBU
.head 5 -  ! причём надо сначала два раза (хрен знает почему), чтобы выработался правильный код возврата !!!
.head 5 -  Set nI = VisFileDelete(sPath || '\\ATBU_TEH.TMP')
.head 5 -  Set nI = VisFileDelete(sPath || '\\ATBU_TEH.TMP')
.head 5 -  ! Call DebugN(nI)
.head 5 +  Loop
.head 6 +  If nI = -5
.head 7 -  Call MessageNoWait('Ожидайте, работает монитор КЛИЕНТ-БАНК (A' || IifS(bNBU,'N','T')|| 'BU.EXE) ...',
     'ВНИМАНИЕ !!!', nTimeWaitMessage, 1)
.head 7 -  Set nI = VisFileDelete(sPath || '\\ATBU_TEH.TMP')
.head 7 -  ! Call DebugN(nI)
.head 6 +  Else
.head 7 -  Break
.head 5 -  ! создать файл B014_TEH.TMP, если его нет,
.head 5 -  ! если есть (значит работает другой операционист) ПОДОЖДАТЬ
.head 5 +  Loop
.head 6 -  Call VisFileDelete(sPath || '\\B014_TEH.TMP')
.head 6 +  If not File(sPath || '\\B014_TEH.TMP')
.head 7 -  Call SalFileOpen(hB014, sPath || '\\B014_TEH.TMP', OF_Create | OF_Share_Deny_None)
.head 7 -  Set sFileName = sPath || '\\' || sSAB || 'TEHN.ABS'
.head 7 +  If SalFileOpen(fH, sFileName, IifN(File(sFileName), OF_Append | OF_Write, OF_Create | OF_Write))
.head 8 -  Set sBuffer = StrWinToDosX(sSAB || PadL(Str(nVOB), 2) || PadR(sND, 10) || PadL(Str(nS), 16) || PadR(sNLSA, 14) ||
    PadL(sMFOA, 9) || PadR(sNLSB,14) || PadL(sMFOB, 9) || PadR(sKOKB, 14) || PadR(sKORR, 38) || PadR(sNAZN, 160) ||
    PadR(SalFmtFormatDateTime(GetBankDate(), 'dd/MM/yy ') || sPRWO, 40) || PadR(sPOND, 9)) || PutCrLf()
.head 8 +  If SalFileWrite(fH, sBuffer, Len(sBuffer)) = Len(sBuffer)
.head 9 -  Call SalFileClose(fH)
.head 9 -  Call SalFileClose(hB014)
.head 9 -  Call VisFileDelete(sPath || '\\B014_TEH.TMP')
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Call SalFileClose(fH)
.head 9 -  Call SalFileClose(hB014)
.head 9 -  Call VisFileDelete(sPath || '\\B014_TEH.TMP')
.head 9 -  Call WaitCursorOff()
.head 9 -  Call MessageNoWait('Ошибка записи в файл ' || sFileName, 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call WaitCursorOn()
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call MessageNoWait('Ошибка открытия файла ' || sFileName, 'ВНИМАНИЕ !!!', 0, 1)
.head 8 -  Call SalFileClose(hB014)
.head 8 -  Call VisFileDelete(sPath || '\\B014_TEH.TMP')
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call MessageNoWait('Ожидайте, выполняется возврат документов другим пользователем АБС ...', 'ВНИМАНИЕ !!!',
     nTimeWaitMessage, 1)
.head 3 +  Function: Fun_SumCol
.head 4 -  Description: Сумирует SELECTED колонку
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  String: strTitle
.head 5 -  String: strSuma
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nW
.head 5 -  Number: nH
.head 4 +  Actions
.head 5 -  Call GetWindowRect(hWndForm, nX, nY, nW, nH)
.head 5 -  Call SalTblObjectsFromPoint(hWndForm, wParam-nX, lParam-nY, nH, hWndCol, nH)
.head 5 -  Set strTitle = PadR(' ', 100)
.head 5 -  Call SalTblGetColumnTitle(hWndCol, strTitle, 100)
.head 5 +  If SalIsValidNumber(hWndCol)
.head 6 -  Set nH = SalTblColumnSum(hWndForm, SalTblQueryColumnID(hWndCol), ROW_Selected, 0)
.head 6 +  If nH
.head 7 -  Set strTitle = SalStrTrimX(strTitle)
.head 7 -  Set strSuma = SalStrTrimX(SalFmtFormatNumber(nH, 'Default'))
.head 7 -  Set nH = Max(Len(strTitle), Len(strSuma))
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Yellow)
.head 7 -  Call XSalTooltipShow(hWndForm, strTitle || PutLf() || PadL(strSuma, nH))
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Function: GetT00_902
.head 4 -  Description: Получить номера счетов
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sMfoA
.head 5 -  Number: nDk
.head 5 -  Number: nKv
.head 5 -  Number: nBlk
.head 5 -  Receive String: strNlsT00
.head 5 -  Receive String: strNls902
.head 5 -  Receive String: strTTadd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: mfo
.head 4 +  Actions
.head 5 -  Set strTTadd = ''
.head 5 -  Set strNls902 = IifS(nDk=1, '902', '90D')
.head 5 +  If GetGlobalOptionEx('CLRTRN') and nKv = 980
.head 6 +  If sMfoA = aMfo
.head 7 -  Set strNlsT00 = IifS(nDk=1, 'T00', 'T0D')
.head 6 +  Else
.head 7 -  Set strNlsT00 = IifS(nDk=1, 'TO0', 'TOD')
.head 6 -  Call SqlPrepareAndExecute(hSql(), '
     SELECT mfo
     INTO   :mfo
     FROM   banks
     WHERE  mfop=:aMfo and (mfo=:sMfoA or mfo=(SELECT mfop
                                               FROM   banks
                                               WHERE  mfop<>:aMfo and mfo=:sMfoA))')
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Call Debug('1-' || aMfo || ',2-' || sMfoA || ',3-' || mfo)
.head 5 +  Else
.head 6 -  Set strNlsT00 = IifS(nDk=1, 'T00', 'T0D')
.head 6 -  Set mfo = aMfo
.head 5 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT tip,nls
     FROM   accounts
     WHERE  kv=:nKv and (tip=:strNls902 or tip=:strNlsT00 and acc IN (SELECT acc
                                                                      FROM   bank_acc
                                                                      WHERE  mfo=:mfo))
     INTO   :sTmp,:sNls")
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If sTmp = 'T00' or sTmp = 'T0D' or sTmp = 'TO0' or sTmp = 'TOD'
.head 7 -  Set strNlsT00 = sNls
.head 6 +  Else If sTmp = '902' or sTmp = '90D'
.head 7 -  Set strNls902 = sNls
.head 6 -  ! Call Debug('4-' || sTmp || ',5-' || sNls || ',3-' || mfo)
.head 5 +  If GetGlobalOptionEx('LST92')
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,tt
   FROM   t902_acc
   WHERE  kv=:nKv and dk=:nDk and blk=:nBlk
   INTO   :strNls902,:strTTadd")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Function: OurTranS ! Трансляция формулы суммы
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: nS
.head 5 -  String: sS
.head 5 -  Number: nRef
.head 5 -  String: sNlsA
.head 5 -  String: sMfoA
.head 5 -  Number: nKvA
.head 5 -  Number: nSA
.head 5 -  String: sNlsB
.head 5 -  String: sMfoB
.head 5 -  Number: nKvB
.head 5 -  Number: nSB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: S   !
.head 5 -  String: S2  ! для
.head 5 -  String: N   ! подстановки
.head 5 -  String: KvA ! при вычислении суммы операции
.head 5 -  String: KvB !
.head 5 -  String: REF
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 +  If sS
.head 6 -  Set S = SalNumberToStrX(nSA, 0)      ! Сумма платежа
.head 6 -  Set S2 = SalNumberToStrX(nSB, 0)     ! Сумма платежа
.head 6 -  ! Set N = SalNumberToStrX(m_nNom, 0) ! Номинал Б
.head 6 -  Set KvA = SalNumberToStrX(nKvA, 0)   ! Код валюты А
.head 6 -  Set KvB = SalNumberToStrX(nKvB, 0)   ! Код валюты B
.head 6 -  Set REF = SalNumberToStrX(nRef, 0)   ! Референція
.head 6 -  Set sS = SalStrUpperX(' ' || sS)
.head 6 +  While SalStrScan(sS, '#(S)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(S)'), 4, S)
.head 6 +  While SalStrScan(sS, '#(S2)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(S2)'), 5, S2)
.head 6 +  While SalStrScan(sS, '#(NOM)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(NOM)'), 6, N)
.head 6 +  While SalStrScan(sS, '#(NLSA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(NLSA)'), 7, sNlsA)
.head 6 +  While SalStrScan(sS, '#(NLSB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(NLSB)'), 7, sNlsB)
.head 6 +  While SalStrScan(sS, '#(MFOA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(MFOA)'), 7, sMfoA)
.head 6 +  While SalStrScan(sS, '#(MFOB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(MFOB)'), 7, sMfoB)
.head 6 +  While SalStrScan(sS, '#(KVA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(KVA)'), 6, KvA)
.head 6 +  While SalStrScan(sS, '#(KVB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(KVB)'), 6, KvB)
.head 6 +  While SalStrScan(sS,'#(REF)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS, SalStrScan(sS, '#(REF)'), 6, REF)
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   SELECT ROUND(" || sS || ",0)
   INTO   :nS
   FROM   dual")
.head 7 -  Return FALSE
.head 6 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: GetWebPayFlag
.head 4 -  Description: Получить статус оплати в ВЕБ
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sWeb
.head 4 +  Actions
.head 5 -  Call SqlPLSQLCommand(hSql(), "gl.getP('WEBPAY',sWeb)")
.head 5 -  Return sWeb
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Boolean: fAllowChanges
.head 3 -  Boolean: fAllowRules
.head 3 -  Boolean: fAllowPriority
.head 3 -  Boolean: bPutSignMode  ! флаг наложения ЭЦП на платежи
                       ! при разблокировании (для Сбербанка)
.head 3 -  String: strPreDefinedCode  ! Фильтр из строки вызова
.head 2 +  Window Variables
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  ! Number: nRowCount
.head 3 -  String: sTmp
.head 3 -  String: sNms
.head 3 -  String: sNmk
.head 3 -  String: sNls
.head 3 -  String: strNls902 ! Номер счета "до выяснения"
.head 3 -  String: strNls90D ! Номер счета "до выяснения" (дебетовый)
.head 3 -  String: strNlsT00 ! Номер счета "всеобщий транзит"
.head 3 -  String: strNlsT0D ! Номер счета "всеобщий транзит" дебетовый
.head 3 -  String: strTts
.head 3 -  Number: nTmp
.head 3 -  Number: nTmpL00
.head 3 -  Number: nBlk
.head 3 -  Number: nSumDocs
.head 3 -  Date/Time: dDat   ! Банковская дата
.head 3 -  String: strAddCond
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sf
.head 3 -  String: sErrorTxt
.head 3 -  String: aMfo
.head 3 -  String: sErrTxt
.head 3 -  String: sBackDocPath
.head 3 -  String: strUserLogin
.head 3 -  Boolean: fVisaSign
.head 3 -  Boolean: bMisys
.head 3 -  Boolean: bFinacle
.head 3 -  Boolean: bFinMon
.head 3 -  Boolean: bPdat
.head 3 -  Boolean: bSuspR    ! Вставлять причину помещения на 902
.head 3 -  Boolean: bSuspBis  ! Переносить БИСы на невыясненные
.head 3 -  Boolean: bShow902  ! Всегда открыта кнопка "до выяснения"
.head 3 -  Boolean: bBlk902   ! Показывать код блокировки в "разборе невыясненных" 
.head 3 -  Boolean: bOtmMono  ! Показывать моно или цветную отметку
.head 3 -  Boolean: bSwift    ! Есть SWIFT
.head 3 -  Boolean: bWebPay   ! Есть управление оплатой WEB
.head 3 -  Number: nSepVisa
.head 3 -  Number: nUserId
.head 3 -  String: strKeyId
.head 3 -  String: sChk
.head 3 -  String: sBankOkpo
.head 3 -  Window Handle: hWinMis
.head 3 -  Number: nFMOtm
.head 3 -  !
.head 3 -  Number: nTimeWaitMessage
.head 3 -  String: sTimeWaitMessage
.head 3 -  !
.head 3 -  Number: nX1
.head 3 -  Number: nY1
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT val
     INTO   :sTmp
     FROM   params
     WHERE  par='BANKDATE'")
.head 4 +  If SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If SalDateConstruct(SalStrToNumber(SalStrMidX(sTmp, 6,4 )), SalStrToNumber(SalStrLeftX(sTmp, 2)), SalStrToNumber(
   SalStrMidX(sTmp, 3, 2)), 0, 0, 0) != GetBankDate()
.head 6 -  Call SalMessageBox('Работа с блокированными документами СЭП за ' || SalFmtFormatDateTime(GetBankDate(), 'dd-MM-yyyy')
     || ' невозможна', sTmp, MB_IconStop)
.head 6 -  Return SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Call ShowApdVersion('01')
.head 4 -  Call SalTblSetTableFlags(tbl, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set aMfo = GetBankMfo()
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('ElektroKlients', 'BackDocPath', GetPrnDir(), sBackDocPath, GetIniFileName())
.head 4 -  Call SalGetProfileString('ElektroKlients', 'TimeWaitMessage', '3', sTimeWaitMessage, GetIniFileName())
.head 4 -  Set nTimeWaitMessage = Max(0, Val(sTimeWaitMessage))
.head 4 +  If not fAllowChanges
.head 5 -  Call SalHideWindow(pbAccept)
.head 5 -  Call SalHideWindow(pbReject)
.head 5 -  Call SalHideWindow(pb902)
.head 5 -  Call SalHideWindow(cbAllWithCode)
.head 5 -  Call SalHideWindow(cbOnSumm)
.head 5 -  Call SalHideWindow(dfBoundSum)
.head 4 +  If not fAllowChanges or not fAllowRules
.head 5 -  Call SalHideWindow(pbConditionBlk)
.head 4 +  If not fAllowPriority
.head 5 -  Call SalHideWindow(tbl.PRTY)
.head 5 -  Call SalHideWindow(cbChooseForAllStp)
.head 4 -  Call SalSetFocus(pbExit)
.head 4 -  Set obTimer = FALSE
.head 4 -  Set nReasonId = 0
.head 4 +  If nMode = 1      !! Начальные
.head 5 -  Set strAddCond = 'and arc_rrp.mfoa=' || aMfo
.head 4 +  Else If nMode = 2 !! Ответные
.head 5 -  Set strAddCond = 'and arc_rrp.mfob=' || aMfo
.head 4 +  Else If nMode = 3 !! Транзитные
.head 5 -  Set strAddCond = 'and arc_rrp.mfoa<>' || aMfo || ' and arc_rrp.mfob<>' || aMfo
.head 4 -  Set strAddCond = ' arc_rrp.s>0 and arc_rrp.blk>0 and arc_rrp.fn_b is null ' || strAddCond
.head 4 +  If strPreDefinedCode
.head 5 -  Set strAddCond = strPreDefinedCode ||' and '|| strAddCond
.head 4 -  Set spl_LockDocs.nTabInstance1   = 1
.head 4 -  Set strPrintFileName = 'BLKD'
.head 4 -  Set strFilterTblName = 'arc_rrp'
.head 4 -  Set strUserLogin = GetUserLoginName()
.head 4 -  Set nUserId      = GetUserId()
.head 4 -  Set strKeyId     = GetIdOper()
.head 4 -  Set sBankOkpo    = GetBankOkpoS()
.head 4 -  Set nSepVisa     = GetGlobalOptionEx('SEPVISA')
.head 4 -  Set fVisaSign    = GetGlobalOptionEx('VISASIGN')
.head 4 -  Set bSuspR       = GetGlobalOptionEx('RES92')
.head 4 -  Set bSuspBis     = GetGlobalOptionEx('BIS92')
.head 4 -  Set bBlk902      = GetGlobalOptionEx('BLK92')
.head 4 -  Set bShow902     = GetGlobalOptionEx('SHW92')    !-- Всегда открыта кнопка "до выяснения"
.head 4 -  Set bMisys       = GetGlobalOptionEx('MISYS')    !-- Misys   Int (Для Аваля)
.head 4 -  Set bFinacle     = GetGlobalOptionEx('FINACLE')  !-- Finacle Int (Для НадраБанк)
.head 4 -  Set bFinMon      = GetGlobalOptionEx('FINMON')   !-- ЕСТЬ ФинМониторинг
.head 4 -  Set bPdat        = GetGlobalOptionEx('UPR_PDAT') !--
.head 4 -  Set bOtmMono     = GetGlobalOptionEx('OTM_MONO') !-- Отметка цветная или моно
.head 4 -  Set bSwift       = GetGlobalOptionEx('SWIFT')    !-- Есть свифт
.head 4 -  Set bWebPay      = GetGlobalOptionEx('WEB_PAY0') !-- Есть управление оплатой WEB
.head 4 -  ! Call SalTblSetLockedColumns(tbl, 3+bPdat)
.head 4 +  If nSepVisa
.head 5 -  Set sChk = SalStrRightX('00' || NumberToHexSX(nSepVisa), 2) || SalStrRightX('0000' || NumberToHexSX(nUserId), 4)
.head 4 -  Set dDat = GetBankDate()
.head 4 +  If bPdat
.head 5 -  Call SalShowWindow(tbl.PDAT)
.head 4 +  If bMisys or bFinacle
.head 5 -  Call SalHideWindow(tbl.PDAT)
.head 4 -  ! Установить заголовок
.head 4 +  If bPutSignMode
.head 5 -  Call SalSetWindowText(hWndForm, 'Наложение ЭЦП на коммунальные платежи')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_Timer
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalTimerKill(spl_LockDocs, TIMER_ID1)
.head 4 -  ! Deactivation of function role which call for window
.head 4 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ShowLDocsForRW("")')
.head 3 +  On UM_Close
.head 4 -  Call SalDestroyWindow(hWndForm)
.head 1 -  !
.head 1 +  Dialog Box: dlg_Rules         ! 02
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редактирование правил блокировки документов СЭП
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.07"
.head 4 -  Top:    0.775"
.head 4 -  Width:  10.817"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.635"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Blocking Rules Top Dialog Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblRules
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  10.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.375"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colACTIVE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Акт.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.486"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  Call SalEnableWindow(pbSave)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'Отметьте для разрешения использования')
.head 5 +  Column: colRULE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
прав.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBODY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие блокирования
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 252
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
блокировки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.914"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call SalEnableWindow(pbSave)
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strSql = T('
    SELECT fa,rule,rtrim(body),name,rowid
    FROM bp_rrp
    INTO :tblRules.colACTIVE,:tblRules.colRULE,:tblRules.colBODY,:tblRules.colNAME,:tblRules.colRID
    ORDER BY rule')
.head 6 -  Call SalTblSetLockedColumns(tblRules, 2)
.head 6 -  Call SalTblPopulate(tblRules, hSql(), strSql, TBL_FillAll)
.head 5 +  On SAM_DoubleClick
.head 6 -  Set strBodyTransf = colBODY
.head 6 -  Set nCurrentRow = lParam
.head 6 +  If SalModalDialog(dlg_RulesBodyEdit, hWndForm, strBodyTransf)
.head 7 -  Set tblRules.colBODY = strBodyTransf
.head 7 -  Call SalTblSetRowFlags(tblRules, nCurrentRow, ROW_Edited, TRUE)
.head 5 +  On WM_LbuttonUp
.head 6 -  Call SalEnableWindow(pbSave)
.head 6 -  Call SalEnableWindow(pbDel)
.head 6 -  !
.head 6 -  Set strBodyTransf = colBODY
.head 6 -  Set nCurrentRow = lParam
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If SalTblQueryRowFlags(hWndItem, lParam, ROW_MarkDeleted)
.head 7 -  Call SalTblSetRowFlags(hWndItem, lParam, ROW_MarkDeleted, FALSE)
.head 3 -  !
.head 3 +  Pushbutton: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.1"
.head 5 -  Top:    4.625"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow=SalTblInsertRow(tblRules, TBL_MaxRow)
.head 6 -  Call SalTblSetFocusRow(tblRules, nRow)
.head 6 -  Call SalTblSetContext(tblRules, nRow)
.head 6 +  If SalModalDialog(dlg_RulesBodyEdit, hWndForm, strBodyTransf)
.head 7 -  Set tblRules.colBODY = strBodyTransf
.head 7 -  Call SalTblSetFocusCell(tblRules, nRow, tblRules.colRULE, 0, -1)
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.617"
.head 5 -  Top:    4.625"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblRules, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblFetchRow(tblRules, nRow)
.head 7 +  If SalTblQueryRowFlags(tblRules, nRow, ROW_MarkDeleted)
.head 8 -  Call SalTblSetRowFlags(tblRules, nRow, ROW_MarkDeleted, FALSE)
.head 7 +  Else If SalTblQueryRowFlags(tblRules, nRow, ROW_New)
.head 8 -  Call SalTblDeleteRow(tblRules, nRow, TBL_NoAdjust)
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags(tblRules, nRow, ROW_MarkDeleted, TRUE)
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.45"
.head 5 -  Top:    4.625"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MessageQuestion('Изменить "Бизнес-правила" блокировки документов СЭП?') != IDYES
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  Loop
.head 7 +  If SalTblAnyRows(tblRules, ROW_MarkDeleted, 0)
.head 8 +  If not(SqlPrepare(hSql(), 'DELETE FROM Bp_rrp WHERE rowid=:tblRules.colRID')
   and SalTblDoDeletes(tblRules, hSql(), ROW_MarkDeleted))
.head 9 -  Break
.head 7 +  If SalTblAnyRows(tblRules, ROW_New, 0)
.head 8 +  If not(SqlPrepare(hSql(), 'INSERT INTO Bp_rrp (rule,body,fa,name) VALUES (:tblRules.colRULE,:tblRules.colBODY,:tblRules.colACTIVE,:tblRules.colNAME)')
   and SalTblDoInserts(tblRules, hSql(), TRUE))
.head 9 -  Break
.head 7 +  If SalTblAnyRows(tblRules, ROW_Edited, 0)
.head 8 +  If not(SqlPrepare(hSql(), 'UPDATE Bp_rrp SET rule=:tblRules.colRULE,body=:tblRules.colBODY,fa=:tblRules.colACTIVE,name=:tblRules.colNAME WHERE rowid=:tblRules.colRID')
   and SalTblDoUpdates(tblRules, hSql(), TRUE))
.head 9 -  Break
.head 7 +  If MakeActiveBLProc()
.head 8 -  Call SqlCommitEx(hSql(),'Коррекция процедуры Бизнес-правил блокировки документов СЭП завершена')
.head 8 -  Call MessageInfo('Коррекция процедуры Бизнес-правил блокировки документов СЭП завершена')
.head 7 +  Else
.head 8 -  Call MessageError('Ошибка создания процедуры блокировки документов СЭП!')
.head 7 -  Break
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalPostMsg(tblRules, SAM_Create, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    4.625"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 10614
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.542"
.head 5 -  Width:  10.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.594"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  ! Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.06"
.head 5 -  Width:  10.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.563"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 2 +  Functions
.head 3 +  Function: MakeActiveBLProc
.head 4 -  Description: Создает процедуру BL_RRP согласно активным правилам
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: bl_body
.head 5 -  String: strRU
.head 4 +  Actions
.head 5 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 6 +  If GetGlobalOptionEx( 'SQNC' )
.head 7 +  If SqlPrepareAndExecute(hSql(), T("SELECT substr(bars_sqnc.ru,1,2) INTO :strRU from dual" ) )
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If strRU
.head 10 -  Set strRU = '_' || strRU
.head 8 +  Else
.head 9 -  Return FALSE
.head 6 -  Set bl_body =
 "CREATE OR REPLACE "|| PutLf() ||
 "PROCEDURE bars.bl_rrp"||strRU||"( rc IN OUT NUMBER, kv IN NUMBER," || PutLf() ||
 "          mfoa_p IN VARCHAR2, mfoa IN VARCHAR2, nlsa IN VARCHAR2," || PutLf() ||
 "          mfob_p IN VARCHAR2, mfob IN VARCHAR2, nlsb IN VARCHAR2," || PutLf() ||
 "              dk IN NUMBER,  s IN NUMBER,"  || PutLf() ||
 "            id_a IN VARCHAR2 DEFAULT NULL," || PutLf() ||
 "            id_b IN VARCHAR2 DEFAULT NULL," || PutLf() ||
 "            ref  IN NUMBER   DEFAULT NULL ) IS " || PutLf()
.head 6 -  Set bl_body = bl_body || "classa NUMBER := 0;" || PutLf()
.head 6 -  Set bl_body = bl_body || "classb NUMBER := 0;" || PutLf()
.head 6 -  Set bl_body = bl_body || "nbsa   VARCHAR2(4);" || PutLf()
.head 6 -  Set bl_body = bl_body || "nbsb   VARCHAR2(4);" || PutLf()
.head 6 -  Set bl_body = bl_body || "erm    VARCHAR2 (80);" || PutLf()
.head 6 -  Set bl_body = bl_body || "ern    CONSTANT POSITIVE := 715;" || PutLf()
.head 6 -  Set bl_body = bl_body || "err    EXCEPTION;" || PutLf()
.head 6 -  !
.head 6 -  Set bl_body = bl_body || "BEGIN" || PutLf()
.head 6 -  !
.head 6 -  Set bl_body = bl_body || "   IF deb.debug THEN" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'module/0', 'bl_rrp');" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'kv', kv);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'mfoa_p', mfoa_p);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'mfoa', mfoa);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'nlsa', nlsa);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'mfob_p', mfob_p);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'mfob', mfob);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'nlsb', nlsb);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'dk', dk);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 's', s);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'id_a', id_a);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'id_b', id_b);" || PutLf()
.head 6 -  Set bl_body = bl_body || "      deb.trace( ern, 'ref',  ref);" || PutLf()
.head 6 -  Set bl_body = bl_body || "   END IF;" || PutLf()
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblRules, nRow, 0, ROW_MarkDeleted)
.head 7 -  Call SalTblFetchRow(tblRules, nRow)
.head 7 -  !
.head 7 +  If tblRules.colACTIVE
.head 8 -  Set bl_body = bl_body || "   IF  " || tblRules.colBODY || " THEN " || PutLf()
.head 8 -  ! сделать возможным возврата rc:=NULL, если colRULE = NULL
.head 8 +  If tblRules.colRULE = NUMBER_Null
.head 9 -  Set bl_body = bl_body || "      rc := NULL ;" || PutLf()
.head 8 +  Else
.head 9 -  Set bl_body = bl_body || "      rc := " || Str(tblRules.colRULE) || ";" || PutLf()
.head 8 -  Set bl_body = bl_body || "      IF deb.debug THEN" || PutLf()
.head 8 -  Set bl_body = bl_body || "         deb.trace( ern, 'result/" || Str(nRow) || "', rc);" || PutLf()
.head 8 -  Set bl_body = bl_body || "      END IF;" || PutLf()
.head 8 -  Set bl_body = bl_body || "      RETURN;" || PutLf()
.head 8 -  Set bl_body = bl_body || "   END IF;" || PutLf()
.head 6 -  !
.head 6 -  Set bl_body = bl_body || "   rc := 0;" || PutLf()
.head 6 -  Set bl_body = bl_body || "END bl_rrp"||strRU||";" || PutLf()
.head 5 -  Call SaveInfoToLog(bl_body)
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), bl_body)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCurrentRow
.head 3 -  Long String: strBodyTransf
.head 3 -  Long String: bl_body
.head 3 -  String: strDebugFile
.head 3 -  Number: nAltState
.head 3 -  Number: nCtlState
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call ShowApdVersion('02')
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 -  ! Deactivation of function role which call for window
.head 1 +  Dialog Box: dlg_RulesBodyEdit ! 03
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редактирование правила
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.638"
.head 4 -  Top:    1.281"
.head 4 -  Width:  8.443"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.031"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Редактирование Бизнес-правила
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlBody
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.063"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.76"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalEnableWindow( pbSave )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  On SAM_Create
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set mlBody=strRuleBody
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 -  Group Box: Логические операторы
.head 4 -  Resource Id: 51504
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.906"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbAND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: И
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' AND '
.head 3 +  Pushbutton: pbOR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ИЛИ
.head 4 -  Window Location and Size
.head 5 -  Left:   0.786"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' OR '
.head 3 +  Pushbutton: pbNOT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   1.386"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' NOT '
.head 3 -  Group Box: Операторы сравнения
.head 4 -  Resource Id: 51505
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.786"
.head 5 -  Top:    1.906"
.head 5 -  Width:  3.857"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  !
.head 3 +  Pushbutton: pbL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <
.head 4 -  Window Location and Size
.head 5 -  Left:   2.886"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' < '
.head 3 +  Pushbutton: pbG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >
.head 4 -  Window Location and Size
.head 5 -  Left:   3.286"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' > '
.head 3 +  Pushbutton: pbLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <=
.head 4 -  Window Location and Size
.head 5 -  Left:   3.686"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' <= '
.head 3 +  Pushbutton: pbGE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >=
.head 4 -  Window Location and Size
.head 5 -  Left:   4.086"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' >= '
.head 3 +  Pushbutton: pbEQL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: =
.head 4 -  Window Location and Size
.head 5 -  Left:   4.486"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' = '
.head 3 +  Pushbutton: pbNE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: !=
.head 4 -  Window Location and Size
.head 5 -  Left:   4.886"
.head 5 -  Top:    2.156"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' <> '
.head 3 +  Pushbutton: pbLIKE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПО МАСКЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   5.286"
.head 5 -  Top:    2.156"
.head 5 -  Width:  1.229"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlBody = mlBody || ' LIKE '
.head 3 -  !
.head 3 +  Pushbutton: pbField
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поле
.head 4 -  Window Location and Size
.head 5 -  Left:   6.786"
.head 5 -  Top:    1.542"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalModalDialog( dlg_RulesGetField, hWndForm, strValue ) = 0
.head 7 -  Set mlBody = mlBody || strValue
.head 3 +  Pushbutton: pbValue
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Значение
.head 4 -  Window Location and Size
.head 5 -  Left:   6.786"
.head 5 -  Top:    2.073"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalModalDialog( dlg_RulesGetValue, hWndForm, strValue, FALSE ) = 0
.head 7 -  Set mlBody = mlBody || strValue
.head 7 -  Call SalEnableWindow( pbSave )
.head 3 -  !
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.786"
.head 5 -  Top:    0.083"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set strRuleBody=mlBody
.head 6 -  Call SalEndDialog( hWndForm, TRUE )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   6.786"
.head 5 -  Top:    0.604"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  !
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Long String: strRuleBody
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ShowApdVersion('03')
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalDisableWindow( pbSave )
.head 4 -  !
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  On SAM_CreateComplete
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -  Call WaitCursorOff()
.head 4 -  !
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 +  Dialog Box: dlg_RulesGetField ! 04
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.34"
.head 4 -  Top:    2.117"
.head 4 -  Width:  8.533"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.179"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбрать поле таблицы
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblFields
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  8.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.104"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREADME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описание
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.829"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblFields, hSql(),
                                T( "SELECT atr, name FROM Bp_domain INTO :colNAME, :colREADME WHERE trim( tab )='arc_rrp'" ),
                                 TBL_FillNormal )
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  On SAM_DoubleClick
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set sT=' ' || SalStrTrimX(colNAME) || ' '
.head 6 -  !
.head 6 -  Call SalEndDialog( dlg_RulesGetField, FALSE )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   5.114"
.head 5 -  Top:    3.313"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblFields, SAM_DoubleClick, 0, 0 )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.757"
.head 5 -  Top:    3.313"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sT = ''
.head 6 -  Call SalEndDialog( hWndForm, -1)
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 51506
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.24"
.head 5 -  Width:  8.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sT
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ShowApdVersion('04')
.head 4 -  Call SetWindowFont( hWndForm )
.head 1 +  Dialog Box: dlg_RulesGetValue ! 05
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Введите значение
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   3.575"
.head 4 -  Top:    2.208"
.head 4 -  Width:  5.457"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.719"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Значение:
.head 4 -  Resource Id: 51507
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.486"
.head 5 -  Top:    0.302"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfVal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.986"
.head 6 -  Top:    0.26"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.014"
.head 5 -  Top:    0.823"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsValidNumber( dfVal )
.head 7 -  Set sT = ' ' || SalStrTrimX( dfVal ) || ' '
.head 6 +  Else
.head 7 -  Set sT = ' "' || SalStrTrimX( dfVal ) || '" '
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   3.671"
.head 5 -  Top:    0.823"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sT = ''
.head 6 -  Call SalEndDialog( hWndForm, -1 )
.head 3 -  Frame
.head 4 -  Resource Id: 51508
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    0.073"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.635"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sT
.head 3 -  Boolean: bMode
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ShowApdVersion('05')
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  !
.head 4 +  If bMode=TRUE
.head 5 -  Call SalSetWindowText( hWndForm, 'Имя файла отладки:' )
.head 5 -  Set dfVal='/usr/informix/bl_rrp_debug.sql'
.head 4 -  !
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 -  !
.head 1 +  Dialog Box: dlg_Reason        ! 06
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Укажите причину возврата документа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.4"
.head 4 -  Top:    0.906"
.head 4 -  Width:  10.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBpReason
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.057"
.head 6 -  Top:    0.024"
.head 6 -  Width:  10.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.406"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colID_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описание
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 8 -  !
.head 8 -  Call SalEnableWindow( pbAccept )
.head 8 -  !
.head 8 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblPopulate( tblBpReason, hSql(),
                  T( 'SELECT id, reason, rowid FROM Bp_reason INTO :colID, :colID_NAME, :tblBpReason.colRID' ), TBL_FillAll )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 +  If SalTblAnyRows( tblBpReason, ROW_Selected, 0 )
.head 7 -  Call SalEnableWindow( pbAccept )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +  Pushbutton: pbAccept
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    4.573"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 +  If SalTblAnyRows( tblBpReason, ROW_Edited, 0)
.head 7 -  Call SqlPrepare( hSql(), T( 'UPDATE Bp_reason SET reason=:tblBpReason.colID_NAME WHERE rowid=:tblBpReason.colRID' ) )
.head 7 -  Call SalTblDoUpdates( tblBpReason, hSql(), TRUE )
.head 7 -  Call SqlCommitEx( hSql(), 'Сохранение данных в справочнике BP_REASON' )
.head 6 -  !
.head 6 +  If SalTblAnyRows( tblBpReason, ROW_Selected, 0 )
.head 7 -  !
.head 7 -  Set nReasonId=tblBpReason.colID
.head 7 -  Set sReason=tblBpReason.colID_NAME
.head 7 -  !
.head 7 +  If nReasonId>0
.head 8 -  Call SalEndDialog( dlg_Reason, TRUE )
.head 7 +  Else
.head 8 -  Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
.head 6 +  Else
.head 7 -  Call MessageInfoEx( 'Не указана причина возврата документов СЭП! Необходимо выбрать запись в списке!' )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.7"
.head 5 -  Top:    4.573"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set nReasonId=0
.head 6 -  Call SalEndDialog( dlg_Reason, FALSE )
.head 6 -  !
.head 6 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 10283
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.5"
.head 5 -  Width:  10.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.594"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalCenterWindow( dlg_Reason )
.head 4 -  Call ShowApdVersion('06')
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalDisableWindow( pbAccept )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_RefBpReason   ! 07
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник кодов причин возврата платежей СЭП
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.5"
.head 4 -  Top:    0.5"
.head 4 -  Width:  10.129"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.107"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник кодов причин возврата платежей СЭП
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBpReason
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.088"
.head 6 -  Top:    0.042"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.094"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 128
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colID_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.629"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate(tblBpReason, hSql(), T('
     SELECT id,reason,rowid
     FROM Bp_reason
     INTO :tblBpReason.colID,:tblBpReason.colID_NAME,:tblBpReason.colRID'),
     TBL_FillAll)
.head 6 -  Call WaitCursorOff()
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalEnableWindow(pbDel)
.head 6 +  If bMode = TRUE
.head 7 -  Call SalEnableWindow(pbSave)
.head 5 +  On WM_LbuttonUp
.head 6 -  Call SalSendMsg(tblBpReason, SAM_RowHeaderClick, 0, 0)
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.467"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nNewRow = SalTblInsertRow(tblBpReason, TBL_MaxRow)
.head 6 +  If nNewRow != TBL_Error
.head 7 -  Call SalTblSetFocusRow(tblBpReason, nNewRow)
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Удалить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.983"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetFlagsAnyRows(tblBpReason, ROW_MarkDeleted, TRUE, ROW_Selected, 0)
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call WaitCursorOn()
.head 6 +  If bMode = TRUE
.head 7 -  Set nBpr = tblBpReason.colID
.head 7 -  Call SaveInfoToLog('Выбран код возврата платежа СЭП: ' || NumberToStr(nBpr))
.head 6 +  Else
.head 7 +  If SalIsNull(tblBpReason.colID) Or tblBpReason.colID = 0
.head 8 -  Call MessageInfoEx('Заполните корректно код возврата документа СЭП !')
.head 7 +  Else
.head 8 +  If SalTblAnyRows(tblBpReason, ROW_New, 0)
.head 9 -  Call SqlPrepare(hSql(), T('
     INSERT
     INTO Bp_reason (id,reason)
     VALUES (:tblBpReason.colID,:tblBpReason.colID_NAME)'))
.head 9 -  Call SalTblDoInserts(tblBpReason, hSql(), TRUE)
.head 8 +  If SalTblAnyRows(tblBpReason, ROW_MarkDeleted, 0)
.head 9 -  Call SqlPrepare(hSql(), T('
     DELETE
     FROM Bp_reason
     WHERE rowid=:tblBpReason.colRID'))
.head 9 -  Call SalTblDoDeletes(tblBpReason, hSql(), ROW_MarkDeleted)
.head 8 +  If SalTblAnyRows(tblBpReason, ROW_Edited, 0)
.head 9 -  Call SqlPrepare(hSql(), T('
     UPDATE Bp_reason
     SET reason=:tblBpReason.colID_NAME
     WHERE rowid=:tblBpReason.colRID'))
.head 9 -  Call SalTblDoUpdates( tblBpReason, hSql(), TRUE )
.head 8 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 8 -  Call SalSendMsg(tblBpReason, SAM_Create, 0, 0)
.head 8 -  Call SalSetFocus(tblBpReason)
.head 6 -  Call WaitCursorOff()
.head 6 +  If bMode = TRUE
.head 7 -  Set bMode = FALSE
.head 7 -  Call SalEndDialog(hWndForm, nBpr)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, -1)
.head 3 -  Frame
.head 4 -  Resource Id: 33968
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.177"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.594"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: bMode
.head 2 +  Window Variables
.head 3 -  Number: nBpr
.head 3 -  Number: nNewRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call ShowApdVersion('07')
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Set nBpr = NUMNULL
.head 4 +  If bMode = TRUE
.head 5 -  Call SalHideWindow(pbNew)
.head 5 -  Call SalHideWindow(pbDel)
.head 5 -  Call SalTblSetColumnFlags(tblBpReason.colID, COL_Editable, FALSE)
.head 5 -  Call SalTblSetColumnFlags(tblBpReason.colID_NAME, COL_Editable, FALSE)
.head 5 -  Call SalSetWindowText(pbSave, 'Выбрать')
.head 5 -  Call SalDisableWindow(pbSave)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 1 -  !
.head 1 +  Form Window: splSepFiles  ! 08 Ручное формирование файлов СЕП $A
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ручная отправка файлов СЭП
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  10.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.893"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Default
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Ручное формирование файлов СЕП $A
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать записи в таблице'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tblFils, UM_Populate, 0, 0 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.433"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22297
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.557"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  4.557"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 25803
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.883"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  5.883"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 25804
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  10.033"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  10.033"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Set sf = cF.GetFilterWhereClause( FALSE )
.head 8 -  Call SalSendMsg(tblDocs, UM_Populate, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Установить фильтр на документы"
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробная информация для строки таблицы'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_HotDocuments, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.433"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22298
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Line
.head 5 -  Resource Id: 22299
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.95"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.95"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCrtImg
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.733"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Select.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Присвоить имя файла'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_MenuSelect, 0, 0)
.head 4 +  Pushbutton: pbFilSqn
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.333"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Forward.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Создать/Подписать файл'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_MenuSetItem, 0, 0)
.head 4 +  Data Field: dfResurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 11
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.683"
.head 7 -  Top:    0.131"
.head 7 -  Width:  2.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SqlPrepareAndExecute( hSql(),"
SELECT sum(decode(tip,'TNB',-ostc-lim,-ostc) ) INTO :nTmpL00
  FROM v_accounts_proc
 WHERE kv=980 AND p_tip in ('N00','TNB'"||IifS(GetBankModel(),",'L00','TUR'",'')||")")
.head 7 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nTmpL00=0
.head 7 -  Set dfResurs=nTmpL00 / 100
.head 7 +  If nTmpL00 < 0
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Red )
.head 7 +  Else
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 4 -  Background Text: Ресурс:
.head 5 -  Resource Id: 25802
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.133"
.head 6 -  Top:    0.119"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfNumSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.233"
.head 7 -  Top:    0.131"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfSumSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.833"
.head 7 -  Top:    0.131"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.15"
.head 6 -  Top:    0.0"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblFils
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  2.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colFn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
файла
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
файла
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кол
Док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSde
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
Дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 16
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSkr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
Кредит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 16
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOtm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отм
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPopulate
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strPopulate="
SELECT '-О ж и д а ю т-' fn,TO_DATE(null) dat,TO_NUMBER(null) n,
TO_NUMBER(null) sde,TO_NUMBER(null) skr,TO_NUMBER(null) otm FROM dual
 UNION
SELECT fn,dat,n,sde,skr,otm
  INTO :colFn,:colDat,:colN,:colSde,:colSkr,:colOtm
  FROM zag_b WHERE dat>=bankdate_g and dat<bankdate_g+1 and otm<5 AND SUBSTR(Fn,2,1)='A' AND SUBSTR(Fn,9,1)='.' ORDER By dat DESC"
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If bp_grc(3)
.head 7 -  Call SqlCommit( hSql() )
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call MessageErrorEx( 'Ошибка при вызове bp_grc(3).' )
.head 6 +  If po_grc()
.head 7 -  Call SqlCommit( hSql() )
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call MessageErrorEx( 'Ошибка при вызове po_grc().' )
.head 6 -  Call SalTblPopulate(hWndItem, hSql(), T(strPopulate),TBL_FillAll)
.head 6 -  Call SalSendMsg( hWndItem, SAM_TblDoDetails, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_TblDoDetails
.head 6 +  If SalStrLeftX(tblFils.colFn,1)='-'
.head 7 -  Call SalEnableWindow( pbCrtImg )
.head 7 -  Call SalDisableWindow( pbFilSqn )
.head 7 -  Call SalEnableWindow( pbFilter )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbCrtImg )
.head 7 +  If GetSignType() = 'NBU' and colOtm=1 or
   GetSignType()!= 'NBU' and colOtm=2 or colOtm=3
.head 8 -  Call SalEnableWindow( pbFilSqn )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( pbFilSqn )
.head 7 -  Call SalDisableWindow( pbFilter )
.head 6 -  Call SalSendMsg( tblDocs, UM_Populate, 0, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 +  Select Case colOtm
.head 7 +  Case 3
.head 8 -  Call VisTblSetRowColor( hWndItem, lParam, COLOR_DarkBlue )
.head 8 -  Break
.head 7 +  Case 1
.head 8 -  Call VisTblSetRowColor( hWndItem, lParam, IifN(GetSignType() = 'NBU',COLOR_DarkGreen,COLOR_Green) )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  Call VisTblSetRowColor( hWndItem, lParam, COLOR_DarkGreen )
.head 8 -  Break
.head 7 +  Case 0
.head 8 -  Call VisTblSetRowColor( hWndItem, lParam, COLOR_Blue )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call VisTblSetRowColor( hWndItem, lParam, COLOR_Purple )
.head 8 -  Break
.head 3 +  Child Table: tblDocs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.95"
.head 6 -  Top:    -0.071"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colMfoA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfoB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 16
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRec
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: #
Зап
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOne
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 1

.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FN_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
файла
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 12
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата файла
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REC_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REC_A
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BIS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPopulate
.head 5 -  Number: nBaseVal
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 +  If SalStrLeftX(tblFils.colFn,1)='-'
.head 7 -  ! Работаем только по гривне SERG 16.02.2005
.head 7 -  Set nBaseVal = GetBaseVal()
.head 7 -  Set strPopulate='
SELECT /*+ INDEX(arc_rrp XPK_ARC_RRP) */
       arc_rrp.rec,mfoa,nlsa,mfob,nlsb,dk,kv,s,1,fn_a,dat_a,rec_a,bis
  INTO :colRec,:colMfoA,:colNlsA,:colMfoB,:colNlsB,:colDk,:colKv,:colS,:colOne,:FN_A,:DAT_A,:REC_A,:BIS
  FROM rec_que, arc_rrp
 WHERE fn_b IS NULL AND sos = 3 AND blk=0 AND bis in (0,1) 
   AND nvl(prty,0)<>1 
   AND rec_que.rec=arc_rrp.rec AND kv=:nBaseVal AND
EXISTS (SELECT mfo FROM banks
         WHERE mfo=arc_rrp.mfob AND (mfop=:strMfoNbu AND mfop<>:strMfo OR mfo=:strMfoNbu))'
        || IifS(sf !='',' AND '||sf,'')||
  ' ORDER BY kv,fn_a,dat_a,rec_a,ref_a,bis'
.head 6 +  Else
.head 7 -  Set strPopulate='
SELECT rec,mfoa,nlsa,mfob,nlsb,dk,kv,s,1
  INTO :colRec,:colMfoA,:colNlsA,:colMfoB,:colNlsB,:colDk,:colKv,:colS,:colOne
  FROM arc_rrp
 WHERE fn_b = :tblFils.colFn AND dat_b = :tblFils.colDat AND sos = 3 AND blk=0 '
.head 6 -  Set sf = ''
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblPopulate(hWndItem, hSql(), T(strPopulate),TBL_FillAll)
.head 6 -  Call SalSendMsg( dfResurs,SAM_Create, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Set dfSumSelect=0
.head 6 -  Set dfNumSelect=0
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(splSepFiles, UM_HotDocuments, 0, 0 )
.head 5 +  On WM_LbuttonUp
.head 6 -  Set dfSumSelect=SalTblColumnSum( hWndForm, 7, ROW_Selected, 0 )/100
.head 6 -  Set dfNumSelect=SalTblColumnSum( hWndForm, 9, ROW_Selected, 0 )
.head 2 +  Functions
.head 3 +  Function: WrtFile
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strPath
.head 5 -  String: strFn
.head 5 -  Date/Time: dDatB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: lsSignD
.head 5 -  Number: nFetchRes
.head 5 -  Number: nFile
.head 5 -  String: sMfoA
.head 5 -  String: sNlsA
.head 5 -  String: sMfoB
.head 5 -  String: sNlsB
.head 5 -  Number: nDk
.head 5 -  Number: nS
.head 5 -  Number: nVob
.head 5 -  String: sNd
.head 5 -  Number: nKv
.head 5 -  Date/Time: dDatD
.head 5 -  Date/Time: dDatP
.head 5 -  String: sNamA
.head 5 -  String: sNamB
.head 5 -  String: sNazn
.head 5 -  String: sDrec
.head 5 -  String: sNaznK
.head 5 -  String: sNaznS
.head 5 -  String: sOkpoA
.head 5 -  String: sOkpoB
.head 5 -  String: sRefA
.head 5 -  Number: nBis
.head 5 -  Number: nRecB
.head 5 -  Number: nN
.head 5 -  Number: nSde
.head 5 -  Number: nSkr
.head 5 -  Number: nOtm
.head 5 -  String: sKey
.head 5 -  String: sIDKey
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( lsSignD, 65 )
.head 5 -  Set nFile=llcreat(strPath||'\\'||strFn, 0 )
.head 5 +  If nFile>0
.head 6 +  If not SqlPrepareAndExecute(hSql(),
'SELECT n,sde,skr,otm,sign_key INTO :nN,:nSde,:nSkr,:nOtm,:sKey
   FROM zag_b WHERE fn=:strFn and dat=:dDatB FOR UPDATE OF otm NOWAIT')
.head 7 -  Call llclose( nFile )
.head 7 -  Return FALSE
.head 6 +  If SqlFetchNext(hSql(),nFetchRes)
.head 7 +  If nOtm=3 and sOperId != sKey
.head 8 +  If SalMessageBox( 'Файл '||strFn||' уже был подписан пользователем '||sKey||'
Сформировать ЕЩЕ раз ?', 'Предупреждение', MB_IconQuestion | MB_YesNo | MB_DefButton2)!=IDYES
.head 9 -  Call llclose( nFile )
.head 9 -  Return FALSE
.head 8 -  Call SaveFInfoToLog('Заказали сформировать ЕЩЕ раз '||strFn)
.head 7 -  Call llwrite( nFile,SalStrRepeatX( ' ', 100 )||PutCrLf(), 102)
.head 7 -  Call llwrite( nFile,strFn||SalFmtFormatDateTime( dDatB, 'yyMMdd' )||
     Right('0'||SalFmtFormatDateTime( dDatB, 'hhhhmm' ),4)||
     PadL(SalNumberToStrX(nN,0),6)||
     PadL(SalNumberToStrX(nSde,0),16)||
     PadL(SalNumberToStrX(nSkr,0),16)||
     PadL(' ',64)||PadL(' ',6)||PadL(' ',64)||PutCrLf(), 196)
.head 7 -  If SqlPrepare(hSql(),
'SELECT MFOA,NLSA,MFOB,NLSB,DK,S,VOB,ND,KV,DATD,DATP,
        NAM_A,NAM_B,NAZN,D_REC,NAZNK,NAZNS,ID_A,ID_B,ID_O,REF_A,
        BIS,SIGN,REC_B
 FROM arc_rrp WHERE fn_b=:strFn AND dat_b=:dDatB ORDER BY rec_b
 INTO :sMfoA,:sNlsA,:sMfoB,:sNlsB,:nDk,:nS,:nVob,:sNd,:nKv,:dDatD,:dDatP,
      :sNamA,:sNamB,:sNazn,:sDrec,:sNaznK,:sNaznS,:sOkpoA,:sOkpoB,:sIDKey,:sRefA,
      :nBis,:lsSignD,:nRecB')
.head 7 -  If SqlSetLongBindDatatype( 24, BLOB_BYTE )
.head 7 -  If SqlExecute ( hSql() )
.head 7 +  While SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call llwrite(nFile,PadL(sMfoA, 9)||PadL(sNlsA,14)||
PadL(sMfoB, 9)||PadL(sNlsB,14)||PadL(SalNumberToStrX(nDk,0),1)||
PadL(SalNumberToStrX(nS,0),16)||PadL(SalNumberToStrX(nVob,0),2)||
PadR(sNd,10)||PadL(SalNumberToStrX(nKv,0 ),3 )||
SalFmtFormatDateTime( dDatD, 'yyMMdd' )||
SalFmtFormatDateTime( dDatP, 'yyMMdd' )||
PadR(sNamA,38) || PadR(sNamB,38 ) ||PadR(sNazn,160)||PadR(sDrec,60) ||
PadR(sNaznK,3) || PadR(sNaznS,2)  ||PadL(sOkpoA,14)||PadL(sOkpoB,14)||
PadL(sRefA,9)  || PadR(sIDKey,6) ||
PadL(SalNumberToStrX(nBis,0 ), 2) ||PadL(' ',8),444)
.head 8 -  Call llwrite(nFile,lsSignD,64)
.head 8 -  Call llwrite(nFile,strFn||PadL(SalNumberToStrX(nRecB,0),6)||PadL(' ',66)||PutCrLf(),86)
.head 6 +  If sFil(nFile)
.head 7 -  Call SaveFInfoToLog(strFn||' сформирован')
.head 7 -  Call llclose( nFile )
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call llclose( nFile )
.head 7 -  Call SaveFInfoToLog('Не удалось подписать файл '||strFn)
.head 7 -  Call SalMessageBox( 'Не удалось подписать файл', 'Ошибка', MB_IconStop )
.head 7 -  Return FALSE
.head 5 -  Return FALSE
.head 3 +  Function: sIni	        ! Инициализировать подпись
.head 4 -  Description: Инициализировать ЭЦП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  Boolean: bSignInited
.head 5 -  Number: nTim
.head 4 +  Local variables
.head 5 -  String: strDay
.head 5 -  Number: nDay
.head 5 -  Number: nErrorSign
.head 5 -  String: strPinCode
.head 5 -  Number: lTim
.head 4 +  Actions
.head 5 -  Set lTim=nTim
.head 5 -  Set nTim=SalDateHour( SalDateCurrent(  ) )*60+SalDateMinute( SalDateCurrent(  ) )
.head 5 +  If bSignInited and nTim-lTim<5
.head 6 -  Return TRUE
.head 5 -  Set nErrorSign=NUMBER_Null
.head 5 -  Set strPinCode=STRING_Null
.head 5 +  While TRUE
.head 6 +  If SalModalDialog( dlgAskPinCode, hWndForm, strPinCode )
.head 7 +  If bSignInited
.head 8 -  Set nErrorSign=CLOSE_ZAH()
.head 8 -  Set bSignInited=FALSE
.head 7 -  Set nErrorSign=INIT_ZAH( strOpenKeyDir, GetSecretKeyDrv(), sOperId, GetKeyDate(), strPinCode )
.head 7 -  !
.head 7 +  If nErrorSign= -70
.head 8 -  Call MessageErrorEx( sOperId||': Последний день действия секретного ключа' )
.head 7 +  Else If nErrorSign> -77 And nErrorSign< -70
.head 8 -  Set nDay= - nErrorSign - 70
.head 8 +  If nDay=1
.head 9 -  Set strDay='день'
.head 8 +  Else If nDay=2 Or nDay=3 Or nDay=4
.head 9 -  Set strDay='дня'
.head 8 +  Else If nDay=5 Or nDay=6
.head 9 -  Set strDay='дней'
.head 8 -  Call MessageErrorEx( sOperId||': Срок действия секретного ключа прекращается через ' || NumberToStr( nDay ) || ' ' || strDay )
.head 7 +  Else If nErrorSign!=0
.head 8 -  Break
.head 7 -  Call SaveInfoToLog( '>> RSA- инициализация - OK' )
.head 7 -  Set bSignInited=TRUE
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Break
.head 5 -  !
.head 5 +  If nErrorSign		     ! обработка ошибок ЭЦП
.head 6 -  Call MessageErrorEx(sOperId||': Ошибка '|| NumberToStr( nErrorSign ) ||' инициализации ЭЦП')
.head 5 -  Return FALSE
.head 3 +  Function: sFil          ! Подписать файл
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nFile
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nErrorSign
.head 5 -  Number: nN
.head 5 -  String: sN
.head 5 -  Number: nP4
.head 5 -  Number: nP5
.head 5 -  Number: nP6
.head 5 -  Number: nPz
.head 5 -  Number: nDz
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( lsSignF, 65 )
.head 5 -  Call SalStrSetBufferLength( lsSignZ, 65 )
.head 5 +  If GetSignOn()=0	!  ЭЦП отключена - вернуть Пусто
.head 6 -  Return TRUE
.head 5 +  If sIni()
.head 6 -  Set sN='      '
.head 6 -  Call lllseek(  nFile, 124, FILE_SeekBegin )
.head 6 -  Call llread( nFile, sN, 6 )
.head 6 -  Set nN = SalStrToNumber(sN)
.head 6 -  !
.head 6 -  Set nP4=298
.head 6 -  Set nP5=444
.head 6 -  Set nP6=594
.head 6 -  Set nPz=60
.head 6 -  Set nDz=130
.head 6 +  If nN > 0
.head 7 -  Set nErrorSign=RSA_ZAH0( 87, nFile, nN, nP4, nP5, nP6, lsSignF, sOperId )
.head 7 -  Call lllseek( nFile, 102+nPz, FILE_SeekBegin )
.head 7 -  Call llwrite( nFile, lsSignF, 64 )
.head 6 -  Call lllseek( nFile, 102+nPz+64, FILE_SeekBegin )
.head 6 -  Call llwrite( nFile, sOperId, 6 )
.head 6 -  Set nErrorSign=RSA_ZAH0( 87, nFile, 1, 102, nDz, 0, lsSignZ, sOperId )
.head 6 -  Call lllseek( nFile, 102+nDz, FILE_SeekBegin )
.head 6 -  Call llwrite( nFile, lsSignZ, 64 )
.head 6 +  If nErrorSign=0
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call MessageAttention('>> RSA. NBU - Ошибка наложения ЭЦП: ' || NumberToStr( nErrorSign ))
.head 5 -  Return FALSE
.head 3 +  Function: bp_grc 	! присвоение имени файла
.head 4 -  Description: Присвоение имени файла для процессинга
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nDir    ! direction
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRet
.head 4 +  Actions
.head 5 -  Set nRet=0
.head 5 +  While TRUE
.head 6 +  If SalStrTrimX(SalStrUpperX( GetDBMS() ))='ORACLE'
.head 7 +  If SqlPLSQLCommand( hSql(), 'sep.bp_grc(nRet,nDir)')
.head 8 +  If nRet=0
.head 9 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Для Informix не реализовано', 'Внимание', MB_OK )
.head 6 -  Break
.head 5 -  Call SalMessageBox( 'Ошибка в bp_grc '||Str(nRet), 'Внимание', MB_IconStop )
.head 5 -  Call SqlRollback(  hSql() )
.head 5 -  Return FALSE
.head 3 +  Function: po_grc 	! оплата файла СЕП
.head 4 -  Description: Оплата файла СЕП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 +  If SalStrTrimX(SalStrUpperX( GetDBMS() ))='ORACLE'
.head 7 +  If SqlPrepareAndExecute(hSql(),'BEGIN sep.po_grc;END;')
.head 8 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Для Informix не реализовано', 'Внимание', MB_OK )
.head 6 -  Break
.head 5 -  Call SalMessageBox( 'Ошибка в po_grc', 'Внимание', MB_IconStop )
.head 5 -  Call SqlRollback(  hSql() )
.head 5 -  Return FALSE
.head 3 +  Function: Int
.head 4 -  Description: Возвращает целую часть от деления
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nNumber
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sI
.head 4 +  Actions
.head 5 -  Set sI = SalNumberToStrX(nNumber, 9)
.head 5 -  Return SalStrToNumber(SalStrLeftX(sI, SalStrLength(sI)-10))
.head 3 +  Function: UserIdTo2DigitId
.head 4 -  Description: Преобразует числовой идентификатор пользователя
в двухсимвольный по технологии старого "Барс"а
(Для АЖИО)
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nHighBit
.head 5 -  Number: nLowBit
.head 4 +  Actions
.head 5 +  If nId < 100
.head 6 -  Return SalStrRightX( '00' || SalNumberToStrX( nId, 0 ), 2 )
.head 5 +  If nId > 25*27 + 100
.head 6 -  Return ''
.head 5 -  Set nId = nId - 100
.head 5 -  Set nHighBit = Int (nId/26)
.head 5 -  Set nLowBit  = SalNumberMod(nId, 26)
.head 5 -  Return SalNumberToChar(65 + nHighBit) ||
       SalNumberToChar(65 + nLowBit)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 2 +  Window Variables
.head 3 -  String: strMfo
.head 3 -  String: strMfoNbu
.head 3 -  String: sErrTxt
.head 3 -  Number: nRow
.head 3 -  Number: nSumDocs
.head 3 -  Number: nDocs
.head 3 -  String: strARM3Dir
.head 3 -  String: strBKUPDir
.head 3 -  Boolean: bOk
.head 3 -  ! Глобальные переменные для функций записи и подписи файла
.head 3 -  String: sOperId
.head 3 -  Long String: lsSignF
.head 3 -  Long String: lsSignZ
.head 3 -  !
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sf
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  String: YYMMDD
.head 3 -  Number: nOff
.head 3 -  String: strPath
.head 3 -  String: strFn
.head 3 -  File Handle: hFile
.head 3 -  Number: nTmp
.head 3 -  Number: nTmpL00
.head 3 -  String: strBackUpPath
.head 3 -  String: strOpenKeyDir
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call ShowApdVersion('08')
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Directory', 'Arm3DirO', SalStrLeftX(SalFileGetDrive(), 1) ||':\\ARM3', strARM3Dir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Directory', 'BackUpDir',SalStrLeftX(SalFileGetDrive(), 1) ||':\\BARS98.TSS\BACKUP', strBKUPDir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Digital Signature', 'OpenKeyNBU', GetOpenKeyDir(), strOpenKeyDir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Digital Signature', 'DebugIdOper', 'None', sOperId, GetIniFileName())
.head 4 -  Call SalTblSetTableFlags ( tblFils, TBL_Flag_SingleSelection, TRUE )
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set strMfo=GetBankMfo()
.head 4 +  If sOperId='None'
.head 5 -  Set sOperId = SalStrMidX(GetBankSab(),1,3)|| 'B' || UserIdTo2DigitId( GetUserId() )
.head 4 -  Call SqlPrepareAndExecute(hSql(),'SELECT UNIQUE mfo INTO :strMfoNbu FROM banks WHERE mfop=:strMfo AND kodn=3')
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox( 'Не найдено МФО НБУ (Dir3)', 'Ошибка', MB_IconStop )
.head 5 -  Return SalDestroyWindow(hWndForm)
.head 4 -  Call SqlPrepareAndExecute(hSql(),"SELECT val INTO :sTmp FROM params WHERE par='BANKDATE'")
.head 4 +  If SqlFetchNext(hSql(),nFetchRes)
.head 5 +  If SalDateConstruct( SalStrToNumber( SalStrMidX(sTmp,6,4)), SalStrToNumber(SalStrLeftX(sTmp,2)),
                     SalStrToNumber( SalStrMidX(sTmp,3,2)), 0, 0, 0 ) != GetBankDate()
.head 6 -  Call SalMessageBox( 'Работа в СЕП за '||SalFmtFormatDateTime( GetBankDate(),'dd-MM-yyyy')||' невозможна', sTmp, MB_IconStop )
.head 6 -  Return SalDestroyWindow(hWndForm)
.head 4 +  If not GetGlobalOption('SEP$A')='MANUAL'
.head 5 -  Call SalMessageBox( 'Не установлен ручной режим формирования $A
 (PARAMS: SEP$A != MANUAL)', 'Ошибка', MB_IconStop )
.head 5 -  Return SalDestroyWindow(hWndForm)
.head 4 -  Call SalDisableWindow( pbIns )
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  Call SalDisableWindow( pbUpdate )
.head 4 -  Call SalDisableWindow( pbSearch )
.head 4 -  Call SalDisableWindow( pbFilter )
.head 4 -  Call cF.Init('ARC_RRP', 'ARC_RRP')
.head 4 -  Call SalDisableWindow( pbPrint )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalPostMsg( tblFils, UM_Populate, 0, 0 )
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalUpdateWindow(hWndForm)
.head 4 -  Call SalSendClassMessage(SAM_CreateComplete, wParam, lParam)
.head 3 +  On UM_MenuSetItem
.head 4 +  If GetSignType() = 'NBU' and tblFils.colOtm=1 or
   GetSignType()!= 'NBU' and tblFils.colOtm=2 or tblFils.colOtm=3
.head 5 +  If VisDosExist (strARM3Dir)
.head 6 -  Set nOff = VisStrScanReverse (strARM3Dir, -1, '\\')
.head 6 +  If nOff<0
.head 7 -  Call SalMessageBox( strPath||'- не каталог', 'Ошибка', MB_IconStop )
.head 7 -  Return FALSE
.head 6 -  Set strPath = SalStrLeftX( strARM3Dir, nOff )
.head 6 -  Set strFn=tblFils.colFn
.head 6 +  If WrtFile(strPath,strFn,tblFils.colDat)
.head 7 -  Set bOk=FALSE
.head 7 +  While TRUE
.head 8 +  If not SqlPrepare( hSql(),
"UPDATE zag_b SET otm=3,sign_key=:sOperId,sign=:lsSignF
 WHERE Fn=:strFn AND dat=:tblFils.colDat AND otm ="||SalNumberToStrX(tblFils.colOtm,0) )
.head 9 -  Break
.head 8 +  If not SqlSetLongBindDatatype( 2, BLOB_BYTE )
.head 9 -  Break
.head 8 +  If SqlExecute ( hSql() )
.head 9 -  Call SqlCommit( hSql() )
.head 9 -  Call SalFileCopy( strPath ||'\\'||strFn, strARM3Dir||'\\'||strFn, TRUE )
.head 9 -  ! Call Debug('Copied at '||strARM3Dir||'\\'||strFn)
.head 9 +  If VisDosExist (strBKUPDir)  !! do backup
.head 10 -  Set YYMMDD=SalFmtFormatDateTime( tblFils.colDat, 'yyMMdd' )
.head 10 -  Set strBackUpPath=strBKUPDir||'\\'||YYMMDD||'\\OUT'
.head 10 +  If not VisDosExist(strBackUpPath)
.head 11 +  If not SalFileCreateDirectory( strBackUpPath )
.head 12 -  Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
.head 12 -  Break
.head 10 -  Call SalFileCopy( strPath||'\\'||strFn, strBackUpPath||'\\'||strFn, TRUE )
.head 10 -  ! Call Debug('Backed up as '||strBKUPDir||'\\'||YYMMDD||'\\'||strFn)
.head 9 -  Call SalFileOpen( hFile, strPath||'\\'||strFn, OF_Delete )
.head 9 -  ! Call Debug('Deleted from  '||strPath||'\\'||strFn)
.head 9 -  Call SalMessageBox( 'Файл '||tblFils.colFn||' сформирован.', 'Информация', MB_IconInformation )
.head 9 -  Set bOk=TRUE
.head 8 -  Break
.head 7 +  If not bOk
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Call MessageErrorEx( 'Ошибка: Невозможно отметить формирование файла в БД.' )
.head 6 +  Else
.head 7 -  Call SalMessageBox('Невозможно сформировать файл.', 'Ошибка', MB_IconExclamation )
.head 5 +  Else
.head 6 -  Call SalMessageBox('Нет каталога '||strARM3Dir||'.', 'Ошибка', MB_IconExclamation )
.head 4 -  Call SalSendMsg( tblFils, UM_Populate, 0, 0 )
.head 3 +  On UM_MenuSelect
.head 4 -  Set nSumDocs=0
.head 4 -  Set nDocs=0
.head 4 -  !
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nRow=TBL_MinRow
.head 4 +  While SalTblFindNextRow( tblDocs, nRow, ROW_Selected, 0 )
.head 5 -  Call SalTblSetContext( tblDocs, nRow )
.head 5 +  If tblDocs.BIS
.head 6 +  If not SqlPrepareAndExecute( hSql(),'UPDATE rec_que SET otm=1 WHERE rec_g=:tblDocs.colRec AND rec_g IS NOT NULL')
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call MessageErrorEx( 'Невозможно отметить документы для отправки. (BIS)' )
.head 7 -  Break
.head 5 +  Else
.head 6 +  If not SqlPrepareAndExecute( hSql(),'UPDATE rec_que SET otm=1 WHERE rec=:tblDocs.colRec')
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call MessageErrorEx( 'Невозможно отметить документы для отправки.' )
.head 7 -  Break
.head 5 -  Set nDocs=nDocs+1
.head 5 -  Set nSumDocs=nSumDocs+tblDocs.colS
.head 4 -  Call SqlCommit( hSql() )
.head 4 +  If nDocs
.head 5 -  Set sErrTxt='Отмечено '||SalNumberToStrX( nDocs, 0)||' на сумму '||SalNumberToStrX( nSumDocs, 0)
.head 4 +  Else
.head 5 -  Set sErrTxt='Нет отмеченных документов'
.head 4 -  Call SalMessageBox( sErrTxt||'.', 'Информация', MB_IconInformation )
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalSendMsg( tblFils, UM_Populate, 0, 0 )
.head 3 +  On UM_HotDocuments
.head 4 -  Call DocViewContents(hWndForm,tblDocs.colRec)
.head 1 -  !
.head 1 +  Table Window: tblFilesSep     ! 09
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Информация о файлах СЭП
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.688"
.head 4 -  Width:  11.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.393"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.512"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Group Box: Поиск
.head 5 -  Resource Id: 2268
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.0"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfFileName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 12
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.883"
.head 7 -  Top:    0.155"
.head 7 -  Width:  1.657"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: !
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.155"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Задействовать имя для поиска')
.head 4 +  Combo Box: cmbKv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.286"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? No
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strKv = ''
.head 7 -  Call cmbKv.Init(hWndItem)
.head 7 -  Call cmbKv.Populate(hSql(), "kv", "lcv, DECODE(kv,980,1,0) i,sv", "tabval WHERE sv IS NOT NULL UNION SELECT TO_NUMBER(NULL),'*',2,'' FROM dual", "ORDER BY i DESC, lcv")
.head 7 -  ! Call cmbKv.Add('', '*')
.head 7 -  Call SalListSetSelect(cmbKv, 0)
.head 6 +  On SAM_Click
.head 7 -  Set strKv = IifS(cmbKv!='*', ' and h.kv=' || cmbKv.GetKey( SalListQuerySelection(hWndItem)), '')
.head 7 -  Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
.head 4 +  Combo Box: cmbFileDate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.65"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.595"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? No
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbFileDate.Init(hWndItem)
.head 7 -  Call cmbFileDate.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
    "(select fdat from fdat)",
     "ORDER BY fdat DESC")
.head 7 -  Call SalListSetSelect(cmbFileDate, 0)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 -  Set sTmp = cmbFileDate.GetNameById(cmbFileDate.GetKey(SalListQuerySelection(hWndItem)))
.head 7 -  Set dDateSelected = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
.head 7 -  Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
.head 6 +  On SAM_User
.head 7 -  Set nDay = SalDateDay(dDateSelected)
.head 7 -  Set nMonth = SalDateMonth(dDateSelected)
.head 7 -  Set nYear = SalDateYear(dDateSelected)
.head 7 +  If cmbBanks = '*'
.head 8 -  Set strSab = ''
.head 7 +  Else
.head 8 +  If not SalIsNull(cmbBanks)
.head 9 -  Set strSab = cmbBanks.GetKey(SalListQuerySelection(cmbBanks))
.head 7 -  Set dfFileName = '*' || strSab || GetCharForDigit(nMonth) || GetCharForDigit(nDay) ||'????'
.head 7 -  Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
.head 4 -  !
.head 4 +  Combo Box: cmbBanks
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.488"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.369"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? No
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbBanks.Init(hWndItem)
.head 7 -  Call cmbBanks.Populate(hSql(), "sab", "nb", "Banks", "WHERE mfop = " || strBankMfo ||
     " ORDER BY sab")
.head 7 -  Call cmbBanks.Add('*', '*')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
.head 4 -  !
.head 4 -  Group Box: Признак файлов
.head 5 -  Resource Id: 2270
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.183"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  2.657"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 4 +  Radio Button: rbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Сквитованные
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.155"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set strFileStatus = 'Сквитованые'
.head 7 +  If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
.head 8 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 7 -  Set szOtm = ' and otm>=5'
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Radio Button: rbNotOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Не сквитованные
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.488"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set strFileStatus = 'Несквитованые'
.head 7 +  If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
.head 8 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 7 -  Set szOtm = ' and otm<5'
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0 )
.head 4 -  Group Box: Тип файлов
.head 5 -  Resource Id: 2269
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.983"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 4 +  Radio Button: rbTypeA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Входящие
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set strFileDirection = 'Входящие'
.head 7 +  If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
.head 8 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 7 -  ! Set TypedCond = 'Zag_a'
.head 7 -  Call SalHideWindow( tblFilesSep.colERR )
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Radio Button: rbTypeB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Исходящие
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set strFileDirection = 'Исходящие'
.head 7 +  If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
.head 8 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 7 -  ! Set TypedCond = 'Zag_b'
.head 7 -  Call SalShowWindow( tblFilesSep.colERR )
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 -  Frame
.head 5 -  Resource Id: 2265
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.905"
.head 6 -  Width:  11.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Etched
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вилучити файл'
.head 6 +  On SAM_Click
.head 7 +  ! If MessageQuestion('Вилучити файл СЕП: ' || tblFilesSep.colFN || ' ?') != IDYES
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Set bErr = FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tblFilesSep, nRow, ROW_Selected, 0 )
.head 8 -  Call SalTblSetContext( tblFilesSep, nRow )
.head 8 +  If ShowButt(4)
.head 9 -  Set bErr = TRUE
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 ' DELETE FROM tzapros WHERE rec IN
  (SELECT rec FROM arc_rrp
    WHERE fn_a=:tblFilesSep.colFN AND dat_a=:tblFilesSep.colDAT_Z)')
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 ' DELETE FROM rec_que WHERE rec IN
  (SELECT rec FROM arc_rrp
    WHERE fn_a=:tblFilesSep.colFN AND dat_a=:tblFilesSep.colDAT_Z)')
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(), 
 ' DELETE FROM arc_rrp
    WHERE fn_a=:tblFilesSep.colFN AND dat_a=:tblFilesSep.colDAT_Z')
.head 10 -  Break
.head 9 +  If not SqlPrepareAndExecute(hSql(),
 ' DELETE FROM zag_a
    WHERE fn = :tblFilesSep.colFN AND dat = :tblFilesSep.colDAT_Z AND otm=0')
.head 10 -  Break
.head 9 +  If tblFilesSep.colREF
.head 10 +  If not Pay_Bck(tblFilesSep.colREF, 5, '')
.head 11 -  Break
.head 9 +  If not SqlCommitEx(hSql(), 'Вилучення файлу: ' || tblFilesSep.colFN)
.head 10 -  Break
.head 9 -  Call MessageInfo('Файл: ' || tblFilesSep.colFN ||' вилучено!')
.head 9 -  Set bErr=FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 +  If bErr
.head 8 -  Call MessageError('Помилка вилучення файлу: ' || tblFilesSep.colFN)
.head 7 -  Return SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbUnCreate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    0.988"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Unform.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розформувати файл'
.head 6 +  On SAM_Click
.head 7 -  Call WaitCursorOn()
.head 7 -  Set nBpr = 0
.head 7 -  Set bErr=FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tblFilesSep, nRow, ROW_Selected, 0 )
.head 8 -  Call SalTblSetContext( tblFilesSep, nRow )
.head 8 -  Set strTextError=''
.head 8 +  If ShowButt(2)
.head 9 -  Set bErr=TRUE
.head 9 +  If SalStrMidX(tblFilesSep.colFN, 2, 4) = strMySab
.head 10 +  If MessageQuestion('Це може призвести до розбіжностей $Z та ЦОСЕП та блокування БАНКу.'|| PutCrLf() ||
                   'Розформувати файл '||tblFilesSep.colFN||' ?') != IDYES
.head 11 -  Return FALSE
.head 9 -  ! установить код ошибки
.head 9 +  If tblFilesSep.colERR
.head 10 -  Set nError = tblFilesSep.colERR ! // установить код ошибки для файла СЭП
.head 9 +  Else
.head 10 +  If nBpr <= 0
.head 11 -  Set nBpr = ShowRefBpReason(TRUE) ! // выбрать код ошибки для файла СЭП
.head 11 +  If nBpr <= 0
.head 12 -  Return FALSE
.head 10 -  Set nError=nBpr
.head 9 -  !
.head 9 -  Set strTT = 'RT0' ! // возможно расформирование только ИСХОДЯЩИХ файлов СЭП!
.head 9 -  Set nSdb = tblFilesSep.colSDE * 100
.head 9 -  Set nSkr = tblFilesSep.colSDK * 100
.head 9 -  Set nRec = 0
.head 9 -  ! Set nError = nBpr
.head 9 -  ! Set nDetail = 1
.head 9 -  Set nRetCode = 0
.head 9 -  Set strTextError = ''
.head 9 +  If not p_kwt(nRetCode, tblFilesSep.colFN, tblFilesSep.colDAT_Z, nRec, nError)
.head 10 -  Break
.head 9 -  Call SaveInfoToLog('Блокування документів файлу. Код помилки: ' || NumberToStr(nRetCode))
.head 9 +  If nRetCode != 0  ! // ошибка ...
.head 10 -  Set strRetCode = Right('0000' || Str(nRetCode), 4)
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'SELECT n_er FROM S_er WHERE k_er=:strRetCode INTO :strTextError')
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set strTextError = PutCrLf() || 'Код помилки: '||strRetCode||'-'||strTextError
.head 10 -  Break
.head 9 -  Set nRetCode = 0
.head 9 +  If not ps_grc(nRetCode, strTT, tblFilesSep.colFN,
   tblFilesSep.colDAT_Z, tblFilesSep.colN, nSdb, nSkr, nError, 1)
.head 10 -  Break
.head 9 -  Call SaveInfoToLog('Виклик процедури PS_GRC. Код помилки: '||NumberToStr(nRetCode))
.head 9 +  If nRetCode != 0 ! // ошибка ...
.head 10 -  Set strRetCode = Right('0000' || Str(nRetCode), 4)
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'SELECT n_er FROM s_er WHERE k_er=:strRetCode INTO :strTextError')
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set strTextError = PutCrLf() || 'Код помилки: '||strRetCode||'-'||strTextError
.head 10 -  Break
.head 9 +  If SqlCommitEx(hSql(), 'Розформування файлу: ' || tblFilesSep.colFN) = FALSE
.head 10 -  Break
.head 9 -  Call MessageInfo('Файл: ' || tblFilesSep.colFN ||' розформовано. Код помилки: ' || Str(nRetCode))
.head 9 -  Set bErr=FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 +  If bErr
.head 8 -  Call MessageError('Помилка розформування файлу: '||tblFilesSep.colFN||strTextError)
.head 7 -  Return SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbNewCreate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    0.988"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Переформувати файл'
.head 6 +  On SAM_Click
.head 7 -  Call WaitCursorOn()
.head 7 -  Set bErr=FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tblFilesSep, nRow, ROW_Selected, 0 )
.head 8 -  Call SalTblSetContext( tblFilesSep, nRow )
.head 8 +  If ShowButt(3)
.head 9 -  Set bErr = TRUE
.head 9 +  If not SqlPrepareAndExecute(hSql(), 
 ' UPDATE Zag_b SET otm=1,k_er=NULL
   WHERE fn=:tblFilesSep.colFN AND dat = :tblFilesSep.colDAT_Z AND otm in (1,2,3)')
.head 10 -  Break
.head 9 +  If not SqlCommitEx(hSql(), 'Переформування файлу: ' || tblFilesSep.colFN)
.head 10 -  Break
.head 9 -  Call MessageInfo('Файл: ' || tblFilesSep.colFN || ' переформовано !')
.head 9 -  Set bErr = FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 +  If bErr
.head 8 -  Call MessageError('Помилка переформування файлу СЭП: ' || tblFilesSep.colFN)
.head 7 -  Return SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сквитувати файл'
.head 6 +  On SAM_Click
.head 7 -  Call WaitCursorOn()
.head 7 -  Set bErr=FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tblFilesSep, nRow, ROW_Selected, 0 )
.head 8 -  Call SalTblSetContext( tblFilesSep, nRow )
.head 8 -  Set strTextError=''
.head 8 +  If ShowButt(1)
.head 9 -  Set bErr=TRUE
.head 9 +  If SalStrMidX(tblFilesSep.colFN, 2, 4) = strMySab
.head 10 +  If MessageQuestion('Це може призвести до розбіжностей $Z та ЦОСЕП та блокування БАНКу.'|| PutCrLf() ||
                   'Сквитувати файл '||tblFilesSep.colFN||' ?') != IDYES
.head 11 -  Return FALSE
.head 9 -  !
.head 9 -  Set strTT = IifS(rbTypeA, 'RT1', 'RT0')
.head 9 -  Set nSdb = tblFilesSep.colSDE * 100
.head 9 -  Set nSkr = tblFilesSep.colSDK * 100
.head 9 -  Set nRetCode = 0
.head 9 +  If not ps_grc(nRetCode, strTT, tblFilesSep.colFN, 
   tblFilesSep.colDAT_Z, tblFilesSep.colN, nSdb, nSkr, 0, 0)
.head 10 -  Break
.head 9 -  Call SaveInfoToLog('Виклик процедури PS_GRC. Код помилки: '||NumberToStr(nRetCode))
.head 9 +  If nRetCode != 0
.head 10 -  Set strRetCode = Right('0000' || Str(nRetCode), 4)
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'SELECT n_er FROM s_er WHERE k_er=:strRetCode INTO :strTextError')
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set strTextError = PutCrLf() || 'Код помилки: '||strRetCode||'-'||strTextError
.head 10 -  Break
.head 9 +  If not SqlCommitEx(hSql(), 'Квитовка файлу: '||tblFilesSep.colFN)
.head 10 -  Break
.head 9 -  Call MessageInfo('Файл: '|| tblFilesSep.colFN||' сквитовано. Код помилки: '||Str(nRetCode))
.head 9 -  Set bErr=FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 +  If bErr
.head 8 -  Call MessageError('Помилка квитовки файлу: '||tblFilesSep.colFN||strTextError)
.head 7 -  Return SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 2266
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.183"
.head 6 -  Begin Y:  0.905"
.head 6 -  End X:  2.183"
.head 6 -  End Y:  1.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитати дані'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDocs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Переглянути документи файлу'
.head 6 +  On SAM_Click
.head 7 +  If rbTypeA
.head 8 -  Set szCond = "fn_a='" || tblFilesSep.colFN || "' and dat_a=TO_DATE('" ||
    SalFmtFormatDateTime(tblFilesSep.colDAT_Z, 'dd/MM/yyyy hhhh:mm')
    || "', 'DD/MM/YYYY HH24:MI')"
.head 7 +  Else
.head 8 -  Set szCond = "fn_b='" || tblFilesSep.colFN || "' and dat_b=TO_DATE('" ||
    SalFmtFormatDateTime(tblFilesSep.colDAT_Z, 'dd/MM/yyyy hhhh:mm')
    || "', 'DD/MM/YYYY HH24:MI')"
.head 7 -  ! Call Debug(szCond)
.head 7 -  Call DocViewList(hWndMDI, szCond, 'Документы файла СЭП: ' || SalStrTrimX(tblFilesSep.colFN))
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.283"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зберегти зміни'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
.head 8 -  Set strSql = 
"UPDATE " || IifS(rbTypeA,'zag_a','zag_b') ||
  " SET otm=:tblFilesSep.colOTM"|| IifS(rbTypeA,'',',k_err=NULL') || 
" WHERE trim(fn) = trim(:tblFilesSep.colFN)"
.head 8 -  Call WaitCursorOn()
.head 8 -  ! Call SqlIsolationExclusive(hSql())
.head 8 -  Call SqlPrepare(hSql() , T(strSql))
.head 8 -  Call SalTblDoUpdates(tblFilesSep, hSql(), TRUE)
.head 8 -  ! Call SqlIsolationNormal(hSql())
.head 8 -  Call SqlCommitEx(hSql(), 'Встановили відмітку: ' || Str(tblFilesSep.colOTM) ||' для '||tblFilesSep.colFN )
.head 8 -  Call WaitCursorOff()
.head 4 -  Line
.head 5 -  Resource Id: 2267
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.783"
.head 6 -  Begin Y:  0.905"
.head 6 -  End X:  3.783"
.head 6 -  End Y:  1.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вийти'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Contents
.head 3 +  Column: colFN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.629"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Валю
та
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.629"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_Z
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата/Время
создания
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.529"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy hhhh:mm
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма (дебет)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.871"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма (кредит)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.871"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
инф. строк
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 5
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOTM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
опла
ты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата/Время
платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.557"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yy hhhh:mm:ss
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РЕФ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colERR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
блк
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ShowRefBpReason
.head 4 -  Description: Показать справочник кодов причин возврата платежей СЭП ( dlg_RefBpReason )
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Boolean: bMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalModalDialog(dlg_RefBpReason, hWndForm, bMode)
.head 3 +  Function: ShowButt
.head 4 -  Description: Визначає можливість відкриття кнопок
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nPar
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case nPar
.head 6 +  Case 1 ! ------------ pbOk
.head 7 -  Return (tblFilesSep.colOTM = 0 And SalStrMidX(tblFilesSep.colFN, 1, 5) = 'B' || strMySab And rbTypeA)
    or (tblFilesSep.colOTM > 0 And tblFilesSep.colOTM < 5 And rbTypeB)
.head 6 +  Case 2 ! ------------ pbUnCreate
.head 7 -  Return (tblFilesSep.colOTM >= 0 And tblFilesSep.colOTM < 3 And rbTypeB)
.head 6 +  Case 3 ! ------------ pbNewCreate
.head 7 -  Return rbTypeB and 
       (tblFilesSep.colOTM = 3 or (( tblFilesSep.colOTM=1 or tblFilesSep.colOTM=2 ) and tblFilesSep.colERR))
.head 6 +  Case 4
.head 7 -  Return tblFilesSep.colOTM = 0 And ( SalStrMidX(tblFilesSep.colFN, 1, 5) = 'B' || strMySab
or SalStrMidX(tblFilesSep.colFN, 1, 5) = 'B' || strSabVPS
or (SalStrMidX(tblFilesSep.colFN, 8, 1) = ':' AND SalStrMidX(tblFilesSep.colFN, 2, 4) != strMySab) )
.head 6 +  Default
.head 7 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Boolean: fFullAccess
.head 3 -  String: sFlags   ! кнопки+признаки     '11111' (мультивал)
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndCurrent
.head 3 -  !
.head 3 -  String: sFlagI
.head 3 -  String: strBankMfo
.head 3 -  String: strWndName
.head 3 -  String: strFileDirection
.head 3 -  String: strFileStatus
.head 3 -  !
.head 3 -  String: strMonth[12]
.head 3 -  String: strWeekDays[7]
.head 3 -  !
.head 3 -  Number: nRowCount
.head 3 -  !
.head 3 -  String: strSql
.head 3 -  String: TypedCond
.head 3 -  String: szCond
.head 3 -  String: szOtm
.head 3 -  !
.head 3 -  String: strSQLBody
.head 3 -  String: strTT
.head 3 -  Number: nSdb
.head 3 -  Number: nSkr
.head 3 -  Number: nError
.head 3 -  Number: nDetail
.head 3 -  !
.head 3 -  Number: nRec
.head 3 -  Number: nRetCode
.head 3 -  String: strRetCode
.head 3 -  String: strTextError
.head 3 -  Boolean: bErr
.head 3 -  !
.head 3 -  Number: nDay
.head 3 -  Number: nMonth
.head 3 -  Number: nYear
.head 3 -  String: strDateSelected
.head 3 -  Date/Time: dDateSelected
.head 3 -  Date/Time: dDada
.head 3 -  !
.head 3 -  String: strSab
.head 3 -  String: strMySab
.head 3 -  String: strSabVPS
.head 3 -  String: strKv
.head 3 -  !
.head 3 -  Number: nBpr
.head 3 -  String: strCBSelect
.head 3 -  !
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeigh
.head 3 -  !
.head 3 -  Number: nI
.head 3 -  Date/Time: dSelect
.head 3 -  !
.head 3 -  Number: nOldOtm
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeigh
.head 3 -  Number: nColWidth
.head 3 -  !
.head 3 -  Window Handle: hWndCol
.head 3 -  Window Handle: hWndColLast
.head 3 -  Number: nSortDirection
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  Number: nOTM_Control
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set strBankMfo = GetBankMfo()
.head 4 -  Set strMySab = GetBankSab()
.head 4 -  Set strSabVPS = 'none'
.head 4 -  Set dDateSelected = GetBankDate()
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('09')
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SalGetWindowText(hWndForm, strWndName, 150)
.head 4 -  Set nDay   = SalDateDay(GetBankDate())
.head 4 -  Set nMonth = SalDateMonth(GetBankDate())
.head 4 -  Set nYear  = SalDateYear(GetBankDate())
.head 4 -  Set dfFileName = '*' || GetCharForDigit(nMonth) || GetCharForDigit(nDay) || '????'
.head 4 -  ! Состояние кнопок
.head 4 -  Set sFlagI=sFlags||'1111111'
.head 4 -  ! Set TypedCond = 'Zag_a'
.head 4 -  Set rbTypeA = TRUE
.head 4 -  Set rbTypeB = FALSE
.head 4 -  Set strFileDirection = 'Входящие'
.head 4 -  Set szOtm=' and otm>=5'
.head 4 -  Set rbOk = TRUE
.head 4 -  Set rbNotOk = FALSE
.head 4 -  Set strFileStatus = 'Сквитованые'
.head 4 +  If SalStrLeftX( strBankMfo,1)='8'  !! ДКСУ
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select sab INTO :strSabVPS from banks where mfop=:strBankMfo and kodn=4 and mfo like '8_____'")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  ! Call SalTblSetTableFlags(tblFilesSep, TBL_Flag_SingleSelection, TRUE)  MIK 30-05-2011
.head 4 -  Call SalTblSetTableFlags(tblFilesSep, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 -  Call WaitCursorOff()
.head 3 -  !
.head 3 +  On UM_Populate
.head 4 -  Call SalSetWindowText(hWndCurrent, strWndName || ': ' || strFileDirection || ', ' || strFileStatus)
.head 4 -  Set nRowCount = 0
.head 4 -  Set hWndCol = hWndNULL
.head 4 -  Set hWndColLast = hWndNULL
.head 4 -  Set nSortDirection = TBL_SortIncreasing
.head 4 -  Call SalDisableWindow(pbOk)
.head 4 -  Call SalDisableWindow(pbDocs)
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  Call SalDisableWindow(pbDelete)
.head 4 -  Call SalDisableWindow(pbUnCreate)
.head 4 -  Call SalDisableWindow(pbNewCreate)
.head 4 -  Call SalTblSetLockedColumns(tblFilesSep, 2)
.head 4 -  Set strSql = "
    SELECT fn,t.lcv,dat,n,sde,skr,datk,otm,ref,"||IifS(rbTypeA,'NULL','k_er')||
    " FROM Tabval t, " || IifS(rbTypeA,'zag_a','zag_b') ||" h
    INTO :tblFilesSep.colFN,  :tblFilesSep.colKV, :tblFilesSep.colDAT_Z,
         :tblFilesSep.colN,   :tblFilesSep.colSDE,:tblFilesSep.colSDK,
         :tblFilesSep.colDATK,:tblFilesSep.colOTM,:tblFilesSep.colREF,:tblFilesSep.colERR
    WHERE fn LIKE '" || StrMatches2Like(dfFileName) || "' and
          dat>=:dDateSelected and dat-1<:dDateSelected and h.kv=t.kv"
.head 4 -  Set strSql = strSql || szOtm || strKv || " ORDER BY fn, dat"
.head 4 -  Call WaitCursorOn()
.head 4 -  Set nRow = 0
.head 4 -  Set nSdb = 0
.head 4 -  Set nSkr = 0
.head 4 -  Call SalTblPopulate(tblFilesSep, hSqlAux(), T(strSql), TBL_FillAll)
.head 4 -  Call SalTblDefineSplitWindow (tblFilesSep, 1, TRUE)
.head 4 -  Set nTmp = SalTblInsertRow(tblFilesSep, TBL_MinRow)
.head 4 -  Call SalTblSetContext(tblFilesSep, nTmp)
.head 4 -  Call SalTblSetRowFlags(tblFilesSep, nTmp, ROW_New, FALSE)
.head 4 -  Set tblFilesSep.colSDE = nSdb
.head 4 -  Set tblFilesSep.colSDK = nSkr
.head 4 -  Set tblFilesSep.colN = nRow
.head 4 -  Call VisTblAutoSizeColumn(tblFilesSep, hWndNULL)
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set tblFilesSep.colSDK = tblFilesSep.colSDK / 100
.head 4 -  Set tblFilesSep.colSDE = tblFilesSep.colSDE / 100
.head 4 -  Set nRow=nRow+tblFilesSep.colN
.head 4 -  Set nSdb=nSdb+tblFilesSep.colSDE
.head 4 -  Set nSkr=nSkr+tblFilesSep.colSDK
.head 4 -  Set nRowCount = nRowCount + 1
.head 4 -  Call XSalTblSetRowBackColor( tblFilesSep,lParam,IifN(tblFilesSep.colERR,COLOR_LightPeriwinkle,COLOR_White))
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDocs, SAM_Click, 0, 0)
.head 3 +  On WM_LbuttonUp
.head 4 +  If nRowCount != 0
.head 5 -  Call SalEnableWindow(pbDocs)
.head 5 +  If fFullAccess
.head 6 +  If ShowButt(1) and SalStrMidX(sFlagI,3,1)='1'    ! Сквитувати
.head 7 -  Call SalEnableWindow(pbOk) 
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbOk)
.head 6 +  If ShowButt(2) and SalStrMidX(sFlagI,1,1)='1'    ! Розформувати файла СЭП
.head 7 -  Call SalEnableWindow(pbUnCreate)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbUnCreate)
.head 6 +  If ShowButt(3) and SalStrMidX(sFlagI,2,1)='1'    ! Переформувати
.head 7 -  Call SalEnableWindow(pbNewCreate)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbNewCreate)
.head 6 +  If ShowButt(4) and SalStrMidX(sFlagI,0,1)='1'    ! Вилучити
.head 7 -  Call SalEnableWindow(pbDelete)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbDelete)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Set hWndCol = SalNumberToWindowHandle(wParam)
.head 4 +  If hWndCol != hWndColLast
.head 5 -  Set hWndColLast = hWndCol
.head 5 -  Set nSortDirection = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortDirection = 1 - nSortDirection
.head 4 -  !
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblSetColumnFlags(hWndCol, COL_Selected, FALSE)
.head 4 -  Call SalTblSortRows(hWndItem, SalTblQueryColumnID(hWndCol), nSortDirection)
.head 4 -  !
.head 4 +  ! If SalIsValidNumber(hWndCol)
.head 5 -                                                                 Call XSalTooltipShow(hWndItem, Str(SalTblColumnSum(hWndItem,
     SalTblQueryColumnID(hWndCol), 0, 0)))
.head 4 -  !
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_RowHeaderClick
.head 4 -  Set strTextError = ''
.head 4 -  Set strRetCode = Right('0000' || Str(colERR), 4)
.head 4 -  Call SqlPrepareAndExecute(hSql(), T('SELECT n_er FROM s_er INTO :strTextError WHERE trim(k_er)=:strRetCode'))
.head 4 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set strTextError = ''
.head 5 -  Call SqlPrepareAndExecute(hSql(), T('SELECT name FROM bp_rrp INTO :strTextError WHERE rule=:strRetCode and fa=1'))
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set strTextError = 'Бизнес правило №' || Str(colERR) || IifS(Len(strTextError)>0, ' (' ||strTextError || ')', '')
.head 4 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 4 -  Call XSalTooltipShow(hWndForm, strTextError)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 1 +  Table Window: VRO            ! 11
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.263"
.head 4 -  Top:    0.281"
.head 4 -  Width:  13.514"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description: Верификация ответного провода
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  ! On SAM_Click
.head 7 -                                                                 Call SalModalDialog( dlg_Rules, hWndForm )
.head 6 +  ! On SAM_Create
.head 7 -                                                                 Set strTip='Просмотреть БИЗНЕС-ПРАВИЛА'
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Relation.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Принять <<До выяснения>>'
.head 6 +  On SAM_Click
.head 7 +  If MessageQuestion( 'Принять отмеченные документы СЭП <<До выяснения>>?' ) != IDYES
or not UnlockSepDocs(1)
.head 8 -  Return FALSE
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Принять'
.head 6 +  On SAM_Click
.head 7 +  If MessageQuestion( 'Разблокировать отмеченные документы СЭП?' ) != IDYES
or not UnlockSepDocs(0)
.head 8 -  Return FALSE
.head 4 -  Line
.head 5 -  Resource Id: 30554
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.671"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  4.671"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотреть ДОКУМЕНТ'
.head 6 +  On SAM_Click
.head 7 -  Call DocViewContents( hWndForm, VRO.REC )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30555
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30556
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.871"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.871"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет - Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.56"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование-Б
фактическое
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование-Б
из документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 27
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.857"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.329"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО-А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.786"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет - А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование-А

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 27
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.729"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: REC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KV
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: UnlockSepDocs
.head 4 -  Description: Разблокировать документы СЭП: n902=0
Зачислить на дикаря         : n902=1
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: n902
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strSql
.head 5 -  String: strRec
.head 5 -  Number: nRow
.head 5 -  Number: nRef
.head 5 -  Boolean: bRollback
.head 5 -  !
.head 5 -  : cDoc
.head 6 -  Class: cDoc
.head 4 +  Actions
.head 5 -  Call WaitCursorOn()
.head 5 -  Set strSql="UPDATE Arc_rrp SET blk=0" ||
IifS(n902=0,"", ", ref=:cDoc.m_nRef,dat_b=:dDat,sos=5") ||
" WHERE rec=:hWndForm.REC AND fn_b IS NULL"
.head 5 -  Set bRollback=FALSE
.head 5 -  Set nRow=TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, ROW_Selected, 0 )
.head 6 +  When SqlError
.head 7 -  Set bRollback=TRUE
.head 7 -  Call SqlCheckErrorCodeEx( wParam, lParam )
.head 7 -  Break
.head 6 -  Call SalTblFetchRow( hWndForm, nRow )
.head 6 -  Set strRec=Str(VRO.REC)
.head 6 +  If n902=0 !! зачислить вертушкой на счет
.head 7 +  If not SqlPrepareAndExecute( hSql(),strSql ) or not SqlCommit( hSql() )
.head 8 -  Set bRollback=TRUE
.head 8 -  Call Debug( 'Кнопка <Принять>: Ошибка при вызове ф-ции SqlPrepareAndExecute - ' || strSql )
.head 8 -  Break
.head 6 +  Else !! зачислить здесь же на дикаря
.head 7 +  If VRO.DK=1
.head 8 -  Call cDoc.SetDoc( 0,'R01',1, 6,'',dDat,dDat,dDat,dDat,
 strNlsT00, '', '', '', VRO.KV, VRO.S*100, '',
 strNls902, '', '', '', VRO.KV, VRO.S*100, '', 'Блокированный КР документ -> до выяснения','',GetIdOper(),'',NUMBER_Null,0 )
.head 7 +  Else
.head 8 -  Call cDoc.SetDoc( 0,'R01',0, 6,'',dDat,dDat,dDat,dDat,
 strNlsT0D, '', '', '', VRO.KV, VRO.S*100, '',
 strNls90D, '', '', '', VRO.KV, VRO.S*100, '', 'Блокированный ДБ документ -> до выяснения','',GetIdOper(),'',NUMBER_Null,0 )
.head 7 +  If cDoc.oDoc()
.head 8 +  If not SqlPrepareAndExecute( hSql(),strSql)
or not SqlPrepareAndExecute( hSql(),'INSERT INTO t902 (ref,rec) VALUES (:cDoc.m_nRef,:VRO.REC)')
or not SqlCommitEx( hSql(), 'Разблокирование документа СЭП на 902: ' || strRec )
.head 9 -  Set bRollback=TRUE
.head 9 -  Call Debug( 'Кнопка <Принять на 902>: Ошибка при SqlPrepareAndExecute' )
.head 9 -  Break
.head 8 -  !
.head 8 -  Call SaveInfoToLog( 'Документ СЭП принят на 902. Входящий REC- ' || strRec )
.head 5 -  !
.head 5 -  Set nRow=TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, ROW_Selected, 0 )
.head 6 -  Call SalTblDeleteRow ( hWndForm, nRow, TBL_Adjust )
.head 6 -  Call SalTblFetchRow( hWndForm, nRow )
.head 5 -  Call WaitCursorOff()
.head 5 +  If bRollback
.head 6 -  Return SqlRollback( hSql() )
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 2 +  Window Variables
.head 3 -  String: aMFO
.head 3 -  Number: Id
.head 3 -  !
.head 3 -  String: strNls902  ! Номер счета "до выяснения"
.head 3 -  String: strNls90D  ! Номер счета "до выяснения" (дебетовый)
.head 3 -  String: strNlsT00  ! Номер счета "всеобщий транзит"
.head 3 -  String: strNlsT0D  ! Номер счета "всеобщий транзит"(дебетовый)
.head 3 -  String: sNls
.head 3 -  String: sTmp
.head 3 -  Date/Time: dDat     ! Банковская дата
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set VRO.aMFO=GetBankMfo()
.head 4 -  Set VRO.dDat=GetBankDate()
.head 4 -  Set VRO.Id=GetUserId()
.head 4 -  Set VRO.strFilterTblName = 'ARC_RRP'
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3 )
.head 4 -  Call SalSetWindowText( hWndForm,
 'Верификация ответного провода.' ||
 IifS(nPar=0,'',' Исполнитель '||Str(Id) ) ||
 ' Бизнес-правило № '||strPar01 )
.head 4 -  !
.head 4 -  Call ShowApdVersion('11')
.head 4 -  Call SqlPrepareAndExecute( hSql(),
"SELECT nls,tip INTO :sNls,:sTmp FROM accounts WHERE kv=980 AND
  tip in ('902','90D','T00','T0D') " )
.head 4 +  While SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If sTmp='902'
.head 6 -  Set strNls902=sNls
.head 5 +  Else If sTmp='90D'
.head 6 -  Set strNls90D=sNls
.head 5 +  Else If sTmp='T00'
.head 6 -  Set strNlsT00=sNls
.head 5 +  Else If sTmp='T0D'
.head 6 -  Set strNlsT0D=sNls
.head 4 -  !
.head 4 -  Set VRO.strSqlPopulate=
"SELECT arc_rrp.nlsb,
        convert(arc_rrp.nam_b,'CL8MSWIN1251','RU8PC866'),
        arc_rrp.dk, arc_rrp.mfoa, arc_rrp.nlsa, arc_rrp.s/100,
        convert(arc_rrp.nam_a,'CL8MSWIN1251','RU8PC866'),
        arc_rrp.rec,  C.nmk, A.kv
 INTO :VRO.NLSB, :VRO.NAM_B,:VRO.DK,:VRO.MFOA,:VRO.NLSA,:VRO.S,
      :VRO.NAM_A,:VRO.REC, :VRO.NMS,:VRO.KV
 FROM arc_rrp arc_rrp, accounts A, customer C,
 WHERE arc_rrp.rec in (select rec from rec_que)
   AND arc_rrp.blk =" || VRO.strPar01 || "
   AND arc_rrp.mfob=" || VRO.aMFO     || "
   AND arc_rrp.nlsb=A.nls
   AND arc_rrp.kv=A.kv AND A.rnk=C.RNK
   AND arc_rrp.fn_b is null " || IifS(VRO.nPar=0,"","
   AND A.isp="||Str(VRO.Id) ) || "
ORDER BY arc_rrp.rec "
.head 4 -  ! Set strSqlUpdate='UPDATE lkl_rrp SET lim=100*:colLTK,lno=100*:colLNO WHERE mfo=:colMFO'
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam )
.head 1 +  Form Window: splT902    ! 12
.head 2 -  Class: cGenericTableSpl1
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Розбір картотеки "До з'ясування"
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    1.458"
.head 4 -  Width:  12.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbBackToSender
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Повернути платнику'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 3)
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.686"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'На інший рахунок'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 1)
.head 4 +  Pushbutton: pbOutside
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'В інший банк'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 2)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вилучити'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 4)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.186"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.529"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зарахувати'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If tbl.OTM = 1
.head 8 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 1707
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  1.886"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.886"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.629"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.076"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If sFilt
.head 8 -  Call SalColorSet ( hWndItem, COLOR_IndexWindow, COLOR_LightPeriwinkle )
.head 7 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.519"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPr1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.399"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_link.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Отримана відповідь '
.head 6 +  On SAM_Click
.head 7 +  If tbl.RECO
.head 8 -  Call DocViewContents(hWndMDI,tbl.RECO)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.959"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1708
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  4.029"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.029"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.186"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1709
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl1
.head 5 -  Coordinates
.head 6 -  Begin X:  7.786"
.head 6 -  Begin Y:  0.406"
.head 6 -  End X:  7.786"
.head 6 -  End Y:  -0.01"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 1711
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.986"
.head 6 -  Begin Y:  0.406"
.head 6 -  End X:  6.986"
.head 6 -  End Y:  -0.01"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfSumT902
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.986"
.head 7 -  Top:    0.073"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On UM_Populate
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
     "SELECT ostc/100 INTO :dfSumT902
       FROM accounts
      WHERE rownum=1 and kv=:splT902.nKv and tip='902'")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set dfSumT902 = 0
.head 7 +  If dfSumT902 < 0
.head 8 -  Set dfSumT902 = -dfSumT902
.head 8 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_Red)
.head 7 +  Else
.head 8 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue)
.head 4 +  Pushbutton: pbAlt
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.972"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\App1.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'На альтернативний рахунок'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  ! On SAM_Click  Старий по одному
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,nms
     INTO :sNlsAlt,:sNamAlt
     FROM accounts
    WHERE nls=:tbl.NLSALT and kv=:tbl.KV") and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 5)
.head 7 +  Else 
.head 8 -  Call SalMessageBox("Рахунок " || tbl.NLSALT || " (альтернативний) НЕ знайдено !","Помилка!", 1)
.head 6 +  On SAM_Click   ! Новий груповий
.head 7 -  Set i=0
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext( tbl, nRow )
.head 8 -  Set i=i+1
.head 7 +  If i=1
.head 8 +  If SqlPrepareAndExecute(hSql(),
 " SELECT a.nls,a.nms,c.okpo
     INTO :sNlsAlt,:sNamAlt,:sOKPOAlt
     FROM accounts a,customer c
    WHERE a.nls=:tbl.NLSALT and a.kv=:tbl.KV and a.rnk=c.rnk") and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 5)
.head 8 +  Else
.head 9 -  Call SalMessageBox("Рахунок " || tbl.NLSALT || " (альтернативний) НЕ знайдено !","Помилка!", 1)
.head 7 +  Else If i>0
.head 8 -  Call SalMessageBeep(MB_IconQuestion)
.head 8 +  If SalMessageBox('Зарахувати на альтернативний рахунок '||Str(i)||' документів?',
'Увага!', MB_IconQuestion | MB_YesNo) != IDYES
.head 9 -  Return FALSE
.head 8 -  ! Групове зарахування на альтернативний рах
.head 8 -  Set bOk=TRUE
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tbl, nRow, ROW_Selected, 0 )
.head 9 -  Call SalTblSetContext( tbl, nRow )
.head 9 -  Call SalTblSetFocusRow( tbl, nRow )
.head 9 -  ! Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
.head 9 -  ! Call Debug('Внутри цыкла')
.head 9 +  If SqlPrepareAndExecute(hSql(),
 " SELECT a.nls,a.nms,c.okpo
     INTO :sNlsAlt,:sNamAlt,:sOKPOAlt
     FROM accounts a,customer c
    WHERE a.nls=:tbl.NLSALT and a.kv=:tbl.KV and a.rnk=c.rnk") and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  ! Call Debug('Счет найден '||tbl.NLSALT)
.head 10 -  If SqlPrepareAndExecute(hSql(),
 "SELECT nls,nms INTO :S902,:S902NAME FROM accounts WHERE acc=:splT902.tbl.ACC") and SqlFetchNext(hSql(),nFetchRes)
.head 10 -  ! IifN((sOrd902='N' or sOrd902='0'), tbl.REF, 0),
.head 10 -  Call cDocAlt.SetDoc( 0, 
     '901', tbl.DK, 6,'', dDat, dDat, dDat, dDat,
     S902, IifS(sNam902='Y',S902NAME,tbl.NAMA),
     GetBankMfo(),'', tbl.KV, tbl.S*100, tbl.OKPOA,
     SalStrTrimX(sNlsAlt), SalStrTrimX(sNamAlt),  GetBankMfo(),'', tbl.KV, tbl.S*100, SalStrTrimX(sOKPOAlt),
     SalStrTrimX('Док '||tbl.ND||' від '||SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy')||' '||tbl.NAZN),
     SalStrLeftX(SalStrTrimX('#C'||tbl.MFOA||','||tbl.NLSA ||','||tbl.NAMA),59)||'#',
     GetIdOper(),'',NUMBER_Null,0 )
.head 10 -  ! Call Debug('А теперь о-док!')
.head 10 -  Set cDocAlt.nRefDoc=tbl.REF
.head 10 +  If cDocAlt.oDoc()
.head 11 +  ! If SqlPrepareAndExecute( hSql()," UPDATE "|| strTabN || " SET sos=5 WHERE id=:colId")
.head 12 -    Call SqlCommit(hSql())
.head 11 +  ! Else
.head 12 -    Call SqlRollback(hSql())
.head 12 -    Set bOk=FALSE
.head 11 -  ! Call DebugN(cDocAlt.m_nRef)
.head 11 +  If not SqlCommitEx( hSql(), 'Док. реф.'||Str(tbl.REF)||' зараховано на альтернативний рахунок' )
.head 12 -  Break
.head 11 -  Set i = i - 1
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Set bOk=FALSE
.head 9 -  Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, FALSE )
.head 8 -  Call SaveFInfoToLog( IifS(bOk,'Преведено всі','Не проведено ' ||  Str(i) || ' документів'))
.head 8 -  Call MessageInfoEx('Готово.')
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 8 -  Call SalWaitCursor( FALSE )
.head 4 +  Pushbutton: pbRequest
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.419"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сформувати запит на уточнення реквізитів'
.head 6 +  On SAM_Click
.head 7 +  If MessageQuestion( 'Сформувати запит на уточнення реквізитів'||IifS(tbl.SOS=1,',ПОВТОРНО?','?')) != IDYES
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set nRow=TBL_MinRow
.head 7 -  !
.head 7 -  Call WaitCursorOn()
.head 7 -  !
.head 7 -  Set nTmp=0
.head 7 +  While SalTblFindNextRow ( tbl, nRow, ROW_Selected, 0 )
.head 8 -  !
.head 8 -  Call SalTblFetchRow( tbl, nRow )
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute( hSql(),'SELECT fa_name,fa_ln,datp,d_rec INTO :sFA_name,:nFA_ln,:dTmp,:sDREC FROM arc_rrp WHERE rec=:tbl.REC and fa_name is not null') and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call cDoc.SetDoc(0,sTT ,2, tbl.VOB,tbl.ND,tbl.DATD,dDat,dDat,dDat,
      tbl.NLSB, tbl.NAMB, sAMFO,   '',tbl.KV,tbl.S*100, tbl.OKPOB,
      tbl.NLSA, tbl.NAMA, tbl.MFOA,'',tbl.KV,tbl.S*100, tbl.OKPOA,
      'Запит на уточнення реквізитів документа','',GetIdOper(),'',NUMBER_Null, 0)
.head 9 -  Set cDoc.m_sDrec='#?'||PadR(sFA_name,12)||PadL(SalNumberToStrX(nFA_ln,0),6)||'#'
.head 9 -  !
.head 9 +  If tbl.OKPOA='0000000000'
.head 10 -  Set cDoc.m_sDrec=cDoc.m_sDrec||'фКлієнтом не надано#'
.head 9 +  If tbl.OKPOB='0000000000' 
.head 10 -  Set cDoc.m_sDrec=cDoc.m_sDrec||'ФКлієнтом не надано#'
.head 9 -  Set cDoc.m_sNazns = '11'
.head 9 -  Set cDoc.m_dDatP = dTmp
.head 9 +  If cDoc.oDoc()
.head 10 +  If not SqlPrepareAndExecute( hSql(),'UPDATE t902 SET otm=1,dat=:dDat WHERE rec=:tbl.REC')
.head 11 -  Break
.head 10 +  If not SqlCommitEx( hSql(), 'Формування запиту на уточнення реквізитів' )
.head 11 -  Break
.head 10 +  Else
.head 11 -  Set nTmp=nTmp+1
.head 9 +  Else
.head 10 -  Break
.head 8 +  Else
.head 9 -  Call MessageInfo( 'Неможливо сформувати запит на уточнення реквізитів документа '||tbl.ND )
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call MessageInfo( 'Сформовано '||Str(nTmp)||' запитів' )
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbReport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.429"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Logfile.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зформувати реєстр'
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlg_ZapReqPrt, hWndForm, 0, sRepFn)
.head 7 -  Call SalEnableWindow( pbPreView )
.head 4 +  Pushbutton: pbPreView
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.986"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перегляд звіту'
.head 7 -  Call SalDisableWindow( hWndItem )
.head 6 +  On SAM_Click
.head 7 -  Call DirectView(sRepFn)
.head 4 +  Combo Box: cmbKv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.886"
.head 6 -  Top:    0.073"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.26"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? No
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If SalStrScan(sFlags,'V')>=0
.head 8 +  If cmbKv.Init( hWndItem )
.head 9 -  Call cmbKv.Populate( hSql(), 'kv', 'lcv', 'tabval', 'where sv is not null order by kv desc' )
.head 9 -  Call cmbKv.SetSelectById( nKv )
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 -  Set nKv=cmbKv.nCurrentId
.head 7 -  Call SalSendMsg( tbl, UM_Populate, 0, 0 )
.head 4 +  ! cTBarButton: pbAlt2
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.2"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Set i=0
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext( tbl, nRow )
.head 8 -  Set i=i+1
.head 7 +  If i=1
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,nms
     INTO :sNlsAlt,:sNamAlt
     FROM accounts
    WHERE nls=:tbl.NLSALT and kv=:tbl.KV") and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 5)
.head 8 +  Else 
.head 9 -  Call SalMessageBox("Рахунок " || tbl.NLSALT || " (альтернативний) НЕ знайдено !","Помилка!", 1)
.head 7 +  Else If i>0
.head 8 -  Call SalMessageBeep(MB_IconQuestion)
.head 8 +  If SalMessageBox('Зарахувати на альтернативний рахунок '||Str(i)||' документів?',
'Увага!', MB_IconQuestion | MB_YesNo) != IDYES
.head 9 -  Return FALSE
.head 8 -  ! Групове зарахування на альтернативний рах
.head 8 -  Set bOk=TRUE
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tbl, nRow, ROW_Selected, 0 )
.head 9 -  Call SalTblSetContext( tbl, nRow )
.head 9 -  Call SalTblSetFocusRow( tbl, nRow )
.head 9 -  ! Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
.head 9 -  ! Call Debug('Внутри цыкла')
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,nms
     INTO :sNlsAlt,:sNamAlt
     FROM accounts
    WHERE nls=:tbl.NLSALT and kv=:tbl.KV") and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  ! Call Debug('Счет найден '||tbl.NLSALT)
.head 10 -  If SqlPrepareAndExecute(hSql(),
 "SELECT nls,nms INTO :S902,:S902NAME FROM accounts WHERE acc=:splT902.tbl.ACC") and SqlFetchNext(hSql(),nFetchRes)
.head 10 -  ! IifN((sOrd902='N' or sOrd902='0'), tbl.REF, 0),
.head 10 -  Call cDocAlt.SetDoc( 0, 
     '901', tbl.DK, 6,'', dDat, dDat, dDat, dDat,
     S902, IifS(sNam902='Y',S902NAME,tbl.NAMA),
     GetBankMfo(),'', tbl.KV, tbl.S*100, tbl.OKPOA,
     SalStrTrimX(sNlsAlt), SalStrTrimX(sNamAlt),  GetBankMfo(),'', tbl.KV, tbl.S*100, tbl.OKPOB2,
     SalStrTrimX('Док '||tbl.ND||' від '||SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy')||' '||tbl.NAZN),
     SalStrLeftX(SalStrTrimX('#C'||tbl.MFOA||','||tbl.NLSA ||','||tbl.NAMA),59)||'#',
     GetIdOper(),'',NUMBER_Null,0 )
.head 10 -  ! Call Debug('А теперь о-док!')
.head 10 -  Set cDocAlt.nRefDoc=tbl.REF
.head 10 +  If cDocAlt.oDoc()
.head 11 +  ! If SqlPrepareAndExecute( hSql()," UPDATE "|| strTabN || " SET sos=5 WHERE id=:colId")
.head 12 -    Call SqlCommit(hSql())
.head 11 +  ! Else
.head 12 -    Call SqlRollback(hSql())
.head 12 -    Set bOk=FALSE
.head 11 -  ! Call DebugN(cDocAlt.m_nRef)
.head 11 +  If not SqlCommitEx( hSql(), 'Док. реф.'||Str(tbl.REF)||' зараховано на альтернативний рахунок' )
.head 12 -  Break 
.head 11 -  Set i = i - 1
.head 10 +  Else 
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Set bOk=FALSE
.head 9 -  Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, FALSE )
.head 8 -  Call SaveFInfoToLog( IifS(bOk,'Преведено всі','Не проведено ' ||  Str(i) || ' документів'))
.head 8 -  Call MessageInfoEx('Готово.')
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 8 -  Call SalWaitCursor( FALSE )
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: REF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рефе-
ренція
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BLK   ! причина помещения на невыясненные
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Причина
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If bBlk902
.head 9 -  Call SalShowWindow(hWndItem)
.head 8 +  Else
.head 9 -  Call SalHideWindow(hWndItem)
.head 5 +  Column: MFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
A
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рахунок
A
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.229"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рахунок
Б
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKПO
Б
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отримувач

з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 49
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.439"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OTM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Відкр
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Призначення платежу
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: DK
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKПO
РАХ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMB2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва рахунку
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 50
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.439"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
зарахування
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: STMP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата / Час
зарахування
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm 
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N док

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платник
з документу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.486"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид
ОП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОПЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REFN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NEW ref
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKПO
A
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSALT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ALT
рахунок

з док
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAZS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
закриття рах
зарахування
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
состояния
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RECO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
состояния
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
Б
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ACC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DREC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: DREC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: sErrorTxt
.head 5 -  Number: nCurRow
.head 5 -  Number: nMinRow
.head 5 -  Number: nMaxRow
.head 5 -  Number: hPic
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalTblSetCellTextColor(S,   IifN(DK=0, COLOR_DarkRed, COLOR_DarkBlue), FALSE)
.head 6 -  Call SalTblSetCellTextColor(REF, IifN(DK=0, COLOR_DarkRed, COLOR_DarkBlue), FALSE)
.head 6 -  Set OPL = 0
.head 6 -  ! Здесь строчки НЕ переставлять !
.head 6 +  If SOS=1              ! отправили запрос
.head 7 -  Call XSalTblSetRowBackColor( hWndForm,lParam,COLOR_Yellow)
.head 6 +  If SOS=2 or SOS=3     ! замена ОКПО или счета
.head 7 -  Call XSalTblSetRowBackColor( hWndForm,lParam,IifN(SOS=2, COLOR_LightGreen, COLOR_Green))
.head 7 -  If SqlPrepareAndExecute(hSqlAux3(),
  "SELECT a.nlsb,a.nam_b,a.id_b,k.okpo,
          s.nms, NVL(s.pap/s.pap,0), s.nlsalt, s.dazs, s.blkk
    INTO :NLSB,:NAMB,:OKPOB,:OKPOB2,:NAMB2,:OTM,:NLSALT,:DAZS,:BLKK
    FROM arc_rrp a, t902 t, accounts s, customer k
   WHERE t.rec=:REC AND a.rec=t.rec_o AND (t.otm=2 or t.otm=3) AND a.dk=3 AND
         a.nlsb=s.nls (+) AND a.kv=s.kv (+) and s.rnk=k.rnk (+)") and
   SqlFetchNext( hSqlAux3(), nFetchRes )
.head 6 +  If SOS=4 or SOS=5 or SOS=6  ! вернуть-ош.запрос-ош.ответ
.head 7 -  Call XSalTblSetRowBackColor( hWndForm,lParam,IifN(SOS=4, COLOR_Salmon, IifN(SOS=5, COLOR_Red, COLOR_LightAqua)))
.head 6 +  If DK=1
.head 7 -  Set nSumD = nSumD + tbl.S
.head 7 -  Set nRowC = nRowC + 1
.head 6 +  If OTM and BLKK   ! счет блокирован
.head 7 -  Call XSalTblSetCellBackColor( NLSB, 0xffc0ff ) ! SalColorFromRGB( 230,245,240 ) )
.head 6 +  If OTM and DAZS   ! счет закрыт
.head 7 -  Call XSalTblSetCellBackColor( NLSB, COLOR_LightPeriwinkle )
.head 6 +  If DREC
.head 7 +  If SalStrScan(DREC,'#B')>=0
.head 8 -  Set DREC=SalStrRightX(DREC,SalStrLength(DREC)-IifN(SalStrLength(DREC)=5,5,4))
.head 6 +  If OKPOB != OKPOB2
.head 7 -  Call XSalTblSetCellBackColor( OKPOB, COLOR_Yellow )
.head 6 -  ! Установка флага для даты
.head 6 +  If SalDateCurrent() - STMP - 
IifN(SalDateWeekday ( SalDateCurrent())>= 2 
 and SalDateWeekday ( SalDateCurrent())<= 4, 2, 0 ) > 3
.head 7 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_UnusedFlag2, TRUE )
.head 5 +  ! On WM_Char
.head 6 +  If wParam = 32
.head 7 -  Call DocViewContents(hWndMDI, REC)
.head 5 +  On SAM_DoubleClick
.head 6 +  If REC
.head 7 -  Call DocViewContents(hWndMDI, REC)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalEnableWindow(pbBackToSender)
.head 6 -  Call SalEnableWindow(pbIns)
.head 6 +  If not bNOI
.head 7 -  Call SalEnableWindow(pbOutside)
.head 6 -  Call SalEnableWindow(pbDel)
.head 6 +  If DK=0
.head 7 -  Call SalDisableWindow(pbBackToSender)
.head 7 -  Call SalDisableWindow(pbOutside)
.head 6 +  If OTM and not DAZS
.head 7 -  Call SalEnableWindow(pbUpdate)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 6 +  If NLSALT
.head 7 -  Call SalEnableWindow(pbAlt)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbAlt)
.head 6 +  If SOS=0
.head 7 +  If MFOB=sAMFO
.head 8 -  Call SalEnableWindow(pbRequest)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pbRequest)
.head 7 -  Call SalDisableWindow(pbPr1)
.head 6 +  Else
.head 7 +  If SOS=1
.head 8 -  Call SalEnableWindow(pbRequest)
.head 8 -  Call SalDisableWindow(pbPr1)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pbRequest)
.head 8 -  Call SalEnableWindow(pbPr1)
.head 6 -  Set ml = 'Відправник:     МФО: ' || MFOA || ' , Рахунок: ' || NLSA || PutCrLf() ||
    PadR(NAMA, 38) || PutCrLf() || PutCrLf() || ' Отримувач:     МФО: ' ||
    GetBankMfo() || ' , Рахунок: ' || NLSB || PutCrLf() ||
    PadR(NAMB, 38) || PutCrLf() || PutCrLf() || 'Призначення платежу:' ||
    PutCrLf() || NAZN
.head 6 -  ! Управление кнопками
.head 6 +  If SalStrMidX(sFlagI,0,1)='0'
.head 7 -  Call SalDisableWindow( pbBackToSender )
.head 6 +  If SalStrMidX(sFlagI,1,1)='0'
.head 7 -  Call SalDisableWindow( pbIns )
.head 6 +  If SalStrMidX(sFlagI,2,1)='0'
.head 7 -  Call SalDisableWindow( pbOutside )
.head 6 +  If SalStrMidX(sFlagI,3,1)='0'
.head 7 -  Call SalDisableWindow( pbDel )
.head 6 +  If SalStrMidX(sFlagI,4,1)='0'
.head 7 -  Call SalDisableWindow( pbUpdate )
.head 6 +  If SalStrMidX(sFlagI,5,1)='0'
.head 7 -  Call SalDisableWindow( pbAlt )
.head 6 +  If SalStrMidX(sFlagI,6,1)='0'
.head 7 -  Call SalDisableWindow( pbRequest )
.head 5 +  On UM_Populate
.head 6 -  Call SalSendMsg(dfSumT902, UM_Populate, 0, 0)
.head 6 -  Set nSumD = 0
.head 6 -  Set nRowC = 0
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call SalTblDefineSplitWindow (tbl, 1, TRUE)
.head 6 -  Set nTmp = SalTblInsertRow(tbl, TBL_MinRow)
.head 6 -  Call SalTblSetContext(tbl, nTmp)
.head 6 -  Call SalTblSetRowFlags(tbl, nTmp, ROW_New, FALSE)
.head 6 -  Set tbl.S = nSumD
.head 6 -  Set tbl.REF = nRowC
.head 6 -  Call VisTblAutoSizeColumn(tbl, hWndNULL)
.head 6 -  ! Установить на старое место
.head 6 -  Call SalTblQueryScroll ( tbl, nTmp, nMinRow, nMaxRow )
.head 6 +  If nCurRow > nMaxRow
.head 7 -  Set nCurRow=nMaxRow
.head 6 -  Call SalTblSetContext( tbl, nCurRow )
.head 6 -  Call SalTblSetRowFlags( tbl, nCurRow, ROW_Selected, TRUE )
.head 6 -  Call SalTblSetFocusRow( tbl, nCurRow )
.head 6 -  Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
.head 5 -  On SAM_ContextMenu   ! не  удалять
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If SOS=1
.head 7 -  Set sErrorTxt = 'Відправлено запит'
.head 6 +  Else If SOS=2
.head 7 -  Set sErrorTxt = 'Отримано новий Ідент.Код '
.head 6 +  Else If SOS=3
.head 7 -  Set sErrorTxt = 'Отримано новий № рахунку'
.head 6 +  Else If SOS=4
.head 7 -  Set sErrorTxt = 'Отримано відповідь, що платежу нема в банку-відправнику'
.head 6 +  Else If SOS=5
.head 7 -  Set sErrorTxt = 'Отримано вимогу повернути'
.head 6 +  Else If SOS=6
.head 7 -  Set sErrorTxt = 'Отримано відповідь, що некоректно оформлена'
.head 6 +  Else
.head 7 -  Set sErrorTxt = ''
.head 7 +  If tbl.BLK
.head 8 -  Call SqlPrepareAndExecute(hSql(),
    "SELECT k_er||' '||n_er INTO :sErrorTxt
       FROM s_er   
      WHERE LPAD(:tbl.BLK,4,'0') = k_er")
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SqlPrepareAndExecute(hSql(), 
    'SELECT name
       FROM bp_rrp
       INTO :sErrorTxt
      WHERE rule=:tbl.BLK and fa=1')
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sErrorTxt = 'Бізнес правило № ' || Str(tbl.BLK) || IifS(Len(sErrorTxt)>0, ' (' || sErrorTxt || ')', '')
.head 6 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 6 -  Call XSalTooltipShow(hWndForm, sErrorTxt)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 5 +  On SAM_KillFocus
.head 6 -  Set nCurRow = SalTblQueryContext ( tbl )
.head 5 +  On SAM_Create
.head 6 -  Set hPic = VisPicLoad( PIC_LoadResource | PIC_FormatBitmap, VT_DLLName, VTPIC_DiamondBlackClosed )
.head 6 -  Call VisTblSetRowPicture (hWndForm, ROW_UnusedFlag2, hPic)
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 5 +  On SAM_Destroy
.head 6 -  Call VisPicFree ( hPic )
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 33
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Multiline Field: ml
.head 4 -  Class Child Ref Key: 32
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl1
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar     ! не использ
.head 3 -  String: sFlags   ! кнопки+признаки     '11111,V' (мультивал)
.head 3 -  String: sFilt    ! Предустановленный фильтер
.head 2 +  Window Variables
.head 3 -  Number: BLKK
.head 3 -  Number: nWid
.head 3 -  Number: nHei
.head 3 -  String: S902
.head 3 -  String: S902NAME
.head 3 -  String: sNlsAlt
.head 3 -  String: sNamAlt
.head 3 -  String: sOKPOAlt
.head 3 -  String: sDREC
.head 3 -  String: aDREC[*]
.head 3 -  Number: nRowC
.head 3 -  Number: nSumD
.head 3 -  Number: nFetchRes
.head 3 -  ! Number: nBaseVal
.head 3 -  Window Handle: hWinDoc
.head 3 -  !
.head 3 -  String: sPLSQL
.head 3 -  String: ss1
.head 3 -  String: ss2
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  String: s6
.head 3 -  String: s7  ! ОКПО відправника
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  String: sOrd902
.head 3 -  String: sOkp902
.head 3 -  String: sNam902
.head 3 -  String: sNaz902
.head 3 -  String: sTT
.head 3 -  String: sAMFO
.head 3 -  String: sFA_name
.head 3 -  Number: nFA_ln
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dDat1
.head 3 -  Date/Time: dDat2
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  String: sRepFn
.head 3 -  Boolean: bNOI
.head 3 -  Number: nKv
.head 3 -  Number: nWndX
.head 3 -  Number: nWndY
.head 3 -  String: sFlagI
.head 3 -  Boolean: bBlk902    ! Показывать код блокировки в "разборе невыясненных" 
.head 3 -  Number: i
.head 3 -  Number: bOk
.head 3 -  : cDocAlt
.head 4 -  Class: cDocAlt
.head 3 -  String: aDrec[10]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('12')
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set nKv      = GetBaseVal()
.head 4 -  Set dDat     = GetBankDate()
.head 4 -  Set sAMFO    = GetBankMfo()
.head 4 -  Set sOrd902  = GetGlobalOption( 'ORD902' )  ! Отдельный ордер по зачислению  Y/N
.head 4 -  Set sOkp902  = GetGlobalOption( 'OKP902' )  ! ОКПО платника-Y, банку-N
.head 4 -  Set sNam902  = GetGlobalOption( 'NAM902' )  ! Назва рахунку нез"ясованих-Y, стандарт-N
.head 4 -  Set sNaz902  = GetGlobalOption( 'NAZ902' )  ! Ф-я Призначення платежу при поверненні коштів з нез"яс
.head 4 -  Set bNOI     = GetGlobalOptionEx('NOI902')  ! Невозможно перенаправить платеж в другой банк
.head 4 -  Set bBlk902  = GetGlobalOptionEx('BLK92' )  ! Показывать код блокировки
.head 4 +  If SalStrScan(sFlags,',')>=0
.head 5 -  Set sFlagI=SalStrLeftX(sFlags,SalStrScan(sFlags,','))||'1111111'
.head 4 +  Else
.head 5 -  Set sFlagI=sFlags||'1111111'
.head 4 -  Set splT902.nTabInstance1 = 1
.head 4 +  If NOT sOrd902
.head 5 -  Set sOrd902='N'
.head 4 -  ! Получение операции для дебетовых информационных запросов
.head 4 -  Set sTT      = GetGlobalOption( 'ID_TT' )
.head 4 -  ! По умолчанию 014
.head 4 +  If NOT sTT
.head 5 -  Set sTT='014'
.head 4 -  Set strFilterTblName = 'ARC_RRP'
.head 4 -  Set strPrintFileName = 'T902.txt'
.head 4 -  Set splT902.strSqlPopulate = "
    SELECT o.dk,o.ref,a.mfoa,a.nlsa,a.s/100,a.nlsb,a.nam_b,a.nazn,a.d_rec,
           a.rec,o.fdat,a.nd,a.nam_a,a.vob,a.datd,a.id_a,a.id_b,k.okpo,s.nms,
           NVL(s.pap/s.pap,0),a.kv, s.nlsalt, s.dazs, "||IifS(bBlk902,'t.blk','NULL')||", t.otm, t.rec_o, t.stmp, s.blkk, a.mfob, o.acc
     FROM arc_rrp a, opldok o, t902 t, accounts s, customer k
    WHERE o.acc in (SELECT acc FROM accounts WHERE tip IN ('902','90D')) and
          o.tt in ('R01','D01') and a.rec=t.rec and o.ref=t.ref and a.nlsb=s.nls (+) and
          a.kv=s.kv (+) and s.rnk=k.rnk (+) "||
    IifS(SalStrLength(SalStrTrimX(sFilt)),"AND "||sFilt,'')||
    IifS(SalStrScan(sFlags,'V')>=0,' AND a.kv=:splT902.nKv ','')||
  " ORDER BY o.ref
    INTO :splT902.tbl.DK,:splT902.tbl.REF,:splT902.tbl.MFOA,:splT902.tbl.NLSA,
         :splT902.tbl.S,:splT902.tbl.NLSB,:splT902.tbl.NAMB,:splT902.tbl.NAZN,:splT902.tbl.DREC,
         :splT902.tbl.REC,:splT902.tbl.FDAT,:splT902.tbl.ND,:splT902.tbl.NAMA,
         :splT902.tbl.VOB,:splT902.tbl.DATD,:splT902.tbl.OKPOA,:splT902.tbl.OKPOB,
         :splT902.tbl.OKPOB2,:splT902.tbl.NAMB2,:splT902.tbl.OTM,:splT902.tbl.KV,
         :splT902.tbl.NLSALT,:splT902.tbl.DAZS, :splT902.tbl.BLK,:splT902.tbl.SOS, :splT902.tbl.RECO,
         :splT902.tbl.STMP,  :splT902.BLKK,:splT902.tbl.MFOB,:splT902.tbl.ACC "
.head 4 -  ! Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call tbl.cF.Init(strFilterTblName, 'a')
.head 3 +  On UM_ObjActivate
.head 4 +  If tbl.OPL = 0
.head 5 +  If lParam = 0 ! Зачислить
.head 6 -  Set s1 = SalStrTrimX(tbl.NAMB2) ! Получатель
.head 6 -  Set s2 = SalStrTrimX(tbl.NLSB)  ! Счет получателя
.head 6 -  Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -  Set s5 = IifS(tbl.SOS=2 or tbl.SOS=3,tbl.OKPOB,tbl.OKPOB2) ! ОКПО получателя
.head 6 -  Set s7 = IifS(sOkp902='Y',tbl.OKPOA,'')
.head 6 -  Set ss1 = 'ЗАРАХУВАТИ на рахунок ' || s2 || ' ' || s1 || ' ?'
.head 6 +  If sOrd902='N' or sOrd902='0'
.head 7 -  Set ss2 = "Буде добавлено проводку в основну операцію"
.head 7 -  Set s4  = tbl.NAZN               ! Назначение платежа
.head 7 -  Set s6  = tbl.DREC               ! Допреквізити
.head 6 +  Else
.head 7 -  Set ss2 = "Буде сформировано внутрішній мем.ордер"
.head 7 -  Set s4  = SalStrTrimX('Док '||tbl.ND||' від '||SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy')||' '||tbl.NAZN)
.head 7 -  Set s6  = SalStrLeftX(SalStrTrimX('#C'||tbl.MFOA||','||tbl.NLSA ||','||tbl.NAMA),59)||'#' ! Допреквізити
.head 5 +  If lParam = 1 ! На другой счет
.head 6 -  Set s1 = ''                     ! получатель
.head 6 -  Set s2 = ''                     ! Счет получателя
.head 6 -  Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -  Set s4  = SalStrTrimX('Док '||tbl.ND||' від '||SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy')||' '||tbl.NAZN)
.head 6 -  Set s5 = ''
.head 6 -  Set s6 = SalStrLeftX(SalStrTrimX('#C'||tbl.MFOA||','||tbl.NLSA ||','||tbl.NAMA),59)||'#' ! Допреквізити
.head 6 -  Set s7 = IifS(sOkp902='Y',tbl.OKPOA,'')
.head 6 -  Set ss1 = IifS(tbl.DK=0, "ПЕРЕДЕБЕ", "ПЕРЕКРЕДИ") || "ТУВАТИ документ на інший рахунок ?"
.head 6 -  Set ss2 = "Буде сформировано внутрішній мем.ордер"
.head 6 -  Set sPLSQL = "
BEGIN
  SEP.G_rec:="||Str(tbl.REC)||";
  SEP.G_mfoA:="||tbl.MFOA||";
  SEP.G_mfoB:="||s3||";
END; "
.head 6 -  Call SqlPrepareAndExecute( hSql(), sPLSQL )
.head 5 +  If lParam = 2 ! В другой банк
.head 6 -  Set s1 = ''                     ! получатель
.head 6 -  Set s2 = ''                     ! Счет получателя
.head 6 -  Set s3 = ''                     ! Банк получателя
.head 6 -  Set s4 = SalStrTrimX('Перекр.док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy') || '. Платник МФО ' || tbl.MFOA ||
    ' Рах ' || tbl.NLSA || ' ' || tbl.NAMA || ' ' || tbl.NAZN)
.head 6 -  Set s5 = ''
.head 6 -  Set s6 = tbl.DREC               ! Допреквізити
.head 6 -  Set s7 = IifS(sOkp902='Y',tbl.OKPOA,'')
.head 6 -  Set ss1 = "ПЕРЕКРЕДИТУВАТИ в інший банк ?"
.head 6 -  Set ss2 = "Буде сформировано новий документ"
.head 5 +  If lParam = 3 ! Вернуть плательщику
.head 6 -  Set s1 = tbl.NAMA               ! получатель
.head 6 -  Set s2 = tbl.NLSA               ! Счет получателя
.head 6 -  Set s3 = tbl.MFOA               ! Банк получателя
.head 6 -  Set s4 = SalStrTrimX('Повернено док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy') || ' Уточніть реквізити отримувача '
    || tbl.NLSB || ' ' || tbl.NAMB || ' ' || tbl.NAZN)
.head 6 +  If sNaz902
.head 7 -  Call SqlPrepareAndExecute(hSql(), "SELECT SUBSTR(" || sNaz902 ||"("||Str(tbl.REC)||") ,1,160) INTO :s4 FROM dual")
.head 7 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Set s5 = tbl.OKPOA
.head 6 -  Set s6 = IifS(tbl.BLK,'#CКод причини повернення:'||Str(tbl.BLK),'')
.head 6 +  If tbl.OKPOA='0000000000'
.head 7 -  Set i = SalStrTokenize( tbl.DREC, '', '#', aDrec )
.head 7 +  While i>0
.head 8 -  ! Call Debug(aDrec[i])
.head 8 +  If SalStrLeftX(aDrec[i],1)='Ф'
.head 9 -  Set s6=s6||'#ф'||SalStrRightX(aDrec[i],SalStrLength(aDrec[i])-1)
.head 8 -  Set i=i-1
.head 6 -  Set s6 = s6||IifS(SalStrLength(s6)>0,'#','')
.head 6 -  Set s7 = ''
.head 6 -  ! Call Debug('s6='||s6)
.head 6 -  Set ss1 = "ПОВЕРНУТИ кошти платнику ?"
.head 6 -  Set ss2 = "Буде сформовано зворотній міжбанківський платіж"
.head 5 +  If lParam = 4 ! Удалить из картотеки
.head 6 -  Set ss1 = "ВИЛУЧИТИ з картотеки нез'ясованих сум ?"
.head 6 -  Set ss2 = "Документ по перекредитуванню потрібно ввести окремо"
.head 5 +  If lParam = 5 ! На альтернативный счет
.head 6 -  Set s1 = SalStrTrimX(sNamAlt)   ! Получатель
.head 6 -  Set s2 = SalStrTrimX(sNlsAlt)   ! Счет получателя
.head 6 -  Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -  Set s4  = SalStrTrimX('Док '||tbl.ND||' від '||SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy')||' '||tbl.NAZN)
.head 6 -  Set s5 = SalStrTrimX(sOKPOAlt)  !--tbl.OKPOB2
.head 6 -  Set s6 = SalStrLeftX(SalStrTrimX('#C'||tbl.MFOA||','||tbl.NLSA ||','||tbl.NAMA),59)||'#' ! Допреквізити
.head 6 -  Set s7 = IifS(sOkp902='Y',tbl.OKPOA,'')
.head 6 -  Set ss1 = IifS(tbl.DK=0, "ПЕРЕДЕБЕ", "ПЕРЕКРЕДИ") || "ТУВАТИ документ на альтернативний рахунок ?"
.head 6 -  Set ss2 = "Буде сформировано внутрішній мем.ордер"
.head 5 +  If SalMessageBox(ss1 || PutCrLf() || ss2, 'Увага', MB_YesNo | MB_IconHand) = IDYES
.head 6 +  If lParam < 4 or lParam = 5
.head 7 +  If not IsWindow(hWinDoc)
.head 8 +  If SqlPrepareAndExecute(hSql(),
 "SELECT nls,nms INTO :S902,:S902NAME FROM accounts WHERE acc=:splT902.tbl.ACC") and SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set hWinDoc = SalCreateWindow(frmDoc, hWndMDI, hWndForm, tbl, tbl.REC, tbl.REF,
    IifN(lParam=0 and (sOrd902='N' or sOrd902='0'), tbl.REF, 0), tbl.DK, IifS(s3=GetBankMfo(), '901', '902'),
    tbl.S*100, IifS(s7='',IifS(sNam902='Y',S902NAME,''),tbl.NAMA),
    s1, S902, s2, s3, s7, s5, s4, s6, tbl.KV, lParam)
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute(hSql(), "DELETE FROM t902 WHERE ref=:tbl.REF")
.head 8 -  Call SqlCommitEx(hSql(), ss1 || ' REF=' || Str(tbl.REF))
.head 8 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_ObjDeactivate
.head 4 +  If lParam
.head 5 -  Call SalDisableWindow(pbBackToSender)
.head 5 -  Call SalDisableWindow(pbIns)
.head 5 -  Call SalDisableWindow(pbOutside)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalDisableWindow(pbAlt)
.head 5 -  Call SalDisableWindow(pbRefresh)
.head 5 -  Call SalDisableWindow(pbUpdate)
.head 5 -  Call SalDisableWindow(pbSearch)
.head 5 -  Call SalDisableWindow(pbFilter)
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 5 -  Call SalDisableWindow(tbl)
.head 5 -  Call SalDisableWindow(ml)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbBackToSender)
.head 5 -  Call SalEnableWindow(pbIns)
.head 5 +  If not bNOI
.head 6 -  Call SalEnableWindow(pbOutside)
.head 5 -  Call SalEnableWindow(pbDel)
.head 5 -  Call SalEnableWindow(pbAlt)
.head 5 -  Call SalEnableWindow(pbRefresh)
.head 5 -  Call SalEnableWindow(pbUpdate)
.head 5 -  Call SalEnableWindow(pbSearch)
.head 5 -  Call SalEnableWindow(pbFilter)
.head 5 -  Call SalEnableWindow(pbDetails)
.head 5 -  Call SalEnableWindow(pbPrint)
.head 5 -  Call SalEnableWindow(tbl)
.head 5 -  Call SalEnableWindow(ml)
.head 1 +  Table Window: tblVisnovki    ! 13
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Підтвердження висновків з районів
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.013"
.head 4 -  Top:    1.677"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 3333
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26744
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If sFilt
.head 8 -  Call SalColorSet ( hWndItem, COLOR_IndexWindow, COLOR_LightPeriwinkle )
.head 7 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26745
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26746
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.867"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Внести в картотеку'
.head 6 +  On SAM_Click
.head 7 -  Call PayK2Documents()
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 2 +  Contents
.head 3 +  Column: colREC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ID
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Document
reference
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Transaction
code
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: User
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.543"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: N
висновку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
висновку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MFO - A

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал. А
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Value
Date
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Db
Cr
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Type
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поступив
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFN_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поступив
в файлі
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREC_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Record
number
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAM_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Payee
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAM_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Reciever
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Payment Details
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colD_REC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 80
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 9
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: PayK2Documents
.head 4 -  Description: Произвести операции с отмеченными документами таблицы
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowIterator
.head 5 -  String: strAction ! Пояснение действия.
.head 5 -  : ccDoc	  ! Документ
.head 6 -  Class: cDoc
.head 5 -  Number: nVidPl
.head 5 -  Number: nTmp
.head 5 -  Number: i
.head 5 -  Number: nDelta
.head 5 -  String: sTolog
.head 4 +  Actions
.head 5 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  Call SalMessageBeep(MB_IconQuestion)
.head 6 +  If SalMessageBox('Внести відмічені документи в картотеку ?', 'Увага !', MB_IconQuestion | MB_YesNo) != IDYES
.head 7 -  Return FALSE
.head 6 -  Set nRowIterator = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRowIterator, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRowIterator)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT rec  INTO   :nTmp
   FROM tzapros
  WHERE rec=:tblVisnovki.colREC FOR UPDATE OF rec NOWAIT")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sTmp=STRING_Null
.head 9 -  ! Call Debug(colOKPOB)
.head 9 +  If colOKPOB = '0000000000'
.head 10 -  Set i = SalStrScan(colD_REC, '#ф')
.head 10 -  ! Call DebugN(i)
.head 10 +  If i >= 0
.head 11 -  Set sTmp = SalStrMidX(colD_REC, i, SalStrLength(colD_REC)-i)
.head 11 -  ! Call Debug(sTmp||'->'||SalStrMidX( sTmp, 1, SalStrLength(sTmp)-1 ))
.head 11 -  Set sTmp = SalStrMidX(sTmp, 0, SalStrScan( SalStrMidX( sTmp, 1, SalStrLength(sTmp)-1 ), '#')+2)
.head 11 -  ! Call Debug(sTmp||'-'||Str(SalStrLength(sTmp)))
.head 9 -  Call ccDoc.SetDoc(0, 'K2A', 1, 1, colND, colDDAT, colDAT_A, GetBankDate(), GetBankDate(), colNLSA, colNAM_A,
     colMFOA,'', colKV, colS*100, colOKPOA, colNLSB, colNAM_B, colMFOB,'', colKV, colS*100, colOKPOB, colNAZN,
     sTmp, GetIdOper(), '', NUMBER_Null, 0)
.head 9 +  If not ccDoc.oDoc()
.head 10 -  Call SqlRollback(hSql())
.head 9 +  Else
.head 10 +  If nMode = 1
.head 11 -  Set nDelta = 0
.head 11 -  Set i = SalStrScan(sNbsList, SalStrLeftX(colNLSA, 4))
.head 11 -  ! Call DebugN(i)
.head 11 +  If i >= 0 and i+4 < SalStrLength(sNbsList)
.head 12 -  Set nDelta = SalStrToNumber(SalStrMidX(sNbsList, SalStrScan(sNbsList, SalStrLeftX(colNLSA, 4))+4, 1))
.head 12 -  ! Call DebugN(nDelta)
.head 11 -  Set nVidPl = IifN(colMFOB=GetBankMfo(), 2, 1) + nDelta
.head 10 +  Else
.head 11 -  Set nVidPl = IifN(colMFOB=GetBankMfo(), 2, 1) + IifN(SalStrLeftX(colNLSA,4)='3412', 3, 0)
.head 10 +  If not SqlPrepareAndExecute(hSql(),
 "INSERT INTO   operw (ref,tag,value)
  VALUES (:ccDoc.m_nRef,'VIDPL',:nVidPl)")
.head 11 -  Call SqlRollback(hSql())
.head 10 +  Else
.head 11 +  If not SqlPrepareAndExecute(hSql(), "
   DELETE
   FROM   tzapros
   WHERE  rec=:tblVisnovki.colREC")
.head 12 -  Call SqlRollback(hSql())
.head 11 +  Else
.head 12 -  Set sTolog = 'ВИСНОВОК(Помещ)  ' || colND || '  ' || colNLSA || '  ' || colMFOB || '  ' || colNLSB || '  '
    || SalNumberToStrX(colS, 2)
.head 12 +  If Left(colFN_A, 2) = '$A' ! только для СВОИХ ВИСНОВКОВ
.head 13 -  ! записать в файл для МФО, начинающегося на 8
.head 13 +  If Kart8Elektro(sBackDocPath, ccDoc.m_nRef, colREC, colFN_A, colVOB, colND, colS, colNLSA, colMFOA,
   colNLSB, colMFOB, colOKPOB, colNAM_B, colNAZN, colREF_A)
.head 14 -  Call SqlCommit(hSql())
.head 14 -  ! здесь запись про ВИСНОВКИ
.head 14 -  Call SaveInfoToLog(sTolog)
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 12 +  Else ! !!!!!!!!!!!!!!!!!!!!! !!!!!! для ЧУЖЫХ ВИСНОВКОВ
.head 13 -  Call SqlCommit(hSql())
.head 13 -  Call SaveInfoToLog(sTolog)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: Back8Elektro
.head 4 -  Description: Возврат ВИСНОВКІВ клиентам (сотворение файла ABS_VISN.DEL)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sPath
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: fH
.head 5 -  Number: nRowIterator
.head 5 -  String: sBuffer
.head 5 -  String: sKOKB
.head 5 -  Number: nI
.head 5 -  String: sTemp
.head 5 -  File Handle: hB014
.head 4 +  Actions
.head 5 -  ! TODO: SEP-2 Encoding
.head 5 +  If SalTblAnyRows(hWndForm, ROW_MarkDeleted, 0)
.head 6 +  If SalFileOpen(fH, sPath || '\\ABS_VISN.T' || sUserId, IifN(File(sPath || '\\ABS_VISN.T' || sUserId),
   OF_Append | OF_Write, OF_Create | OF_Write))
.head 7 -  Set nRowIterator = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRowIterator, ROW_MarkDeleted, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRowIterator)
.head 8 -  ! select colFN_A(выгрести SAB=substr(colFN_A,3,4)),colVOB,colND,colS,colNLSA,colMFOA,colNLSB,colMFOB,
         colD_REC(выгрести KOKB),colNAM_B(=KORR),colNAZN,SalFmtFormatDateTime(GetBankDate(), 'dd/MM/yy ') ||
         'Отказано в помещении в картотеку', 40) || colREF_A(=POND)
.head 6 +  Else
.head 7 -  Call MessageNoWait('Ошибка открытия файла ' || sPath || '\\ABS_VISN.T' || sUserId, 'ВНИМАНИЕ !!!', 7, 1)
.head 7 -  Return FALSE
.head 6 -  Set nRowIterator = TBL_MinRow
.head 6 -  Set nIs = 0
.head 6 -  Call SalArraySetUpperBound(smNDs, 1, -1)
.head 6 -  Call SalArraySetUpperBound(smNLSAs, 1, -1)
.head 6 -  Call SalArraySetUpperBound(smMFOBs, 1, -1)
.head 6 -  Call SalArraySetUpperBound(smNLSBs, 1, -1)
.head 6 -  Call SalArraySetUpperBound(nmSs, 1, -1)
.head 6 +  While SalTblFindNextRow(hWndForm, nRowIterator, ROW_MarkDeleted, 0)
.head 7 -  Call SalTblFetchRow(hWndForm, nRowIterator)
.head 7 +  If colOKPOB = ''
.head 8 -  Set sKOKB = '99999999'
.head 8 -  Set nI = At('#o', colD_REC)
.head 8 +  If nI > 0
.head 9 -  Set sTemp = Right(colD_REC, Len(colD_REC)-2)
.head 9 -  Set nI = At('#', sTemp)
.head 9 +  If nI > 0
.head 10 -  Set sKOKB = Left(sTemp, nI-1)
.head 7 +  Else
.head 8 -  Set sKOKB = colOKPOB
.head 7 -  Set sBuffer = StrWinToDosX(PadL(Str(colREC), 10) || colFN_A || PadL(Str(colVOB), 2) || PadR(colND, 10) || PadL(
    Str(colS*100), 16) || PadR(colNLSA, 14) || PadL(colMFOA, 9) || PadR(colNLSB, 14) || PadL(colMFOB, 9) ||
    PadR(sKOKB, 14) || PadR(colNAM_B, 38) || PadR(colNAZN, 160) || PadR(SalFmtFormatDateTime(
    GetBankDate(), 'dd/MM/yy ') || 'Не принят в картотеку', 40) || PadR(colREF_A, 9)) || PutCrLf()
.head 7 -  Set smNDs[nIs] = colND
.head 7 -  Set smNLSAs[nIs] = colNLSA
.head 7 -  Set smMFOBs[nIs] = colMFOB
.head 7 -  Set smNLSBs[nIs] = colNLSB
.head 7 -  Set nmSs[nIs] = colS
.head 7 -  Set nIs = nIs + 1
.head 7 -  ! здесь накапливать массивы для дальнейшего вывода в журнал
.head 7 +  If SalFileWrite(fH, sBuffer, Len(sBuffer)) != Len(sBuffer)
.head 8 -  Call SalFileClose(fH)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call VisFileDelete(sPath || '\\ABS_VISN.T' || sUserId)
.head 8 -  Call MessageNoWait('Ошибка записи в файл ' || sPath || '\\ABS_VISN.T' || sUserId, 'ВНИМАНИЕ !!!', 7, 1)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Return FALSE
.head 6 -  Call SalFileClose(fH)
.head 6 -  ! если есть файл ATBU_DEL.TMP, и его НЕЛЬЗЯ удалить, ЖДАТЬ, значит работает ATBU
.head 6 +  Loop
.head 7 +  If File(sPath || '\\ATBU_DEL.TMP')
.head 8 -  Call MessageNoWait('Ожидайте, работает монитор КЛИЕНТ-БАНК (ATBU.EXE) ...', 'ВНИМАНИЕ !!!', nTimeWaitMessage, 0)
.head 8 -  Call VisFileDelete(sPath || '\\ATBU_DEL.TMP')
.head 7 +  Else
.head 8 -  Break
.head 6 -  ! создать файл B014_DEL.TMP, если его нет,
! если есть (значит работает другой операционист) ПОДОЖДАТЬ
.head 6 +  Loop
.head 7 +  If not File(sPath || '\\B014_DEL.TMP')
.head 8 -  Call SalFileOpen(hB014, sPath || '\\B014_DEL.TMP', OF_Create | OF_Share_Deny_None)
.head 8 -  Break
.head 7 +  Else
.head 8 -  Call MessageNoWait('Ожидайте, выполняется возврат документов, НЕ ПРИНЯТЫХ В КАРТОТЕКУ, другим пользователем АБС ...',
     'ВНИМАНИЕ !!!', nTimeWaitMessage, 0)
.head 6 +  If File(sPath || '\\ABS_VISN.DEL')
.head 7 +  If VisFileAppend(sPath || '\\ABS_VISN.T' || sUserId, sPath || '\\ABS_VISN.DEL') < 0
.head 8 -  ! Error
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call VisFileDelete(sPath || '\\ABS_VISN.T' || sUserId)
.head 8 -  Call SalFileClose(hB014)
.head 8 -  Call VisFileDelete(sPath || '\\B014_DEL.TMP')
.head 8 -  Call MessageNoWait('Невозможно обновить файл ' || sPath || '\\ABS_VISN.DEL', 'ВНИМАНИЕ !!!', 7, 1)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 +  If VisFileCopy(sPath || '\\ABS_VISN.T' || sUserId, sPath || '\\ABS_VISN.DEL') < 0
.head 8 -  ! Error
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call VisFileDelete(sPath || '\\ABS_VISN.T' || sUserId)
.head 8 -  Call SalFileClose(hB014)
.head 8 -  Call VisFileDelete(sPath || '\\B014_DEL.TMP')
.head 8 -  Call MessageNoWait('Невозможно создать файл ' || sPath || '\\ABS_VISN.DEL', 'ВНИМАНИЕ !!!', 7, 1)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Return FALSE
.head 6 -  Call VisFileDelete(sPath || '\\ABS_VISN.T' || sUserId)
.head 6 -  Call SalFileClose(hB014)
.head 6 -  Call VisFileDelete(sPath || '\\B014_DEL.TMP')
.head 6 -  Return TRUE
.head 6 -  ! Call SalMessageBeep(MB_IconQuestion)
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: Kart8Elektro
.head 4 -  Description: ВИСНОВКИ, принятые в К-2 (сотворение файла ABS_VISN.KRT)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sPath
.head 5 -  Number: nREF
.head 5 -  Number: nREC
.head 5 -  String: sFN_A
.head 5 -  Number: nVOB
.head 5 -  String: sND
.head 5 -  Number: nS
.head 5 -  String: sNLSA
.head 5 -  String: sMFOA
.head 5 -  String: sNLSB
.head 5 -  String: sMFOB
.head 5 -  String: sOKPOB
.head 5 -  String: sNAM_B
.head 5 -  String: sNAZN
.head 5 -  String: sREF_A
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: fH
.head 5 -  String: sBuffer
.head 5 -  File Handle: hB014
.head 4 +  Actions
.head 5 -  ! TODO: SEP-2 Encoding
.head 5 -  If SalFileOpen(fH, sPath || '\\ABS_VISN.G' || sUserId,
   IifN(File(sPath || '\\ABS_VISN.G' || sUserId),
   OF_Append | OF_Write, OF_Create | OF_Write))
.head 5 +  Else
.head 6 -  Call MessageNoWait('Ошибка открытия файла ' || sPath || '\\ABS_VISN.G' || sUserId, 'ВНИМАНИЕ !!!', 7, 1)
.head 6 -  Return FALSE
.head 5 -  Set sBuffer = StrWinToDosX(PadL(Str(nREF), 10) || PadL(Str(nREC), 10) || sFN_A || PadL(Str(nVOB), 2) || PadR(sND, 10) ||
    PadL(Str(nS*100), 16) || PadR(sNLSA, 14) || PadL(sMFOA, 9) || PadR(sNLSB, 14) || PadL(sMFOB, 9) || PadR(sOKPOB, 14)
    || PadR(sNAM_B, 38) || PadR(sNAZN, 160) || PadR(sREF_A, 9)) || PutCrLf()
.head 5 +  If SalFileWrite(fH, sBuffer, Len(sBuffer)) != Len(sBuffer)
.head 6 -  Call SalFileClose(fH)
.head 6 -  Call VisFileDelete(sPath || '\\ABS_VISN.G' || sUserId)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call MessageNoWait('Ошибка записи в файл ' || sPath || '\\ABS_VISN.G' || sUserId, 'ВНИМАНИЕ !!!', 7, 1)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Return FALSE
.head 5 -  Call SalFileClose(fH)
.head 5 -  ! если есть файл ATBU_KRT.TMP, и его НЕЛЬЗЯ удалить, ЖДАТЬ, значит работает ATBU
.head 5 +  Loop
.head 6 +  If File(sPath || '\\ATBU_KRT.TMP')
.head 7 -  Call MessageNoWait('Ожидайте, работает монитор КЛИЕНТ-БАНК (ATBU.EXE) ...', 'ВНИМАНИЕ !!!', nTimeWaitMessage, 0)
.head 7 -  Call VisFileDelete(sPath || '\\ATBU_KRT.TMP')
.head 6 +  Else
.head 7 -  Break
.head 5 -  ! создать файл B014_KRT.TMP, если его нет,
! если есть (значит работает другой операционист) ПОДОЖДАТЬ
.head 5 +  Loop
.head 6 +  If not File(sPath || '\\B014_KRT.TMP')
.head 7 -  Call SalFileOpen(hB014, sPath || '\\B014_KRT.TMP', OF_Create | OF_Share_Deny_None)
.head 7 -  Break
.head 6 +  Else
.head 7 -  Call MessageNoWait('Ожидайте, выполняется обработка документов, ПРИНЯТЫХ В КАРТОТЕКУ, другим пользователем АБС ...',
     'ВНИМАНИЕ !!!', nTimeWaitMessage, 0)
.head 5 +  If File(sPath || '\\ABS_VISN.KRT')
.head 6 +  If VisFileAppend(sPath || '\\ABS_VISN.G' || sUserId, sPath || '\\ABS_VISN.KRT') < 0
.head 7 -  ! Error
.head 7 -  Call VisFileDelete(sPath || '\\ABS_VISN.G' || sUserId)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalFileClose(hB014)
.head 7 -  Call VisFileDelete(sPath || '\\B014_KRT.TMP')
.head 7 -  Call MessageNoWait('Невозможно обновить файл ' || sPath || '\\ABS_VISN.KRT', 'ВНИМАНИЕ !!!', 7, 1)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 +  If VisFileCopy(sPath || '\\ABS_VISN.G' || sUserId, sPath || '\\ABS_VISN.KRT') < 0
.head 7 -  ! Error
.head 7 -  Call VisFileDelete(sPath || '\\ABS_VISN.G' || sUserId)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalFileClose(hB014)
.head 7 -  Call VisFileDelete(sPath || '\\B014_KRT.TMP')
.head 7 -  Call MessageNoWait('Невозможно создать файл ' || sPath || '\\ABS_VISN.KRT', 'ВНИМАНИЕ !!!', 7, 1)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Return FALSE
.head 5 -  Call VisFileDelete(sPath || '\\ABS_VISN.G' || sUserId)
.head 5 -  Call SalFileClose(hB014)
.head 5 -  Call VisFileDelete(sPath || '\\B014_KRT.TMP')
.head 5 -  Return TRUE
.head 3 +  Function: NumberToHexSX36mom
.head 4 -  Description: Преобразует число в строку 36-ричных кодов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nNumber
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strHex
.head 5 -  Number: nRmd
.head 5 -  Number: nDvd
.head 4 +  Actions
.head 5 -  Set nDvd = nNumber
.head 5 -  Set nRmd = 0
.head 5 -  Set strHex = ''
.head 5 +  Loop
.head 6 +  If nDvd = 0
.head 7 -  Break
.head 6 -  Set nRmd = SalNumberMod(nDvd, 36)
.head 6 -  Set nDvd = SalNumberTruncate(nDvd/36, 10, 0)
.head 6 +  ! If nRmd < 10
.head 7 -  Set strHex = SalNumberToChar(nRmd+48) || strHex
.head 6 +  ! Else
.head 7 -  Set strHex = SalNumberToChar(nRmd+55) || strHex
.head 6 -  Set strHex = SalNumberToChar(nRmd+IifN(nRmd<10, 48, 55)) || strHex
.head 5 +  If SalNumberMod(SalStrLength(strHex), 2) != 0
.head 6 -  Set strHex = '0' || strHex
.head 5 -  Return strHex
.head 2 +  Window Parameters
.head 3 -  Number: nMode    ! 0 - старая версия, 1 - новая версия (со списком бал счетов)
.head 3 -  String: sNbsList ! список б/с вида с VIDPL  BBBBV,BBBBV,....
.head 3 -  String: sFilt    ! зовнішній фільтр
.head 2 +  Window Variables
.head 3 -  String: sAMFO
.head 3 -  String: sBackDocPath
.head 3 -  Boolean: bOk
.head 3 -  String: sTmp
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  String: sUserId
.head 3 -  !
.head 3 -  Number: nIs
.head 3 -  String: smNDs[*]
.head 3 -  String: smNLSAs[*]
.head 3 -  String: smMFOBs[*]
.head 3 -  String: smNLSBs[*]
.head 3 -  Number: nmSs[*]
.head 3 -  !
.head 3 -  Number: nTimeWaitMessage
.head 3 -  String: sTimeWaitMessage
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sAMFO = GetBankMfo()
.head 4 -  Set sUserId = NumberToHexSX36mom(GetUserId())
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('ElektroKlients', 'BackDocPath', GetPrnDir(), sBackDocPath, GetIniFileName())
.head 4 -  Call SalGetProfileString('ElektroKlients', 'TimeWaitMessage', '3', sTimeWaitMessage, GetIniFileName())
.head 4 -  Set nTimeWaitMessage = Max(0, Val(sTimeWaitMessage))
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call ShowApdVersion('13')
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set tblVisnovki.strFilterTblName = 'ARC_RRP'
.head 4 -  Set tblVisnovki.strPrintFileName = 'Visnovky.txt'
.head 4 -  Set tblVisnovki.strSqlPopulate = '
    SELECT rec,nd,datd,mfoa,nlsa,mfob,nlsb,dk,s/100,vob,kv,fn_a,dat_a,rec_a,nam_a,nam_b,nazn,d_rec,fn_a,ref_a,id_a,id_b
    FROM   arc_rrp
    WHERE  dk=3 and s>0 and NVL(blk,0)=0 and mfoa=' || GetBankMfo() ||
  ' and rec in (SELECT rec FROM   Tzapros) '||
    IifS(SalStrLength(SalStrTrimX(sFilt)),' and '||sFilt,'')||
  ' ORDER BY dat_a,rec_a
    INTO :tblVisnovki.colREC,:tblVisnovki.colND,:tblVisnovki.colDDAT,:tblVisnovki.colMFOA,:tblVisnovki.colNLSA,
         :tblVisnovki.colMFOB,:tblVisnovki.colNLSB,:tblVisnovki.colDK,:tblVisnovki.colS,:tblVisnovki.colVOB,
         :tblVisnovki.colKV,:tblVisnovki.colFN_A,:tblVisnovki.colDAT_A,:tblVisnovki.colREC_A,:tblVisnovki.colNAM_A,
         :tblVisnovki.colNAM_B,:tblVisnovki.colNAZN,:tblVisnovki.colD_REC,:tblVisnovki.colFN_A,:tblVisnovki.colREF_A,
         :tblVisnovki.colOKPOA,:tblVisnovki.colOKPOB'
.head 4 -  Set tblVisnovki.strSqlDelete = '
    DELETE
    FROM   Tzapros
    WHERE  rec=:tblVisnovki.colREC'
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 3)
.head 4 -  Set nFlags = GT_NoRet | GT_NoIns
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  If GetGlobalOptionEx('SEPNUM') = 2
.head 4 +  Else
.head 5 -  Set colNAM_A = StrDosToWinX(colNAM_A)
.head 5 -  Set colNAM_B = StrDosToWinX(colNAM_B)
.head 5 -  Set colNAZN = StrDosToWinX(colNAZN)
.head 4 +  If colOKPOB = ''
.head 5 -  Set nI = At('#o', colD_REC)
.head 5 +  If nI > 0
.head 6 -  Set sTmp = Right(colD_REC, Len(colD_REC)-2)
.head 6 -  Set nI = At('#', sTmp)
.head 6 +  If nI > 0
.head 7 -  Set colOKPOB = Left(sTmp, nI-1)
.head 5 +  Else
.head 6 -  Set colOKPOB = '99999'
.head 3 +  On SAM_DoubleClick
.head 4 -  Call DocViewContents(hWndMDI, tblVisnovki.colREC)
.head 3 +  On UM_Update
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
.head 4 +  If strSqlDelete != ''
.head 5 -  Set bOk = TRUE
.head 5 +  If Left(sAMFO, 1) = '8'
.head 6 -  ! сформировать квитанцию на возврат ВИСНОВКІВ эл.клиентам (районы) KAZNA
.head 6 -  Set bOk = Back8Elektro(sBackDocPath) ! расскомментировать для работы
.head 5 +  If bOk
.head 6 -  Call SqlPrepare(cMain.hSql(), T(strSqlDelete))
.head 6 -  Call SalTblDoDeletes(hWndForm, cMain.hSql(), ROW_MarkDeleted)
.head 6 -  Call SqlCommit(cMain.hSql())
.head 6 -  ! здесь запись про ВИСНОВКИ
.head 6 -  Set nI = 0
.head 6 +  While nI < nIs
.head 7 -  Call SaveInfoToLog('ВИСНОВОК(Возвр)  ' || smNDs[nI] || '  ' || smNLSAs[nI] || '  ' || smMFOBs[nI] || '  ' ||
     smNLSBs[nI] || '  ' || SalNumberToStrX(nmSs[nI], 2))
.head 7 -  Set nI = nI + 1
.head 4 +  If strSqlInsert != ''
.head 5 -  Call SqlPrepare(cMain.hSql(), T(strSqlInsert))
.head 5 -  Call SalTblDoInserts(hWndForm, cMain.hSql(), TRUE)
.head 4 +  If strSqlUpdate != ''
.head 5 -  Call SqlPrepare(cMain.hSql(), T(strSqlUpdate))
.head 5 -  Call SalTblDoUpdates(hWndForm, cMain.hSql(), TRUE)
.head 4 -  Call SqlCommit(cMain.hSql())
.head 4 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: frmDoc                 ! 14
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 29155
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 29156
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 29157
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 29158
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 29159
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 29150
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sSndr
.head 7 -  Set dfNamA=sSndr
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If strOkpoA
.head 7 -  Set dfOkpoA=strOkpoA
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNamB=sRcvr
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfOkpoB=strOkpoB
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -                                          Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -                                          Call frmDoc.HideIt(hWndItem)
.head 5 +  On SAM_Create
.head 6 +  If bSplitS
.head 7 -  Call SqlPrepareAndExecute(hSql(),"SELECT s INTO :nSrest FROM t902 WHERE ref=:nRefPara0 FOR UPDATE OF ref NOWAIT")
.head 7 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx('Ошибка : Невозможно получить доступ к Реф.'||SalNumberToStrX(nRefPara0,0) || '.')
.head 8 -  Return FALSE
.head 7 +  If not nSrest
.head 8 -  Set nSrest=nAmnt
.head 7 -  Set frmDoc.nS=nSrest/SalNumberPower(10, frmDoc.nDigA)
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  Else
.head 7 -  Set frmDoc.nS=nAmnt/SalNumberPower(10, frmDoc.nDigA)
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 7 -  Call frmDoc.HideIt(hWndItem)
.head 5 +  On SAM_Validate
.head 6 +  If bSplitS
.head 7 +  If SalSendClassMessage( SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 +  If dfSumC*SalNumberPower(10, frmDoc.nDigA)>nSrest
.head 9 -  Call SalMessageBox('Превышен остаток суммы документа ('||Str(nSrest)||').',CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return SalSendClassMessage( SAM_Validate, 0, 0 )
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNazn=strNazn
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrTxt
.head 5 -  Number: nDk0
.head 5 -  Number: nSdocA
.head 5 -  Number: nSdocB
.head 4 +  Actions
.head 5 -  Set nDk0=cDocW.m_nDk
.head 5 -  Set nSdocA=cDocW.A.S
.head 5 -  Set nSdocB=cDocW.B.S
.head 5 -  Set cDocW.m_nRef=nRefPara1
.head 5 -  Set cDocW.m_sDrec=strDrec
.head 5 +  If cDocW.m_sDrec
.head 6 -  Set cDocW.m_sNazns = '11'
.head 5 +  Else
.head 6 -  Set cDocW.m_sNazns = '10'
.head 5 +  While TRUE
.head 6 -  Call SqlPrepareAndExecute(hSql(),"SELECT ref INTO :nFetchRes FROM t902 WHERE ref=:nRefPara0 FOR UPDATE OF ref NOWAIT")
.head 6 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set sErrTxt='Невозможно получить доступ к Реф.'||SalNumberToStrX(nRefPara0,0)
.head 7 -  Break
.head 6 +  If cDocW.oDoc()
.head 7 -  Set cDocW.m_nDk=nDk0
.head 7 -  Set cDocW.A.S=nSdocA
.head 7 -  Set cDocW.B.S=nSdocB
.head 7 +  If cDocW.m_sTT='901'
.head 8 +  If not SqlPLSQLCommand(hSql(),
   "DynTT(cDocW.m_nFlg,cDocW.m_nRef,cDocW.m_dDatV1,
     cDocW.m_nDk,cDocW.A.Kv,cDocW.A.Nls,cDocW.A.S,cDocW.B.Kv,cDocW.B.Nls,cDocW.B.S)")
.head 9 -  Set sErrTxt='Невозможно выполнить связанную операцию для '||cDocW.m_sTT
.head 9 -  Break
.head 7 +  If bSplitS
.head 8 +  If cDocW.A.S = nSrest
.head 9 +  If not SqlPrepareAndExecute(hSql(), "DELETE FROM t902 WHERE ref=:nRefPara0")
.head 10 -  Set sErrTxt='Невозможно удалить Реф.'||SalNumberToStrX(nRefPara1,0)||' из T902'
.head 10 -  Break
.head 8 +  Else
.head 9 +  If not SqlPrepareAndExecute(hSql(), "UPDATE t902 SET s="||Str(nSrest-cDocW.A.S)||" WHERE ref=:nRefPara0")
.head 10 -  Set sErrTxt='Невозможно обновить Реф.'||SalNumberToStrX(nRefPara1,0)||' в T902'
.head 10 -  Break
.head 7 +  Else
.head 8 +  If not SqlPrepareAndExecute(hSql(), "DELETE FROM t902 WHERE ref=:nRefPara0")
.head 9 -  Set sErrTxt='Невозможно удалить Реф.'||SalNumberToStrX(nRefPara1,0)||' из T902'
.head 9 -  Break
.head 7 +  If cDocW.m_nRef=nRefPara0
.head 8 +  If not cDocW.Pay(2,cDocW.m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 9 -  Set sErrTxt = 'Неуспех при фактической оплате 9'
.head 9 -  Break
.head 7 +  Else
.head 8 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:cDocW.m_nRef,'REF92',:nRefPara0)")
.head 9 -  Set sErrTxt=' Невозможно вставить TAG REF92 в OPERW'
.head 9 -  Break
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
.head 5 -  Return FALSE
.head 3 +  Function: iDop
.head 4 -  Description: Вставить доп реквизиты
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrTxt
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 +  If SalStrScan (strDrec,'#fMT' )>=0
.head 7 +  If cDocW.B.Bank=GetBankMfo()     ! З ВПС на СВІФТ через подбор КС
.head 8 +  If cDocW.m_nRef=nRefPara0 and GetGlobalOption('SWIFT')='1'
.head 9 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:cDocW.m_nRef,'NOS_A',0)")
.head 10 -  Set sErrTxt=' Невозможно вставить TAG NOS_A в OPERW'
.head 10 -  Break
.head 7 +  ! Else
.head 8 +  If not SqlPLSQLCommand(hSql(),"sep.bis2ref(nRec,cDocW.m_nRef)")
.head 9 -  Set sErrTxt=' Невозможно вставить SWIFT TAGs в OPERW'
.head 9 -  Break 
.head 6 +  If cDocW.m_nRef != nRefPara0 and nOp != 3 ! копія допреквізитів (якщо не возврат)
.head 7 +  If not SqlPrepareAndExecute(hSql(),'INSERT INTO operw (ref,tag,value) SELECT :cDocW.m_nRef,tag,value FROM operw WHERE ref=:nRefPara0')
.head 8 -  Set sErrTxt=' Невозможно скопировать допреквизиты в OPERW'
.head 8 -  Break
.head 6 -  Return TRUE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWnd
.head 3 -  Window Handle: hWndTbl
.head 3 -  Number: nRec
.head 3 -  Number: nRefPara0
.head 3 -  Number: nRefPara1
.head 3 -  Number: nDkPara     ! Д/К
.head 3 -  String: sSWT_TT     ! Код операции
.head 3 -  Number: nAmnt       ! Сумма
.head 3 -  String: sSndr       ! Отправитель
.head 3 -  String: sRcvr       ! Получатель
.head 3 -  String: strNlsA     ! Счет А
.head 3 -  String: strNlsB     ! Счет Б
.head 3 -  String: strMfoB     ! МФО Б
.head 3 -  String: strOkpoA    ! Код отправителя
.head 3 -  String: strOkpoB    ! Код получателя
.head 3 -  String: strNazn     ! Назначение платежа
.head 3 -  String: strDrec     ! Допреквізити
.head 3 -  Number: nKvPara     ! Код валюти
.head 3 -  Number: nOp         ! Код операції
.head 2 +  Window Variables
.head 3 -  Boolean: bSplitS
.head 3 -  Number: nSrest
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, 1)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Choose
.head 4 -  Set bDocStart=TRUE
.head 4 -  Set bSplitS=TRUE
.head 4 -  Set sTT=sSWT_TT
.head 4 -  Set sNlsA_TT=strNlsA
.head 4 -  Set sNlsB_TT=strNlsB
.head 4 -  Set sBankB_TT=strMfoB
.head 4 -  Set nId=GetUserId()
.head 4 -  Set nKvA_TT=nKvPara
.head 4 -  Set dDat=GetBankDate()
.head 4 -  Call SqlPrepareAndExecute(hSql(),"
SELECT t.name,t.flags,t.fli,t.flv,t.sk
  INTO :sTTN,:sFlags,:nFli,:nFlv,:nSk FROM tts t WHERE t.tt=:sTT")
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не описана операция "||sTT,'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call Flgs2aFlg(sFlags)
.head 4 -  Call SqlPrepareAndExecute(hSql(),'SELECT kv,dig INTO :sLcv,:nDigA FROM tabval WHERE kv=:nKvA_TT')
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не найдена валюта "||Str(nKvA_TT),'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set nKvB_TT=nKvA_TT
.head 4 -  Set nDk=nDkPara
.head 4 -  Call SalSetWindowText(hWndForm, 'Ввод документа - [ ' ||sTTN|| ' ]')
.head 4 -  Call ShowApdVersion('14')
.head 4 +  If not aFlg[9]
.head 5 -  Set nSk_TT=NUMBER_Null
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( hWnd,UM_ObjDeactivate, 0, 0)
.head 4 -  Call SalSendMsg( hWndTbl, UM_Populate, 0, 0)
.head 4 -  Call SqlRollback(hSql())   ! Разлочим   T902, если вдруг она осталась залочена
.head 1 +  Table Window: tbl_SetLimsI   ! 15
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: История  установки лимитов прямым участникам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.19"
.head 4 -  Top:    1.683"
.head 4 -  Width:  11.817"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.781"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.371"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42329
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.557"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  4.557"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.15"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42330
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42331
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dMFO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.033"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.383"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dNB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.467"
.head 7 -  Top:    0.071"
.head 7 -  Width:  4.85"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Банковская
дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: USERID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
исполнителя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_SYS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Системная
дата-время
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LNO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит
начальных
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LTK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: nId
.head 3 -  Date/Time: bDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('15')
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3 )
.head 4 -  Set dMFO= strPar02
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT nb INTO :dNB FROM banks where mfo=:dMFO")
and SqlFetchNext( hSql(), nFetchRes )
.head 4 -  !
.head 4 -  Set tbl_SetLimsI.strSqlPopulate=
"SELECT  l.DAT,l.USERID,l.LIM,l.LNO,l.DAT_SYS,s.fio
   INTO  :tbl_SetLimsI.DAT,     :tbl_SetLimsI.USERID,
         :tbl_SetLimsI.LTK,     :tbl_SetLimsI.LNO,
         :tbl_SetLimsI.DAT_SYS, :tbl_SetLimsI.FIO
   FROM lkl_rrp_update l, staff s
   WHERE l.mfo=:dMFO and l.USERID =s.id
   ORDER BY 5 desc "
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam )
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 1 +  Table Window: tbl_SetLims    ! 16
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Установка лимитов прямым участникам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.05"
.head 4 -  Top:    0.448"
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.369"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.371"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40673
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.557"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  4.557"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.043"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.471"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'История установки лимитов по выбронному МФО'
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.329"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40674
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.014"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40675
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Check Box: cbIsGenFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Cформировать файл лимитов для участников
.head 5 -  Window Location and Size
.head 6 -  Left:   4.786"
.head 6 -  Top:    0.073"
.head 6 -  Width:  8.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: clMfo_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО

 1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clKv_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clLCV_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clNam_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование

2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clDos_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
 Дебет
3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clKos_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
4
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clOst_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток

5
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clOstN_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток +
Незаквит
6
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clOstNL_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток +
Незаквит -
Лимит (6-7)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: clLTK_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит

7
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clLNO_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит
начальных
8
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clacc_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит
начальных
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.457"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: clMfoP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.971"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  File Handle: hFile
.head 3 -  Number: nCur
.head 3 -  Number: nTmp
.head 3 -  !
.head 3 -  Number: nId
.head 3 -  Date/Time: bDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set tbl_SetLims.nFlags=GT_NoRet | GT_NoIns | GT_NoDel
.head 4 +  If strPar01 = 'RO'
.head 5 -  Call SalDisableWindow( cbIsGenFile )
.head 5 -  Call SalDisableWindow( pbIns )
.head 5 -  Call SalDisableWindow( pbDel )
.head 5 -  Call SalDisableWindow( pbUpdate )
.head 5 -  Call SalDisableWindow( clLTK_ )
.head 5 -  Call SalDisableWindow( clLNO_ )
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('16')
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 7 )
.head 4 -  Set tbl_SetLims.strPrintFileName =  'SetLims.txt'
.head 4 -  Set tbl_SetLims.strFilterTblName = 'LKL_RRP'
.head 4 -  Set tbl_SetLims.strSqlPopulate=
"SELECT a.acc,lkl_rrp.mfo,lkl_rrp.kv,a.nms,a.ostc,a.dos,a.kos,
        DECODE(c.mfop,"||GetBankMfo()||",-a.lim,lkl_rrp.lim),
        lkl_rrp.lno,c.mfop,v.lcv
   INTO :clacc_,:clMfo_,:clKv_,:clNam_,:clOst_,:clDos_,:clKos_,:clLTK_,:clLNO_,:clMfoP,:clLCV_
   FROM lkl_rrp, bank_acc b, accounts a, banks c, tabval v
  WHERE lkl_rrp.mfo=b.mfo AND a.kv=lkl_rrp.kv AND c.mfo=lkl_rrp.mfo AND a.acc=b.acc AND a.tip='L00' 
    AND v.kv=lkl_rrp.kv
  ORDER BY lkl_rrp.mfo,lkl_rrp.kv"
.head 4 -  Set tbl_SetLims.strSqlUpdate=
'UPDATE lkl_rrp SET lim = :tbl_SetLims.clLTK_,  lno=:tbl_SetLims.clLNO_
  WHERE mfo=:tbl_SetLims.clMfo_ AND kv=:tbl_SetLims.clKv_'
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam )
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation call function' role
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'SetLimMod1()' )
.head 4 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 3 +  On UM_Update
.head 4 -  Call SalSendClassMessage(UM_Update, 0, 0 )
.head 4 +  If SqlPrepareAndExecute(hSql(), 
"BEGIN
FOR c IN 
  (SELECT a.acc,l.mfo,l.lim,l.lno
     FROM lkl_rrp l, bank_acc b, accounts a
    WHERE l.mfo=b.mfo AND a.kv=l.kv AND a.acc=b.acc
      AND a.tip='L00' AND a.lim<>-l.lim 
    ORDER BY l.mfo,l.kv)
 LOOP
   UPDATE accounts SET lim=-c.lim WHERE acc=c.acc;
   INSERT INTO lkl_rrp_update (mfo,dat,lim,lno,userid,dat_sys)
   VALUES (c.mfo,gl.bDATE,c.lim,c.lno,
          (SELECT id FROM staff WHERE logname=USER),SYSDATE); 
END LOOP;
END;")
.head 5 -  Call SqlCommit(hSql())
.head 5 +  If cbIsGenFile
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 7 +  If SalFileOpen( hFile,
IifS(clMfoP=GetBankMfo(),GetIntDir() || '\\K',GetExtDir() || '\\FL'), OF_Binary | OF_Create )
.head 8 -  Call SalFileClose( hFile )
.head 7 +  Else
.head 8 -  Return MessageError( 'Ошибка создания файла-флага ' ||
IifS(clMfoP=GetBankMfo(),GetIntDir() || '\\K',GetExtDir() || '\\FL') )
.head 4 +  Else
.head 5 -  Call SqlRollback(hSql())
.head 3 +  On UM_DoubleClick
.head 4 -  Call Sel014 (hWndMDI, 10, 0,  '', tbl_SetLims.clMfo_)
.head 3 +  On SAM_FetchRowDone
.head 4 -  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT sum(ostc) INTO :nTmp FROM accounts a, bank_acc b
    WHERE a.tip in ('TUR','TUD') and a.acc=b.acc and b.mfo=:clMfo_ " )
 and SqlFetchNext( hSqlAux2(),  nFetchRes )
.head 4 +  If nTmp=NUMBER_Null
.head 5 -  Set nTmp=0
.head 4 -  Set clOstN_ = clOst_ + nTmp
.head 4 -  Set clOstNL_ = clOst_ + nTmp - clLTK_
.head 4 +  If clOstNL_ < 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray )
.head 1 +  Table Window: TZ             ! 17 картотека информац.запросов
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Інформаційні повідомлення з СЕП
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.65"
.head 4 -  Top:    1.375"
.head 4 -  Width:  13.033"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.781"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = ' Изъять'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 4)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.371"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41426
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.367"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  6.367"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 41427
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.667"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  5.667"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.043"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.471"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.329"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41428
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41429
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_link.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Порожденный документ '
.head 6 +  On SAM_Click
.head 7 -  Call DocViewContentsEx(hWndMDI, TZ.REFN)
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удовлетворить запрос '
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 3)
.head 4 +  Pushbutton: pbReply
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Reply.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Відповідь на уточнення реквізитів'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 2)
.head 4 +  Pushbutton: pbReport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.967"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Logfile.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зформувати реєстр'
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlg_ZapReqPrt, hWndForm, 1, sRepFn)
.head 7 -  Call SalEnableWindow( pbPreView )
.head 4 +  Pushbutton: pbPreView
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перегляд звіту'
.head 7 -  Call SalDisableWindow( hWndItem )
.head 6 +  On SAM_Click
.head 7 -  Call DirectView(sRepFn)
.head 4 +  Option Button: obFixed
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SHOWITEM.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obFixed, 'Все', 'Обработанные за месяц'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 2 +  Contents
.head 3 +  Column: REC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: REC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
надходження
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.143"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СУМА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наш
рахунок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.386"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва рахунку
з повідомлення
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.214"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LIM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення платежу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва рахунку
у нас
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.343"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OPL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОПЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: N док

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.057"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид оп.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
док
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
поступил в банк
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PAP
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DREC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДопРеквізити
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вик
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nPar=0
.head 7 -  Call SalHideWindow( hWndItem )
.head 6 +  Else
.head 7 -  Call SalShowWindow( hWndItem )
.head 3 +  Column: OTM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмітка
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nPar=0
.head 7 -  Call SalHideWindow( hWndItem )
.head 6 +  Else
.head 7 -  Call SalShowWindow( hWndItem )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar	 ! 0-обычн. 1-для петрокомм (с исполнителями)
.head 3 -  String: sFlags   ! 3-и кнопки+ТТ:   '111,PS2'
.head 3 -  String: sFilt    ! Предустановленный фильтер
.head 2 +  Window Variables
.head 3 -  String: S902
.head 3 -  String: NMS902
.head 3 -  String: sOperID
.head 3 -  Number: nTmp
.head 3 -  String: sRepFn
.head 3 -  !
.head 3 -  String: sTT
.head 3 -  String: sBankDay
.head 3 -  Date/Time: dBankDay
.head 3 -  String: sBankMfo
.head 3 -  Number: nBaseVal
.head 3 -  Window Handle: hWinDoc
.head 3 -  !
.head 3 -  Number: nS
.head 3 -  Number: nKv
.head 3 -  Number: nDk
.head 3 -  Number: nVob
.head 3 -  String: ss1
.head 3 -  String: ss2
.head 3 -  String: strNAMa
.head 3 -  String: strNAMb
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: strOKPOa
.head 3 -  String: strOKPOb
.head 3 -  String: s6
.head 3 -  String: s7
.head 3 -  String: sNazn
.head 3 -  String: sDrec
.head 3 -  Date/Time: dDatD
.head 3 -  Date/Time: dDatP
.head 3 -  Number: nIsp
.head 3 -  String: sFlagI       ! Кнопки del-run-reply   111
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If SalStrScan(sFlags,',')>=0
.head 5 -  Set sFlagI=SalStrLeftX(sFlags,SalStrScan(sFlags,','))||'111'
.head 4 +  Else
.head 5 -  Set sFlagI=sFlags||'111'
.head 4 -  ! Call Debug(sFlagI)
.head 4 -  Set TZ.nTabInstance = 1
.head 4 -  Set TZ.strFilterTblName='ARC_RRP'
.head 4 +  If nPar=0
.head 5 -  Set nFlags=GT_NoRet | GT_NoIns | GT_NoUpd
.head 4 +  Else ! Для ПЕТРОКОММЕРЦА изврат (передача запросов между исполнителями)
.head 5 -  Set nFlags=GT_NoRet | GT_NoIns
.head 5 -  Set TZ.strSqlUpdate="UPDATE tzapros SET isp=:TZ.ISP WHERE rec =:TZ.REC"
.head 5 -  Call SalEnableWindow(TZ.ISP)
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ShowApdVersion('17')
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set TZ.sBankDay = GetBankDateEx( )
.head 4 -  Set TZ.dBankDay = GetBankDate( )
.head 4 -  Set TZ.sBankMfo = GetBankMfo()
.head 4 -  Set TZ.sOperID  = GetIdOper()
.head 4 -  Set TZ.nBaseVal = GetBaseVal()
.head 4 -  Set TZ.nIsp     = GetUserId()
.head 4 -  Set TZ.strPrintFileName = 'Tzapros.txt'
.head 4 +  If not (SqlPrepareAndExecute(hSql(),
  "SELECT nls,nms INTO :S902,:NMS902
     FROM accounts
    WHERE kv=:nBaseVal and tip='902'") and SqlFetchNext(hSql(), nFetchRes))
.head 5 -  Set S902='372001'
.head 5 -  Set NMS902 = 'Нез"ясовані відповідні суми з СЕП'
.head 4 -  ! Получение операции для обработки информационных запросов
.head 4 -  Set sTT = GetGlobalOption( 'IQ_TT' )
.head 4 -  ! По умолчанию PS2
.head 4 +  If NOT sTT
.head 5 -  Set sTT='PS2'
.head 4 +  If SalStrScan(sFlags,',')>=0
.head 5 -  Set sTT=SalStrMidX(sFlags,SalStrScan(sFlags,',')+1,SalStrLength(sFlags)-SalStrScan(sFlags,',')-1)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalEnableWindow(pbFilter)
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalSendMsg(TZ.pbFilter,SAM_Click, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If GetGlobalOptionEx('SEPNUM')=2
.head 5 +  If TZ.DK=2 AND SalStrScan( TZ.DREC, '#?' )>=0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen	)
.head 5 +  If TZ.DK=3
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray )
.head 5 -  Set TZ.OPL=0
.head 5 -  Set TZ.DK1=IifS(TZ.DK=2,'Д','К')
.head 4 +  Else
.head 5 -  Set TZ.NAMA =StrDosToWinX(TZ.NAMA)
.head 5 -  ! Set TZ.ND =StrDosToWinX(TZ.ND)
.head 5 +  If TZ.DK=2 AND SalStrScan( TZ.DREC, '#?' )>=0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen	)
.head 5 +  If TZ.DK=3
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray )
.head 5 -  Set TZ.NAMB =StrDosToWinX(TZ.NAMB)
.head 5 -  Set TZ.NAZN =StrDosToWinX(TZ.NAZN)
.head 5 -  Set TZ.OPL=0
.head 5 -  Set TZ.DK1=IifS(TZ.DK=2,'Д','К')
.head 3 +  On WM_Char
.head 4 +  If wParam=32
.head 5 -  Call DocViewContents(hWndMDI,TZ.REC)
.head 3 +  On SAM_RowSetContext
.head 4 +  If TZ.OPL=1
.head 5 -  Call SalDisableWindow(TZ.pbRun )
.head 5 -  Call SalDisableWindow(TZ.pbDel )
.head 4 +  Else
.head 5 +  If TZ.DK=2 and (TZ.PAP=3 or TZ.PAP=1 or TZ.PAP=2 and TZ.S <= TZ.OST + TZ.LIM)
.head 6 -  Call SalEnableWindow(TZ.pbRun )
.head 5 +  Else
.head 6 -  Call SalDisableWindow(TZ.pbRun )
.head 5 +  If TZ.DK=2 and SalStrScan( TZ.DREC, '#?' )>=0
.head 6 -  Call SalDisableWindow(TZ.pbRun )
.head 6 -  Call SalEnableWindow(TZ.pbReply )
.head 5 +  Else
.head 6 -  Call SalDisableWindow(TZ.pbReply )
.head 5 -  Call SalEnableWindow(TZ.pbDel )
.head 4 +  If TZ.REFN
.head 5 -  Call SalEnableWindow(pbDoc )
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbDoc )
.head 4 -  ! Управление кнопками
.head 4 +  If SalStrMidX(sFlagI,0,1)='0'
.head 5 -  Call SalDisableWindow( pbDel )
.head 4 +  If SalStrMidX(sFlagI,1,1)='0'
.head 5 -  Call SalDisableWindow( pbRun )
.head 4 +  If SalStrMidX(sFlagI,2,1)='0'
.head 5 -  Call SalDisableWindow( pbReply )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call DocViewContents(hWndMDI,TZ.REC)
.head 3 +  On UM_ObjActivate
.head 4 +  If TZ.OPL = 0
.head 5 +  If lParam = 2 ! Відповідь на уточнення реквізитів
.head 6 +  If SqlPrepareAndExecute( hSqlAux(),
'SELECT nlsa,mfob,nlsb,s,nam_a,id_a,nam_b,id_b,nd,vob,nazn,trunc(datd),trunc(datp)
   INTO :s6,:s3,:s2,:nS,:strNAMa,:strOKPOa,:strNAMb,:strOKPOb,:s7,:nVob,:sNazn,:dDatD,:dDatP
   FROM arc_rrp
  WHERE dat_b>=ADD_MONTHS(TO_DATE(\''||TZ.sBankDay||'\',\'MM-DD-YYYY\''||'),-1) AND
        fn_b=\''||SalStrMidX( TZ.DREC, 2,12)||'\' AND
        rec_b='||SalStrMidX( TZ.DREC,14,6 ) ) and SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 +  If nS=TZ.S*100 and s3=TZ.MFOA and s6=TZ.NLSB and s7=TZ.ND and dDatD=TZ.DATD and nVob=TZ.VOB
.head 8 -  Set s4 = 'Уточнення реквізитів документа'
.head 8 -  ! надо еще проверить ID_A DATP
.head 8 -  If GetGlobalOptionEx('SEPNUM')=2
.head 8 +  Else
.head 9 -  Set sNazn=StrDosToWinX(sNazn)
.head 9 -  Set strNAMa=StrDosToWinX(strNAMa)
.head 9 -  Set strNAMb=StrDosToWinX(strNAMb)
.head 9 -  Set s7=StrDosToWinX(s7)
.head 8 -  Set sDrec=TZ.DREC
.head 8 -  Set nDk=3
.head 8 -  Set nKv=TZ.KV
.head 8 -  Set ss1 = "СФОРМУВАТИ відповідь на уточнення реквізитів документа ?"
.head 8 -  Set ss2 = "Буде сформировано інформаційне повідомлення"
.head 7 +  Else
.head 8 +  If GetGlobalOptionEx('SEPNUM')=2
.head 9 -  Set ss1 = "Не співпадають реквізити запиту і первинного документу"||PutCrLf()||PutCrLf()||
'ЗАП: № '||TZ.ND||', від '||DtoS(TZ.DATD)||', Сума '||Str(TZ.S*100)||PutCrLf()||
'ДОК: № '|| s7  ||', від '||DtoS(dDatD)  ||', Сума '||Str(nS)      ||PutCrLf()||PutCrLf()||
'ЗАП: МФО-А '||TZ.MFOA||', Рах.-Б '||TZ.NLSB||', Код '||Str(TZ.VOB)||PutCrLf()||
'ДОК: МФО-А '||  s3   ||', Рах.-Б '||   s6  ||', Код '||Str(nVob)  ||PutCrLf()
.head 8 +  Else
.head 9 -  Set ss1 = "Не співпадають реквізити запиту і первинного документу"||PutCrLf()||PutCrLf()||
' Док '||StrDosToWinX(TZ.ND)||', від '||DtoS(TZ.DATD)||', Сума '||Str(TZ.S*100)||PutCrLf() ||
' Док '||StrDosToWinX(s7)||', від '||DtoS(dDatD)||', Сума '||Str(nS)||PutCrLf()
.head 8 -  Set ss2 = "СФОРМУВАТИ відповідь, що платежу немає в банку-відправнику ?"
.head 8 -  Set nDk=3
.head 8 -  Set nKv=TZ.KV
.head 8 -  Set dDatD=TZ.DATD
.head 8 -  Set dDatP=TZ.DATP
.head 8 -  Set sDrec=SalStrReplaceX(TZ.DREC,1,1,'*')
.head 8 -  Set sNazn=TZ.NAZN
.head 8 -  Set strOKPOa= GetBankOkpoS()
.head 8 -  Set strOKPOb=TZ.OKPOA
.head 8 -  Set s3=TZ.MFOA
.head 8 -  Set s2=TZ.NLSA
.head 8 -  Set s6=S902
.head 8 -  Set strNAMa=NMS902
.head 8 -  Set strNAMb=TZ.NAMA
.head 8 -  Set nVob=TZ.VOB
.head 8 -  Set nS=TZ.S*100
.head 8 +  If GetGlobalOptionEx('SEPNUM')=2
.head 9 -  Set s7=TZ.ND
.head 8 +  Else
.head 9 -  Set s7=StrDosToWinX(TZ.ND)
.head 6 +  Else
.head 7 -  Set ss1 = "Не знайдено документа з файла "||SalStrMidX( TZ.DREC, 2,18)||" за останні 30 днів!"
.head 7 -  Set ss2 = "СФОРМУВАТИ відповідь, що платежу немає в банку-відправнику ?"
.head 7 -  Set nDk=3
.head 7 -  Set nKv=TZ.KV
.head 7 -  Set dDatD=TZ.DATD
.head 7 -  Set dDatP=TZ.DATP
.head 7 -  Set sDrec=SalStrReplaceX(TZ.DREC,1,1,'*')
.head 7 -  Set sNazn=TZ.NAZN
.head 7 -  Set strOKPOa= GetBankOkpoS()
.head 7 -  Set strOKPOb=TZ.OKPOA
.head 7 -  Set s3=TZ.MFOA
.head 7 -  Set s2=TZ.NLSA
.head 7 -  Set s6=S902
.head 7 -  Set strNAMb=TZ.NAMA
.head 7 -  Set nVob=TZ.VOB
.head 7 -  Set nS=TZ.S*100
.head 7 +  If GetGlobalOptionEx('SEPNUM')=2
.head 8 -  Set s7=TZ.ND
.head 7 +  Else
.head 8 -  Set s7=StrDosToWinX(TZ.ND)
.head 5 +  If lParam = 3 ! Удовлетворить
.head 6 -  Set nS=TZ.S*100
.head 6 -  Set strNAMb=TZ.NAMA
.head 6 -  Set s2=TZ.NLSA
.head 6 -  Set s3=TZ.MFOA
.head 6 -  Set s4='На Вашу вимогу/'|| TZ.NAMB
.head 6 -  Set strNAMa=TZ.NAMB2
.head 6 -  Set strOKPOb=TZ.OKPOA
.head 6 -  Set s6=TZ.NLSB
.head 6 -  Set s7=''
.head 6 -  Set nDk=1
.head 6 -  Set nKv=TZ.KV
.head 6 -  Set nVob=NUMBER_Null
.head 6 -  Set dDatD=DATETIME_Null
.head 6 -  Set dDatP=DATETIME_Null
.head 6 -  Set sNazn=SalStrTrimX(SalStrLeftX( s4 || '/' || TZ.NAZN, 160))
.head 6 -  Set sDrec=''
.head 6 -  Set ss1 = "Задовольнити вимогу на списання коштів ?"
.head 6 -  Set ss2 = "Буде сформовано кредитовий міжбанківський платіж"
.head 5 +  If lParam = 4 ! Удалить из картотеки
.head 6 -  Set ss1 = "ВИЛУЧИТИ з картотеки запитів ?"
.head 6 -  Set ss2 = "Задоволення запиту відміняється."
.head 5 +  If SalMessageBox(ss1 || PutCrLf() || ss2 || IifS(TZ.OTM>0,' Повторно.',''), 'Увага', MB_YesNo | MB_IconHand) = IDYES
.head 6 +  If lParam = 2 or lParam = 3
.head 7 +  If not IsWindow(hWinDoc)
.head 8 -  Set hWinDoc = SalCreateWindow(frmDocTZ, hWndMDI, hWndForm, TZ, TZ.REC,
    lParam, nDk, nVob, IifS(lParam=2,'014',sTT), s7, nKv, nS, strNAMa, strNAMb, s6, s2, s3, strOKPOa, strOKPOb, sNazn, sDrec, dDatD, dDatP)
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute(hSql(), "DELETE FROM tzapros WHERE rec=:TZ.REC")
.head 8 -  Call SqlCommitEx(hSql(), ss1 || ' REС=' || Str(TZ.REC))
.head 8 -  Call SalSendMsg(TZ, UM_Populate, 0, 0)
.head 3 +  On UM_ObjDeactivate
.head 4 +  If lParam
.head 5 -  Call SalDisableWindow(pbRun)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalDisableWindow(pbRefresh)
.head 5 -  Call SalDisableWindow(pbUpdate)
.head 5 -  Call SalDisableWindow(pbSearch)
.head 5 -  Call SalDisableWindow(pbFilter)
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 5 -  Call SalDisableWindow(TZ)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(TZ.pbRun )
.head 5 -  Call SalEnableWindow(pbDel)
.head 5 -  Call SalEnableWindow(pbRefresh)
.head 5 -  Call SalEnableWindow(pbUpdate)
.head 5 -  Call SalEnableWindow(pbSearch)
.head 5 -  Call SalEnableWindow(pbFilter)
.head 5 -  Call SalEnableWindow(pbDetails)
.head 5 -  Call SalEnableWindow(pbPrint)
.head 5 -  Call SalEnableWindow(TZ)
.head 5 -  Call SalBringWindowToTop( hWndForm )
.head 3 +  On UM_Populate
.head 4 +  If nPar=0
.head 5 -  Set strSqlPopulate=
 "SELECT arc_rrp.dk,   arc_rrp.rec,  arc_rrp.datd,arc_rrp.nd,  arc_rrp.vob,
         arc_rrp.mfoa, arc_rrp.nlsa, arc_rrp.kv,  arc_rrp.s/100, 
         arc_rrp.nlsb, arc_rrp.nam_b,arc_rrp.nazn,arc_rrp.d_rec,
         arc_rrp.dat_a,arc_rrp.nam_a,arc_rrp.id_a,arc_rrp.id_b,arc_rrp.datp,
         accounts.nms, accounts.ostc/100, accounts.lim/100, accounts.pap, tzapros.otm
   INTO :TZ.DK,   :TZ.REC, :TZ.DATD,:TZ.ND,  :TZ.VOB, :TZ.MFOA,:TZ.NLSA, :TZ.KV, :TZ.S,
        :TZ.NLSB, :TZ.NAMB,:TZ.NAZN,:TZ.DREC,:TZ.FDAT,:TZ.NAMA,:TZ.OKPOA,:TZ.OKPOB,:TZ.DATP
        :TZ.NAMB2,:TZ.OST, :TZ.LIM, :TZ.PAP, :TZ.OTM
   FROM tzapros, arc_rrp, accounts
  WHERE "||IifS(obFixed,'tzapros.otm>0 AND tzapros.dat+30>:TZ.dBankDay','tzapros.otm=0')||  
       " AND arc_rrp.s>0 and arc_rrp.dk>1 and arc_rrp.rec =tzapros.rec AND
         accounts.nls(+)=arc_rrp.nlsb AND accounts.KV(+)=arc_rrp.KV "||
  IifS(SalStrLength(SalStrTrimX(sFilt)),"AND "||sFilt,'')||
" ORDER BY tzapros.rec DESC"
.head 4 +  Else ! Для ПЕТРОКОММЕРЦА изврат (передача запросов между исполнителями)
.head 5 -  Set strSqlPopulate=
 "SELECT arc_rrp.dk,   arc_rrp.rec,  arc_rrp.datd,arc_rrp.nd,  arc_rrp.vob,
         arc_rrp.mfoa, arc_rrp.nlsa, arc_rrp.kv,  arc_rrp.s/100, 
         arc_rrp.nlsb, arc_rrp.nam_b,arc_rrp.nazn,arc_rrp.d_rec,
         arc_rrp.dat_a,arc_rrp.nam_a,arc_rrp.ID_A,arc_rrp.ID_B,arc_rrp.datp,
         accounts.nms,  accounts.ostc/100, accounts.lim/100, accounts.pap, tzapros.otm, tzapros.isp
   INTO :TZ.DK,   :TZ.REC, :TZ.DATD,:TZ.ND,  :TZ.VOB, :TZ.MFOA,:TZ.NLSA, :TZ.KV, :TZ.S,
        :TZ.NLSB, :TZ.NAMB,:TZ.NAZN,:TZ.DREC,:TZ.FDAT,:TZ.NAMA,:TZ.OKPOA,:TZ.OKPOB,:TZ.DATP
        :TZ.NAMB2,:TZ.OST, :TZ.LIM, :TZ.PAP, :TZ.OTM, :TZ.ISP
   FROM tzapros, arc_rrp, accounts
  WHERE "||IifS(obFixed,'tzapros.otm>0 AND tzapros.dat+30>:TZ.dBankDay','tzapros.otm=0')||
       " AND arc_rrp.s>0 and arc_rrp.dk>1 and arc_rrp.rec =tzapros.rec AND
         accounts.nls(+)=arc_rrp.nlsb AND accounts.KV(+)=arc_rrp.KV "||
         IifS(SalStrLength(SalStrTrimX(sFilt)),"AND "||sFilt,'')||
" ORDER BY tzapros.rec DESC"
.head 4 -  Call cQ.Init(strSqlPopulate)
.head 4 -  Call SalSendClassMessage( UM_Populate, 0, 0 )
.head 1 +  Form Window: splTDVal   ! 18 докум. не зачисленные по дате вал СЕП
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl0
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: СЭП. Документы с ненаступившей датой валютарования
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.413"
.head 4 -  Top:    0.115"
.head 4 -  Width:  12.55"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbBackToSender
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Повернути платнику'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 3)
.head 4 +  Pushbutton: pbInside
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.733"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_down.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'На інший рахунок'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 1)
.head 4 +  ! cTBarButton: pbOutside
.head 5 +                                                                 Message Actions
.head 6 +                                                                 On SAM_Create
.head 7 -                                                                 Set strTip = 'В інший банк'
.head 7 -                                                                 Call SalDisableWindow(hWndItem)
.head 6 +                                                                 On SAM_Click
.head 7 -                                                                 Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 2)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.45"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вилучити'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 4)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зарахувати'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If tbl.OTM = 1
.head 8 -  Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 49424
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Coordinates
.head 6 -  Begin X:  4.883"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.883"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.433"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.333"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Документ '
.head 6 +  On SAM_Click
.head 7 -  Call DocViewContents(hWndMDI, tbl.REC)
.head 4 +  Pushbutton: pbPr1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.233"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_link.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Порожденный документ '
.head 6 +  On SAM_Click
.head 7 -  Call DocViewContentsEx(hWndMDI, tbl.REFN)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49425
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Coordinates
.head 6 -  Begin X:  8.083"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  8.083"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.233"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49426
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl0
.head 5 -  Coordinates
.head 6 -  Begin X:  8.783"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  8.783"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfSumTDVAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.033"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On UM_Populate
.head 7 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT nls,ostc/100
       INTO :dfNlsTDVAL,:dfSumTDVAL
       FROM accounts
      WHERE acc IN
   (SELECT acc FROM opldok o WHERE o.tt='R01' AND o.ref=:tbl.REF AND o.sos=3 AND o.dk=0)")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set dfSumTDVAL= 0
.head 7 +  If dfSumTDVAL < 0
.head 8 -  Set dfSumTDVAL = -dfSumTDVAL
.head 8 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_Red)
.head 7 +  Else
.head 8 -  Call SalColorSet(hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue)
.head 4 +  Data Field: dfNlsTDVAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.933"
.head 7 -  Top:    0.095"
.head 7 -  Width:  2.083"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49427
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.933"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  1.933"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  ! cTBarButton: pbAlt
.head 5 +                                                                 Message Actions
.head 6 +                                                                 On SAM_Create
.head 7 -                                                                 Set strTip = 'На альтернативний рахунок'
.head 7 -                                                                 Call SalDisableWindow(hWndItem)
.head 6 +                                                                 On SAM_Click
.head 7 +                                                                 If SqlPrepareAndExecute(hSql(), "
   SELECT nls,nms
     INTO :sNlsAlt,:sNamAlt
     FROM accounts
    WHERE nls=:tbl.NLSALT and kv=:nBaseVal") and SqlFetchNext(hSql(), nFetchRes)
.head 8 -                                                                 Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 5)
.head 7 +                                                                 Else
.head 8 -                                                                 Call SalMessageBox("Рахунок " || tbl.NLSALT || " (альтернативний) НЕ знайдено !",
     "Помилка!", 1)
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl0
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: REF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рефе-
ренція
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
A
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рахунок
A
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.229"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рахунок
Б
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKPO
Б
з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отримувач

з док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 49
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.439"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OTM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Відкр
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Призначення платежу
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: DK
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKPO
РАХ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMB2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва рахунку
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 50
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.439"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
зарахування
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N док

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платник
з документу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.486"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид
ОП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОПЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REFN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NEW ref
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKPO
A
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код валюты
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSALT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ALT
рахунок

з док
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAZS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
закриття рах
зарахування
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATVAL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
валютування
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  If GetGlobalOptionEx('SEPNUM')=2
.head 6 +  Else
.head 7 -  Set NAMA = StrDosToWinX(NAMA)
.head 7 -  Set NAMB = StrDosToWinX(NAMB)
.head 7 -  Set NAZN = StrDosToWinX(NAZN)
.head 7 -  Set ND = StrDosToWinX(ND)
.head 6 -  Call SalTblSetCellTextColor(S, IifN(DK=0, COLOR_DarkRed, COLOR_DarkBlue), FALSE)
.head 6 -  Call SalTblSetCellTextColor(REF, IifN(DK=0, COLOR_DarkRed, COLOR_DarkBlue), FALSE)
.head 6 -  Set OPL = 0
.head 6 +  If OTM and DAZS
.head 7 -  Call XSalTblSetRowBackColor( hWndForm,lParam,COLOR_LightPeriwinkle)
.head 6 +  If tbl.DK = 1
.head 7 -  Set nSumD = nSumD + tbl.S
.head 7 -  Set nRowC = nRowC + 1
.head 5 +  On WM_Char
.head 6 +  If wParam = 32
.head 7 -  Call DocViewContents(hWndMDI, REC)
.head 5 +  On SAM_DoubleClick
.head 6 +  If REC
.head 7 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalEnableWindow(pbBackToSender)
.head 6 -  Call SalEnableWindow(pbInside)
.head 6 -  ! Call SalEnableWindow(pbOutside)
.head 6 -  Call SalEnableWindow(pbDel)
.head 6 +  If DK=0
.head 7 -  Call SalDisableWindow(pbBackToSender)
.head 7 -  ! Call SalDisableWindow(pbOutside)
.head 6 +  If OTM and not DAZS
.head 7 -  Call SalEnableWindow(pbUpdate)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 6 +  If REFN
.head 7 -  Call SalEnableWindow(pbPr1)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbPr1)
.head 6 +  ! If NLSALT
.head 7 -                                                                 Call SalEnableWindow(pbAlt)
.head 6 +  ! Else
.head 7 -                                                                 Call SalDisableWindow(pbAlt)
.head 6 -  Call SalSendMsg(dfSumTDVAL, UM_Populate, 0, 0)
.head 6 -  Set ml = 'Відправник:     МФО: ' || MFOA || ' , Рахунок: ' || NLSA || PutCrLf() ||
    PadR(NAMA, 38) || PutCrLf() || PutCrLf() || ' Отримувач:     МФО: ' ||
    GetBankMfo() || ' , Рахунок: ' || NLSB || PutCrLf() || PadR(
    Subs(NAMB, 12, 38), 38) || PutCrLf() || PutCrLf() || 'Призначення платежу:' ||
    PutCrLf() || NAZN
.head 5 +  On UM_Populate
.head 6 -  ! Call SalSendMsg(dfSumT902, UM_Populate, 0, 0)
.head 6 -  Set nSumD = 0
.head 6 -  Set nRowC = 0
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call SalTblDefineSplitWindow (tbl, 1, TRUE)
.head 6 -  Set nTmp = SalTblInsertRow(tbl, TBL_MinRow)
.head 6 -  Call SalTblSetContext(tbl, nTmp)
.head 6 -  Call SalTblSetRowFlags(tbl, nTmp, ROW_New, FALSE)
.head 6 -  Set tbl.S = nSumD
.head 6 -  Set tbl.REF = nRowC
.head 6 -  Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
.head 6 -  Call SalTblSetContext(tbl, 0)
.head 6 -  Call SalTblSetRowFlags( tbl, SalTblQueryContext ( tbl ), ROW_Selected, TRUE )
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl, hWndNULL)
.head 5 +  On VTM_KeyUp
.head 6 -  Call VisTblAutoSizeColumn(tbl, hWndNULL)
.head 3 +  Multiline Field: ml
.head 4 -  Class Child Ref Key: 32
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl0
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    5.369"
.head 6 -  Width:  16.783"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.357"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl0
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    5.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Number: ACC902
.head 3 -  ! Number: ACC90D
.head 3 -  ! String: NMS902
.head 3 -  ! String: NMS90D
.head 3 -  String: NMSDVAL
.head 3 -  String: NLSDVAL
.head 3 -  ! String: S902
.head 3 -  ! String: S90D
.head 3 -  String: sErrTxt
.head 3 -  ! String: sNamAlt
.head 3 -  Number: nRowC
.head 3 -  Number: nSumD
.head 3 -  Number: nFetchRes
.head 3 -  Number: nBaseVal
.head 3 -  Window Handle: hWinDoc
.head 3 -  !
.head 3 -  String: ss1
.head 3 -  String: ss2
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('18')
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set nBaseVal = GetBaseVal()
.head 4 -  Set dDat=GetBankDate()
.head 4 -  Set strFilterTblName = 'ARC_RRP'
.head 4 -  Set strPrintFileName = 'TDVAL.txt'
.head 4 -  ! Новый вариант от 22.08.2003 (MIK)
.head 4 -  Set splTDVal.strSqlPopulate = "
    SELECT a.dk,a.ref,a.mfoa,a.nlsa,a.s/100,a.nlsb,a.nam_b,a.nazn,
           a.rec,a.dat_a,a.nd,a.nam_a,a.vob,a.datd,a.id_a,a.id_b,k.okpo,s.nms,
           NVL(s.pap/s.pap,0),a.kv, s.nlsalt, s.dazs, 
           to_date('20'||substr( d_rec, instr(d_rec,'#D')+2, 2)||substr( d_rec, instr(d_rec,'#D')+4, 4),'yyyymmdd')
     FROM tdval t, arc_rrp a, accounts s, customer k
     WHERE  a.ref=t.ref and a.nlsb=s.nls (+) AND a.kv=s.kv (+) AND
	          s.rnk=k.rnk (+) AND exists
	 (SELECT ref FROM opldok o WHERE o.tt='R01' AND t.ref=o.ref AND o.sos=3 AND o.dk=0)
     ORDER BY a.ref
    INTO :splTDVal.tbl.DK,:splTDVal.tbl.REF,:splTDVal.tbl.MFOA,:splTDVal.tbl.NLSA,
         :splTDVal.tbl.S,:splTDVal.tbl.NLSB,:splTDVal.tbl.NAMB,:splTDVal.tbl.NAZN,
         :splTDVal.tbl.REC,:splTDVal.tbl.FDAT,:splTDVal.tbl.ND,:splTDVal.tbl.NAMA,
         :splTDVal.tbl.VOB,:splTDVal.tbl.DATD,:splTDVal.tbl.OKPO,:splTDVal.tbl.OKPOB,
         :splTDVal.tbl.OKPOB2,:splTDVal.tbl.NAMB2,:splTDVal.tbl.OTM,:splTDVal.tbl.KV,
         :splTDVal.tbl.NLSALT,:splTDVal.tbl.DAZS,:splTDVal.tbl.DATVAL"
.head 4 -  Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call tbl.cF.Init(strFilterTblName, 'a')
.head 3 +  On UM_ObjActivate
.head 4 +  If tbl.OPL = 0
.head 5 +  If lParam = 0 ! Зачислить
.head 6 -  Set s1 = SalStrTrimX(tbl.NAMB2) ! Получатель
.head 6 -  Set s2 = SalStrTrimX(tbl.NLSB)  ! Счет получателя
.head 6 -  Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -  Set s4 = tbl.NAZN               ! Назначение платежа
.head 6 -  Set s5 = tbl.OKPOB2             ! ОКПО получателя
.head 6 -  Set ss1 = 'ДОСТРОКОВО ЗАРАХУВАТИ на рахунок ' || s2 || ' ' || s1 || ' ?'
.head 6 -  Set ss2 = "Буде добавлено проводку в основну операцію"
.head 5 +  If lParam = 1 ! На другой счет
.head 6 -  Set s1 = ''                     ! получатель
.head 6 -  Set s2 = ''                     ! Счет получателя
.head 6 -  Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -  Set s4 = SalStrTrimX('Перекр.док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy') || '. Платник МФО ' || tbl.MFOA ||
    ' Рах ' || tbl.NLSA || ' ' || tbl.NAMA || '/ ' || tbl.NAZN)
.head 6 -  Set s5 = ''
.head 6 -  Set ss1 = IifS(tbl.DK=0, "ПЕРЕДЕБЕ", "ПЕРЕКРЕДИ") || "ТУВАТИ документ на інший рахунок ?"
.head 6 -  Set ss2 = "Буде сформовано внутрішній мем.ордер"
.head 5 +  ! If lParam = 2 ! В другой банк
.head 6 -                                                                 Set s1 = ''                     ! получатель
.head 6 -                                                                 Set s2 = ''                     ! Счет получателя
.head 6 -                                                                 Set s3 = ''                     ! Банк получателя
.head 6 -                                                                 Set s4 = SalStrTrimX('Перекр.док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy') || '. Платник МФО ' || tbl.MFOA ||
    ' Рах ' || tbl.NLSA || ' ' || tbl.NAMA || '/ ' || tbl.NAZN)
.head 6 -                                                                 Set s5 = ''
.head 6 -                                                                 Set ss1 = "ПЕРЕКРЕДИТУВАТИ в інший банк ?"
.head 6 -                                                                 Set ss2 = "Буде сформировано новий документ"
.head 5 +  If lParam = 3 ! Вернуть плательщику
.head 6 -  Set s1 = tbl.NAMA               ! получатель
.head 6 -  Set s2 = tbl.NLSA               ! Счет получателя
.head 6 -  Set s3 = tbl.MFOA               ! Банк получателя
.head 6 -  Set s4 = SalStrTrimX('Повернено док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD, 'dd/MM/yy') || ' до настання дати валютування СЕП. : "'
    || tbl.NLSB || ' ' || tbl.NAMB || '" ' || tbl.NAZN)
.head 6 -  Set s5 = tbl.OKPO
.head 6 -  Set ss1 = "ПОВЕРНУТИ кошти платнику ?"
.head 6 -  Set ss2 = "Буде сформовано зворотній міжбанківський платіж"
.head 5 +  If lParam = 4 ! Удалить из картотеки
.head 6 -  Set ss1 = "ВИЛУЧИТИ з картотеки незарахованих сум ?"
.head 6 -  Set ss2 = "Документ по зарахуванню/поверненню потрібно ввести окремо"
.head 5 +  ! If lParam = 5 ! На альтернативный счет
.head 6 -                                                                 Set s1 = SalStrTrimX(sNamAlt)   ! Получатель
.head 6 -                                                                 Set s2 = SalStrTrimX(sNlsAlt)   ! Счет получателя
.head 6 -                                                                 Set s3 = GetBankMfo()           ! Банк получателя
.head 6 -                                                                 Set s4 = SalStrTrimX('Перекр.док ' || tbl.ND || ' від ' ||
    SalFmtFormatDateTime(tbl.DATD,'dd/MM/yy') || '. Платник МФО ' || tbl.MFOA ||
    ' Рах ' || tbl.NLSA || ' ' || tbl.NAMA || '/' || ' Отримувач Рах ' || tbl.NLSB || '/ ' || tbl.NAZN)
.head 6 -                                                                 Set s5 = tbl.OKPOB2
.head 6 -                                                                 Set ss1 = IifS(tbl.DK=0, "ПЕРЕДЕБЕ", "ПЕРЕКРЕДИ") || "ТУВАТИ документ на альтернативний рахунок ?"
.head 6 -                                                                 Set ss2 = "Буде сформировано внутрішній мем.ордер"
.head 5 +  If SalMessageBox(ss1 || PutCrLf() || ss2, 'Увага', MB_YesNo | MB_IconHand) = IDYES
.head 6 +  If lParam = 1 or lParam = 3   !  Вернуть или на другой счет
.head 7 +  If not IsWindow(hWinDoc)
.head 8 -  Call SqlPrepareAndExecute(hSql(),
"SELECT nls,nms INTO :NLSDVAL,:NMSDVAL
   FROM accounts a,opldok o
  WHERE o.acc=a.acc AND o.tt='R01' AND o.ref=:tbl.REF AND o.sos=3 AND o.dk=0")
.head 8 +  If SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set hWinDoc = SalCreateWindow(frmDocDV, hWndMDI, hWndForm, tbl, tbl.REF,
    IifN(lParam=0, tbl.REF, 0), tbl.DK, IifS(s3=GetBankMfo(), 'DV1', 'DV2'),
    tbl.S*100, NMSDVAL, s1, NLSDVAL, s2, s3, s5, s4)
.head 6 +  Else If lParam = 0 or lParam = 4   !  Удалить или зачислить
.head 7 -  Set sErrTxt=''
.head 7 +  While TRUE
.head 8 -  Call SqlPrepareAndExecute(hSql(),"SELECT ref INTO :nFetchRes FROM tdval WHERE ref=:tbl.REF FOR UPDATE OF ref NOWAIT")
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set sErrTxt='Невозможно получить доступ'
.head 9 -  Break
.head 8 +  If lParam = 4        ! -- Удалить
.head 9 +  If not SqlPLSQLCommand(hSql(),'gl.pay_bck('||Str(tbl.REF)||',3)')
.head 10 -  Set sErrTxt='Ошибка при BAK операции'
.head 10 -  Break
.head 8 +  Else If lParam = 0   ! -- Зачислить досрочно
.head 9 +  If not SqlPrepareAndExecute(hSql(),"UPDATE opldok SET fdat=:dDat WHERE ref=:tbl.REF and sos in (0,3)")
.head 10 -  Set sErrTxt='Ошибка при изм.даты в OPKDOK'
.head 10 -  Break
.head 8 -  ! Else If lParam = 0   ! -- Зачислить досрочно
.head 8 +  If not SqlPLSQLCommand(hSql(),'gl.pay(2,'||Str(tbl.REF)||
',dDat,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null)')
.head 9 -  Set sErrTxt='Ошибка при факт. оплате'
.head 9 -  Break
.head 8 +  If not SqlPrepareAndExecute(hSql(), "DELETE FROM tdval WHERE ref=:tbl.REF")
.head 9 -  Set sErrTxt='Невозможно удалить ссылку из TDVAL'
.head 9 -  Break
.head 8 -  Call SqlCommitEx(hSql(), ss1 || ' REF=' || Str(tbl.REF))
.head 8 -  Break
.head 7 +  If sErrTxt
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageErrorEx(sErrTxt || '. Референс '||Str(tbl.REF))
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_ObjDeactivate
.head 4 +  If lParam
.head 5 -  Call SalDisableWindow(pbBackToSender)
.head 5 -  Call SalDisableWindow(pbInside)
.head 5 -  ! Call SalDisableWindow(pbOutside)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  ! Call SalDisableWindow(pbAlt)
.head 5 -  Call SalDisableWindow(pbRefresh)
.head 5 -  Call SalDisableWindow(pbUpdate)
.head 5 -  Call SalDisableWindow(pbSearch)
.head 5 -  Call SalDisableWindow(pbFilter)
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 5 -  Call SalDisableWindow(tbl)
.head 5 -  Call SalDisableWindow(ml)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbBackToSender)
.head 5 -  Call SalEnableWindow(pbInside)
.head 5 -  ! Call SalEnableWindow(pbOutside)
.head 5 -  Call SalEnableWindow(pbDel)
.head 5 -  ! Call SalEnableWindow(pbAlt)
.head 5 -  Call SalEnableWindow(pbRefresh)
.head 5 -  Call SalEnableWindow(pbUpdate)
.head 5 -  Call SalEnableWindow(pbSearch)
.head 5 -  Call SalEnableWindow(pbFilter)
.head 5 -  Call SalEnableWindow(pbDetails)
.head 5 -  Call SalEnableWindow(pbPrint)
.head 5 -  Call SalEnableWindow(tbl)
.head 5 -  Call SalEnableWindow(ml)
.head 1 +  Form Window: frmDocDV               ! 19
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49433
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 49434
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 49435
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 49436
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49437
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 49428
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNamB=sRcvr
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfOkpoB=strOkpoB
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call frmDocDV.HideIt(hWndItem)
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNazn=strNazn
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrTxt
.head 4 +  Actions
.head 5 -  Set frmDocDV.m_nRef=nRefPara1
.head 5 +  While TRUE
.head 6 -  Call SqlPrepareAndExecute(hSql(),"SELECT ref INTO :nFetchRes FROM tdval WHERE ref=:nRefPara0 FOR UPDATE OF ref NOWAIT")
.head 6 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set sErrTxt='Невозможно получить доступ к'
.head 7 -  Break
.head 6 +  If cDocW.oDoc()
.head 7 +  ! If cDocW.m_sTT='901'
.head 8 +                                                                 If not SqlPLSQLCommand(hSql(),
   "DynTT(1,cDocW.m_nRef,cDocW.m_dDatV1,
     cDocW.m_nDk,cDocW.A.Kv,cDocW.A.Nls,cDocW.A.S,
                 cDocW.B.Kv,cDocW.B.Nls,cDocW.B.S)")
.head 9 -                                                                 Set sErrTxt='Невозможно выполнить связанную операцию для '||cDocW.m_sTT
.head 9 -                                                                 Break
.head 7 +  If SqlPrepareAndExecute(hSql(), "DELETE FROM tdval WHERE ref=:nRefPara0") and
                   SqlPLSQLCommand(hSql(),'gl.pay_bck('||Str(nRefPara0)||',3)')
.head 8 +  If not SqlPLSQLCommand(hSql(),'gl.pay(2,'||Str(nRefPara0)||
',frmDocDV.m_dDatV1,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null)')
.head 9 -  Set sErrTxt='Ошибка при факт. оплате'
.head 9 -  Break
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Set sErrTxt='Невозможно удалить из TDVAL'
.head 8 -  Break
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call MessageErrorEx('Ошибка : ' || sErrTxt ||' REF='||SalNumberToStrX(nRefPara0,0))
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWnd
.head 3 -  Window Handle: hWndTbl
.head 3 -  Number: nRefPara0
.head 3 -  Number: nRefPara1
.head 3 -  Number: nDkPara     ! Д/К
.head 3 -  String: sSWT_TT     ! Код операции
.head 3 -  Number: nAmnt       ! Сумма
.head 3 -  String: sSndr       ! Отправитель
.head 3 -  String: sRcvr       ! Получатель
.head 3 -  String: strNlsA     ! Счет А
.head 3 -  String: strNlsB     ! Счет Б
.head 3 -  String: strMfoB     ! МФО Б
.head 3 -  String: strOkpoB    ! Код получателя
.head 3 -  String: strNazn     ! Назначение платежа
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, 1)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Choose
.head 4 -  Set bDocStart=TRUE
.head 4 -  Set sTT=sSWT_TT
.head 4 -  Set sNlsA_TT=strNlsA
.head 4 -  Set sNlsB_TT=strNlsB
.head 4 -  Set sBankB_TT=strMfoB
.head 4 -  Set nId=GetUserId()
.head 4 -  Set nKvA_TT=GetBaseVal()
.head 4 -  Set dDat=GetBankDate()
.head 4 -  Call SqlPrepareAndExecute(hSql(),T("
SELECT t.name,t.flags,t.fli,t.flv,t.sk
  INTO :sTTN,:sFlags,:nFli,:nFlv,:nSk FROM tts t WHERE t.tt=:sTT"))
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не описана операция "||sTT,'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call Flgs2aFlg(sFlags)
.head 4 -  Call SqlPrepareAndExecute(hSql(),'SELECT kv,dig INTO :sLcv,:nDigA FROM tabval WHERE kv=:nKvA_TT')
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не найдена валюта "||Str(nKvA_TT),'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set nKvB_TT=nKvA_TT
.head 4 -  Set nDk=nDkPara
.head 4 -  Set nS=nAmnt/SalNumberPower(10, nDigA)
.head 4 -  Call SalSetWindowText(hWndForm, 'Ввод документа - [ ' ||sTTN|| ' ]')
.head 4 -  Call ShowApdVersion('19')
.head 4 +  If not aFlg[9]
.head 5 -  Set nSk_TT=NUMBER_Null
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 3 +  On SAM_Destroy
.head 4 -  ! Call SalEnableWindow(hWnd)
.head 4 -  Call SalSendMsg( hWnd,UM_ObjDeactivate, 0, 0)
.head 4 -  Call SalSendMsg( hWndTbl, UM_Populate, 0, 0)
.head 1 +  Form Window: frmDocTZ               ! 20
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.925"
.head 4 -  Top:    1.604"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51823
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 51824
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 51825
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 51826
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51827
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbOrdBack
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Back.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nMode=2 and SalStrLeftX(strDrec,2)!='#*'
.head 8 -  Call SalShowWindow( hWndItem )
.head 8 -  Set strTip = 'Запрос на возврат документа'
.head 7 +  Else
.head 8 -  Call SalHideWindow( hWndItem )
.head 6 +  On SAM_Click
.head 7 -  Set frmDocTZ.nDk=2
.head 7 -  Call SalSendMsg( hWndForm, UM_Insert, 0, 0 )
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.HideIt( hWndItem )
.head 3 -  Background Text:
.head 4 -  Resource Id: 51818
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNd=sNumDoc
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.HideIt( hWndItem )
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  If nMode=2
.head 7 -  Set dfDocD=dDocPara
.head 7 -  Call frmDocTZ.HideIt( hWndItem )
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  If nMode=2
.head 7 -  Set dfNamA=sSndr
.head 7 -  Set dfOkpoA=strOkpoA
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.UnHideIt( hWndItem )
.head 5 +  On SAM_Validate
.head 6 -  Set sTmpValidOKPO=dfOkpoB
.head 6 -  Set sTmpValidNAMB=dfNamB
.head 6 -  Set nValidReturn=SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 6 +  If nMode=2
.head 7 -  Set dfOkpoB=sTmpValidOKPO
.head 7 -  Set dfNamB=sTmpValidNAMB
.head 6 -  Return nValidReturn
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNamB=sRcvr
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.UnHideIt( hWndItem )
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfOkpoB=strOkpoB
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.UnHideIt( hWndItem )
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call frmDocTZ.HideIt(hWndItem)
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNazn=strNazn
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If nMode=2
.head 7 -  Call frmDocTZ.HideIt( hWndItem )
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrTxt
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 -  Call SqlPrepareAndExecute(hSql(),"SELECT rec INTO :nFetchRes FROM tzapros WHERE rec=:nRecPara0 FOR UPDATE OF rec NOWAIT")
.head 6 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set sErrTxt='Невозможно получить доступ к'
.head 7 -  Break
.head 6 +  If nMode=2
.head 7 -  Set cDoc.m_sDrec=strDrec
.head 7 +  If cDoc.m_nDk=2
.head 8 +  If strNlsB!=dfNlsB or strOkpoB!=dfOkpoB
.head 9 -  Set sErrTxt='У вимозі заборонено заміну № рахунку чи коду ОКПО'
.head 9 -  Break
.head 8 -  Set cDoc.m_sDrec = SalStrReplaceX(cDoc.m_sDrec,1,1,'-')
.head 8 -  Set cDoc.m_sNazn="В результаті уточнення належного отримувача слід повернути кошти за документом"
.head 7 +  Else
.head 8 +  If SalStrLeftX(cDoc.m_sDrec,2)='#*'
.head 9 +  If strNlsB!=dfNlsB or strOkpoB!=dfOkpoB
.head 10 -  Set sErrTxt='У відповіді щодо платежу, якого немає в банку заборонено заміну № рахунку чи коду ОКПО'
.head 10 -  Break
.head 9 -  Set cDoc.m_sNazn="Відповідь на запит щодо платежу, якого немає в банку-відправнику"
.head 8 +  Else
.head 9 +  If strNlsB=dfNlsB and strOkpoB!=dfOkpoB
.head 10 -  Set cDoc.m_sDrec = SalStrReplaceX(cDoc.m_sDrec,1,1,'!')
.head 9 +  Else If strNlsB!=dfNlsB and strOkpoB=dfOkpoB
.head 10 -  Set cDoc.m_sDrec = SalStrReplaceX(cDoc.m_sDrec,1,1,'+')
.head 9 +  Else
.head 10 -  Set sErrTxt='У відповіді дозволено заміну або № рахунку або коду ОКПО'
.head 10 -  Break
.head 9 -  Set cDoc.m_sNazn="Уточнення реквізитів документа"
.head 7 -  Set cDoc.m_sNazns = '11'
.head 7 -  Set cDoc.m_nVob=nVobPara
.head 7 -  Set cDoc.m_dDatD = dDocPara
.head 7 -  Set cDoc.m_dDatP = dPosPara
.head 6 +  If nMode=3 and SalStrLeftX(cDoc.A.Bank,1)='8'
.head 7 -  Set cDoc.m_nPyD = 0
.head 6 +  If cDocW.oDoc()
.head 7 +  If SqlPrepareAndExecute(hSql(), "UPDATE tzapros SET otm=:nMode,dat=:dDat WHERE rec=:nRecPara0")
.head 8 +  If nMode=3 and SalStrLeftX(cDoc.A.Bank,1)='8'
.head 9 -  Call SqlPrepareAndExecute(hSql(),"SELECT nbs INTO :sTmp FROM kaz_dohb WHERE nbs='"||SalStrLeftX(cDoc.A.Nls,4)||"'")
.head 9 +  If SqlFetchNext(hSql(),nFetchRes)
.head 10 +  If not PayTT(0,cDoc.m_nRef,cDoc.m_dDatV1,'DDZ',cDoc.m_nDk,cDoc.A.Kv,cDoc.A.Nls,cDoc.A.S,cDoc.B.Kv,cDoc.B.Nls,cDoc.B.S)
.head 11 -  Set sErrTxt = 'Неуспешная оплата связанной транзакции DDZ'
.head 11 -  Break
.head 9 +  If cDoc.m_nFlg=1
.head 10 +  If not cDoc.P_Fac(cDoc.m_nRef, SalFmtFormatDateTime(cDoc.m_dDatV1, 'MM-dd-yyyy'))
.head 11 -  Set sErrTxt = 'Невозможно оплатить док. РЕФ #' || Str(cDoc.m_nRef)
.head 11 -  Break
.head 8 +  If GetGlobalOption('TZPRINT')='1'
.head 9 -  Call DocsPrint(nRecPara0, 'ARC_RRP', PRINT_DOC )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Set sErrTxt='Неможливо вилучити з TZAPROS'
.head 8 -  Break
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call MessageErrorEx('Помилка : ' || sErrTxt ||' REC='||SalNumberToStrX(nRecPara0,0))
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWnd
.head 3 -  Window Handle: hWndTbl
.head 3 -  Number: nRecPara0   ! rec в ARC_RRP
.head 3 -  Number: nMode       ! 2-Ответ на запрос на изменение 3-Удовлетворить запрос
.head 3 -  Number: nDkPara     ! Д/К
.head 3 -  Number: nVobPara
.head 3 -  String: sSWT_TT     ! Код операции
.head 3 -  String: sNumDoc     ! Номер документа
.head 3 -  Number: nKvPara     ! Валюта
.head 3 -  Number: nAmnt       ! Сумма
.head 3 -  String: sSndr       ! Отправитель
.head 3 -  String: sRcvr       ! Получатель
.head 3 -  String: strNlsA     ! Счет А
.head 3 -  String: strNlsB     ! Счет Б
.head 3 -  String: strMfoB     ! МФО Б
.head 3 -  String: strOkpoA    ! Код отправителя
.head 3 -  String: strOkpoB    ! Код получателя
.head 3 -  String: strNazn     ! Назначение платежа
.head 3 -  String: strDrec     ! ДопРеквизиты
.head 3 -  Date/Time: dDocPara  ! Дата исходного документа  (только для
.head 3 -  Date/Time: dPosPara  ! Дата поступил в Банк А исходного документа
.head 2 +  Window Variables
.head 3 -  Number: nValidReturn
.head 3 -  String: sTmpValidOKPO
.head 3 -  String: sTmpValidNAMB
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, 1)
.head 4 -  Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
.head 3 +  On UM_Choose
.head 4 -  Set bDocStart=TRUE
.head 4 -  Set sTT=sSWT_TT
.head 4 -  Set sNlsA_TT=strNlsA
.head 4 -  Set sNlsB_TT=strNlsB
.head 4 -  Set sBankB_TT=strMfoB
.head 4 -  Set nId     = GetUserId()
.head 4 -  Set nKvA_TT = nKvPara
.head 4 -  Set dDat    = GetBankDate()
.head 4 -  Call SqlPrepareAndExecute(hSql(),T("
SELECT t.name,t.flags,t.fli,t.flv,t.sk
  INTO :sTTN,:sFlags,:nFli,:nFlv,:nSk FROM tts t WHERE t.tt=:sTT"))
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не описана операция "||sTT,'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call Flgs2aFlg(sFlags)
.head 4 -  Call SqlPrepareAndExecute(hSql(),'SELECT kv,dig INTO :sLcv,:nDigA FROM tabval WHERE kv=:nKvA_TT')
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Не найдена валюта "||Str(nKvA_TT),'DlgMSG_Error', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set nKvB_TT=nKvA_TT
.head 4 -  Set nDk=nDkPara
.head 4 -  Set nS=nAmnt/SalNumberPower(10, nDigA)
.head 4 -  Call SalSetWindowText(hWndForm, 'Ввод документа - [ ' ||sTTN|| ' ]')
.head 4 -  Call ShowApdVersion('20')
.head 4 +  If not aFlg[9]
.head 5 -  Set nSk_TT=NUMBER_Null
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 4 +  If SalIsWindowEnabled (pbPayDoc)
.head 5 -  Call SalEnableWindow(pbOrdBack)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbOrdBack)
.head 3 +  On SAM_Destroy
.head 4 -  ! Call SalEnableWindow(hWnd)
.head 4 -  Call SalSendMsg( hWnd,UM_ObjDeactivate, 0, 0)
.head 4 -  Call SalSendMsg( hWndTbl, UM_Populate, 0, 0)
.head 1 +  Dialog Box: dlg_ZapReqPrt     ! 21
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Друк реєстрів по уточненню реквізитів
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.575"
.head 4 -  Top:    1.719"
.head 4 -  Width:  8.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.881"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Combo Box: cmbTipZapr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    0.369"
.head 5 -  Width:  7.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.369"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nMode=0
.head 7 -  Call SalListAdd( hWndItem, 'ОТРИМАНІ ВІДПОВІДІ на УТОЧНЕННЯ РЕКВІЗИТІВ' )
.head 7 -  Call SalListAdd( hWndItem, 'ВІДПРАВЛЕНІ ЗАПИТИ на УТОЧНЕННЯ РЕКВІЗИТІВ' )
.head 6 +  Else
.head 7 -  Call SalListAdd( hWndItem, 'ОТРИМАНІ ЗАПИТИ на УТОЧНЕННЯ РЕКВІЗИТІВ' )
.head 7 -  Call SalListAdd( hWndItem, 'ВІДПРАВЛЕНІ ВІДПОВІДІ на УТОЧНЕННЯ РЕКВІЗИТІВ' )
.head 6 -  Call SalListSetSelect ( hWndItem, 0 )
.head 5 +  ! On SAM_Click
.head 6 -                                                                Set nTmp=SalListQuerySelection ( hWndItem )
.head 6 -                                                                Set sTit=SalListQueryTextX ( hWndItem, nTmp )
.head 6 -  ! Set sTit='РЕЄСТР '||sTit||' на УТОЧНЕННЯ РЕКВІЗИТІВ'
.head 3 -  Background Text: з
.head 4 -  Resource Id: 50627
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.533"
.head 5 -  Top:    0.833"
.head 5 -  Width:  0.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dDat1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.15"
.head 6 -  Top:    0.833"
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: по
.head 4 -  Resource Id: 50628
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.817"
.head 5 -  Top:    0.833"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dDat2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.467"
.head 6 -  Top:    0.833"
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  ! cpbOk: pbOk
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Надрукувати
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    1.179"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +                                                                Message Actions
.head 5 +                                                                On SAM_Click
.head 6 -  ! Call SalSendMsg( cmbTipZapr, SAM_Click, 0, 0 )
.head 6 -                                                                Set nTmp=SalListQuerySelection ( cmbTipZapr )
.head 6 -                                                                Set sTit=SalListQueryTextX ( cmbTipZapr, nTmp )
.head 6 -  ! Call Debug(Str(nTmp)||sTit)
.head 6 -                                                                Set strBind='DAT,MFOA,NLSA,MFOB,NLSB,DK,S,VOB,ND,KV,DATD,NAMA,NAMB,NAZN,DREC,ID_A,ID_B,NMK'
.head 6 -  ! !
.head 6 -                                                                Set sFilNem=GetFilNem('ZP'||Str(nTmp)||'_'||SalFmtFormatDateTime(GetBankDate(),'ddMM'))
.head 6 -                                                                Call SalWaitCursor( TRUE )
.head 6 -                                                                Call SalStatusSetText ( hWndForm, sFilNem )
.head 6 -                                                                Call SalPrtSetDefault('Generic / Text Only', 'WINSPOOL', 'FILE:')
.head 6 -  !
.head 6 -  ! Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\BARS014'||SalStrLeftX(GetLang(),1)||'.QRP',
     sFilNem, strBind, strBind, 1, RPT_PrintAll, 1, 1, FALSE, nInd )
.head 6 -                                                                Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\BARS014.QRP',
     sFilNem, strBind, strBind, 1, RPT_PrintAll, 1, 1, FALSE, nInd )
.head 6 +                                                                If nInd>4
.head 7 -                                                                Call SalMessageBox( 'Ошибка '||SalNumberToStrX( nInd, 0 )||' при формировании отчета', 'Внимание', MB_IconExclamation )
.head 6 -                                                                Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
.head 6 -                                                                Call zarez12(sFilNem, 90, sDeviceDef)
.head 6 -                                                                Call SalWaitCursor( FALSE)
.head 6 -                                                                Call SalStatusSetText ( hWndForm, 'Готово' )
.head 6 -                                                                Call SalEndDialog( hWndForm,1)
.head 3 +  ! cpbCancel: cpbCancel
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вийти
.head 4 -  Window Location and Size
.head 5 -  Left:   6.467"
.head 5 -  Top:    1.179"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +                                                                Message Actions
.head 5 +                                                                On SAM_Click
.head 6 -                                                                Set nMode=-1
.head 6 -                                                                Call SalEndDialog( hWndForm,-1)
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.633"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalSendMsg( cmbTipZapr, SAM_Click, 0, 0 )
.head 6 -  Set nTmp=SalListQuerySelection ( cmbTipZapr )
.head 6 -  Set sTit=SalListQueryTextX ( cmbTipZapr, nTmp )
.head 6 -  ! Call Debug(Str(nTmp)||sTit)
.head 6 -  Set strBind='DAT,MFOA,NLSA,MFOB,NLSB,DK,S,VOB,ND,KV,DATD,NAMA,NAMB,NAZN,DREC,ID_A,ID_B,NMK'
.head 6 -  ! !
.head 6 -  Set sFilNem=GetFilNem('ZP'||Str(nTmp)||'_'||SalFmtFormatDateTime(GetBankDate(),'ddMM'))
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalStatusSetText ( hWndForm, sFilNem )
.head 6 -  ! Call SalPrtSetDefault('Generic / Text Only', 'WINSPOOL', 'FILE:')
.head 6 -  !
.head 6 -  ! Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\BARS014'||SalStrLeftX(GetLang(),1)||'.QRP',
     sFilNem, strBind, strBind, 1, RPT_PrintAll, 1, 1, FALSE, nInd )
.head 6 -  Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\BARS014.QRP',
     sFilNem, strBind, strBind, 1, RPT_PrintAll, 1, 1, FALSE, nInd )
.head 6 +  If nInd>4
.head 7 -  Call SalMessageBox( 'Ошибка '||SalNumberToStrX( nInd, 0 )||' при формировании отчета', 'Внимание', MB_IconExclamation )
.head 6 -  ! Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
.head 6 -  Call zarez12(sFilNem, 90, sDeviceDef)
.head 6 -  Call SalWaitCursor( FALSE)
.head 6 -  Call SalStatusSetText ( hWndForm, 'Готово' )
.head 6 -  Call SalEndDialog( hWndForm,1)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.233"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Set nMode=-1
.head 6 -  Call SalEndDialog( hWndForm,-1)
.head 3 -  Frame
.head 4 -  Resource Id: 39018
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.226"
.head 5 -  Width:  7.867"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: GetFilNem
.head 4 -  Description: Ищет "свободное" имя файла
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sFn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  String: sTmp
.head 5 -  Date/Time: dDatTmp
.head 4 +  Actions
.head 5 -  Set i=0
.head 5 +  While i<=999
.head 6 -  Set sTmp=GetPrnDir()||'\\'||sFn||'.'||SalFmtFormatNumber(i,'000')
.head 6 +  If SalFileGetDateTime(sTmp,dDatTmp)
.head 7 -  Set i=i+1
.head 6 +  Else
.head 7 -  Break
.head 5 -  Return sTmp
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Receive String: sFilNem
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 3 -  ! Report variables
.head 3 -  Date/Time: DAT
.head 3 -  String: MFOA
.head 3 -  String: NLSA
.head 3 -  String: MFOB
.head 3 -  String: NLSB
.head 3 -  Number: DK
.head 3 -  Number: S
.head 3 -  Number: VOB
.head 3 -  String: ND
.head 3 -  Number: KV
.head 3 -  Date/Time: DATD
.head 3 -  String: NAMA
.head 3 -  String: NAMB
.head 3 -  String: NAZN
.head 3 -  String: DREC
.head 3 -  String: ID_A
.head 3 -  String: ID_B
.head 3 -  String: NMK
.head 3 -  !
.head 3 -  String: strBind
.head 3 -  ! String: sFilNem
.head 3 -  !
.head 3 -  Number: nInd
.head 3 -  !
.head 3 -  String: sDeviceDef
.head 3 -  String: sDriverDef
.head 3 -  String: sPortDef
.head 3 -  String: sTit
.head 3 -  !
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( dlg_ZapReqPrt )
.head 4 -  Call ShowApdVersion('21')
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Set dDat1=GetBankDate()
.head 4 -  Set dDat2=GetBankDate()
.head 3 +  On SAM_ReportStart
.head 4 +  If nMode=1 and nTmp=0     ! Запросы к нам
.head 5 -  Set sTmp="mfob="||GetBankMfo()||" AND SUBSTR(d_rec,1,2)='#?'"
.head 5 -  ! Set sTit='ОТРИМАНИХ ЗАПИТІВ на УТОЧНЕННЯ РЕКВІЗИТІВ'
.head 4 +  Else If nMode=0 and nTmp=1 ! Запросы наши
.head 5 -  Set sTmp="mfoa="||GetBankMfo()||" AND SUBSTR(d_rec,1,2)='#?'"
.head 5 -  ! Set sTit='ВІДПРАВЛЕНИХ ЗАПИТІВ на УТОЧНЕННЯ РЕКВІЗИТІВ'
.head 4 +  Else If nMode=0 and nTmp=0 ! Ответы нам
.head 5 -  Set sTmp="mfob="||GetBankMfo()||" AND SUBSTR(d_rec,1,2) IN ('#!','#+','#-','#*')"
.head 5 -  ! Set sTit='ОТРИМАНИХ ВІДПОВІДЕЙ на УТОЧНЕННЯ РЕКВІЗИТІВ'
.head 4 +  Else If nMode=1 and nTmp=1 ! Ответы наши
.head 5 -  Set sTmp="mfoa="||GetBankMfo()||" AND SUBSTR(d_rec,1,2) IN ('#!','#+','#-','#*')"
.head 5 -  ! Set sTit='ВІДПРАВЛЕНИХ ВІДПОВІДЕЙ на УТОЧНЕННЯ РЕКВІЗИТІВ'
.head 4 -  ! Call DebugN(nTmp)
.head 4 -  Call SqlPrepare( hSql(),T(
"SELECT dat_a,mfoa,nlsa,mfob,nlsb,dk,s,vob,nd,kv,datd,nam_a,nam_b,nazn,d_rec,id_a,id_b
   INTO :DAT,:MFOA,:NLSA,:MFOB,:NLSB,:DK,:S,:VOB,:ND,:KV,:DATD,:NAMA,:NAMB,:NAZN,:DREC,:ID_A,:ID_B
   FROM arc_rrp
  WHERE "||sTmp||" AND dat_a >=:dDat1 AND dat_a -1  < :dDat2
  ORDER BY nlsb"))
.head 4 -  ! /* AND dat_a BETWEEN :dDat1 AND :dDat2 */
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'REENAZN', sTit )
.head 4 -  Call SalReportSetDateTimeVar(SalNumberToWindowHandle( wParam ),'DAT1', dDat1 )
.head 4 -  Call SalReportSetDateTimeVar(SalNumberToWindowHandle( wParam ),'DAT2', dDat2 )
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'aMFO', GetBankMfo() )
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'aNAME', GetBankName() )
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'VYK', GetUserRealName())
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return SqlExecute( hSql() )
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! Dos To Win
.head 5 -  Set S=S/100
.head 5 -  If GetGlobalOptionEx('SEPNUM')=2
.head 5 +  Else
.head 6 -  Set ND = StrDosToWinX(ND)
.head 6 -  Set NAMA = StrDosToWinX(NAMA)
.head 6 -  Set NAMB = StrDosToWinX(NAMB)
.head 6 -  Set NAZN = StrDosToWinX(NAZN)
.head 6 -  Set DREC = StrDosToWinX(DREC)
.head 5 +  If nTmp=1 or nTmp=3
.head 6 -  Set NMK=NAMA
.head 5 +  Else
.head 6 -  Set NMK=NAMB
.head 5 -  Return TRUE
.head 1 +  Table Window: tblMisysAcc    ! 22
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Процесінгові рахунки BMRS
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.88"
.head 4 -  Top:    1.267"
.head 4 -  Width:  13.014"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.5"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 38880
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 38881
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 38882
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.086"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вхідний
залишок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вихідний
залишок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call ShowApdVersion('22')
.head 4 -  Set tblMisysAcc.nFlags=GT_ReadOnly
.head 4 -  ! Call SalTblSetLockedColumns( hWndForm, 3 )
.head 4 -  Set tblMisysAcc.strSqlPopulate=
"SELECT NMS, NLS, OST, DOS, KOS
    INTO :tblMisysAcc.colNms,:tblMisysAcc.colNls,:tblMisysAcc.colOstO,
         :tblMisysAcc.colDos,:tblMisysAcc.colKos FROM sal"
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam )
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set colDos=colDos/100
.head 4 -  Set colKos=colKos/100
.head 4 -  Set colOstO=colOstO/100
.head 4 -  Set colOstI=colOstO+colDos-colKos
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, wParam, lParam )
.head 4 -  Call VisTblAutoSizeColumn(tblMisysAcc, hWndNULL)
.head 1 +  Table Window: tblIPS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Відповіді ІПС
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  17.15"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.31"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51104
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Друк квитанції'
.head 6 +  On SAM_Click
.head 7 +  If colFnQa
.head 8 -  Call PrintKvt(colFnQb)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51105
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51106
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colDatQb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
відповіді
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFnQb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ім'я
файлу
QB
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDatSep
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
платежу
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
банку А
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
в банку А
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
банку Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
в банку Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
платежу
(в коп.)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFnQa
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ім'я
файлу
QA
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFnA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ім'я
файлу
джерела
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! cColumnLabeled: colDatA
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Час
виготовлення
файлу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  ! cColumnLabeled: colDatPA
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Час
отримання
файлу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: hhhh:mm dd/MM/yy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colFnB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ім'я
файлу
одержувача
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! cColumnLabeled: colDatB
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Час
виготовлення
файлу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: hhhh:mm dd/MM/yy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  ! cColumnLabeled: colDatPB
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Час
зарахування
на коррахунок
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: hhhh:mm dd/MM/yy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 2 +  Functions
.head 3 +  Function: PrintKvt_dos
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFileQB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hF
.head 5 -  String: sFileName
.head 5 -  String: sRec
.head 5 -  String: sFnQA
.head 5 -  String: sFnA
.head 5 -  String: sDatA
.head 5 -  String: sDatPA
.head 5 -  String: sFnB
.head 5 -  String: sDatB
.head 5 -  String: sDatPB
.head 5 -  Number: nRet
.head 4 +  Actions
.head 5 +  If not SqlPrepareAndExecute(hSql(), "select fn_qa into :sFnQA from ips_rrp where fn_qb = :sFileQB and rec_qb = 1")
.head 6 -  Return FALSE
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Set sFileName = GetPrnDir() || '\\' || 'P' || Subs(sFnQA, 2, 11)
.head 5 +  If not SalFileOpen(hF, sFileName, OF_Create | OF_Write | OF_Text)
.head 6 -  Call SalMessageBox('Не вдалося створити файл.', 'Повідомлення', 0)
.head 6 -  Return FALSE
.head 5 -  Call SalFilePutStr(hF, Chr(213) || SalStrRepeatX(Chr(205), 87) || Chr(184) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
' ЦРП' || PadL(GetBankName(), 75) || Spac(8) ) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
' Дата відповіді ' || SalFmtFormatDateTime(colDatQb, 'dd/MM/yy') || ' ( ДД/ММ/РР )' || 
Spac(39) || 'МФО ' || PadL(GetBankMfo(),6) || ' ' 
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(198) || SalStrRepeatX(Chr(205), 87) || Chr(181) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR(' На Ваш запит, надісланий у файлі ' || sFnQA || ', надаємо інформацію', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR(' щодо проходження електронного платіжного документу в СЕП НБУ:', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || Spac(87) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR('  Дата        МФО           Рахунок     МФО           Рахунок    Д     Сума платежу', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR('  платежу    банку А       в банку А   банку Б       в банку Б   К      в копійках', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
' ' || PadR(SalFmtFormatDateTime(colDatSep, 'dd/MM/yy'), 8) || PadL(colMfoA, 11) ||
PadL(colNlsA,16) || PadL(colMfoB, 10) || PadL(colNlsB,16) || PadL(Str(colDk),4) || PadL(Str(colS),20) || ' '
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || Spac(87) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(195) || SalStrRepeatX(Chr(196), 87) || Chr(180) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR(" Ім'я          Час            Час            Ім'я         Час            Час зараху-", 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR(' файлу         виготовлення   отримання      файлу        виготовлення   вання на', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || StrWinToDosX(
PadR(' джерела       файлу          файлу          одержувача   файлу          коррахунок    ', 87)
) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || Spac(87) || Chr(179) )
.head 5 -  Call SqlPrepareAndExecute(hSql(), 
"select to_char(rec_qb),
        fn_a, to_char(dat_a, 'hh24:mi dd/mm/yy'), to_char(dat_pa, 'hh24:mi dd/mm/yy'), 
        fn_b, to_char(dat_b, 'hh24:mi dd/mm/yy'), to_char(dat_pb, 'hh24:mi dd/mm/yy')
   into :sRec, :sFnA, :sDatA, :sDatPA, :sFnB, :sDatB, :sDatPB
   from ips_rrp
  where fn_qb = :sFileQB
  order by rec_qb")
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalFilePutStr(hF, Chr(179) || 
sRec || '.' || 
PadR(sFnA,12) || ' ' || PadR(sDatA,14) || ' ' || PadR(sDatPA,14) || ' ' ||
PadR(sFnB,12) || ' ' || PadR(sDatB,14) || ' ' || PadR(sDatPB,14)
 || Chr(179) )
.head 6 -  Call SalFilePutStr(hF, Chr(179) || Spac(87) || Chr(179) )
.head 5 -  Call SalFilePutStr(hF, Chr(179) || Spac(87) || Chr(179) )
.head 5 -  !
.head 5 -  Call SalFilePutStr(hF, Chr(212) || SalStrRepeatX(Chr(205), 87) || Chr(190) )
.head 5 -  Call SalFileClose(hF)
.head 5 -  ! Call MessageNoWait('Файл зформовано: ' || sFileName, 'Повідомлення', 5, 0)
.head 5 -  Call SalLoadAppAndWait( 'DView.exe ' || sFileName, Window_NotVisible, nRet)
.head 5 -  Return TRUE
.head 3 +  Function: PrintKvt
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFileQB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hF
.head 5 -  String: sFileName
.head 5 -  String: sRec
.head 5 -  String: sFnQA
.head 5 -  String: sFnA
.head 5 -  String: sDatA
.head 5 -  String: sDatPA
.head 5 -  String: sFnB
.head 5 -  String: sDatB
.head 5 -  String: sDatPB
.head 5 -  Number: nRet
.head 4 +  Actions
.head 5 +  If not SqlPrepareAndExecute(hSql(), "select fn_qa into :sFnQA from ips_rrp where fn_qb = :sFileQB and rec_qb = 1")
.head 6 -  Return FALSE
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Set sFileName = GetPrnDir() || '\\' || 'P' || Subs(sFnQA, 2, 11)
.head 5 +  If not SalFileOpen(hF, sFileName, OF_Create | OF_Write | OF_Text)
.head 6 -  Call SalMessageBox('Не вдалося створити файл.', 'Повідомлення', 0)
.head 6 -  Return FALSE
.head 5 -  Call SalFilePutStr(hF, SalStrRepeatX(Chr(45), 89))
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
' ЦРП' || PadL(GetBankName(), 75) || Spac(8) 
|| Chr(124))
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
' Дата відповіді ' || SalFmtFormatDateTime(colDatQb, 'dd/MM/yy') || ' ( ДД/ММ/РР )' || 
Spac(39) || 'МФО ' || PadL(GetBankMfo(),6) || ' ' 
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || SalStrRepeatX(Chr(45), 87) || Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR(' На Ваш запит, надісланий у файлі ' || sFnQA || ', надаємо інформацію', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR(' щодо проходження електронного платіжного документу в СЕП НБУ:', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || Spac(87) || Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR('  Дата        МФО           Рахунок     МФО           Рахунок    Д     Сума платежу', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR('  платежу    банку А       в банку А   банку Б       в банку Б   К      в копійках', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
' ' || PadR(SalFmtFormatDateTime(colDatSep, 'dd/MM/yy'), 8) || PadL(colMfoA, 11) ||
PadL(colNlsA,16) || PadL(colMfoB, 10) || PadL(colNlsB,16) || PadL(Str(colDk),4) || PadL(Str(colS),20) || ' '
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || Spac(87) || Chr(124))
.head 5 -  Call SalFilePutStr(hF, Chr(124) || SalStrRepeatX(Chr(45), 87) || Chr(124))
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR(" Ім'я          Час            Час            Ім'я         Час            Час зараху-", 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR(' файлу         виготовлення   отримання      файлу        виготовлення   вання на', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || 
PadR(' джерела       файлу          файлу          одержувача   файлу          коррахунок    ', 87)
|| Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || Spac(87) || Chr(124) )
.head 5 -  Call SqlPrepareAndExecute(hSql(), 
"select to_char(rec_qb),
        fn_a, to_char(dat_a, 'hh24:mi dd/mm/yy'), to_char(dat_pa, 'hh24:mi dd/mm/yy'), 
        fn_b, to_char(dat_b, 'hh24:mi dd/mm/yy'), to_char(dat_pb, 'hh24:mi dd/mm/yy')
   into :sRec, :sFnA, :sDatA, :sDatPA, :sFnB, :sDatB, :sDatPB
   from ips_rrp
  where fn_qb = :sFileQB
  order by rec_qb")
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalFilePutStr(hF, Chr(124) || 
sRec || '.' || 
PadR(sFnA,12) || ' ' || PadR(sDatA,14) || ' ' || PadR(sDatPA,14) || ' ' ||
PadR(sFnB,12) || ' ' || PadR(sDatB,14) || ' ' || PadR(sDatPB,14)
 || Chr(124) )
.head 6 -  Call SalFilePutStr(hF, Chr(124) || Spac(87) || Chr(124) )
.head 5 -  Call SalFilePutStr(hF, Chr(124) || Spac(87) || Chr(124))
.head 5 -  !
.head 5 -  Call SalFilePutStr(hF, SalStrRepeatX(Chr(45), 89))
.head 5 -  Call SalFileClose(hF)
.head 5 -  ! Call MessageNoWait('Файл зформовано: ' || sFileName, 'Повідомлення', 5, 0)
.head 5 -  Call SalLoadAppAndWait( 'DView.exe ' || sFileName, Window_NotVisible, nRet)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndObject
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set hWndForm.tblIPS.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.tblIPS.strFilterTblName = 'ips_rrp'
.head 4 -  Set hWndForm.tblIPS.strPrintFileName = 'ips_rrp'
.head 4 -  Set hWndForm.tblIPS.strSqlPopulate = 
"select dat_sep, mfoa, nlsa, mfob, nlsb, dk, s, kv,
        fn_qa, fn_qb, dat_qb, fn_a, fn_b
   into :hWndForm.tblIPS.colDatSep, :hWndForm.tblIPS.colMfoA, :hWndForm.tblIPS.colNlsA,
        :hWndForm.tblIPS.colMfoB, :hWndForm.tblIPS.colNlsB,
        :hWndForm.tblIPS.colDk, :hWndForm.tblIPS.colS, :hWndForm.tblIPS.colKv,
        :hWndForm.tblIPS.colFnQa, :hWndForm.tblIPS.colFnQb, :hWndForm.tblIPS.colDatQb,
        :hWndForm.tblIPS.colFnA, :hWndForm.tblIPS.colFnB
   from ips_rrp 
  order by dat_qb, fn_qb, rec_qb"
.head 4 -  ! Set hWndForm.tblIPS.strSqlPopulate = 
"select dat_sep, mfoa, nlsa, mfob, nlsb, dk, s, kv,
        fn_qa, fn_qb, dat_qb, fn_a, dat_a, dat_pa, fn_b, dat_b, dat_pb
   into :hWndForm.tblIPS.colDatSep, :hWndForm.tblIPS.colMfoA, :hWndForm.tblIPS.colNlsA,
        :hWndForm.tblIPS.colMfoB, :hWndForm.tblIPS.colNlsB,
        :hWndForm.tblIPS.colDk, :hWndForm.tblIPS.colS, :hWndForm.tblIPS.colKv,
        :hWndForm.tblIPS.colFnQa, :hWndForm.tblIPS.colFnQb, :hWndForm.tblIPS.colDatQb,
        :hWndForm.tblIPS.colFnA, :hWndForm.tblIPS.colDatA, :hWndForm.tblIPS.colDatPA, 
        :hWndForm.tblIPS.colFnB, :hWndForm.tblIPS.colDatB, :hWndForm.tblIPS.colDatPB
   from ips_rrp 
  order by dat_qb, fn_qb, rec_qb"
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalDisableWindow(hWndObject)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_TableColumn)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 -  On SAM_DoubleClick
