.head 0 +  Application Description: 06-12-2010 Сухова Т.А 
Фьючерс - НБУ
(раньше біло что-то от Кучугурнрго Алексея)
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000003F0100 002C000000020000 0003000000000000 0060020000F7FFFF
0040: FFDCFFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773024650
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 30342E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: bars013.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: DOCVIEW.APD
.head 2 -  Dynalib: Watchdog.apd
.head 2 -  Dynalib: Ssplashd.apd
.head 2 -  Dynalib: Dblogin.apd
.head 2 -  Dynalib: License.apd
.head 2 -  Dynalib: Dfltrapi.apd
.head 2 -  !
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: VTCal.apl
.head 2 -  File Include: Xsalimg.apl
.head 2 -  File Include: Gentimer.apl
.head 2 -  File Include: GenButn.apl
.head 2 -  File Include: GenFcls.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Gentbls.apl
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: Vtdos.apl
.head 2 -  File Include: Vtlbx.apl
.head 2 -  File Include: Vttblwin.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Ttp32.apl
.head 2 -  File Include: signfile.apl
.head 2 -  File Include: Genfiltr.apl
.head 2 -  File Include: vtcomm.apl
.head 2 -  File Include: vtmisc.apl
.head 2 -  File Include: vtstr.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: VTSPLIT.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yy
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Date/Time: dd-MM-yy hh:mm:ss
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: ApdNum   =  '02'
.head 4 -  String: ApdVer   =  '01'
.head 4 -  ! История изменений: -----------------------------------------------------|
.head 4 -  ! 01 30-11-01  MIK     Заложил новые apd                        |
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hWin30
.head 3 -  Window Handle: hWin31
.head 3 -  Window Handle: hWin32
.head 3 -  Window Handle: hWin33
.head 3 -  Window Handle: hWin34
.head 3 -  Number: nFetchRes
.head 2 +  Internal Functions
.head 3 +  Function: Sel004	! __exported
.head 4 -  Description: Bars004_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! надо вставить инициализацию apd
.head 5 +  Select Case nMode
.head 6 +  ! Case 0   ! Ручное формирование файлов СЭП  $A
.head 7 +   If not IsWindow(hWin0)
.head 8 -   Set hWin0=SalCreateWindow(splSepFiles,hWndParent,nPar)
.head 7 +   Else 
.head 8 -   Call SalBringWindowToTop ( splSepFiles )
.head 7 -   Break 
.head 6 +  Case 1   !Формирование файлов для Крединфо
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1=SalCreateWindow(MB_Exp,hWndParent,nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (MB_Exp)
.head 7 -  Break
.head 6 +  Case 2   !Свифты. Просмотр цепочки уточняющих сообщений
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2=SalCreateWindow(SW_UTOCH,hWndParent,nPar, strPar01)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (SW_UTOCH)
.head 7 -  Break
.head 6 +  Case 30   !Свифты. Просмотр цепочки уточняющих сообщений
.head 7 +  If not IsWindow(hWin30)
.head 8 -  Set hWin30 = SalCreateWindow( FU, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( hWin30 )
.head 7 -  Return TRUE
.head 3 +  Function: ShowApdVersion
.head 4 -  Description: Показать версию APD
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strText
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strText, 160 )
.head 5 -  Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
.head 5 -  Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1394641701
0000: 9102000039010000 0000000000000000 0200000400FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F41003C00 000D630052616469
0040: 6F4C69730074426F 7886000000F00500 0000E0010D000000 FF3F0D00B9000100
0060: FFFFE01A00000001 FE00FF8327000000 01FB00FF0F340000 00EE0100FF3F0180
0080: 004E000000010000 000009635369676E 4669006C65A00000 0006003C0000010D
00A0: FB00FF6F0D00EE01 00FFBF1AB9000100 FFFFE6270001FE00 FF9B340001FB00FF
00C0: 4F410000EE0100FF 3F01800022000000 02000000C00A6347 656E460074657274
00E0: 0000000479000002 44040000010000FF E08001000000DF04 D800010D00FF7F11
0100: 700000000200FFFF C11500000001FD00 FFC7018022000003 0000000B6347E344
0120: 4669CF0004DE0002 D1000100003F8001 F9000037040001F6 0D00FFDF11DC0002
0140: 00FF7F1573000100 FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbGetValue
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box: cOutlineListBox
.head 3 -  Combo Box: cOutlineComboBox
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  Table Window: MB_Exp
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экспорт МБД / МБК в КредИнфо
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.833"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.214"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbALL
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set df3='Формирование файла экспорта...'
.head 7 -  Call CreateFile()
.head 7 -  Set df3=''
.head 7 -  Call SalSendMsg( MB_Exp.pbRefresh, SAM_Click, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Формирование файла экспорта'
.head 4 +  Pushbutton: pbNEW
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\UNFORM.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Рассыпать незаквитованый файл'
.head 7 -  Call SalHideWindow( pbNEW )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( MB_Exp.pbReceipt, SAM_Click, 0, 0 )
.head 7 -  Call SalModalDialog( DelFileExp, MB_Exp)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\REFRESH.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbReceipt
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHKMAIL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set df3='Чтение файлов квитанций'
.head 7 -  Call ReadKvit()
.head 7 -  Set df3=''
.head 7 -  Call SalSendMsg( MB_Exp.pbRefresh, SAM_Click, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Принять файлы квитанций'
.head 4 -  Line
.head 5 -  Resource Id: 1594
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.033"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  8.033"
.head 6 -  End Y:  1.214"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.233"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.667"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.1"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If MB_Exp.REF !=NUMBER_Null
.head 8 -  Call DocViewContentsEx(hWndMDI, MB_Exp.REF )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1595
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.217"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  7.217"
.head 6 -  End Y:  0.524"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 1596
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.933"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  1.933"
.head 6 -  End Y:  0.524"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 1597
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  -0.033"
.head 6 -  Begin Y:  0.512"
.head 6 -  End X:  8.033"
.head 6 -  End Y:  0.512"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.417"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1598
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.0"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  5.0"
.head 6 -  End Y:  0.512"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: df1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.333"
.head 7 -  Top:    0.786"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.369"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set df1=300
.head 6 +  On SAM_AnyEdit
.head 7 +  If df1<0
.head 8 -  Set df1=0
.head 7 -  Set df5=df1
.head 4 +  Combo Box: cmb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    0.905"
.head 6 -  Width:  4.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.881"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set sTip[1]='Ручной режим'
.head 7 -  Set sTip[2]='Авто обновление'
.head 7 -  Set sTip[3]='Авто форирование/квитовка/обновление'
.head 7 -  Call SalListInsert (cmb1,0, sTip [3] )
.head 7 -  Call SalListInsert (cmb1,0, sTip [2] )
.head 7 -  Call SalListInsert (cmb1,0, sTip [1] )
.head 7 -  Set cmb1=sTip[1]
.head 6 +  On SAM_Click
.head 7 +  If cmb1!=sTip[1]
.head 8 -  Call SalTimerSet ( df5, 1, 1000 )
.head 8 -  Set df5=df1
.head 7 +  Else
.head 8 -  Call SalTimerKill ( df5, 1 )
.head 8 -  Set df3=''
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Set df5=NUMBER_Null
.head 7 +  If cmb1=sTip[3]
.head 8 -  Set df5=-5
.head 8 -  Call SalSendMsg( MB_Exp.df5, SAM_Timer, 0, 0 )
.head 4 +  Data Field: df3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.233"
.head 7 -  Top:    0.571"
.head 7 -  Width:  4.85"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.274"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: df5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.867"
.head 7 -  Top:    0.786"
.head 7 -  Width:  0.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.381"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Timer
.head 7 +  If df1!=0
.head 8 +  If df5=df1
.head 9 -  Set df3=''
.head 9 -  Call SalWaitCursor( FALSE )
.head 8 -  Set df5=df5-1
.head 8 +  If df5<=0 and df1!=0
.head 9 -  Call SalWaitCursor( TRUE )
.head 9 -  Set df5=df1
.head 9 +  If cmb1=sTip[2]
.head 10 -  Call SalSendMsg( MB_Exp.pbRefresh, SAM_Click, 0, 0 )
.head 9 +  If cmb1=sTip[3]
.head 10 -  Call SalSendMsg( MB_Exp.pbRefresh, SAM_Click, 0, 0 )
.head 10 -  Call SalSendMsg( MB_Exp.pbReceipt, SAM_Click, 0, 0 )
.head 10 -  Set nCurrentRow = TBL_MinRow
.head 10 +  Loop
.head 11 +  If SalTblFindNextRow ( MB_Exp, nCurrentRow,ROW_UnusedFlag1,0) 
.head 12 -  Call SalTblSetRowFlags ( MB_Exp, nCurrentRow, ROW_Selected, TRUE )
.head 11 +  Else
.head 12 -  Break
.head 10 -  Call SalSendMsg( MB_Exp.pbALL, SAM_Click, 0, 0 )
.head 4 -  Background Text: Период
.head 5 -  Resource Id: 1599
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.4"
.head 6 -  Top:    0.583"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Таймер
.head 5 -  Resource Id: 1600
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.95"
.head 6 -  Top:    0.583"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pb10
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.333"
.head 6 -  Top:    0.798"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\PUT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set df1=df1+30
.head 7 -  Set df5=df1
.head 4 +  Pushbutton: pb11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.333"
.head 6 -  Top:    0.964"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\PUTD.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set df1=df1-30
.head 7 +  If df1<0
.head 8 -  Set df1=0
.head 7 -  Set df5=df1
.head 4 -  Background Text: Дата вал.
документа
.head 5 -  Resource Id: 40791
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.133"
.head 6 -  Top:    0.119"
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.345"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: VDATE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.533"
.head 7 -  Top:    0.155"
.head 7 -  Width:  1.367"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yyyy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalSetFieldEdit ( VDATE, 1 )
.head 7 -  Set VDATE=GetBankDate()
.head 6 +  On SAM_AnyEdit
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Check Box: VdateEnable
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.133"
.head 6 -  Top:    0.119"
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If VdateEnable=1
.head 8 -  Call SalShowWindow  ( VDATE )
.head 8 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 7 +  If VdateEnable=0
.head 8 -  Call SalHideWindow  ( VDATE )
.head 8 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set VdateEnable=1
.head 2 +  Contents
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
док-та
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата вал.
док-та
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd-MM-yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет-А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет-Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Д/К
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SOS
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFO_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО Банка-
корреспондента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV_ZAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КВ
залога
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назначение
платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Switzerland
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: F_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла
экспорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS_KVIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние
экспорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS_KVIT_TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние экспорта
словами 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVIT_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла
квитанции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOCTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
док-та
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAPRTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Напр.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: STAVKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PERIOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Период действия
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PERIOD_TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Период действия
договора словами
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CreateFile
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: FileName
.head 5 -  String: NextNum
.head 5 -  String: FileHead
.head 5 -  String: FileBodyLine
.head 5 -  String: BankDate
.head 5 -  String: FileBody
.head 5 -  File Handle: FileHandle
.head 5 -  Number: nFile
.head 5 -  Number: nCurrentRow
.head 5 -  Number: LineNumber
.head 5 -  String: LineNumberS
.head 5 -  Number: FileLength
.head 5 -  String: strCredSignType
.head 5 -  String: strCredOpenKey
.head 5 -  String: strCredSecretDrv
.head 5 -  String: strCredDebugIdOper
.head 5 -  String: strCredDebugKeyDate
.head 5 -  String: strIdOper
.head 5 -  Long String: m_lsSign        ! подпись на документе
.head 5 -  Number: nSignLen ! ширина подписи в байтах
.head 5 -  Number: nErrorSign
.head 5 -  Number: FileRef
.head 5 -  Number: CountToExp
.head 4 +  Actions
.head 5 -  ! Вычитываем параметры из ini-файла
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Call SalGetProfileString(INI_DigitalSignature, 'CredSignType',     'NBU',      strCredSignType,    GetIniFileName())
.head 5 -  Call SalGetProfileString(INI_DigitalSignature, 'CredOpenKey',      '.',        strCredOpenKey,     GetIniFileName())
.head 5 -  Call SalGetProfileString(INI_DigitalSignature, 'CredSecretDrv',    'a:',       strCredSecretDrv,   GetIniFileName())
.head 5 -  Call SalGetProfileString(INI_DigitalSignature, 'CredDebugIdOper',  STRING_Null,strCredDebugIdOper, GetIniFileName())
.head 5 -  Call SalGetProfileString(INI_DigitalSignature, 'CredDebugKeyDate', STRING_Null,strCredDebugKeyDate,GetIniFileName())
.head 5 +  If strCredDebugIdOper=STRING_Null
.head 6 -  Set strCredDebugIdOper=GetIdOper()
.head 5 +  If strCredDebugKeyDate=STRING_Null
.head 6 -  Set strCredDebugKeyDate=GetKeyDate()
.head 5 +  If strCredImpPath=STRING_Null
.head 6 -  Call SalMessageBox( 'Ошибка формирования файла.
Отсувствует параметр CredImpPath в ini-файле','Внимание!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Call SignFile.SetVariables(
  strCredSignType,
  strCredOpenKey,
  strCredSecretDrv,
  strCredDebugIdOper,
  strCredDebugKeyDate,
  5
 )
.head 5 +  If NOT SignFile._bInited
.head 6 +  If NOT SignFile.Init()
.head 7 -  Call SalMessageBox( 'Ошибка формирования файла.
Невозможно инициализировать эл. подпись','Внимание!', MB_Ok )
.head 7 -  Return FALSE
.head 5 -  ! Call Debug('ЭЦП инициализирована')
.head 5 -  Set KeyId=SignFile._strKeyID
.head 5 -  Set CountToExp=SalStrToNumber( GetRowNumToExp())
.head 5 +  If SqlPrepareAndExecute( hSql(),"select LPAD(nvl(max(to_number(substr(F_NAME,-3))),0)+1,3,'0')
                                      into :NextNum
                                      from MB_FILE_EXP
                                      where trunc(dat_f)=trunc(sysdate)")
.head 6 -  If SqlFetchNext( hSql(), NFeechRes )
.head 6 +  Else
.head 7 -  Set NextNum='001'
.head 5 -  Set FileName='WI'||KeyId||'.'||NextNum
.head 5 -  ! Call Debug('Имя файла = '||FileName)
.head 5 +  ! If not SalFileOpen(FileHandle,FileName,OF_Binary|OF_ReadWrite|OF_Create)
.head 6 -   Call SalMessageBox( 'Невозможно открыть файл:'||FileName,'Внимание', MB_Ok)
.head 5 -  Set nFile=_sopen(strCredImpPath||'\\'||FileName,0x8000|0x0100|0x0002,0x20,0x00000180)
.head 5 -  Call SalDateToStr ( GetBankDate(),BankDate)
.head 5 +  If not SqlPrepareAndExecute( hSql(),"Insert into MB_FILE_EXP(F_REF,F_NAME,SIGN_KEY,DAT_F) VALUES (nvl((select max(F_REF)+1 from MB_FILE_EXP ),1),:FileName,:KeyId,sysdate)")
.head 6 -  Call SalMessageBox( 'Ошибка формирования файла.
Невозможно произвести запись в базу данных','Внимание!', MB_Ok )
.head 6 -  Call SqlRollback( hSql())
.head 6 -  Call _close ( nFile)
.head 6 -  Call SalFileOpen ( Handl,strCredImpPath||'\\'||FileName,  OF_Delete )
.head 6 -  Return FALSE
.head 5 +  If CountToExp=0
.head 6 -  ! Call MessageNoWait( 'Ошибка формирования файла.
Отсувствует информация для экспорта','Внимание!', 3,0 )
.head 6 -  Call SqlRollback( hSql())
.head 6 -  Call _close ( nFile)
.head 6 -  Call SalFileOpen ( Handl,strCredImpPath||'\\'||FileName,  OF_Delete )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return FALSE
.head 5 -  Set BankDate=SalStrMidX (BankDate ,8,2)||'.'||SalStrMidX (BankDate,5,2)||'.'||SalStrMidX (BankDate,0,4)
.head 5 -  ! Call Debug('BankDate = '||BankDate)
.head 5 -  Set FileHead="count_doc="||GetRowNumToExp()||",date_doc="||BankDate||",idkey="||KeyId
.head 5 -  Call SalFileWrite( FileHandle, FileHead, SalStrLength (FileHead))
.head 5 -  Call _write(nFile,FileHead, SalStrLength (FileHead))
.head 5 -  Set nCurrentRow = TBL_MinRow
.head 5 -  Set LineNumber = 0
.head 5 -  Call SalCreateWindow(Progress, Hand )
.head 5 +  Loop
.head 6 +  If SalTblFindNextRow ( MB_Exp, nCurrentRow,ROW_Selected,0) 
.head 7 +  If SalTblQueryRowFlags ( MB_Exp, nCurrentRow, ROW_UnusedFlag1 )
.head 8 -  Call _write(nFile,SalNumberToChar(13)||SalNumberToChar(10), 2)
.head 8 -  Call FProgress('aaa',SalNumberToStrX(MB_Exp.REF,0),LineNumber*100/SalStrToNumber(GetRowNumToExp()),100/SalStrToNumber(GetRowNumToExp()))
.head 8 -  Set LineNumber = LineNumber +1
.head 8 -  Set LineNumberS = SalStrRepeatX ( '0', 3-SalStrLength ( SalNumberToStrX( LineNumber, 0 )))||SalNumberToStrX( LineNumber, 0 )
.head 8 -  Call SalTblSetContext ( MB_Exp, nCurrentRow )
.head 8 -  Set FileBodyLine='lno='||LineNumberS||',doctype='||MB_Exp.DOCTYPE||',naprtype='||
MB_Exp.NAPRTYPE||',mfo_k='||MB_Exp.MFO_K||',Summa='||NumToStr(MB_Exp.SUM,2)||',Stavka='||NumToStr(STAVKA,2)
||',Valtype='||MB_Exp.KV_ZAL||',Period='||SalNumberToStrX(MB_Exp.PERIOD,0)
.head 8 -  Call _write(nFile,FileBodyLine, SalStrLength (FileBodyLine))
.head 8 +  If not SqlPrepareAndExecute( hSql(),"Insert into MB_FILE_OPER(F_REF,REF,err,lno) VALUES ((select F_REF from MB_FILE_EXP where F_NAME=:FileName and trunc(DAT_F)=trunc(sysdate)),:MB_Exp.REF,0,:LineNumber)")
or not SqlPrepareAndExecute( hSql(),"Insert into MB_EXP_ARC(REF, KV_ZAL, SOS, DOCTYPE, NAPRTYPE, MFO_K, STAVKA, PERIOD, F_NAME, PERIOD_TXT, LINE_NUMBER) 
                                                             values (:MB_Exp.REF, :MB_Exp.KV_ZAL, :MB_Exp.SOS, :MB_Exp.DOCTYPE, :MB_Exp.NAPRTYPE, :MB_Exp.MFO_K, :MB_Exp.STAVKA, :MB_Exp.PERIOD, :FileName, :MB_Exp.PERIOD_TXT, 
:LineNumber)")
                                                             
.head 9 -  Call SalMessageBox( 'Ошибка формирования файла.
Невозможно произвести запись в базу данных','Внимание!', MB_Ok )
.head 9 -  Call SqlRollback(  hSql())
.head 9 -  Call _close ( nFile)
.head 9 -  Call SalWaitCursor( FALSE )
.head 9 -  Return FALSE
.head 6 +  Else
.head 7 -  Break
.head 5 -  Call SalDestroyWindow( Progress )
.head 5 -  Call _write(nFile,SalNumberToChar(13)||SalNumberToChar(10), 2)
.head 5 -  Set FileLength = _lseek(nFile,0,2)
.head 5 -  ! Call Debug('FileLength = '||SalNumberToStrX(FileLength,0))
.head 5 -  ! Наложение ЭЦП
.head 5 -  Call SalStrSetBufferLength( m_lsSign, 65 )
.head 5 -  Set nErrorSign = SignFile.SignFile( nFile, 1, 0, FileLength, 0, nSignLen, m_lsSign)
.head 5 +  If nErrorSign!=0
.head 6 -  Call SalMessageBox( 'Ошибка при попытке подписи файла','Внимание!', MB_Ok )
.head 6 -  Call SqlRollback( hSql())
.head 6 -  Call _close ( nFile)
.head 6 -  Call SalFileOpen ( Handl,strCredImpPath||'\\'||FileName,  OF_Delete )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return FALSE
.head 5 -  Set FileLength = _lseek(nFile,0,2)
.head 5 -  Call _write(nFile, m_lsSign, nSignLen)
.head 5 -  Call _close ( nFile)
.head 5 -  Call SqlCommit( hSql())
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return TRUE
.head 3 +  Function: GetRowNumToExp
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NRowToExp
.head 5 -  String: RET
.head 4 +  Actions
.head 5 -  Set nCurrentRow = TBL_MinRow
.head 5 -  Set NRowToExp=0
.head 5 +  Loop
.head 6 +  If SalTblFindNextRow ( hWndForm, nCurrentRow, ROW_Selected, 0 )
.head 7 +  If SalTblQueryRowFlags ( MB_Exp, nCurrentRow, ROW_UnusedFlag1 )
.head 8 -  Set NRowToExp=NRowToExp+1
.head 6 +  Else
.head 7 -  Break
.head 5 -  Set RET=SalStrRepeatX ( '0', 3-SalStrLength ( SalNumberToStrX( NRowToExp, 0 )))||SalNumberToStrX( NRowToExp, 0 )
.head 5 -  Return RET
.head 3 +  Function: NumToStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: InNum
.head 5 -  Number: NumAfterPoint
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TMP_STR
.head 5 -  Number: LENGTH 
.head 4 +  Actions
.head 5 -  Set TMP_STR=SalNumberToStrX( InNum, NumAfterPoint )
.head 5 -  Set LENGTH=SalStrLength(TMP_STR)
.head 5 -  Return SalStrLeftX(TMP_STR,LENGTH-NumAfterPoint-1)||'.'||SalStrRightX(TMP_STR,NumAfterPoint)
.head 3 +  Function: FProgress
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: GlobOper
.head 5 -  String: LocOper
.head 5 -  Number: StartOper
.head 5 -  Number: CostOper
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 4 +  Actions
.head 5 -  Set Progress.df2=LocOper
.head 5 -  Set Progress.df2=GlobOper
.head 5 +  Loop
.head 6 +  If i<=100 
.head 7 -  Set i=i+1
.head 7 -  Call Progress.LocalProg.SetProgress(i)
.head 7 -  Call Progress.GlobalProg.SetProgress(StartOper+CostOper*i/100)
.head 6 +  Else
.head 7 -  Break
.head 3 +  Function: ReadKvit
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: FileName
.head 5 -  String: KvitName
.head 5 -  Date/Time: TmpDate
.head 5 -  Number: FileKV
.head 5 -  Long String: FileBody 
.head 5 -  Number: FileLength
.head 5 -  String: FileHead
.head 5 -  String: lno
.head 5 -  String: status
.head 5 -  String: descr
.head 5 -  Number: NumRow
.head 5 -  Number: PosEndStr
.head 5 -  Number: PosBeginStr
.head 5 -  String: RowStr
.head 5 -  Number: PosStatus
.head 5 -  Number: PosDescr
.head 5 -  Number: PosCrLf
.head 5 -  Number: Lno
.head 5 -  String: Status
.head 5 -  String: Descr
.head 5 -  Number: F_REF
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If SqlPrepareAndExecute( hSql(), 'Select F_Name,F_REF into :FileName, :F_REF from MB_FILE_EXP where KV_NAME is NULL and trunc(DAT_F)=trunc(sysdate)' )
.head 6 +  Loop
.head 7 +  If not SqlFetchNext( hSql(), NFeechRes )
.head 8 -  Break
.head 7 -  Set KvitName='WE'||SalStrRightX(FileName,10 )
.head 7 -  ! Call Debug('Проверка файла '||KvitName)
.head 7 +  If SalFileOpen ( Handl,strCredImpPath||'\\'||KvitName,  OF_Exist )
.head 8 -  ! Call Debug('Найден файл квитанции '||KvitName)
.head 8 -  Set FileKV=_sopen(strCredImpPath||'\\'||KvitName,0x8000|0x0000,0x20,0x00000000)
.head 8 -  Set FileLength=_lseek(FileKV,0,2)
.head 8 -  Set FileBody=SalStrRepeatX( ' ', FileLength )
.head 8 -  Call _lseek(FileKV,0,0)
.head 8 -  Call _read(FileKV,FileBody,FileLength)
.head 8 -  ! Call Debug('Длина файла '||SalNumberToStrX(FileLength,0))
.head 8 -  Call _close(FileKV)
.head 8 -  Set NumRow=0
.head 8 -  Set PosEndStr=0
.head 8 +  Loop
.head 9 -  Set PosBeginStr=PosEndStr
.head 9 -  Set PosEndStr=SalStrScan(SalStrRightX (FileBody,FileLength-PosBeginStr),SalNumberToChar(13)||SalNumberToChar(10))+2+PosBeginStr
.head 9 -  Set NumRow=NumRow+1
.head 9 +  If PosEndStr=PosBeginStr+1
.head 10 -  Break
.head 9 -  Set RowStr=SalStrMidX(FileBody,PosBeginStr,PosEndStr-PosBeginStr)
.head 9 -  ! Call Debug('Строка:'||RowStr||'begin='||SalNumberToStrX(PosBeginStr,0)||',end='||SalNumberToStrX(PosEndStr,0))
.head 9 +  If NumRow!=1
.head 10 -  Set PosStatus=SalStrScan ( RowStr, ',status=' ) 
.head 10 -  Set PosDescr=SalStrScan ( RowStr, ",descr='" ) 
.head 10 -  Set PosCrLf=SalStrScan ( RowStr, "'"||PutCrLf() ) 
.head 10 +  If PosStatus=-1 or PosDescr=-1 or  PosCrLf=-1
.head 11 -  Call MessageNoWait('Неверный формат файла квитанции '||KvitName,'Ошибка формирования файла!',5,1)
.head 11 -  Return FALSE
.head 10 -  Set Lno=SalStrToNumber(SalStrMidX ( RowStr, 4, PosStatus-4 ))
.head 10 -  Set Status=SalStrMidX ( RowStr, PosStatus+8, PosDescr-PosStatus-8 )
.head 10 -  Set Descr=SalStrMidX ( RowStr, PosDescr+8,PosCrLf-PosDescr-8)
.head 10 -  ! Call MessageNoWait('lno='||SalNumberToStrX( Lno, 0)||',Status='||Status||',Descr='||Descr,'A',1,0)
.head 10 +  If not SqlPrepareAndExecute( hSqlAux(), 'update MB_FILE_OPER set ERR=:Status, DESCR=:Descr where F_REF=:F_REF and LNO=:Lno')
.head 11 -  Call SalMessageBox( 'Ошибка разбора файла квитанции.
Невозможно произвести запись в базу данных','Внимание!', MB_Ok )
.head 11 -  Call SqlRollback(  hSqlAux())
.head 11 -  Return FALSE
.head 8 -  If not SqlPrepareAndExecute( hSqlAux(), 'Update MB_FILE_EXP Set KV_NAME=:KvitName where F_REF=:F_REF' )
.head 8 -  Call SqlCommit(  hSqlAux())
.head 8 -  Call SalFileOpen ( Handl,strCredImpPath||'\\'||KvitName,  OF_Delete )
.head 8 -  Return TRUE
.head 5 -  Call SalWaitCursor( FALSE )
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  String: sTip[*]
.head 3 -  String: sSel
.head 3 -  String: sWhere
.head 3 -  String: sOrd
.head 3 -  Number: NFeechRes
.head 3 -  : SignFile
.head 4 -  Class: cSignFile
.head 3 -  String: KeyId
.head 3 -  Number: nCurrentRow
.head 3 -  Window Handle: Hand
.head 3 -  String: strCredImpPath
.head 3 -  File Handle: Handl
.head 3 -  String: strMonth[12]              !! Наименов. месяце для календаря
.head 3 -  String: strWeekDays[7]         !! Дни недели для календаря
.head 3 -  Number: i
.head 3 -  Date/Time: dSelect                !!
.head 3 -  String: strBankDate
.head 3 -  String: strDateFrom              !! Дата  (DD-MM-YYYY)
.head 3 -  Number: nDay
.head 3 -  Number: nMonth
.head 3 -  Number: nYear
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set MB_Exp.nTabInstance = 1
.head 4 -  Set strFilterTblName="MB_DEALS_MON"
.head 4 -  Set sSel = "SELECT ref, DATD, nlsa, nlsb, dk, SOS, MFO_K, kv_zal, s/100, nazn, f_name, SOS_KVIT, SOS_KVIT_TXT, KV_NAME, DOCTYPE, NAPRTYPE, STAVKA, PERIOD,
 PERIOD_TXT
 FROM MB_DEALS_MON where DATD=decode(:VdateEnable,1,:VDATE,0,DATD)"
.head 4 -  Set sWhere = ''
.head 4 -  Set sOrd = ''
.head 4 -  Set MB_Exp.strSqlPopulate = sSel
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'CredImpPath', STRING_Null,strCredImpPath,GetIniFileName())
.head 4 -  Call SalDisableWindow( VDATE )
.head 4 -  ! Call SalDisableWindow( VdateEnable )
.head 4 -  Call SalHideWindow( VdateEnable )
.head 3 +  On SAM_FetchRowDone
.head 4 +  If MB_Exp.SOS=-1 or MB_Exp.SOS=-2
.head 5 -  Call SetTblRowColor ( MB_Exp, COLOR_Red)
.head 4 +  If MB_Exp.SOS=5
.head 5 +  If MB_Exp.F_NAME=STRING_Null
.head 6 -  Call SalTblSetRowFlags ( MB_Exp, lParam	, ROW_UnusedFlag1, TRUE )
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB ( 210, 255, 255 ) )
.head 5 +  If MB_Exp.F_NAME!=STRING_Null and MB_Exp.KVIT_NAME=STRING_Null
.head 6 -  Call SalTblSetRowFlags ( MB_Exp, lParam	, ROW_UnusedFlag2, TRUE )
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB ( 255, 255, 190 ) )
.head 5 +  If MB_Exp.F_NAME!=STRING_Null and MB_Exp.KVIT_NAME!=STRING_Null and MB_Exp.SOS_KVIT='IMP'
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_White )
.head 5 +  If MB_Exp.F_NAME!=STRING_Null and MB_Exp.KVIT_NAME!=STRING_Null and MB_Exp.SOS_KVIT!='IMP'
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB ( 255, 200, 200 ) )
.head 5 -  Call SetTblRowColor (MB_Exp, COLOR_Black)
.head 4 +  Else If MB_Exp.SOS>-1 and MB_Exp.SOS<5
.head 5 -  Call SetTblRowColor ( MB_Exp, COLOR_DarkGreen )
.head 3 +  On SAM_Close
.head 4 -  Call SignFile.Deinit()
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Form Window: Progress
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.393"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Custom Control: LocalProg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.524"
.head 6 -  Width:  5.367"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: GlobalProg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    1.321"
.head 6 -  Width:  5.35"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: df2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.274"
.head 6 -  Width:  3.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.467"
.head 6 -  Top:    1.048"
.head 6 -  Width:  3.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: DelFileExp
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Разформирование файла
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.15"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.833"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: Tab1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    -0.024"
.head 6 -  Width:  3.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.714"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: FileName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
файла
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DateTimeCreate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата/Время
формирования
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  2.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV_Exist
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Doc_Exist
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: File_Ref
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags ( Tab1, TBL_Flag_MovableCols, 0 )
.head 6 -  Call SalTblSetTableFlags ( Tab1, TBL_Flag_SingleSelection, 1 )
.head 6 -  Set strPopulate="select F_NAME,DAT_F,decode(nvl(KV_NAME,'0'),'0',0,1),decode(count(o.ref),0,0,1),e.F_REF  from mb_file_exp e, mb_file_oper o  where trunc(e.dat_f)=trunc(sysdate) and o.f_ref(+)=e.f_ref group by f_name,dat_f,kv_name,e.F_REF"
.head 6 -  Call SalTblPopulate(Tab1, hSql(), strPopulate, TBL_FillAll )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If Doc_Exist=1 and KV_Exist=0
.head 7 -  Call SetTblRowColor ( Tab1, COLOR_DarkGreen)
.head 6 +  If Doc_Exist=1 and KV_Exist=1
.head 7 -  Call SetTblRowColor ( Tab1, COLOR_Black)
.head 6 +  If Doc_Exist=0 and KV_Exist=0
.head 7 -  Call SetTblRowColor ( Tab1, COLOR_Red)
.head 3 +  Pushbutton: OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разформировать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.893"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If Tab1.Doc_Exist and not Tab1.KV_Exist
.head 7 +  If SalMessageBox( 'Вы действительно хотите разформировать файл "'||Tab1.FileName||'"?','Внимание!', MB_OkCancel )
.head 8 +  If SqlPrepareAndExecute( hSqlAux(), 'Delete from MB_FILE_OPER where F_REF=:Tab1.File_Ref' )
.head 9 -  Call SalMessageBox( 'файл "'||Tab1.FileName||'" успешно разформирован!','Информация...', MB_Ok )
.head 9 -  Call SalEndDialog( DelFileExp, 0 )
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Невозможно разформировать файл "'||Tab1.FileName||'"!','Ошибка!', MB_Ok )
.head 9 -  Call SalEndDialog( DelFileExp, 0 )
.head 3 +  Pushbutton: CANSEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.1"
.head 5 -  Top:    2.893"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( DelFileExp, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strPopulate
.head 2 -  Message Actions
.head 1 +  Form Window: SW_UTOCH
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр уточняющих SWIFT сообщений
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.094"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.557"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60792
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  1.629"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.629"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.986"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.843"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If IsTbl2
.head 8 -  Call SalSendMsg( tbl2, UM_DoubleClick, 0, 0 )
.head 7 +  Else If IsTbl
.head 8 -  Call SalSendMsg( tbl, UM_DoubleClick, 0, 0 )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60793
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  2.414"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  2.414"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 13437
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.443"
.head 6 -  Begin Y:  0.427"
.head 6 -  End X:  8.443"
.head 6 -  End Y:  0.01"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.571"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60794
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  9.157"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  9.157"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: Период выборки
.head 5 -  Resource Id: 60795
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.614"
.head 6 -  Top:    0.146"
.head 6 -  Width:  1.857"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: по
.head 5 -  Resource Id: 60796
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.2"
.head 6 -  Top:    0.156"
.head 6 -  Width:  0.386"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: DAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.671"
.head 7 -  Top:    0.125"
.head 7 -  Width:  1.514"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.557"
.head 7 -  Top:    0.115"
.head 7 -  Width:  1.514"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Periwinkle
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colSwRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.886"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: I/O
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: MT
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSwID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SWIFT
референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDateIn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
поступления
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.943"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDateOut
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
отправления
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.014"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
валютирования
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.214"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  ! Call Debug('header table populate...')
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  ! Call Debug('set focus to first row ....')
.head 6 -  Call SalTblSetRow(tbl, TBL_SetFirstRow)
.head 6 -  ! Call Debug('Send message to detail table with currency=' || Str(tbl.colInvKV) || ' amount=' || tbl.colSs || ' ref=' || Str(tbl.colRef))
.head 6 -  ! Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
.head 5 +  On UM_DoubleClick
.head 6 -  Call SalSendMsg( tbl2,  UM_Populate, 0, 0 )
.head 5 +  On UM_Create
.head 6 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Set IsTbl=TRUE
.head 5 +  On SAM_KillFocus
.head 6 -  Set IsTbl=FALSE
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.071"
.head 6 -  Top:    2.104"
.head 6 -  Width:  11.529"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.656"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colSwRef2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.886"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIO2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: I/O
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: MT
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSwID2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SWIFT
референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDateIn2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
поступления
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.943"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDateOut2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
отправления
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.014"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDate2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
валютирования
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.214"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MM-yy hh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSwTRN2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SWIFT
Поле 21
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: n
.head 5 -  Number: SW_REF
.head 5 -  String: SW_ID
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset (  hWndForm )
.head 6 -  ! Call Debug('populate detail table...')
.head 6 -  Set SW_REF=tbl.colSwRef
.head 6 +  While TRUE
.head 7 +  If SqlPrepareAndExecute( hSql(), "select substr(value,1,40) into :SW_ID from sw_operw where tag=21 and swref=:SW_REF" ) and
not SqlFetchNext( hSql(), NFetchRez )
.head 8 -  ! Call Debug('Первый вылет')
.head 8 -  Break
.head 7 -  ! Call DebugN(tbl2.colSwRef2)
.head 7 -  Call SalTblInsertRow (hWndForm,TBL_MaxRow)
.head 7 -  ! Call Debug('SW_ID='||SW_ID)
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT SWREF, IO_IND, MT, TRN, DATE_IN, DATE_OUT, VDATE 
INTO :tbl2.colSwRef2, :tbl2.colIO2, :tbl2.colMT2, :tbl2.colSwID2, :tbl2.colDateIn2, :tbl2.colDateOut2, :tbl2.colVDate2 
FROM SW_JOURNAL 
WHERE trn=:SW_ID and rownum=1") and
not SqlFetchNext( hSql(), NFetchRez )
.head 8 -  Call SalTblDeleteRow ( hWndForm, n, TBL_NoAdjust)
.head 8 -  ! Call Debug('Второй вылет')
.head 8 -  Break
.head 7 -  ! Call Debug('Сработала первая вставка')
.head 7 -  Set tbl2.colSwTRN2=Val21(tbl2.colSwRef2)
.head 7 -  Set SW_REF=tbl2.colSwRef2
.head 6 -  Call SalTblInsertRow (hWndForm, TBL_MaxRow )
.head 6 -  If SqlPrepareAndExecute( hSql(), "SELECT SWREF, IO_IND, MT, TRN, DATE_IN, DATE_OUT, VDATE 
INTO :tbl2.colSwRef2, :tbl2.colIO2, :tbl2.colMT2, :tbl2.colSwID2, :tbl2.colDateIn2, :tbl2.colDateOut2, :tbl2.colVDate2 
FROM SW_JOURNAL 
WHERE swref=:tbl.colSwRef ") and
SqlFetchNext( hSql(), NFetchRez )
.head 6 -  Set tbl2.colSwTRN2=Val21(tbl2.colSwRef2)
.head 6 +  While TRUE
.head 7 +  If SqlPrepareAndExecute( hSql(), "select swref into :SW_REF from sw_operw where tag=21 and value=:tbl2.colSwID2" ) and
not SqlFetchNext( hSql(), NFetchRez )
.head 8 -  ! Call Debug('Первый вылет')
.head 8 -  Break
.head 7 -  ! Call DebugN(tbl2.colSwRef2)
.head 7 -  Call SalTblInsertRow (hWndForm,TBL_MaxRow )
.head 7 -  ! Call Debug('SW_ID='||SW_ID)
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT SWREF, IO_IND, MT, TRN, DATE_IN, DATE_OUT, VDATE 
INTO :tbl2.colSwRef2, :tbl2.colIO2, :tbl2.colMT2, :tbl2.colSwID2, :tbl2.colDateIn2, :tbl2.colDateOut2, :tbl2.colVDate2 
FROM SW_JOURNAL 
WHERE swref=:SW_REF and rownum=1") and
not SqlFetchNext( hSql(), NFetchRez )
.head 8 -  Call SalTblDeleteRow ( hWndForm, n, TBL_NoAdjust)
.head 8 -  ! Call Debug('Второй вылет')
.head 8 -  Break
.head 7 -  ! Call Debug('Сработала вторая вставка')
.head 7 -  Set tbl2.colSwTRN2=Val21(tbl2.colSwRef2)
.head 6 -  Call SalTblSetFlagsAnyRows ( tbl2, ROW_New, FALSE, ROW_New, 0 )
.head 5 +  On UM_Create
.head 6 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Set IsTbl2=TRUE
.head 5 +  On SAM_KillFocus
.head 6 -  Set IsTbl2=FALSE
.head 5 +  On UM_DoubleClick
.head 6 -  Call SWIFTMsgView(SW_UTOCH,tbl2.colSwRef2)
.head 2 +  Functions
.head 3 +  Function: Val21
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: SWREF_
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: SWID_
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "select substr(value,1,40) into :SWID_ from sw_operw where tag=21 and swref=:SWREF_" ) and
not SqlFetchNext( hSql(), NFetchRez )
.head 6 -  Return STRING_Null
.head 5 -  Return SWID_
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar
.head 2 +  Window Variables
.head 3 -  Number: NFetchRez
.head 3 -  Boolean: IsTbl
.head 3 -  Boolean: IsTbl2
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set DAT1=GetBankDate()
.head 4 -  Set DAT2=GetBankDate()
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set strSqlPopulate =
"SELECT SWREF, IO_IND, MT, TRN, DATE_IN, DATE_OUT, VDATE 
INTO :colSwRef, :colIO, :colMT, :colSwID, :colDateIn, :colDateOut, :colVDate 
FROM SW_JOURNAL 
WHERE mt IN ("||sPar||") AND
      VDATE BETWEEN :DAT1 AND :DAT2
 ORDER BY VDATE"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  ! Call Debug('create complitte')
.head 4 -  Call SalDisableWindow(pbIns)
.head 1 +  Form Window: FI
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.25"
.head 4 -  Top:    0.542"
.head 4 -  Width:  12.767"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.131"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: № документа
.head 4 -  Resource Id: 28874
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '№ документа' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( sRASP )
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Номер та Дата распоряження 
.head 4 -  Resource Id: 24992
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    0.095"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: sRASP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.321"
.head 6 -  Width:  3.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '№ распоряж.' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( dRASP )
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dRASP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.986"
.head 6 -  Top:    0.656"
.head 6 -  Width:  2.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата распоряж.' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( BANK_DAT )
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 +  Check Box: cb_Korr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Корр.обороты
.head 4 -  Window Location and Size
.head 5 -  Left:   6.783"
.head 5 -  Top:    0.071"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Дата биржи
.head 4 -  Resource Id: 19417
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.483"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BIR_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата биржи' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmpE = BIR_DAT
.head 5 +  On SAM_Validate
.head 6 +  If BIR_DAT > BANK_DAT
.head 7 -  Call SalMessageBox( 
"<Дата биржи> НЕ может быть БОЛЬШЕ <Дата банка> ",
                    sVnim, MB_IconExclamation )
.head 7 -  Set BIR_DAT = dTmpE
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Дата банка
.head 4 -  Resource Id: 28875
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.483"
.head 5 -  Top:    0.762"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BANK_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.655"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата банка' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmpE = BANK_DAT
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 +  If BIR_DAT = DATETIME_Null
.head 7 -  If SqlPrepareAndExecute( hSql(), "select fu.DAT_BIR_BANK ( :BANK_DAT) into :BIR_DAT from dual " )
and  SqlFetchNext( hSql(), nFetchRes)
.head 6 -  !
.head 6 +  If BIR_DAT > BANK_DAT
.head 7 -  Call SalMessageBox( 
"<Дата банка>  НЕ может быть МЕНЬШЕ  <Дата биржи> ",
                    sVnim, MB_IconExclamation )
.head 7 -  Set BANK_DAT = dTmpE
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If SqlPrepareAndExecute( hSql(), 
"select to_number( to_char( :BIR_DAT ,'yyyymm') ), to_number( to_char( :BANK_DAT,'yyyymm') )
 into  :bir_YM, :bank_YM from dual" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 7 +  If bank_YM > bir_YM
.head 8 -  Set cb_Korr = 1
.head 7 +  Else
.head 8 -  Set cb_Korr = 0
.head 6 +  If nMode = 1   
.head 7 -  Call SalSetFocus( KURS_A )
.head 6 +  Else
.head 7 -  Call SalSetFocus( pb_F3 )
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 +  Data Field: REF1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.655"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Реф. покупки выбранной сделки ' )
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 21656
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.071"
.head 5 -  Width:  12.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Комбинированный код ФК
.head 4 -  Resource Id: 28877
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    1.155"
.head 5 -  Width:  10.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_F3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = "Найти среди существующих ФК"
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Set sTmp2 = STRING_Null
.head 6 -  Call FunNSIGetFiltered
 ("FU_IMG","NAME"," KOD is not null ORDER BY KOD" , sTmp, sTmp2 )
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set KOD = sTmp
.head 7 -  Call FU_Ins()
.head 7 -  Call SalMapEnterToTab( TRUE )
.head 7 -  Call SalSetFocus( rb_N )
.head 6 +  Else
.head 7 -  Set KOD = STRING_Null
.head 7 -  Set KV = NUMBER_Null
.head 3 +  Data Field: KOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    1.488"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код ФК' )
.head 3 -  !
.head 3 +  Pushbutton: pb_F1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.383"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = "Выбрать инструмент ФК"
.head 5 +  On SAM_Click
.head 6 -  ! If KOD = STRING_Null
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Set sTmp2 = STRING_Null
.head 6 -  Call FunNSIGet ("FU_INS", "NM_ENG" , sTmp, sTmp2 )
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set sSI = sTmp2
.head 7 -  Set SI = sTmp
.head 7 -  Call FU_Ins()
.head 7 -  Call SalMapEnterToTab( TRUE )
.head 7 -  Call SalSetFocus( pb_F2 )
.head 6 +  Else
.head 7 -  Set sSI = STRING_Null
.head 7 -  Set SI = STRING_Null
.head 3 +  Data Field: SI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    1.488"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код инструмента ФК' )
.head 3 +  Data Field: sSI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    1.488"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Название инструмента ФК' )
.head 3 -  !
.head 3 +  Pushbutton: pb_F2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = "Выбрать месяц поставки ФК"
.head 5 +  On SAM_Click
.head 6 -  ! If KOD = STRING_Null
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Set sTmp2 = STRING_Null
.head 6 -  Call FunNSIGet ("FU_MES","NM_ENG" , sTmp, sTmp2 )
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set sSM = sTmp2
.head 7 -  Set SM= sTmp
.head 7 -  Call FU_Ins()
.head 7 -  Call SalMapEnterToTab( TRUE )
.head 7 -  Call SalSetFocus( SY )
.head 6 +  Else
.head 7 -  Set sSM = STRING_Null
.head 7 -  Set SM = STRING_Null
.head 3 +  Data Field: SM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    1.488"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код месяца поставки' )
.head 3 +  Data Field: sSM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.283"
.head 6 -  Top:    1.488"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Название месяца поставки' )
.head 3 -  !
.head 3 +  Data Field: YYY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.983"
.head 6 -  Top:    1.488"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set YYY = '201'
.head 3 +  Data Field: SY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.486"
.head 6 -  Top:    1.488"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код года поставки' )
.head 5 +  On SAM_Validate
.head 6 -  Call FU_Ins()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( hWnd )
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Вал
.head 4 -  Resource Id: 64153
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    1.929"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    2.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Валюта инструмента ФК' )
.head 3 -  !
.head 3 -  Background Text: Наименование
.head 4 -  Resource Id: 64154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.183"
.head 5 -  Top:    1.929"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: sKOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    2.071"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Название ФК' )
.head 3 -  !
.head 3 -  Background Text: Мес
.head 4 -  Resource Id: 64156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.783"
.head 5 -  Top:    1.929"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: NPP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.75"
.head 6 -  Top:    2.095"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '№ месяца поставки' )
.head 3 -  !
.head 3 -  Background Text: Коефф.
.head 4 -  Resource Id: 64152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.283"
.head 5 -  Top:    1.929"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KOEFF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.283"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Коефф.инструмента' )
.head 3 -  !
.head 3 -  Background Text: Дата заверш
.head 4 -  Resource Id: 64155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.983"
.head 5 -  Top:    1.929"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: DAT_C
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.95"
.head 6 -  Top:    2.095"
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата завершения' )
.head 5 +  On SAM_Validate
.head 6 +  If DAT_C != DATETIME_Null and 
   Val(SalFmtFormatDateTime( DAT_C, 'MMyyyy' ) ) != NPP*10000 + 2010 + SY
.head 7 -  Call SalMessageBox( 
"<Дата завершения>  НЕ соотв <Мес+Год> поставки ", sVnim, MB_IconExclamation )
.head 7 -  Set DAT_C = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SalMapEnterToTab( TRUE )
.head 7 -  Call SalSetFocus( rb_N )
.head 7 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 19416
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.083"
.head 5 -  Top:    2.571"
.head 5 -  Width:  5.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rb_N
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: N
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    1.988"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rb_L
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 1.Long = обязательство BUY
.head 4 -  Window Location and Size
.head 5 -  Left:   5.583"
.head 5 -  Top:    2.655"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( KURS_A )
.head 3 +  Radio Button: rb_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 2.Short = обязательство SELL
.head 4 -  Window Location and Size
.head 5 -  Left:   5.583"
.head 5 -  Top:    2.905"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Magenta
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( KURS_A )
.head 3 -  !
.head 3 -  Group Box: Комбинированный Курс сделки
.head 4 -  Resource Id: 21655
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    3.238"
.head 5 -  Width:  10.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: KURS_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    3.488"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Курс сделки_A' )
.head 5 +  On SAM_Validate
.head 6 -  Call F_Kurs ()
.head 6 -  Call F_OST ()
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 +  If KURS_B = 0 and KURS_B != NUMBER_Null
.head 7 -  Call SalSetFocus( KURS )
.head 6 +  Else
.head 7 -  Call SalSetFocus( KURS_B )
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: + (
.head 4 -  Resource Id: 21659
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.083"
.head 5 -  Top:    3.512"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: KURS_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    3.488"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Курс сделки_B' )
.head 5 +  On SAM_Validate
.head 6 -  Call F_Kurs ()
.head 6 -  Call F_OST ()
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( KURS )
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: /
.head 4 -  Resource Id: 21658
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.583"
.head 5 -  Top:    3.512"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: KURS_C
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    3.488"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Курс сделки_C' )
.head 3 -  Background Text: )
.head 4 -  Resource Id: 21660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.483"
.head 5 -  Top:    3.512"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: =
.head 4 -  Resource Id: 21657
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.783"
.head 5 -  Top:    3.512"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: KURS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.183"
.head 6 -  Top:    3.488"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Курс сделки Расчетный = A  + B/C' )
.head 5 +  On SAM_Validate
.head 6 -  Call F_Kurs ()
.head 6 -  Call F_OST ()
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( KOL )
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Количество
.head 4 -  Resource Id: 28878
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    4.262"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    4.155"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество ФК' )
.head 5 +  On SAM_Validate
.head 6 +  If nMode = 1   
.head 7 +  If KOL >  nKol 
.head 8 -  Call SalMessageBox( 
"Количество НЕ м.б. более остатка на сделке="||Str(nKol),
                    sVnim, MB_IconExclamation )
.head 8 -  Set KOL = nKol 
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Call F_OST ()
.head 6 -  Call F_Nazn()
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( OST )
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Условная Стоимость
.head 4 -  Resource Id: 28880
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    4.262"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.183"
.head 6 -  Top:    4.155"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Условная стоимость сделки' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( NAZN )
.head 3 -  !
.head 3 -  !
.head 3 -  Background Text: Для назн.пл.
.head 4 -  Resource Id: 28882
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    5.179"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    5.405"
.head 6 -  Width:  11.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = NAZN
.head 5 +  On SAM_Validate
.head 6 +  If SalStrLength( NAZN  ) < 4
.head 7 -  Call SalMessageBox( 
"Назн.пл. НЕ м.б. менее 4-х символов",  sVnim, MB_IconExclamation )
.head 7 -  Set NAZN = sTmpE
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 -  Call SalSetFocus( pb_OK )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Текст для назн.пл. проводки в учете' )
.head 3 -  !
.head 3 +  Pushbutton: pb_OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    5.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Opl ()
.head 3 +  Pushbutton: pb_Clear
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Очистить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.583"
.head 5 -  Top:    5.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\REFRESH.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Clear()
.head 3 +  Pushbutton: pb_Clear1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наследовать
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    5.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\NEWREC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Clear1()
.head 3 +  Pushbutton: pb_EXIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   7.183"
.head 5 -  Top:    5.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Data Field: REF_oper
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    5.821"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Референс АБС операции покупки' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpE = REF_oper
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REF_oper =  nTmpE
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If REF_oper > 0
.head 7 -  Call DocViewContentsEx(hWndForm, REF_oper )
.head 3 +  Data Field: dSTART
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    4.821"
.head 6 -  Width:  11.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: FU_Ins
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If KOD != STRING_Null 
.head 6 -  Set SI = Subs(KOD,1,2)
.head 6 -  Set SM = Subs(KOD,3,1)
.head 6 -  Set SY = Val(Subs(KOD,4,1))
.head 5 +  Else
.head 6 +  If SI != STRING_Null and SM != STRING_Null and SY != NUMBER_Null
.head 7 -  Set KOD = SI || SM || Str(SY)
.head 5 -  !
.head 5 +  If SI != STRING_Null 
.head 6 -  If SqlPrepareAndExecute( hSql(), 
"select kv, koeff, nm_eng, k_b, k_c
 into :KV,:KOEFF, :sSI, :KURS_B, :KURS_C
 from fu_ins where SI=:SI " )
and  SqlFetchNext( hSql(), nFetchRes)
.head 6 +  If KURS_B = 0 and KURS_B !=NUMBER_Null
.head 7 -  Call SalDisableWindow( KURS_B )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( KURS_B )
.head 5 +  Else
.head 6 -  Set KV = NUMBER_Null
.head 6 -  Set KOEFF = NUMBER_Null
.head 6 -  Set KURS_B = NUMBER_Null
.head 6 -  Set KURS_C = NUMBER_Null
.head 6 -  Set sSI = STRING_Null
.head 5 -  !
.head 5 +  If SM != STRING_Null 
.head 6 -  If SqlPrepareAndExecute( hSql(), 
"select nm_eng, npp into :sSM, :NPP from fu_mes where SM=:SM " )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -  Set sKOD = sSI || ' ' || sSM || ' 201' || Str (SY)
.head 5 -  Set hWnd = rb_N
.head 5 -  Call SalDisableWindow( DAT_C )
.head 5 +  If SalStrLength( SalStrTrimX( KOD )) = 4 
.head 6 +  If SqlPrepareAndExecute( hSql(), 
"select dat_c into :DAT_C from fu_img where kod=:KOD and dat_c is not null " )
and NOT SqlFetchNext( hSql(), nFetchRes)
.head 7 +  If nMode != 1   
.head 8 -  Call SalEnableWindow( DAT_C )
.head 8 -  Set hWnd = DAT_C
.head 5 -  Call F_OST ()
.head 3 +  Function: F_Kurs
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If KURS_A != NUMBER_Null and  KURS_B != NUMBER_Null and KURS_C != NUMBER_Null 
.head 6 -  Set KURS = KURS_A + KURS_B/KURS_C
.head 5 +  Else
.head 6 -  Set KURS = NUMBER_Null
.head 3 +  Function: F_Opl
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sND
.head 5 -  Date/Time: dDATD
.head 5 -  Date/Time: dDATC
.head 5 -  Date/Time: dBir_Dat
.head 5 -  String: sKOD
.head 5 -  String: sNAZN
.head 5 -  Number: nKOL
.head 5 -  Number: nKURS
.head 5 -  Number: nOST
.head 5 -  Number: nRef1
.head 5 -  Number: nVob
.head 5 -  !
.head 5 -  Number: nRef
.head 5 -  Number: nErr
.head 5 -  String: sErr
.head 4 +  Actions
.head 5 -  Set sKOD = KOD 
.head 5 +  If sKOD = STRING_Null 
.head 6 +  If SM = STRING_Null or 
   SI = STRING_Null or 
   SY = NUMBER_Null
.head 7 -  Call SalMessageBox('Не выбран код ФК',sVnim, MB_IconStop)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set sKOD = SI || SM || Str(SY)
.head 5 +  If ND = STRING_Null 
.head 6 -  Call SalMessageBox('Не Задан № док',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If BANK_DAT = DATETIME_Null
.head 6 -  Call SalMessageBox('Не Задана Банк.Дата для учета сделки',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If KOL = NUMBER_Null or KOL < 1
.head 6 -  Call SalMessageBox('Не Задано кол-во ФК',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If OST = NUMBER_Null or  OST <= 0 
.head 6 -  Call SalMessageBox('Не Заполнена Условная стоимость',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If KURS = NUMBER_Null 
.head 6 -  Call SalMessageBox('Не Задан курс',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If rb_N
.head 6 -  Call SalMessageBox('Не указана позиция :
long/short',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 +  If rb_S
.head 7 -  Set nPOZ = 2
.head 6 +  Else If rb_L
.head 7 -  Set nPOZ = 1
.head 5 +  If SalStrLength( NAZN ) < 4 
.head 6 -  Call SalMessageBox('Не Задано Назнач.пл',sVnim, MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If SalMessageBox(
'Вы действительно желаете сохранить сделку ?',
'Внимание !', MB_IconQuestion | MB_YesNo) != IDYES
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sND = ND
.head 5 -  Set dDATD = BANK_DAT
.head 5 -  Set nKOL = KOL
.head 5 -  Set nKURS = KURS
.head 5 -  Set nOST = SalNumberRound( OST * 100)
.head 5 -  Set sNAZN = NAZN
.head 5 -  Set dDATC = DAT_C
.head 5 -  Set dBir_Dat = BIR_DAT
.head 5 -  Set nErr = 0
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set sErr = STRING_Null
.head 5 +  If cb_Korr = 1
.head 6 -  Set nVob = 96
.head 5 +  Else
.head 6 -  Set nVob = 6
.head 5 +  If nMode = 1   
.head 6 +  If nPar = 1 or nPar = 2
.head 7 -  ! продажа из НЕТТО поз
.head 7 +  If NOT SqlPLSQLCommand( hSql(),
 "FU.sell_KOD ( nVob, sND , dDATD, sKOD, nPOZ, nKOL, nKURS, nOST, sNAZN, nRef, nErr, sErr  )" )
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  ! продажа из сделки покупки
.head 7 -  Set nRef1 = REF1
.head 7 +  If NOT SqlPLSQLCommand( hSql(),
 "FU.sell_1( nVob, sND , dDATD, sKOD, nPOZ, nKOL, nKURS, nOST, sNAZN, nRef1, nRef, nErr, sErr  )" )
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 5 +  Else
.head 6 +  If NOT SqlPLSQLCommand( hSql(),
 "FU.buy_1 ( nVob, sND , dDATD, sKOD, dDATC, nPOZ, nKOL, dBir_Dat, nKURS, nOST, sNAZN, nRef, nErr, sErr  )" )
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Return FALSE
.head 5 +  If nErr > 0 
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBeep(MB_IconStop)
.head 6 -  Call MessageNoWait( 'Внимание, ош.№ '||Str(nErr) || ' '|| sErr ,'',2,1)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Set REF_oper = nRef
.head 5 -  Call SalDisableWindow( pb_OK )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call MessageNoWait( "Сделка "|| IifS(nMode=0,"BUY","SELL")||" сохранена Реф = " || Str(nRef),'',2,0)
.head 5 -  Call SalSendMsg( hWnd_Refresh, SAM_Click, 0, 0 )
.head 5 -  Return TRUE
.head 3 +  Function: F_OST
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sIns
.head 4 +  Actions
.head 5 -  ! В  операциях покупки-продажи округляем весь паке, а не 1 шт.
.head 5 -  ! Set OST = KOL * SalNumberRound( KURS*KOEFF*100*100) ) /100
.head 5 +  If nStart = 1
.head 6 -  Set OST = NUMBER_Null
.head 5 +  Else
.head 6 +  If nMode = 1   
.head 7 -  ! 3) Продажа Цена_P=Количество * Курс0 * Коэффициент
.head 7 -  Set OST = SalNumberRound( KOL * KURS * KOEFF * 100 * 100 ) /100
.head 7 -  ! Set OST = ( KOL * KURS * KOEFF * 100 * 100 ) /100
.head 6 +  Else
.head 7 -  ! 1)Покупка Цена_0=ОКРУГЛ(Количество * Курс0 * Коэффициент) 
.head 7 -  Set OST = SalNumberRound( KOL * KURS * KOEFF * 100 * 100 ) /100
.head 5 -  Return TRUE
.head 3 +  Function: F_Clear
.head 4 -  Description: Очистить єкран
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set BANK_DAT = GetBankDate()
.head 5 -  Call SalSendMsg( BANK_DAT, SAM_Validate, 0, 0 )
.head 5 -  Set dRASP = BANK_DAT
.head 5 -  Set sRASP = MASKA_R 
.head 5 -  !
.head 5 -  Set ND = STRING_Null
.head 5 -  Set rb_N = TRUE
.head 5 -  Set rb_L = FALSE
.head 5 -  Set rb_S = FALSE
.head 5 -  Set DAT_C = DATETIME_Null
.head 5 -  Set KOD = STRING_Null
.head 5 -  Set sKOD = STRING_Null
.head 5 -  Set SI = STRING_Null
.head 5 -  Set sSI = STRING_Null
.head 5 -  Set SM = STRING_Null
.head 5 -  Set sSM = STRING_Null
.head 5 -  Set KV = NUMBER_Null
.head 5 -  Set SY = NUMBER_Null
.head 5 -  Set KOL = NUMBER_Null
.head 5 -  Set KURS = NUMBER_Null
.head 5 -  Set KURS_A = NUMBER_Null
.head 5 -  Set KURS_B = NUMBER_Null
.head 5 -  Set KURS_C = NUMBER_Null
.head 5 -  Set KOEFF = NUMBER_Null
.head 5 -  Set OST = NUMBER_Null
.head 5 -  Set REF_oper = NUMBER_Null
.head 5 -  Call SalEnableWindow( pb_OK )
.head 5 -  Call SalSetFocus( ND )
.head 3 +  Function: F_Clear1
.head 4 -  Description: Очистить єкран
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set ND = STRING_Null
.head 5 -  Set KOL = NUMBER_Null
.head 5 -  Set KURS = NUMBER_Null
.head 5 -  Set KURS_A = NUMBER_Null
.head 5 -  ! Call Debug ('DO')
.head 5 -  ! Call DebugN (KURS_B)
.head 5 +  If KURS_B > 0
.head 6 -  Set KURS_B = NUMBER_Null
.head 5 -  ! Call Debug ('PO')
.head 5 -  Set OST = NUMBER_Null
.head 5 -  Set REF_oper = NUMBER_Null
.head 5 -  Call SalEnableWindow( pb_OK )
.head 5 -  Call SalSetFocus( ND )
.head 3 +  Function: F_Nazn
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sMode
.head 5 -  String: sPoz
.head 4 +  Actions
.head 5 +  If nMode = 1  
.head 6 -  Set sMode = "ПРОДАЖ "
.head 5 +  Else
.head 6 +  If nStart = 1
.head 7 -  Set sMode = "Старт:"
.head 6 +  Else
.head 7 -  Set sMode = "КУПІВЛЯ "
.head 5 +  If rb_L
.head 6 -  Set sPoz = ' ДОВГИХ '
.head 5 +  Else If rb_S
.head 6 -  Set sPoz = ' КОРОТКИХ '
.head 5 -  Set NAZN = Subs( sMode || Str(KOL) || sPoz || 'Ф"ЮЧЕРСIВ ЗА ЦІНОЮ ' || Str(KURS) || 
' (' || sSI ||' '|| sSM ||'1'||Str(SY) || '), С/Р ' || sRASP || ' ВІД ' || 
SalFmtFormatDateTime( dRASP, 'dd.MM.yyyy' ), 1, 160) 
.head 2 +  Window Parameters
.head 3 -  Number: nMode !!!! = 0 - купить (отк.поз), 1 - продать (закр.поз)
.head 3 -  Number: nPar  !!!! = REF-покупки ( или 0) 
.head 3 -  String: strPar01 ! = название окна
.head 3 -  String: strPar02 ! = KOD ФК
.head 3 -  Number: pKol  !!!! = макс.колво - для продажи
.head 3 -  Window Handle: hWnd_Refresh
.head 2 +  Window Variables
.head 3 -  String: sTmp
.head 3 -  String: sTmp2
.head 3 -  String: sVnim
.head 3 -  String: sTmpE
.head 3 -  Number: nTmpE
.head 3 -  Date/Time: dTmpE
.head 3 -  !
.head 3 -  Number: nPOZ 
.head 3 -  Number: SY
.head 3 -  Number: nStart
.head 3 -  Number: nKol  !!!! = макс.колво - для продажи
.head 3 -  !
.head 3 -  Number: bank_YM
.head 3 -  Number: bir_YM
.head 3 -  Window Handle: hWnd
.head 3 -  String: MASKA_R
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, strPar01 )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set sVnim = 'Внимание, ошибка !'
.head 4 -  Call SalDisableWindow( cb_Korr )
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "select val into :MASKA_R from fu_Param where Par = 'MASKA_R' " ) 
and SqlFetchNext( hSql(), nFetchRes)
.head 4 -  !
.head 4 -  Set nStart = 0
.head 4 +  If nMode != 1   
.head 5 -  If SqlPrepareAndExecute( hSql(),
  "select to_number(val) into :nStart from fu_Param  where Par = 'START'  " ) 
and SqlFetchNext( hSql(), nFetchRes)
.head 5 +  If nStart = 0
.head 6 -  Call SalHideWindow( dSTART )
.head 5 +  Else If nStart = 1
.head 6 -  Set dSTART = "СТАРТОВОЕ ФОРМИРОВАНИЕ ПОРТФЕЛЯ СДЕЛОК ! "
.head 4 -  !
.head 4 -  Set nPOZ = NUMBER_Null
.head 4 -  Set rb_N = FALSE
.head 4 -  Call F_Clear ()
.head 4 -  !
.head 4 +  If nPar > 10
.head 5 -  Set REF1 = nPar 
.head 5 -  Call SalDisableWindow( pb_Clear )
.head 5 -  If SqlPrepareAndExecute( hSql(),
"select  d.poz, abs(a.ostb)/100  into :nPOZ, :nKol 
 from  fu_deal d, accounts a
 where d.ref=:REF1 and a.acc=d.acck" ) 
and  SqlFetchNext( hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Call SalHideWindow( REF1 )
.head 4 -  !
.head 4 +  If nPar = 1 or nPar = 2
.head 5 -  Set nPOZ = nPar
.head 5 -  Set nKol = pKol
.head 4 -  !
.head 4 +  If strPar02 != STRING_Null
.head 5 -  Call SalDisableWindow( pb_Clear )
.head 5 -  Set KOD = strPar02
.head 5 -  Set SI= Subs(KOD,1,2)
.head 5 -  Set SM= Subs(KOD,3,1)
.head 5 -  Set SY = Val(Subs(KOD,4,1))
.head 5 -  Call SalDisableWindow( pb_F3 )
.head 5 -  Call SalDisableWindow( pb_F1 )
.head 5 -  Call SalDisableWindow( pb_F2 )
.head 5 -  Call SalDisableWindow( SY )
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select i.nm_eng, i.koeff, m.nm_eng into :sSI, :KOEFF, :sSM
 from fu_ins i, fu_mes m  where i.si=:SI and m.sm=:SM " ) 
and  SqlFetchNext( hSql(), nFetchRes)
.head 6 -  Set sKOD = sSI || ' ' || sSM || ' 201' || Str (SY)
.head 6 -  Call FU_Ins () 
.head 4 -  !
.head 4 +  If nPOZ = 2
.head 5 -  Set rb_S = TRUE
.head 5 -  Set rb_L = FALSE
.head 5 -  Call SalHideWindow( rb_L )
.head 4 +  Else If nPOZ = 1
.head 5 -  Set rb_L = TRUE
.head 5 -  Set rb_S = FALSE
.head 5 -  Call SalHideWindow( rb_S )
.head 4 +  If nMode = 1   
.head 5 -  Call SalDisableWindow( pb_Clear1 )
.head 5 -  Set KOL = nKol
.head 1 +  Table Window: FU
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Портфель фьючерсных контрактов (сделок)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    1.031"
.head 4 -  Width:  19.017"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 8.688"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.177"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNetto
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Netto - позиции ФК '
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWin32)
.head 8 -  Set hWin32 = SalCreateWindow( FN, hWndMDI, 0, 0, strTip, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( hWin32 )
.head 4 -  !
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = " Просморт Счетов по выбранной сделке "
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call F_ACC(REF)
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 +  Pushbutton: pb_Spec
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = " Просмотр Всех проводок по выбранной сделке "
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 +  If not IsWindow(hWin34)
.head 9 -  Set hWin34 = SalCreateWindow( FP, hWndMDI, 0, REF, strTip , strPar02 )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin34 )
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открыть позицию (Купить) ФК '
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWin31)
.head 8 -  Set hWin31 = SalCreateWindow( FI, hWndForm, 0, 0, strTip, STRING_Null, NUMBER_Null, pbRefresh )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( hWin31 )
.head 4 +  Pushbutton: pbIns_Copy
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ДоОткрыть позицию (Купить) ФК на базе выбранной сделки '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and REF >0
.head 8 +  If not IsWindow(hWin31)
.head 9 -  Set hWin31 = SalCreateWindow( FI, hWndForm, 0, REF, strTip, KOD, NUMBER_Null, pbRefresh )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin31 )
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 -  !
.head 4 +  Pushbutton: pb_F3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF3.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Рабочие Фьючерсные контракты"
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditF("FU_IMG",2)
.head 4 +  Pushbutton: pbRepo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = '(До)Закрыть позицию (Продать) ФК выбранной сделки '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and REF >0
.head 8 +  If not IsWindow(hWin31)
.head 9 -  Set hWin31 = SalCreateWindow( FI, hWndForm, 1, REF, strTip, KOD, NUMBER_Null, pbRefresh )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin31 )
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 -  !
.head 4 -  Background Text: Пред.Дата биржи
.head 5 -  Resource Id: 18710
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.25"
.head 6 -  Top:    0.119"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: pBIRDAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.283"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Пред.Дата биржи' )
.head 4 -  !
.head 4 +  Pushbutton: pb_Kurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\K.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Ручной Ввод и просмотр курсов '
.head 6 +  On SAM_Click
.head 7 -  !
.head 7 -  Call FunNSIEditF("FU_RATES",0)
.head 4 +  Pushbutton: pb_XSL ! Принять курсы
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Принять курсы из файла fch_rat.csv '
.head 6 +  On SAM_Click
.head 7 -  Call KursFile()
.head 4 -  Background Text: Дата биржи
.head 5 -  Resource Id: 58838
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: BIR_DAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.183"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата биржи' )
.head 6 +  On SAM_SetFocus
.head 7 -  Set dTmpE = BIR_DAT
.head 6 +  On SAM_Validate
.head 7 +  If BIR_DAT > BANK_DAT
.head 8 -  Call SalMessageBox( 
"Дата биржи = " || SalFmtFormatDateTime( BIR_DAT, "dd.MM.yyyy") || "
  НЕ может быть БОЛЬШЕ 
Дата банка = " || SalFmtFormatDateTime( BANK_DAT, "dd.MM.yyyy") ,
                    sVnim, MB_IconExclamation )
.head 8 -  Set BIR_DAT = dTmpE
.head 8 -  Return VALIDATE_Cancel
.head 7 -  If SqlPrepareAndExecute( hSql(),
"select max(BIR_DAT) into :pBIRDAT from fu_rates where BIR_DAT < :BIR_DAT " ) 
and SqlFetchNext( hSql(), nFetchRes)
.head 4 -  !
.head 4 -  Background Text: Дата банка
.head 5 -  Resource Id: 58839
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.083"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: BANK_DAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.083"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Maize
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата банка' )
.head 6 +  On SAM_SetFocus
.head 7 -  Set dTmpE = BANK_DAT
.head 6 +  On SAM_Validate
.head 7 +  If BIR_DAT = DATETIME_Null
.head 8 -  If SqlPrepareAndExecute( hSql(), "select fu.DAT_BIR_BANK ( :BANK_DAT) into :BIR_DAT from dual " )
and  SqlFetchNext( hSql(), nFetchRes)
.head 7 -  !
.head 7 +  If BIR_DAT  > BANK_DAT
.head 8 -  Call SalMessageBox( 
"Дата банка = " || SalFmtFormatDateTime( BANK_DAT, "dd.MM.yyyy")  ||"
  НЕ может быть МЕНЬШЕ  
Дата биржи = "|| SalFmtFormatDateTime( BIR_DAT, "dd.MM.yyyy") ,
                    sVnim, MB_IconExclamation )
.head 8 -  Set BANK_DAT = dTmpE
.head 8 -  Return VALIDATE_Cancel
.head 7 -  !
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"select to_number( to_char( :BIR_DAT ,'yyyymm') ), to_number( to_char( :BANK_DAT,'yyyymm') )
 into  :bir_YM, :bank_YM from dual" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 8 +  If bank_YM > bir_YM
.head 9 -  Set cb_Korr = 1
.head 8 +  Else
.head 9 -  Set cb_Korr = 0
.head 4 +  Pushbutton: pb_Pereoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Переоценка Сделок согласно введенных курсов"
.head 6 +  On SAM_Click
.head 7 -  Call F_Pereoc()
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 7 -  !
.head 4 +  Check Box: cb_Korr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: корр.об.
.head 5 -  Window Location and Size
.head 6 -  Left:   13.55"
.head 6 -  Top:    0.345"
.head 6 -  Width:  1.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  ! !!!!!!!!!
.head 4 -  Background Text: № Листа
.head 5 -  Resource Id: 24996
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.679"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: sRASP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.183"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, '№ Листа' )
.head 4 -  Background Text: Дата Листа
.head 5 -  Resource Id: 24994
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.083"
.head 6 -  Top:    0.679"
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dRASP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.083"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата Листа ' )
.head 4 -  !
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.983"
.head 6 -  Top:    0.488"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  ! On SAM_Create
.head 7 -  Set strTip = " Виконати проводки згідно макету"
.head 6 +  ! On SAM_Click
.head 7 +  If SalMessageBox(
'Ви дійсно бажаєте ' ||strTip || ' ?',
'У В А Г А  !', MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call F_Opl(1)
.head 8 -  Call SalWaitCursor(FALSE)
.head 4 -  !
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 28871
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 28872
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 28873
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Frame
.head 5 -  Resource Id: 24995
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Raised-Shadow
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dSTART
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.286"
.head 7 -  Top:    0.698"
.head 7 -  Width:  5.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф угоди
купівлі
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpE = REF
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REF = nTmpE
.head 5 +  On SAM_DoubleClick
.head 6 +  If REF > 0
.head 7 -  Call DocViewContentsEx(hWndForm, REF )
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № угоди
купівлі
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cBIR_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
Бiржi
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Банк-Дата 
угоди 
купівлі
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ФК
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = KOD
.head 5 +  On SAM_AnyEdit
.head 6 -  Set KOD = sTmpE
.head 3 +  Column: NAM_POZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Позиция
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол
ФК
пл.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
сделки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Условная
Стоимость
фактическая
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Условная
Стоимость
плановая
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: RATEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
предыдущ.
дня
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
текущего 
дня
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DELR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: План.
сумма
переоценки
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Условная
Стоимость
Расчетная
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! :FU.DAPP
.head 3 +  Column: DAPP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
 последн
операции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол
Куп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PROD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол
Прод.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование 
ФК

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_C
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
завершения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: POZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! -    Курс предыдущего дня (перед курсом текущего дня)
-    Расчетное приращение стоимомти – как плановая сумма переоценки
-  Условная стоимость по тикету (после "Кол ФК пл.")
.head 3 -  !
.head 2 +  Functions
.head 3 +  Function: F_ACC
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRef
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp = " (a.acc in (" ||Str(ACCS) ||","|| Str(ACCK )||") )" 
.head 5 +  If nPar = 2
.head 6 -  Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
.head 5 +  Else
.head 6 -  Call ShowAccF(hWndMDI, sTmp )
.head 3 +  Function: F_Pereoc
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nS
.head 5 -  Number: nRow
.head 5 -  Number: nErr
.head 5 -  String: sErr
.head 5 -  String: sDat
.head 5 -  String: sNazn
.head 5 -  Number: nVob
.head 5 -  Date/Time: bDat 
.head 5 -  Date/Time: bDat1 
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sDat =  SalFmtFormatDateTime( BIR_DAT, 'dd.MM.yyyy' ) 
.head 5 +  If SalMessageBox(
'Вы действительно желаете сделать переоценку по курсу биржи за '|| sDat || ' ?',
'Внимание !', MB_IconQuestion | MB_YesNo) != IDYES
.head 6 -  Return FALSE
.head 5 +  If cb_Korr = 1
.head 6 -  Set nVob = 96
.head 5 +  Else
.head 6 -  Set nVob = 6
.head 5 -  Set bDat  = BIR_DAT
.head 5 -  Set bDat1 = pBIRDAT
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set nErr = 0
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 +  If nRow >=0  and OSTB = OSTC and OSTC  != OSTR
.head 7 -  Set nErr = 1
.head 7 -  Set sNazn = 
'РЕЗУЛЬТАТ ПЕРЕОЦІНКИ ВІД ЗМІНИ ЦІНИ ' || sDat || ' курс='||Str(RATE)||' НА ' ||
IifS(POZ=1, 'ДОВГІ','КОРОТКI') ||
' Ф"ЮЧЕРСНІ КОНТРАКТИ (в кількості-' || 
Str(SalNumberAbs(KOL)) || ').ЛИСТ УПРАВЛІННЯ КОНТРОЛЮ РИЗИКІВ № ' || sRASP ||
' ВІД ' || SalFmtFormatDateTime( dRASP, 'dd.MM.yyyy' )
.head 7 -  Set sNazn = Subs(sNazn, 1,160)
.head 7 -  Set nS = DELR * 100
.head 7 +  If SqlPLSQLCommand(hSql(), " FU.Pereoc1 ( nVob, REF, nS, sNazn,nErr, sErr )")
.head 8 +  If nErr = 0
.head 9 -  Call SqlCommit(hSql())
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 +  If nErr = 0
.head 6 -  Call MessageNoWait( 'Успешная переоценка','',2,0)
.head 6 -  Return TRUE
.head 5 -  !
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call SalMessageBeep(MB_IconStop)
.head 5 -  Call MessageNoWait( 'НЕ успешная переоценка ' || Str(nErr) || ' '||sErr ,'',2,1)
.head 5 -  Return FALSE
.head 3 +  Function: KursFile
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sIni
.head 5 -  String: sBak
.head 5 -  String: sOk
.head 5 -  String: sIn
.head 5 -  String: strFileName
.head 5 -  String: sFile 
.head 5 -  String: Titl
.head 5 -  !
.head 5 -  String: strFilters[*]
.head 5 -  Number: nIndex
.head 5 -  ! !
.head 5 -  Number: Kol_Col  ! Количество столбцов
.head 5 -  String: Name_Sec ! Имя секции
.head 5 -  String: Telo [*,99999]
.head 5 -  ! ! Telo [*,0] - Код ФК
.head 5 -  ! ! Telo [*,1] - Курс ФК
.head 5 -  Number: n
.head 5 -  Number: i
.head 5 -  ! !
.head 5 -  String: sFileM[*]
.head 5 -  Date/Time: dDat_Bir
.head 5 -  Date/Time: dDat_Bank
.head 5 -  String: sKod
.head 5 -  Number: nKurs
.head 5 -  Number: nErr
.head 5 -  String: sErr
.head 4 +  Actions
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Set sIni = GetIniFileName()
.head 5 -  ! Вычитать имя каталога FCH_BAK
.head 5 -  Call SalGetProfileString( 'FCH', 'FCH_BAK','', sBak, sIni )
.head 5 +  If NOT SalFileSetCurrentDirectory( sBak )
.head 6 -  Call MessageAttention('Нет каталога для <FCH_BAK> = ' || sBak )
.head 5 -  ! Вычитать имя каталога FCH_OK
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Call SalGetProfileString( 'FCH', 'FCH_OK', '', sOk, sIni )
.head 5 +  If NOT SalFileSetCurrentDirectory( sOk )
.head 6 -  Call MessageAttention('Нет каталога для <FCH_OK> = ' || sOk )
.head 5 -  ! Вычитать имя каталога FCH__IN
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Call SalGetProfileString( 'FCH', 'FCH_IN', '', sIn, sIni)
.head 5 +  If NOT SalFileSetCurrentDirectory( sIn )
.head 6 -  Call MessageAttention('Нет каталога для <FCH_IN> = ' || sIn)
.head 5 -  ! Имя файла strFileName =   fch_rat.csv
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Call SalGetProfileString( 'FCH', 'FCH_FILE','', strFileName, sIni )
.head 5 -  Set sFile = sIn || '\\'|| strFileName
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  ! !!!!!!!!!
.head 5 -  Set Titl ="Курсы по ФЧК"
.head 5 -  Call SalFileSetCurrentDirectory(sIn)
.head 5 +  If NOT VisDosEnumFiles( sFile, FA_Standard, sFileM)>0
.head 6 -  Set strFilters[0] = Titl || ' (*.csv)'
.head 6 +  If sIn != ''
.head 7 -  Set strFilters[1] = sIn || '\\*.csv'
.head 6 +  Else
.head 7 -  Set strFilters[1] = '*.csv'
.head 6 -  Set nIndex = 1
.head 6 -  ! Call Debug (strFileName)
.head 6 -  ! Call Debug (sIn)
.head 6 +  If NOT SalDlgOpenFile ( hWndForm, 'Выбор файла Курсов',
 strFilters, 2, nIndex, strFileName, sIn )
.head 7 -  Call SalMessageBox("Не выбран файл Курсов ФЧК !","Ошибка ! ", MB_IconStop)
.head 7 -  Return FALSE
.head 5 -  ! ! ~!!!!
.head 5 -  Set Kol_Col = 2
.head 5 -  Set Name_Sec = '1'
.head 5 -  Set i = 0
.head 5 -  Set n = ImportCSV (sFile, ';', Telo )
.head 5 -  ! !
.head 5 +  If n = -1 !  нет файла
.head 6 -  Call SalMessageBox("Файл "|| sFile || " Не найден ! ","Ошибка ! ", MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  If n > 0
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  While i < n
.head 7 +  If i = 0
.head 8 -  ! Вычитать даты
.head 8 -  Set dDat_Bir = SalStrToDate( SalStrTrimX ( Telo [0,0] ) )
.head 8 -  Set dDat_Bank= SalStrToDate( SalStrTrimX ( Telo [0,1] ) )
.head 7 +  Else
.head 8 -  ! Вычитать курсы
.head 8 -  Set sKod =  SalStrTrimX(Telo [i,0])
.head 8 -  Set nKurs = Val(SalStrTrimX( Telo [i,1] ))
.head 8 +  If SqlPLSQLCommand(hSql(), " FU.Kurs ( dDat_Bir, dDat_Bank, sKod, nKurs, nErr, sErr )")
.head 9 +  If nErr = 0
.head 10 -  Call SqlCommit(hSql())
.head 9 +  Else
.head 10 -  ! Записать в sBak
.head 10 -  Call VisFileRename(sFile, sBak || '\\' || SalFmtFormatDateTime(dDat_Bir, 'yyyyMMdd') || '.bad')
.head 10 -  !
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("Ош.импорта, код ФК="||sKod,"Ошибка ! ", MB_IconStop)
.head 10 -  Return FALSE
.head 7 -  Set i = i + 1
.head 6 -  ! Записать в sOk
.head 6 -  Call VisFileRename(sFile, sOk || '\\' || SalFmtFormatDateTime(dDat_Bir, 'yyyyMMdd') || '.ok')
.head 6 -  !
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox( "Курсы за бирж.день = " || Telo [0,0] || "  
(банк.день = " || Telo [0,1] || ")" ,"Успешно приняты! ", MB_Ok )
.head 6 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dTmpE
.head 3 -  ! Date/Time: pBIRDAT
.head 3 -  String: aMfo
.head 3 -  String: aOkpo
.head 3 -  String: sTmpE
.head 3 -  Number: nTmpE
.head 3 -  Number: bank_YM
.head 3 -  Number: bir_YM
.head 3 -  String: sFilter
.head 3 -  String: sVnim
.head 3 -  String: sAnyRows
.head 3 -  ! String: sFilter
.head 3 -  Number: nRYN
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set aMfo = GetBankMfo()
.head 4 -  Set aOkpo= GetBankOkpoS()
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 7 )
.head 4 -  Call SalDisableWindow( cb_Korr )
.head 4 -  Set sVnim = 'Внимание, ошибка !'
.head 4 -  Set sAnyRows = 'Не выбрана сделка покупки для 
'
.head 4 -  ! Set cb_Korr = 0
.head 4 -  Set BANK_DAT = GetBankDate()
.head 4 -  Call SalSendMsg( BANK_DAT, SAM_Validate, 0, 0 )
.head 4 -  Set FU.strFilterTblName = 'FU_VIEW'
.head 4 -  Set FU.strPrintFileName = 'FU_VIEW'
.head 4 -  Set FU.fFilterAtStart = TRUE
.head 4 -  Set FU.nTabInstance = 1
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  ! ! спросить фильтр
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  If SqlPrepareAndExecute( hSql(),  "select max(bir_dat) into :pBIRDAT from fu_rates where bir_dat < :BIR_DAT " ) 
and SqlFetchNext( hSql(), nFetchRes)
.head 4 -  Set sFilter = ''
.head 4 -  Set sFilter = cF.GetFilterWhereClause(FALSE)
.head 4 -  Set FU.strSqlPopulate = 
"select s.KV, FU_VIEW.ND, FU_VIEW.DATD, FU_VIEW.REF, FU_VIEW.KOD, FU_VIEW.POZ, 
        FU_VIEW.NAM_POZ,FU_VIEW.KURS, FU_VIEW.ACCS, FU_VIEW.ACCK, FU_VIEW.SOS, 
        FU_VIEW.nm, FU_VIEW.KOL,  
        -s.ostc/100, -s.ostB/100, - fu.ostr (FU_VIEW.ref,:BIR_DAT)/100, 
        fu.rates( FU_VIEW.kod, :BIR_DAT ),  
        FU_VIEW.KUP, FU_VIEW.PROD, FU_VIEW.DAPP, FU_VIEW.DAT_C,         FU_VIEW.BIR_DAT,
        fu.rates( FU_VIEW.kod, :pBIRDAT ), 
        fu.DELR ( FU_VIEW.ref, :BIR_DAT ) /100 
 into :FU.KV,   :FU.ND,:FU.DATD,:FU.REF,:FU.KOD,:FU.POZ, :FU.NAM_POZ,:FU.KURS,
      :FU.ACCS, :FU.ACCK,:FU.SOS,  :FU.NM,:FU.KOL,  :FU.OSTC, :FU.OSTB, :FU.OSTR, :FU.RATE, 
      :FU.KUP,  :FU.PROD, :FU.DAPP,:FU.DAT_C,:FU.cBIR_DAT,    :FU.RATEP,
      :FU.DELR 
 from FU_VIEW, accounts s
 where FU_VIEW.accs = s.acc and s.dazs is null " || IifS( sFilter = "", "", " and " || sFilter ) || " 
 order by FU_VIEW.poz, FU_VIEW.kod desc "
.head 4 -  Call SalTblPopulate( hWndForm, hSql(), FU.strSqlPopulate, TBL_FillAll )
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SOS <0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 )   )
.head 4 +  Else If SOS =1 or OSTC != OSTB
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam,SalColorFromRGB( 230,255,230 )   )
.head 4 +  Else If SOS =3
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam,SalColorFromRGB( 220,255,255 )   )
.head 4 +  If POZ = 2
.head 5 -  Call XSalTblSetCellBackColor( NAM_POZ, SalColorFromRGB( 255,210,210 ) )
.head 4 +  Else
.head 5 -  Call XSalTblSetCellBackColor( NAM_POZ, SalColorFromRGB( 220,255,255 )  )
.head 4 +  If OSTR != OSTB
.head 5 -  Call XSalTblSetCellBackColor( OSTR, COLOR_Yellow )
.head 4 +  If KUP = 0
.head 5 -  Set KUP = NUMBER_Null
.head 4 +  If PROD = 0
.head 5 -  Set PROD = NUMBER_Null
.head 1 +  Form Window: FN
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Netto - позиции ФК
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.213"
.head 4 -  Top:    0.969"
.head 4 -  Width:  15.217"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.69"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.786"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 -  !
.head 4 +  Data Field: FDAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.238"
.head 7 -  Width:  2.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Check Box: cb_Korr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: С учетом корр.оборотов
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.321"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установить фильтр на LONG и SHORT таблицы '
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(tbl.cF)
.head 8 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать LONG и SHORT таблицы '
.head 6 +  On SAM_Click
.head 7 -  Call tbl.NAS()
.head 7 -  Call tbl2.NAS()
.head 4 -  !
.head 4 -  Group Box: Long
.head 5 -  Resource Id: 35949
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать таблицы LONG-позиций ФК '
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( tbl, 'Таблица SHORT-позиций ФК', GetPrnDir() || '\\LONG' , '')
.head 4 +  Pushbutton: pbRepoL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = '(До)Закрыть Long-позицию (Продать) выбранный ФК '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( tbl, ROW_Selected, 0 ) and SalStrLength( tbl.KOD) = 4
.head 8 +  If not IsWindow(hWin31)
.head 9 -  Set hWin31 = SalCreateWindow( FI, hWndForm, 1, 1, strTip, tbl.KOD, tbl.KOL, pbRefresh )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin31 )
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 -  !
.head 4 -  Group Box: Short
.head 5 -  Resource Id: 35950
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Orchid
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать таблицы SHOR-позиций ФК '
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( tbl2, 'Таблица SHORT-позиций ФК', GetPrnDir() || '\\SHORT' , '')
.head 4 +  Pushbutton: pbRepoS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.583"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Orchid
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = '(До)Закрыть Short-позицию (Продать) выбранный ФК '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( tbl2, ROW_Selected, 0 )  and SalStrLength( tbl.KOD) = 4
.head 8 +  If not IsWindow(hWin31)
.head 9 -  Set hWin31 = SalCreateWindow( FI, hWndForm, 1, 2, strTip, tbl2.KOD, - tbl2.KOL, pbRefresh )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin31 )
.head 7 +  Else
.head 8 -  Call SalMessageBox( sAnyRows || strTip,sVnim, MB_IconStop)
.head 4 -  !
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 -  !
.head 4 -  Line
.head 5 -  Resource Id: 51209
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51210
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 51211
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.0"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  18.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: KOD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код ФК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
на дату
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OST
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условная стоимость SHORT
на дату
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOLB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
текущее
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OSTB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условная стоимость SHORT
текущая
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование ФК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT_C
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
завершения 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: NAS
.head 6 -  Description: long
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: FOST
.head 7 -  String: korr
.head 7 -  String: sFilter
.head 6 +  Actions
.head 7 +  If cb_Korr = 0
.head 8 -  Set FOST ='FOST'
.head 8 -  Set korr =''
.head 7 +  Else
.head 8 -  Set FOST ='FOSTZN'
.head 8 -  Set korr ='
с корр.'
.head 7 -  !
.head 7 -  ! ! спросить фильтр
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set sFilter = ''
.head 7 -  Set sFilter = cF.GetFilterWhereClause(FALSE)
.head 7 -  Call SalTblSetColumnTitle( tbl2.KOL, "Количество
на " || SalFmtFormatDateTime(FDAT, 'dd.MM.yyyy' ) || korr )
.head 7 -  Call SalTblSetColumnTitle( tbl2.OST, "Условная стоимость SHORT
на " || SalFmtFormatDateTime(FDAT, 'dd.MM.yyyy' )  || korr )
.head 7 -  !
.head 7 -  Call SalTblSetColumnTitle( tbl.KOL, "Количество
на " || SalFmtFormatDateTime(FDAT, 'dd.MM.yyyy' ) || korr )
.head 7 -  Call SalTblSetColumnTitle( tbl.OST, "Условная стоимость LONG
на " || SalFmtFormatDateTime(FDAT, 'dd.MM.yyyy' )  || korr )
.head 7 -  !
.head 7 -  Set sSql = 
"select - sum(" ||FOST || "(d.acck, :FDAT))/100, 
        - sum(" || FOST || "(d.accs, :FDAT)) /100,
        - sum(k.ostb)/100, 
        - sum(s.ostb) /100,  d.kod, FU_IMG.nm, fu_img.dat_c 
 into  :KOL, :OST , :KOLB, :OSTB, :KOD, :NAME, :DAT_C 
 from fu_deal d, accounts k, accounts s, FU_IMG 
 where d.poz = :nPoz and d.acck=k.acc and d.accs=s.acc 
   and d.kod = FU_IMG.kod " || IifS( sFilter = "", "", " and " || sFilter ) || " 
 group by d.kod , FU_IMG.nm, fu_img.dat_c 
 having ( sum(" || FOST || "(d.acck, :FDAT)) <>0  OR sum(k.ostb)<>0 )
 order by d.kod desc"
.head 7 -  !
.head 7 -  Set nPoz = 1
.head 7 -  ! Обнуление
.head 7 -  Set nK  = 0
.head 7 -  Set nKF = 0
.head 7 -  Set nKB = 0
.head 7 -  Set nSF = 0
.head 7 -  Set nSB = 0
.head 7 -  !
.head 7 -  Call SalTblPopulate( tbl, hSql(), sSql, TBL_FillAll )
.head 7 -  ! Выложить итог
.head 7 -  Call SalTblDefineSplitWindow( tbl, 1, TBL_Split_Adjustable)
.head 7 -  Call SalTblFetchRow( tbl, SalTblInsertRow( tbl, TBL_MinSplitRow ))
.head 7 -  Call SalTblSetFlagsAnyRows( tbl, ROW_New, FALSE, 0, 0)
.head 7 -  Set KOD  = Str(nK) || ' LONG-поз.'
.head 7 -  Set KOL  = nKF
.head 7 -  Set KOLB = nKB
.head 7 -  Set OST  = nSF
.head 7 -  Set OSTB = nSB
.head 7 -  Call XSalTblSetCellBackColor( OSTB, COLOR_Sky )
.head 7 -  Call XSalTblSetCellBackColor( OST, COLOR_Sky )
.head 7 -  Call XSalTblSetCellBackColor( KOLB, COLOR_Sky )
.head 7 -  Call XSalTblSetCellBackColor( KOL, COLOR_Sky )
.head 7 -  Call XSalTblSetCellBackColor( KOD, COLOR_Sky )
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam,SalColorFromRGB( 220,255,255 )   )
.head 6 -  ! Накопление итогов
.head 6 -  Set nK  = nK + 1
.head 6 -  Set nKF = nKF + KOL
.head 6 -  Set nKB = nKB + KOLB
.head 6 -  Set nSF = nSF + OST
.head 6 -  Set nSB = nSB + OSTB
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.071"
.head 6 -  Width:  10.883"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.214"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: KOD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код ФК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
на дату
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OST
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условная стоимость SHORT
на дату
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOLB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
текущее
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OSTB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условная стоимость SHORT
текущая
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование ФК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT_C
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
завершения 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: NAS
.head 6 -  Description: short
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  !
.head 7 -  Set nPoz = 2
.head 7 -  ! Обнуление
.head 7 -  Set nK  = 0
.head 7 -  Set nKF = 0
.head 7 -  Set nKB = 0
.head 7 -  Set nSF = 0
.head 7 -  Set nSB = 0
.head 7 -  !
.head 7 -  Call SalTblPopulate( tbl2, hSql(), sSql, TBL_FillAll )
.head 7 -  !
.head 7 -  ! Выложить итог
.head 7 -  Call SalTblDefineSplitWindow( tbl2, 1, TBL_Split_Adjustable)
.head 7 -  Call SalTblFetchRow( tbl2, SalTblInsertRow( tbl2, TBL_MinSplitRow ))
.head 7 -  Call SalTblSetFlagsAnyRows( tbl, ROW_New, FALSE, 0, 0)
.head 7 -  Set KOD  = Str(nK) || ' SHORT-поз.'
.head 7 -  Set KOL  = nKF
.head 7 -  Set KOLB = nKB
.head 7 -  Set OST  = nSF
.head 7 -  Set OSTB = nSB
.head 7 -  Call XSalTblSetCellBackColor( OSTB, COLOR_Orchid )
.head 7 -  Call XSalTblSetCellBackColor( OST, COLOR_Orchid )
.head 7 -  Call XSalTblSetCellBackColor( KOLB, COLOR_Orchid )
.head 7 -  Call XSalTblSetCellBackColor( KOL, COLOR_Orchid )
.head 7 -  Call XSalTblSetCellBackColor( KOD, COLOR_Orchid )
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 )   )
.head 6 -  ! Накопление итогов
.head 6 -  Set nK  = nK + 1
.head 6 -  Set nKF = nKF + KOL
.head 6 -  Set nKB = nKB + KOLB
.head 6 -  Set nSF = nSF + OST
.head 6 -  Set nSB = nSB + OSTB
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode 
.head 3 -  Number: nPar  
.head 3 -  String: strPar01 ! = strTip=название окна
.head 3 -  String: strPar02 
.head 2 +  Window Variables
.head 3 -  String: sSql
.head 3 -  Number: nPoz
.head 3 -  !
.head 3 -  Number: nK
.head 3 -  Number: nKF
.head 3 -  Number: nSF
.head 3 -  Number: nKB
.head 3 -  Number: nSB
.head 3 -  String: sVnim
.head 3 -  String: sAnyRows
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, strPar01 )
.head 4 -  Set FN.strFilterTblName = 'FU_IMG'
.head 4 -  ! Set FN.strPrintFileName = 'LONG'
.head 4 -  Set sVnim = 'Внимание, ошибка !'
.head 4 -  Set sAnyRows = 
'Не выбрана строка ФК для 
'
.head 4 -  !
.head 4 -  Call SalColorSet( pbPrint, COLOR_IndexWindow, SalColorFromRGB( 220,255,255 ) )
.head 4 -  Call SalColorSet( pbRepoL, COLOR_IndexWindow, SalColorFromRGB( 220,255,255 ) )
.head 4 -  !
.head 4 -  Call SalColorSet( pbUpdate, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
.head 4 -  Call SalColorSet( pbRepoS, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
.head 4 -  !
.head 4 -  Set FDAT = GetBankDate()
.head 4 -  Set cb_Korr = 0
.head 4 -  Call tbl.NAS()
.head 4 -  Call tbl2.NAS()
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Table Window: FP
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Реестр про
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.344"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 703
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 704
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 705
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
проводки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
проводки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: STMT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
проводки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
оп.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
номинал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
экв
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Детали пров.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Общее назначение платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SOS
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nRef1
.head 3 -  String: strTitle
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: sSql_D
.head 3 -  String: sSql_P 
.head 3 -  String: sFilter
.head 3 -  Date/Time: FDAT0
.head 3 -  Number: i
.head 3 -  Number: nStart
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, strTitle ||Str(nRef1)  )
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 5 )
.head 4 -  Set FP.strPrintFileName = Str(nRef1)
.head 4 -  Set FP.strFilterTblName = 'FK_PROV'
.head 4 -  Set FP.fFilterAtStart = TRUE
.head 4 -  !
.head 4 -  Set sSql_D = 
"select o.ref,o.stmt,o.fdat,o.tt,o.txt,o.s,o.sq, 
        sum(decode(o.dk,0,o.acc,0)) ACCD, sum(decode(o.dk,1,o.acc,0)) ACCk 
 from opldok o, fu_ref r 
 where r.ref1=" ||Str(nRef1) || " and o.ref=r.ref 
 group by o.ref,o.stmt,o.fdat,o.tt,o.s,o.sq, o.txt "
.head 4 -  !
.head 4 -  Set sSql_P = 
"select d.fdat, d.ref, d.stmt, d.tt, ad.kv, ad.nls NLSD, ak.nls NLSK, d.s, d.sq, d.txt, 
        p.nazn, p.sos, p.vob 
 from accounts ak,  accounts ad, oper p, (" || sSql_D || ") d 
 where d.accd = ad.acc  and d.acck = ak.acc  and d.ref = p.ref " 
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  ! ! спросить фильтр
.head 4 -  Set FDAT0 = GetBankDate()-50000
.head 4 -  Set i = 1
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set sFilter = ''
.head 4 -  Set sFilter = cF.GetFilterWhereClause(FALSE)
.head 4 -  Set FP.strSqlPopulate = 
"select FDAT,REF,STMT,TT,KV,NLSD,NLSK,S/100,SQ/100,TXT,NAZN,SOS,VOB      
 into :FP.FDAT,:FP.REF,:FP.STMT,:FP.TT,:FP.KV,:FP.NLSD,:FP.NLSK,
      :FP.S,:FP.SQ,:FP.TXT,:FP.NAZN,:FP.SOS,:FP.VOB  
 from (" || sSql_P || ") FU_PROV " ||  IifS( sFilter = "", "", " where " || sFilter ) || " 
 order by 1,2,3 "
.head 4 -  ! Call Debug (FP.strSqlPopulate)
.head 4 -  Call SalTblPopulate( hWndForm, hSql(), FP.strSqlPopulate, TBL_FillAll )
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "select to_number(val) into :nStart from fu_Param  where Par = 'START'  " ) 
and SqlFetchNext( hSql(), nFetchRes)
.head 4 +  If nStart = 0
.head 5 -  Call SalHideWindow( dSTART )
.head 4 +  Else If nStart = 1
.head 5 -  Set dSTART = "СТАРТОВОЕ ФОРМИРОВАНИЕ ПОРТФЕЛЯ СДЕЛОК ! "
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SOS =1 
.head 5 -  ! Call XSalTblSetRowBackColor( hWndForm, lParam,SalColorFromRGB( 230,255,230 )   )
.head 5 -  Call SetTblRowColor ( FP, COLOR_DarkGreen )
.head 4 +  Else If SOS =3
.head 5 -  ! Call XSalTblSetRowBackColor( hWndForm, lParam,SalColorFromRGB( 220,255,255 )   )
.head 5 -  Call SetTblRowColor ( FP, COLOR_Sky )
.head 4 +  If VOB = 96 or VOB = 99
.head 5 -  ! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow  )
.head 5 -  Call XSalTblSetCellBackColor( VOB, COLOR_Yellow )
.head 4 +  If FDAT0 != FDAT
.head 5 -  Set i = 1-i
.head 5 -  Set FDAT0 = FDAT
.head 4 +  If i =1 
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
.head 3 +  ! On SAM_ColumnSelectClick
.head 4 -  ! Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 4 -  ! Set bSortOrd = not bSortOrd
.head 4 -  ! Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
