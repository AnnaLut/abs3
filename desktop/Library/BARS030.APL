Application Description: Для аналитических функций
		16-05-2008 
		Сухова Т.А.
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000CE0000 002C000000020000 0003000000000000 0002020000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 33302E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: vttblwin.apl
		File Include: Vtarray.apl
		File Include: Genemnu.apl
		File Include: Genlist.apl
		File Include: Winbars2.apl
		File Include: Xsalcpt.apl
		File Include: XSALIMG.APL
		File Include: VT.APL
		File Include: GENTBLS.APL
		Dynalib: CustAcnt.apd
		Dynalib: Nsiapi.apd
		Dynalib: Otcn.apd
		Dynalib: V_BALANS.apd
		Dynalib: Global.apd
		Dynalib: Absapi.apd
		File Include: Vtcomm.apl
		File Include: Constant.apl
		File Include: Genbutn.apl
		File Include: qckdvc.apl
		File Include: Vtfile.apl
		File Include: Vtdos.apl
		File Include: GENTBLF.APL
		Dynalib: Message.apd
		Dynalib: Dfltrapi.apd
		Dynalib: Docview.apd
		File Include: XSALSPL.APL
		File Include: VTTBLWIN.APL
		!
		!
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: ###0
			Number: #00000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '30'
				String: ApdVer   =  '00'
				! ! << Версія бібліотеки >>
				String: sLibraryVersion =  '2.01 від 17.02.2016'
				! История изменений: -----------------------------------------------------|
		Resources
		Variables
.data RESOURCE 0 0 1 755936895
0000: 1E00000011000000 0000000000000000 0200000100000087 000000E0010D0000
0020: 00FF3F
.enddata
			Window Handle: hWin0 
			Window Handle: h_GAK
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hTRC1
			Window Handle: hFR
			Window Handle: hAR
			Number: nFetchRes
			Number: nHaveTOBO
			Number: nOB22
			String: RNBU_TRACEX
			!
			Window Handle: hWin_RES1
		Internal Functions
			Function: Sel030	! __exported
				Description: Bars030_Selector
				Returns
					Boolean:
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					Number: nTmp
				Actions
					! надо вставить инициализацию apd
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					Set nOB22 = GetGlobalOptionEx('OB22')
					Set RNBU_TRACEX = 'RNBU_TRACE1'
					Select Case nMode
						! nMode = 1 Разрывы: RNBU_TRACE_1
								 ANI-1. Анализ вiдповiдностi АКТ-ПАС +   ANI-10. Анализ вiдповiдностi Проц.АКТ-ПАС 
						Case 0 ! Консолидированные и средние Разрывы
							If IsWindow( h_GAK )
								Call SalDestroyWindow( h_GAK )
							Set h_GAK = SalCreateWindow( GAK, hWndParent, nMode, nPar, strPar01, strPar02 )
							Break
						Case 1 
							If SalStrTrimX( strPar01 ) = ''
								Set RNBU_TRACEX = 'RNBU_TRACE1'
							Else
								Set RNBU_TRACEX = SalStrTrimX( strPar01 )
							Call SalCreateWindow( GAP, hWndMDI, nPar,NUMBER_Null, "",0,"",
									FALSE,TRUE,FALSE,FALSE,FALSE,0,"",1,"", DATETIME_Null)
							Break
						! nMode = -1 Разрывы: RNBU_TRACE_2
								 ANI-1. Анализ вiдповiдностi АКТ-ПАС +   ANI-10. Анализ вiдповiдностi Проц.АКТ-ПАС 
						! Case 99 
							                                                                          If SalStrTrimX( strPar01 ) = ''
								                                                                          Set RNBU_TRACEX = 'RNBU_TRACE1'
							                                                                          Else 
								                                                                          Set RNBU_TRACEX = SalStrTrimX( strPar01 )
							                                                                          Call SalCreateWindow( GAP, hWndMDI, nPar,NUMBER_Null, "",0,"",
									FALSE,TRUE,FALSE,FALSE,FALSE,0,"",1,"", DATETIME_Null)
							                                                                          Break 
						! !!!!!!!!!!!!!!!
						Case 2 ! ANI-2.Платежный календарь по КС
							Call Sel00V(hWndMDI,4,0,"","")
							Break
						! Case 3 ! Трансф.цены Устарелая версия
								         ANI-3. Реальнi та трансфернi цiни АКТ-ПАС
							                                                                                     Call SalCreateWindow( TRA, hWndMDI, nPar,NUMBER_Null, "",0,"",TRUE,FALSE,FALSE,FALSE,FALSE,"",1,"")
							                                                                                     Break 
						Case 31 ! ANI-31. Установка трансферних цiн на проц.АКТ-ПАС
							Call SalCreateWindow( TRC, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 32 ! ANI-32. Ефективнiсть проц.АКТ-ПАС по ном. та трансф. цiнi
							Call SalCreateWindow( TRU, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 4 ! ANI-4. Рентабельность ТОБО по аналитите 6-7 кл
							If nHaveTOBO = 2
								Call SalCreateWindow( RTA, hWndParent, nPar,NUMBER_Null, "",0,"",TRUE,FALSE,FALSE,FALSE,FALSE,"",1,"")
							Else
								Call SalCreateWindow( RTB, hWndMDI, nPar,NUMBER_Null, "",0,"",TRUE,FALSE,FALSE,FALSE,FALSE,"",1,"")
							Break
						Case 14 ! Бюджет. План
							Call SalCreateWindow( RT0, hWndMDI, nMode, nPar, strPar01, strPar02)
							Break
						!
						Case 11 ! Баланс в структурі показників ОБ
							If nHaveTOBO = 2
								Call SalCreateWindow( BAL, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						! Case 12 ! Архив-Баланс в структурі показників ОБ
							                                                                                         If nHaveTOBO = 2
								                                                                                         If IsWindow( hAR )
									                                                                                         Call SalDestroyWindow( hAR )
								                                                                                         Set hAR = SalCreateWindow( BAX, hWndParent, nMode, nPar, strPar01, strPar02)
							                                                                                         Break 
						! Case 13 ! TECT Sql - формул
							! If nHaveTOBO = 2
							                                                                                                     Call SalCreateWindow( FRM, hWndParent, nMode, nPar, strPar01, strPar02)
							                                                                                                     Break 
						Case 22 ! для ОБ + Гляд "на дату"  в анал.форме "Аналiз балансу за перiод" (SNP)
							If nHaveTOBO = 2
								Call SalCreateWindow( OB2, hWndMDI, nMode, nPar, strPar01, strPar02)
							Break
						!
						Case 5 ! ANI-5.Концентрацiя ресурсiв
							! nPar = 7 - на снапах, иначе - на saldoa
							Call SalCreateWindow
									(RES, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 6 ! ANI-6.Var-аналіз
							Call SalCreateWindow
									(VAR, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 7 ! ANI-7.Фондирование Акт-Пас по БАЛ.сч
							Call SalCreateWindow
									(FD, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 8 ! ANI-7.Связь упр.учета и фин.учета для ФОНДИРОВАНИЯ
							Call SalCreateWindow
									(BR0, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						! FSC >100
						Case 77  ! Выполнение кат.запроса по его уникальному симв.ключу (PKEY)
							Call Debug(strPar01)
							If SqlPrepareAndExecute(hSql(), "select kodz into :nTmp from zapros where pkey=:strPar01 ")
									and  SqlFetchNext( hSql(), nFetchRes )
								Call DebugN(nTmp)
								Call ZAPROS1 ( hWndMDI , nTmp )
								Call Debug('/nTmp')
							Break
						Case 101 ! FSC-1 КП ФО у розрізі продуктів  
							Call SalCreateWindow
									(F1, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 102 ! FSC-2 КП ФО у розрізі точок продажу (або регіонів)
							Call SalCreateWindow
									(F2, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 104 ! FSC-4 КП ФО Vintage
							Call SalCreateWindow
									(F4, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 105 ! FSC-5 Матриця переходів
							Call SalCreateWindow
									(F5, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
						Case 201 ! FSC: 1C Реєстр проводок DOS-кодировка
							Call SalCreateWindow
									(FS, hWndParent, 1, nPar, strPar01, strPar02)
							Break
						Case 202 ! FSC: 1C Реєстр проводок WIN-кодировка
							Call SalCreateWindow
									(FS, hWndParent, 2, nPar, strPar01, strPar02)
							Break
						Case 300 ! FSC: Квитовка с IBOX или подобным партнером 
							Call SalCreateWindow
									(KWT, hWndParent, nMode, nPar, strPar01, strPar02)
							Break
					Return TRUE
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 3404341369
0000: D9060000F0020000 0000000000000000 0200000A00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F01808F000000 00050000000F6300
01A0: 4465736B746F704C 00697374426F7822 01C2000B000000B3 010D00FFFFE60D00
01C0: 01FE00FF9B1A0001 FB00FF6F2700EE01 00FFBF34B9000100 FFFFE04100000001
01E0: FE00FF834E000000 01FB00FF0F5B0000 00EE0100FF3F6800 B800000100FFFFE0
0200: 7500000001FE00FF 838200000001FB00 FF0F018034000100 060000000B63E044
0220: 69724C69836C0000 00043D00010DFB00 FF6F0D00EE0100FF BF1AB9000100FFFF
0240: E6270001FE00FF43 0180270000E00700 00000F8154726565 4C690F52000000F6
0260: 0300EC010D00FFBF 0DB9000100FFFFE6 1A0001FE00FF4301 805B000000080000
0280: 000C634669F9654C C1BA000000079E00 010DFD00FF370D00 01F700FFDF1ADC00
02A0: 0100FF7F27730001 00FFFFCD340001FD 00FF37410001F700 FFDF4EDC000100FF
02C0: 7F01088041000009 000000000D635261 64696F7C4C6986B0 000000050067010D
02E0: 00FFFFC90D000001 FD00FF371A0001F7 00FFDF27DC000100 FF7F3473000100FF
0300: FF01
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbExecute
			Radio Button:
			Option Button:
			Check Box: cCheckBoxLabeled
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	! cGenericTableSpl: TRC2 !!  ANI-31. Установка трансферних цiн на проц.АКТ-ПАС
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.winattr class Form Window:
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name: vti11.dll;0;3145728;;;
		Title: Номенклатура та значення  трансферних цін на проц.АКТ та ПАС
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  14.167"
				Width Editable? Yes
				Height: 5.583"
				Height Editable? Yes
			Form Size
				Width:  -1.0"
				Height: -1.0"
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                Description: 
		                                                                                Named Menus 
		                                                                                Menu 
		                                                                                Tool Bar 
			                                                                                Contents 
				                                                                                Pushbutton: pbIns
					                                                                                Message Actions 
						                                                                                On SAM_Create
							                                                                                Set strTip = 'Добавить новую запись'
						                                                                                On SAM_Click
							                                                                                Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				                                                                                Pushbutton: pbDel
					                                                                                Message Actions 
						                                                                                On SAM_Create
							                                                                                Set strTip = 'Пометить/Снять пометку на удаление'
						                                                                                On SAM_Click
							                                                                                Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				                                                                                Pushbutton: pbRefresh
					                                                                                Message Actions 
				                                                                                Pushbutton: pbUpdate
					                                                                                Message Actions 
						                                                                                On SAM_Create
							                                                                                Set strTip = 'Внести изменения в Базу Данных'
						                                                                                On SAM_Click
							! Call SalSendMsg(hWndForm, UM_Update, 0, 0)
							                                                                                Call SalSendMsg( hWndLost, UM_Update, 0, 0 )
				                                                                                Line 
				                                                                                Pushbutton: pbSearch
					                                                                                Message Actions 
				                                                                                Pushbutton: pbFilter
					                                                                                Message Actions 
						                                                                                On SAM_Create
							                                                                                Set strTip = 'Перечитать записи в таблице (с фильтром)'
							                                                                                Call SalEnableWindow(hWndItem)
						                                                                                On SAM_Click
							                                                                                Call SalTblDefineSplitWindow(tbl, 0, FALSE)
							                                                                                If SetQueryFilter( cF )
								                                                                                Set sf = cF.GetFilterWhereClause( FALSE )
								                                                                                Set sfrom = cF.GetFilterFromClause( FALSE )
							                                                                                Call SalSendMsg(tbl, UM_Populate, 0, 0)
				                                                                                Pushbutton: pbDetails
					                                                                                Message Actions 
						! On SAM_Create
							                                                                                                                                                                                                                    Set strTip = 'Поповнити можливими значеннями'
						! On SAM_Click
				                                                                                Pushbutton: pbPrint
					                                                                                Message Actions 
				                                                                                Line 
				                                                                                Pushbutton: pbExit
					                                                                                Message Actions 
				                                                                                Line 
				! cGenComboBox_NumId: cmbGroups
					                                                                                                                                                                                                                    List Initialization 
					                                                                                                                                                                                                                    Message Actions 
						                                                                                                                                                                                                                    On SAM_Create
							                                                                                                                                                                                                                    If cmbGroups.Init( hWndItem )
								                                                                                                                                                                                                                    If pGRP = NUMBER_Null or pGRP=0
									                                                                                                                                                                                                                    Call cmbGroups.Populate( hSql(),
											"idg", "idg||'.'||name", "sto_grp", "order by name" )
								                                                                                                                                                                                                                    Else 
									                                                                                                                                                                                                                    Call cmbGroups.Populate( hSql(),
											"idg", "idg||'.'||name", "sto_grp", "where IDG="||Str(pGRP) )
									                                                                                                                                                                                                                    Set nGrp=pGRP
									                                                                                                                                                                                                                    Call SalDisableWindow( cmbGroups )
									                                                                                                                                                                                                                    Call SalSendMsg( tbl, UM_Populate, 0, 0 )
								                                                                                                                                                                                                                    Call cmbGroups.SetSelectById( nGrp )
						                                                                                                                                                                                                                    On SAM_Click
							                                                                                                                                                                                                                    Call SalSendClassMessage( SAM_Click, 0, 0 )
							                                                                                                                                                                                                                    Set nGrp=cmbGroups.nCurrentId
							                                                                                                                                                                                                                    Call SalSendMsg( tbl, UM_Populate, 0, 0 )
				                                                                                Data Field: BR_NAME
					                                                                                Message Actions 
		                                                                                Contents 
			                                                                                Custom Control: ccSplitter
				                                                                                Message Actions 
			                                                                                Child Table: tbl
				                                                                                Contents 
					!
					                                                                                Column: cBR_NAME
						                                                                                List Values 
						                                                                                Message Actions 
				                                                                                Functions 
				                                                                                Window Variables 
				                                                                                Message Actions 
					!
			                                                                                Child Table: tbl2
				                                                                                Contents 
					                                                                                Column: KV
						                                                                                List Values 
						                                                                                Message Actions 
							! On SAM_SetFocus
								                                                                                                                                                                                                                    If colKvA = NUMBER_Null
									                                                                                                                                                                                                                    Set colKvA = GetBaseVal()
							                                                                                On SAM_Validate
								                                                                                If SqlPrepareAndExecute( hSql(), 
										"select lcv, name into :tbl2.LCV, :tbl2.KV_NAME 
										from tabval where kv=:tbl2.KV and d_close is null" )
										and NOT SqlFetchNext( hSql(), nFetchRes )
									                                                                                Call SalMessageBox('Недопустиме значення коду валюти',
											'Помилка ! ', MB_IconStop)
									                                                                                Set KV = NUMBER_Null
									                                                                                Set KV_NAME = STRING_Null
					                                                                                Column: LCV
						                                                                                List Values 
						                                                                                Message Actions 
					                                                                                Column: KV_NAME
						                                                                                List Values 
						                                                                                Message Actions 
					                                                                                Column: BDATE
						                                                                                List Values 
						                                                                                Message Actions 
							                                                                                On SAM_SetFocus
								                                                                                If BDATE = DATETIME_Null
									                                                                                Set BDATE = GetBankDate()
					                                                                                Column: RATE
						                                                                                List Values 
						                                                                                Message Actions 
				                                                                                Functions 
					                                                                                Function: GetFirstEditableColumn
						                                                                                Description: Получить первую редактируюмую колонку
						                                                                                Returns 
							                                                                                Window Handle: 
						                                                                                Parameters 
							                                                                                Window Handle: hWndTbl
						                                                                                Static Variables 
						                                                                                Local variables 
							                                                                                Number: nCol
							                                                                                Window Handle: hWndCol
						                                                                                Actions 
							                                                                                Set nCol=1
							                                                                                Loop 
								                                                                                Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol,
										    COL_GetPos)
								                                                                                If hWndCol = hWndNULL
									                                                                                Break 
								                                                                                If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
										   SalIsWindowVisible(hWndCol)
									                                                                                Break 
								                                                                                Set nCol = nCol + 1
							                                                                                Return hWndCol
					! Function: F_NLS
						                                                                                                                                                                                                                    Description: 
						                                                                                                                                                                                                                    Returns 
						                                                                                                                                                                                                                    Parameters 
							                                                                                                                                                                                                                    Number: nKv
							                                                                                                                                                                                                                    String: sMfo
							                                                                                                                                                                                                                    String: sNls
						                                                                                                                                                                                                                    Static Variables 
						                                                                                                                                                                                                                    Local variables 
							                                                                                                                                                                                                                    String: sTmp
						                                                                                                                                                                                                                    Actions 
							                                                                                                                                                                                                                    If nKv != GetBaseVal() and
									SqlPrepareAndExecute( hSql(),"SELECT name into :sTmp from tabval where kv=:nKv " )
									and NOT SqlFetchNext(  hSql(), nFetchRes )
								                                                                                                                                                                                                                    Call SalMessageBox("Код вал","Ошибка ! ", MB_IconStop)
								                                                                                                                                                                                                                    Return FALSE
							!
							                                                                                                                                                                                                                    If sMfo != STRING_Null and sMfo != GetBankMfo() and
									SqlPrepareAndExecute( hSql(),"SELECT nb into :sTmp from banks where mfo=:sMfo " )
									and NOT SqlFetchNext(  hSql(), nFetchRes )
								                                                                                                                                                                                                                    Call SalMessageBox("Код Банка","Ошибка ! ", MB_IconStop)
								                                                                                                                                                                                                                    Return FALSE
							!
							                                                                                                                                                                                                                    If sNls != STRING_Null and  nKv != NUMBER_Null and sMfo !=STRING_Null
								                                                                                                                                                                                                                    If sMfo = GetBankMfo() and
										SqlPrepareAndExecute( hSql(),"SELECT nms into :sTmp from accounts where kv=:nKv and nls=:sNls " )
										and NOT SqlFetchNext(  hSql(), nFetchRes )
									                                                                                                                                                                                                                    Call SalMessageBox("Отсутствует счет в нашем банке","Ошибка ! ", MB_IconStop)
									                                                                                                                                                                                                                    Return FALSE
								                                                                                                                                                                                                                    Else If sNls != KeyAccount(sMfo, sNls)
									                                                                                                                                                                                                                    Call SalMessageBox("Контрольный разряд счета","Ошибка ! ", MB_IconStop)
									                                                                                                                                                                                                                    Return FALSE
							!
							                                                                                                                                                                                                                    Return TRUE
				                                                                                Window Variables 
					                                                                                String: strSqlPopulate	! Строка SQL SELECT
					                                                                                String: strSqlInsert	! Строка SQL INSERT
					                                                                                String: strSqlDelete	! Строка SQL DELETE
					                                                                                String: strSqlUpdate	! Строка SQL UPDATE
					                                                                                String: strTitleAux
					                                                                                String: sTmp
				                                                                                Message Actions 
					                                                                                On UM_Delete
						                                                                                Set nRow = TBL_MinRow
						                                                                                While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							                                                                                If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								                                                                                Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							                                                                                Else 
								                                                                                Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
		                                                                                Functions 
		                                                                                Window Parameters 
		                                                                                Window Variables 
			!
			                                                                                Number: nId
			                                                                                String: sf
			                                                                                String: sfrom
			                                                                                : cF
			                                                                                Number: nRow
			                                                                                Number: BR_ID
			                                                                                String: sBR_ID
			                                                                                Window Handle: hWndLost
			!
		                                                                                Message Actions 
	!
	Table Window: TRC
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Номенклатура та значення  трансферних цін на проц.АКТ та ПАС
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.138"
				Top:    0.021"
				Width:  16.45"
				Width Editable? Class Default
				Height: 7.155"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19222
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Значення трансферних ставок'
						On SAM_Click
							If IsWindow( hTRC1 )
								Call SalDestroyWindow(hTRC1 )
							Set hTRC1 = SalCreateWindow(TRC1, hWndMDI, ID, nPar,strTip,strPar02 )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19223
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19224
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! Data Field: BR_NAME
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 35
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.95"
							Top:    0.095"
							Width:  4.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                 Message Actions 
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						баз.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: Number
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If ID <= nPlus
							Call SalMessageBox('Код баз.<= '||Str(nPlus),
									'Помилка ! ', MB_IconStop)
							Set ID = NUMBER_Null
			!
			Column: PAP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1=АКТ
						2=ПАС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: Number
				Justify: Left
				Width:  0.629"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call K_PAP()
					On SAM_KillFocus
						Call K_PAP()
			Column: PAP_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бал
						рах
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.671"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_NBS()
					On SAM_Validate
						Call K_NBS()
					On SAM_KillFocus
						Call K_NBS()
			Column: NBS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						Бал.рах
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  3.543"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_NBS()
			!
			Column: S180
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						терм.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  0.757"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_S180()
					On SAM_Validate
						Call K_S180 ()
					On SAM_KillFocus
						Call K_S180()
			Column: S180_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва початкового
						терміну Розм/Залуч
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  2.171"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_S180()
			!
			Column: PRT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1=ставка
						2=маржа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: Number
				Justify: Left
				Width:  0.957"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call K_PRT()
					On SAM_KillFocus
						Call K_PRT()
			Column: PRT_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.871"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: cBR_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						базової ставки
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.871"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл.
						ставок
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: Number
				Justify: Left
				Width:  0.629"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If PAP =1
							Set PAP_NAME = sAkt
						Else If PAP =2
							Set PAP_NAME = sPas 
						Else
							Call SalMessageBox('Недопустиме значення АКТ-ПАС',
									'Помилка ! ', MB_IconStop)
							Set PAP = NUMBER_Null
							Set PAP_NAME = STRING_Null
		Functions
			Function: F_NBS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("PS","NAME", 
							" D_CLOSE is null 
							 and nbs in (select nbs  from ANB1_PS 
							             where substr(id,1,1) in ('1','2') 
							               and pap = " || Str(PAP) || " ) ",
							sTmp,sTmp1 )
					If sTmp != STRING_Null
						Set NBS = sTmp
						Set NBS_NAME = sTmp1
			Function: F_S180
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("V_KL_S180","TXT", " DATA_C is null",
							sTmp,sTmp1 )
					If sTmp != STRING_Null
						Set S180 = sTmp
						Set S180_NAME = sTmp1
			Function: K_S180
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If S180 = '*' 
							OR SqlPrepareAndExecute( hSql(), 
							"select txt into :S180_NAME from v_KL_S180 where DATA_C is null" )
							and SqlFetchNext( hSql(), nFetchRes )
					Else
						Call SalMessageBox('Недопустиме значення S180',
								'Помилка ! ', MB_IconStop)
						Set S180 = STRING_Null
						Set S180_NAME = STRING_Null
					Return TRUE
			Function: K_NBS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(), 
							"select name into  :NBS_NAME 
							from ps where d_close is null and nbs=:NBS" )
							and SqlFetchNext( hSql(), nFetchRes )
					Else
						Call SalMessageBox('Недопустиме значення БР',
								'Помилка ! ', MB_IconStop)
						Set NBS = STRING_Null
						Set NBS_NAME = STRING_Null
					Return TRUE
			Function: K_PAP
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If PAP =1
						Set PAP_NAME = sAkt
					Else If PAP =2
						Set PAP_NAME = sPas 
					Else
						Call SalMessageBox('Недопустиме значення АКТ-ПАС',
								'Помилка ! ', MB_IconStop)
						Set PAP = NUMBER_Null
						Set PAP_NAME = STRING_Null
					Return TRUE
			Function: K_PRT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If PRT =1
						Set PRT_NAME =  sSta 
					Else If PRT =2
						Set PRT_NAME = sMar 
					Else
						Call SalMessageBox('Недопустиме значення ПРИЗНАКУ',
								'Помилка ! ', MB_IconStop)
						Set PRT = NUMBER_Null
						Set PRT_NAME = STRING_Null
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sAkt
			String: sPas
			String: sSta
			String: sMar
			Number: nPlus
		Message Actions
			On SAM_Create
				Set TRC.strSqlDelete=
						'DELETE FROM ANI3 WHERE NBS=:TRC.NBS and PAP=:TRC.PAP and S180= :TRC.S180 '
				Set TRC.strSqlInsert=
						'INSERT INTO ANI3 (ID,NBS, PAP, S180, PRT )
						 VALUES ( :TRC.ID, :TRC.NBS,:TRC.PAP,:TRC.S180,:TRC.PRT )'
				!
				Set TRC.strSqlUpdate=
						'UPDATE ANI3 SET PRT=:TRC.PRT, NBS=:TRC.NBS, PAP=:TRC.PAP, S180=:TRC.S180 
						 WHERE ID= :TRC.ID '
				!
				Set nPlus = 1000000
				Set sAkt = 'Актив'
				Set sPas = 'Пасив'
				Set sSta = 'Тр.СТАВКА'
				Set sMar = 'Тр.МАРЖА'
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set TRC.strSqlPopulate =
						"SELECT a.ID, a.NBS, a.PAP, a.S180, a.PRT,  p.name, k.txt ,
						   substr(decode (a.PAP,1,:sAkt, 2, :sPas, ''),1,10), 
						   substr(decode (a.PRT,1,:sSta, 2, :sMar, ''),1,15),
						   b.name, g.KOL 
						 INTO :TRC.ID, :TRC.NBS, :TRC.PAP, :TRC.S180, :TRC.PRT, 
						      :TRC.NBS_NAME, :TRC.S180_NAME, :TRC.PAP_NAME,:TRC.PRT_NAME,
						      :TRC.cBR_NAME, :TRC.KOL 
						 from ani3 a, ps p, v_kl_s180 k, brates b,
						  (select br_id, count(*) KOL from BR_NORMAL group by br_id ) g 
						 where a.nbs  = p.nbs 
						   and a.s180 = k.s180 (+) 
						   and a.id   = b.br_id (+) 
						   and a.id   = g.br_id (+) 
						 order by a.PAP, a.NBS, a.S180 "
				Call SalTblPopulate(hWndForm, hSql(), TRC.strSqlPopulate, TBL_FillAll  )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If KOL > 0
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen)
	Table Window: TRC1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.155"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19228
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19229
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19230
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: NBS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.071"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: NBS_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.071"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: PAP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.321"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: PAP_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.321"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: S180
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.571"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: S180_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.571"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: PRT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.821"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: PRT_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.821"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Data Field: BR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.571"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: BR_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.821"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВАЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.571"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call K_KV()
					On SAM_KillFocus
						Call K_KV()
			Column: LCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ISO
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.914"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						установки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If BDATE = DATETIME_Null
							Set BDATE = GetBankDate()
			Column: RATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Значення
						ставки або маржі
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: Number
				Justify: Right
				Width:  2.529"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: K_KV
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If KV != NUMBER_Null
						If SqlPrepareAndExecute( hSql(), 
								"select lcv, name into :LCV, :KV_NAME 
								from tabval where kv=:KV and d_close is null" )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							Call SalMessageBox('Недопустиме значення коду валюти',
									'Помилка ! ', MB_IconStop)
							Set KV = NUMBER_Null
							Set KV_NAME = STRING_Null
					Return TRUE
			Function: F_KV
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("TABVAL","NAME", " D_CLOSE is null " , sTmp,sTmp1 )
					If sTmp = STRING_Null
						Set KV = NUMBER_Null
						Set KV_NAME = STRING_Null
						Set LCV = STRING_Null
					Else
						Set KV = Val(sTmp)
						Call K_KV ()
		Window Parameters
			Number: nId
			Number: nPar
			String: sTitl
			String: strPar02
		Window Variables
			String: sId
			String: BR_NORMAL
			Number: nKv
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, sTitl )
				Set sId = Str(TRC1.nId)
				If nHaveTOBO = 2
					Set BR_NORMAL = 'BR_NORMAL_edit'
					Set TRC1.strSqlInsert=
							"INSERT INTO " || BR_NORMAL || " (br_id, kv, BDATE, RATE, branch )
							  VALUES ("|| sId ||",:TRC1.KV,:TRC1.BDATE, :TRC1.RATE,SYS_CONTEXT ('bars_context', 'user_branch') )"
					Set TRC1.strSqlUpdate=
							"UPDATE " || BR_NORMAL || " SET RATE =:TRC1.RATE
							 WHERE br_id = "|| sId ||" and kv=:TRC1.KV and BDATE =:TRC1.BDATE 
							   and branch = SYS_CONTEXT ('bars_context', 'user_branch')"
					Set TRC1.strSqlDelete=
							"DELETE FROM " || BR_NORMAL || " WHERE br_id="|| sId ||" 
							   and kv=:TRC1.KV and BDATE =:TRC1.BDATE 
							   and branch = SYS_CONTEXT ('bars_context', 'user_branch')"
					Set TRC1.strSqlPopulate=
							"SELECT b.KV, b.BDATE, b.RATE, t.lcv, t.name
							 INTO :TRC1.KV, :TRC1.BDATE, :TRC1.RATE, :TRC1.LCV, :TRC1.KV_NAME
							 FROM " || BR_NORMAL || " b, tabval t
							 WHERE b.br_id="|| sId || " and t.kv=b.kv 
							   and b.branch = SYS_CONTEXT ('bars_context', 'user_branch')
							 order by b.KV, b.BDATE desc "
				Else
					Set BR_NORMAL = 'BR_NORMAL'
					Set TRC1.strSqlInsert=
							"INSERT INTO " || BR_NORMAL || " (br_id, kv, BDATE, RATE )
							  VALUES ("|| sId ||",:TRC1.KV,:TRC1.BDATE, :TRC1.RATE )"
					Set TRC1.strSqlUpdate=
							"UPDATE " || BR_NORMAL || " SET RATE =:TRC1.RATE
							 WHERE br_id = "|| sId ||" and kv=:TRC1.KV and BDATE =:TRC1.BDATE "
					Set TRC1.strSqlDelete=
							"DELETE FROM " || BR_NORMAL || " WHERE br_id="|| sId ||" and kv=:TRC1.KV and BDATE =:TRC1.BDATE "
					Set TRC1.strSqlPopulate=
							"SELECT b.KV, b.BDATE, b.RATE, t.lcv, t.name
							 INTO :TRC1.KV, :TRC1.BDATE, :TRC1.RATE, :TRC1.LCV, :TRC1.KV_NAME
							 FROM " || BR_NORMAL || " b, tabval t
							 WHERE  b.br_id="|| sId || " and t.kv=b.kv order by b.KV, b.BDATE desc "
				!
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			!
			On SAM_CreateComplete
				If SqlPrepareAndExecute( hSql(), 
						"SELECT  a.NBS, to_char(a.PAP), a.S180, a.PRT,  p.name, k.txt ,
						   substr(decode (a.PAP,1,'Актив', 2, 'Пасив', ''),1,10), 
						   substr(decode (a.PRT,1,'Ставка', 2, 'Маржа', ''),1,15), b.name, 
						   b.br_id
						 INTO :TRC1.NBS, :TRC1.PAP, :TRC1.S180, :TRC1.PRT, 
						      :TRC1.NBS_NAME, :TRC1.S180_NAME, 
						      :TRC1.PAP_NAME, :TRC1.PRT_NAME, :TRC1.BR_NAME, :TRC1.BR   
						 from ani3 a, ps p, v_kl_s180 k, brates b
						 where a.nbs=p.nbs and a.s180 = k.s180 (+) and a.id=b.br_id (+) 
						 and a.id="|| sId )
						and SqlFetchNext( hSql(), nFetchRes )
					If TRC1.BR = NUMBER_Null
						Set TRC1.BR_NAME = 
								TRC1.PRT_NAME ||' '|| TRC1.PAP_NAME ||' '|| TRC1.NBS || ' ' || TRC1.S180
						If SqlPrepareAndExecute( hSql(),
								"insert into brates (BR_ID, BR_TYPE, NAME) values 
								("|| Str(nId)||",1,:TRC1.BR_NAME) " )
				Call SalDisableWindow( pbDetails )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				Call F_KV()
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set nKv = 0
				Call SalTblPopulate(hWndForm, hSql(), TRC1.strSqlPopulate, TBL_FillAll  )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If nKv != KV
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen)
					Set nKv = KV
	Table Window: KWT ! Квитовіка с IBOX
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Квитовка с IBOX
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.433"
				Width Editable? Class Default
				Height: 7.44"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 100000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.405"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.071"
						Width:  0.5"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить и заквитовать по реестру'
							Call SalHideWindow( pb_Opl )
						On SAM_Click
							If F_Opl( )
								Call SqlCommitEx( hSql(),"IBOX_REF="||Str(IREF)||": Оплата з реестру")
							Else
								Call SqlRollback( hSql()) 
								If p_res_code != 0
									Call SalMessageBox("Код.ош="||Str(p_res_code) || "
											 "|| p_res_text ,
											"Внимание, ошибка ! ", MB_IconStop)
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Удалить выбранный платеж'
							Call SalHideWindow( pbDel )
						On SAM_Click
							If AREF >0 
								If SalMessageBox( strTip || ' Реф.АБС = ' || Str (AREF) || ' ? ', 
										'Подтвердите !', MB_IconQuestion | MB_YesNo) = IDYES
									Call F_Bek ( strTip, AREF, TYPI, IREF )
							Else
								Call SalMessageBox('НЕ выбран Реф.АБС для удаления',
										'ВНИМАНИЕ, ошибка !', MB_IconStop)
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.05"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.617"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.15"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.617"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 52183
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.15"
						Begin Y:  Class Default
						End X:  5.15"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 52184
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.683"
						Begin Y:  Class Default
						End X:  3.683"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 52185
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.8"
						Begin Y:  Class Default
						End X:  0.8"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: nKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.383"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Количество записей в выборке')
				Data Field: nSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.071"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Сумма платежей в выборке')
				!
				Radio Button: rbR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Красные 
					Window Location and Size
						Left:   9.783"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 
									'Плохо. 
									Есть в реесре, нет (несовп) в АБС')
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Зеленые
					Window Location and Size
						Left:   11.383"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam,
									 'НЕопределен.
									Ждем реестр')
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Серые
					Window Location and Size
						Left:   12.983"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam,
									 'Хорошо.
									Cквитовано')
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все
					Window Location and Size
						Left:   14.583"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam,
									 'Разные.
									Установите фильтр, м.б. много')
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: TYPI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Имя 
						Интерфейса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Результат
						квитовки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AREF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IKWT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак
						квитовки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IREF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						IBOX
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-время
						IBOX
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.883"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CCID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № КД
						IBOX
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма пл.
						IBOX
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OFIL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Операционная 
						дата реестра
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.35"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NFIL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Имя файла
						реестра
				Visible? Yes
				Editable? No
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DFIL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-время
						прийома реестра
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  2.167"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KFIL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол
						зап
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SFIL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						в реестре
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						квитовки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: p_ibox_type
					Number: p_ibox_ref
					Date/Time: p_ibox_date
					String: p_cc_id
					Number: p_sum
				Actions
					Set p_ibox_type = TYPI
					Set p_ibox_ref = IREF
					Set p_ibox_date= IDAT
					Set p_cc_id = CCID
					Set p_sum = ISUM
					! procedure ibox_pay(p_ibox_type in varchar2, -- Тип интерфейса
							                     p_ibox_ref  in number, -- Референс документа в IBox
							                     p_ibox_date in date, -- Дата/время операции в IBox
							                     p_cc_id     in varchar2, -- Номер договора
							                     p_sum       in number, -- Сумма операции
							                     p_res_code  out number, -- Код результата
							                     p_res_text  out varchar2 -- Текст результата
					If NOT SqlPLSQLCommand( hSql(), 
							"WCS_exchange.IBOX_PAY
							( p_ibox_type, 
							  p_ibox_ref, 
							  p_ibox_date, 
							  p_cc_id, 
							  p_sum, 
							  p_res_code, 
							  p_res_text
							 ) "  ) 
						Return FALSE
					If p_res_code != 0
						Return FALSE
					!
					Return TRUE
			Function: F_Bek
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
					Number: aRef 
					String: sTip
					Number: iRef 
				Static Variables
				Local variables
					Number: nErr
					String: sErr
					String: sTxt
				Actions
					! !!!
					! Добавить в форму "FSC: Квитовка с"Имя Интерфейса"" 
							функциональность (кнопку) "Удалить платеж". 
							Функция должна удалять выбранный платеж 
							(транзакционно чистить реестр платежей, 
							удалять основную проводку по погашению, 
							удалять дочерние проводки по разбору счета гашения) при выполнении следующих условий: 
							1) только для записей несквитованного дня; 
							2) только если платёж в ОДБ был удачно проведён 
							  (наличие референса в реестре платежей и в таблице oper.sos = 5);
							3) только если Банковский День платежа  ("Сегодня") Не закрыт
							4) только если по указанному SG  счёту клиента, за текущий БД  не было Ручных проводок (013)
							5) если на счете гашения есть текущий остаток равный сумме платежа;
							6) если на счете гашения текущий остаток равен 0 или меньше Суммы платежа, то нужно удалить все документы типа ASG по этому счёту за текущий (открытый) банковский день;
							7) только если на 2809 соответствующего интерфейса ещё есть дебетовый остаток(т.е не было поступления "живых" денег через Клиент Банк;
					Set nErr = 0 
					Set sErr = ''
					Set sTxt = strTip || ' Реф.АБС = ' || Str(aRef)
					! -- Функция удаляет IBOX платеж (реестр платежей, основную проводку по погашению, дочерние проводки по разбору счета гашения) 
							  -- %param p_mode тип обращения {*} 1 проверить {*} 2 удалить
							  -- %param p_ibox_type тип интерфейса
							  -- %param p_ibox_ref референс документа в IBox
							  -- %param p_abs_ref референс документа в АБС
							  -- %param p_res_code код результата
							  --        {*} 0 без ошибок
							  --        {*} 1 Запись уже сквитована
							  --        {*} 2 Платёж в ОДБ %s НЕ найден
							  --        {*} 3 Платёж в ОДБ %s НЕ проведён
							  --        {*} 4 Банковский День %s НЕ равен макс (%s)
							  --        {*} 5 Банковский День закрыт
							  --        {*} 6 Банковский День %s НЕ равен дню платежа (%s)
							  --        {*} 7 Счет %s НЕ найден в ОБД
							  --        {*} 8 Счет %s угроза красного сальдо
							  --        {*} 9 По Счету SG %s есть "ручные" проводки
							  -- %param p_res_text текст результата
							  procedure ibox_delete_payment(p_mode      in number,
							                                p_ibox_type in wcs_ibox_types.id%type,
							                                p_ibox_ref  in wcs_ibox_recs.ibox_ref%type,
							                                p_abs_ref   in wcs_ibox_recs.abs_ref%type,
							                                p_res_code  out number,
							                                p_res_text  out varchar2);
							
							
					If SqlPLSQLCommand(hSql(), "WCS_EXCHANGE.ibox_delete_payment
							( 2, sTip, iRef, aRef, nErr, sErr )") 
						If nErr = 0 
							Call SqlCommit(hSql())
							Call MessageNoWait( 'Успешное вып.' || sTxt ,'',2,0)
							Return TRUE
						!
						Call SqlRollback(hSql())
						Call SalMessageBox( Str(nErr) || '. ' || sErr, 'ВНИМАНИЕ, НЕвозможно '|| sTxt  , MB_IconStop)
						Return FALSE
						!
		Window Parameters
			Number: nMode
			Number: nPar 
			String: pibox ! IBOX , XBANK, XREST -- Тип интерфейса
			String: strPar02
		Window Variables
			String: sFilter
			String: rFilter
			String: sSql
			Number: nColR
			Number: nColY
			Number: nColG
			!
			Number: p_res_code
			String: p_res_text
			String: Tip_Int
			String: sTitl
			String: ibox_type ! IBOX , XBANK, XREST -- Тип интерфейса
			String: wbox_type 
			Date/Time: MAX_FDAT
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm,8)
				Set ibox_type = SalStrTrimX( pibox)  
				Set KWT.nTabInstance = 1
				Set KWT.fFilterAtStart = 1
				Set KWT.strFilterTblName = 'IBOX'
				Set KWT.strPrintFileName = 'KWT_'|| ibox_type
				Set rbR = TRUE
				!
				If ibox_type != ''
					If SqlPrepareAndExecute( hSql(),
							 "SELECT Substr(NAME,1,50) into :Tip_Int 
							  from WCS_IBOX_TYPES where id=:ibox_type " )
							and NOT SqlFetchNext(hSql(),nFetchRes)
						Call SalMessageBox('Не задан (Не найден) тип интерфейса '|| ibox_type,
								'Внимание ! Ош.в параметрах вызава !', MB_IconStop)
						! Call SalDestroyWindow(hWndForm)
						! Return TRUE
				Else
					Set Tip_Int = 'Все интефейсы'
				! !!!!!!!!!!!!!!!!
				Set sTitl = "Квитовка с " || ibox_type || ' ' ||  Tip_Int
				Call SalSetWindowText( hWndForm, sTitl )
				! розовый Плохо.
				! Set nColR = SalColorFromRGB( 255,240,255 ) 
				Set nColR = COLOR_Salmon
				! серый Хорошо.
				Set nColY = COLOR_LightGray
				! зеленый ждем.
				Set nColG = COLOR_LightGreen
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If SqlPrepareAndExecute( hSql(), "SELECT max(fdat) into :MAX_FDAT from fdat " )
						and SqlFetchNext(hSql(),nFetchRes)
					If GetBankDate() < MAX_FDAT OR IsBankDayOpen() != 1
						Call SalDisableWindow( pbDel )
					Else
						Call SalEnableWindow( pbDel )
				If KWT.fFilterAtStart
					Set KWT.fFilterAtStart = NOT KWT.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				!
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalWaitCursor(TRUE)
				Set nKol = 0
				Set nSum = 0
				If rbR 
					Set rFilter = '(ibox.IKWT=0 or ibox.AREF IS NULL or ibox.IKWT IS NULL AND ibox.IDAT<gl.BD and ibox.AREF>0) '
				Else If rbG
					Set rFilter = '(ibox.IKWT IS NULL AND ibox.IDAT >= gl.BD and ibox.AREF>0) '
				Else If rbY
					Set rFilter = '(ibox.IKWT=1 )'
				Else If rbA
					Set rFilter = '(ibox.IREF is not null)'
				!
				Set wbox_type = IifS ( ibox_type != "", " IBOX_TYPE = '" || ibox_type || "' " , "") 
				!
				Set sSql =
						"select typi,
						       aref,
						       iref,
						       idat,
						       ccid,
						       isum,
						       ikwt,
						       nfil,
						       dfil,
						       kfil,
						       sfil,
						       ofil
						  into :hWndForm.KWT.TYPI,
						       :hWndForm.KWT.AREF,
						       :hWndForm.KWT.IREF,
						       :hWndForm.KWT.IDAT,
						       :hWndForm.KWT.CCID,
						       :hWndForm.KWT.ISUM,
						       :hWndForm.KWT.IKWT,
						       :hWndForm.KWT.NFIL,
						       :hWndForm.KWT.DFIL,
						       :hWndForm.KWT.KFIL,
						       :hWndForm.KWT.SFIL,
						       :hWndForm.KWT.OFIL
						  from v_wcs_ibox_payments ibox
						 where " || rFilter || IifS(sFilter = "", "", "
						   and " || sFilter) || IifS( ibox_type = "", "", " and typi = '" || ibox_type || "'") 
				!
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), sSql , TBL_FillAll  )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If IKWT = 1
					! 1. Хорошо. Cквитован = серый
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColY )
					Set SOS = 1
					Set sSOS = '1.Сквитован'
				Else If IKWT = 0 and AREF != NUMBER_Null 
					! 3.1. Плохо. Есть в реесре, есть платеж, но что-то не совпадает = розовый
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColR )
					Set SOS = 31
					Set sSOS = '31.НЕсовп.рекв.'
				Else If IKWT = NUMBER_Null
					If AREF = NUMBER_Null 
						! 3.2. Плохо. Есть в реесре, но нет платежа
						Call XSalTblSetRowBackColor( hWndForm, lParam, nColR )
						Set SOS = 32
						Set sSOS = '32.НЕТ платежа'
					Else
						! Не ясно- ждем. Есть платеж, но нет в реестре
						If IDAT >= GetBankDate()
							! 2. ждем. Зеленый. Оплатили сегодня, квитовка будет
							Call XSalTblSetRowBackColor( hWndForm, lParam, nColG )
							Set SOS = 2
							Set sSOS = '2.Ждем реестр'
						Else
							! 3.3. Плохо. Оплатили вчера, пора бы сквитоваться
							Call XSalTblSetRowBackColor( hWndForm, lParam, nColR )
							Set SOS = 33
							Set sSOS = '33.Нет реестра'
				Set nKol = nKol + 1 
				Set nSum = nSum + ISUM
			On SAM_TblDoDetails
				! Сквитовать
				If SOS = 32
					Call SalShowWindow( pb_Opl )
				Else
					Call SalHideWindow( pb_Opl )
				! Бекнуть
				If AREF > 0 and IKWT != 1
					Call SalShowWindow( pbDel )
				Else
					Call SalHideWindow( pbDel )
				!
			On SAM_DoubleClick
				If AREF > 0
					Call DocViewContentsEx(hWndForm, AREF )
	Table Window: GAK !! Консолидированные и средние Разрывы
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Консолидированные и средние Разрывы
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.69"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути склад архіву ПІДСУМКОВИХ даних'
						On SAM_Click
							Call FunNSIEditF ('ANI_GAPV2', 1 )
						!
				Pushbutton: pb_Rnbu 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.071"
						Width:  0.5"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									'Переглянути наявні дати в архіві ПЕРВИННИХ даних 
									та (Пере)Накопичити ПІДСУМКОВІ дані'
						On SAM_Click
							Call F_Nak1()
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = '(Пере)Накопичити в архів підсумкові дані з протоколу за указаний період'
						On SAM_Click
							Call F_Nak2 ( strTip, DAT1, DAT2)
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати дані з архіву за інтервал дат (включно)'
						On SAM_Click
							If FDAT()
								Call NASELENIE ()
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43657
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43658
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43659
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   9.283"
						Top:    0.405"
						Width:  3.9"
						Width Editable? Yes
						Height: 4.905"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nKv = 0
							Call cmb_KV.Init(hWndItem)
							Call cmb_KV.Populate(hSql(),
									"KV","substr('   '||KV,-3)||'.'||LCV||'/'||NAME","TABVAL",
									" where  D_CLOSE is null union all select  0 , '  */Консолідовано по вал' from dual
									 ORDER BY 2 ")
							Call SalListSetSelect(cmb_KV,0)
						On SAM_Click
							Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							If nKv = 0 or nKv=n980
								Set nKurs = 1
							Else
								If SqlPrepareAndExecute( hSql(),
										"SELECT RATE_O/BSUM into :nKurs from cur_rates c
										 where c.KV=:nKv and (c.kv,c.vdate) =
										(select kv,max(vdate) from cur_rates
										 where kv=c.KV and vdate<=:dDat group by kv) " )
										 and SqlFetchNext( hSql(), nFetchRes )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: nKurs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.383"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmb_TOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.383"
						Top:    0.405"
						Width:  3.9"
						Width Editable? Yes
						Height: 5.833"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set sTobo = '*'
							Call cmb_TOBO.Init(hWndItem)
							If nHaveTOBO != 2
								Call cmb_TOBO.Populate(hSql(),
										"TOBO","TOBO||'/'||NAME","TOBO",
										" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
										 ORDER BY 1")
							Else
								Call cmb_TOBO.Populate(hSql(),
										"BRANCH","BRANCH||'/'||NAME","BRANCH",
										" where BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask')  
										union all select '*' , '*/Консолідовано по BRANCH' from dual
										 ORDER BY 1")
							Call SalListSetSelect(cmb_TOBO,0)
						On SAM_Click
							Set sTobo =cmb_TOBO.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dWait
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.071"
							Width:  6.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pb_Chut 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Аналіз чутливості відкритих позицій до процентного ризику'
						On SAM_Click
							Call F_CUT (strTip, SDAT)
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.405"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата початку періоду розрахунку')
						On SAM_Validate
							Call FDAT()
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.405"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершення періоду розрахунку')
						On SAM_Validate
							Call FDAT()
		Contents
			Column: PAP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: А
						П
				Visible? Class Default
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: 10
				Data Type: String
				Justify: Left
				Width:  1.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Днів
						
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом
						Сума
						0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.883"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом
						% ст
						0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: На вимогу
						Сума
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: На вимогу
						%ст
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Овернайт
						Сума
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.717"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Овернайт
						% ст
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 7 дн
						Сума
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 7 дн
						% ст
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 8 - 21 дн
						Сума
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 8 - 21 дн
						% ст
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 22 - 31 дн
						Сума
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 22 - 31 дн
						% ст
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 32 - 92 дн
						Сума
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 32 - 92 дн
						% ст
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 93 -183 дн
						Сума
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 93 -183 дн
						% ст
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 184 - 274 дн
						Сума
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 184 - 274 дн
						% ст
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 275 -365
						Сума
						B
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 275 -365
						% ст
						B
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1- 1.5 р
						Сума
						C
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1- 1.5 р
						% ст
						C
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1,5 - 2 р
						Сума
						D
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1,5 - 2 р
						% ст
						D
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0E
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 3 р
						Сума
						E
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0E
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 3 р
						% ст
						E
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0F
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 3 - 5 років
						Сума
						F
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0F
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 3 - 5 років
						% ст
						F
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 5 - 10 р
						Сума
						G
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 5 - 10 р
						% ст
						G
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0H
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: > 10 р
						Сума
						H
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0H
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: > 10 р
						% ст
						H
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0X
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Прострочені
						Сума
						X
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0X
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Прострочені
						% ст
						X
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			! Function: FunNSIEditF			!__exported
				                                                 Description: Универсальная функция вызова редактирования таблиц с
						вариативными вкл/выкл фильтров, режимов редактирования
						и т.д.
				                                                 Returns 
					                                                 Number: nRet
				                                                 Parameters 
					                                                 String: strNSITblName
					                                                 Number: nMode
				                                                 Static Variables 
				                                                 Local variables 
					                                                 Number: fReturnResult
					                                                 Boolean: fFilterAtStart
				                                                 Actions 
					! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
					                                                 Call IniNsiApi()
					!
					                                                 Set fReturnResult = TRUE
					!
					! Реанимация записей (ПРАВЭКС)
					                                                 If strNSITblName = STRING_Null and nMode = 20
						                                                 If not IsWindow(hWin20)
							                                                 Set hWin20 = SalCreateWindow(frmRestoreRecord, hWndMDI)
						                                                 Else 
							                                                 Call SalBringWindowToTop(hWin20)
					! Обычное редактирование справочников
					                                                 Else 
						! 0x0010 - принудительный фильтр на старте
						                                                 If nMode & 0x0010
							                                                 Set fFilterAtStart = TRUE
							                                                 Set nMode = nMode - 0x0010
						                                                 Else 
							                                                 Set fFilterAtStart = FALSE
						!
						                                                 If nMode < 0 OR nMode > 7
							                                                 Set nMode = NSIMode_Normal
						!
						                                                 If ChekNsiTable(strNSITblName)
							                                                 Call SalCreateWindow(frm_universal_nsi_edit, hWndMDI, SalStrTrimX(strNSITblName), hWndNULL, 0, '', nMode, fFilterAtStart)
						                                                 Else 
							                                                 Set fReturnResult = FALSE
					!
					                                                 Return fReturnResult
					!
					! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
			Function: I0 ! Обнуление итогов
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set I00[1] = 0
					Set I01[1] = 0
					Set I02[1] = 0
					Set I03[1] = 0
					Set I04[1] = 0
					Set I05[1] = 0
					Set I06[1] = 0
					Set I07[1] = 0
					Set I0A[1] = 0
					Set I0B[1] = 0
					Set I0C[1] = 0
					Set I0D[1] = 0
					Set I0E[1] = 0
					Set I0F[1] = 0
					Set I0G[1] = 0
					Set I0H[1] = 0
					Set I0X[1] = 0
					!
					Set I00[2] = 0
					Set I01[2] = 0
					Set I02[2] = 0
					Set I03[2] = 0
					Set I04[2] = 0
					Set I05[2] = 0
					Set I06[2] = 0
					Set I07[2] = 0
					Set I0A[2] = 0
					Set I0B[2] = 0
					Set I0C[2] = 0
					Set I0D[2] = 0
					Set I0E[2] = 0
					Set I0F[2] = 0
					Set I0G[2] = 0
					Set I0H[2] = 0
					Set I0X[2] = 0
					!
					Set J00[1] = 0
					Set J01[1] = 0
					Set J02[1] = 0
					Set J03[1] = 0
					Set J04[1] = 0
					Set J05[1] = 0
					Set J06[1] = 0
					Set J07[1] = 0
					Set J0A[1] = 0
					Set J0B[1] = 0
					Set J0C[1] = 0
					Set J0D[1] = 0
					Set J0E[1] = 0
					Set J0F[1] = 0
					Set J0G[1] = 0
					Set J0H[1] = 0
					Set J0X[1] = 0
					!
					Set J00[2] = 0
					Set J01[2] = 0
					Set J02[2] = 0
					Set J03[2] = 0
					Set J04[2] = 0
					Set J05[2] = 0
					Set J06[2] = 0
					Set J07[2] = 0
					Set J0A[2] = 0
					Set J0B[2] = 0
					Set J0C[2] = 0
					Set J0D[2] = 0
					Set J0E[2] = 0
					Set J0F[2] = 0
					Set J0G[2] = 0
					Set J0H[2] = 0
					Set J0X[2] = 0
					!
			Function: F_Nak1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp 
					String: sTmp1 
					Date/Time: dTmp
				Actions
					Set sTmp =STRING_Null
					Call FunNSIGetFiltered("ANI_GAPV1","FDAT"," nvl(YN,0) >=0 ", sTmp, sTmp1)
					If sTmp != STRING_Null
						Set dTmp = SalStrToDate( sTmp )
						Call F_Nak2 ('(Пере)Накопичення ', dTmp,dTmp)
				! Call FunNSIEditF ('ANI_GAPV1', 1 )
			Function: F_Nak2
				Description:
				Returns
				Parameters
					String: strTip
					Date/Time: dTmp1
					Date/Time: dTmp2
				Static Variables
				Local variables
				Actions
					Set sTmp = 'Виконати 
							' || strTip || ' 
							з '|| SalFmtFormatDateTime( dTmp1, 'dd.MM.yyyy' )||
							' по ' || SalFmtFormatDateTime( dTmp2, 'dd.MM.yyyy' ) || ' включно '
					If SalMessageBox( sTmp || '?', 'Увага !', MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand( hSql(), " ANI_GAPS( 1, dTmp1, dTmp2 ) " )
							Call SqlCommit( hSql()  )
							Call SalWaitCursor(FALSE)
							Call MessageNoWait(sTmp,'Повідомлення про успішне виконання',3,0)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						Else
							Call SqlRollback( hSql() )
							Call SalWaitCursor(FALSE)
							Call MessageNoWait(sTmp,'Повідомлення про аварійне завершення',0,1)
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql
					Number: nKol
				Actions
					Call SalWaitCursor(TRUE)
					If SqlPrepareAndExecute( hSql(), 
							"select max(fdat) into :DAT_MAX from ani_gap where fdat<= :DAT1 ") 
							and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute( hSql(),
								"update ani_gap a set a.KOL = 
								     (select  NVL(min(n.fdat),:DAT2  + 1)  - greatest(a.fdat, :DAT1)  
								              from ani_gap n 
								      where n.fdat > a.fdat and n.fdat<= :DAT2  
								        and n.pap = a.pap and n.kv = a.kv and n.branch = a.branch    )
								where fdat >=:DAT_MAX and fdat<= :DAT2 ")
							Call SqlCommit( hSql())
							Call I0()
							Set nKol = DAT2- DAT1 + 1
							! Заголовки
							Call SalSetWindowText( hWndForm, "Консолидированные и средние Разрывы." || cmb_KV ||" " || cmb_TOBO )
							Call IIS (0)
							! Селект
							Set sSql = 
									"SELECT TO_CHAR(FDAT,'YYYY.MM.DD') SDAT, KOL, PAP, G0X, R0X,
									   G00, G01, G02, G03, G04, G05, G06, G07,
									   G0A, G0B, G0C, G0D, G0E, G0F, G0G, G0H,
									   R00, R01, R02, R03, R04, R05, R06, R07,
									   R0A, R0B, R0C, R0D, R0E, R0F, R0G, R0H   
									 FROM  ANI_GAP WHERE KV = :nKv AND BRANCH = :sTobo 
									  and fdat >= :DAT_MAX and fdat <= :DAT2 
									 union all 
									 SELECT 'Середнi' SDAT, "||Str(nKol)||" kol, PAP , sum(G0X*KOL)/:nKol, sum(R0X*KOL)/:nKol,
									   sum(G00*KOL)/:nKol, sum(G01*KOL)/:nKol, sum(G02*KOL)/:nKol, sum(G03*KOL)/:nKol, 
									   sum(G04*KOL)/:nKol, sum(G05*KOL)/:nKol, sum(G06*KOL)/:nKol, sum(G07*KOL)/:nKol,
									   sum(G0A*KOL)/:nKol, sum(G0B*KOL)/:nKol, sum(G0C*KOL)/:nKol, sum(G0D*KOL)/:nKol,
									   sum(G0E*KOL)/:nKol, sum(G0F*KOL)/:nKol, sum(G0G*KOL)/:nKol, sum(G0H*KOL)/:nKol,
									   sum(R00*KOL)/:nKol, sum(R01*KOL)/:nKol, sum(R02*KOL)/:nKol, sum(R03*KOL)/:nKol,
									   sum(R04*KOL)/:nKol, sum(R05*KOL)/:nKol, sum(R06*KOL)/:nKol, sum(R07*KOL)/:nKol,
									   sum(R0A*KOL)/:nKol, sum(R0B*KOL)/:nKol, sum(R0C*KOL)/:nKol, sum(R0D*KOL)/:nKol,
									   sum(R0E*KOL)/:nKol, sum(R0F*KOL)/:nKol, sum(R0G*KOL)/:nKol, sum(R0H*KOL)/:nKol  
									  FROM  ANI_GAP  WHERE KV = :nKv AND BRANCH = :sTobo 
									   and fdat >= :DAT_MAX and fdat <= :DAT2 
									  group by PAP 
									 ORDER BY 1, 2 
									INTO :GAK.SDAT, :GAK.KOL, :GAK.PAP, :GAK.G0X,  :GAK.R0X,
									  :GAK.G00,:GAK.G01,:GAK.G02,:GAK.G03,:GAK.G04,:GAK.G05,:GAK.G06,:GAK.G07,
									  :GAK.G0A,:GAK.G0B,:GAK.G0C,:GAK.G0D,:GAK.G0E,:GAK.G0F,:GAK.G0G,:GAK.G0H,
									  :GAK.R00,:GAK.R01,:GAK.R02,:GAK.R03,:GAK.R04,:GAK.R05,:GAK.R06,:GAK.R07,
									  :GAK.R0A,:GAK.R0B,:GAK.R0C,:GAK.R0D,:GAK.R0E,:GAK.R0F,:GAK.R0G,:GAK.R0H "
						Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll  )
					Call SalWaitCursor(FALSE)
			Function: II ! Расчет % ставок
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If G00 != 0
						Set R00 = R00/G00
					Else
						Set R00 = 0
					!
					If G01 != 0
						Set R01 = R01/G01
					Else
						Set R01 = 0
					If G02 != 0
						Set R02 = R02/G02
					Else
						Set R02 = 0
					If G03 != 0
						Set R03 = R03/G03
					Else
						Set R03 = 0
					If G04 != 0
						Set R04 = R04/G04
					Else
						Set R04 = 0
					If G05 != 0
						Set R05 = R05/G05
					Else
						Set R05 = 0
					If G06 != 0
						Set R06 = R06/G06
					Else
						Set R06 = 0
					If G07 != 0
						Set R07 = R07/G07
					Else
						Set R07 = 0
					If G0A != 0
						Set R0A = R0A/G0A
					Else
						Set R0A = 0
					If G0B != 0
						Set R0B = R0B/G0B
					Else
						Set R0B = 0
					If G0C != 0
						Set R0C = R0C/G0C
					Else
						Set R0C = 0
					If G0D != 0
						Set R0D = R0D/G0D
					Else
						Set R0D = 0
					If G0E != 0
						Set R0E = R0E/G0E
					Else
						Set R0E = 0
					If G0F != 0
						Set R0F = R0F/G0F
					Else
						Set R0F = 0
					If G0G != 0
						Set R0G = R0G/G0G
					Else
						Set R0G = 0
					If G0H != 0
						Set R0H = R0H/G0H
					Else
						Set R0H = 0
					!
					If G0X != 0
						Set R0X = R0X/G0X
					Else
						Set R0X = 0
			Function: IIS ! Расчет средних % ставок
				Description:
				Returns
				Parameters
					Number: pPap
				Static Variables
				Local variables
					Number: nZnak
				Actions
					If pPap = 0
						Set s0X = 0 
						Set s00 = 0 
						Set s01 = 0 
						Set s02 = 0 
						Set s03 = 0 
						Set s04 = 0 
						Set s05 = 0 
						Set s06 = 0 
						Set s07 = 0 
						Set s0A = 0 
						Set s0B = 0 
						Set s0C = 0 
						Set s0D = 0 
						Set s0E = 0 
						Set s0F = 0 
						Set s0G = 0 
						Set s0H = 0 
					Else If pPap = 3
						Set R0X = s0X
						Set R00 = s00 
						Set R01 = s01 
						Set R02 = s02 
						Set R03 = s03 
						Set R04 = s04 
						Set R05 = s05 
						Set R06 = s06 
						Set R07 = s07 
						Set R0A = s0A 
						Set R0B = s0B 
						Set R0C = s0C 
						Set R0D = s0D 
						Set R0E = s0E 
						Set R0F = s0F 
						Set R0G = s0G 
						Set R0H = s0H 
					Else
						Set nZnak = IifN( PAP = 1, 1, -1)
						Set s0X = s0X +  nZnak * R0X
						Set s00 = s00 +  nZnak * R00
						Set s01 = s01 +  nZnak * R01 
						Set s02 = s02 +  nZnak * R02 
						Set s03 = s03 +  nZnak * R03
						Set s04 = s04 +  nZnak * R04
						Set s05 = s05 +  nZnak * R05
						Set s06 = s06 +  nZnak * R06
						Set s07 = s07 +  nZnak * R07
						Set s0A = s0A +  nZnak * R0A
						Set s0B = s0B +  nZnak * R0B 
						Set s0C = s0C +  nZnak * R0C
						Set s0D = s0D +  nZnak * R0D
						Set s0E = s0E +  nZnak * R0E
						Set s0F = s0F +  nZnak * R0F
						Set s0G = s0G +  nZnak * R0G
						Set s0H = s0H +  nZnak * R0H
			Function: STROKA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If PAP = 1 
						Set NAME = 'Актив'
					Else If PAP = 2
						Set NAME = 'Пасив'
					Else If PAP = 3
						Set NAME = 'Рiзниця'
					! Пересчет в номинал для инвалюты
					If nKv != 0 and nKv != n980 and nKv != NUMBER_Null
						Set G0X = G0X / nKurs
						Set G01 = G01 / nKurs
						Set G02 = G02 / nKurs
						Set G03 = G03 / nKurs
						Set G04 = G04 / nKurs
						Set G05 = G05 / nKurs
						Set G06 = G06 / nKurs
						Set G07 = G07 / nKurs
						Set G0A = G0A / nKurs
						Set G0B = G0B / nKurs
						Set G0C = G0C / nKurs
						Set G0D = G0D / nKurs
						Set G0E = G0E / nKurs
						Set G0F = G0F / nKurs
						Set G0H = G0H / nKurs
						Set G00 = G00 / nKurs
						!
						Set R0X = R0X / nKurs
						Set R01 = R01 / nKurs
						Set R02 = R02 / nKurs
						Set R03 = R03 / nKurs
						Set R04 = R04 / nKurs
						Set R05 = R05 / nKurs
						Set R06 = R06 / nKurs
						Set R07 = R07 / nKurs
						Set R0A = R0A / nKurs
						Set R0B = R0B / nKurs
						Set R0C = R0C / nKurs
						Set R0D = R0D / nKurs
						Set R0E = R0E / nKurs
						Set R0F = R0F / nKurs
						Set R0H = R0H / nKurs
						Set R00 = R00 / nKurs
					! Накопление для расчета средних
					!
					! Расчет средних % ставок
					Call II()
			Function: F_CUT
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
					String: sDat 
				Static Variables
				Local variables
					Number: nRow
					Number: nPP
				Actions
					Set nRow = TBL_MinRow
					Set nPP =0 
					While SalTblFindNextRow(hWndForm, nRow,  0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If SDAT = sDat
							If PAP = 1 OR PAP=2 
								Set nPP = nPP +PAP
								!
								Set I0X[PAP] = G0X
								Set I00[PAP] = G00
								Set I01[PAP] = G01
								Set I02[PAP] = G02
								Set I03[PAP] = G03
								Set I04[PAP] = G04
								Set I05[PAP] = G05
								Set I06[PAP] = G06
								Set I07[PAP] = G07
								Set I0A[PAP] = G0A
								Set I0B[PAP] = G0B
								Set I0C[PAP] = G0C
								Set I0D[PAP] = G0D
								Set I0E[PAP] = G0E
								Set I0F[PAP] = G0F
								Set I0G[PAP] = G0G
								Set I0H[PAP] = G0H
								!
								Set J0X[PAP] = R0X * I0X[PAP]
								Set J00[PAP] = R00 * I00[PAP]
								Set J01[PAP] = R01 * I01[PAP]
								Set J02[PAP] = R02 * I02[PAP]
								Set J03[PAP] = R03 * I03[PAP]
								Set J04[PAP] = R04 * I04[PAP]
								Set J05[PAP] = R05 * I05[PAP]
								Set J06[PAP] = R06 * I06[PAP]
								Set J07[PAP] = R07 * I07[PAP]
								Set J0A[PAP] = R0A * I0A[PAP]
								Set J0B[PAP] = R0B * I0B[PAP]
								Set J0C[PAP] = R0C * I0C[PAP]
								Set J0D[PAP] = R0D * I0D[PAP]
								Set J0E[PAP] = R0E * I0E[PAP]
								Set J0F[PAP] = R0F * I0F[PAP]
								Set J0G[PAP] = R0G * I0G[PAP]
								Set J0H[PAP] = R0H * I0H[PAP]
					If nPP = 3 
						Call SalCreateWindow (CUT, hWndForm, strTip, cmb_KV, cmb_TOBO, sDat,
								 I0X,I01,I02,I03,I04,I05,I06,I07,I0A,I0B,I0C,I0D,I0E,I0F,I0G,I0H,I00,
								 J0X,J01,J02,J03,J04,J05,J06,J07,J0A,J0B,J0C,J0D,J0E,J0F,J0G,J0H,J00)
			Function: FDAT
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					! String: sTmp
				Actions
					If DAT1 != DATETIME_Null 
						If SqlPrepareAndExecute(hSql(),"SELECT min(fdat) into :DAT_MIN FROM ani_gap ") 
								and SqlFetchNext(hSql(), nFetchRes)
						If DAT_MIN = DATETIME_Null 
							Call SalMessageBox('В архіві не накопичено жодної дати !','Помилка ! ', MB_IconStop)
							Return FALSE
						!
						If DAT_MIN > DAT1 
							If SalMessageBox(
									'В архіві мінімально доступна Дата "З"  = ' || SalFmtFormatDateTime( DAT_MIN, 'dd.MM.yyyy' )||' 
									Установити її ?', 'Увага !', MB_IconQuestion | MB_YesNo) = IDYES
								Set DAT1 = DAT_MIN
								Return TRUE
							!
							Set DAT1 = DATETIME_Null
							Return FALSE
						!
						If DAT2 != DATETIME_Null
							If DAT1 > DAT2
								Call SalMessageBox('Дата "З"  >  Дата "По" !','Помилка ! ', MB_IconStop)
								Set DAT1 = DATETIME_Null
								Return FALSE
						!
						Return TRUE
					!
					Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: sStr1
			String: sStr2
		Window Variables
			Number: nKv
			Date/Time: DAT_MIN 
			Date/Time: DAT_MAX
			! Date/Time: bDat
			! Date/Time: dTmp
			Date/Time: dDat
			Number: n980
			String: sTobo 
			String: sTmp 
			Number: nIr
			!
			Number: nCol[*]
			! Number: nCol9
			! I01[1] - итог сумм-активов 
			! I01[2] - итог сумм-пассивов
			Number: s0X
			Number: s00
			Number: s01
			Number: s02
			Number: s03
			Number: s04
			Number: s05
			Number: s06
			Number: s07
			Number: s0A
			Number: s0B
			Number: s0C
			Number: s0D
			Number: s0E
			Number: s0F
			Number: s0G
			Number: s0H
			!
			Number: I0X[*]
			Number: I01[*]
			Number: I02[*]
			Number: I03[*]
			Number: I04[*]
			Number: I05[*]
			Number: I06[*]
			Number: I07[*]
			Number: I0A[*]
			Number: I0B[*]
			Number: I0C[*]
			Number: I0D[*]
			Number: I0E[*]
			Number: I0F[*]
			Number: I0G[*]
			Number: I0H[*]
			Number: I00[*]
			!
			! J01[1] - для расчета середн.зв ставка активов 
			! J01[2] - для расчета середн.зв ставка пассивов
			Number: J0X[*]
			Number: J01[*]
			Number: J02[*]
			Number: J03[*]
			Number: J04[*]
			Number: J05[*]
			Number: J06[*]
			Number: J07[*]
			Number: J0A[*]
			Number: J0B[*]
			Number: J0C[*]
			Number: J0D[*]
			Number: J0E[*]
			Number: J0F[*]
			Number: J0G[*]
			Number: J0H[*]
			Number: J00[*]
			!
		Message Actions
			On SAM_Create
				Set GAK.nTabInstance = 1
				Set GAK.n980 = GetBaseVal()
				Set nCol[1] = COLOR_LightGreen
				Set nCol[4] = COLOR_Green
				Set nCol[2] = COLOR_Sky
				Set nCol[5] = COLOR_Cyan 
				! Set nCol[5] = COLOR_Cyan ! COLOR_DarkAqua  COLOR_LightAqua
				Set nCol[3] = SalColorFromRGB( 255,255,180)
				Set nCol[6] = COLOR_Yellow 
				!
				Set DAT2 = GetBankDate() -1 
				Set DAT1 = SalDateConstruct( SalDateYear ( DAT2 ), SalDateMonth( DAT2 ), 1, 0, 0, 0 )
				!
				Set GAK.strPrintFileName = 'GAK_'||Str(hWndForm.GAK.nPar)
				Call SalTblSetLockedColumns(hWndForm, 6)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
			! On UM_Populate
				                                                    Call NASELENIE ()
			On SAM_FetchRowDone
				! Расчет средних % ставок
				Call STROKA()
				If SDAT = 'Середнi'
					Call XSalTblSetRowBackColor( hWndForm, lParam, nCol[PAP+3])
					Set NAME = SalStrUpperX( NAME )
				Else
					Call XSalTblSetRowBackColor( hWndForm, lParam, nCol[PAP])
					If DAT1 > DAT_MAX and SDAT = SalFmtFormatDateTime( DAT_MAX, 'yyyy.MM.dd' )
						Call XSalTblSetCellBackColor( SDAT, COLOR_Gray )
						! Call XSalTblSetCellBackColor( SDAT, SalColorFromRGB( 255,210,250 ) )
				Call IIS (PAP)
				If PAP = 3
					Call IIS ( 0 )
	Table Window: GAP !! Разрывы
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Анализ відповідності АКТ-ПАС в розрізі рахунків
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  19.3"
				Width Editable? Class Default
				Height: 8.5"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.131"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 38123
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Детально по рахункам'
						On SAM_Click
							If (hWndForm.GAP.nPar = 700 OR hWndForm.GAP.nPar = 800)
									and hWndForm.GAP.NBS != '5   '
								Call SalCreateWindow( GAP, hWndMDI, hWndForm.GAP.nPar + 1,
										hWndForm.GAP.PAP,
										SalStrTrimX(hWndForm.GAP.NBS),
										hWndForm.GAP.nKv,
										hWndForm.GAP.sTobo,
										hWndForm.GAP.rb0,
										hWndForm.GAP.rb1,
										hWndForm.GAP.rb2,
										hWndForm.GAP.rb3,
										hWndForm.GAP.rb4,
										hWndForm.GAP.cb_A7,
										hWndForm.GAP.cmb_KV,
										hWndForm.GAP.nKurs,
										hWndForm.GAP.cmb_TOBO, hWndForm.GAP.dDat )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 38124
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 38125
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				! Data Field: dDat
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.883"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                                                                                                                                                                  Message Actions
				Check Box: cb_A7
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тільки #A7
					Window Location and Size
						Left:   3.683"
						Top:    0.738"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 38126
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.283"
						Top:    0.655"
						Width:  4.6"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Власні ( F- 631)
					Window Location and Size
						Left:   3.483"
						Top:    0.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Клас
					Window Location and Size
						Left:   5.483"
						Top:    0.738"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Розділ
					Window Location and Size
						Left:   6.483"
						Top:    0.738"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Група
					Window Location and Size
						Left:   7.583"
						Top:    0.738"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Баланс
					Window Location and Size
						Left:   8.583"
						Top:    0.738"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.283"
						Top:    0.405"
						Width:  4.6"
						Width Editable? Yes
						Height: 5.524"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If nPar=701
								Call SalDisableWindow( cmb_KV )
								Set cmb_KV = pcmb_KV
								Set nKurs = pKurs
								Set nKv = pKV
							Else
								Set nKv = 0
								Call cmb_KV.Init(hWndItem)
								Call cmb_KV.Populate(hSql(),
										"KV","substr('   '||KV,-3)||'.'||LCV||'/'||NAME","TABVAL",
										" where  D_CLOSE is null union all select  0 , '  */Консолідовано по вал' from dual
										 ORDER BY 2 ")
								Call SalListSetSelect(cmb_KV,0)
						On SAM_Click
							Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							If nKv = 0 or nKv=n980
								Set nKurs = 1
							Else
								If SqlPrepareAndExecute( hSql(),
										"SELECT RATE_O/BSUM into :hWndForm.GAP.nKurs from cur_rates c
										 where c.KV=:hWndForm.GAP.nKv and (c.kv,c.vdate) =
										(select kv,max(vdate) from cur_rates
										 where kv=c.KV and vdate<=:hWndForm.GAP.dDat group by kv) " )
										 and SqlFetchNext( hSql(), nFetchRes )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: nKurs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.683"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmb_TOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  4.6"
						Width Editable? Yes
						Height: 4.131"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If nPar=701
								Call SalDisableWindow( cmb_TOBO )
								Set cmb_TOBO = pcmb_TOBO
							Else
								Set sTobo = '*'
								Call cmb_TOBO.Init(hWndItem)
								If nHaveTOBO != 2
									Call cmb_TOBO.Populate(hSql(),
											"TOBO","TOBO||'/'||NAME","TOBO",
											" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
											 ORDER BY 1")
								Else
									Call cmb_TOBO.Populate(hSql(),
											"BRANCH","BRANCH||'/'||NAME","BRANCH",
											" where BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask')  
											union all select '*' , '*/Консолідовано по BRANCH' from dual
											 ORDER BY 1")
								! Call cmb_TOBO.Populate(hSql(),
										"TOBO","TOBO||'/'||NAME","TOBO",
										" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
										 ORDER BY 1")
								Call SalListSetSelect(cmb_TOBO,0)
						On SAM_Click
							Set sTobo =cmb_TOBO.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dWait
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.738"
							Width:  5.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: sDAT        !! dd-MM-yyyy
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.75"
						Top:    0.44"
						Width:  1.833"
						Width Editable? Yes
						Height: 6.143"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If hWndForm.GAP.nPar=700 or hWndForm.GAP.nPar=800
								Call FDAT()
								Call SalListSetSelect(hWndForm.GAP.sDAT, 0)
								Set hWndForm.GAP.dDat = SalStrToDate( hWndForm.GAP.sDAT )
							Else
						On SAM_Click
							Set hWndForm.GAP.dDat = SalStrToDate( hWndForm.GAP.sDAT )
							If nKv = 0 or nKv=n980
								Set nKurs = 1
							Else
								If SqlPrepareAndExecute( hSql(),
										"SELECT RATE_O/BSUM into :hWndForm.GAP.nKurs from cur_rates c
										 where c.KV=:hWndForm.GAP.nKv and (c.kv,c.vdate) =
										(select kv,max(vdate) from cur_rates
										 where kv=c.KV and vdate<=:hWndForm.GAP.dDat group by kv) " )
										 and SqlFetchNext( hSql(), nFetchRes )
						On SAM_SetFocus
							Call SalStatusSetText(hWndForm, 'Выберите дату.')
				Pushbutton: pbExecute
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати накопичення типу A7 за указану дату(м.б. довго)'
							! Call SalDisableWindow( hWndForm.GAP.pbExecute )
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Call SalShowWindow( hWndForm.GAP.dWait )
							Set dWait = "Зачекайте, Виконується накопичення типу A7 за "|| sDAT
							Set hWndForm.GAP.dDat = SalStrToDate( hWndForm.GAP.sDAT )
							If nOB22 = 1
								Set PROC_NAME = "ANI4_BU_ex(2, 0, STRING_Null, hWndForm.GAP.dDat )"
							Else
								Set PROC_NAME = "Bars.ANI( -1, hWndForm.GAP.dDat -1, hWndForm.GAP.dDat  )"
							Set dForm_B = SalDateCurrent(  )
							Set dForm_E = DATETIME_Null
							If SqlPLSQLCommand( hSql(), PROC_NAME  )
								Set dForm_E =  SalDateCurrent(  )
								Call FDAT()
								Set hWndForm.GAP.sDAT = SalFmtFormatDateTime( hWndForm.GAP.dDat, 'dd/MM/yyyy' )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Set dWait = ""
							Call SalHideWindow( hWndForm.GAP.dWait )
							Call SalWaitCursor(FALSE)
				!
				Pushbutton: pb_Chut 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Аналіз чутливості відкритих позицій до процентного ризику'
							! Кнопка "чутливість"
							If hWndForm.GAP.nPar >=800
								Call SalShowWindow( pb_Chut )
							Else
								Call SalHideWindow( pb_Chut )
						On SAM_Click
							Call SalCreateWindow (CUT, hWndForm, strTip, cmb_KV, cmb_TOBO, sDAT,
									 I0X,I01,I02,I03,I04,I05,I06,I07,I0A,I0B,I0C,I0D,I0E,I0F,I0G,I0H,I00,
									 J0X,J01,J02,J03,J04,J05,J06,J07,J0A,J0B,J0C,J0D,J0E,J0F,J0G,J0H,J00)
				Data Field: VE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.183"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dForm_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.405"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: DateTime
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dForm_E
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.55"
							Top:    0.429"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: DateTime
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: PAP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: А
						П
				Visible? Class Default
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом
						Сума
						0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.883"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом
						% ст
						0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			!
			Column: G01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: На вимогу
						Сума
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: На вимогу
						%ст
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Овернайт
						Сума
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.717"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Овернайт
						% ст
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 7 дн
						Сума
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 7 дн
						% ст
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 8 - 21 дн
						Сума
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 8 - 21 дн
						% ст
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 22 - 31 дн
						Сума
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 22 - 31 дн
						% ст
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 32 - 92 дн
						Сума
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 32 - 92 дн
						% ст
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 93 -183 дн
						Сума
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 93 -183 дн
						% ст
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 184 - 274 дн
						Сума
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 184 - 274 дн
						% ст
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 275 -365
						Сума
						B
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 275 -365
						% ст
						B
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1- 1.5 р
						Сума
						C
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1- 1.5 р
						% ст
						C
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1,5 - 2 р
						Сума
						D
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1,5 - 2 р
						% ст
						D
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0E
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 3 р
						Сума
						E
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0E
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 2 - 3 р
						% ст
						E
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0F
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 3 - 5 років
						Сума
						F
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0F
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 3 - 5 років
						% ст
						F
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 5 - 10 р
						Сума
						G
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 5 - 10 р
						% ст
						G
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G0H
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: > 10 р
						Сума
						H
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0H
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: > 10 р
						% ст
						H
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G0X
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Прострочені
						Сума
						X
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0X
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Прострочені
						% ст
						X
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! cColumnLabeled: nPAP
				                                                                                                                                                                                                                                  List Values
				                                                                                                                                                                                                                                  Message Actions
		Functions
			Function: FDAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Call SalListClear( sDAT )
					If SqlPrepareAndExecute(hSql(),
							"SELECT to_char(fdat,'dd/MM/yyyy') INTO :sTmp
							 FROM " || VE ||" group by fdat  ORDER BY fdat DESC")
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(sDAT, sTmp)
			Function: F_Col
				Description:
				Returns
				Parameters
					Window Handle: hW
					Number: nW
				Static Variables
				Local variables
				Actions
					If nW >0
						Call XSalTblSetCellBackColor( hW, nCol[2] )
					Else If nW <0
						Call XSalTblSetCellBackColor( hW, nCol[1] )
			Function: I0 ! Обнуление итогов
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set I00[1] = 0
					Set I01[1] = 0
					Set I02[1] = 0
					Set I03[1] = 0
					Set I04[1] = 0
					Set I05[1] = 0
					Set I06[1] = 0
					Set I07[1] = 0
					Set I0A[1] = 0
					Set I0B[1] = 0
					Set I0C[1] = 0
					Set I0D[1] = 0
					Set I0E[1] = 0
					Set I0F[1] = 0
					Set I0G[1] = 0
					Set I0H[1] = 0
					Set I0X[1] = 0
					!
					Set I00[2] = 0
					Set I01[2] = 0
					Set I02[2] = 0
					Set I03[2] = 0
					Set I04[2] = 0
					Set I05[2] = 0
					Set I06[2] = 0
					Set I07[2] = 0
					Set I0A[2] = 0
					Set I0B[2] = 0
					Set I0C[2] = 0
					Set I0D[2] = 0
					Set I0E[2] = 0
					Set I0F[2] = 0
					Set I0G[2] = 0
					Set I0H[2] = 0
					Set I0X[2] = 0
					!
					Set J00[1] = 0
					Set J01[1] = 0
					Set J02[1] = 0
					Set J03[1] = 0
					Set J04[1] = 0
					Set J05[1] = 0
					Set J06[1] = 0
					Set J07[1] = 0
					Set J0A[1] = 0
					Set J0B[1] = 0
					Set J0C[1] = 0
					Set J0D[1] = 0
					Set J0E[1] = 0
					Set J0F[1] = 0
					Set J0G[1] = 0
					Set J0H[1] = 0
					Set J0X[1] = 0
					!
					Set J00[2] = 0
					Set J01[2] = 0
					Set J02[2] = 0
					Set J03[2] = 0
					Set J04[2] = 0
					Set J05[2] = 0
					Set J06[2] = 0
					Set J07[2] = 0
					Set J0A[2] = 0
					Set J0B[2] = 0
					Set J0C[2] = 0
					Set J0D[2] = 0
					Set J0E[2] = 0
					Set J0F[2] = 0
					Set J0G[2] = 0
					Set J0H[2] = 0
					Set J0X[2] = 0
					!
			Function: IG ! Накопление итогов
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.GAP.s9 != 9
						Set I00[PAP] = I00[PAP] + G00
						!
						Set I01[PAP] = I01[PAP] + G01
						Set I02[PAP] = I02[PAP] + G02
						Set I03[PAP] = I03[PAP] + G03
						Set I04[PAP] = I04[PAP] + G04
						Set I05[PAP] = I05[PAP] + G05
						Set I06[PAP] = I06[PAP] + G06
						Set I07[PAP] = I07[PAP] + G07
						Set I0A[PAP] = I0A[PAP] + G0A
						Set I0B[PAP] = I0B[PAP] + G0B
						Set I0C[PAP] = I0C[PAP] + G0C
						Set I0D[PAP] = I0D[PAP] + G0D
						Set I0E[PAP] = I0E[PAP] + G0E
						Set I0F[PAP] = I0F[PAP] + G0F
						Set I0G[PAP] = I0G[PAP] + G0G
						Set I0H[PAP] = I0H[PAP] + G0H
						Set I0X[PAP] = I0X[PAP] + G0X
						!
						If hWndForm.GAP.nPar >=800
							Set J00[PAP] = J00[PAP] + R00
							Set J01[PAP] = J01[PAP] + R01
							Set J02[PAP] = J02[PAP] + R02
							Set J03[PAP] = J03[PAP] + R03
							Set J04[PAP] = J04[PAP] + R04
							Set J05[PAP] = J05[PAP] + R05
							Set J06[PAP] = J06[PAP] + R06
							Set J07[PAP] = J07[PAP] + R07
							Set J0A[PAP] = J0A[PAP] + R0A
							Set J0B[PAP] = J0B[PAP] + R0B
							Set J0C[PAP] = J0C[PAP] + R0C
							Set J0D[PAP] = J0D[PAP] + R0D
							Set J0E[PAP] = J0E[PAP] + R0E
							Set J0F[PAP] = J0F[PAP] + R0F
							Set J0G[PAP] = J0G[PAP] + R0G
							Set J0H[PAP] = J0H[PAP] + R0H
							Set J0X[PAP] = J0X[PAP] + R0X
			Function: IR ! Строка-Разрыв (Разница)
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: A
					Number: P
				Actions
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set PAP = NUMBER_Null
					Set NAME='Різниця'
					Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[3] )
					Set G00 = I00[1] - I00[2]
					!
					Set G01 = I01[1] - I01[2]
					Set G02 = I02[1] - I02[2]
					Set G03 = I03[1] - I03[2]
					Set G04 = I04[1] - I04[2]
					Set G05 = I05[1] - I05[2]
					Set G06 = I06[1] - I06[2]
					Set G07 = I07[1] - I07[2]
					Set G0A = I0A[1] - I0A[2]
					Set G0B = I0B[1] - I0B[2]
					Set G0C = I0C[1] - I0C[2]
					Set G0D = I0D[1] - I0D[2]
					Set G0E = I0E[1] - I0E[2]
					Set G0F = I0F[1] - I0F[2]
					Set G0G = I0G[1] - I0G[2]
					Set G0H = I0H[1] - I0H[2]
					Set G0X = I0X[1] - I0X[2]
					!
					Call F_Col(G00,G00)
					!
					Call F_Col(G01,G01)
					Call F_Col(G02,G02)
					Call F_Col(G03,G03)
					Call F_Col(G04,G04)
					Call F_Col(G05,G05)
					Call F_Col(G06,G06)
					Call F_Col(G07,G07)
					Call F_Col(G0A,G0A)
					Call F_Col(G0B,G0B)
					Call F_Col(G0C,G0C)
					Call F_Col(G0D,G0D)
					Call F_Col(G0E,G0E)
					Call F_Col(G0F,G0F)
					Call F_Col(G0G,G0G)
					Call F_Col(G0H,G0H)
					Call F_Col(G0X,G0X)
					If hWndForm.GAP.nPar >= 800
						! 00
						If I00[1] != 0
							Set A = J00[1]/I00[1]
						Else
							Set A = 0
						If I00[2] != 0
							Set P = J00[2]/I00[2]
						Else
							Set P = 0
						Set R00 = A - P
						! 01
						If I01[1] != 0
							Set A = J01[1]/I01[1]
						Else
							Set A = 0
						If I01[2] != 0
							Set P = J01[2]/I01[2]
						Else
							Set P = 0
						Set R01 = A - P
						! 02
						If I02[1] != 0
							Set A = J02[1]/I02[1]
						Else
							Set A = 0
						If I02[2] != 0
							Set P = J02[2]/I02[2]
						Else
							Set P = 0
						Set R02 = A - P
						! 03
						If I03[1] != 0
							Set A = J03[1]/I03[1]
						Else
							Set A = 0
						If I03[2] != 0
							Set P = J03[2]/I03[2]
						Else
							Set P = 0
						Set R03 = A - P
						! 04
						If I04[1] != 0
							Set A = J04[1]/I04[1]
						Else
							Set A = 0
						If I04[2] != 0
							Set P = J04[2]/I04[2]
						Else
							Set P = 0
						Set R04 = A - P
						! 05
						If I05[1] != 0
							Set A = J05[1]/I05[1]
						Else
							Set A = 0
						If I05[2] != 0
							Set P = J05[2]/I05[2]
						Else
							Set P = 0
						Set R05 = A - P
						! 06
						If I06[1] != 0
							Set A = J06[1]/I06[1]
						Else
							Set A = 0
						If I06[2] != 0
							Set P = J06[2]/I06[2]
						Else
							Set P = 0
						Set R06 = A - P
						! 07
						If I07[1] != 0
							Set A = J07[1]/I07[1]
						Else
							Set A = 0
						If I07[2] != 0
							Set P = J07[2]/I07[2]
						Else
							Set P = 0
						Set R07 = A - P
						! 0A
						If I0A[1] != 0
							Set A = J0A[1]/I0A[1]
						Else
							Set A = 0
						If I0A[2] != 0
							Set P = J0A[2]/I0A[2]
						Else
							Set P = 0
						Set R0A = A - P
						! 0B
						If I0B[1] != 0
							Set A = J0B[1]/I0B[1]
						Else
							Set A = 0
						If I0B[2] != 0
							Set P = J0B[2]/I0B[2]
						Else
							Set P = 0
						Set R0B = A - P
						! 0C
						If I0C[1] != 0
							Set A = J0C[1]/I0C[1]
						Else
							Set A = 0
						If I0C[2] != 0
							Set P = J0C[2]/I0C[2]
						Else
							Set P = 0
						Set R0C = A - P
						! 0D
						If I0D[1] != 0
							Set A = J0D[1]/I0D[1]
						Else
							Set A = 0
						If I0D[2] != 0
							Set P = J0D[2]/I0D[2]
						Else
							Set P = 0
						Set R0D = A - P
						! 0E
						If I0E[1] != 0
							Set A = J0E[1]/I0E[1]
						Else
							Set A = 0
						If I0E[2] != 0
							Set P = J0E[2]/I0E[2]
						Else
							Set P = 0
						Set R0E = A - P
						! 0F
						If I0F[1] != 0
							Set A = J0F[1]/I0F[1]
						Else
							Set A = 0
						If I0F[2] != 0
							Set P = J0F[2]/I0F[2]
						Else
							Set P = 0
						Set R0F = A - P
						! 0G
						If I0G[1] != 0
							Set A = J0G[1]/I0G[1]
						Else
							Set A = 0
						If I0G[2] != 0
							Set P = J0G[2]/I0G[2]
						Else
							Set P = 0
						Set R0G = A - P
						! 0H
						If I0H[1] != 0
							Set A = J0H[1]/I0H[1]
						Else
							Set A = 0
						If I0H[2] != 0
							Set P = J0H[2]/I0H[2]
						Else
							Set P = 0
						Set R0H = A - P
						! 0X
						If I0X[1] != 0
							Set A = J0X[1]/I0X[1]
						Else
							Set A = 0
						If I0X[2] != 0
							Set P = J0X[2]/I0X[2]
						Else
							Set P = 0
						Set R01 = A - P
						!
			Function: KOM_RAZR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set G00 = I00[1] - I00[2]
					Set G01 = I01[1] - I01[2]
					Set G02 = I02[1] - I02[2] + G01
					Set G03 = I03[1] - I03[2] + G02
					Set G04 = I04[1] - I04[2] + G03
					Set G05 = I05[1] - I05[2] + G04
					Set G06 = I06[1] - I06[2] + G05
					Set G07 = I07[1] - I07[2] + G06
					Set G0A = I0A[1] - I0A[2] + G07
					Set G0B = I0B[1] - I0B[2] + G0A
					Set G0C = I0C[1] - I0C[2] + G0B
					Set G0D = I0D[1] - I0D[2] + G0C
					Set G0E = I0E[1] - I0E[2] + G0D
					Set G0F = I0F[1] - I0F[2] + G0E
					Set G0G = I0G[1] - I0G[2] + G0F
					Set G0H = I0H[1] - I0H[2] + G0G
					!
					Set G0X = I0X[1] - I0X[2] + G0H
					!
			Function: IK ! Строки-Коефициенты
				Description:
				Returns
				Parameters
					Number: nK
				Static Variables
				Local variables
				Actions
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set PAP = NUMBER_Null
					Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[3] )
					If nK =1
						Set NAME='Коефіцієнт ГЕП'
						If I00[1] != 0
							Set G00 = ( I00[1] - I00[2] )*100 /I00[1]
							!
							Set G01 = ( I01[1] - I01[2] )*100 /I00[1]
							Set G02 = ( I02[1] - I02[2] )*100 /I00[1]
							Set G03 = ( I03[1] - I03[2] )*100 /I00[1]
							Set G04 = ( I04[1] - I04[2] )*100 /I00[1]
							Set G05 = ( I05[1] - I05[2] )*100 /I00[1]
							Set G06 = ( I06[1] - I06[2] )*100 /I00[1]
							Set G07 = ( I07[1] - I07[2] )*100 /I00[1]
							Set G0A = ( I0A[1] - I0A[2] )*100 /I00[1]
							Set G0B = ( I0B[1] - I0B[2] )*100 /I00[1]
							Set G0C = ( I0C[1] - I0C[2] )*100 /I00[1]
							Set G0D = ( I0D[1] - I0D[2] )*100 /I00[1]
							Set G0E = ( I0E[1] - I0E[2] )*100 /I00[1]
							Set G0F = ( I0F[1] - I0F[2] )*100 /I00[1]
							Set G0G = ( I0G[1] - I0G[2] )*100 /I00[1]
							Set G0H = ( I0H[1] - I0H[2] )*100 /I00[1]
							!
							Set G0X = ( I0X[1] - I0X[2] )*100 /I00[1]
					Else If nK = 2
						Set NAME='Кумулятивний розрив'
						Call KOM_RAZR()
					Else If nK = 3
						Set NAME='Кумулятивний Коефіцієнт ГЕП'
						If I00[1] != 0
							Call KOM_RAZR()
							Set G00 = G00*100 /I00[1]
							!
							Set G01 = G01*100 /I00[1]
							Set G02 = G02*100 /I00[1]
							Set G03 = G03*100 /I00[1]
							Set G04 = G04*100 /I00[1]
							Set G05 = G05*100 /I00[1]
							Set G06 = G06*100 /I00[1]
							Set G07 = G07*100 /I00[1]
							Set G0A = G0A*100 /I00[1]
							Set G0B = G0B*100 /I00[1]
							Set G0C = G0C*100 /I00[1]
							Set G0D = G0D*100 /I00[1]
							Set G0E = G0E*100 /I00[1]
							Set G0F = G0F*100 /I00[1]
							Set G0G = G0G*100 /I00[1]
							Set G0H = G0H*100 /I00[1]
							!
							Set G0X = G0X*100 /I00[1]
					Else If nK = 4 and hWndForm.GAP.nPar >=800
						! соотношение процентных активов к процентным пассивам на определеном сроке
						Set NAME='Коефіцієнт RSA/RSL'
						If I00[2] != 0
							Set G00 = I00[1]*100/I00[2]
						!
						If I01[2] != 0
							Set G01 = I01[1]*100/I01[2]
						If I02[2] != 0
							Set G02 = I02[1]*100/I02[2]
						If I03[2] != 0
							Set G03 = I03[1]*100/I03[2]
						If I04[2] != 0
							Set G04 = I04[1]*100/I04[2]
						If I05[2] != 0
							Set G05 = I05[1]*100/I05[2]
						If I06[2] != 0
							Set G06 = I06[1]*100/I06[2]
						If I07[2] != 0
							Set G07 = I07[1]*100/I07[2]
						If I0A[2] != 0
							Set G0A = I0A[1]*100/I0A[2]
						If I0B[2] != 0
							Set G0B = I0B[1]*100/I0B[2]
						If I0C[2] != 0
							Set G0C = I0C[1]*100/I0C[2]
						If I0D[2] != 0
							Set G0D = I0D[1]*100/I0D[2]
						If I0E[2] != 0
							Set G0E = I0E[1]*100/I0E[2]
						If I0F[2] != 0
							Set G0F = I0F[1]*100/I0F[2]
						If I0G[2] != 0
							Set G0G = I0G[1]*100/I0G[2]
						If I0H[2] != 0
							Set G0H = I0H[1]*100/I0H[2]
						!
						If I0X[2] != 0
							Set G0X = I0X[1]*100/I0X[2]
					Call F_Col(G00,G00)
					!
					Call F_Col(G01,G01)
					Call F_Col(G02,G02)
					Call F_Col(G03,G03)
					Call F_Col(G04,G04)
					Call F_Col(G05,G05)
					Call F_Col(G06,G06)
					Call F_Col(G07,G07)
					Call F_Col(G0A,G0A)
					Call F_Col(G0B,G0B)
					Call F_Col(G0C,G0C)
					Call F_Col(G0D,G0D)
					Call F_Col(G0E,G0E)
					Call F_Col(G0F,G0F)
					Call F_Col(G0G,G0G)
					Call F_Col(G0H,G0H)
					!
					Call F_Col(G0X,G0X)
			Function: IAP ! Строка-Итог АКТ(1) или ПАС(2)
				Description:
				Returns
				Parameters
					Number: n
				Static Variables
				Local variables
				Actions
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[n])
					Set PAP=n
					Set NAME= IifS( n=1,'Активи','Пасиви')
					Set G00 = I00[n]
					Set G0X = I0X[n]
					!
					Set G01 = I01[n]
					Set G02 = I02[n]
					Set G03 = I03[n]
					Set G04 = I04[n]
					Set G05 = I05[n]
					Set G06 = I06[n]
					Set G07 = I07[n]
					Set G0A = I0A[n]
					Set G0B = I0B[n]
					Set G0C = I0C[n]
					Set G0D = I0D[n]
					Set G0E = I0E[n]
					Set G0F = I0F[n]
					Set G0G = I0G[n]
					Set G0H = I0H[n]
					If nPar >= 800
						Set R00 = J00[n]
						Set R0X = J0X[n]
						Set R01 = J01[n]
						Set R02 = J02[n]
						Set R03 = J03[n]
						Set R04 = J04[n]
						Set R05 = J05[n]
						Set R06 = J06[n]
						Set R07 = J07[n]
						Set R0A = J0A[n]
						Set R0B = J0B[n]
						Set R0C = J0C[n]
						Set R0D = J0D[n]
						Set R0E = J0E[n]
						Set R0F = J0F[n]
						Set R0G = J0G[n]
						Set R0H = J0H[n]
						Call II()
						! для чутливості нужен массв итогов АКТ-ПАС и массив сред ставок по АКТ и ПАС
			Function: II ! Расчет средних % ставок
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.GAP.nPar >= 800
						If G00 != 0
							Set R00 = R00/G00
						Else
							Set R00 = 0
						!
						If G01 != 0
							Set R01 = R01/G01
						Else
							Set R01 = 0
						If G02 != 0
							Set R02 = R02/G02
						Else
							Set R02 = 0
						If G03 != 0
							Set R03 = R03/G03
						Else
							Set R03 = 0
						If G04 != 0
							Set R04 = R04/G04
						Else
							Set R04 = 0
						If G05 != 0
							Set R05 = R05/G05
						Else
							Set R05 = 0
						If G06 != 0
							Set R06 = R06/G06
						Else
							Set R06 = 0
						If G07 != 0
							Set R07 = R07/G07
						Else
							Set R07 = 0
						If G0A != 0
							Set R0A = R0A/G0A
						Else
							Set R0A = 0
						If G0B != 0
							Set R0B = R0B/G0B
						Else
							Set R0B = 0
						If G0C != 0
							Set R0C = R0C/G0C
						Else
							Set R0C = 0
						If G0D != 0
							Set R0D = R0D/G0D
						Else
							Set R0D = 0
						If G0E != 0
							Set R0E = R0E/G0E
						Else
							Set R0E = 0
						If G0F != 0
							Set R0F = R0F/G0F
						Else
							Set R0F = 0
						If G0G != 0
							Set R0G = R0G/G0G
						Else
							Set R0G = 0
						If G0H != 0
							Set R0H = R0H/G0H
						Else
							Set R0H = 0
						!
						If G0X != 0
							Set R0X = R0X/G0X
						Else
							Set R0X = 0
		Window Parameters
			Number: nnPar !! 700 - вход в ГААР, 702-углубление в баланс, 701 - подробно по счетам
			Number: pPAP
			String: sNBS
			Number: pKV
			String: pTOBO
			Boolean: b0
			Boolean: b1
			Boolean: b2
			Boolean: b3
			Boolean: b4
			Number: A7
			String: pcmb_KV
			Number: pKurs
			String: pcmb_TOBO
			Date/Time: pDat
		Window Variables
			Number: nPar !! 700 - вход в ГААР, 702-углубление в баланс, 701 - подробно по счетам
			Number: nKv
			Number: nPar2
			! Date/Time: bDat
			! Number: nKurs
			Date/Time: dTmp
			Date/Time: dDat
			Number: n980
			String: sTobo 
			String: PROC_NAME
			! Number: nFl
			Number: nRow
			String: sNbs
			String: sNls
			String: sf
			Number: s9
			!
			Number: nCol[*]
			Number: nCol9
			! I01[1] - итог сумм-активов 
			! I01[2] - итог сумм-пассивов
			Number: I0X[*]
			Number: I01[*]
			Number: I02[*]
			Number: I03[*]
			Number: I04[*]
			Number: I05[*]
			Number: I06[*]
			Number: I07[*]
			Number: I0A[*]
			Number: I0B[*]
			Number: I0C[*]
			Number: I0D[*]
			Number: I0E[*]
			Number: I0F[*]
			Number: I0G[*]
			Number: I0H[*]
			Number: I00[*]
			!
			! J01[1] - для расчета середн.зв ставка активов 
			! J01[2] - для расчета середн.зв ставка пассивов
			Number: J0X[*]
			Number: J01[*]
			Number: J02[*]
			Number: J03[*]
			Number: J04[*]
			Number: J05[*]
			Number: J06[*]
			Number: J07[*]
			Number: J0A[*]
			Number: J0B[*]
			Number: J0C[*]
			Number: J0D[*]
			Number: J0E[*]
			Number: J0F[*]
			Number: J0G[*]
			Number: J0H[*]
			Number: J00[*]
			!
			String: sINTO
			String: sSUM
			String: sCR
			String: sDECO
			String: sSql
			String: RNBU_TRACE1
		Message Actions
			On SAM_Create
				Set hWndForm.GAP.nTabInstance = 1
				If RNBU_TRACEX = STRING_Null
					Set RNBU_TRACEX = 'RNBU_TRACE1'
				Set VE = RNBU_TRACEX
				Set nPar =  nnPar
				! Call DebugN(hWndForm.GAP.nPar)
				Set hWndForm.GAP.rb0 = hWndForm.GAP.b0
				Set hWndForm.GAP.rb1 = hWndForm.GAP.b1
				Set hWndForm.GAP.rb2 = hWndForm.GAP.b2
				Set hWndForm.GAP.rb3 = hWndForm.GAP.b3
				Set hWndForm.GAP.rb4 = hWndForm.GAP.b4
				Set hWndForm.GAP.cb_A7 = A7
				Set hWndForm.GAP.n980 = GetBaseVal()
				Set hWndForm.GAP.nCol[1] = SalColorFromRGB( 255,240,255 )
				Set hWndForm.GAP.nCol[2] = SalColorFromRGB( 220,255,255 )
				Set hWndForm.GAP.nCol[3] = SalColorFromRGB( 230,255,230 )
				Set hWndForm.GAP.nCol9 = COLOR_LightGray
				!
				Set RNBU_TRACE1 =
						" from " || VE ||" r1 where fdat=:hWndForm.GAP.dDat AND " ||
						  IifS(hWndForm.GAP.nPar <800, "", " IR is not null AND " )
				! Set hWndForm.GAP.bDat = GetBankDate()
				If hWndForm.GAP.nPar=700 OR hWndForm.GAP.nPar=800
					Call SalEnableWindow( hWndForm.GAP.sDAT )
				Else
					Set hWndForm.GAP.dDat = hWndForm.GAP.pDat
					Set hWndForm.GAP.sDAT = SalFmtFormatDateTime( hWndForm.GAP.dDat, 'dd/MM/yyyy' )
					Call SalDisableWindow( hWndForm.GAP.sDAT )
					Call SalHideWindow( hWndForm.GAP.pbExecute )
					Call SalDisableWindow( hWndForm.GAP.rb1 )
					Call SalDisableWindow( hWndForm.GAP.rb2 )
					Call SalDisableWindow( hWndForm.GAP.rb3 )
					Call SalDisableWindow( hWndForm.GAP.rb4 )
					Call SalDisableWindow( hWndForm.GAP.cb_A7 )
				Set sINTO =
						 " s.PAP,s.G0X,s.G01,s.G02,s.G03,s.G04,s.G05,s.G06,s.G07,s.G0A,s.G0B,s.G0C,
						   s.G0D,s.G0E,s.G0F,s.G0G,s.G0H,s.G00 " ||
						IifS(hWndForm.GAP.nPar < 800, "",
						 ",S.R00,s.R01,s.R02,s.R03,s.R04,s.R05,s.R06,s.R07,s.R0A,s.R0B,s.R0C,
						   s.R0D,s.R0E,s.R0F,s.R0G,s.R0H ") || "
						INTO :hWndForm.GAP.s9, :hWndForm.GAP.NBS,:hWndForm.GAP.NAME,
						  :hWndForm.GAP.PAP,:hWndForm.GAP.G0X,:hWndForm.GAP.G01,
						  :hWndForm.GAP.G02,:hWndForm.GAP.G03,:hWndForm.GAP.G04,:hWndForm.GAP.G05,
						  :hWndForm.GAP.G06,:hWndForm.GAP.G07,:hWndForm.GAP.G0A,:hWndForm.GAP.G0B,
						  :hWndForm.GAP.G0C,:hWndForm.GAP.G0D,:hWndForm.GAP.G0E,:hWndForm.GAP.G0F,
						  :hWndForm.GAP.G0G,:hWndForm.GAP.G0H,:hWndForm.GAP.G00 " ||
						IifS(hWndForm.GAP.nPar < 800, "",
						",:hWndForm.GAP.R00,:hWndForm.GAP.R01,
						  :hWndForm.GAP.R02,:hWndForm.GAP.R03,:hWndForm.GAP.R04,:hWndForm.GAP.R05,
						  :hWndForm.GAP.R06,:hWndForm.GAP.R07,:hWndForm.GAP.R0A,:hWndForm.GAP.R0B,
						  :hWndForm.GAP.R0C,:hWndForm.GAP.R0D,:hWndForm.GAP.R0E,:hWndForm.GAP.R0F,
						  :hWndForm.GAP.R0G,:hWndForm.GAP.R0H ")
				Set sSUM = "Sum(G0X)/100 G0X,
						  Sum(G01)/100 G01, Sum(G02)/100 G02, Sum(G03)/100 G03, Sum(G04)/100 G04,
						  Sum(G05)/100 G05, Sum(G06)/100 G06, Sum(G07)/100 G07, Sum(G0A)/100 G0A,
						  Sum(G0B)/100 G0B, Sum(G0C)/100 G0C, Sum(G0D)/100 G0D, Sum(G0E)/100 G0E,
						  Sum(G0F)/100 G0F, Sum(G0G)/100 G0G, Sum(G0H)/100 G0H, Sum(G00)/100 G00 " ||
						IifS(hWndForm.GAP.nPar < 800, "",
						",Sum(R00)/100 R00, Sum(R0X)/100 R0X, Sum(R01)/100 R01, Sum(R02)/100 R02, 
						  Sum(R03)/100 R03,
						  Sum(R04)/100 R04, Sum(R05)/100 R05, Sum(R06)/100 R06, Sum(R07)/100 R07,
						  Sum(R0A)/100 R0A, Sum(R0B)/100 R0B, Sum(R0C)/100 R0C, Sum(R0D)/100 R0D,
						  Sum(R0E)/100 R0E, Sum(R0F)/100 R0F, Sum(R0G)/100 R0G, Sum(R0H)/100 R0H" )
				Set sDECO = "
						 decode(Substr(kodp,8,1),'1',znap,0) G01, decode(Substr(kodp,8,1),'2',znap,0) G02,
						 decode(Substr(kodp,8,1),'3',znap,0) G03, decode(Substr(kodp,8,1),'4',znap,0) G04,
						 decode(Substr(kodp,8,1),'5',znap,0) G05, decode(Substr(kodp,8,1),'6',znap,0) G06,
						 decode(Substr(kodp,8,1),'7',znap,0) G07, decode(Substr(kodp,8,1),'A',znap,0) G0A,
						 decode(Substr(kodp,8,1),'B',znap,0) G0B, decode(Substr(kodp,8,1),'C',znap,0) G0C,
						 decode(Substr(kodp,8,1),'D',znap,0) G0D, decode(Substr(kodp,8,1),'E',znap,0) G0E,
						 decode(Substr(kodp,8,1),'F',znap,0) G0F, decode(Substr(kodp,8,1),'G',znap,0) G0G,
						 decode(Substr(kodp,8,1),'H',znap,0) G0H, 
						 decode(Substr(kodp,8,1),'0',znap,' ',znap,0) G0X,
						 znap G00 "
				Set sCR =
						" G00,G00*IR R00, G0X,G0X*IR R0X,
						  G01,G01*IR R01, G02,G02*IR R02, G03,G03*IR R03, G04,G04*IR R04, 
						  G05,G05*IR R05, G06,G06*IR R06, G07,G07*IR R07, G0A,G0A*IR R0A, 
						  G0B,G0B*IR R0B, G0C,G0C*IR R0C, G0D,G0D*IR R0D, G0E,G0E*IR R0E, 
						  G0F,G0F*IR R0F, G0G,G0G*IR R0G, G0H,G0H*IR R0H "
				If hWndForm.GAP.nPar < 800
					Call SalHideWindow( hWndForm.GAP.R00 )
					Call SalHideWindow( hWndForm.GAP.R01 )
					Call SalHideWindow( hWndForm.GAP.R02 )
					Call SalHideWindow( hWndForm.GAP.R03 )
					Call SalHideWindow( hWndForm.GAP.R04 )
					Call SalHideWindow( hWndForm.GAP.R05 )
					Call SalHideWindow( hWndForm.GAP.R06 )
					Call SalHideWindow( hWndForm.GAP.R07 )
					Call SalHideWindow( hWndForm.GAP.R0A )
					Call SalHideWindow( hWndForm.GAP.R0B )
					Call SalHideWindow( hWndForm.GAP.R0C )
					Call SalHideWindow( hWndForm.GAP.R0D )
					Call SalHideWindow( hWndForm.GAP.R0E )
					Call SalHideWindow( hWndForm.GAP.R0F )
					Call SalHideWindow( hWndForm.GAP.R0G )
					Call SalHideWindow( hWndForm.GAP.R0H )
					Call SalHideWindow( hWndForm.GAP.R0X )
				Set GAP.strPrintFileName = 'GAP_'||Str(hWndForm.GAP.nPar)
				Call SalTblSetLockedColumns(hWndForm, 5)
				Call SalHideWindow( hWndForm.GAP.dWait )
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call cF.Init('RNBU_TRACE', 'r1')
				Call SalShowWindow( hWndForm.GAP.pbFilter)
				Call SalEnableWindow(pbFilter)
			On SAM_CreateComplete
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				! спросить фильтр
				Set hWndForm.GAP.sf =""
				Set hWndForm.GAP.sf = cF.GetFilterWhereClause(FALSE)
				!
				! По БС
				If hWndForm.GAP.nPar =700 OR hWndForm.GAP.nPar =702
						OR hWndForm.GAP.nPar =800 OR hWndForm.GAP.nPar =802
					Call hWndForm.GAP.I0()
					! Заголовки
					If hWndForm.GAP.nPar =700
						Call SalSetWindowText( hWndForm, SalFmtFormatDateTime( dDat,'dd/MM/yyyy' ) ||'.'||
								"Анализ відповідності АКТ-ПАС "|| hWndForm.GAP.cmb_KV ||" "||hWndForm.GAP.cmb_TOBO )
					Else If hWndForm.GAP.nPar =702
						Set sNls = hWndForm.GAP.sNBS || '%'
						Call SalSetWindowText( hWndForm, SalFmtFormatDateTime( dDat,'dd/MM/yyyy' ) ||'.'||
								"Анализ відповідності АКТ-ПАС по БАЛ.рах."|| hWndForm.GAP.sNls ||" "|| cmb_KV ||" "||cmb_TOBO )
					Else If hWndForm.GAP.nPar =800
						Call SalSetWindowText( hWndForm, SalFmtFormatDateTime( dDat,'dd/MM/yyyy' ) ||'.'||
								"Анализ відпов.проц. АКТ-ПАС "|| hWndForm.GAP.cmb_KV ||" "||hWndForm.GAP.cmb_TOBO )
					Else If hWndForm.GAP.nPar =802
						Set sNls = hWndForm.GAP.sNBS || '%'
						Call SalSetWindowText( hWndForm, SalFmtFormatDateTime( dDat,'dd/MM/yyyy' ) ||'.'||
								"Анализ відпов.проц. АКТ-ПАС по БАЛ.рах."|| hWndForm.GAP.sNls ||" "|| cmb_KV ||" "||cmb_TOBO )
					! Селекты
					If hWndForm.GAP.rb0 ! По "полочкам типа Ф-631"
						If hWndForm.GAP.nPar < 800
							Set sSql =
									"SELECT bs1.PU, bs1.id, bs1.name," || sINTO || " FROM bs1 ,
									 (select r.pap, bs2.id," || sSUM || "
									  from BS2,
									   (select Substr(kodp,1,1) PAP, substr(kodp,2,4) NBS, KV, NBUC," || sDECO ||
									    RNBU_TRACE1 || 
									IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf || " and ") ||
									IifS(hWndForm.GAP.nPar =702, "nls like :hWndForm.GAP.sNls AND ", "" ) ||
									IifS(hWndForm.GAP.cb_A7=1  , "recid is NOT null", " Substr(kodp,2,1)<>'?' " )||
									IifS(hWndForm.GAP.nKv=0    , "", " and KV=:hWndForm.GAP.nKv " )||
									IifS(hWndForm.GAP.sTobo='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.sTobo " ) ||
									 " and (KODP LIKE '191291%' OR KODP not like '19129%')
									        ) r
									  where bs2.nbs=r.nbs and r.pap=decode(nvl(bs2.zn,3), 3, r.pap, bs2.zn)
									Group by r.pap, bs2.id ) s
									 WHERE bs1.id = s.id Order by s.pap, s.id"
						Else
							Set sSql =
									"SELECT bs1.PU, bs1.id, bs1.name," || sINTO || " FROM bs1 ,
									 (select r.pap, bs2.id," || sSUM || "
									  from BS2,
									(SELECT PAP, NBS, "|| sCR || " FROM
									 (select IR,Substr(kodp,1,1) PAP, substr(kodp,2,4) NBS, KV, NBUC," || sDECO ||
									  RNBU_TRACE1 || 
									IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf || " and ") ||
									IifS(hWndForm.GAP.nPar =802, "nls like :hWndForm.GAP.sNls AND ", "" ) ||
									IifS(hWndForm.GAP.cb_A7=1  , "recid is NOT null", " Substr(kodp,2,1)<>'?' " )||
									IifS(hWndForm.GAP.nKv=0    , "", " and KV=:hWndForm.GAP.nKv " )||
									IifS(hWndForm.GAP.sTobo='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.sTobo " ) ||
									 " and (KODP LIKE '191291%' OR KODP not like '19129%')
									  )
									) r
									  where bs2.nbs=r.nbs and r.pap=decode(nvl(bs2.zn,3), 3, r.pap, bs2.zn)
									Group by r.pap, bs2.id ) s
									 WHERE bs1.id = s.id Order by s.pap, s.id"
					Else
						If rb1
							Set sNbs = " Substr(kodp,2,1)||'   ' "
						Else If rb2
							Set sNbs = " Substr(kodp,2,2)||'  ' "
						Else If rb3
							Set sNbs = " Substr(kodp,2,3)||' ' "
						Else If rb4
							Set sNbs = " Substr(kodp,2,4) "
						If hWndForm.GAP.nPar < 800
							Set sSql =
									"SELECT to_number(Substr(p.nbs,1,1)),p.NBS,p.name," || sINTO || "
									 FROM ps p,
									 (select pap, "|| sNbs || " NBS," || sSUM || " from
									 (select Substr(kodp,1,1) PAP, kodp, KV, NBUC,"||sDECO||
									  RNBU_TRACE1 || 
									IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf|| " and ") ||
									IifS(hWndForm.GAP.nPar =702," Substr(kodp,2,4) like :hWndForm.GAP.sNls AND ","") ||
									        IifS(hWndForm.GAP.cb_A7=1," recid is NOT null"," Substr(kodp,2,1)<'6' ") ||
									        IifS(nKv=0,""," and KV=:nKv ") ||
									        IifS(sTobo='*',""," and Nvl(nbuc,'0')=:sTobo ")||" )
									  Group by pap,"|| sNbs ||" ) s
									 WHERE p.nbs = s.nbs  Order by s.pap, s.nbs"
						Else
							Set sSql =
									"SELECT to_number(Substr(p.nbs,1,1)),p.NBS,p.name," || sINTO || "
									 FROM ps p,
									 (select pap, "|| sNbs || " NBS," || sSUM || " from
									(SELECT PAP,KODP, " || sCR || " FROM
									(select Substr(kodp,1,1) PAP, IR, kodp, "|| sDECO ||
									 RNBU_TRACE1 || 
									IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf|| " and ") ||
									IifS(hWndForm.GAP.nPar =802," Substr(kodp,2,4) like :hWndForm.GAP.sNls AND ","") ||
									        IifS(hWndForm.GAP.cb_A7=1," recid is NOT null"," Substr(kodp,2,1)<'6' ") ||
									        IifS(nKv=0,""," and KV=:nKv ") ||
									        IifS(sTobo='*',""," and Nvl(nbuc,'0')=:sTobo ")||" )
									 ) WHERE G00<>0
									  Group by pap,"|| sNbs ||" ) s
									 WHERE p.nbs = s.nbs  Order by s.pap, s.nbs"
					If SalTblPopulate(hWndForm, hSql(), hWndForm.GAP.sSql,TBL_FillAll  )
						Call SalTblDefineSplitWindow(hWndForm, 7, TBL_Split_Adjustable)
						Call IK(4)
						Call IK(3)
						Call IK(2)
						Call IK(1)
						Call IR()
						Call IAP(2) ! - ПАС
						Call IAP(1) ! - АКТ
				! По  ЛС
				Else
					! Set hWndForm.GAP.sf =""
					! Set hWndForm.GAP.sf = cF.GetFilterWhereClause(FALSE)
					Set hWndForm.GAP.sNls = hWndForm.GAP.sNBS || '%'
					Call SalSetWindowText( hWndForm, SalFmtFormatDateTime( dDat,'dd/MM/yyyy' ) ||'.'||
							"Анализ відповідності " || IifS(hWndForm.GAP.nPar =701,"","проц.") ||
							"АКТ-ПАС по ОС.рах."|| hWndForm.GAP.sNls ||" "|| hWndForm.GAP.cmb_KV ||" "||hWndForm.GAP.cmb_TOBO )
					! По  ЛС - АКТ-ПАС
					If hWndForm.GAP.nPar =701 and hWndForm.GAP.rb0
						Set hWndForm.GAP.sSql =
								"SELECT to_number(s.K9),
								 :hWndForm.GAP.sNBS,s.NLS," || sINTO || " FROM
								 (select k9,pap, NLS||'/'||kv||'/'||NBUC nls, " || sSUM || " from
								(select substr(kodp,2,1) K9,Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO ||
								  RNBU_TRACE1 || 
								IifS(hWndForm.GAP.sf="","", hWndForm.GAP.sf||" AND " ) || "
								  substr(kodp,2,4) in (select nbs from bs2 where id=:hWndForm.GAP.sNBS )
								and Substr(kodp,1,1)=:hWndForm.GAP.pPAP and Substr(kodp,2,1)<>'?' "||
								IifS(hWndForm.GAP.pKV=0,    ""," and KV=:hWndForm.GAP.pKV ") ||
								IifS(hWndForm.GAP.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.pTOBO ")||" )
								  Group by k9,pap, NLS||'/'||kv||'/'||NBUC ) s
								 Order by s.pap,s.nls"
					Else If hWndForm.GAP.nPar =701
						Set hWndForm.GAP.sSql =
								"SELECT :hWndForm.GAP.pPAP,:hWndForm.GAP.sNBS,s.NLS," ||
								 sINTO || " FROM
								 (select pap, NLS||'/'||kv||'/'||NBUC nls, " || sSUM || " from
								(select Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO ||
								 RNBU_TRACE1 || 
								IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf|| " and ") || "
								  Substr(kodp,2,4) like :hWndForm.GAP.sNls
								and Substr(kodp,1,1)=:hWndForm.GAP.pPAP
								and Substr(kodp,2,1)<'6' "||
								IifS(hWndForm.GAP.pKV=0,    ""," and KV=:hWndForm.GAP.pKV ") ||
								IifS(hWndForm.GAP.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.pTOBO ")||" )
								  Group by pap,NLS||'/'||kv||'/'||NBUC ) s
								 Order by s.pap,s.nls"
					Else If hWndForm.GAP.nPar =801 AND hWndForm.GAP.rb0
						Set hWndForm.GAP.sSql =
								"SELECT to_number(s.K9),
								 :hWndForm.GAP.sNBS,s.NLS," || sINTO || " FROM
								 (select k9,pap, nls, " || sSUM || "
								  from
								(SELECT K9, PAP, NLS||'/'||kv||'/'||NBUC nls," || sCR || " FROM
								(select IR, substr(kodp,2,1) K9,Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO ||
								 RNBU_TRACE1  || 
								IifS(hWndForm.GAP.sf="","", hWndForm.GAP.sf||" AND " ) || "
								  substr(kodp,2,4) in (select nbs from bs2 where id=:hWndForm.GAP.sNBS )
								and Substr(kodp,1,1)=:hWndForm.GAP.pPAP and Substr(kodp,2,1)<>'?' "||
								IifS(hWndForm.GAP.pKV=0,    ""," and KV=:hWndForm.GAP.pKV ") ||
								IifS(hWndForm.GAP.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.pTOBO ")||" )
								) WHERE G00<>0
								  Group by k9,pap, NLS ) s
								 Order by s.pap,s.nls"
					Else If hWndForm.GAP.nPar =801
						Set hWndForm.GAP.sSql =
								"SELECT :hWndForm.GAP.pPAP,:hWndForm.GAP.sNBS,s.NLS," ||
								 sINTO || " FROM
								 (select pap, nls, " || sSUM || "
								  from
								(SELECT PAP , NLS||'/'||kv||'/'||NBUC nls, " || sCR || " FROM
								 (select IR, Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO ||
								  RNBU_TRACE1 || 
								IifS(hWndForm.GAP.sf="","",hWndForm.GAP.sf|| " and ") || "
								  Substr(kodp,2,4) like :hWndForm.GAP.sNls
								 and Substr(kodp,1,1)=:hWndForm.GAP.pPAP
								 and Substr(kodp,2,1)<'6' "||
								 IifS(hWndForm.GAP.pKV=0,    ""," and KV=:hWndForm.GAP.pKV ") ||
								 IifS(hWndForm.GAP.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.GAP.pTOBO ")||" )
								) WHERE G00<>0
								  Group by pap,NLS ) s
								 Order by s.pap,s.nls"
					If SalTblPopulate(hWndForm, hSql(), hWndForm.GAP.sSql, TBL_FillAll  )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				! Пересчет в номинал для инвалюты
				If hWndForm.GAP.nKv != 0 and
						   hWndForm.GAP.nKv != n980 and
						   hWndForm.GAP.nKv != NUMBER_Null
					Set hWndForm.GAP.G0X = hWndForm.GAP.G0X / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G01 = hWndForm.GAP.G01 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G02 = hWndForm.GAP.G02 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G03 = hWndForm.GAP.G03 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G04 = hWndForm.GAP.G04 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G05 = hWndForm.GAP.G05 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G06 = hWndForm.GAP.G06 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G07 = hWndForm.GAP.G07 / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0A = hWndForm.GAP.G0A / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0B = hWndForm.GAP.G0B / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0C = hWndForm.GAP.G0C / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0D = hWndForm.GAP.G0D / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0E = hWndForm.GAP.G0E / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0F = hWndForm.GAP.G0F / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G0H = hWndForm.GAP.G0H / hWndForm.GAP.nKurs
					Set hWndForm.GAP.G00 = hWndForm.GAP.G00 / hWndForm.GAP.nKurs
					If hWndForm.GAP.nPar >= 800
						Set hWndForm.GAP.R01 = hWndForm.GAP.R01 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R02 = hWndForm.GAP.R02 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R03 = hWndForm.GAP.R03 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R04 = hWndForm.GAP.R04 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R05 = hWndForm.GAP.R05 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R06 = hWndForm.GAP.R06 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R07 = hWndForm.GAP.R07 / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0A = hWndForm.GAP.R0A / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0B = hWndForm.GAP.R0B / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0C = hWndForm.GAP.R0C / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0D = hWndForm.GAP.R0D / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0E = hWndForm.GAP.R0E / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0F = hWndForm.GAP.R0F / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R0H = hWndForm.GAP.R0H / hWndForm.GAP.nKurs
						Set hWndForm.GAP.R00 = hWndForm.GAP.R00 / hWndForm.GAP.nKurs
				! Накопление итогов
				If hWndForm.GAP.nPar =700 OR hWndForm.GAP.nPar =702
						OR hWndForm.GAP.nPar =800 OR hWndForm.GAP.nPar =802
					Call hWndForm.GAP.IG()
				Else If hWndForm.GAP.nPar =701 OR hWndForm.GAP.nPar =801
					Set hWndForm.GAP.NBS = hWndForm.GAP.sNBS
				Call XSalTblSetRowBackColor( hWndForm, lParam, hWndForm.GAP.nCol[hWndForm.GAP.PAP])
				If hWndForm.GAP.s9=9
					Call XSalTblSetCellBackColor( hWndForm.GAP.NAME,hWndForm.GAP.nCol9 )
					Call XSalTblSetCellBackColor( hWndForm.GAP.PAP, hWndForm.GAP.nCol9 )
					Call XSalTblSetCellBackColor( hWndForm.GAP.NBS, hWndForm.GAP.nCol9 )
				! Расчет средних % ставок
				Call II()
			On SAM_DoubleClick
				If hWndForm.GAP.nPar < 800
					Set hWndForm.GAP.nPar2 = 702
				Else
					Set hWndForm.GAP.nPar2 = 802
				If hWndForm.GAP.rb1
					Call SalCreateWindow( GAP, hWndMDI, hWndForm.GAP.nPar2, hWndForm.GAP.PAP,
							SalStrTrimX(hWndForm.GAP.NBS), hWndForm.GAP.nKv, hWndForm.GAP.sTobo,
							FALSE,FALSE,TRUE,FALSE,FALSE,
							hWndForm.GAP.cb_A7, hWndForm.GAP.cmb_KV, hWndForm.GAP.nKurs,
							hWndForm.GAP.cmb_TOBO,hWndForm.GAP.dDat )
				Else If hWndForm.GAP.rb2
					Call SalCreateWindow( GAP, hWndMDI, hWndForm.GAP.nPar2, hWndForm.GAP.PAP,
							SalStrTrimX(hWndForm.GAP.NBS), hWndForm.GAP.nKv, hWndForm.GAP.sTobo,
							FALSE,FALSE,FALSE,TRUE,FALSE,
							hWndForm.GAP.cb_A7, hWndForm.GAP.cmb_KV, hWndForm.GAP.nKurs,
							 hWndForm.GAP.cmb_TOBO , hWndForm.GAP.dDat)
				Else If hWndForm.GAP.rb3
					Call SalCreateWindow( GAP, hWndMDI, hWndForm.GAP.nPar2, hWndForm.GAP.PAP,
							SalStrTrimX(hWndForm.GAP.NBS), hWndForm.GAP.nKv, hWndForm.GAP.sTobo,
							FALSE,FALSE,FALSE,FALSE,TRUE,
							hWndForm.GAP.cb_A7, hWndForm.GAP.cmb_KV, hWndForm.GAP.nKurs,
							hWndForm.GAP.cmb_TOBO,hWndForm.GAP.dDat )
	! cGenericTable: TRA	!! Трансф.цены Устарелая версия
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Анализ відповідності АКТ-ПАС в розрізі рахунків
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.413"
				Top:    0.24"
				Width:  16.15"
				Width Editable? Yes
				Height: 6.464"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? No
.end
		                                                                                     Description: 
		                                                                                     Named Menus 
		                                                                                     Menu 
		                                                                                     Tool Bar 
			                                                                                     Contents 
				                                                                                     Pushbutton: pbIns
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbDel
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbRefresh
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbUpdate
					                                                                                     Message Actions 
				                                                                                     Line 
				                                                                                     Pushbutton: pbSearch
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbFilter
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbDetails
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbPrint
					                                                                                     Message Actions 
				                                                                                     Line 
				                                                                                     Pushbutton: pbExit
					                                                                                     Message Actions 
				                                                                                     Line 
				!
				                                                                                     Data Field: DAT1
					                                                                                     Message Actions 
						                                                                                     On SAM_TooltipSetText
							                                                                                     Return XSalTooltipSetText( lParam, 'Дата початку періоду розрахунку')
						                                                                                     On SAM_Validate
							                                                                                     Call F_DAT()
				                                                                                     Data Field: DAT2
					                                                                                     Message Actions 
						                                                                                     On SAM_TooltipSetText
							                                                                                     Return XSalTooltipSetText( lParam, 'Дата завершення періоду розрахунку')
						                                                                                     On SAM_Validate
							                                                                                     Call F_DAT()
				                                                                                     Radio Button: rb0
					                                                                                     Message Actions 
						                                                                                     On SAM_Click
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                     Radio Button: rb1
					                                                                                     Message Actions 
						                                                                                     On SAM_Click
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                     Radio Button: rb2
					                                                                                     Message Actions 
						                                                                                     On SAM_Click
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                     Radio Button: rb3
					                                                                                     Message Actions 
						                                                                                     On SAM_Click
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                     Radio Button: rb4
					                                                                                     Message Actions 
						                                                                                     On SAM_Click
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                     Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					                                                                                     List Initialization 
					                                                                                     Message Actions 
						                                                                                     On SAM_Create
							                                                                                     If nPar=701
								                                                                                     Call SalDisableWindow( cmb_KV )
								                                                                                     Set cmb_KV = pcmb_KV
								                                                                                     Set nKurs = pKurs
							                                                                                     Else 
								                                                                                     Set nKv = 0
								                                                                                     Call cmb_KV.Init(hWndItem)
								                                                                                     Call cmb_KV.Populate(hSql(),
										"KV","substr('   '||SKV,-3)||'.'||LCV||'/'||NAME","TABVAL",
										" where  D_CLOSE is null union all select  0 , '  */Консолідовано по вал' from dual
										 ORDER BY 2 ")
								                                                                                     Call SalListSetSelect(cmb_KV,0)
						                                                                                     On SAM_Click
							                                                                                     Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							                                                                                     If nKv = 0 or nKv=n980
								                                                                                     Set nKurs = 1
							                                                                                     Else 
								                                                                                     If SqlPrepareAndExecute( hSql(),
										"SELECT RATE_O/BSUM into :hWndForm.TRA.nKurs from cur_rates c
										 where c.KV=:hWndForm.TRA.nKv and (c.kv,c.vdate) =
										(select kv,max(vdate) from cur_rates
										 where kv=c.KV and vdate<=:hWndForm.TRA.DAT2 group by kv) " )
										 and SqlFetchNext( hSql(), nFetchRes )
				                                                                                     Data Field: nKurs
					                                                                                     Message Actions 
				                                                                                     Combo Box: cmb_TOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					                                                                                     List Initialization 
					                                                                                     Message Actions 
						                                                                                     On SAM_Create
							                                                                                     If nPar=701
								                                                                                     Call SalDisableWindow( cmb_TOBO )
								                                                                                     Set cmb_TOBO = pcmb_TOBO
							                                                                                     Else 
								                                                                                     Set sTobo = '*'
								                                                                                     Call cmb_TOBO.Init(hWndItem)
								                                                                                     Call cmb_TOBO.Populate(hSql(),
										"TOBO","TOBO||'/'||NAME","TOBO",
										" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
										 ORDER BY 1")
								                                                                                     Call SalListSetSelect(cmb_TOBO,0)
						                                                                                     On SAM_Click
							                                                                                     Set sTobo =cmb_TOBO.GetKey(SalListQuerySelection(hWndItem))
				                                                                                     Data Field: dWait
					                                                                                     Message Actions 
				                                                                                     Pushbutton: pbExecute
					                                                                                     Message Actions 
						                                                                                     On SAM_Create
							                                                                                     Set strTip = 'Виконати Розрахунок (м.б. довго)'
						                                                                                     On SAM_Click
							                                                                                     Call SalWaitCursor(TRUE)
							                                                                                     Call SalShowWindow( hWndForm.TRA.dWait )
							                                                                                     Set dWait = "Зачекайте, Виконується розрахунок по реальним і трансф.цінам "
							                                                                                     If SqlPLSQLCommand( hSql(), "Bars.ANI( 3, DAT1, DAT2 )" )
							                                                                                     Set dWait = ""
							                                                                                     Call SalHideWindow( hWndForm.TRA.dWait )
							                                                                                     Call SalWaitCursor(FALSE)
							                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		                                                                                     Contents 
			                                                                                     Column: PAP
				                                                                                     List Values 
				                                                                                     Message Actions 
			                                                                                     Column: NBS
				                                                                                     List Values 
				                                                                                     Message Actions 
					                                                                                     On SAM_SetFocus
						                                                                                     Set sTmpE = NBS
					                                                                                     On SAM_AnyEdit
						                                                                                     Set NBS = sTmpE
						                                                                                     Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			                                                                                     Column: NAME
				                                                                                     List Values 
				                                                                                     Message Actions 
			                                                                                     Column: RE
				                                                                                     List Values 
				                                                                                     Message Actions 
			!
			                                                                                     Column: SR
				                                                                                     List Values 
				                                                                                     Message Actions 
			                                                                                     Column: ST
				                                                                                     List Values 
				                                                                                     Message Actions 
			                                                                                     Column: RT
				                                                                                     List Values 
				                                                                                     Message Actions 
			!
			! cColumnLabeled: IR
				                                                                                                                                                                                                                                                       List Values
				                                                                                                                                                                                                                                                       Message Actions
			! cColumnLabeled: IT
				                                                                                                                                                                                                                                                       List Values
				                                                                                                                                                                                                                                                       Message Actions
			! cColumnLabeled: IT
				                                                                                                                                                                                                                                                       List Values
				                                                                                                                                                                                                                                                       Message Actions
		                                                                                     Functions 
			                                                                                     Function: F_Col
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
					                                                                                     Window Handle: hW
					                                                                                     Number: nW
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     If nW >0
						                                                                                     Call XSalTblSetCellBackColor( hW, nCol[2] )
					                                                                                     Else If nW <0
						                                                                                     Call XSalTblSetCellBackColor( hW, nCol[1] )
			                                                                                     Function: I0
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     Set I01[1] = 0
					                                                                                     Set I02[1] = 0
					                                                                                     Set I03[1] = 0
					                                                                                     Set I04[1] = 0
					                                                                                     Set I01[2] = 0
					                                                                                     Set I02[2] = 0
					                                                                                     Set I03[2] = 0
					                                                                                     Set I04[2] = 0
			                                                                                     Function: IG
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     Set I01[PAP] = I01[PAP] + RE
					                                                                                     Set I02[PAP] = I02[PAP] + SR
					                                                                                     Set I03[PAP] = I03[PAP] + ST
					                                                                                     Set I04[PAP] = I04[PAP] + RT
			                                                                                     Function: IR
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					                                                                                     Call SalTblFetchRow(hWndForm, nRow )
					                                                                                     Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					                                                                                     Set PAP = NUMBER_Null
					                                                                                     Set NAME='Різниця'
					                                                                                     Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[3] )
					                                                                                     Set RE = I01[2] - I01[1]
					                                                                                     Set SR = I02[2] - I02[1]
					                                                                                     Set ST = I03[2] - I03[1]
					                                                                                     Set RT = I04[2] - I04[1]
					                                                                                     Call F_Col(RE,RE)
					                                                                                     Call F_Col(SR,SR)
					                                                                                     Call F_Col(ST,ST)
					                                                                                     Call F_Col(RT,RT)
			                                                                                     Function: IP
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					                                                                                     Call SalTblFetchRow(hWndForm, nRow )
					                                                                                     Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					                                                                                     Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[2])
					                                                                                     Set PAP=2
					                                                                                     Set NAME='Пасиви'
					                                                                                     Set RE = I01[2]
					                                                                                     Set SR = I02[2]
					                                                                                     Set ST = I03[2]
					                                                                                     Set RT = I04[2]
			                                                                                     Function: IA
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					                                                                                     Call SalTblFetchRow(hWndForm, nRow )
					                                                                                     Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					                                                                                     Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[1])
					                                                                                     Set PAP=1
					                                                                                     Set NAME='Активи'
					                                                                                     Set RE = I01[1]
					                                                                                     Set SR = I02[1]
					                                                                                     Set ST = I03[1]
					                                                                                     Set RT = I04[1]
			                                                                                     Function: F_DAT
				                                                                                     Description: 
				                                                                                     Returns 
				                                                                                     Parameters 
				                                                                                     Static Variables 
				                                                                                     Local variables 
				                                                                                     Actions 
					                                                                                     If DAT1 > DAT2
						                                                                                     Call SalMessageBox(
								"Дата Початку НЕ може бути більшою Дати завершення !",
								"Увага, помилка !", MB_IconStop)
						                                                                                     Set hWndForm.TRA.DAT2 = GetBankDate() - 1
						                                                                                     Set hWndForm.TRA.DAT1 = AddMonths( hWndForm.TRA.DAT2, -1 ) + 1
		                                                                                     Window Parameters 
			                                                                                     Number: nPar
			                                                                                     Number: pPAP
			                                                                                     String: sNBS
			                                                                                     Number: pKV
			                                                                                     String: pTOBO
			                                                                                     Boolean: b0
			                                                                                     Boolean: b1
			                                                                                     Boolean: b2
			                                                                                     Boolean: b3
			                                                                                     Boolean: b4
			                                                                                     String: pcmb_KV
			                                                                                     Number: pKurs
			                                                                                     String: pcmb_TOBO
		                                                                                     Window Variables 
			                                                                                     Number: nKv
			! Number: nKurs
			                                                                                     Date/Time: dTmp
			                                                                                     Number: n980
			                                                                                     String: sTobo
			                                                                                     String: sTmpE
			                                                                                     String: sTmp
			! Number: nFl
			                                                                                     Number: nRow
			                                                                                     String: sNbs
			                                                                                     String: sNls
			!
			                                                                                     Number: nCol[*]
			                                                                                     Number: I01[*]
			                                                                                     Number: I02[*]
			                                                                                     Number: I03[*]
			                                                                                     Number: I04[*]
			!
			                                                                                     String: sINTO
			                                                                                     String: sSUM
			                                                                                     String: sDECO
			                                                                                     String: sSql
		                                                                                     Message Actions 
			                                                                                     On SAM_Create
				                                                                                     Set hWndForm.TRA.nTabInstance = 1
				                                                                                     Set hWndForm.TRA.rb0 = hWndForm.TRA.b0
				                                                                                     Set hWndForm.TRA.rb1 = hWndForm.TRA.b1
				                                                                                     Set hWndForm.TRA.rb2 = hWndForm.TRA.b2
				                                                                                     Set hWndForm.TRA.rb3 = hWndForm.TRA.b3
				                                                                                     Set hWndForm.TRA.rb4 = hWndForm.TRA.b4
				                                                                                     Set hWndForm.TRA.n980 = GetBaseVal()
				                                                                                     Set hWndForm.TRA.nCol[1] = SalColorFromRGB( 255,240,255 )
				                                                                                     Set hWndForm.TRA.nCol[2] = SalColorFromRGB( 220,255,255 )
				                                                                                     Set hWndForm.TRA.nCol[3] = SalColorFromRGB( 230,255,230 )
				                                                                                     Set TRA.strPrintFileName = 'TRA_'||Str(hWndForm.TRA.nPar)
				                                                                                     Call SalTblSetLockedColumns(hWndForm, 4)
				                                                                                     Call SalHideWindow( hWndForm.TRA.dWait )
				                                                                                     If hWndForm.TRA.nPar=711
					                                                                                     Call SalHideWindow( hWndForm.TRA.pbExecute )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.rb1 )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.rb2 )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.rb3 )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.rb4 )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.DAT1 )
					                                                                                     Call SalDisableWindow( hWndForm.TRA.DAT2 )
				                                                                                     Else 
					                                                                                     Set hWndForm.TRA.DAT2 = GetBankDate() - 1
					                                                                                     Set hWndForm.TRA.DAT1 = AddMonths( hWndForm.TRA.DAT2, -1 ) + 1
				                                                                                     Set sINTO = " s.PAP, s.RE,s.SR,s.ST INTO
						 :hWndForm.TRA.NBS,:hWndForm.TRA.NAME,:hWndForm.TRA.PAP,:hWndForm.TRA.RE,
						 :hWndForm.TRA.SR,:hWndForm.TRA.ST"
				                                                                                     Set sSUM = " Sum(RE)/100 RE, Sum(SR)/100 SR, Sum(ST)/100 ST "
				                                                                                     Set sDECO= " decode(Substr(kodp,2,1),'1',ref,0) RE,
						 decode(Substr(kodp,2,1),'0',znap,0) SR, decode(Substr(kodp,2,1),'1',znap,0) ST "
				                                                                                     Call SalSendClassMessage(SAM_Create, 0, 0)
			                                                                                     On SAM_CreateComplete
				                                                                                     Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			                                                                                     On UM_Populate
				                                                                                     Call SalWaitCursor(TRUE)
				                                                                                     If nPar =710
					                                                                                     Call I0()
					                                                                                     Call SalSetWindowText( hWndForm,
							"Реальнi та трансфернi цiни на проц.АКТ-ПАС "|| cmb_KV ||" "||cmb_TOBO )
					!
					                                                                                     If rb0
						                                                                                     Set sSql =
								"SELECT bs1.id, bs1.name," || sINTO || " FROM bs1 ,
								 (select r.pap, bs2.id," || sSUM || "
								  from (select Substr(kodp,1,1) PAP, substr(kodp,3,4) NBS, KV, NBUC," || sDECO || "
								        from RNBU_TRACE   where Substr(kodp,3,1)<'6' "||
								         IifS(nKv=0,""," and KV=:nKv ")||
								         IifS(sTobo='*',""," and Nvl(nbuc,'0')=:sTobo ")||"
								        ) r, bs2
								  where bs2.nbs=r.nbs
								  Group by r.pap, bs2.id ) s
								 WHERE bs1.id = s.id
								 Order by s.pap, s.id"
					                                                                                     Else 
						                                                                                     If rb1
							                                                                                     Set sNbs = " Substr(kodp,3,1)||'   ' "
						                                                                                     Else If rb2
							                                                                                     Set sNbs = " Substr(kodp,3,2)||'  ' "
						                                                                                     Else If rb3
							                                                                                     Set sNbs = " Substr(kodp,3,3)|| ' ' "
						                                                                                     Else If rb4
							                                                                                     Set sNbs = " Substr(kodp,3,4) "
						                                                                                     Set sSql =
								"SELECT p.NBS,p.name," || sINTO || " FROM ps p,
								 (select pap, "|| sNbs || " NBS," || sSUM || "
								  from (select Substr(kodp,1,1) PAP, kodp, KV, NBUC," || sDECO || " FROM RNBU_TRACE
								        where Substr(kodp,3,1)<'6' "||
								         IifS(nKv=0,""," and KV=:nKv ")||IifS(sTobo='*',""," and Nvl(nbuc,'0')=:sTobo ")||" )
								  Group by pap,"|| sNbs ||" ) s
								 WHERE p.nbs = s.nbs  Order by s.pap, s.nbs"
					                                                                                     If SalTblPopulate(hWndForm, hSql(), sSql,TBL_FillAll  )
						                                                                                     Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
						                                                                                     Call IR()
						                                                                                     Call IP()
						                                                                                     Call IA()
				                                                                                     Else If nPar =711
					                                                                                     Set sNls = hWndForm.TRA.sNBS || '%'
					                                                                                     Call SalSetWindowText( hWndForm,
							"Реальнi та трансфернi цiни на проц.АКТ-ПАС рах."|| hWndForm.TRA.sNls ||" "|| cmb_KV ||" "||cmb_TOBO )
					                                                                                     If rb0
						                                                                                     Set sSql =
								"SELECT :hWndForm.TRA.sNBS,s.NLS," || sINTO || " FROM
								 (select pap, NLS, " || sSUM || "
								  from (select Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO || " FROM RNBU_TRACE
								 where substr(kodp,3,4) in (select nbs from bs2 where id=:hWndForm.TRA.sNBS )
								and   Substr(kodp,1,1)=:hWndForm.TRA.pPAP
								          and Substr(kodp,3,1)<'6' "||
								         IifS(hWndForm.TRA.pKV=0,    ""," and KV=:hWndForm.TRA.pKV ") ||
								         IifS(hWndForm.TRA.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.TRA.pTOBO ")||" )
								  Group by pap,NLS ) s  Order by s.pap,s.nls"
					                                                                                     Else 
						                                                                                     Set sSql =
								"SELECT :hWndForm.TRA.sNBS,s.NLS," || sINTO || " FROM
								 (select pap, NLS, " || sSUM || "
								  from (select Substr(kodp,1,1) PAP, NLS, KV, NBUC," || sDECO || " FROM RNBU_TRACE
								        where nls like :hWndForm.TRA.sNls
								and   Substr(kodp,1,1)=:hWndForm.TRA.pPAP
								and Substr(kodp,3,1)<'6' "||
								         IifS(hWndForm.TRA.pKV=0,    ""," and KV=:hWndForm.TRA.pKV ") ||
								         IifS(hWndForm.TRA.pTOBO='*',""," and Nvl(nbuc,'0')=:hWndForm.TRA.pTOBO ")||" )
								  Group by pap,NLS ) s  Order by s.pap,s.nls"
					                                                                                     If SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll  )
				                                                                                     Call SalWaitCursor(FALSE)
			                                                                                     On SAM_FetchRowDone
				                                                                                     Set RT = SR - ST
				                                                                                     If nKv != 0 and nKv != n980
					                                                                                     Set RE = RE / nKurs
					                                                                                     Set SR = SR / nKurs
					                                                                                     Set ST = ST / nKurs
					                                                                                     Set RT = RT / nKurs
				                                                                                     If nPar =710
					                                                                                     Call IG()
				                                                                                     Else If nPar =711
					                                                                                     Set hWndForm.TRA.NBS = hWndForm.TRA.sNBS
				                                                                                     Call XSalTblSetRowBackColor( hWndForm, lParam, nCol[PAP])
			                                                                                     On SAM_DoubleClick
				                                                                                     If nPar = 710 and NBS != '5   '
					                                                                                     Call SalCreateWindow
							( TRA, hWndMDI, 711, PAP,
							SalStrTrimX( NBS),nKv, sTobo, rb0,rb1,rb2,rb3,rb4, cmb_KV, nKurs, cmb_TOBO )
				                                                                                     If nPar = 711
					                                                                                     Set sTmp = " a.nls like '" || hWndForm.TRA.NBS ||"%'"
					                                                                                     Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
	Table Window: FS !! FSC-1_C Реєстр проводок 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: FSC: Реєстр консолідованих проводок в 1_C 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.476"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43667
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43668
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43669
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Звітна дата')
						On SAM_Validate
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати вигрузку в '||sKatalog||'\KP<yymmdd>.DBF '
						On SAM_Click
							Call F_DBF()
		Contents
			Column: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						проводу
				Visible? No
				Editable? No
				Maximum Data Length: 10
				Data Type: Date/Time
				Justify: Center
				Width:  1.533"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						док
				Visible? Class Default
				Editable? No
				Maximum Data Length: 10
				Data Type: String
				Justify: Left
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид
						док
				Visible? No
				Editable? No
				Maximum Data Length: 10
				Data Type: Number
				Justify: Left
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дебет
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRC_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: БРАНЧ
						Деб-рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кредит
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRC_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: БРАНЧ
						Кред-рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума 
						документу
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NMS_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						Дебет-рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRN_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва БРАНЧ
						Деб-рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						Кредит-рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRN_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва БРАНЧ
						Кред-рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Призначення
						платежу
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  6.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PROD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						субпродукта
				Visible? Yes
				Editable? No
				Maximum Data Length: 100
				Data Type: String
				Justify: Left
				Width:  2.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			!
		Functions
			Function: F_DBF
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sFile
					Number: nRow
				Actions
					Set sFile = sKatalog||'\KP'||SalFmtFormatDateTime( DAT, "yyMMdd" )
					If SqlPrepareAndExecute( hSql(),  "delete from TMP_VPKLB" )
							 and SqlPrepare(hSql(), 
							"insert into TMP_VPKLB 
							 ( S, ND, NAZN, VOB, DATD, NLS_D, NMS_D, BRC_D, BRN_D, 
							                           NLS_K, NMS_K, BRC_K, BRN_K, PROD)
							  values
							 (:S,:ND,:NAZN,:VOB,:DATD,:NLS_D,:NMS_D,:BRC_D,:BRN_D,
							                          :NLS_K,:NMS_K,:BRC_K,:BRN_K, :PROD) " ) 
							and SalTblDoInserts(hWndForm, hSql(), TRUE)
						Call ExportCatQuery(nZapros,
								sFile, 
								nKod,
								"",
								TRUE)
						Call SalMessageBox( "Файл "|| sFile || " сформовано !" , 'Увага ! ', MB_Ok )
						Return TRUE
					!
					Call SalMessageBox("Файл "|| sFile || " НЕ сформовано !",
							'Помилка ! ', MB_IconStop)
					Return FALSE
		Window Parameters
			Number: nKod ! 1 -DOS-кодировка, 2-WIN-кодировка
			Number: nZapros ! Код запроса
			String: strPar01
			String: strPar02
		Window Variables
			String: sSql
			String: sDat
			String: sKatalog
			Number: nKol
		Message Actions
			On SAM_Create
				Set FS.strPrintFileName = '1C'
				If SqlPrepareAndExecute( hSql(),
						"select trim(namef) into :sKatalog 
						 from zapros  where kodz=:nZapros  " )
						and NOT SqlFetchNext(hSql(),nFetchRes)
					Set sKatalog = ""
				Call SalTblSetLockedColumns(hWndForm, 8 )
				Set DAT = GetBankDate()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set nKol = 0
				Set sDat = SalFmtFormatDateTime( DAT, 'dd/MM/yyyy' )
				! Set sSql =
						"SELECT t.NAME,sd.nls_1c NLS_D, substr(sd.name,1,38) NMS_D, 
						        bd.BRANCH BRC_D, bd.name              BRN_D,
						        sk.nls_1c NLS_K, substr(sk.name,1,38) NMS_K,
						        bk.BRANCH BRC_K, bk.name              BRN_K,
						        b.PROD,  SUM(b.S)/100 S 
						 INTO :FS.NAZN,
						      :FS.NLS_D, :FS.NMS_D, :FS.BRC_D, :FS.BRN_D, 
						      :FS.NLS_K, :FS.NMS_K, :FS.BRC_K, :FS.BRN_K, 
						      :FS.PROD,  :FS.S 
						 FROM (SELECT d1.TT,d2.branch BRANCHD, d2.nbs NBSD, 
						              k2.branch BRANCHK, k2.nbs NBSK, 
						              substr(GET_CCKACC_PRODUCT(d1.acc),1,100) PROD,
						              sum(k1.s) S
						       FROM  opldok d1, opldok k1, accounts d2, accounts k2 
						       WHERE d1.sos=5 AND d1.REF=k1.REF AND d1.acc =d2.acc 
						         AND d1.dk =0 AND k1.acc=k2.acc AND d1.stmt=k1.stmt  
						         AND k1.dk =1 AND d1.s  = k1.s  
						         AND d1.fdat=:DAT
						       GROUP by d1.TT,d2.branch,d2.nbs, k2.branch,k2.nbs,
						                 substr(GET_CCKACC_PRODUCT(d1.acc),1,100)
						       ) b,  
						      ps_ps2 pd, ps_ps2 pk,  
						      ps2    sd, ps2    sk, 
						      branch bd, branch bk, tts t
						 WHERE t.tt=b.TT 
						   and b.nbsd=pd.nbs and pd.nbs2=sd.nbs2 and b.BRANCHk=bk.branch 
						   and b.nbsk=pk.nbs and pk.nbs2=sk.nbs2 and b.BRANCHd=bd.branch
						 GROUP by t.NAME,sd.nls_1c, substr(sd.name,1,38) , 
						          bd.BRANCH, bd.name              ,
						          sk.nls_1c, substr(sk.name,1,38) ,
						          bk.BRANCH, bk.name , b.PROD     
						 ORDER by bd.BRANCH, bk.BRANCH, sd.nls_1c, sk.nls_1c "
				Set sSql =
						"SELECT t.NAME, 
						  sd.nls_1c NLS_D, substr(sd.name,1,38) NMS_D, bd.BRANCH BRC_D, bd.name BRN_D,
						  sk.nls_1c NLS_K, substr(sk.name,1,38) NMS_K, bk.BRANCH BRC_K, bk.name BRN_K,
						  x.PROD,  SUM(x.S)/100 S 
						 INTO :FS.NAZN, :FS.NLS_D, :FS.NMS_D, :FS.BRC_D, :FS.BRN_D, 
						                :FS.NLS_K, :FS.NMS_K, :FS.BRC_K, :FS.BRN_K, :FS.PROD, :FS.S 
						 FROM (SELECT B.TT, B.PROD, SUM(B.S) s, 
						         B.BRANCHD, NVL(b.NBS2d,PD.NBS2) NBS2D, B.BRANCHK, NVL(b.NBS2k,Pk.NBS2) NBS2K
						       FROM (SELECT d1.TT,substr(GET_CCKACC_PRODUCT(d1.acc),1,100) PROD, sum(k1.s) S, 
						               d2.branch BRANCHD, d2.nbs NBSD, d2.NBS2 NBS2d, k2.branch BRANCHK, k2.nbs NBSK, k2.NBS2 NBS2k
						             FROM  opldok d1, opldok k1, accounts d2, accounts k2 
						             WHERE d1.sos=5 AND d1.REF=k1.REF AND d1.acc =d2.acc AND d1.dk =0 
						               AND k1.acc=k2.acc AND d1.stmt=k1.stmt AND k1.dk =1 AND d1.fdat=:DAT               
						             GROUP by d1.TT, substr(GET_CCKACC_PRODUCT(d1.acc),1,100),
						               d2.branch, d2.nbs, d2.nbs2, k2.branch, k2.nbs, k2.nbs2                     
						           ) b, ps_ps2 pd, ps_ps2 pk
						       WHERE b.nbsd=pd.nbs and b.nbsk=pk.nbs 
						       group BY B.TT, B.PROD, B.BRANCHD, NVL(b.NBS2d,PD.NBS2), B.BRANCHK, NVL(b.NBS2k,Pk.NBS2)
						      ) X ,  ps2    sd, ps2    sk,  branch bd, branch bk, tts t
						WHERE t.tt=X.TT and X.NBS2d = sd.nbs2 AND X.BRANCHd=bd.branch and X.NBS2k = sK.nbs2 AND x.BRANCHk=bk.branch 
						GROUP by t.NAME, sd.nls_1c, substr(sd.name,1,38), bd.BRANCH, bd.name,
						                 sk.nls_1c, substr(sk.name,1,38), bk.BRANCH, bk.name, x.PROD  
						ORDER by bd.BRANCH, bk.BRANCH, sd.nls_1c, sk.nls_1c "
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set nKol = nKol +1 
				Set ND='ЦКС/'||Str(nKol)
				Set DATD = DAT
				Set VOB  = 6
				! Set S = S /100
				Set NAZN = NAZN||" за " || sDat
				Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, TRUE )
	Table Window: F1 !! FSC-1 КП ФО у розрізі продуктів  
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: 1.КП ФО у розрізі продуктів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.042"
				Width:  15.333"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.25"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр по ПРОДУКТАМ'
						On SAM_Click
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("CC_POTR","NAME",
									" ID is not null ORDER BY NAME ", sTmp, sTmp1)
							If sTmp != STRING_Null
								Set PROD = sTmp
								Set NAME_PROD = sTmp1
							Else
								Set PROD = ''
								Set NAME_PROD = ''
				Data Field: PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.783"
							Top:    0.071"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вибраного продукту для аналізу')
				Data Field: NAME_PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.405"
							Width:  6.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва вибраного продукту для аналізу')
				!
				Data Field: DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.583"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Звітна дата')
						On SAM_Validate
							Call F_DAT()
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок за дату по вибранному дереру БРАНЧІВ'
						On SAM_Click
							Call F_Run()
				!
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pb_Branch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.071"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати дереро БРАНЧІВ'
						On SAM_Click
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("BRANCH", "NAME",
									  "DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
									  "ORDER BY NAME ",
									  sTmp, sTmp1)
							If sTmp != STRING_Null
								Set BRANCH = sTmp
								Set NAME_BRANCH = sTmp1
							Else
								Set BRANCH = ''
								Set NAME_BRANCH = ''
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.483"
							Top:    0.071"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вибраного Бранчу для аналізу')
				Data Field: NAME_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.583"
							Top:    0.405"
							Width:  5.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва вибраного Бранчу для аналізу')
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21993
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21994
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.283"
						Top:    0.905"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21995
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Frame
					Resource Id: 53360
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.25"
						Top:    0.738"
						Width:  11.933"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_KP00
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: КП
					Window Location and Size
						Left:   0.35"
						Top:    0.929"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_BR02
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч
					Window Location and Size
						Left:   1.25"
						Top:    0.929"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_RG06
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Регіон
					Window Location and Size
						Left:   2.55"
						Top:    0.929"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_GC61
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Геог.центр
					Window Location and Size
						Left:   3.75"
						Top:    0.929"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_MN04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Менеджер
					Window Location and Size
						Left:   5.25"
						Top:    0.929"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_PR01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Продукт
					Window Location and Size
						Left:   6.65"
						Top:    0.929"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_TR07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Термін
					Window Location and Size
						Left:   7.95"
						Top:    0.929"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_SM08
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сума
					Window Location and Size
						Left:   9.15"
						Top:    0.929"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_CT09
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Контрагент
					Window Location and Size
						Left:   10.35"
						Top:    0.929"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						п/п
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME ! s00  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: N6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-5 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			! cColumnLabeled: PROD ! id
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						прод
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                              List Values 
				                                                                                                                                                              Message Actions 
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: DA1
					Date/Time: DA2
					Date/Time: DA3
					Date/Time: DA4
					Date/Time: DA5
					Date/Time: DA6
					Date/Time: DA7
				Actions
					If SqlPrepareAndExecute( hSql(), "SELECT 
							  add_months(:DAT,-1), add_months(:DAT,-2), add_months(:DAT,-3),
							  add_months(:DAT,-4), add_months(:DAT,-5), add_months(:DAT,-6) 
							 INTO :DA1, :DA2, :DA3, :DA4, :DA5, :DA6  FROM dual ") 
							and SqlFetchNext(hSql(),nFetchRes)
						Call SalTblSetColumnTitle( N0, SalFmtFormatDateTime( DAT, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N1, SalFmtFormatDateTime( DA1, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N2, SalFmtFormatDateTime( DA2, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N3, SalFmtFormatDateTime( DA3, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N4, SalFmtFormatDateTime( DA4, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N5, SalFmtFormatDateTime( DA5, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N6, SalFmtFormatDateTime( DA6, 'dd/MM/yyyy' ) )
			Function: F_Run
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: p_PROD
				Actions
					If BRANCH=''
						Call SalMessageBox('НЕ вибрано дерево БРАНЧІВ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					Else If DAT = DATETIME_Null
						Call SalMessageBox('НЕ задано звітну ДАТУ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					Call SalWaitCursor(TRUE)
					If rb_KP00
						Set sTitl = "0.КП ФО "
						Set nRep = 00
					Else If rb_PR01
						Set sTitl = "1.КП ФО у розрiзi продуктів "
						Set nRep = 01
					Else If rb_BR02 
						Set sTitl = "2.КП ФО у розрiзi точок продажу "
						Set nRep = 02
					Else If rb_MN04 
						Set sTitl = "4.КП ФО у розрiзi менеджерів "
						Set nRep = 04
					Else If rb_RG06
						Set sTitl = "6.КП ФО у розрiзi регiонiв "
						Set nRep = 06
					Else If rb_GC61
						Set sTitl = "6/1.КП ФО у розрiзi геогр.центрiв "
						Set nRep = 61
					Else If rb_TR07
						Set sTitl = "7.КП ФО у розрiзi термiну кредиту "
						Set nRep = 07
					Else If rb_SM08
						Set sTitl = "8.КП ФО у розрiзi суми кредиту "
						Set nRep = 08
					Else If rb_CT09
						Set sTitl = "9.КП ФО у розрiзi типу контрагенту "
						Set nRep = 09
					If PROD = STRING_Null
						Set p_PROD = '%'
					Else
						Set p_PROD = PROD 
					If SqlPLSQLCommand( hSql(), "CCK_rep.P1 (nRep, DAT, BRANCH, p_PROD )" )
						Call F_DAT()
						Call SalSetWindowText( hWndForm, sTitl || 
								NAME_BRANCH ||' за ' || SalFmtFormatDateTime(DAT,'dd/MM/yyyy') 
								|| ' ' || NAME_PROD  )
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return TRUE
					!
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp
			String: sTmp1
			String: sTmp2
			Number: nRep
			String: sTitl
		Message Actions
			On SAM_Create
				Set hWndForm.F1.nTabInstance = 1
				Set F1.strPrintFileName = 'F_1'
				Call SalTblSetLockedColumns(hWndForm, 2)
				If SqlPrepareAndExecute( hSql(),
						  "select max(sdate) into :DAT 
						  from cc_deal where prod is not null and sos>=10")
						and NOT SqlFetchNext(hSql(),nFetchRes)
					Set hWndForm.F1.DAT = GetBankDate()
				! Set hWndForm.F1.strFilterTblName = 'TMP_REP'
				If SqlPrepareAndExecute( hSql(),
						"select branch, name into :BRANCH,:NAME_BRANCH 
						 from branch where branch=SYS_CONTEXT('bars_context','user_branch') " )
						and SqlFetchNext(hSql(),nFetchRes)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalEnableWindow( pbFilter )
			On SAM_ColumnSelectClick
				! Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
				! Set bSortOrd = not bSortOrd
				! Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set F1.strSqlPopulate =
						"SELECT  npp, s00, n00,  n01,  n02,  n03,  n04,  n05,  n06
						 INTO :F1.NPP, :F1.NAME, :F1.N0, :F1.N1, :F1.N2, :F1.N3,
						                         :F1.N4, :F1.N5, :F1.N6
						 FROM TMP_REP where idf=1 and id=:F1.nRep ORDER BY x00, npp "
				Call SalTblPopulate(hWndForm, hSql(), F1.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If NPP = 0
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray)
			! On SAM_DoubleClick
	Table Window: F4 !! FSC-3 КП ФО Vintage 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: 3. КП ФО Vintage
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.302"
				Width:  15.333"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.143"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Background Text: X : Періоди видачі 
					Resource Id: 28974
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.583"
						Top:    0.095"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				Data Field: DATX1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата початку Першого періоду відач')
						On SAM_Validate
							Call F_DATY()
				Data Field: MESX
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.583"
							Top:    0.071"
							Width:  0.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,
									 'Кількість ' ||
									 IifS(nPar=1,'Місяців',IifS(nPar=2,'Кварталів','Років') ) ||
									' для аналізу видач' )
				Data Field: DATX2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.083"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата кінця Останньго періоду відач')
						On SAM_Validate
							Set DATY2 = DATX2
				!
				Background Text: Y : Періоди погашень
					Resource Id: 28975
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.583"
						Top:    0.345"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
				Data Field: DATY1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата початку Першого періоду погашень')
				Data Field: MESY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.583"
							Top:    0.321"
							Width:  0.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,
									 'Кількість ' ||
									 IifS(nPar=1,'Місяців',IifS(nPar=2,'Кварталів','Років') ) ||
									' для аналізу погашень')
				Data Field: DATY2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.083"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата кінця Останньго періоду погашень')
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28976
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.883"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр по БРАНЧАМ'
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28977
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28978
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: KODP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.405"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість днів+ просрочки')
						! On SAM_Validate
							                                                                                                                                                                                       Call F_DAT()
						On SAM_Create
							Set KODP = 7
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок на дату по вибранному дереру БРАНЧІВ'
						On SAM_Click
							If BRANCH=''
								Call SalMessageBox('НЕ вибрано дерево БРАНЧІВ !',
										'Помилка ! ', MB_IconStop)
							Else
								Call SalWaitCursor(TRUE)
								Call F_SQL()
								Call SalWaitCursor(FALSE)
				Pushbutton: pb_Branch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.405"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати дереро БРАНЧІВ'
							If nPar = 61 
								Call SalDisableWindow( pb_Branch )
						On SAM_Click
							Set sTmp = STRING_Null
							If nPar = 0
								Call FunNSIGetFiltered("BRANCH", "NAME",
										  "DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
										  "ORDER BY NAME ",
										  sTmp, sTmp1)
							Else
								Call FunNSIGetFiltered("BRANCH", "NAME",
										  "length(branch)<=15 and DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
										  "ORDER BY NAME ",
										  sTmp, sTmp1)
							If sTmp != STRING_Null
								Set BRANCH = sTmp
								Set NAME_BRANCH = sTmp1
							Else
								Set BRANCH = ''
								Set NAME_BRANCH = ''
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.683"
							Top:    0.071"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Data Field: NAME_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.683"
							Top:    0.321"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Frame
					Resource Id: 31749
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.783"
						Top:    0.071"
						Width:  3.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Значення
					Window Location and Size
						Left:   1.883"
						Top:    0.155"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
				Radio Button: rbP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: %
					Window Location and Size
						Left:   3.483"
						Top:    0.155"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
				! !!!!
				Frame
					Resource Id: 31750
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.783"
						Top:    0.405"
						Width:  3.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По сумі
					Window Location and Size
						Left:   1.883"
						Top:    0.488"
						Width:  1.133"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
				Radio Button: rbKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По кількості
					Window Location and Size
						Left:   3.483"
						Top:    0.488"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
				! !!!!
				Frame
					Resource Id: 31751
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.783"
						Top:    0.738"
						Width:  12.3"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_KP00
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: КП
					Window Location and Size
						Left:   1.883"
						Top:    0.821"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Radio Button: rb_PR01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Продукт
					Window Location and Size
						Left:   8.483"
						Top:    0.821"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_BR02
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч
					Window Location and Size
						Left:   2.783"
						Top:    0.821"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_MN04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Менеджер
					Window Location and Size
						Left:   6.983"
						Top:    0.821"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_RG06
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Регіон
					Window Location and Size
						Left:   4.083"
						Top:    0.821"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_TR07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Термін
					Window Location and Size
						Left:   9.883"
						Top:    0.821"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Periwinkle
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_SM08
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сума
					Window Location and Size
						Left:   11.283"
						Top:    0.821"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Periwinkle
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_CT09
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Контрагент
					Window Location and Size
						Left:   12.383"
						Top:    0.821"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Light Periwinkle
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_GC61
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Геог.центр
					Window Location and Size
						Left:   5.283"
						Top:    0.821"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Periwinkle
					Background Color: Default
					Message Actions
					! Message Actions 
				Data Field: P_ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Set P_ND = 0
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Контрольний реф.КД')
		Contents
			Column: colMonth
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Через
						міс
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.65"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Груповано
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  1.85"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: F_CREATE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					!
					If SqlPrepareAndExecute(hSql(),
							"select branch, name into :BRANCH, :NAME_BRANCH 
							 from branch where branch=SYS_CONTEXT('bars_context','user_branch') ")
							and SqlFetchNext(hSql(), nFetchRes) 
					Set Br = BRANCH || '%'
					! X, Y 
					If SqlPrepareAndExecute(hSql(),
							"select min(d.sdate), max(f.fdat), Round( months_between( max(f.fdat), min(d.sdate) )+0.5,0)
							 into :DATX1, :DATX2, :MESX 
							 from cc_deal d, fdat f 
							 where d.sos>=10 and d.prod is NOT null and d.branch like :Br ")
							and SqlFetchNext(hSql(), nFetchRes) 
					Call F_DATY()
					! Set Sh = 'YYYY-MM'
					! Set mKol = 1
					! If nPar=2
						                                                                                                      Set MESX = SalNumberRound( MESX/3 +0.5)
						                                                                                                      Set Sh   = 'YYYY-Q'
						                                                                                                      Set mKol = 3
						                                                                                                      Call SalTblSetColumnTitle( colMonth, 'Через
								кварт' )
					! Else If nPar=3 
						                                                                                                      Set MESX = SalNumberRound( MESX/12 +0.5)
						                                                                                                      Set Sh   = 'YYYY'
						                                                                                                      Set mKol = 12
						                                                                                                      Call SalTblSetColumnTitle( colMonth, 'Через
								років' )
					! Set MESY  = MESX -1 
					! == Колонки
					! Set nFixPos = 2
					Set nFixPos = 3
					Set nColPos = nFixPos
					Set nColWidth = 1.6
					Set nColMaxChar = 30
					If SqlPrepareAndExecute(hSql(),
							"select distinct to_char(fdat,:Sh ) YYYYMM 
							 into :sColTitle 
							 from fdat where fdat>=:DATX1 and fdat<=:DATX2 
							 order by 1 ")
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalTblCreateColumn(hWndForm, nColPos, nColWidth, nColMaxChar, sColTitle)
							Set hWndColumn = SalTblGetColumnWindow(hWndForm, nColPos, COL_GetPos)
							Call SalTblSetColumnFlags(hWndColumn, COL_RightJustify, TRUE)
							Call SalDisableWindow(hWndColumn)
							Set smColumn[nColPos] = sColTitle
							Set nColPos = nColPos + 1
			Function: F_SQL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql
					String: sName
					Number: MODE_
					String: YYYYMM	! Період видачі
					Number: SDOG	! Об`єм видачі - сума
					Number: KDOG	! Об`єм видачі - кількість
					Number: KOL	! Через місяців
					Number: SPS	! Сума просрочки
					Number: SPK	! кількість просрочки
					Number: nRow1
					Number: nRow2
					Number: nLine
					Number: X00
					String: sRb
					String: SDATX1
					String: SDATX2
				Actions
					Call SalWaitCursor(TRUE)
					If rb_KP00
						Set MODE_ = 0
						Set sRb = "КП"
					Else If rb_PR01
						Set MODE_ =01
						Set sRb = "Продуктам"
					Else If rb_BR02
						Set MODE_ = 2
						Set sRb = "Бранчам"
					Else If rb_MN04
						Set MODE_ =04
						Set sRb = "Менеджерам"
					Else If rb_RG06
						Set MODE_ =06
						Set sRb = "Регіонам"
					Else If rb_GC61
						Set MODE_ =61
						Set sRb = "Геог.центрам"
					Else If rb_TR07
						Set MODE_ =07
						Set sRb = "Термінам"
					Else If rb_SM08
						Set MODE_ =08
						Set sRb = "Сумам"
					Else If rb_CT09
						Set MODE_ =09
						Set sRb = "Контрагентам"
					Call SalTblSetColumnTitle( NAME, 'Груповано по
							'||sRb )
					!
					Set SDATX1 = SalFmtFormatDateTime( DATX1, 'dd.MM.yyyy' )
					Set SDATX2 = SalFmtFormatDateTime( DATX2, 'dd.MM.yyyy' )
					If SqlPLSQLCommand( hSql(),
							 "CCK_rep.P4 (MODE_, SDATX1, SDATX2, BRANCH, nPar, KODP, P_ND)" )
						Set sTitl = 
								"4"||Str(nPar)||". КП ФО "|| 
								IifS(nPar=1,"M",IifS(nPar=2,"Q","Y")) || "-Vintage по " || 
								IifS(rbSum,"Сумі","Кількості") || ' КД, Код просрочки=' || Str(KODP) ||'+' 
						Call SalSetWindowText(hWndForm, sTitl)
						Set sSql = 
								"select s00,  branch,  npp, n00,    n01,   n02, n03, x00 
								 into :sName, :YYYYMM,:KOL, :SDOG, :KDOG, :SPS,:SPK,:X00  
								 from tmp_rep where idf=4 and id=:MODE_ 
								 order by s00, branch, npp "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblReset( hWndForm )
						Set nRow1 = 0
						! == Таблица
						If SqlPrepareAndExecute(hSql(), sSql)
							While SqlFetchNext(hSql(), nFetchRes)
								If X00 = 1
									! ==Строим новый фрагмент таблицы (добавляем Строки)
									Set nLine = 0
									Set nRow2 = 0
									While nLine < MESY
										Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
										If nRow2 = 0
											Set NAME = sName
											Call XSalTblSetCellBackColor( NAME, SalColorFromRGB( 255,255,180) )
										Set nLine = nLine + 1
										Set nRow2 = nRow2 + 1
										Set colMonth = nRow2
									Set nRow1 = nRow1 + nRow2
								! == разноска по матрице
								Set x = nFixPos
								While x < nColPos
									If smColumn[x] = YYYYMM
										Set y = 0
										While y <= nRow2
											! Call SalTblSetContext(hWndForm,(nRow1-1) + y)
											Call SalTblSetContext(hWndForm,(nRow1-nRow2) + y)
											If colMonth = KOL
												If KDOG > 0 and KDOG != NUMBER_Null 
													If rbP ! Vintag %
														If MODE_ = 0
															Call SalTblSetColumnTitle( SalTblGetColumnWindow( hWndForm,x,COL_GetID ),
																	 YYYYMM||'
																	100%')
														If rbSum ! По Сумі
															Call SalTblSetColumnText(hWndForm, x, SalNumberToStrX( SPS*100/SDOG, 2 ) )
														Else If rbKol ! По количеству
															Call SalTblSetColumnText(hWndForm, x, SalNumberToStrX( SPK*100/KDOG, 2 ) )
													Else ! Vintag - значения
														If rbSum ! По Сумі
															Call SalTblSetColumnText(hWndForm, x, SalNumberToStrX( SPS, 2) )
															If MODE_ = 0 
																Call SalTblSetColumnTitle( SalTblGetColumnWindow( hWndForm,x,COL_GetID ),
																		 YYYYMM||'
																		'|| SalNumberToStrX( SDOG, 2))
														Else If rbKol ! По количеству
															Call SalTblSetColumnText(hWndForm, x, SalNumberToStrX( SPK, 0) )
															If MODE_ = 0
																Call SalTblSetColumnTitle( SalTblGetColumnWindow( hWndForm,x,COL_GetID ),
																		 YYYYMM||'
																		'|| SalNumberToStrX( KDOG, 0))
													!
													If MODE_>0
														Call SalTblSetColumnTitle( SalTblGetColumnWindow( hWndForm,x,COL_GetID ),
																 YYYYMM)
												Break
											Set y = y + 1
										Break
									Set x = x + 1
						Call SalTblSetContext(hWndForm, 0)
						Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			Function: F_DATY
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute(hSql(),
							"select add_months( :DATX1, 1), Round( months_between( :DATX2, :DATX1) +0.5,0)
							 into :DATY1, :MESX from dual ")
							and SqlFetchNext(hSql(), nFetchRes) 
					! Set DATY1 = AddMonths( DATX1, 1 )
					Set DATY2 = DATX2
					Set Sh = 'YYYY-MM'
					Set mKol = 1
					If nPar=2
						Set MESX = SalNumberRound( MESX/3 +0.5)
						Set Sh   = 'YYYY-Q'
						Set mKol = 3
						Call SalTblSetColumnTitle( colMonth, 'Через
								кварт' )
					Else If nPar=3 
						Set MESX = SalNumberRound( MESX/12 +0.5)
						Set Sh   = 'YYYY'
						Set mKol = 12
						Call SalTblSetColumnTitle( colMonth, 'Через
								років' )
					Set MESY  = MESX -1 
		Window Parameters
			Number: nMode
			Number: nPar ! 1=M, 2=Q, 3=Y
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp
			String: sTmp1
			String: sTitl
			Number: nRep
			Number: n3
			String: sPopulate
			!
			String: Br
			String: Sh
			Number: mKol
			!
			Number: nFixPos
			Number: nFixRow
			Window Handle: hmColWnd[*]
			Number: nColPos
			Number: nColWidth
			Number: nColMaxChar
			String: sColTitle
			String: smColumn[*]
			Window Handle: hWndColumn
			Number: nRow
			Number: x
			Number: y
			!
		Message Actions
			On SAM_Create
				Set sTitl = 
						"4"||Str(nPar)||". КП ФО "|| 
						IifS(nPar=1,"M",IifS(nPar=2,"Q","Y"))||"-Vintage"
				Call SalSetWindowText(hWndForm, sTitl)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 2)
				!
				Set hWndForm.F4.strPrintFileName = 'F4'||Str(nPar)
				Set hWndForm.F4.nTabInstance = 1
				! Set hWndForm.F4.strFilterTblName = 'TMP_REP'
				Call F_CREATE()
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Set rb_KP00 = TRUE
				Set rb_PR01 = FALSE
				Set rb_BR02 = FALSE
				Set rb_MN04 = FALSE
				Set rb_RG06 = FALSE
				Set rb_TR07 = FALSE
				Set rb_SM08 = FALSE
				Set rb_CT09 = FALSE
				Set rb_GC61 = FALSE
				! Call SalDisableWindow( rb_PR01 )
				! Call SalDisableWindow( rb_BR02 )
				! Call SalDisableWindow( rb_MN04 )
				! Call SalDisableWindow( rb_RG06 )
				! Call SalDisableWindow( rb_TR07 )
				! Call SalDisableWindow( rb_SM08 )
				Call SalDisableWindow( rb_CT09 )
				! Call SalDisableWindow( rb_GC61 )
			On SAM_ColumnSelectClick
			On UM_Populate
				Call F_SQL()
			! On SAM_FetchRowDone
				                                                                                                                                                                                       If BRAN = '/'
					                                                                                                                                                                                       If NPP < 5
						                                                                                                                                                                                       Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize)
					                                                                                                                                                                                       Else If NPP < 9
						                                                                                                                                                                                       Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle)
					                                                                                                                                                                                       Else 
						                                                                                                                                                                                       Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Orchid)
	Table Window: F2 !! FSC-2 КП ФО у розрізі точок продажу 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: 2. КП ФО у розрізі 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.393"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр по БРАНЧАМ'
						On SAM_Click
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("CC_POTR","NAME",
									" ID is not null ORDER BY NAME ", sTmp, sTmp1)
							If sTmp != STRING_Null
								Set PROD = sTmp
								Set NAME_PROD = sTmp1
							Else
								Set PROD = ''
								Set NAME_PROD = ''
				Data Field: PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.683"
							Top:    0.155"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вибраного продукту для аналізу')
				Data Field: NAME_PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.488"
							Width:  6.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва вибраного продукту для аналізу')
				!
				Data Field: DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.155"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Звітна дата')
						On SAM_Validate
							Call F_DAT()
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок за дату по вибранному дереру БРАНЧІВ'
						On SAM_Click
							Call F_Run()
				!
				Pushbutton: pb_Branch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.283"
						Top:    0.155"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати дереро БРАНЧІВ'
							! If nPar = 61 
								                                                                                                                                                                   Call SalDisableWindow( pb_Branch )
						On SAM_Click
							Set sTmp = STRING_Null
							! If nPar = 0
								                                                                                                                                                                   Call FunNSIGetFiltered("BRANCH", "NAME",
										  "DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
										  "ORDER BY NAME ",
										  sTmp, sTmp1)
							! Else
							Call FunNSIGetFiltered("BRANCH", "NAME",
									  "length(branch)<=15 and DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
									  "ORDER BY NAME ",
									  sTmp, sTmp1)
							If sTmp != STRING_Null
								Set BRANCH = sTmp
								Set NAME_BRANCH = sTmp1
							Else
								Set BRANCH = ''
								Set NAME_BRANCH = ''
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.783"
							Top:    0.155"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вибраного Бранчу для аналізу')
				Data Field: NAME_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.683"
							Top:    0.488"
							Width:  5.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва вибраного Бранчу для аналізу')
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7900
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7901
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7902
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Frame
					Resource Id: 3567
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.821"
						Width:  12.3"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_KP00
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: КП
					Window Location and Size
						Left:   0.283"
						Top:    0.988"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_BR02
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч
					Window Location and Size
						Left:   1.183"
						Top:    0.988"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_RG06
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Регіон
					Window Location and Size
						Left:   2.483"
						Top:    0.988"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_GC61
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Геог.центр
					Window Location and Size
						Left:   3.683"
						Top:    0.988"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_MN04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Менеджер
					Window Location and Size
						Left:   5.183"
						Top:    0.988"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_PR01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Продукт
					Window Location and Size
						Left:   6.583"
						Top:    0.988"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_TR07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Термін
					Window Location and Size
						Left:   7.883"
						Top:    0.988"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_SM08
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сума
					Window Location and Size
						Left:   9.083"
						Top:    0.988"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_CT09
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Контрагент
					Window Location and Size
						Left:   10.283"
						Top:    0.988"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						п/п
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME ! s00  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: N6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-5 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-4
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-3
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тек мес-0
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: BRAN ! id
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						прод
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			! Function: F_DAT
				                                                                                                                              Description: 
				                                                                                                                              Returns 
				                                                                                                                              Parameters 
				                                                                                                                              Static Variables 
				                                                                                                                              Local variables 
				                                                                                                                              Actions 
					                                                                                                                              Call SalTblSetColumnTitle( N0, SalFmtFormatDateTime( DAT, 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N1, SalFmtFormatDateTime( AddMonths( DAT,-1), 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N2, SalFmtFormatDateTime( AddMonths( DAT,-2), 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N3, SalFmtFormatDateTime( AddMonths( DAT,-3), 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N4, SalFmtFormatDateTime( AddMonths( DAT,-4), 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N5, SalFmtFormatDateTime( AddMonths( DAT,-5), 'dd/MM/yyyy' ) )
					                                                                                                                              Call SalTblSetColumnTitle( N6, SalFmtFormatDateTime( AddMonths( DAT,-6), 'dd/MM/yyyy' ) )
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: DA1
					Date/Time: DA2
					Date/Time: DA3
					Date/Time: DA4
					Date/Time: DA5
					Date/Time: DA6
					Date/Time: DA7
				Actions
					If SqlPrepareAndExecute( hSql(), "SELECT 
							  add_months(:DAT,-1), add_months(:DAT,-2), add_months(:DAT,-3),
							  add_months(:DAT,-4), add_months(:DAT,-5), add_months(:DAT,-6) 
							 INTO :DA1, :DA2, :DA3, :DA4, :DA5, :DA6  FROM dual ") 
							and SqlFetchNext(hSql(),nFetchRes)
						Call SalTblSetColumnTitle( N0, SalFmtFormatDateTime( DAT, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N1, SalFmtFormatDateTime( DA1, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N2, SalFmtFormatDateTime( DA2, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N3, SalFmtFormatDateTime( DA3, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N4, SalFmtFormatDateTime( DA4, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N5, SalFmtFormatDateTime( DA5, 'dd/MM/yyyy' ) )
						Call SalTblSetColumnTitle( N6, SalFmtFormatDateTime( DA6, 'dd/MM/yyyy' ) )
			Function: F_Run
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: p_PROD
				Actions
					If BRANCH=''
						Call SalMessageBox('НЕ вибрано дерево БРАНЧІВ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					If DAT = DATETIME_Null
						Call SalMessageBox('НЕ задано звітну ДАТУ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					Call SalWaitCursor(TRUE)
					If rb_KP00
						Set sTitl = "0.КП ФО "
						Set nRep = 00
					Else If rb_PR01
						Set sTitl = "1.КП ФО у розрiзi продуктів "
						Set nRep = 01
					Else If rb_BR02 
						Set sTitl = "2.КП ФО у розрiзi точок продажу "
						Set nRep = 02
					Else If rb_MN04 
						Set sTitl = "4.КП ФО у розрiзi менеджерів "
						Set nRep = 04
					Else If rb_RG06
						Set sTitl = "6.КП ФО у розрiзi регiонiв "
						Set nRep = 06
					Else If rb_GC61
						Set sTitl = "6/1.КП ФО у розрiзi геогр.центрiв "
						Set nRep = 61
					Else If rb_TR07
						Set sTitl = "7.КП ФО у розрiзi термiну кредиту "
						Set nRep = 07
					Else If rb_SM08
						Set sTitl = "8.КП ФО у розрiзi суми кредиту "
						Set nRep = 08
					Else If rb_CT09
						Set sTitl = "9.КП ФО у розрiзi типу контрагенту "
						Set nRep = 09
					If PROD = STRING_Null
						Set p_PROD = '%'
					Else
						Set p_PROD = PROD 
					If SqlPLSQLCommand( hSql(), "CCK_rep.P2 (nRep, DAT, BRANCH, p_PROD )" )
						Call F_DAT()
						Call SalSetWindowText( hWndForm, sTitl || 
								NAME_BRANCH ||' за ' || SalFmtFormatDateTime(DAT,'dd/MM/yyyy') 
								|| ' ' || NAME_PROD  )
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nParr
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp
			String: sTmp1
			String: sTitl
			Number: nRep
		Message Actions
			On SAM_Create
				Set hWndForm.F2.nTabInstance = 1
				Call SalSetWindowText( hWndForm, sTitl )
				Set F2.strPrintFileName = 'F_2'
				Call SalTblSetLockedColumns(hWndForm, 2)
				If SqlPrepareAndExecute( hSql(),
						  "select max(sdate) into :DAT 
						  from cc_deal where prod is not null and sos>=10")
						and NOT SqlFetchNext(hSql(),nFetchRes)
					Set hWndForm.F2.DAT = GetBankDate()
				! Set hWndForm.F2.strFilterTblName = 'TMP_REP'
				!
				If SqlPrepareAndExecute( hSql(),
						"select branch, name into :BRANCH,:NAME_BRANCH 
						 from branch where branch=SYS_CONTEXT('bars_context','user_branch') " )
						and SqlFetchNext(hSql(),nFetchRes)
				Set F2.strSqlPopulate =
						"SELECT branch, npp, s00, n00, n01, n02, n03, n04, n05, n06
						 INTO :F2.BRAN, :F2.NPP, :F2.NAME, :F2.N0, :F2.N1, :F2.N2, 
						      :F2.N3,   :F2.N4,  :F2.N5, :F2.N6
						 FROM TMP_REP where idf=2 and id=:F2.nRep 
						 ORDER BY npp, branch "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalEnableWindow( pbFilter )
			On SAM_ColumnSelectClick
				! Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
				! Set bSortOrd = not bSortOrd
				! Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			! On UM_Populate
			On SAM_FetchRowDone
				If BRAN = '/'
					If NPP < 5
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize)
					Else If NPP < 9
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle)
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Orchid)
			! On SAM_DoubleClick
	Table Window: F5 !! FSC-5 Матриця переходів
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: FSC-5 Матриця переходів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.845"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51478
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр по БРАНЧАМ'
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51479
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51480
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Звітна дата')
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Виконати розрахунок за дату 
									по вибранному дереру БРАНЧІВ та ПРОДУКТУ'
						On SAM_Click
							Call F_RUN()
							Call SalWaitCursor(FALSE)
				Pushbutton: pb_Branch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати дереро БРАНЧІВ'
						On SAM_Click
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("BRANCH", "NAME",
									  "DELETED is null AND BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') " ||
									  "ORDER BY NAME ",
									  sTmp, sTmp1)
							If sTmp != STRING_Null
								Set BRANCH = sTmp
								Set NAME_BRANCH = sTmp1
							Else
								Set BRANCH = ''
								Set NAME_BRANCH = ''
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.483"
							Top:    0.071"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: NAME_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.071"
							Width:  4.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Frame
					Resource Id: 3568
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.35"
						Top:    0.429"
						Width:  14.233"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_KP00
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: КП
					Window Location and Size
						Left:   0.483"
						Top:    0.488"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_BR02
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч
					Window Location and Size
						Left:   1.683"
						Top:    0.488"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_RG06
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Регіон
					Window Location and Size
						Left:   3.083"
						Top:    0.488"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_GC61
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Геог.центр
					Window Location and Size
						Left:   4.483"
						Top:    0.488"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_MN04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Менеджер
					Window Location and Size
						Left:   6.283"
						Top:    0.488"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_PR01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Продукт
					Window Location and Size
						Left:   8.083"
						Top:    0.488"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_TR07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Термін
					Window Location and Size
						Left:   9.683"
						Top:    0.488"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_SM08
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сума
					Window Location and Size
						Left:   11.283"
						Top:    0.488"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				Radio Button: rb_CT09
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Контрагент
					Window Location and Size
						Left:   12.683"
						Top:    0.488"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
					! Message Actions 
				!
				Frame
					Resource Id: 325
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.071"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По сумі
					Window Location and Size
						Left:   0.483"
						Top:    0.155"
						Width:  1.133"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
				Radio Button: rbKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По кількості
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
		Contents
			Column: NAME 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 0
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 0
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1-30
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 1-30
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 31-60
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 31-60
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 61-90
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 61-90
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 91-120
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 91-120
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 121-180
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.567"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 121-180
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: >=181
						Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: >=181
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						прод
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_RUN
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sErr
					String: sCol
					Number: SumKol
				Actions
					Set sErr = ''
					If BRANCH=''
						Set sErr = sErr || '
								НЕ вибрано дерево БРАНЧІВ !'
					If DAT = DATETIME_Null
						Set sErr = sErr || '
								НЕ задано звітну ДАТУ !'
					If sErr != ''
						Call SalMessageBox( sErr, 'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					Call SalWaitCursor(TRUE)
					If rb_KP00
						Set nRep = 0
						Set sRb = "КП"
					Else If rb_PR01
						Set nRep =01
						Set sRb = "Продуктам"
					Else If rb_BR02
						Set nRep = 2
						Set sRb = "Бранчам"
					Else If rb_MN04
						Set nRep =04
						Set sRb = "Менеджерам"
					Else If rb_RG06
						Set nRep =06
						Set sRb = "Регіонам"
					Else If rb_GC61
						Set nRep =61
						Set sRb = "Геог.центрам"
					Else If rb_TR07
						Set nRep =07
						Set sRb = "Термінам"
					Else If rb_SM08
						Set nRep =08
						Set sRb = "Сумам"
					Else If rb_CT09
						Set nRep =09
						Set sRb = "Контрагентам"
					!
					If rbSum
						Set SumKol =1
						Set sCol = 'Сума'
					Else If rbKol
						Set SumKol =2
						Set sCol = 'Кіл-ть'
					Call SalTblSetColumnTitle( M0, '0
							'||sCol )
					Call SalTblSetColumnTitle( M1, '1-30
							'||sCol )
					Call SalTblSetColumnTitle( M2, '31-60
							'||sCol )
					Call SalTblSetColumnTitle( M3, '61-90
							'||sCol )
					Call SalTblSetColumnTitle( M4, '91-120
							'||sCol )
					Call SalTblSetColumnTitle( M5, '121-180
							'||sCol )
					Call SalTblSetColumnTitle( M6, '>=181
							'||sCol )
					If SqlPLSQLCommand( hSql(), "CCK_rep.P5 (SumKol, DAT, BRANCH, nRep )" )
						!
						Call SalSetWindowText( hWndForm, 
								'КП ФО Матриця переходів ' || NAME_BRANCH ||
								' за ' || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy' )||
								', по '|| sRb ||
								', по ' || IifS(rbSum,"Сумі","Кількості")
								)
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						Return TRUE
					Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp 
			String: sRb 
			String: sTmp1
			Number: nRep
			Number: nZ[10]
			! Number: nRep
		Message Actions
			On SAM_Create
				Set hWndForm.F5.nTabInstance = 1
				Set nRep = 5
				Set F5.strPrintFileName = 'F_'||Str(nRep)
				Call SalTblSetLockedColumns(hWndForm, 1)
				If SqlPrepareAndExecute( hSql(),
						  "select max(sdate) into :DAT 
						  from cc_deal where prod is not null and sos>=10")
						and NOT SqlFetchNext(hSql(),nFetchRes)
					Set DAT = GetBankDate()
				!
				If SqlPrepareAndExecute( hSql(),
						"select branch, name into :BRANCH, :NAME_BRANCH 
						 from branch where branch=SYS_CONTEXT('bars_context','user_branch') " )
						and SqlFetchNext(hSql(),nFetchRes)
				Set F5.strSqlPopulate =
						"SELECT NPP, s00, n06, n05, n04, n03, n02, n01, n00
						 INTO :F5.NPP, :F5.NAME,
						      :F5.M6,  :F5.M5, :F5.M4,  :F5.M3, :F5.M2, :F5.M1, :F5.M0
						 FROM TMP_REP where idf=5 and id=:F5.nRep
						 ORDER BY x00,NPP "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_ColumnSelectClick
			On SAM_FetchRowDone
				If NPP=-1
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize)
				Else
					If NPP = 0
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
						Set nZ[0]= M0
						Set nZ[1]= M1
						Set nZ[2]= M2
						Set nZ[3]= M3
						Set nZ[4]= M4
						Set nZ[5]= M5
						Set nZ[6]= M6
					!
					Call XSalTblSetCellBackColor( F5.P0, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P1, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P2, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P3, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P4, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P5, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( F5.P6, SalColorFromRGB( 230,255,230 ) )
					If nZ[0] !=0 
						Set P0 = M0 *100 / nZ[0]
					If nZ[1] !=0 
						Set P1 = M1 *100 / nZ[1]
					If nZ[2] !=0 
						Set P2 = M2 *100 / nZ[2]
					If nZ[3] !=0 
						Set P3 = M3 *100 / nZ[3]
					If nZ[4] !=0 
						Set P4 = M4 *100 / nZ[4]
					If nZ[5] !=0 
						Set P5 = M5 *100 / nZ[5]
					If nZ[6] !=0 
						Set P6 = M6 *100 / nZ[6]
	Table Window: BAX	!! Для ОБ Balans
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Архiв Балансiв в структурi показникiв ОБ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.619"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Group Box: Групування по :
					Resource Id: 7683
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				Radio Button: rb_BU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Показники
					Window Location and Size
						Left:   2.083"
						Top:    0.238"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_ZAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Заголовки
					Window Location and Size
						Left:   0.283"
						Top:    0.238"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Combo Box: YYYY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.083"
						Top:    0.238"
						Width:  1.733"
						Width Editable? Yes
						Height: 2.274"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If SqlPrepareAndExecute(hSql(),
									"SELECT distinct to_char(yyyy) INTO :BAX.sTmp FROM bsx ORDER BY 1 DESC")
								While SqlFetchNext(hSql(), nFetchRes)
									Call SalListAdd(BAX.YYYY, BAX.sTmp)
								Call SalListSetSelect(BAX.YYYY, 0)
						! On SAM_SetFocus
							                                                                                         Call SalStatusSetText(hWndForm, 'Виберіть звітний рік')
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 340
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.583"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 341
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 342
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.383"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Пок.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: XLS
						код 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Середньо-
						мiсячний
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 01.Сiчень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 01.Сiчень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 02.Лютий 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 02.Лютий 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 03.Березень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 03.Березень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 04.Квiтень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 04.Квiтень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 05.Травень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 05.Травень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 06.Червень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 06.Червень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 07.Липень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 07.Липень 
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 08.Серпень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 08.Серпень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 09.Вересень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 09.Вересень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 10.Жовтень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 10.Жовтень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 11.Листопад
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 11.Листопад
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: M12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 12.Грудень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 12.Грудень
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Показника
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Показника
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Col
				Description:
				Returns
				Parameters
					Number: xCol
				Static Variables
				Local variables
				Actions
					Call XSalTblSetCellBackColor( ID, xCol )
					Call XSalTblSetCellBackColor( NAME, xCol )
					Call XSalTblSetCellBackColor( KOD, xCol )
			Function: F_Zag
				Description:
				Returns
				Parameters
					String: XXXX
					String: YYYY
				Static Variables
				Local variables
				Actions
					! 01
					Call SalTblSetColumnTitle( M01,"Сiчень
							01-"|| YYYY )
					Call SalTblSetColumnTitle( N01,"Сiчень
							01-"|| XXXX )
					! 02
					Call SalTblSetColumnTitle( M02,"Лютий
							02-"|| YYYY )
					Call SalTblSetColumnTitle( N02,"Лютий
							02-"|| XXXX )
					! 03
					Call SalTblSetColumnTitle( M03,"Березень
							03-"|| YYYY )
					Call SalTblSetColumnTitle( N03,"Березень
							03-"|| XXXX )
					! 04
					Call SalTblSetColumnTitle( M04,"Квiтень
							04-"|| YYYY )
					Call SalTblSetColumnTitle( N04,"Квiтень
							04-"|| XXXX )
					! 05
					Call SalTblSetColumnTitle( M05,"Травень
							05-"|| YYYY )
					Call SalTblSetColumnTitle( N05,"Травень
							05-"|| XXXX )
					! 06
					Call SalTblSetColumnTitle( M06,"Червень
							06-"|| YYYY )
					Call SalTblSetColumnTitle( N06,"Червень
							06-"|| XXXX )
					! 07
					Call SalTblSetColumnTitle( M07,"Липень
							07-"|| YYYY )
					Call SalTblSetColumnTitle( N07,"Липень
							07-"|| XXXX )
					! 08
					Call SalTblSetColumnTitle( M08,"Серпень
							08-"|| YYYY )
					Call SalTblSetColumnTitle( N08,"Серпень
							08-"|| XXXX )
					! 09
					Call SalTblSetColumnTitle( M09,"Вересень
							09-"|| YYYY )
					Call SalTblSetColumnTitle( N09,"Вересень
							09-"|| XXXX )
					! 10
					Call SalTblSetColumnTitle( M10,"Жовтень
							10-"|| YYYY )
					Call SalTblSetColumnTitle( N10,"Жовтень
							10-"|| XXXX )
					! 11
					Call SalTblSetColumnTitle( M11,"Листопад
							11-"|| YYYY )
					Call SalTblSetColumnTitle( N11,"Листопад
							11-"|| XXXX )
					! 12
					Call SalTblSetColumnTitle( M12,"Грудень
							12-"|| YYYY )
					Call SalTblSetColumnTitle( N12,"Грудень
							12-"|| XXXX )
			Function: F_Sr
				Description:
				Returns
				Parameters
					Number: nM
				Static Variables
				Local variables
				Actions
					If nI < 13 
						If nM != NUMBER_Null
							Set nS = nS + nM
							Set nI = nI +1
			Function: F_M00
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nS = 0
					Set nI = 0
					Call F_Sr (M12)
					Call F_Sr (M11)
					Call F_Sr (M10)
					Call F_Sr (M09)
					Call F_Sr (M08)
					Call F_Sr (M07)
					Call F_Sr (M06)
					Call F_Sr (M05)
					Call F_Sr (M04)
					Call F_Sr (M03)
					Call F_Sr (M02)
					Call F_Sr (M01)
					!
					Call F_Sr (N12)
					Call F_Sr (N11)
					Call F_Sr (N10)
					Call F_Sr (N09)
					Call F_Sr (N08)
					Call F_Sr (N07)
					Call F_Sr (N06)
					Call F_Sr (N05)
					Call F_Sr (N04)
					Call F_Sr (N03)
					Call F_Sr (N02)
					Call F_Sr (N01)
					!
					If nI > 0
						Set M00 = nS/nI
					Call XSalTblSetCellBackColor( M00, nColS )
		Window Parameters
			Number: nMode
			Number: nPar
			String: sTitl
			String: strPar02
		Window Variables
			String: sTmp
			! Number: nOB22
			Number: nCol
			Number: nColS
			String: XXXX
			!
			Number: nS
			Number: nI
		Message Actions
			On SAM_Create
				Set BAX.nTabInstance = 1
				Call SetWindowFullSize( BAX )
				Set nCol = SalColorFromRGB( 230,245,240 ) ! бледнофиолет. для прош.года
				Set nColS = SalColorFromRGB( 255,255,180) ! желтый , для средних
				Set BAX.strPrintFileName = 'BAX'
				Call SalTblSetLockedColumns(BAX, 4)
				! Set hWndForm.BAX.strFilterTblName = 'BSB'
				Set BAX.fFilterAtStart = 1
				Set BAX.rb_BU  = TRUE
				Set BAX.rb_ZAG = FALSE
				! Set nOB22 = GetGlobalOptionEx('OB22')
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(FALSE)
				Set BAX.XXXX = Str(Val(BAX.YYYY) -1 ) 
				Call SalSetWindowText( BAX, BAX.sTitl ||
						 '. Звiтний рiк ' || BAX.XXXX || ' - ' || BAX.YYYY )
				Call BAX.F_Zag (BAX.XXXX,BAX.YYYY)
				Call SalTblDefineSplitWindow(BAX, 0, FALSE)
				Set BAX.strSqlPopulate =
						"SELECT b.id,  b.name, b.KOD, b.pu, nvl(b.ord,b.id), 
						   x.m01/100, x.m02/100, x.m03/100, x.m04/100, x.m05/100, x.m06/100,
						   x.m07/100, x.m08/100, x.m09/100, x.m10/100, x.m11/100, x.m12/100,
						   y.m01/100, y.m02/100, y.m03/100, y.m04/100, y.m05/100, y.m06/100,
						   y.m07/100, y.m08/100, y.m09/100, y.m10/100, y.m11/100, y.m12/100 
						 INTO :BAX.ID, :BAX.NAME, :BAX.KOD, :BAX.PU, :BAX.ORD,
						  :BAX.M01, :BAX.M02, :BAX.M03, :BAX.M04, :BAX.M05, :BAX.M06,
						  :BAX.M07, :BAX.M08, :BAX.M09, :BAX.M10, :BAX.M11, :BAX.M12,
						  :BAX.N01, :BAX.N02, :BAX.N03, :BAX.N04, :BAX.N05, :BAX.N06,
						  :BAX.N07, :BAX.N08, :BAX.N09, :BAX.N10, :BAX.N11, :BAX.N12 
						 from bs1 b, 
						     ( select * from BSX where yyyy=" || BAX.YYYY || "  ) x ,  
						     ( select * from BSX where yyyy=" || BAX.YYYY || "-1) y   
						 where b.id=x.ID (+) and b.id=y.Id (+)  " ||  
						  IifS(BAX.rb_ZAG, " and b.pu in (2,0) ", "") ||  " 
						 ORDER BY nvl(b.ord,b.id) "
				Call SalTblPopulate(BAX, hSql(), BAX.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(BAX, 0)
				Call SalPostMsg(BAX, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If BAX.PU = 2
					Call BAX.F_Col (COLOR_LightGray)
				Else If BAX.PU = 0
					Call BAX.F_Col (COLOR_LightGreen)
				!
				Call XSalTblSetCellBackColor( BAX.N01, nCol )
				Call XSalTblSetCellBackColor( BAX.N02, nCol )
				Call XSalTblSetCellBackColor( BAX.N03, nCol )
				Call XSalTblSetCellBackColor( BAX.N04, nCol )
				Call XSalTblSetCellBackColor( BAX.N05, nCol )
				Call XSalTblSetCellBackColor( BAX.N06, nCol )
				Call XSalTblSetCellBackColor( BAX.N07, nCol )
				Call XSalTblSetCellBackColor( BAX.N08, nCol )
				Call XSalTblSetCellBackColor( BAX.N09, nCol )
				Call XSalTblSetCellBackColor( BAX.N10, nCol )
				Call XSalTblSetCellBackColor( BAX.N11, nCol )
				Call XSalTblSetCellBackColor( BAX.N12, nCol )
				!
				Call BAX.F_M00()
				! !!!!!!!!!!!
	Table Window: BAL	!! Для ОБ Balans
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Баланс в структурі показників ОБ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 8.024"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.464"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				! !!!!
				Group Box: Групування по :
					Resource Id: 8191
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.155"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				Radio Button: rb_ZAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Заголовки
					Window Location and Size
						Left:   0.283"
						Top:    0.405"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_BU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Показники
					Window Location and Size
						Left:   2.083"
						Top:    0.405"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				! !!!
				Group Box: Термін для розрахунку
					Resource Id: 8192
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.283"
						Top:    0.155"
						Width:  10.4"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Green
					Background Color: Default
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Показать SQL
					Window Location and Size
						Left:   14.783"
						Top:    1.071"
						Width:  2.7"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pb_ArchV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = "Архів балансiв"
						On SAM_Click
							If IsWindow( hAR )
								Call SalDestroyWindow( hAR )
							Set hAR = SalCreateWindow( BAX, hWndForm, nMode, nPar, strTip, strPar02)
				Pushbutton: pb_Arch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = "Перенесення в річний архів даних розрахунку за звітний період "
						On SAM_Click
							Call F_Arch( strTip, rYYYY_MM  )
							Call SalWaitCursor(FALSE)
				Combo Box: YYYYMM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.583"
						Top:    0.405"
						Width:  2.0"
						Width Editable? Yes
						Height: 1.964"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If SqlPrepareAndExecute(hSql(),
									"SELECT distinct to_char(fdat,'yyyy-MM') INTO :sTmp
									 FROM fdat  
									 WHERE to_char(fdat,'yyyy-MM') < to_char(gl.BD,'yyyy-MM')
									ORDER BY 1 DESC")
								While SqlFetchNext(hSql(), nFetchRes)
									Call SalListAdd(YYYYMM, sTmp)
								Call SalListSetSelect(hWndItem, 0)
						! On SAM_Click
							                                                                                                                         Call NASELENIE()
						On SAM_SetFocus
							Call SalStatusSetText(hWndForm, 'Виберіть звітний місяць')
				Background Text: >
					Resource Id: 12001
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.083"
						Top:    0.405"
						Width:  0.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунок за вибраний період'
						On SAM_Click
							Call F_Run(  )
							Call SalWaitCursor(FALSE)
				Background Text: <
					Resource Id: 12003
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.983"
						Top:    0.429"
						Width:  0.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: DAT_RAB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.683"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Radio Button: rbM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.393"
						Width:  0.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Баланс на звiтний МIСЯЦЬ')
				Radio Button: rbD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.405"
						Width:  0.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Баланс на звiтний ДЕНЬ')
				Radio Button: rbSM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: M
					Window Location and Size
						Left:   11.783"
						Top:    0.405"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Середньозважений Баланс за 1 день(з початку Місяця).')
				Radio Button: rbSQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Q
					Window Location and Size
						Left:   12.583"
						Top:    0.405"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Середньозважений Баланс за 1 день(з початку Кварталу).')
				Radio Button: rbSY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Y
					Window Location and Size
						Left:   13.383"
						Top:    0.405"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Середньозважений Баланс за 1 день(з початку Року).')
				! !!!!!
					                                                                                                                                       Message Actions 
						                                                                                                                                       On SAM_Click
							                                                                                                                                       Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Group Box: Розріз по установам :
					Resource Id: 8190
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.821"
						Width:  4.9"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
				Radio Button: rb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч 1+
					Window Location and Size
						Left:   0.283"
						Top:    1.071"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_Run(  )
				Radio Button: rb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч 2+
					Window Location and Size
						Left:   2.083"
						Top:    1.071"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_Run(  )
				Radio Button: rb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч 3
					Window Location and Size
						Left:   3.583"
						Top:    1.071"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_Run(  )
				! !!!!
				Group Box: Додатково
					Resource Id: 8196
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.083"
						Top:    0.821"
						Width:  9.6"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Marigold
					Background Color: Default
				!
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд первинних балансових даних'
						On SAM_Click
							Call FunNSIEditF("BSA",1 | 0x0010)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.683"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pb_Sql
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.183"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\TABLER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд  та Тест формул ВСІХ показників'
						On SAM_Click
							If IsWindow( hFR )
								Call SalDestroyWindow(hFR )
							Set hFR = SalCreateWindow( FR, hWndForm, nMode, nPar, strPar01, strPar02)
							!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.988"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Check Box: cb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: з 0.00 - знач
					Window Location and Size
						Left:   8.183"
						Top:    0.988"
						Width:  1.7"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						On SAM_Create
							Set cb_0 = 0
				Check Box: cb_Form
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: з Формулами
					Window Location and Size
						Left:   9.983"
						Top:    0.988"
						Width:  1.9"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If cb_Form = 1
								Call SalShowWindow( sFXLS )
								! Call SalShowWindow( sFSQL )
							Else
								Call SalHideWindow( sFXLS )
								! Call SalHideWindow( sFSQL )
						On SAM_Create
							Set cb_Form = 0
				Check Box: cb_Goriz
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: по горизонталі
					Window Location and Size
						Left:   11.983"
						Top:    0.988"
						Width:  2.5"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If cb_Goriz = 0 OR rb_3 
								Call SalShowWindow( NAME_TOBO )
								Call SalShowWindow( TOBO )
							Else
								If cb_Goriz = 1
									Call SalHideWindow( NAME_TOBO )
									Call SalHideWindow( TOBO )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						On SAM_Create
							Set cb_Goriz = 1
							Call SalHideWindow( NAME_TOBO )
							Call SalHideWindow( TOBO )
				! !!!!!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 8193
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.583"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 8194
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 8195
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Показника
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Пок.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: XLS
						код 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Показника
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sFXLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оригiнальна XLS-Формула
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: 250
				Data Type: Long String
				Justify: Left
				Width:  6.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
				                                          List Values 
				                                          Message Actions 
			Column: S01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 01
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 02
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 03
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 04
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 05
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 06
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 07
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 08
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 09
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 10
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 11
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 12
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S13
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 13
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S14
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 14
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S15
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 15
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S16
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 16
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S17
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 17
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S18
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 18
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S19
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 19
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S20
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 20
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S21
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 21
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 22
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S23
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 23
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S24
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 24
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S25
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 25
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 26
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S27
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 27
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S28
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 28
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S29
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 29
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S30
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 30
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S31
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 31
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S32
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 32
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S33
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 33
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S34
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 34
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 35
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S36
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 36
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S37
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 37
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S38
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 38
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S39
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 39
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S40
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 40
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S41
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 41
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S42
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 42
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S43
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 43
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S44
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 44
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S45
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 45
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S46
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 46
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S47
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 47
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S48
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 48
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S49
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 49
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S50
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 50
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S51
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 51
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S52
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 52
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S53
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 53
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S54
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 54
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S55
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 55
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S56
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 56
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S57
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 57
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S58
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 58
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S59
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 59
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S60
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 60
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S61
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 61
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S62
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 62
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S63
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 63
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S64
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 64
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S65
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 65
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S66
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 66
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S67
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 67
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S68
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 68
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S69
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 69
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S70
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 70
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S71
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 71
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S72
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 72
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S73
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 73
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S74
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 74
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S75
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 75
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S76
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 76
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S77
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 77
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S78
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 78
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S79
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 79
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S80
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 80
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			! cColumnLabeled: S41
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 41
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S42
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 42
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S43
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 43
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S44
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 44
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S45
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 45
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S46
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 46
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S47
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 47
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S48
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 48
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S49
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 49
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			! cColumnLabeled: S50
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: 50
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                        List Values 
				                                        Message Actions 
			!
			! cColumnLabeled: sFSQL
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: SQL-Формула
						Показника
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  6.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                  List Values 
				                                                                                                  Message Actions 
			!
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Установи
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						Установи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Run
				Description:
				Returns
					Boolean:
				Parameters
					! Boolean: b_M
				Static Variables
				Local variables
					Number: nUr
					String: sRb
					Number: nKodZ
				Actions
					Call SalWaitCursor(TRUE)
					Call SalDisableWindow( pb_Run )
					Call SalHideWindow( pb_Arch )
					Set nUr = IifN (rb_1,1, IifN (rb_2,2,3) )+10
					Set rYYYY_MM = STRING_Null
					If rbM 
						! За звітниний міс
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 1, nUr, YYYYMM, DAT_RAB)" )
							Set sRb = sTitl || '. Зв.перiод ' || YYYYMM
							If rb_1 
								Set rYYYY_MM = YYYYMM
								Call SalShowWindow( pb_Arch )
					Else If rbD
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 2, nUr, YYYYMM, DAT_RAB)" )
							Set sRb = sTitl || '. За дату ' || SalFmtFormatDateTime( DAT_RAB, 'dd/MM/yyyy' )
					Else If rbSM
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 31, nUr, YYYYMM, DAT_RAB)" )
							Set sRb = 'Середн.зваж.Баланс з початку Місяця по '|| SalFmtFormatDateTime( DAT_RAB, 'dd/MM/yyyy' )
					Else If rbSQ
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 32, nUr, YYYYMM, DAT_RAB)" )
							Set sRb = 'Середн.зваж.Баланс з початку Кварталу по '|| SalFmtFormatDateTime( DAT_RAB, 'dd/MM/yyyy' )
					Else If rbSY
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 33, nUr, YYYYMM, DAT_RAB)" )
							Set sRb = 'Середн.зваж.Баланс з початку Року по '|| SalFmtFormatDateTime( DAT_RAB, 'dd/MM/yyyy' )
					!
					Call SalSetWindowText( hWndForm, sRb )
					!
					If rb_3
						! \SBR\BRS\ANI11
						If SqlPrepareAndExecute( hSql(),
								"select kodz into :nKodZ from zapros where pkey = '\\SBR\\BRS\\ANI11' " )
							If SqlFetchNext( hSql(),nFetchRes )
								Call ExportCatQuery(nKodZ,"",8,"",TRUE)
						Call SalEnableWindow( pb_Run )
					Else
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return TRUE
					!
			Function: F_Arch
				Description:
				Returns
				Parameters
					String: sMess0
					String: YYYY_MM
				Static Variables
				Local variables
					String: sMess1
				Actions
					Set sMess1 = sMess0 || YYYY_MM
					If SalMessageBox(
							'Ви дійсно бажаєте виконати 
							' || sMess1 ||' ?', 'Увага!', MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 1, 77, YYYY_MM, DAT_RAB)" )
							Call SqlCommitEx(hSql(),sMess1)
							Call SalHideWindow( pb_Arch )
							Call SalWaitCursor(FALSE)
							Call MessageNoWait(sMess1 || '
									 Виконано !','Повідомлення',3,0)
			Function: F_Zag_Col
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: II
					String: BRA
					Window Handle: hCol
				Actions
					If cb_Form = 1
						Call SalShowWindow( sFXLS )
					Else
						Call SalHideWindow( sFXLS )
					!
					Call SalShowWindow( NAME_TOBO )
					Call SalShowWindow( TOBO )
					Set II = 0 
					If rb_2 and cb_Goriz = 1
						Call SalHideWindow( NAME_TOBO )
						Call SalHideWindow( TOBO )
						Call SalTblSetColumnTitle( S00, 
								"Разом по
								Бранч 2+"  )
						If SqlPrepareAndExecute( hSql(), 
								"select rownum npp, substr(branch,-8) into :II,  :BRA
								 from (select branch from branch where length(branch) = 15 
								 order by branch)" )
							! Открыть  колонку и дать ее заголовок
							While SqlFetchNext( hSql(), nFetchRes )
								! Call Debug ( Str(II) || ' ' || BRA ) 
								Set hCol = SalTblGetColumnWindow( hWndForm, ( nSdvig + II ), COL_GetID  )
								Call SalShowWindow( hCol )
								Call SalTblSetColumnTitle( hCol, Str(II)|| " 
										" || BRA )
						Set BAL.strSqlPopulate =
								"select  nvl(bs1.ord,bs1.id), bs1.id, bs1.name, bs1.KOD, bs1.pu, bs1.ssql, S00,
								        S01, S02, S03, S04, S05, S06, S07, S08, S09, S10,
								        S11, S12, S13, S14, S15, S16, S17, S18, S19, S20,
								        S21, S22, S23, S24, S25, S26, S27, S28, S29, S30,
								        S31, S32, S33, S34, S35, S36, S37, S38, S39, S40,
								        S41, S42, S43, S44, S45, S46, S47, S48, S49, S50,
								        S51, S52, S53, S54, S55, S56, S57, S58, S59, S60,
								        S61, S62, S63, S64, S65, S66, S67, S68, S69, S70,
								        S71, S72, S73, S74, S75, S76, S77, S78, S79, S80
								 INTO :BAL.ORD,:BAL.ID ,:BAL.NAME,:BAL.KOD, :BAL.PU , :BAL.sFXLS ,   :BAL.S00, 
								      :BAL.S01,:BAL.S02,:BAL.S03,:BAL.S04,:BAL.S05,:BAL.S06,:BAL.S07,:BAL.S08,:BAL.S09,:BAL.S10,
								      :BAL.S11,:BAL.S12,:BAL.S13,:BAL.S14,:BAL.S15,:BAL.S16,:BAL.S17,:BAL.S18,:BAL.S19,:BAL.S20,
								      :BAL.S21,:BAL.S22,:BAL.S23,:BAL.S24,:BAL.S25,:BAL.S26,:BAL.S27,:BAL.S28,:BAL.S29,:BAL.S30,
								      :BAL.S31,:BAL.S32,:BAL.S33,:BAL.S34,:BAL.S35,:BAL.S36,:BAL.S37,:BAL.S38,:BAL.S39,:BAL.S40,
								:BAL.S41,:BAL.S42,:BAL.S43,:BAL.S44,:BAL.S45,:BAL.S46,:BAL.S47,:BAL.S48,:BAL.S49,:BAL.S50,
								:BAL.S51,:BAL.S52,:BAL.S53,:BAL.S54,:BAL.S55,:BAL.S56,:BAL.S57,:BAL.S58,:BAL.S59,:BAL.S60,
								:BAL.S61,:BAL.S62,:BAL.S63,:BAL.S64,:BAL.S65,:BAL.S66,:BAL.S67,:BAL.S68,:BAL.S69,:BAL.S70,
								:BAL.S71,:BAL.S72,:BAL.S73,:BAL.S74,:BAL.S75,:BAL.S76,:BAL.S77,:BAL.S78,:BAL.S79,:BAL.S80
								 from bs1 , 
								    (select x.id,  sum(x.s) S00,  
								            sum(decode(b.npp,01,x.s,0)) S01, sum(decode(b.npp,02,x.s,0)) S02,
								            sum(decode(b.npp,03,x.s,0)) S03, sum(decode(b.npp,04,x.s,0)) S04,
								            sum(decode(b.npp,05,x.s,0)) S05, sum(decode(b.npp,06,x.s,0)) S06,
								            sum(decode(b.npp,07,x.s,0)) S07, sum(decode(b.npp,08,x.s,0)) S08,
								            sum(decode(b.npp,09,x.s,0)) S09, sum(decode(b.npp,10,x.s,0)) S10,
								            sum(decode(b.npp,11,x.s,0)) S11, sum(decode(b.npp,12,x.s,0)) S12,
								            sum(decode(b.npp,13,x.s,0)) S13, sum(decode(b.npp,14,x.s,0)) S14,
								            sum(decode(b.npp,15,x.s,0)) S15, sum(decode(b.npp,16,x.s,0)) S16, 
								            sum(decode(b.npp,17,x.s,0)) S17, sum(decode(b.npp,18,x.s,0)) S18,
								            sum(decode(b.npp,19,x.s,0)) S19, sum(decode(b.npp,20,x.s,0)) S20,
								            sum(decode(b.npp,21,x.s,0)) S21, sum(decode(b.npp,22,x.s,0)) S22,
								            sum(decode(b.npp,23,x.s,0)) S23, sum(decode(b.npp,24,x.s,0)) S24,
								            sum(decode(b.npp,25,x.s,0)) S25, sum(decode(b.npp,26,x.s,0)) S26,
								            sum(decode(b.npp,27,x.s,0)) S27, sum(decode(b.npp,28,x.s,0)) S28,
								            sum(decode(b.npp,29,x.s,0)) S29, sum(decode(b.npp,20,x.s,0)) S30,
								            sum(decode(b.npp,31,x.s,0)) S31, sum(decode(b.npp,32,x.s,0)) S32,
								            sum(decode(b.npp,33,x.s,0)) S33, sum(decode(b.npp,34,x.s,0)) S34,
								            sum(decode(b.npp,35,x.s,0)) S35, sum(decode(b.npp,36,x.s,0)) S36,
								            sum(decode(b.npp,37,x.s,0)) S37, sum(decode(b.npp,38,x.s,0)) S38,
								            sum(decode(b.npp,39,x.s,0)) S39, sum(decode(b.npp,40,x.s,0)) S40,
								            sum(decode(b.npp,41,x.s,0)) S41, sum(decode(b.npp,42,x.s,0)) S42,
								            sum(decode(b.npp,43,x.s,0)) S43, sum(decode(b.npp,44,x.s,0)) S44,
								            sum(decode(b.npp,45,x.s,0)) S45, sum(decode(b.npp,46,x.s,0)) S46,
								            sum(decode(b.npp,47,x.s,0)) S47, sum(decode(b.npp,48,x.s,0)) S48,
								            sum(decode(b.npp,49,x.s,0)) S49, sum(decode(b.npp,50,x.s,0)) S50,
								            sum(decode(b.npp,51,x.s,0)) S51, sum(decode(b.npp,52,x.s,0)) S52,
								            sum(decode(b.npp,53,x.s,0)) S53, sum(decode(b.npp,54,x.s,0)) S54,
								            sum(decode(b.npp,55,x.s,0)) S55, sum(decode(b.npp,56,x.s,0)) S56, 
								            sum(decode(b.npp,57,x.s,0)) S57, sum(decode(b.npp,58,x.s,0)) S58,
								            sum(decode(b.npp,59,x.s,0)) S59, sum(decode(b.npp,60,x.s,0)) S60,
								            sum(decode(b.npp,61,x.s,0)) S61, sum(decode(b.npp,62,x.s,0)) S62,
								            sum(decode(b.npp,63,x.s,0)) S63, sum(decode(b.npp,64,x.s,0)) S64,
								            sum(decode(b.npp,65,x.s,0)) S65, sum(decode(b.npp,66,x.s,0)) S66,
								            sum(decode(b.npp,67,x.s,0)) S67, sum(decode(b.npp,68,x.s,0)) S68,
								            sum(decode(b.npp,69,x.s,0)) S69, sum(decode(b.npp,70,x.s,0)) S70,
								            sum(decode(b.npp,71,x.s,0)) S71, sum(decode(b.npp,72,x.s,0)) S72,
								            sum(decode(b.npp,73,x.s,0)) S73, sum(decode(b.npp,74,x.s,0)) S74,
								            sum(decode(b.npp,75,x.s,0)) S75, sum(decode(b.npp,76,x.s,0)) S76,
								            sum(decode(b.npp,77,x.s,0)) S77, sum(decode(b.npp,78,x.s,0)) S78,
								            sum(decode(b.npp,79,x.s,0)) S79, sum(decode(b.npp,80,x.s,0)) S80
								     from (select id, branch, nvl(s,0)/100 s from bsb ) x, 
								          (select rownum npp, branch 
								           from (select branch from branch where length(branch)=15 order by branch)
								           ) b
								     where x.branch = b.branch  group by x.id 
								     ) s
								where bs1.id = s.id " || 
								      IifS(rb_ZAG, " and bs1.pu in(2,0) ", "") ||
								      IifS(sFilter="",""," and "||sFilter ) || 
								      IifS( cb_0 = 0, " and ( nvl(S.S00,0) <>0 OR bs1.KOD IS NULL) ","") ||" 
								order by 1"
					Else
						Set BAL.strSqlPopulate =
								"SELECT nvl(bs1.ord,bs1.id), bs1.id,
								        R.BRANCH, R.name, 
								        bs1.name,BSB.S/100, bs1.KOD, bs1.pu, bs1.ssql
								 INTO :BAL.ORD,:BAL.ID,:BAL.TOBO,:BAL.NAME_TOBO,:BAL.NAME,:BAL.S00,:BAL.KOD,:BAL.PU, :BAL.sFXLS
								 from bs1, BRANCH r, BSB  where bs1.id=BSB.ID and BSB.branch = r.branch " ||
								  IifS( cb_0 = 0, " and (BSB.S<>0 OR bs1.KOD IS NULL) ","") ||
								  IifS(rb_ZAG,    " and bs1.pu in(2,0) ", "") ||
								  IifS(sFilter="",""," and "||sFilter ) || "
								 ORDER BY r.BRANCH, nvl(bs1.ord,bs1.id) "
							Call SalTblSetColumnTitle( S00, 
									"Разом по
									" || IifS( rb_1,"МФО", IifS( rb_2,"Бранч 2+", "Бранч 3"  )  )
									 )
					! Скріть остальніе колонки
					Set II = II + 1
					While II < nColon +1 
						Set hCol= SalTblGetColumnWindow( hWndForm, ( nSdvig + II ), COL_GetID )
						Set II = II +1
						Call SalHideWindow( hCol )
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			! Number: nOB22
			Number: n980
			Number: nCol[*]
			Number: n6
			Number: n7
			Date/Time: DAT0
			Number: i6
			Number: i7
			Number: j6
			Number: j7
			Number: q6
			Number: q7
			Number: nRow
			String: sFilter
			String: sTmp
			String: sNbs
			String: sOb22
			String: rYYYY_MM
			! String: sBR
			String: sTitl
			Number: nSdvig
			Number: nColon
		Message Actions
			On SAM_Create
				Set hWndForm.BAL.nTabInstance = 1
				Call SetWindowFullSize( hWndForm )
				Set hWndForm.BAL.n980 = GetBaseVal()
				Set hWndForm.BAL.nCol[1] = SalColorFromRGB( 255,240,255 )
				Set hWndForm.BAL.nCol[2] = SalColorFromRGB( 220,255,255 )
				Set hWndForm.BAL.nCol[3] = SalColorFromRGB( 230,255,230 )
				Set BAL.strPrintFileName = 'BAL_'||Str(hWndForm.BAL.nPar)
				Set nSdvig = 7
				Set nColon = 80
				Call SalTblSetLockedColumns(hWndForm, nSdvig)
				Set DAT_RAB = GetBankDate()
				Set hWndForm.BAL.strFilterTblName = 'BS1'
				Set hWndForm.BAL.fFilterAtStart = 1
				Set rb_1   = TRUE
				Set rb_2   = FALSE
				Set rb_3   = FALSE
				! Call SalHideWindow( rb_3 )
				Set rb_BU  = TRUE
				Set rb_ZAG = FALSE
				! Set nOB22 = GetGlobalOptionEx('OB22')
				Set cb1 = 0
				!
				Call SalStatusSetText( hWndForm, sLibraryVersion )
				Call SalStatusSetVisible( hWndForm, TRUE )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalGetWindowText( hWndForm, sTitl, 50 )
				Call SalHideWindow( pb_Arch )
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalWaitCursor(FALSE)
				If hWndForm.BAL.fFilterAtStart
					If SetQueryFilter( cF )
						Set hWndForm.BAL.fFilterAtStart = NOT hWndForm.BAL.fFilterAtStart
				If hWndForm.BAL.fFilterAtStart
					Call SalDestroyWindow( hWndForm )
				!
				Call SalWaitCursor(TRUE)
				!
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call F_Zag_Col()
				!
				If cb1 = 1
					Call Debug (Subs(BAL.strSqlPopulate, 0001, 500))
					Call Debug (Subs(BAL.strSqlPopulate, 0501, 500))
					Call Debug (Subs(BAL.strSqlPopulate, 1001, 500 ))
					Call Debug (Subs(BAL.strSqlPopulate, 1501, 500))
					Call Debug (Subs(BAL.strSqlPopulate, 2001, 500 ))
					Call Debug (Subs(BAL.strSqlPopulate, 2501, 500))
					Call Debug (Subs(BAL.strSqlPopulate, 3001, 500 ))
					! Call Debug (Subs(BAL.strSqlPopulate, 3501, 500))
					! Call Debug (Subs(BAL.strSqlPopulate, 4001, 500 ))
				Call SalTblPopulate(hWndForm, hSql(), BAL.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalEnableWindow( pb_Run )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				!
				If PU = 2
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray)
				Else If PU = 0
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen)
					Set S00 = NUMBER_Null
					Set S01 = NUMBER_Null
					Set S02 = NUMBER_Null
					Set S03 = NUMBER_Null
					Set S04 = NUMBER_Null
					Set S05 = NUMBER_Null
					Set S06 = NUMBER_Null
					Set S07 = NUMBER_Null
					Set S08 = NUMBER_Null
					Set S09 = NUMBER_Null
					Set S10 = NUMBER_Null
					Set S11 = NUMBER_Null
					Set S12 = NUMBER_Null
					Set S13 = NUMBER_Null
					Set S14 = NUMBER_Null
					Set S15 = NUMBER_Null
					Set S16 = NUMBER_Null
					Set S17 = NUMBER_Null
					Set S18 = NUMBER_Null
					Set S19 = NUMBER_Null
					Set S20 = NUMBER_Null
					Set S21 = NUMBER_Null
					Set S22 = NUMBER_Null
					Set S23 = NUMBER_Null
					Set S24 = NUMBER_Null
					Set S25 = NUMBER_Null
					Set S26 = NUMBER_Null
					Set S27 = NUMBER_Null
					Set S28 = NUMBER_Null
					Set S29 = NUMBER_Null
					Set S30 = NUMBER_Null
					Set S31 = NUMBER_Null
					Set S32 = NUMBER_Null
					Set S33 = NUMBER_Null
					Set S34 = NUMBER_Null
					Set S35 = NUMBER_Null
					Set S36 = NUMBER_Null
					Set S37 = NUMBER_Null
					Set S38 = NUMBER_Null
					Set S39 = NUMBER_Null
					Set S40 = NUMBER_Null
					! Set S41 = NUMBER_Null
					! Set S42 = NUMBER_Null
					! Set S43 = NUMBER_Null
					! Set S44 = NUMBER_Null
					! Set S45 = NUMBER_Null
					! Set S46 = NUMBER_Null
					! Set S47 = NUMBER_Null
					! Set S48 = NUMBER_Null
					! Set S49 = NUMBER_Null
					! Set S50 = NUMBER_Null
	Table Window: FR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Тест Sql-Формул
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21488
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.683"
						Begin Y:  Class Default
						End X:  4.683"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21489
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  Class Default
						End X:  4.083"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 21490
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Пок.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: XLS
						код 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: sFXLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оригiнальна XLS-Формула
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  6.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sFSQL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: SQL-Формула
						Показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  6.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Пок.
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			! Function: F_Mod
				                                                                                           Description: 
				                                                                                           Returns 
				                                                                                           Parameters 
				                                                                                           Static Variables 
				                                                                                           Local variables 
					                                                                                           Long String: pFSQL
					                                                                                           Long String: pFXLS
				                                                                                           Actions 
					                                                                                           Set pFSQL = sFSQL
					                                                                                           Set pFXLS = sFXLS
					                                                                                           If SalModalDialog(dlg_SQL, hWndForm, TRUE, ID, KOD, NAME, pFSQL, pFXLS ) = 1
						                                                                                           Set sFSQL = pFSQL
						                                                                                           Set sFXLS = pFXLS
						                                                                                           Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTitl
			Long String: s_SQL
		Message Actions
			On SAM_Create
				Call SalTblSetLockedColumns(hWndForm, 3)
				Set hWndForm.FR.strFilterTblName = 'BS1'
				Set hWndForm.FR.strPrintFileName = 'BS1'
				Set hWndForm.FR.strSqlPopulate =
						"SELECT id, kod, name, FORM, ssql, TEST_SQL(FORM) 
						 INTO :hWndForm.FR.ID,   :hWndForm.FR.KOD,
						      :hWndForm.FR.NAME, :hWndForm.FR.sFSQL,
						      :hWndForm.FR.sFXLS,:hWndForm.FR.KOL 
						 from BS1 ORDER BY nvl(ord,id)"
				Set hWndForm.FR.strSqlUpdate =
						"Update bs1 set kod = :hWndForm.FR.KOD,
						                name= :hWndForm.FR.NAME,
						                FORM= :hWndForm.FR.sFSQL,
						                ssql= :hWndForm.FR.sFXLS 
						 where id =:hWndForm.FR.ID "  
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If hWndForm.FR.KOL = 0
					! Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,240,255 )  )
					Call XSalTblSetCellBackColor( sFSQL, SalColorFromRGB( 255,255,180) )
			! On SAM_DoubleClick
				                                                                                            Call F_Mod()
	! Dialog Box: dlg_SQL
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Тест SQL-формул
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  11.533"
				Width Editable? Yes
				Height: 6.381"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                           Description: 
		                                                                                           Tool Bar 
			                                                                                           Contents 
		                                                                                           Contents 
			                                                                                           Background Text: SQL 
			                                                                                           Background Text: v
			                                                                                           Background Text: ^
			                                                                                           Multiline Field: ml_SQL
				                                                                                           Message Actions 
					                                                                                           On SAM_AnyEdit
						                                                                                           Set fEdited = TRUE
			!
			                                                                                           Background Text: Оригинал_XLS
			                                                                                           Multiline Field: ml_XLS
				                                                                                           Message Actions 
					                                                                                           On SAM_AnyEdit
						                                                                                           Set fEdited = TRUE
			!
			                                                                                           Background Text: Ф   О    Р    М    У    Л    И 
		                                                                                           Functions 
		                                                                                           Window Parameters 
			                                                                                           Boolean: FL
			                                                                                           Number: ID
			                                                                                           String: KOD
			                                                                                           String: NAME
			                                                                                           Receive Long String: pFSQL
			                                                                                           Receive Long String: pFXLS
		                                                                                           Window Variables 
			                                                                                           Boolean: fEdited
			                                                                                           Number: K_
		                                                                                           Message Actions 
			                                                                                           On SAM_Create
				                                                                                           Set ml_XLS = pFXLS
				                                                                                           Set ml_SQL = pFSQL
				                                                                                           Call SalCenterWindow(hWndForm)
				                                                                                           Call SalSetWindowText( hWndForm, Str(ID) || ') ' || KOD || ' ' || NAME  )
			                                                                                           On SAM_Close
				                                                                                           If FL and fEdited
					                                                                                           If SqlPrepareAndExecute( hSql(),
							"SELECT TEST_SQL(:ml_SQL) into :K_ from dual " ) 
							and SqlFetchNext(hSql(), nFetchRes)  
						                                                                                           If K_ = 1 
								Or SalMessageBox(
								'Ош.синтаксис SQL-формулы ! 
								 Сохранить ее ?',
								 'Внимание !',
								MB_IconQuestion | MB_YesNo) = IDYES
							                                                                                           Set pFXLS = ml_XLS 
							                                                                                           Set pFSQL = ml_SQL 
							                                                                                           Call SalEndDialog(hWndForm, 1)
				!
				                                                                                           Call SalEndDialog(hWndForm, 0)
	Table Window: RTA	!! Для ОБ Рентабельность BRANCH по аналитите 6 -7 кл Идея ОБ (Ровно)
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Рентабельність по аналітичним рах. 6-7 класу
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.548"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Group Box: Показати звітний :
					Resource Id: 46844
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.155"
						Width:  7.5"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Check Box: cb_M
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Місяць
					Window Location and Size
						Left:   0.583"
						Top:    0.321"
						Width:  1.4"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Hide()
				Check Box: cb_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Квартал
					Window Location and Size
						Left:   2.283"
						Top:    0.321"
						Width:  1.4"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Hide()
				Check Box: cb_G
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Рік
					Window Location and Size
						Left:   3.983"
						Top:    0.321"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Hide()
				Check Box: cb_Razom
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Всі тільки "Разом"
					Window Location and Size
						Left:   5.383"
						Top:    0.321"
						Width:  2.3"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Razom()
				!
				Group Box: Розріз по установам :
					Resource Id: 46845
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.821"
						Width:  7.5"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
				Radio Button: rb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 1.МФО
					Window Location and Size
						Left:   0.583"
						Top:    1.071"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							! Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Call F_Run( 1,rbM  )
				Radio Button: rb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 2.ТВБВ
					Window Location and Size
						Left:   2.783"
						Top:    1.071"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							! Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Call F_Run( 1,rbM  )
				Radio Button: rb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 3.ТВБВ
					Window Location and Size
						Left:   5.383"
						Top:    1.071"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							! Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Call F_Run( 1,rbM  )
				!
				Group Box: Групування по :
					Resource Id: 46846
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.083"
						Top:    0.905"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				! Radio Button: rb_ALL
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: В цілому
					Window Location and Size
						Left:   8.683"
						Top:    1.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
.end
					                                                                            Message Actions 
						                                                                            On SAM_Click
							                                                                            Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_ZAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сумарнi Показники
					Window Location and Size
						Left:   8.283"
						Top:    1.071"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_BU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Всі Показники
					Window Location and Size
						Left:   10.983"
						Top:    1.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
					                                                                                                                                       Message Actions 
						                                                                                                                                       On SAM_Click
							                                                                                                                                       Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Check Box: cb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: з 0.00 - знач.
					Window Location and Size
						Left:   13.483"
						Top:    0.988"
						Width:  2.0"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						On SAM_Create
							Set cb_0 = 0
				!
				Group Box: Термін для розрахунку
					Resource Id: 46847
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.983"
						Top:    0.071"
						Width:  8.6"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Green
					Background Color: Default
				Combo Box: YYYYMM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   8.083"
						Top:    0.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 2.119"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If SqlPrepareAndExecute(hSql(),
									"SELECT distinct to_char(fdat,'yyyy-MM') INTO :sTmp
									 FROM fdat  
									 WHERE to_char(fdat,'yyyy-MM') < to_char(gl.BD,'yyyy-MM')
									ORDER BY 1 DESC")
								While SqlFetchNext(hSql(), nFetchRes)
									Call SalListAdd(YYYYMM, sTmp)
								Call SalListSetSelect(hWndItem, 0)
						! On SAM_Click
							                                                                                                                         Call NASELENIE()
						On SAM_SetFocus
							Call SalStatusSetText(hWndForm, 'Виберіть звітний місяць')
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунок за вибраний період'
						On SAM_Click
							Call F_Run( 1 , rbM  )
				Radio Button: rbM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: >
					Window Location and Size
						Left:   10.083"
						Top:    0.321"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rbD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: <
					Window Location and Size
						Left:   11.083"
						Top:    0.321"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Data Field: DAT_RAB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.238"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.483"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip1 = 'Виконати (До)Розмітку сітки планів бюджету на квартал '
							Set strTip  = strTip1 || ' указаної дати ' 
						On SAM_Click
							Set qMM = SalDateMonth( DAT_RAB )
							Set qYYYY = SalDateYear( DAT_RAB )
							If qMM <  4 
								Set qMM = 01
							Else If qMM <  7 
								Set qMM = 04
							Else If qMM <  10 
								Set qMM = 07
							Else
								Set qMM = 10
							Set qDat = SalDateConstruct( qYYYY, qMM, 01, 0, 0, 0 )
							Set strTip2 = strTip1 || SalFmtFormatDateTime( qDat, 'dd.MM.yyyy' )
							If SalMessageBox('Ви дійсно бажаєте 
									' || strTip2 || ' ? ', 'Увага ! ', MB_IconQuestion | MB_YesNo) = IDYES
								Call SalWaitCursor(TRUE)
								If SqlPrepareAndExecute( hSql(), 
										"insert into BU_PLAN (PDAT, ID, BRANCH ) 
										 select :qDat, u.id, b.branch  from bu1 u, branch b
										 where length(b.branch) in (8,15)   and not exists 
										(select 1 from BU_PLAN where PDAT= :qDat and ID=u.id and BRANCH=b.branch) " )
									Call SqlCommitEx(hSql(), strTip2 )
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( strTip2 || '
											 Виконано !','Повідомлення',3,0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.083"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46848
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.683"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.483"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.283"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46849
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.883"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46850
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: DatY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.083"
							Top:    0.655"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DatQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.655"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Y <-  План  -> Q
					Resource Id: 10861
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.883"
						Top:    0.702"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.483"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Квартальні плани по бюджету
									IV кв ' || sYYYYp || 'р. , I-IV кв ' || sYYYYt || 'р. , I кв ' || sYYYYb || 'р.' 
						On SAM_Click
							! Call FunNSIEditF("V_BUPLAN",2)
							Call Sel030(hWndMDI,14,0,"","")
		Contents
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						одиниці
						Розрізу
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  2.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						одиниці
						Розрізу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						одиниці
						груп
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						одиниці
						групування
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: D6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Доходи
						Місяця
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Видатки
						Місяця
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Прибуток
						Місяця
						3 = 1 - 2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						Рентаб
						Місяця
						4 = 3 / 2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом за 
						Місяць
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PLM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: План на 
						Місяць
						К/3
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RPM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рiзниця M
						Факт -
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FPM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: % M
						Факт :
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: K6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Доходи
						Кварталу
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Видатки
						Кварталу
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Прибуток
						Кварталу
						8 = 6 - 7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						Рентаб
						Кварталу
						9 = 8 / 7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом за 
						Квартал
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: План на 
						Квартал
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RPK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рiзниця К
						Факт -
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FPK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: % К
						Факт :
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Доходи
						Року
						11
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Видатки
						Року
						12
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Прибуток
						Року
						13=11-12
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						Рентаб
						Року
						14=13/12
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом за 
						Рік
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PLY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: План  
						с початку
						Року
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RPY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рiзниця Р
						Факт -
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FPY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: % Р
						Факт :
						План  
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сист.
						код
						показника
				Visible? Class Default
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMBER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Норм.знак
				Visible? No
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Col
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set hWndForm.RTA.D  = hWndForm.RTA.D6 - hWndForm.RTA.D7
					Set hWndForm.RTA.K  = hWndForm.RTA.K6 - hWndForm.RTA.K7
					Set hWndForm.RTA.S  = hWndForm.RTA.S6 - hWndForm.RTA.S7
					!
					If hWndForm.RTA.D7 != NUMBER_Null and hWndForm.RTA.D7 != 0 and 
							   hWndForm.RTA.D6 != NUMBER_Null and hWndForm.RTA.D6 != 0
						Set hWndForm.RTA.DR =  hWndForm.RTA.D * 100 / hWndForm.RTA.D7
					If hWndForm.RTA.K7 != NUMBER_Null and hWndForm.RTA.K7 != 0 and
							   hWndForm.RTA.K6 != NUMBER_Null and hWndForm.RTA.K6 != 0
						Set hWndForm.RTA.KR =  hWndForm.RTA.K * 100 / hWndForm.RTA.K7
					If hWndForm.RTA.S7 != NUMBER_Null and hWndForm.RTA.S7 != 0 and
							   hWndForm.RTA.S6 != NUMBER_Null and hWndForm.RTA.S6 != 0
						Set hWndForm.RTA.SR =  hWndForm.RTA.S * 100 / hWndForm.RTA.S7
					Call XSalTblSetCellBackColor( hWndForm.RTA.D6, hWndForm.RTA.nCol[2] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.K6, hWndForm.RTA.nCol[2] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.S6, hWndForm.RTA.nCol[2] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.D7, hWndForm.RTA.nCol[1] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.K7, hWndForm.RTA.nCol[1] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.S7, hWndForm.RTA.nCol[1] )
					!
					Call XSalTblSetCellBackColor( hWndForm.RTA.D, hWndForm.RTA.nCol[3] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.DR,hWndForm.RTA.nCol[3] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.K, hWndForm.RTA.nCol[3] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.KR,hWndForm.RTA.nCol[3] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.S, hWndForm.RTA.nCol[3] )
					Call XSalTblSetCellBackColor( hWndForm.RTA.SR,hWndForm.RTA.nCol[3] )
					If SalNumberMod( ID, 100 ) = 0
						Call XSalTblSetCellBackColor( NBS,COLOR_LightGray )
						Call XSalTblSetCellBackColor( NAME_NBS,COLOR_LightGray )
			Function: F_Run
				Description:
				Returns
					Boolean:
				Parameters
					Number: nMode  ! = -1 перерахунок планів, +1 = Розрахунок факту
					Boolean: b_M
				Static Variables
				Local variables
					! Number: nMM
					Number: nM1
				Actions
					Call SalWaitCursor(TRUE)
					Call SalDisableWindow( pb_Run )
					Set DatQ = DATETIME_Null
					Set nUr = IifN (rb_1,1, IifN (rb_2,2,IifN (rb_3,3,4 ) ) ) 
					If b_M 
						Call SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 1, nUr * nMode, YYYYMM, DAT_RAB)" )
						Set nMM = Val(Subs(YYYYMM,6,2))
					Else
						If SqlPrepareAndExecute( hSql(),
								"select to_number(to_char(fdat,'MM')) into :nMM from fdat where fdat=:DAT_RAB")
								and NOT SqlFetchNext( hSql(), nFetchRes )
							Call SalWaitCursor(FALSE)
							Call SalMessageBox(
									"Указаний день 
									" ||
									 SalFmtFormatDateTime( DAT_RAB, 'dd/MM/yyyy' )||
									"НЕ є Банківським !",
									'Помилка !',
									 MB_IconStop)
							Call SalEnableWindow( pb_Run )
							Return FALSE 
						If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 2, nUr * nMode , YYYYMM, DAT_RAB)" )
							Call SqlCommit(hSql() )
					!
					If nMM = 1 or nMM = 2 or nMM = 3
						Set nM1 =1
					Else If nMM = 4 or nMM = 5 or nMM = 6
						Set nM1 = 4
					Else If nMM = 7 or nMM = 8 or nMM = 9
						Set nM1 = 7
					Else If nMM = 10 or nMM =11 or nMM =12
						Set nM1 = 10
					!
					Set DatQ = SalDateConstruct( Val(Subs(YYYYMM,1,4)), nM1, 1, 0, 0, 0 )
					Set DatY = SalDateConstruct( Val(Subs(YYYYMM,1,4)), 1, 1, 0, 0, 0 )
					Set KolM =  SalNumberMod( nMM, 3 )
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return TRUE
			Function: F_Hide
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					!
					If cb_M != 1 
						Call SalHideWindow( D6 )
						Call SalHideWindow( D7 )
						Call SalHideWindow( D )
						Call SalHideWindow( DR )
						Call SalHideWindow( IM )
						!
						Call SalHideWindow( PLM )
						Call SalHideWindow( RPM )
						Call SalHideWindow( FPM )
					Else
						Call SalShowWindow( D6 )
						Call SalShowWindow( D7 )
						Call SalShowWindow( D )
						Call SalShowWindow( DR )
						Call SalShowWindow( IM )
						!
						Call SalShowWindow( PLM )
						Call SalShowWindow( RPM )
						Call SalShowWindow( FPM )
					If cb_K != 1 
						Call SalHideWindow( K6 )
						Call SalHideWindow( K7 )
						Call SalHideWindow( K )
						Call SalHideWindow( KR )
						Call SalHideWindow( IK )
						!
						Call SalHideWindow( PLK )
						Call SalHideWindow( RPK )
						Call SalHideWindow( FPK )
					Else
						Call SalShowWindow( K6 )
						Call SalShowWindow( K7 )
						Call SalShowWindow( K )
						Call SalShowWindow( KR )
						Call SalShowWindow( IK )
						!
						Call SalShowWindow( PLK )
						Call SalShowWindow( RPK )
						Call SalShowWindow( FPK )
					If cb_G != 1 
						Call SalHideWindow( S6 )
						Call SalHideWindow( S7 )
						Call SalHideWindow( S )
						Call SalHideWindow( SR )
						Call SalHideWindow( IG )
						!
						Call SalHideWindow( PLY )
						Call SalHideWindow( RPY )
						Call SalHideWindow( FPY )
					Else
						Call SalShowWindow( S6 )
						Call SalShowWindow( S7 )
						Call SalShowWindow( S )
						Call SalShowWindow( SR )
						Call SalShowWindow( IG )
						!
						Call SalShowWindow( PLY )
						Call SalShowWindow( RPY )
						Call SalShowWindow( FPY )
					!
					If rb_1
						Call SalHideWindow( TOBO )
						Call SalHideWindow( NAME )
					Else
						Call SalShowWindow( TOBO )
						Call SalShowWindow( NAME )
					!
					If FALSE
						Call SalHideWindow( NBS )
						Call SalHideWindow( NAME_NBS )  
					Else
						Call SalShowWindow( NBS )
						Call SalShowWindow( NAME_NBS )  
						If cb_M = 1
							Call SalHideWindow( D )
							Call SalHideWindow( DR )  
						If cb_G = 1
							Call SalHideWindow( S )
							Call SalHideWindow( SR )  
						If cb_K = 1
							Call SalHideWindow( K )
							Call SalHideWindow( KR )  
			Function: F_Razom
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					!
					If cb_Razom = 1 
						! MMMMMM
						Call SalHideWindow( D6 )
						Call SalHideWindow( D7 )
						Call SalHideWindow( D )
						Call SalHideWindow( DR )
						!
						Call SalShowWindow( IM )
						Call SalShowWindow( PLM )
						Call SalShowWindow( RPM )
						Call SalShowWindow( FPM )
						! QQQQQQ
						Call SalHideWindow( K6 )
						Call SalHideWindow( K7 )
						Call SalHideWindow( K )
						Call SalHideWindow( KR )
						!
						Call SalShowWindow( IK )
						Call SalShowWindow( PLK )
						Call SalShowWindow( RPK )
						Call SalShowWindow( FPK )
						! YYYYYY
						Call SalHideWindow( S6 )
						Call SalHideWindow( S7 )
						Call SalHideWindow( S )
						Call SalHideWindow( SR )
						!
						Call SalShowWindow( IG )
						Call SalShowWindow( PLY )
						Call SalShowWindow( RPY )
						Call SalShowWindow( FPY )
						! !!!!!!!!!
						Call SalHideWindow( cb_M )
						Call SalHideWindow( cb_K )
						Call SalHideWindow( cb_G )
					Else
						Call SalShowWindow( cb_M )
						Call SalShowWindow( cb_K )
						Call SalShowWindow( cb_G )
						Call F_Hide ()
			Function: F_DATQ
				Description:
				Returns
					Date/Time:
				Parameters
					Date/Time: pDat
				Static Variables
				Local variables
					Number: nYear
					Number: nMonth
					Number: nDay
				Actions
					Set nDay =  1
					Set nYear = SalDateYear( pDat )
					Set nMonth = SalDateMonth( pDat )
					If nMonth = 1 or nMonth = 2 or nMonth = 3
						Set nMonth =1
					Else If nMonth = 4 or nMonth = 5 or nMonth = 6
						Set nMonth = 4
					Else If nMonth = 7 or nMonth = 8 or nMonth = 9
						Set nMonth = 7
					Else If nMonth = 10 or nMonth =11 or nMonth =12
						Set nMonth = 10
					Return SalDateConstruct( nYear, nMonth, nDay, 0, 0, 0 )
		Window Parameters
			Number: nPar
			Number: pPAP
			String: sNBS
			Number: pKV
			String: pTOBO
			Boolean: b0
			Boolean: b1
			Boolean: b2
			Boolean: b3
			Boolean: b4
			String: pcmb_KV
			Number: pKurs
			String: pcmb_TOBO
		Window Variables
			Number: nOB22
			Number: nUr
			Number: n980
			Number: nCol[*]
			Number: n6
			Number: n7
			Date/Time: DAT0
			Number: i6
			Number: i7
			Number: j6
			Number: j7
			Number: q6
			Number: q7
			Number: nRow
			String: sFilter
			String: sTmp
			String: sNbs
			String: sOb22
			String: sTitl 
			String: BU_PLAN
			String: BU_PLANY
			String: tBRANCH
			String: strTip1
			String: strTip2
			Number: KolM
			!
			Number: Y900
			Number: K900
			Number: M900
			!
			Number: Y1000
			Number: K1000
			Number: M1000
			!
			Number: Y1100
			Number: K1100
			Number: M1100
			!
			Date/Time: qDat
			Number: qMM
			Number: qYYYY
			!
			Number: nMM
			String: sYYYYp    
			String: sYYYYt 
			String: sYYYYb
		Message Actions
			On SAM_Create
				Set hWndForm.RTA.nTabInstance = 1
				Call SetWindowFullSize( hWndForm )
				Set hWndForm.RTA.n980 = GetBaseVal()
				Set hWndForm.RTA.nCol[1] = SalColorFromRGB( 255,240,255 )
				Set hWndForm.RTA.nCol[2] = SalColorFromRGB( 220,255,255 )
				Set hWndForm.RTA.nCol[3] = SalColorFromRGB( 230,255,230 )
				Set RTA.strPrintFileName = 'RTA_'||Str(hWndForm.RTA.nPar)
				Set sYYYYt = Str( SalDateYear ( SalDateCurrent ( ) ) )
				Set sYYYYp = Str( SalDateYear ( SalDateCurrent ( ) )-1 )
				Set sYYYYb = Str( SalDateYear ( SalDateCurrent ( ) )+1 )
				Call SalTblSetLockedColumns(hWndForm, 4)
				Set DAT_RAB = GetBankDate()
				Set hWndForm.RTA.strFilterTblName = 'BRANCH'
				Set hWndForm.RTA.fFilterAtStart = 1
				Set rb_1   = TRUE
				Set rb_2   = FALSE
				! Set rb_3   = FALSE
				Set rb_BU  = TRUE
				Set rb_ZAG = FALSE
				Set nOB22 = GetGlobalOptionEx('OB22')
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalGetWindowText( hWndForm, sTitl, 50 )
				Set cb_M = 1
				Set cb_K = 1
				Set cb_G = 1
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalWaitCursor(FALSE)
				If hWndForm.RTA.fFilterAtStart
					If SetQueryFilter( cF )
						Set hWndForm.RTA.fFilterAtStart = NOT hWndForm.RTA.fFilterAtStart
				If hWndForm.RTA.fFilterAtStart
					Call SalDestroyWindow( hWndForm )
				!
				Call SalWaitCursor(TRUE)
				Call SalSetWindowText( hWndForm, sTitl || '. Зв.перiод ' || YYYYMM )
				Call F_Hide()
				Set BU_PLAN = '(select Sum(nvl(sp,0)) from bu_plan where pdat  = :DatQ and branch=t.BRANCH and id=b.id)'
				Set BU_PLANY= '(select Sum(nvl(sp,0)) from bu_plan where pdat >= :DatY and pdat <= :DatQ and branch=t.BRANCH and id=b.id)'
				Set sFilter = ""
				If rb_1
					! Set tBRANCH = 
							"(select BRANCH,NAME from branch where length(branch) =8 ) t "
					Set BU_PLAN = '(select Sum ( nvl(sp,0) ) from bu_plan where pdat  = :DatQ and id=b.id )'
					Set BU_PLANY= '(select Sum ( nvl(sp,0) ) from bu_plan where pdat >= :DatY and pdat <= :DatQ and id=b.id )'
					Set RTA.strSqlPopulate =
							"SELECT b.id,  b.KOD, b.name,  b.NAMBER,
							        nvl(a.d6/100,0),nvl(a.d7/100,0),nvl(a.s6/100,0),nvl(a.s7/100,0),
							        nvl(a.k6/100,0),nvl(a.k7/100,0)," || BU_PLAN || " , " || BU_PLANY || " 
							 INTO :RTA.ID, :RTA.NBS, :RTA.NAME_NBS, :RTA.NAMBER,
							      :RTA.D6, :RTA.D7, :RTA.S6, :RTA.S7,:RTA.K6,:RTA.K7, :RTA.PLK, :RTA.PLY 
							 FROM  ANI_BU a , bu1 b 
							 WHERE " || IifS( rb_ZAG, " mod(b.ID,100)=0 and ","" ) || " b.id=a.ID " || IifS(cb_0=0, "", " 
							union all 
							SELECT b.id,b.KOD,b.name,b.NAMBER,0,0,0,0,0,0," || BU_PLAN || " , " || BU_PLANY || " 
							 FROM bu1 b  WHERE " || IifS( rb_ZAG, " mod(b.ID,100)=0 and ","" ) || 
							      " not exists (select 1 from ANI_BU where id=b.id ) " ) || 
							" ORDER BY 1,2 "
				Else
					Set sFilter = cF.GetFilterWhereClause( FALSE )
					Set tBRANCH = 
							"(select BRANCH,NAME from branch where length(branch)=15 " || IifS(sFilter="",""," and " || sFilter ) || ") t "
					Set RTA.strSqlPopulate =
							"SELECT t.BRANCH,b.id, t.name, b.KOD, b.name,  b.NAMBER,
							        nvl(a.d6/100,0),nvl(a.d7/100,0),nvl(a.s6/100,0),nvl(a.s7/100,0),
							        nvl(a.k6/100,0),nvl(a.k7/100,0)," || BU_PLAN || " , " || BU_PLANY || " 
							 INTO :RTA.TOBO, :RTA.ID, :RTA.NAME, :RTA.NBS, :RTA.NAME_NBS, :RTA.NAMBER,
							      :RTA.D6, :RTA.D7, :RTA.S6, :RTA.S7,:RTA.K6,:RTA.K7, :RTA.PLK, :RTA.PLY 
							 FROM " || tBRANCH || ", ANI_BU a , bu1 b 
							 WHERE " || IifS( rb_ZAG, " mod(b.ID,100)=0 and ","" ) || 
							       " b.id = a.ID  and t.BRANCH = a.branch " || IifS(cb_0 = 0, "", " 
							union all 
							SELECT t.BRANCH,b.id,t.name,b.KOD,b.name,b.NAMBER,0,0,0,0,0,0," || BU_PLAN || " , " || BU_PLANY || " 
							 FROM " || tBRANCH || ",bu1 b 
							 WHERE " || IifS( rb_ZAG, " mod(b.ID,100)=0 and ","" ) || 
							       " not exists (select 1 from ANI_BU where id=b.id and branch=t.BRANCH) " ) || 
							"  ORDER BY 1,2 "
				! Call Debug(Subs(strSqlPopulate, 001,200) )
				! Call Debug(Subs(strSqlPopulate, 201,200) )
				! Call Debug(Subs(strSqlPopulate, 401,200) )
				! Call Debug(Subs(strSqlPopulate, 601,200) )
				! If rb_ZAG
					    Set RTA.strSqlPopulate =
							"SELECT BRANCH.BRANCH, BRANCH.name, 
							        b.KOD, b.name, b.id, b.NAMBER,
							        nvl(TANI_BUd6/100,0),
							        nvl(ANI_BU.d7/100,0),
							        nvl(ANI_BU.s6/100,0), 
							        nvl(ANI_BU.s7/100,0),
							        nvl(ANI_BU.k6/100,0),
							        nvl(ANI_BU.k7/100,0),
							     " || BU_PLAN || " , " || BU_PLANY || " 
							 INTO :RTA.TOBO, :RTA.NAME, :RTA.NBS, :RTA.NAME_NBS, :RTA.ID, :RTA.NAMBER,
							      :RTA.D6, :RTA.D7, :RTA.S6, :RTA.S7,:RTA.K6,:RTA.K7, :RTA.PLK, :RTA.PLY 
							 FROM BRANCH, ANI_BU, bu1 b 
							 WHERE mod(b.ID,100)=0 and b.id = ANI_BU.ID " || IifS(cb_0=1, "(+) " ,"" ) || " 
							   and BRANCH.BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') 
							   and BRANCH.BRANCH = ANI_BU.branch " || 
							        IifS(sFilter="",""," and "||sFilter ) || " 
							  ORDER BY BRANCH.BRANCH, b.id "
				! Else If rb_BU
					    Set RTA.strSqlPopulate =
							"SELECT BRANCH.BRANCH, BRANCH.name, 
							        b.KOD, b.name, b.id, b.NAMBER, 
							        nvl(TANI_BUd6/100,0),
							        nvl(ANI_BU.d7/100,0),
							        nvl(ANI_BU.s6/100,0), 
							        nvl(ANI_BU.s7/100,0),
							        nvl(ANI_BU.k6/100,0),
							        nvl(ANI_BU.k7/100,0),  
							      " || BU_PLAN || " , " || BU_PLANY || " 
							 INTO :RTA.TOBO, :RTA.NAME, :RTA.NBS, :RTA.NAME_NBS, :RTA.ID, :RTA.NAMBER,
							      :RTA.D6, :RTA.D7, :RTA.S6, :RTA.S7,:RTA.K6,:RTA.K7, :RTA.PLK, :RTA.PLY  
							 FROM BRANCH, ANI_BU, bu1 b 
							 WHERE b.id=ANI_BU.ID " || IifS(cb_0=1, "(+) " ,"" ) || " 
							   and BRANCH.BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') 
							   and BRANCH.BRANCH = ANI_BU.branch "||
							       IifS(sFilter="",""," and "||sFilter ) || " 
							 ORDER BY BRANCH.BRANCH, b.id "
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				!
				Set i6=0
				Set i7=0
				Set j6=0
				Set j7=0
				Set q6=0
				Set q7=0
				Call SalTblPopulate(hWndForm, hSql(), RTA.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalEnableWindow( pb_Run )
				Call F_Razom ()
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If hWndForm.RTA.ID < 2000
					Set hWndForm.RTA.D6 = hWndForm.RTA.S6 - hWndForm.RTA.D6
					Set hWndForm.RTA.D7 = hWndForm.RTA.S7 - hWndForm.RTA.D7
					Set hWndForm.RTA.K6 = hWndForm.RTA.S6 - hWndForm.RTA.K6
					Set hWndForm.RTA.K7 = hWndForm.RTA.S7 - hWndForm.RTA.K7
					Call F_Col ()
					Set hWndForm.RTA.i6 = hWndForm.RTA.i6 + hWndForm.RTA.D6
					Set hWndForm.RTA.i7 = hWndForm.RTA.i7 + hWndForm.RTA.D7
					Set hWndForm.RTA.q6 = hWndForm.RTA.q6 + hWndForm.RTA.K6
					Set hWndForm.RTA.q7 = hWndForm.RTA.q7 + hWndForm.RTA.K7
					Set hWndForm.RTA.j6 = hWndForm.RTA.j6 + hWndForm.RTA.S6
					Set hWndForm.RTA.j7 = hWndForm.RTA.j7 + hWndForm.RTA.S7
					Set IM = D6-D7
					Set IK = K6-K7
					Set IG = S6-S7
				Else
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize)
					Set IM = D6
					Set IK = K6
					Set IG = S6
				If rbM
				Else
					Set K6 = NUMBER_Null
					Set K7 = NUMBER_Null
					Set K  = NUMBER_Null
					Set KR = NUMBER_Null
					Set IK = NUMBER_Null
				!
				If ID < 2000 and  PLK !=0 and PLK != NUMBER_Null
					Set PLM = PLK/3
					If KolM >0 
						Set PLY = PLY - PLK + (PLM * KolM)
					If ID = 900
						Set M900 = PLM
						Set K900 = PLK
						Set Y900 = PLY
					Else If ID = 1000
						Set M1000 = PLM
						Set K1000 = PLK
						Set Y1000 = PLY
					Else If ID = 1100
						Set M1100 = PLM
						Set K1100 = PLK
						Set Y1100 = PLY
				If ID = 2100
					! 09-09-2011 план численности по постановке Днепр РУ 
							From: romanchenkorv [mailto:romanchenkorv@savebank.dp.ua] 
							----------------------------------------------------------
							-- Б) Здесь мы используем ВСЕ предыдущие кварталы текущего года
							Если мес ХХ = 01,02,03 –   [кв 01]
							Если мес ХХ = 04,05,06 – ( [кв 01]*3                         + [кв 04]* (XX-3) ) / XX
							Если мес ХХ = 07,08,09 – ( [кв 01]*3 + [кв 04]*3             + [кв 07]* (XX-6) ) / XX
							Если мес ХХ = 10,11,12 – ( [кв 01]*3 + [кв 04]*3 + [кв 07]*3 + [кв 10]* (XX-9) ) / XX
							
					! PLY - здесь сумма планов всех кв с начала тек года, 
							вычитаем  тек кв, и имеем сумму все планов пред кв (что и требуется)
					Set PLY = (PLY - PLK) * 3
					If nMM <= 3
						Set PLM = PLK
					Else If nMM <= 6
						Set PLM = ( PLY + PLK * (nMM-3) ) / nMM
					Else If nMM <= 9
						Set PLM = ( PLY + PLK * (nMM-6) ) / nMM
					Else If nMM <=12
						Set PLM = ( PLY + PLK * (nMM-9) ) / nMM
					Set PLY = PLM
				If ID = 2300
					If M900 != 0
						Set PLM = M1000*100/ M900
					If K900 != 0
						Set PLK = K1000*100/ K900
					If Y900 != 0
						Set PLY = Y1000*100 / Y900
				If ID = 2400
					If M900 != 0
						Set PLM = M1100*100 / M900
					If K900 != 0
						Set PLK = K1100*100 / K900
					If Y900 != 0
						Set PLY = Y1100*100/ Y900
				If ID = 2500
					If M900 != 0
						Set PLM = (M1000+M1100)*100 / M900
					If K900 != 0
						Set PLK = (K1000+K1100)*100 / K900
					If Y900 != 0
						Set PLY = (Y1000+Y1100)*100 / Y900
				!
				If PLM !=0 and PLM != NUMBER_Null
					Set FPM = NAMBER * IM *100 / PLM
					Set RPM = NAMBER * IM - PLM
				If PLK !=0 and PLK != NUMBER_Null
					Set FPK = NAMBER * IK * 100 /PLK 
					Set RPK = NAMBER * IK - PLK
				If PLY != 0 and PLY != NUMBER_Null
					Set FPY = NAMBER * IG * 100/PLY
					Set RPY = NAMBER * IG - PLY
			On SAM_DoubleClick
	Table Window: RTB	!! Рентабельность ТОБО только по аналитите 6 -7 кл Идея ОБ (Ровно)
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Рентабельность ТОБО только по аналитике 6-7
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.583"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10321
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10322
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10323
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.883"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата початку періоду розрахунку')
						On SAM_Validate
							Call F_DAT()
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.683"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершення періоду розрахунку')
						On SAM_Validate
							Call F_DAT()
				Frame
					Resource Id: 10324
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.283"
						Top:    0.071"
						Width:  8.5"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Radio Button: rb_TOBO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По ТВБВ
					Window Location and Size
						Left:   8.583"
						Top:    0.155"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_TOBO_NBS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По ТВБВ+Аналітика
					Window Location and Size
						Left:   10.483"
						Top:    0.155"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_NBS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По Аналітиці
					Window Location and Size
						Left:   13.65"
						Top:    0.179"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: B040
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код НБУ
						ТОБО
				Visible? Class Default
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код внутр.
						ТОБО
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва ТОБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						аналітики
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: D6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Доходи
						періоду
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Видатки
						періоду
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Прибуток
						періоду
						3 = 1 - 2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.65"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						Рентаб
						періоду
						4 = 3 / 2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! cColumnLabeled: IM
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом за 
						період
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                   List Values 
				                                                                                                                                   Message Actions 
			!
			Column: S6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Доходи
						року
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Видатки
						року
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Грн
						Прибуток
						року
						8 = 6 - 7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						Рентаб
						року
						9 = 8 / 7
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! cColumnLabeled: IG
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разом за 
						рік
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                   List Values 
				                                                                                                                                   Message Actions 
			!
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT1 > DAT2
						Call SalMessageBox(
								"Дата Початку НЕ може бути більшою Дати завершення !",
								"Увага, помилка !", MB_IconStop)
						Set DAT2 = GetBankDate() - 1
						Set DAT1 = AddMonths( DAT2, -1 ) + 1
					Set DAT0 = DAT1 - 1
			Function: F_Col
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set D  = D6 + D7
					Set S  = S6 + S7
					If D7 != NUMBER_Null and D7 != 0
						Set DR = - D * 100 / D7
					If S7 != NUMBER_Null and S7 != 0
						Set SR = - S * 100 / S7
					Call XSalTblSetCellBackColor( D6, nCol[2] )
					Call XSalTblSetCellBackColor( S6, nCol[2] )
					Call XSalTblSetCellBackColor( D7, nCol[1] )
					Call XSalTblSetCellBackColor( S7, nCol[1] )
					!
					Call XSalTblSetCellBackColor( D, nCol[3] )
					Call XSalTblSetCellBackColor( DR,nCol[3] )
					Call XSalTblSetCellBackColor( S, nCol[3] )
					Call XSalTblSetCellBackColor( SR,nCol[3] )
		Window Parameters
			Number: nPar
			Number: pPAP
			String: sNBS
			Number: pKV
			String: pTOBO
			Boolean: b0
			Boolean: b1
			Boolean: b2
			Boolean: b3
			Boolean: b4
			String: pcmb_KV
			Number: pKurs
			String: pcmb_TOBO
		Window Variables
			Number: n980
			Number: nCol[*]
			Number: n6
			Number: n7
			Date/Time: DAT0
			Number: i6
			Number: i7
			Number: j6
			Number: j7
			Number: nRow
			String: sFilter
			String: sTmp
			String: sNbs
		Message Actions
			On SAM_Create
				Set hWndForm.RTB.nTabInstance = 1
				Set hWndForm.RTB.fFilterAtStart = 1
				Set hWndForm.RTB.strPrintFileName = 'RTB_'||Str(nPar)
				Set hWndForm.RTB.strFilterTblName = 'TOBO'
				Set n980 = GetBaseVal()
				Set nCol[1] = SalColorFromRGB( 255,240,255 )
				Set nCol[2] = SalColorFromRGB( 220,255,255 )
				Set nCol[3] = SalColorFromRGB( 230,255,230 )
				Call SalTblSetLockedColumns(hWndForm, 3)
				Set DAT2 = GetBankDate()
				Set DAT1 = AddMonths( DAT2, -1 ) + 1
				Set rb_TOBO = TRUE
				Set rb_NBS  = FALSE
				Set rb_TOBO_NBS= FALSE
				Call F_DAT()
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If hWndForm.RTB.fFilterAtStart
					If SetQueryFilter( cF )
						Set hWndForm.RTB.fFilterAtStart = NOT hWndForm.RTB.fFilterAtStart
				If hWndForm.RTB.fFilterAtStart
					Call SalDestroyWindow( hWndForm )
				!
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalShowWindow( B040 )
				Call SalShowWindow( TOBO )
				Call SalShowWindow( NAME )
				Call SalShowWindow( NBS )
				Call SalShowWindow( DR )
				Call SalShowWindow( SR )
				If rb_TOBO
					Call SalHideWindow( NBS )
					Set RTB.strSqlPopulate =
							"SELECT TOBO.B040, TOBO.tobo, TOBO.name, p.d6, p.d7, p.s6, p.s7
							 INTO :RTB.B040, :RTB.TOBO, :RTB.NAME, :RTB.D6, :RTB.D7, :RTB.S6, :RTB.S7
							 FROM TOBO,
							  (select nvl(a.tobo,'0') TOBO,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT0),0 ))/100 d6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT0),0 ))/100 d7,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT2),0 ))/100 s6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT2),0 ))/100 s7
							   from accounts a
							   where substr(a.nbs,1,1) in ('6','7')
							   group by nvl(a.tobo,'0')
							  ) p
							 WHERE "|| IifS(nHaveTOBO != 2,"",
							"TOBO.tobo LIKE SYS_CONTEXT('bars_context','user_branch_mask') and " ) ||
							"TOBO.tobo =p.tobo (+) " || IifS(sFilter="",""," and "||sFilter ) ||
							" ORDER BY TOBO.tobo "
				Else If rb_TOBO_NBS
					Call SalHideWindow( DR )
					Call SalHideWindow( SR )
					Set RTB.strSqlPopulate =
							"SELECT TOBO.B040, TOBO.tobo, TOBO.name, p.d6, p.d7, p.s6, p.s7, p.NBS
							 INTO :RTB.B040,:RTB.TOBO,:RTB.NAME,:RTB.D6,:RTB.D7,:RTB.S6,:RTB.S7,:RTB.NBS
							 FROM TOBO,
							  (select nvl(a.tobo,'0') TOBO, a.nbs,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT0),0 ))/100 d6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT0),0 ))/100 d7,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT2),0 ))/100 s6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT2),0 ))/100 s7
							   from accounts a
							   where substr(a.nbs,1,1) in ('6','7')
							   group by nvl(a.tobo,'0'),a.nbs
							  ) p
							 WHERE "|| IifS(nHaveTOBO != 2,"",
							"TOBO.tobo LIKE SYS_CONTEXT('bars_context','user_branch_mask') and " ) ||
							"TOBO.tobo =p.tobo (+) " || IifS(sFilter="",""," and "||sFilter ) ||
							" ORDER BY TOBO.tobo, p.NBS "
				Else If rb_NBS
					Call SalHideWindow( B040 )
					Call SalHideWindow( TOBO )
					Call SalHideWindow( NAME )
					Call SalHideWindow( DR )
					Call SalHideWindow( SR )
					Set RTB.strSqlPopulate =
							"SELECT  p.d6, p.d7, p.s6, p.s7,   p.NBS
							 INTO :RTB.D6, :RTB.D7, :RTB.S6, :RTB.S7, :RTB.NBS
							 FROM
							  (select a.nbs,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT0),0 ))/100 d6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT0),0 ))/100 d7,
							    sum(decode(substr(a.nbs,1,1),'6', Fost(a.acc,:DAT2),0 ))/100 s6,
							    sum(decode(substr(a.nbs,1,1),'7', Fost(a.acc,:DAT2),0 ))/100 s7
							   from accounts a,  tobo
							   where substr(a.nbs,1,1) in ('6','7')  and "||
							 IifS(nHaveTOBO != 2,"",
							"TOBO.tobo LIKE SYS_CONTEXT('bars_context','user_branch_mask') and " ) ||
							"TOBO.tobo =a.tobo " || IifS(sFilter="",""," and "||sFilter ) || "
							   group by a.nbs
							  ) p
							 ORDER BY p.NBS "
				Set i6=0
				Set i7=0
				Set j6=0
				Set j7=0
				Call SalTblPopulate(hWndForm, hSql(), RTB.strSqlPopulate, TBL_FillAll)
				!
				Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
				Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
				Call SalTblFetchRow(hWndForm, nRow )
				Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
				Set NAME='В цілому по банку'
				Set D6 = i6
				Set D7 = i7
				Set S6 = j6
				Set S7 = j7
				! Set IM = D6+D7
				! Set IG = S6+S7
				!
				Call F_Col ()
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set D6 = S6 - D6
				Set D7 = S7 - D7
				Call F_Col ()
				Set i6 = i6 + D6
				Set i7 = i7 + D7
				Set j6 = j6 + S6
				Set j7 = j7 + S7
				! Set IM = D6+D7
				! Set IG = S6+S7
			On SAM_DoubleClick
				If rb_TOBO
					Set sTmp = " substr(a.nbs,1,1) in ('6','7') and a.tobo = '" || TOBO ||"'"
				Else If rb_TOBO_NBS
					Set sNbs = Subs(NBS,1,4)
					Set sTmp =
							" a.nbs='"|| sNbs ||"' and a.tobo = '" || TOBO ||"'"
				Else If rb_NBS
					Set sNbs = Subs(NBS,1,4)
					Set sTmp = " a.nbs='"|| sNbs ||"' "
				Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
	Table Window: RES !! Концентрация ресурсов
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Концентрація ресурсів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.714"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43670
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43671
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43672
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.405"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						! On SAM_SetFocus
							                                                                                                                                                                                                                                                                 Set dTmp = dDat
				Combo Box: cmb_Rb
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.283"
						Top:    0.071"
						Width:  4.2"
						Width Editable? Yes
						Height: 4.131"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nRb = 0
							Call cmb_Rb.Init(hWndItem)
							Call cmb_Rb.Populate(hSql(),"RB","NAME",
									"(SELECT 0 RB,'По сумі договору' NAME FROM dual UNION ALL
									  SELECT 3,  'По вал договору' FROM dual UNION ALL
									  SELECT 4,  'По Центру Відп. договору' FROM dual UNION ALL
									  SELECT 10, 'По Фін.стану кл.' FROM dual UNION ALL
									  SELECT 11, 'По галузі кл.' FROM dual UNION ALL
									  SELECT 12, 'По адм.області' FROM dual UNION ALL
									  SELECT 13, 'По інсайдерам' FROM dual UNION ALL 
									  SELECT 14, 'По Терміну (пар.S180)' FROM dual 
									)",
									" where RB>=0 ORDER BY RB ")
							Call SalListSetSelect(cmb_Rb,0)
						On SAM_Click
							! Set nRb = cmb_Rb.GetKey(SalListQuerySelection(hWndItem))
							Set nRb = cmb_Rb.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.983"
						Top:    0.405"
						Width:  2.8"
						Width Editable? Yes
						Height: 3.976"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nKv = 0
							Call cmb_KV.Init(hWndItem)
							Call cmb_KV.Populate(hSql(),
									"KV","substr('   '||KV,-3)||'.'||LCV||'/'||NAME","TABVAL",
									" where  D_CLOSE is null union all select  0 , '  */Консолідовано по вал' from dual
									 ORDER BY 2 ")
							Call SalListSetSelect(cmb_KV,0)
						On SAM_Click
							Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Combo Box: cmb_FI
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.283"
						Top:    0.405"
						Width:  4.2"
						Width Editable? Yes
						Height: 3.976"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nFi = 2
							Call cmb_FI.Init(hWndItem)
							Call cmb_FI.Populate(hSql(),"FI","NAME",
									"(SELECT 2 FI,'Позичковi рах.ЮО (КП)' NAME FROM dual UNION ALL
									  SELECT 3,   'Позичковi рах.ФО (КП)'      FROM dual UNION ALL
									  SELECT 2600,'Поточнi рах.ЮО:2600,2650'   FROM dual UNION ALL
									  SELECT 2610,'Cтрок.рах.ЮО:2610,2651'     FROM dual UNION ALL
									  SELECT 2620,'Поточнi рах.ФО:2620+2625'   FROM dual UNION ALL
									  SELECT 2630,'Cтрок.рах.ФО:2630,2635'     FROM dual UNION ALL 
									  SELECT 9999,'Довільна маска бал/рах'     FROM dual 
									)",
									" where fi>=0 ORDER BY fi ")
							Call SalListSetSelect(cmb_FI,0)
						On SAM_Click
							Set nFi =cmb_FI.GetKey(SalListQuerySelection(hWndItem))
							If nFi = 9999
								Call SalShowWindow( BBBB )
							Else
								Call SalHideWindow( BBBB )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: BBBB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 4
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.683"
							Top:    0.405"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ввести маску бал/рах для аналізу')
						On SAM_Create
							Set BBBB = '100'
				Data Field: nKurs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.783"
							Top:    0.405"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmb_TOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.983"
						Top:    0.071"
						Width:  4.2"
						Width Editable? Yes
						Height: 5.988"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set sTobo = '*'
							Call cmb_TOBO.Init(hWndItem)
							If nHaveTOBO != 2
								Call cmb_TOBO.Populate(hSql(),
										"TOBO","TOBO||'/'||NAME","TOBO",
										" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
										 ORDER BY 1")
							Else
								Call cmb_TOBO.Populate(hSql(),
										"BRANCH","BRANCH||'/'||NAME","BRANCH",
										" where BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask')  
										union all select '*' , '*/Консолідовано по BRANCH' from dual
										 ORDER BY 1")
							Call SalListSetSelect(cmb_TOBO,0)
						On SAM_Click
							Set sTobo =cmb_TOBO.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Показать SQL
					Window Location and Size
						Left:   11.683"
						Top:    0.071"
						Width:  2.7"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: PAP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: А
						П
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: NAME1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: NAME2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума коштів
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  2.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Питома вага
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кількість
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума коштів
						просрочена
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  2.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Питома вага
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Zag
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sRb
				Actions
					If nKv = 0 or nKv=n980
						Set nKurs = 1
					Else
						If SqlPrepareAndExecute( hSql(),
								"SELECT RATE_O/BSUM into :hWndForm.RES.nKurs from cur_rates c
								 where c.KV=:hWndForm.RES.nKv and (c.kv,c.vdate) =
								(select kv,max(vdate) from cur_rates
								 where kv=c.KV and vdate<=:hWndForm.RES.dDat group by kv) " )
								 and SqlFetchNext( hSql(), nFetchRes )
					Set sSql = ""
					Set I01 =0
					Set I03 =0
					Set I11 =0
					Call SalTblSetColumnTitle( hWndForm.RES.NAME1, "Код" )
					If nRb = 0
						Call SalTblSetColumnTitle( hWndForm.RES.NAME1, "Більше" )
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Менше,Рівно" )
						Set nSh = IifN( nFi=2 or nFi=2600 or nFi=2610, 2, 3 )
					Else If nRb = 3
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва валюти" )
					Else If nRb = 4
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва центру відповідальності" )
					Else If nRb = 10
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва класу позичальника" )
					Else If hWndForm.RES.nRb = 11
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва галузі" )
					Else If hWndForm.RES.nRb = 12
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва регіону" )
					Else If hWndForm.RES.nRb = 13
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Назва інсайдеру" )
					Else If hWndForm.RES.nRb = 14
						Call SalTblSetColumnTitle( hWndForm.RES.NAME2, "Період розміщення/залучення" )
					Call SalSetWindowText( hWndForm, 'Концентрація ресурсів ' || cmb_Rb ||' '||cmb_FI )
			Function: IG
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set I01 = I01 + G01
					Set I03 = I03 + G03
					Set I11 = I11 + G11
			Function: IR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow,  0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If I01 > 0
							Set G02 = G01*100/I01
						If I11 > 0
							Set G12 = G11*100/I11
					!
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME1='Разом'
					Set G01 = I01
					Set G11 = I11
					Set G03 = I03
					Set G02 = 100
					Set G12 = 100
					! Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[3] )
		Window Parameters
			Number: nMode
			Number: nPar  !!  = 7 на снапах
			String: strPar01
			String: strPar02
			!
		Window Variables
			Number: CALDT_ID 
			!
			Number: nKv 
			Number: nRb
			Number: nSh
			Number: n980
			String: sTobo
			String: sRES1
			String: qRES1
			Number: nRow
			String: sTabl
			String: sOst
			String: sAccounts
			String: qAccounts
			String: sSql
			Number: I01
			Number: I11
			Number: I03
			Number: nFi
			! Number: nKurs
			Date/Time: dTmp
			String: sTitle
			String: sNbs
			String: sNls
			!
			Number: nCol[*]
			!
			String: sSUM
			String: sDECO
		Message Actions
			On SAM_Create
				Set RES.nTabInstance = 1
				Set RES.nRb = 0
				Call SalTblSetLockedColumns(hWndForm, 3)
				Set RES.n980 = GetBaseVal()
				Set RES.dDat = GetBankDate()-1
				Set RES.strPrintFileName = 'RES_'||Str(hWndForm.RES.nPar)
				Set cb1 = 0
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalHideWindow( BBBB )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call F_Zag()
				Set qRES1 = ''
				Set sAccounts = 
						"select kv,acc,nbs,tip,rnk,nvl(tobo,'0') TOBO from accounts where NVL(dazs,:dDat)>= :dDat "
				! Set sAccounts = 
						"select kv,acc,nbs,tip,rnk,nvl(tobo,'0') TOBO 
						 from accounts  where nbs not like '8%' and NVL(dazs,:dDat)>= :dDat "
				Set qAccounts = 
						"select kv,acc,nbs,tip,rnk,nvl(tobo,'0') TOBO 
						 from accounts  where NVL(dazs,:dDat)>= :dDat "
				! Дата для снапов
				If nPar =  7
					If SqlPrepareAndExecute( hSql(), 
							"select CALDT_ID into :CALDT_ID from ACCM_CALENDAR where CALDT_DATE= :hWndForm.RES.dDat" ) 
							and SqlFetchNext(hSql(),nFetchRes)
				! В зависимости от валюты
				If nKv =0
					Set sOst = 
							IifS (nPar = 7, "S.ostQ", "gl.p_icurval(a.kv,s.ostf-s.dos+s.kos,:hWndForm.RES.dDat)")
				Else
					Set sAccounts = sAccounts || " and kv=:hWndForm.RES.nKv "
					Set qAccounts = qAccounts || " and kv=:hWndForm.RES.nKv "
					Set sOst = 
							IifS (nPar = 7, "S.ost", "s.ostf-s.dos+s.kos " )
				! В зависимости от ТОБО
				If sTobo != '*'
					Set sAccounts = sAccounts || " and Nvl(tobo,'0')=:hWndForm.RES.sTobo "
					Set qAccounts = qAccounts || " and Nvl(tobo,'0')=:hWndForm.RES.sTobo "
				! nRb В зависимости от вида концентрации
				If nRb = 0  !! По сумі
					If nKv =0 or nKv= n980
						Set sTabl =
								"select s,s2 from anb_POROG where id="||Str(nSh)
					Else
						Set sTabl =
								"select gl.p_Ncurval(:hWndForm.RES.nKv,s, :hWndForm.RES.dDat) s,
								        gl.p_Ncurval(:hWndForm.RES.nKv,s2,:hWndForm.RES.dDat) s2
								             from anb_POROG where id="||Str(nSh)
				Else If nRb = 3 !! По вал
					Set sTabl = "select kv, lcv||'/'||NAME  name from tabval "
				Else If nRb = 4 !! По TOBO
					Set sTabl = "select tobo, NAME from tobo "
				Else If nRb = 10 !! По класу позичальника
					Set sTabl = "select fin,NAME from stan_fin "
				Else If nRb = 11 !! По галузі
					Set sTabl = "select substr(oe,1,2) OE,Substr(name,1,20) NAME from OE where SUBSTR(OE,3,3)= '000'"
				Else If nRb = 12 !! По регіону
					Set sTabl = "select ko,knb from KODOBL "
				Else If nRb = 13 !! По інсайдерам
					Set sTabl = "select PRINSIDER,NAME from PRINSIDER "
				Else If nRb = 14 !! По пар S180
					Set sTabl = "(select S180 KOD,txt NAME from kl_s180 ) "
				! !!!! nFi - В зависимости от инструмента
				! Кредиты
				If nFi =2 OR nFi =3  !!
					Call SalShowWindow( G11 )
					Call SalShowWindow( G12 )
					! В зависимости от вида концентрации
					If nRb = 0  !! По сумі
						If nPar = 7
							Set sSql =
									"SELECT to_char(k.S/100,'999,999,999,999.00') S,
									        to_char(k.S2/100,'999,999,999,999.00') S2,
									        Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.rnk, a.kv, nvl(n.nd,-a.acc) ND, 
									             -SUM("|| sOst || ") OST, 
									             -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and S.CALDT_ID = :CALDT_ID        
									       GROUP BY a.rnk, a.kv, nvl(n.nd,-a.acc) 
									       ) o
									 WHERE o.OST>k.S and o.OST <= k.S2
									 GROUP BY k.S, k.S2 ORDER BY k.S"
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc 
									        and S.CALDT_ID = :CALDT_ID 
									        and -("||sOst||")/100 > to_number(:RES.NAME1,'999,999,999,999.00')
									        and -("||sOst||")/100 <=to_number(:RES.NAME2,'999,999,999,999.00')
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID "
						Else
							Set sSql =
									"SELECT to_char(k.S/100,'999,999,999,999.00') S,
									        to_char(k.S2/100,'999,999,999,999.00') S2,
									        Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.rnk,a.kv,nvl(n.nd,-a.acc) ND, -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY a.rnk,a.kv,nvl(n.nd,-a.acc)
									 ) o
									 WHERE o.OST>k.S and o.OST <= k.S2
									 GROUP BY k.S, k.S2  ORDER BY k.S"
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, saldoa s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and -("||sOst||")/100 > to_number(:RES.NAME1,'999,999,999,999.00')
									        and -("||sOst||")/100 <=to_number(:RES.NAME2,'999,999,999,999.00')
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 3 !! По вал
						If nPar = 7
							Set sSql =
									"SELECT o.kv,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.rnk,a.kv,nvl(n.nd,-a.acc) ND, 
									          -SUM("|| sOst || ") OST, 
									          -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID    
									       GROUP BY a.rnk,a.kv,nvl(n.nd,-a.acc)
									        ) o
									 WHERE o.kv=k.kv and o.OST>0
									 GROUP BY o.kv,k.NAME ORDER BY decode (o.kv,:n980,1, o.kv)  "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc   
									        and s.CALDT_ID = :CALDT_ID 
									        and a.kv = to_number(:RES.NAME1)        
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID "
						Else
							Set sSql =
									"SELECT o.kv,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.rnk,a.kv,nvl(n.nd,-a.acc) ND, -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY a.rnk,a.kv,nvl(n.nd,-a.acc)
									 ) o
									 WHERE o.kv=k.kv and o.OST>0
									 GROUP BY o.kv,k.NAME ORDER BY decode (o.kv,:n980,1, o.kv)  "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, saldoa s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and a.kv =  to_number(:RES.NAME1)        
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 4 !! По TOBO
						If nPar = 7
							Set sSql =
									"SELECT o.tobo,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.TOBO,a.rnk,a.kv,nvl(n.nd,-a.acc), 
									             -SUM("|| sOst || ") OST, 
									             -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID 
									       GROUP BY a.TOBO,a.rnk,a.kv,nvl(n.nd,-a.acc)
									   ) o
									 WHERE o.tobo=k.tobo and o.OST > 0
									 GROUP BY o.tobo,k.NAME ORDER BY o.tobo "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc 
									        and s.CALDT_ID = :CALDT_ID 
									        and a.tobo = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID "
						Else
							Set sSql =
									"SELECT o.tobo,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.TOBO,a.rnk,a.kv,nvl(n.nd,-a.acc), -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s, nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY a.TOBO,a.rnk,a.kv,nvl(n.nd,-a.acc)
									   ) o
									 WHERE o.tobo=k.tobo and o.OST > 0
									 GROUP BY o.tobo,k.NAME ORDER BY o.tobo "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, saldoa s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and a.tobo = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 10 !! По класу позичальника
						If nPar = 7
							Set sSql =
									"SELECT o.crisk,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.crisk,a.rnk,a.kv,nvl(n.nd,-a.acc),
									         -SUM("|| sOst || ") OST,
									         -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID 
									       GROUP BY c.crisk,a.rnk,a.kv,nvl(n.nd,-a.acc)
									       ) o
									 WHERE o.crisk=k.FIN (+) and o.OST > 0
									 GROUP BY o.crisk,k.NAME ORDER BY o.crisk "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a,  ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n,  customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    
									        and s.CALDT_ID = :CALDT_ID 
									        and c.crisk = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID "
						Else
							Set sSql =
									"SELECT o.crisk,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.crisk,a.rnk,a.kv,nvl(n.nd,-a.acc),-SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s, customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY c.crisk,a.rnk,a.kv,nvl(n.nd,-a.acc)
									   ) o
									 WHERE o.crisk=k.FIN (+) and o.OST > 0
									 GROUP BY o.crisk,k.NAME ORDER BY o.crisk "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, 
									           saldoa s, cc_deal d, nd_acc n,  customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and c.crisk = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 11 !! По галузі
						If nPar = 7
							Set sSql =
									"SELECT o.OE,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(c.oe,1,2) OE, a.rnk,a.kv,nvl(n.nd,-a.acc), 
									             -SUM("|| sOst || ") OST,
									             -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID
									       GROUP BY substr(c.oe,1,2),a.rnk, a.kv,nvl(n.nd,-a.acc)
									      ) o
									 WHERE o.OE=k.OE (+) and o.OST > 0
									 GROUP BY o.OE,k.NAME ORDER BY o.OE "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n,  customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc and s.CALDT_ID = :CALDT_ID
									        and substr(c.oe,1,2) = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID"
						Else
							Set sSql =
									"SELECT o.OE,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(c.oe,1,2) OE, a.rnk,a.kv,nvl(n.nd,-a.acc), 
									             -SUM("|| sOst || ") OST,
									             -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s,  customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY substr(c.oe,1,2),a.rnk, a.kv,nvl(n.nd,-a.acc) ) o
									 WHERE o.OE=k.OE (+) and o.OST > 0
									 GROUP BY o.OE,k.NAME ORDER BY o.OE "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, 
									           saldoa s, cc_deal d, nd_acc n,  customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and substr(c.oe,1,2) = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 12 !! По регіону
						If nPar = 7
							Set sSql =
									"SELECT o.ko,k.knb,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(F_CODOBL_TOBO(a.acc,4),1,2) ko, a.kv,nvl(n.nd,-a.acc), 
									             -SUM("|| sOst || ") OST,
									             -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,   nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc    and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID
									       GROUP BY substr(F_CODOBL_TOBO(a.acc,4),1,2), a.kv, nvl(n.nd,-a.acc) 
									      ) o
									 WHERE o.ko=k.ko (+) and o.OST > 0
									 GROUP BY o.ko,k.knb ORDER BY o.ko "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc 
									        and s.CALDT_ID = :CALDT_ID
									        and substr(F_CODOBL_TOBO(a.acc,4),1,2) = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID "
						Else
							Set sSql =
									"SELECT o.ko,k.knb,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(F_CODOBL_TOBO(a.acc,4),1,2) ko, a.kv,nvl(n.nd,-a.acc), -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s,   nd_acc n
									       WHERE a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY substr(F_CODOBL_TOBO(a.acc,4),1,2), 
									             a.kv,nvl(n.nd,-a.acc)  ) o
									 WHERE o.ko=k.ko (+) and o.OST > 0
									 GROUP BY o.ko,k.knb ORDER BY o.ko "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, saldoa s, cc_deal d, nd_acc n
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and substr(F_CODOBL_TOBO(a.acc,4),1,2) = :RES.NAME1       
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 13 !! По інсайдерам
						If nPar = 7
							Set sSql =
									"SELECT o.PRINSIDER,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.PRINSIDER,a.rnk,a.kv,nvl(n.nd,-a.acc),  
									              -SUM("|| sOst || ") OST, 
									              -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc  and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID
									       GROUP BY c.PRINSIDER, a.rnk, a.kv, nvl(n.nd,-a.acc)
									  ) o
									 WHERE o.PRINSIDER=k.PRINSIDER (+) and o.OST > 0
									 GROUP BY o.PRINSIDER,k.NAME ORDER BY o.PRINSIDER "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n, customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc and s.CALDT_ID = :CALDT_ID
									        and c.PRINSIDER = to_number(:RES.NAME1)
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID"
						Else
							Set sSql =
									"SELECT o.PRINSIDER,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.PRINSIDER,a.rnk,a.kv,nvl(n.nd,-a.acc),  -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s,  customer c , nd_acc n
									       WHERE c.rnk=a.rnk
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc  and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY c.PRINSIDER,a.rnk,a.kv,nvl(n.nd,-a.acc)
									  ) o
									 WHERE o.PRINSIDER=k.PRINSIDER (+) and o.OST > 0
									 GROUP BY o.PRINSIDER,k.NAME ORDER BY o.PRINSIDER "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, 
									           saldoa s, cc_deal d, nd_acc n,  customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and c.PRINSIDER = to_number(:RES.NAME1)
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					Else If nRb = 14 !! По пар S180
						If nPar = 7
							Set sSql =
									"SELECT o.KOD,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.s180 KOD ,a.kv,nvl(n.nd,-a.acc),  
									              -SUM("|| sOst || ") OST, 
									              -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  specparam c , nd_acc n
									       WHERE a.acc = c.acc (+) 
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' 
									         and a.acc=s.acc  and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') 
									         and s.CALDT_ID = :CALDT_ID
									       GROUP BY c.s180, a.kv, nvl(n.nd,-a.acc)
									  ) o
									 WHERE o.KOD = k.KOD (+) and o.OST > 0
									 GROUP BY o.KOD , k.NAME ORDER BY o.KOD "
							Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n, specparam c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and s.acc= c.acc (+) and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc and s.CALDT_ID = :CALDT_ID
									        and c.s180  = :RES.NAME1 
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID"
							! Set qRES1 =
									"SELECT s8.acc N, s8.OST S
									 FROM ACCM_SNAP_BALANCES s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, ACCM_SNAP_BALANCES s, cc_deal d, nd_acc n, customer c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc and s.CALDT_ID = :CALDT_ID
									        and c.PRINSIDER = to_number(:RES.NAME1)
									      ) o
									 WHERE s8.acc=o.acc and s8.CALDT_ID = :CALDT_ID"
						Else
							Set sSql =
									"SELECT o.KOD,k.NAME,Sum(o.OST)/100 OST, Sum(o.OSTP)/100 OSTP, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G11, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.s180 KOD, a.kv,nvl(n.nd,-a.acc),  -SUM("|| sOst || ") OST, -SUM(decode(a.tip,'SS ',0,"||sOst||")) OSTP
									       FROM ("|| sAccounts ||") a, saldoa s,  specparam c , nd_acc n
									       WHERE a.acc = c.acc (+)
									         and a.nbs like '" || IifS(nFi=2,"20","22") || "%' and a.acc=s.acc  and a.acc=n.acc (+)
									         and a.tip in ('SS ', 'SP ', 'SL ') and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY c.s180,a.kv,nvl(n.nd,-a.acc)
									  ) o
									 WHERE o.KOD = k.KOD (+) and o.OST > 0
									 GROUP BY o.KOD,k.NAME ORDER BY o.KOD "
							Set qRES1 =
									"SELECT s8.acc N, s8.ostf-s8.dos+s8.kos S
									 FROM saldoa s8,
									     (SELECT a.acc, -("|| sOst || ")/100 OST
									      FROM ( " || qAccounts || " ) a, 
									           saldoa s, cc_deal d, nd_acc n,  specparam c
									      WHERE n.nd=d.nd and n.acc=a.acc and a.tip='LIM'
									        and c.rnk=d.rnk and d.vidd in (" || IifS(nFi=2,"1,2,3","11,12,13") || ")
									        and a.acc=s.acc    and (s.acc,s.fdat)=
									         (select acc,max(fdat) from saldoa
									         where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc )
									        and c.PRINSIDER = to_number(:RES.NAME1)
									      ) o
									 WHERE s8.acc=o.acc and (s8.acc,s8.fdat)=
									    (select acc,max(fdat) from saldoa
									     where acc=s8.acc and fdat<=:hWndForm.RES.dDat group by acc )"
					! Else If nRb = 15 !! По БС+ОБ22
				! Депозиты
				Else If nFi >= 2600 and nFi <= 2630 OR nFi = 9999
					Call SalHideWindow( G11 )
					Call SalHideWindow( G12 )
					If Subs(sOst,1,3) != 'Abs' 
						Set sOst = 'Abs(' || sOst || ')'
					Set sAccounts = sAccounts || " and nbs " ||
							IifS (nFi=2600,"in ('2600','2650')",
							IifS (nFi=2610,"in ('2610','2651')",
							IifS (nFi=2620,"in ('2620')",
							IifS (nFi=2630,"in ('2630')", 
							IifS (nFi=9999," like '" || SalStrTrimX( BBBB ) || "%'", "like '2%' " )))))
					! В зависимости от вида концентрации
					If nRb = 0  !! По сумі
						If nPar = 7
							Set sSql =
									"SELECT to_char(k.S/100,'999,999,999,999.00') S,
									        to_char(k.S2/100,'999,999,999,999.00') S2,
									        Sum(o.OST)/100 OST,  count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT "|| sOst ||" OST FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s
									       WHERE a.acc=s.acc and s.CALDT_ID = :CALDT_ID   ) o
									 WHERE o.OST>k.S and o.OST <= k.S2
									 GROUP BY k.S, k.S2  ORDER BY k.S"
							Set qRES1 =
									"SELECT s.acc N, s.OST S FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s 
									 WHERE a.acc=s.acc and s.CALDT_ID = :CALDT_ID
									   and ("||sOst||")/100 > to_number(:RES.NAME1,'999,999,999,999.00')
									   and ("||sOst||")/100 <=to_number(:RES.NAME2,'999,999,999,999.00')  "
						Else
							Set sSql =
									"SELECT to_char(k.S/100,'999,999,999,999.00') S,
									        to_char(k.S2/100,'999,999,999,999.00') S2,
									        Sum(o.OST)/100 OST,  count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT "|| sOst ||" OST FROM ("|| sAccounts ||") a, saldoa s
									       WHERE a.acc=s.acc and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       ) o
									 WHERE o.OST>k.S and o.OST <= k.S2
									 GROUP BY k.S, k.S2  ORDER BY k.S"
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s 
									 WHERE a.acc=s.acc 
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and ("||sOst||")/100 > to_number(:RES.NAME1,'999,999,999,999.00')
									   and ("||sOst||")/100 <=to_number(:RES.NAME2,'999,999,999,999.00')
									    "
					Else If nRb = 3 !! По вал
						If nPar = 7
							Set sSql =
									"SELECT o.kv,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.kv, "|| sOst ||" OST FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s
									       WHERE a.acc=s.acc  and s.CALDT_ID = :CALDT_ID   ) o
									 WHERE o.kv=k.kv and o.OST>0
									 GROUP BY o.kv,k.NAME ORDER BY decode (o.kv,:n980,1, o.kv)  "
							Set qRES1 =
									"SELECT s.acc N, s.OST S FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s 
									 WHERE a.acc=s.acc and s.CALDT_ID = :CALDT_ID and a.kv =to_number(:RES.NAME1) "
						Else
							Set sSql =
									"SELECT o.kv,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.kv, "|| sOst ||" OST FROM ("|| sAccounts ||") a, saldoa s
									       WHERE a.acc=s.acc and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									      ) o
									 WHERE o.kv=k.kv and o.OST>0
									 GROUP BY o.kv,k.NAME ORDER BY decode (o.kv,:n980,1, o.kv)  "
							Set qRES1 =
									"SELECT s.acc N, s.OST S
									 FROM ("|| sAccounts ||") a, saldoa s 
									 WHERE a.acc=s.acc 
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc ) 
									   and a.kv =to_number(:RES.NAME1) "
					Else If nRb = 4 !! По TOBO
						If nPar = 7
							Set sSql =
									"SELECT o.tobo,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.TOBO, "|| sOst || " OST  FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s
									       WHERE  a.acc=s.acc  and s.CALDT_ID = :CALDT_ID  ) o
									 WHERE o.tobo=k.tobo and o.OST>0
									 GROUP BY o.tobo,k.NAME ORDER BY o.tobo "
							Set qRES1 =
									"SELECT s.acc N, s.OST S FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s 
									 WHERE a.acc=s.acc and s.CALDT_ID = :CALDT_ID  and a.tobo = :RES.NAME1 "
						Else
							Set sSql =
									"SELECT o.tobo,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT a.TOBO, "|| sOst || " OST  FROM ("|| sAccounts ||") a, saldoa s
									       WHERE  a.acc=s.acc and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									        ) o
									 WHERE o.tobo=k.tobo and o.OST>0
									 GROUP BY o.tobo,k.NAME ORDER BY o.tobo "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s 
									 WHERE a.acc=s.acc 
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and a.tobo = :RES.NAME1 "
					Else If nRb = 10 !! По класу позичальника
						If nPar = 7
							Set sSql =
									"SELECT o.crisk,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.crisk,"|| sOst || " OST FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, customer c
									       WHERE c.rnk=a.rnk and a.acc=s.acc  and s.CALDT_ID = :CALDT_ID 
									       ) o
									 WHERE o.crisk=k.FIN (+) and o.OST>0
									 GROUP BY o.crisk,k.NAME ORDER BY o.crisk "
							Set qRES1 =
									"SELECT s.acc N, s.OST S FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk and s.CALDT_ID = :CALDT_ID and c.crisk = :RES.NAME1 "
						Else
							Set sSql =
									"SELECT o.crisk,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.crisk,"|| sOst || " OST FROM ("|| sAccounts ||") a, saldoa s, customer c
									       WHERE c.rnk=a.rnk and a.acc=s.acc  and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       ) o
									 WHERE o.crisk=k.FIN (+) and o.OST>0
									 GROUP BY o.crisk,k.NAME ORDER BY o.crisk "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk  
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and c.crisk = :RES.NAME1 "
					Else If nRb = 11 !! По галузі
						If nPar = 7
							Set sSql =
									"SELECT o.OE,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(c.oe,1,2) OE, "|| sOst || " OST
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  customer c
									       WHERE c.rnk=a.rnk and a.acc=s.acc and s.CALDT_ID = :CALDT_ID 
									       ) o
									 WHERE o.OE=k.OE (+) and o.OST>0
									 GROUP BY o.OE,k.NAME ORDER BY o.OE "
							Set qRES1 =
									"SELECT s.acc N, s.OST S
									 FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk and s.CALDT_ID = :CALDT_ID and substr(c.oe,1,2) = :RES.NAME1 "
						Else
							Set sSql =
									"SELECT o.OE,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(c.oe,1,2) OE, "|| sOst || " OST
									       FROM ("|| sAccounts ||") a, saldoa s,  customer c
									       WHERE c.rnk=a.rnk       and a.acc=s.acc   and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       ) o
									 WHERE o.OE=k.OE (+) and o.OST>0
									 GROUP BY o.OE,k.NAME ORDER BY o.OE "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk  
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and substr(c.oe,1,2) = :RES.NAME1 "
					Else If nRb = 12 !! По регіону
						If nPar = 7
							Set sSql =
									"SELECT o.ko,k.knb,o.OST/100 OST,  KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(F_CODOBL_TOBO(a.acc,4),1,2) ko, sum("|| sOst || ") OST, count(*) KOL
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s
									       WHERE a.acc=s.acc  and s.CALDT_ID = :CALDT_ID
									       GROUP BY substr(F_CODOBL_TOBO(a.acc,4),1,2) 
									        ) o
									 WHERE o.ko=k.ko(+) and o.OST>0 ORDER BY o.ko "
							Set qRES1 =
									"SELECT s.acc N, s.OST S
									 FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s 
									 WHERE a.acc=s.acc and s.CALDT_ID = :CALDT_ID and substr(F_CODOBL_TOBO(a.acc,4),1,2) = :RES.NAME1 "
						Else
							Set sSql =
									"SELECT o.ko,k.knb,o.OST/100 OST,  KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT substr(F_CODOBL_TOBO(a.acc,4),1,2) ko, sum("|| sOst || ") OST, count(*) KOL
									       FROM ("|| sAccounts ||") a, saldoa s
									       WHERE a.acc=s.acc  and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									       GROUP BY substr(F_CODOBL_TOBO(a.acc,4),1,2) 
									        ) o
									 WHERE o.ko=k.ko(+) and o.OST>0
									 ORDER BY o.ko "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s 
									 WHERE a.acc=s.acc 
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and substr(F_CODOBL_TOBO(a.acc,4),1,2) = :RES.NAME1 "
					Else If nRb = 13 !! По інсайдерам
						If nPar = 7
							Set sSql =
									"SELECT o.PRINSIDER,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.PRINSIDER,"|| sOst || " OST
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  customer c
									       WHERE c.rnk=a.rnk  and a.acc=s.acc  and s.CALDT_ID = :CALDT_ID 
									      ) o
									 WHERE o.PRINSIDER=k.PRINSIDER (+) and o.OST>0
									 GROUP BY o.PRINSIDER,k.NAME ORDER BY o.PRINSIDER "
							Set qRES1 =
									"SELECT s.acc N, s.OST S
									 FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk and s.CALDT_ID = :CALDT_ID and c.PRINSIDER = to_number(:RES.NAME1) "
						Else
							Set sSql =
									"SELECT o.PRINSIDER,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.PRINSIDER,"|| sOst || " OST
									       FROM ("|| sAccounts ||") a, saldoa s,  customer c
									       WHERE c.rnk=a.rnk  and a.acc=s.acc  and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									      ) o
									 WHERE o.PRINSIDER=k.PRINSIDER (+) and o.OST>0
									 GROUP BY o.PRINSIDER,k.NAME ORDER BY o.PRINSIDER "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s, customer c 
									 WHERE a.acc=s.acc and a.rnk=c.rnk  
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and c.PRINSIDER = to_number(:RES.NAME1) "
					Else If nRb = 14 !! По пар S180
						If nPar = 7
							Set sSql =
									"SELECT o.KOD,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.s180 KOD,"|| sOst || " OST
									       FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s,  specparam c
									       WHERE a.acc = c.acc (+) and a.acc=s.acc  and s.CALDT_ID = :CALDT_ID 
									      ) o
									 WHERE o.kod = k.kod (+) and o.OST>0
									 GROUP BY o.kod,k.NAME ORDER BY o.kod "
							Set qRES1 =
									"SELECT s.acc N, s.OST S
									 FROM ("|| sAccounts ||") a, ACCM_SNAP_BALANCES s, specparam c
									 WHERE a.acc = s.acc and a.acc=c.acc(+) and s.CALDT_ID = :CALDT_ID and c.PRINSIDER = to_number(:RES.NAME1) "
						Else
							Set sSql =
									"SELECT o.kod,k.NAME,Sum(o.OST)/100 OST, count(*) KOL
									 INTO :RES.NAME1, :RES.NAME2, :RES.G01, :RES.G03
									 FROM (" || sTabl || ") k,
									      (SELECT c.s180 kod,"|| sOst || " OST
									       FROM ("|| sAccounts ||") a, saldoa s, specparam c
									       WHERE c.rnk=a.rnk  and a.acc=s.acc  and (s.acc,s.fdat)=
									        (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )
									      ) o
									 WHERE o.kod = k.kod (+) and o.OST>0
									 GROUP BY o.kod, k.NAME ORDER BY o.kod "
							Set qRES1 =
									"SELECT s.acc N, s.ostf-s.dos+s.kos S
									 FROM ("|| sAccounts ||") a, saldoa s, specparam c 
									 WHERE a.acc=s.acc and a.acc = c.acc (+)   
									   and (s.acc,s.fdat)=
									       (select acc,max(fdat) from saldoa 
									        where acc=s.acc and fdat<=:hWndForm.RES.dDat group by acc  )   
									   and c.s180 = to_number(:RES.NAME1) "
				! !!!!!!!!!!!!!!!!
				If sSql != ""
					If cb1 = 1
						Call Debug (sSql)
					Call SalTblPopulate(hWndForm, hSql(), sSql,TBL_FillAll  )
					Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
					Call IR()
					! Call IP()
					! Call IA()
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call IG()
			On SAM_DoubleClick
				! If IsWindow( hWin_RES1 )
					                                                                                     Call SalDestroyWindow(hWin_RES1 )
				! If qRES1 != ''
					                                                                                     Call SalGetWindowText( hWndForm, hWndForm.RES.sRES1, 100 )
					! Call Debug(qRES1)
					                                                                                     If SqlPrepareAndExecute( hSql(),"DELETE from TMP_IRR " )
							and SqlPrepareAndExecute(hSql(),"INSERT into TMP_IRR (n,s) "|| qRES1 )
							and SqlCommit( hSql() )
						                                                                                     Set hWin_RES1 =
								SalCreateWindow( RES1, hWndMDI,
								hWndForm.RES.nMode, hWndForm.RES.nPar,
								hWndForm.RES.strPar01, hWndForm.RES.sRES1, hWndForm.RES.dDat )
	Table Window: RES1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  14.5"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43673
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43674
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43675
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код ТВБВ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOBO_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва ТВБВ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок-
						номінал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок-
						еквівалент
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						відк.рах.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.383"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAZS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						закр.рах.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
			Date/Time: DAT
		Window Variables
		Message Actions
			On SAM_Create
				Set RES1.nTabInstance = 1
				Set RES1.strPrintFileName = 'RES1_'||Str(hWndForm.RES1.nPar)
				Set RES1.strFilterTblName = 'ACCOUNTS'
				Call SalTblSetLockedColumns(hWndForm, 5)
				Call SalSetWindowText( hWndForm,
						SalFmtFormatDateTime( hWndForm.RES1.DAT, 'dd/MM/yyyy')||' по рах. ' || strPar02 )
				Set RES1.strSqlPopulate =
						"SELECT ACCOUNTS.acc, ACCOUNTS.kv, ACCOUNTS.nls, ACCOUNTS.nms,
						        ACCOUNTS.tobo,ACCOUNTS.daos,ACCOUNTS.dazs,   t.name,
						       r.s/100, gl.p_icurval(ACCOUNTS.kv,r.s,:hWndForm.RES1.DAT)/100
						 INTO :hWndForm.RES1.ACC,:hWndForm.RES1.KV,:hWndForm.RES1.NLS,:hWndForm.RES1.NMS,
						      :hWndForm.RES1.TOBO, :hWndForm.RES1.DAOS, :hWndForm.RES1.DAZS,
						      :hWndForm.RES1.TOBO_NAME, :hWndForm.RES1.OST, :hWndForm.RES1.OSTQ
						 FROM ACCOUNTS, TMP_IRR r, tobo t
						 WHERE ACCOUNTS.acc=r.n and nvl(ACCOUNTS.tobo,'0')=t.tobo
						 ORDER BY ACCOUNTS.acc, ACCOUNTS.kv
						 "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If strSqlPopulate != ''
					If fFilterAtStart
						If SetQueryFilter( cF )
							Set fFilterAtStart = NOT fFilterAtStart
					If NOT fFilterAtStart
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Set strDSql = cQ.GetFullSQLString(cF)
						Call BindList.ActivateBinds()
						Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), nTabPopulateMethod)
						Call SalTblSetContext(hWndForm, 0)
						Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
					Else
						Call SalDestroyWindow( hWndForm )
	Table Window: VAR !! ANI-6.Var-аналіз
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Var-аналіз
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.464"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Збегерти лімітти на вал.поз.'
						On SAM_Click
							If F_Lim()
								Call SqlCommitEx( hSql(), "Установка лімітів на вал.поз." )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Else
								Call SqlRollback(  hSql() )
				Line
					Resource Id: 43676
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.817"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Деталі розрахунку (корреляц, коваріація)'
						On SAM_Click
							Call SalCreateWindow
									(VAD, hWndMDI, nMode, nPar, strTip, strPar02, dDat )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43677
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43678
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.483"
							Top:    0.155"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата розрахунку ')
				! ctb_pbExecute: pbExecute
					                                                                                                                                                                                                                                     Message Actions
						                                                                                                                                                                                                                                     On SAM_Create
							                                                                                                                                                                                                                                     Set strTip = 'Протокол розрахунку (корреляція, коваріація)'
						                                                                                                                                                                                                                                     On SAM_Click
							! Call SalCreateWindow
									(KAR, hWndParent, nMode, nPar, SalFmtFormatDateTime( dDat, 'dd/MM/yyyy'), strPar02)
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По Рахункам
					Window Location and Size
						Left:   6.483"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По BRANCH
					Window Location and Size
						Left:   8.45"
						Top:    0.095"
						Width:  1.533"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По Валютам
					Window Location and Size
						Left:   10.183"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						BRANCH
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						BRANCH
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ISO
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рахунок
						ВАЛ.ПОЗ.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва рахунку
						ВАЛ.ПОЗ.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата поч.дії
						ліміту
				Visible? Class Default
				Editable? No
				Maximum Data Length: 14
				Data Type: Date/Time
				Justify: Center
				Width:  1.467"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лім на Коротку
						ВП/номінал
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_SQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лім на Коротку
						ВП/еквівал.
				Visible? Class Default
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTС
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ.ПОЗ
						номінал
				Visible? Class Default
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ.ПОЗ.
						еквівалент
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_LN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лім на Довгу
						ВП/номінал
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_LQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лім на Довгу
						ВП/еквівал
				Visible? Class Default
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VAR_95
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: VAR  (95%),
						1 день
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VAR_99
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: VAR  (99%),
						1 день
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Волати-
						льність %
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оф.курс
						валюти
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: #00000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: СЗК
						Купівлі
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: #00000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: СЗК
						Продажу
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: #00000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Lim
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					String: sBlok
					String: sLL
					String: sLS
					String: sAcc
					String: sFdat
				Actions
					Set nRow = TBL_MinRow
					Set sFdat = " to_date('"|| SalFmtFormatDateTime( dDat, "dd/MM/yyyy" ) || "','dd/MM/yyyy') "
					While SalTblFindNextRow( hWndForm, nRow, ROW_Edited, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set sLL  = ' + ' || Str( SalNumberAbs( LIM_LN )  * 100)
						Set sLS  = ' - ' || Str( SalNumberAbs( LIM_SN ) * 100)
						Set sAcc = Str(ACC)
						Set sBlok = "
								 BEGIN
								   UPDATE vp_lim SET ost_long = " || sLL || " , ost_short = " || sLS || " 
								   where acc = " || sAcc || " and fdat = " || sFdat || ";
								   IF SQL%rowcount=0 then
								      INSERT INTO vp_lim (ACC,fdat,ost_long,ost_short) 
								       VALUES (" || sAcc || "," || sFdat || "," || sLL || "," || sLS || ");
								   END if;
								 END;"
						If NOT SqlPrepareAndExecute( hSql(), sBlok)
							Return FALSE
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
			!
		Window Variables
			Number: n980
			Number: n1
			Number: n2
			Number: n3
			Number: n4
			Number: n5
			Date/Time: dTmp
			String: sFilter
			String: VP_LIM
			String: sSql
			Number: nRow
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Set rb1 = FALSE
				Set rb2 = FALSE
				Set rb3 = TRUE
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 6)
				Set n980 = GetBaseVal()
				Set dDat = GetBankDate()
				Set n1 = 1645/1000
				Set n2 = 233 /100
				Set dTmp = VAR.dDat - 1
				Set VAR.nTabInstance = 1
				Set VAR.fFilterAtStart = 1
				Set VAR.strFilterTblName = 'ACCOUNTS'
				Set VAR.strPrintFileName = 'VAR_'||Str(hWndForm.VAR.nPar)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If VAR.fFilterAtStart
					Set VAR.fFilterAtStart = NOT VAR.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				!
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalWaitCursor(TRUE)
				Set VP_LIM = 
						"( SELECT m.ACC,m.FDAT,m.ost_short/100 LIM_SN,m.ost_long/100 LIM_LN 
						   from VP_LIM m where (m.acc,m.fdat) = 
						 (select acc,max(fdat) from vp_lim where acc=m.acc and fdat <= :dDat group by acc) ) "
				!
				Call SalDisableWindow( hWndForm.VAR.pbUpdate )
				If rb1
					Call SalEnableWindow( hWndForm.VAR.pbUpdate )
					Call SalShowWindow( hWndForm.VAR.NLS )
					Call SalShowWindow( hWndForm.VAR.RATE_K )
					Call SalShowWindow( hWndForm.VAR.RATE_P )
					Call SalTblSetColumnTitle( hWndForm.VAR.NLS, "Рахунок
							ВАЛ.ПОЗ." )
					Call SalTblSetColumnTitle( hWndForm.VAR.NMS, "Назва рахунку
							ВАЛ.ПОЗ." )
					Call SalShowWindow( hWndForm.VAR.TOBO )
					Call SalShowWindow( hWndForm.VAR.NAME_TOBO )
					Set sSql =
							"SELECT o.TOBO, o.name, t.KV, v.lcv,  t.nls, ACCOUNTS.nms,
							        t.OSTC/100, t.OSTQ/100,  t.VAR_95/100, t.VAR_99/100,
							        round(t.VOL,6)*100, t.RATE_O/t.BSUM,
							        s.RATE_K, s.RATE_P, 
							        ACCOUNTS.acc, l.LIM_SN, l.LIM_LN, l.FDAT   
							 INTO :hWndForm.VAR.TOBO,  :hWndForm.VAR.NAME_TOBO,
							      :hWndForm.VAR.KV,    :hWndForm.VAR.LCV,
							      :hWndForm.VAR.NLS,   :hWndForm.VAR.NMS,
							      :hWndForm.VAR.OSTС,  :hWndForm.VAR.OSTQ,
							      :hWndForm.VAR.VAR_95,:hWndForm.VAR.VAR_99,
							      :hWndForm.VAR.VOL,   :hWndForm.VAR.RATE,
							      :hWndForm.VAR.RATE_K,:hWndForm.VAR.RATE_P, 
							      :hWndForm.VAR.ACC ,  :hWndForm.VAR.LIM_SN, 
							      :hWndForm.VAR.LIM_LN,:hWndForm.VAR.FDAT 
							 FROM TMP_VAR t, ACCOUNTS, tobo o, tabval v, 
							     (select c.acc,c.RATE_K,c.RATE_P from spot c where (c.acc,c.VDATE)=
							      (select acc,max(VDATE) from spot where acc=c.acc and VDATE<=:dDat group by acc)
							      ) s , " || VP_LIM || " l 
							 WHERE ACCOUNTS.nls=t.nls and ACCOUNTS.kv=t.kv and t.kv=v.kv 
							   and ACCOUNTS.acc=s.acc(+) and ACCOUNTS.acc=l.acc(+) 
							   and ACCOUNTS.dazs is null and v.D_CLOSE is null 
							   and nvl(ACCOUNTS.tobo,'0') = o.tobo " ||
							   IifS(sFilter = "", ""," and "|| sFilter) || "
							 ORDER BY t.KV, t.nls "
				Else If rb2
					Call SalHideWindow( hWndForm.VAR.NLS )
					Call SalHideWindow( hWndForm.VAR.RATE_K )
					Call SalHideWindow( hWndForm.VAR.RATE_P )
					Call SalTblSetColumnTitle( hWndForm.VAR.NMS, "Назва валюти" )
					Call SalShowWindow( hWndForm.VAR.TOBO )
					Call SalShowWindow( hWndForm.VAR.NAME_TOBO )
					Set sSql =
							"SELECT o.TOBO, o.name, t.KV, v.lcv,  v.name ,
							        sum(l.LIM_SN),     sum(l.LIM_LN),  
							        sum(t.OSTC)/100,   sum(t.OSTQ)/100,
							        sum(t.VAR_95)/100, sum(t.VAR_99)/100,
							        round(t.VOL,6)*100, t.RATE_O/t.BSUM
							 INTO :hWndForm.VAR.TOBO,  :hWndForm.VAR.NAME_TOBO,
							      :hWndForm.VAR.KV,    :hWndForm.VAR.LCV,  :hWndForm.VAR.NMS,
							      :hWndForm.VAR.LIM_SN,:hWndForm.VAR.LIM_LN 
							      :hWndForm.VAR.OSTС,  :hWndForm.VAR.OSTQ,
							      :hWndForm.VAR.VAR_95,:hWndForm.VAR.VAR_99,
							      :hWndForm.VAR.VOL,   :hWndForm.VAR.RATE
							 FROM TMP_VAR t, ACCOUNTS, tobo o, tabval v, " || VP_LIM || " l 
							 WHERE ACCOUNTS.nls=t.nls and ACCOUNTS.kv=t.kv and t.kv=v.kv
							   and ACCOUNTS.dazs is null and v.D_CLOSE is null  and ACCOUNTS.acc=l.acc(+) 
							   and nvl(ACCOUNTS.tobo,'0') = o.tobo " ||
							   IifS(sFilter = "", ""," and "|| sFilter) || "
							 GROUP BY o.TOBO,o.name,t.KV,v.lcv,v.name,t.VOL,t.RATE_O,t.BSUM
							 ORDER BY t.KV, o.TOBO "
				Else If rb3
					Call SalHideWindow( hWndForm.VAR.NLS )
					Call SalHideWindow( hWndForm.VAR.RATE_K )
					Call SalHideWindow( hWndForm.VAR.RATE_P )
					Call SalTblSetColumnTitle( hWndForm.VAR.NMS, "Назва валюти" )
					Call SalHideWindow( hWndForm.VAR.TOBO )
					Call SalHideWindow( hWndForm.VAR.NAME_TOBO )
					Set sSql =
							"SELECT t.KV, v.lcv,  v.name ,
							        sum(l.LIM_SN)/100, sum(l.LIM_LN)/100,  
							        sum(t.OSTC)/100,   sum(t.OSTQ)/100,
							        sum(t.VAR_95)/100, sum(t.VAR_99)/100,
							        round(t.VOL,6)*100, t.RATE_O/t.BSUM
							 INTO :hWndForm.VAR.KV,    :hWndForm.VAR.LCV,:hWndForm.VAR.NMS,
							      :hWndForm.VAR.LIM_SN,:hWndForm.VAR.LIM_LN 
							      :hWndForm.VAR.OSTС,  :hWndForm.VAR.OSTQ,
							      :hWndForm.VAR.VAR_95,:hWndForm.VAR.VAR_99,
							      :hWndForm.VAR.VOL,   :hWndForm.VAR.RATE
							 FROM TMP_VAR t, ACCOUNTS, tabval v, " || VP_LIM || " l 
							 WHERE ACCOUNTS.nls=t.nls and ACCOUNTS.kv=t.kv and t.kv=v.kv 
							   and ACCOUNTS.acc=l.acc(+) 
							   and ACCOUNTS.dazs is null and v.D_CLOSE is null " ||
							   IifS(sFilter = "", ""," and "|| sFilter) || "
							 GROUP BY t.KV,v.lcv,v.name,t.VOL,t.RATE_O,t.BSUM
							 ORDER BY t.KV "
				!
				If SqlPLSQLCommand( hSql(), "P_VAR( dDat, n1, n2 )" )
					If SqlPrepareAndExecute( hSql(),
							"SELECT OSTQ/100, VAR_95/100, VAR_99/100
							 INTO :n3, :n4, :n5 FROM TMP_VAR  where kv = 0 "  )
							and SqlFetchNext( hSql(), nFetchRes )
				! Call Debug(sSql)
				Call SalTblPopulate(hWndForm, hSql(), sSql , TBL_FillAll  )
				Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
				Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
				Call SalTblFetchRow(hWndForm, nRow )
				Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
				Set LCV = 'All'
				Set NMS = 'Загальна'
				Set OSTQ = n3
				Set VAR_95 = n4
				Set VAR_99 = n5
				!
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If LIM_SN != NUMBER_Null
					Set LIM_SQ = LIM_SN * RATE
					If OSTС < LIM_SN 
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ))
				If LIM_LN != NUMBER_Null
					Set LIM_LQ = LIM_LN * RATE
					If OSTС > LIM_LN 
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )  ! голубой
			On SAM_DoubleClick
	Table Window: VAD !! ANI-6.Var-аналіз
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Var-аналіз. Деталі розрахунку (корреляц, коваріація)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.464"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43679
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43680
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43681
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.483"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата розрахунку ')
				! ctb_pbExecute: pbExecute
					                                                                                                                                                                                                                                     Message Actions
						                                                                                                                                                                                                                                     On SAM_Create
							                                                                                                                                                                                                                                     Set strTip = 'Протокол розрахунку (корреляція, коваріація)'
						                                                                                                                                                                                                                                     On SAM_Click
							! Call SalCreateWindow
									(KAR, hWndParent, nMode, nPar, SalFmtFormatDateTime( dDat, 'dd/MM/yyyy'), strPar02)
		Contents
			Column: KV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LCV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ISO
						вал
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LCV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ISO
						вал
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOEF_R
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Коєф.
						корреляції
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOEF_V
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Коєф.
						коваріації
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: VOL1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Волати-
						льність %
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VOL2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Волати-
						льність %
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RATE1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оф.курс
						валюти
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оф.курс
						валюти
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CROS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кросс-
						курс
						1/2
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CROS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кросс-
						курс
						2/1
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
			Date/Time: pDat
		Window Variables
			Number: T6
			! Number: n1
			! Number: n2
			! Number: n3
			! Number: n4
			! Number: n5
			! Date/Time: dTmp
			! String: sFilter
			! String: sSql
			! Number: nRow
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 4)
				Set hWndForm.VAD.T6=1000000
				Set dDat = pDat
				Set hWndForm.VAD.strPrintFileName = 'VAD_'||Str(hWndForm.VAD.nPar)
				Set hWndForm.VAD.strSqlPopulate =
						"SELECT r.KV1, T1.lcv, r.KV2, T2.lcv, round(r.koef,6), round(v.koef,6)
						 INTO :hWndForm.VAD.KV1,   :hWndForm.VAD.LCV1,
						      :hWndForm.VAD.KV2,   :hWndForm.VAD.LCV2,
						      :hWndForm.VAD.KOEF_R,:hWndForm.VAD.KOEF_V
						 FROM TMP_KOREL r, TMP_KOVAR v, TABVAL T1, TABVAL T2
						 WHERE r.kv1=T1.kv AND r.kv2=T2.kv
						   AND r.kv1>=r.kv2 AND v.kv1=r.kv1 AND v.kv2=r.kv2
						 ORDER BY 1, 2   "
				! Set hWndForm.VAD.strSqlPopulate =
						"SELECT r.KV1, T1.lcv LCV1, r.KV2, T2.lcv LCV2, r.koef KOEF_R , v.koef KOEF_V ,
						   (select vol from TMP_VAR where kv=r.KV1 and rownum=1 ) VOL1,
						   (select vol from TMP_VAR where kv=r.KV2 and rownum=1 ) VOL2
						 INTO :hWndForm.VAD.KV1,   :hWndForm.VAD.LCV1,
						      :hWndForm.VAD.KV2,   :hWndForm.VAD.LCV2,
						      :hWndForm.VAD.KOEF_R,:hWndForm.VAD.KOEF_V,
						      :hWndForm.VAD.VOL1,  :hWndForm.VAD.VOL2
						 FROM TMP_KOREL r, TMP_KOVAR v, TABVAL T1, TABVAL T2
						 WHERE r.kv1=T1.kv AND r.kv2=T2.kv
						   AND r.kv1>=r.kv2 AND v.kv1=r.kv1 AND v.kv2=r.kv2
						 ORDER BY 1, 2   "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute(hSqlAux2(),
						  "SELECT round(v1.vol*100,6), round(v2.vol*100,6),
						          v1.RATE_O/v1.BSUM, v2.RATE_O/v2.BSUM
						   INTO :hWndForm.VAD.VOL1, :hWndForm.VAD.VOL2,
						        :hWndForm.VAD.RATE1,:hWndForm.VAD.RATE2
						   FROM TMP_VAR v1, TMP_VAR v2
						   WHERE v1.kv=:hWndForm.VAD.KV1 and v2.kv=:hWndForm.VAD.KV2
						     and rownum=1" )
						and SqlFetchNext(hSqlAux2(),nFetchRes)
					If hWndForm.VAD.RATE1 !=0 and hWndForm.VAD.RATE2 !=0
						Set hWndForm.VAD.CROS1 =
								SalNumberRound( hWndForm.VAD.RATE1 *hWndForm.VAD.T6/hWndForm.VAD.RATE2)/hWndForm.VAD.T6
						Set hWndForm.VAD.CROS2 =
								SalNumberRound( hWndForm.VAD.RATE2 *hWndForm.VAD.T6/hWndForm.VAD.RATE1)/hWndForm.VAD.T6
			! On SAM_DoubleClick
	Table Window: TRU ! ANI-32. Ефективнiсть проц.АКТ-ПАС по ном. та трансф. цiнi
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Проц. АКТ та ПАС по ном.  та трансф. ціні
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    0.688"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.714"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити "трансф." карточки на рахунках'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If SqlPrepareAndExecute( hSql(),"Delete from int_ratn where id in (10,11) " )
									and SqlPrepareAndExecute(hSql(),"Delete from int_accn where id in (10,11) " )
									and SqlCommit( hSql() )
							Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32685
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32686
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32687
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.071"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата початку періоду розрахунку')
						On SAM_Validate
							Call F_DAT()
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.083"
							Top:    0.071"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершення періоду розрахунку')
						On SAM_Validate
							Call F_DAT()
						! On SAM_KillFocus
							                                                                                                                                                                                                           Call SalTblSetColumnTitle( OST, "Залишок на
									" || SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy') )
				Pushbutton: pbExecute
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати Розрахунок (м.б. довго)'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							! Call SalShowWindow( dWait )
							Set dWait = 
									"Виконується розр. з "||
									 SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy') || " по " ||
									 SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy')
							Call SalTblSetColumnTitle( hWndForm.TRU.OST, "Залишок на
									" || SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy') )
							If SqlPLSQLCommand( hSql(), "Bars.ANI( 3, DAT1, DAT2 )" )
							Set dWait = ""
							! Call SalHideWindow( dWait )
							Call SalWaitCursor(FALSE)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dWait
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.429"
							Width:  7.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С-1
					Window Location and Size
						Left:   7.683"
						Top:    0.155"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С-2
					Window Location and Size
						Left:   8.483"
						Top:    0.155"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С-3
					Window Location and Size
						Left:   9.283"
						Top:    0.155"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С-4
					Window Location and Size
						Left:   10.083"
						Top:    0.155"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb5
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С-5
					Window Location and Size
						Left:   10.883"
						Top:    0.155"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				Radio Button: rbA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По рахункам
					Window Location and Size
						Left:   11.883"
						Top:    0.155"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				! Child Table: tbl1
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.071"
							Width:  4.1"
							Width Editable? Yes
							Height: 1.167"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: 1
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? No
.end
					                                                                                                                                                                                                            Contents 
						                                                                                                                                                                                                            Column: nSORT
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
						                                                                                                                                                                                                            Column: sSELE
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
						                                                                                                                                                                                                            Column: sINTO
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
						                                                                                                                                                                                                            Column: sNAME
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
						                                                                                                                                                                                                            Column: nFLAG
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
								                                                                                                                                                                                                            On SAM_AnyEdit
									                                                                                                                                                                                                            If nFLAG != 0
										                                                                                                                                                                                                            Set n3 = n3 + 1
										                                                                                                                                                                                                            Set colN = n3
										                                                                                                                                                                                                            Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										                                                                                                                                                                                                            Set nN = 0
										                                                                                                                                                                                                            Set nRw = TBL_MinRow
										                                                                                                                                                                                                            While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											                                                                                                                                                                                                            Call SalTblSetContext(hWndForm, nRw)
											                                                                                                                                                                                                            If nFLAG
												                                                                                                                                                                                                            Set nN = nN + 1
												                                                                                                                                                                                                            Set nSORT = nN
									                                                                                                                                                                                                            Else 
										                                                                                                                                                                                                            Set colN = 0
										                                                                                                                                                                                                            Set nSORT = NUMBER_Null
										                                                                                                                                                                                                            Set nN = 0
										                                                                                                                                                                                                            Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										                                                                                                                                                                                                            Set nRw = TBL_MinRow
										                                                                                                                                                                                                            While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											                                                                                                                                                                                                            Call SalTblSetContext(hWndForm, nRw)
											                                                                                                                                                                                                            If nFLAG
												                                                                                                                                                                                                            Set nN = nN + 1
												                                                                                                                                                                                                            Set nSORT = nN
						                                                                                                                                                                                                            Column: colN
							                                                                                                                                                                                                            List Values 
							                                                                                                                                                                                                            Message Actions 
					                                                                                                                                                                                                            Functions 
					                                                                                                                                                                                                            Window Variables 
						                                                                                                                                                                                                            Number: nRw
						                                                                                                                                                                                                            Number: nN
					                                                                                                                                                                                                            Message Actions 
						                                                                                                                                                                                                            On SAM_Create
							                                                                                                                                                                                                            Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						                                                                                                                                                                                                            On SAM_DoubleClick
							                                                                                                                                                                                                            Set nFLAG=1-nFLAG
							                                                                                                                                                                                                            Call SalSendMsg(nFLAG,SAM_AnyEdit,0,0)
						                                                                                                                                                                                                            On SAM_FetchRowDone
							                                                                                                                                                                                                            Set colN = 0
				Frame
					Resource Id: 51820
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  4.3"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ТВБВ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						ТВБВ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бал
						Рах.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PAP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: А
						П
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S180
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: S180
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєс
						№
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						нар.%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						нар.Д-В
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ном
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Трнс.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок на
						ДАТУ-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.567"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума %% по
						ном.ставці
						номінал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SRQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума %% по
						ном.ставці
						еквівалент
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума %% по
						транс.ціні
						номінал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: STQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума %% по
						транс.ціні
						еквівалент
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ефект
						(різниця 
						екв)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл-.
						рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			! Column: PAP
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: А
						П
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                               List Values 
				                                                                                                                                                                                                               Message Actions 
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT1 > DAT2
						Call SalMessageBox(
								"Дата Початку НЕ може бути більшою Дати завершення !",
								"Увага, помилка !", MB_IconStop)
						Set DAT2 = GetBankDate() - 1
						Set DAT1 = AddMonths( DAT2, -1 ) + 1
					! Set DAT0 = DAT1 - 1
			Function: F_ZAG
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTitl
					String: rTitl
				Actions
					Call SalShowWindow( S180 )
					Call SalShowWindow( NBS )
					Call SalShowWindow( KV )
					Call SalShowWindow( SR )
					Call SalShowWindow( ST )
					Call SalShowWindow( PAP )
					Call SalShowWindow( KOL )
					If rbA
						Call SalGetWindowText( rbA, rTitl, 120 )
						!
						Call SalHideWindow( NBS )
						Call SalHideWindow( KOL )
						Call SalShowWindow( NLS )
						Call SalShowWindow( RNK )
						Call SalShowWindow( NMK )
						Call SalShowWindow( NLSA )
						Call SalShowWindow( NLSB )
					Else
						Call SalHideWindow( NLS )
						Call SalHideWindow( RNK )
						Call SalHideWindow( NMK )
						Call SalHideWindow( NLSA )
						Call SalHideWindow( NLSB )
						If rb1 
							Call SalGetWindowText( rb1, rTitl, 120 )
						Else If rb2
							Call SalGetWindowText( rb2, rTitl, 120 )
							Call SalHideWindow( S180 )
						Else If rb3
							Call SalGetWindowText( rb3, rTitl, 120 )
							Call SalHideWindow( S180 )
							Call SalHideWindow( NBS )
						Else If rb4
							Call SalGetWindowText( rb4, rTitl, 120 )
							Call SalHideWindow( S180 )
							Call SalHideWindow( NBS )
							Call SalHideWindow( KV )
							Call SalHideWindow( SR )
							Call SalHideWindow( ST )
						Else If rb5
							Call SalGetWindowText( rb5, rTitl, 120 )
							Call SalHideWindow( S180 )
							Call SalHideWindow( NBS )
							Call SalHideWindow( KV )
							Call SalHideWindow( SR )
							Call SalHideWindow( ST )
							Call SalHideWindow( PAP )
						!
					! Call SalGetWindowText( hWndForm, sTitl, 120 )
					Set sTitl = 'Проц. АКТ та ПАС по ном. та трансф. ціні'
					Call SalSetWindowText( hWndForm, rTitl || ':' || sTitl )
					Call SalTblSetColumnTitle( hWndForm.TRU.OST, "Залишок на
							" || SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy') )
		Window Parameters
			Number: nMode
			Number: nPar
			String: pFilter1
			String: strPar02
		Window Variables
			String: sFilter
			String: sFilter1
			String: sSql
			Number: nTmp
			Number: iDQ
			Number: iKOL
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 11)
				Set TRU.nTabInstance = 1
				Set TRU.fFilterAtStart = 0
				Set TRU.strFilterTblName = 'ACCOUNTS'
				Set TRU.strPrintFileName = 'TRU_'||Str(nPar)
				If SqlPrepareAndExecute( hSql(), 
						"select to_date(cc_id,'dd/MM/yyyy'), (to_date(cc_id,'dd/MM/yyyy') + srok)
						 into :DAT1, :DAT2 from CCK_AN_TMP where rownum=1" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Set DAT2 = GetBankDate() - 1
					Set DAT1 = AddMonths( DAT2, -1 ) + 1
				If pFilter1 != ''
					Set rbA = TRUE
					Call SalDisableWindow( DAT2 )
					Call SalDisableWindow( DAT1 )
					Call SalDisableWindow( pbExecute )
					Call SalDisableWindow( rb1 )
					Call SalDisableWindow( rb2 )
					Call SalDisableWindow( rb3 )
					Call SalDisableWindow( rb4)
					Call SalDisableWindow( rb5 )
					Call SalDisableWindow( rbA )
				Else
					If nPar =1 
						Call SalDisableWindow( rbA )
					Call F_DAT()
					Set rb1 = TRUE
					Set rbA = FALSE
				Call SalTblSetColumnTitle( OST, "Залишок на
						" || SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy') )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set dWait = pFilter1 
				Call F_ZAG()
				If TRU.fFilterAtStart
					Set TRU.fFilterAtStart = NOT TRU.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				!
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalWaitCursor(TRUE)
				If rb1
					Set sSql =
							"select t.name, c.BRANCH, c.nbs, c.kv, c.dl,  
							        c.n1/100, c.n2/100, c.n3/100, c.n4/100, c.n5/100,
							        decode(c.si,0, 0, round(c.pr /c.si,2)) ,
							        decode(c.si,0, 0, round(c.prs/c.si,2)) ,  
							        decode(c.tip,0,'A','П'), c.kol
							 INTO :hWndForm.TRU.NAME_BRANCH, :hWndForm.TRU.BRANCH,
							      :hWndForm.TRU.NBS, :hWndForm.TRU.KV, :hWndForm.TRU.S180,
							      :hWndForm.TRU.OST, :hWndForm.TRU.SR, :hWndForm.TRU.SRQ,
							      :hWndForm.TRU.ST,  :hWndForm.TRU.STQ,:hWndForm.TRU.PR,
							      :hWndForm.TRU.PRS, :hWndForm.TRU.PAP,:hWndForm.TRU.KOL   
							 from  tobo t,
							      (SELECT BRANCH, nbs, kv, dl, tip,  
							          sum(n1) n1, sum(n2) n2, sum(n3) n3, sum(n4) n4, sum(n5) n5,
							          sum(rezq) PR, sum(zalq) PRs, sum(uv) SI, count(*) kol 
							       FROM CCK_AN_TMP " ||   IifS(sFilter = "", "",
							      "WHERE acc in (select acc from accounts where "|| sFilter || ")" ) ||"
							       GROUP BY BRANCH, nbs, kv, dl, tip
							        ) c 
							 WHERE c.BRANCH = t.tobo 
							 ORDER BY c.BRANCH, c.tip, c.nbs, c.dl, c.kv "
				Else If rb2
					Set sSql =
							"select t.name, c.BRANCH, c.nbs, c.kv,  
							        c.n1/100, c.n2/100, c.n3/100, c.n4/100, c.n5/100,
							        decode(c.si,0, 0, round(c.pr /c.si,2)) ,
							        decode(c.si,0, 0, round(c.prs/c.si,2)) ,  
							        decode(c.tip,0,'A','П'), c.kol
							 INTO :hWndForm.TRU.NAME_BRANCH, :hWndForm.TRU.BRANCH,
							      :hWndForm.TRU.NBS,:hWndForm.TRU.KV, :hWndForm.TRU.OST,
							      :hWndForm.TRU.SR, :hWndForm.TRU.SRQ,:hWndForm.TRU.ST,
							      :hWndForm.TRU.STQ,:hWndForm.TRU.PR, :hWndForm.TRU.PRS,
							      :hWndForm.TRU.PAP,:hWndForm.TRU.KOL      
							 from  tobo t,
							      (SELECT BRANCH, nbs, kv,  tip,  
							          sum(n1) n1, sum(n2) n2, sum(n3) n3, sum(n4) n4, sum(n5) n5,
							          sum(rezq) PR, sum(zalq) PRs, sum(uv) SI, count(*) kol 
							       FROM CCK_AN_TMP " ||  IifS(sFilter = "", "",
							      "WHERE acc in (select acc from accounts where "|| sFilter || ")" ) ||"
							       GROUP BY BRANCH, nbs, kv, tip
							        ) c 
							 WHERE c.BRANCH = t.tobo 
							 ORDER BY c.BRANCH, c.tip, c.nbs, c.kv "
				Else If rb3
					Set sSql =
							"select t.name, c.BRANCH,  c.kv,  
							        c.n1/100, c.n2/100, c.n3/100, c.n4/100, c.n5/100,
							        decode(c.si,0, 0, round(c.pr /c.si,2)) ,
							        decode(c.si,0, 0, round(c.prs/c.si,2)) ,  
							        decode(c.tip,0,'A','П'), c.kol
							 INTO :hWndForm.TRU.NAME_BRANCH, :hWndForm.TRU.BRANCH,
							      :hWndForm.TRU.KV,  :hWndForm.TRU.OST, :hWndForm.TRU.SR,
							      :hWndForm.TRU.SRQ, :hWndForm.TRU.ST,  :hWndForm.TRU.STQ,
							      :hWndForm.TRU.PR,  :hWndForm.TRU.PRS, :hWndForm.TRU.PAP,
							      :hWndForm.TRU.KOL      
							 from  tobo t,
							      (SELECT BRANCH,  kv,  tip,  
							          sum(n1) n1, sum(n2) n2, sum(n3) n3, sum(n4) n4, sum(n5) n5,
							          sum(rezq) PR, sum(zalq) PRs, sum(uv) SI, count(*) kol 
							       FROM CCK_AN_TMP " ||  IifS(sFilter = "", "",
							      "WHERE acc in (select acc from accounts where "|| sFilter || ")" ) ||"
							       GROUP BY BRANCH, kv, tip
							        ) c 
							 WHERE c.BRANCH = t.tobo 
							 ORDER BY c.BRANCH, c.tip, c.kv "
				Else If rb4
					Set sSql =
							"select t.name, c.BRANCH, c.n1/100, c.n3/100, c.n5/100,
							        decode(c.si,0, 0, round(c.pr /c.si,2)) ,
							        decode(c.si,0, 0, round(c.prs/c.si,2)) ,  
							        decode(c.tip,0,'A','П'), c.kol 
							 INTO :hWndForm.TRU.NAME_BRANCH, :hWndForm.TRU.BRANCH,      
							      :hWndForm.TRU.OST, :hWndForm.TRU.SRQ,:hWndForm.TRU.STQ,
							      :hWndForm.TRU.PR,  :hWndForm.TRU.PRS,:hWndForm.TRU.PAP,
							      :hWndForm.TRU.KOL         
							 from  tobo t,
							      (SELECT BRANCH,  tip,  
							          sum(gl.p_icurval(kv,n1,:DAT2)) n1,  sum(n3) n3,  sum(n5) n5,
							          sum(rezq) PR, sum(zalq) PRs, sum(uv) SI, count(*) kol 
							       FROM CCK_AN_TMP " ||  IifS(sFilter = "", "",
							      "WHERE acc in (select acc from accounts where "|| sFilter || ")" ) ||"
							       GROUP BY BRANCH, tip
							        ) c 
							 WHERE c.BRANCH = t.tobo 
							 ORDER BY c.BRANCH, c.tip "
				Else If rb5
					Set sSql =
							"select t.name, c.BRANCH, c.n1/100, c.n3/100, c.n5/100,
							        decode(c.si,0, 0, round(c.pr /c.si,2)),
							        decode(c.si,0, 0, round(c.prs/c.si,2)), c.kol
							 INTO :hWndForm.TRU.NAME_BRANCH, :hWndForm.TRU.BRANCH,      
							      :hWndForm.TRU.OST, :hWndForm.TRU.SRQ,:hWndForm.TRU.STQ,
							      :hWndForm.TRU.PR,  :hWndForm.TRU.PRS,:hWndForm.TRU.KOL         
							 from  tobo t,
							      (SELECT BRANCH, sum(gl.p_icurval(kv,n1,:DAT2)) n1, sum(n3) n3, sum(n5) n5,
							          sum(rezq) PR, sum(zalq) PRs, sum(uv) SI, count(*) kol 
							       FROM CCK_AN_TMP " ||  IifS(sFilter = "", "",
							      "WHERE acc in (select acc from accounts where "|| sFilter || ")" ) ||"
							       GROUP BY BRANCH 
							        ) c 
							 WHERE c.BRANCH = t.tobo 
							 ORDER BY c.BRANCH "
				Else If rbA
					Set sSql =
							"SELECT c.acc, c.BRANCH  , c.nls, c.kv, c.reg, c.name, 
							        to_char(c.acra), to_char(c.accl),
							        c.pr, c.prs, c.n1/100, c.n2/100 , c.n3/100, c.n4/100 , c.n5/100, 
							        t.name, c.dl, decode(c.tip,0,'A','П')
							 INTO :hWndForm.TRU.ACC,  :hWndForm.TRU.BRANCH,
							      :hWndForm.TRU.NLS,  :hWndForm.TRU.KV,
							      :hWndForm.TRU.RNK,  :hWndForm.TRU.NMK,
							      :hWndForm.TRU.NLSA, :hWndForm.TRU.NLSB,
							      :hWndForm.TRU.PR,   :hWndForm.TRU.PRS,
							      :hWndForm.TRU.OST,  :hWndForm.TRU.SR, :hWndForm.TRU.SRQ,
							      :hWndForm.TRU.ST,   :hWndForm.TRU.STQ,
							      :hWndForm.TRU.NAME_BRANCH,:hWndForm.TRU.S180,:hWndForm.TRU.PAP
							 FROM CCK_AN_TMP c,  tobo t
							 WHERE c.BRANCH=t.tobo "|| IifS(pFilter1 = "", "", " AND " || pFilter1 )||
							 IifS(sFilter = "", "",
							" and acc in (select acc from accounts where "|| sFilter || ")" ) ||
							" ORDER BY c.BRANCH, c.tip, c.nbs, c.dl, c.kv,c.reg, c.n1 "
				!
				! Call Debug('1=' || Subs(sSql,  1,100) )
				! Call Debug('2=' || Subs(sSql,101,100) )
				! Call Debug('3=' || Subs(sSql,201,100) )
				! Call Debug('4=' || Subs(sSql,301,100) )
				! Call Debug('5=' || Subs(sSql,401,100) )
				! Call Debug('6=' || Subs(sSql,501,100) )
				! Call Debug('7=' || Subs(sSql,601,100) )
				! Call Debug('8=' || Subs(sSql,701,100) )
				! Call Debug('9=' || Subs(sSql,801,100) )
				Set iDQ = 0
				Set iKOL=0 
				Call SalTblPopulate(hWndForm, hSql(), sSql , TBL_FillAll  )
				Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
				Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
				Call SalTblFetchRow(hWndForm, nRow )
				Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
				Set NAME_BRANCH = 'Разом'
				Set DQ = iDQ
				Set KOL = iKOL
				! Set VAR_99 = n5
				!
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set DQ = SRQ - STQ 
				Call XSalTblSetCellBackColor( PR,COLOR_LightGreen )
				Call XSalTblSetCellBackColor( PRS,COLOR_Sky )
				Call XSalTblSetCellBackColor( SR,COLOR_LightGreen )
				Call XSalTblSetCellBackColor( SRQ,COLOR_LightGreen )
				Call XSalTblSetCellBackColor( ST,COLOR_Sky  )
				Call XSalTblSetCellBackColor( STQ,COLOR_Sky )
				Set iDQ = iDQ +DQ
				Set iKOL= iKOL +1 
			On SAM_DoubleClick
				If (NOT rbA)  and nPar = 0 
					Set nTmp= IifN(hWndForm.TRU.PAP = 'A', 0, 1 )
					If rb1
						Set sFilter1 = 
								"c.BRANCH='" || hWndForm.TRU.BRANCH     ||
								"' and c.nbs='" || hWndForm.TRU.NBS     || 
								"' and c.kv="   || Str(hWndForm.TRU.KV) ||
								"  and c.dl='"  || hWndForm.TRU.S180    ||
								"' and c.tip="  || Str(nTmp) 
					Else If rb2
						Set sFilter1 = 
								"c.BRANCH='" || hWndForm.TRU.BRANCH     || 
								"' and c.nbs='" || hWndForm.TRU.NBS     ||
								"' and c.kv="   || Str(hWndForm.TRU.KV) || 
								"  and c.tip="  || Str(nTmp) 
					Else If rb3
						Set sFilter1 = 
								"BRANCH='" || hWndForm.TRU.BRANCH || "' and c.kv=" || Str(hWndForm.TRU.KV) ||
								" and c.tip=" || Str(nTmp) 
					Else If rb4
						Set sFilter1 = 
								"c.BRANCH='" || hWndForm.TRU.BRANCH  || "' and c.tip="  || Str(nTmp) 
					Else If rb5
						Set sFilter1 = 
								"c.BRANCH='" || hWndForm.TRU.BRANCH  || "'"
					! Set rbA = TRUE
					! Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalCreateWindow( TRU, hWndMDI, nMode, nPar, sFilter1, strPar02 )
	Table Window: FD
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.042"
				Width:  15.833"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.488"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37541
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.317"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Связь упр.учета и фин.учета для ФОНДИРОВАНИЯ'
						On SAM_Click
							Call Sel030( hWndMDI, 8,0, strTip, "из модуля ANI-управленческий учет" )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.85"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37542
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37543
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Combo Box: sDAT        !! dd-MM-yyyy
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   1.917"
						Top:    0.131"
						Width:  1.833"
						Width Editable? Yes
						Height: 5.988"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Call FDAT()
							Call SalListSetSelect(hWndForm.FD.sDAT, 0)
							Set hWndForm.FD.dDat = SalStrToDate( hWndForm.FD.sDAT )
						On SAM_Click
							Set hWndForm.FD.dDat = SalStrToDate( hWndForm.FD.sDAT )
							! If SqlPrepareAndExecute( hSql(), "delete from anb1_tmp" )
									and SqlPrepareAndExecute( hSql(),
									 "insert into anb1_tmp(ID,NAME,N0,SID,PR_99,PR_SR,PR_AU)
									  select ID,NAME,N0,SID,PR_99,PR_SR,PR_AU from anb1
									  where id like 'Ф___'" )
						On SAM_SetFocus
							Call SalStatusSetText(hWndForm, 'Выберите дату.')
				Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.783"
						Top:    0.155"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.881"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nKv = 0
							Call cmb_KV.Init(hWndItem)
							Call cmb_KV.Populate(hSql(),
									"KV","substr('   '||SKV,-3)||'.'||LCV||'/'||NAME","TABVAL",
									" where  D_CLOSE is null union all select  0 , '  */Консолідовано по вал' from dual
									 ORDER BY 2 ")
							Call SalListSetSelect(cmb_KV,0)
						On SAM_Click
							Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Combo Box: cmb_TOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  3.9"
						Width Editable? Yes
						Height: 4.595"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set sTobo = '*'
							Call cmb_TOBO.Init(hWndItem)
							If nHaveTOBO != 2
								Call cmb_TOBO.Populate(hSql(),
										"TOBO","TOBO||'/'||NAME","TOBO",
										" where nvl(tobo,'0') >='0' union all select '*' , '*/Консолідовано по ТОБО' from dual
										 ORDER BY 1")
							Else
								Call cmb_TOBO.Populate(hSql(),
										"BRANCH","BRANCH||'/'||NAME","BRANCH",
										" where BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask')  
										union all select '*' , '*/Консолідовано по BRANCH' from dual
										 ORDER BY 1")
							Call SalListSetSelect(cmb_TOBO,0)
						On SAM_Click
							Set sTobo =cmb_TOBO.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Итог Акт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Mark
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: i
					Number: j
				Actions
					Set j = 0
					While j+nFixRow <= nColPos
						Call SalTblSetContext(hWndForm, j+nFixRow)
						Set i = 0
						While i+nFixPos <= nColPos
							Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hmColWnd[i]), Dig4(0, 2, 2))
							Set i = i + 1
						Set j = j + 1
					Set i = nColPos - nFixPos
					Set j = nColPos - nFixPos
					While TRUE
						Call SalTblSetContext(hWndForm, j)
						If Abs(nI[i]) <= Abs(nJ[j])
							Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hmColWnd[i]), Dig4(Abs(nI[i]), 2, 2))
							Set nJ[j] = Abs(nJ[j]) - Abs(nI[i])
							Set i = i - 1
						Else
							Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hmColWnd[i]), Dig4(Abs(nJ[j]), 2, 2))
							Set nI[i] = Abs(nI[i]) - Abs(nJ[j])
							Set j = j - 1
						If i < 0 or j < 0
							Break
			Function: FDAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Call SalListClear( sDAT )
					If SqlPrepareAndExecute(hSql(),
							"SELECT to_char(fdat,'dd/MM/yyyy') INTO :sTmp
							 FROM fdat where fdat> :bDatM ORDER BY fdat DESC")
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(sDAT, sTmp)
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: bDatM
			Date/Time: dDat
			Number: nKv
			String: sKv
			String: sTobo
			String: sTmp
			Number: nTmp
			Number: nS
			Number: nKol
			!
			Number: nJ[100]
			Number: nI[100]
			String: sI[100]
			Number: nG
			String: sTitl
			Number: nRow
			String: sSql
			!
			Number: nFixPos
			Number: nFixRow
			Window Handle: hmColWnd[*]
			Number: nColPos
			Number: nColWidth
			Number: nColMaxChar
			String: sColTitle
			Number: i
		Message Actions
			On SAM_Create
				Set sTitl = "Фондирование по Бал.Счетам " 
				Set bDatM = AddMonths( GetBankDate(), -1)
				Call SalSetWindowText( hWndForm, sTitl  )
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set nFixPos = 4
				Set nFixRow = 1
				Set hWndForm.FD.strPrintFileName = 'FD'
				Call SalTblSetLockedColumns( hWndForm, 2 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				! Установить в PUL перем код вал и ТОБО
				Set sKv =Str(nKv)
				! Call Debug(sKv)
				If SqlPLSQLCommand( hSql(),"PUL.Set_Mas_Ini( 'NEW_KV', sKv, 'Код вал' )" )
					! Call Debug(sTobo)
					If SqlPLSQLCommand(hSql(),"PUL.Set_Mas_Ini( 'NEW_TB', sTobo, 'Код TOBO' )" )
						! Call Debug('a')
						If SqlPLSQLCommand(hSql(),"ANI( 7, dDat, dDat )" )
							! Call Debug('b')
							! Пассивы
							Set nG =0
							Set i = 0
							Set nColPos = nFixPos
							Set nColWidth = 1.6
							Set nColMaxChar = 30
							If SqlPrepareAndExecute( hSql(),
									  "SELECT substr(id,3,2)+0, name, v0 INTO :nTmp, :sTmp, :nS
									   FROM anb1_tmp WHERE id like 'Ф2__' and substr(id,4,1)<>' ' ")
								Set nKol = 0
								While SqlFetchNext( hSql(), nFetchRes )
									Set nKol = nKol + 1
									Set sColTitle = sTmp
									Call SalTblCreateColumn(hWndForm, nColPos, nColWidth, nColMaxChar, sColTitle)
									Set hmColWnd[i] = SalTblGetColumnWindow(hWndForm, nColPos, COL_GetPos)
									Call SalTblSetColumnFlags(hmColWnd[i], COL_RightJustify, TRUE)
									Set nI[i] = nS
									If nS != NUMBER_Null
										Set nG = nG + nS
									Set i = i + 1
									Set nColPos = nColPos + 1
								If nKol > 0
									Set sSql =
											"SELECT substr(id,3,2) NPP, name, -v0 
											 INTO :FD.NPP, :FD.NAME,:FD.F00
											 FROM anb1_tmp WHERE id like 'Ф1__' and length(trim(id))=4
											 Order by 1 "
									Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
									!
									Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
									Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
									Call SalTblSetContext(hWndForm, nRow)
									Set NPP = '00'
									Set NAME='Итог Пас'
									Set F00 = nG
									Call XSalTblSetCellBackColor( F00, SalColorFromRGB( 230,255,230 ) )
									!
									Set i = 0
									While i+nFixPos <= nColPos
										Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hmColWnd[i]), Dig4(nI[i], 2, 2))
										Call XSalTblSetCellBackColor(hmColWnd[i], COLOR_LightGray)
										Set i = i + 1
									Call SalTblSortRows( hWndForm, SalTblQueryColumnID(NPP), TBL_SortIncreasing )
									Call SalTblSetContext(hWndForm, 0)
									Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
									Call Mark()
				!
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call XSalTblSetCellBackColor( F00, COLOR_LightGray )
				Set nJ[Val(NPP)] = F00
	Form Window: BR0 ! Связь упр.учета и фин.учета для ФОНДТРОВАНИЯ
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Связь упр.учета и фин.учета для ФОНДИРОВАНИЯ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.7"
				Width Editable? Class Default
				Height: 6.31"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить новую запись'
							If nPar = 0
								Call SalDisableWindow( pbIns )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пометить/Снять пометку на удаление'
							If nPar = 0
								Call SalDisableWindow( pbDel )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитать Верхнюю и Нижнюю таблицы Бал.Сч.'
						On SAM_Click
							Call SalSendMsg( tbl, UM_Populate, 0, 0 )
							Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Внести изменения в Базу Данных'
							If nPar = 0
								Call SalDisableWindow( pbUpdate )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Update, 0, 0)
				Line
					Resource Id: 39669
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39670
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39671
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Активы
					Window Location and Size
						Left:   10.183"
						Top:    0.155"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_Rb()
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Пассивы
					Window Location and Size
						Left:   12.783"
						Top:    0.155"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_Rb()
		Contents
			!
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  9.017"
						Width Editable? Class Default
						Height: 2.012"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Class Default
				Contents
					Column: AP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: А/П
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NBS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Бал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование Бал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set BR0.strSqlPopulate =
								"SELECT to_char(a.PAP), a.NBS, k.txt
								 into :BR0.tbl.AP,:BR0.tbl.NBS,:BR0.tbl.NAME
								 FROM  anb1_ps a, kl_r020 k where a.id=:BR0.tbl3.ID and
								 a.nbs=k.R020 and k.prem='КБ ' ORDER BY a.nbs "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), BR0.strSqlPopulate, TBL_FillAll )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					! On SAM_TblDoDetails
						                                                                                                                                                                                                Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
						                                                                                                                                                                                                Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
					On SAM_SetFocus
					On SAM_KillFocus
						Set hWndLost = BR0.tbl
					On SAM_DoubleClick
						Call F_DEL( 1 ) 
			!
			Custom Control: cVSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			!
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    2.333"
						Width:  9.05"
						Width Editable? Yes
						Height: 2.393"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Yes
				Contents
					Column: AP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: А/П
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NBS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Бал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование Бал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
				Functions
				Window Variables
					String: strSqlPopulate2
					String: strSqlDelete2
					String: strSqlInsert2
					String: strSqlUpdate2
				Message Actions
					On SAM_Create
					On SAM_CreateComplete
						! Call SalSendMsg( BR0.tbl2, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strSqlPopulate2=
								"SELECT t020, r020, txt
								 into :BR0.tbl2.AP,:BR0.tbl2.NBS,:BR0.tbl2.NAME
								 FROM kl_r020
								 where prem='КБ ' and substr(r020,4,1) <> ' ' and r020<'8000'
								   and t020 in (:sPAP,'3') and r020 not in
								(select nbs from anb1_ps where id like 'Ф"||sPAP||"__' )
								 ORDER BY r020 "
						Call SalTblDefineSplitWindow( BR0.tbl2, 0, FALSE)
						Call SalTblPopulate( BR0.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
					On SAM_KillFocus
						Set hWndLost = BR0.tbl2
					On SAM_DoubleClick
						Call F_DEL( 2 )
			!
			Child Table: tbl3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   9.283"
						Top:    -0.036"
						Width:  5.4"
						Width Editable? Yes
						Height: 4.702"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								показателя
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								показателя
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					! Function: F_UPD
						                                                                                                                                                                                                Description:
						                                                                                                                                                                                                Returns
							                                                                                                                                                                                                Boolean:
						                                                                                                                                                                                                Parameters
						                                                                                                                                                                                                Static Variables
						                                                                                                                                                                                                Local variables
						                                                                                                                                                                                                Actions
							                                                                                                                                                                                                Call SalWaitCursor( TRUE )
							                                                                                                                                                                                                Set nRow = TBL_MinRow
							                                                                                                                                                                                                While SalTblFindNextRow(BR0.tbl3, nRow, ROW_Edited, 0)
								                                                                                                                                                                                                Call SalTblSetContext(BR0.tbl3, nRow)
								                                                                                                                                                                                                If NOT SqlPrepareAndExecute( hSql(),"delete from br_branch where branch=:BRANCH and BR=:nSch " )
									                                                                                                                                                                                                Return FALSE
								!
								                                                                                                                                                                                                If BR0.tbl3.OTM = 1
									                                                                                                                                                                                                If NOT SqlPrepareAndExecute( hSql(),"insert into br_branch(branch,br) values (:BRANCH,:nSch) " )
										                                                                                                                                                                                                Return FALSE
							!
							                                                                                                                                                                                                Return TRUE
				Window Variables
					String: strSqlPop
				Message Actions
					On SAM_Create
						Set strSqlPop =
								"SELECT id, name
								 INTO :BR0.tbl3.ID, :BR0.tbl3.NAME FROM anb1
								 WHERE id like 'Ф%' and substr(id,4,1)<>' ' and substr(id,2,1)=:sPAP
								 order by ID"
					On SAM_CreateComplete
						! Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), strSqlPop, TBL_FillAll )
						!
						Set nRow = TBL_MinRow
						Call SalTblSetContext ( tbl3, nRow )
						! Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
						Call SalTblSetRowFlags( tbl3, nRow, ROW_Selected, FALSE )
						Call SalTblSetFocusRow( tbl3, nRow )
						Call SalSendMsg( tbl3, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Call SalSendMsg( tbl, UM_Populate, 0, 0 )
						Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
					On SAM_SetFocus
					On SAM_KillFocus
						Set hWndLost = BR0.tbl3
					! On UM_Update
						                                                                                                                                                                                                If tbl3.F_UPD()
							                                                                                                                                                                                                Call SqlCommit( hSql())
						                                                                                                                                                                                                Else
							                                                                                                                                                                                                Call SqlRollback( hSql())
						                                                                                                                                                                                                Call SalSendMsg(BR0.tbl3, UM_Populate, 0, 0)
			!
		Functions
			Function: F_Rb
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If rb1
						Call SalColorSet( tbl3, COLOR_IndexWindowText, SalColorGet( rb1, COLOR_IndexWindowText ) )
						Set sPAP = '1'
					Else
						Call SalColorSet( tbl3, COLOR_IndexWindowText, SalColorGet( rb2, COLOR_IndexWindowText) )
						Set sPAP = '2'
					Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
			Function: F_DEL
				Description:
				Returns
				Parameters
					Number: nR
				Static Variables
				Local variables
					String: sNBS
					String: sNAME
				Actions
					If nR = 1
						Set sNBS = tbl.NBS
						Set sNAME= tbl.NAME
						If SqlPrepareAndExecute( hSql(),
								  "Delete from anb1_ps where id=:tbl3.ID and nbs=:tbl.NBS and pap=:tbl.AP" ) 
								and SqlCommit( hSql() )
							Call SalTblDeleteRow( tbl, SalTblQueryContext(tbl), TBL_NoAdjust)
							!
							Call SalTblSetContext( tbl2, SalTblInsertRow( tbl2, TBL_MaxRow) )
							Set tbl2.NBS  = sNBS
							Set tbl2.NAME = sNAME
							Set tbl2.AP   = sPAP 
							Return TRUE
					Else If nR = 2
						Set sNBS = tbl2.NBS
						Set sNAME= tbl2.NAME
						If SqlPrepareAndExecute( hSql(),
								  "insert into anb1_ps (id,nbs,pap) values(:tbl3.ID,:tbl2.NBS,:sPAP)" ) 
								and SqlCommit( hSql() )
							Call SalTblDeleteRow( tbl2, SalTblQueryContext(tbl2), TBL_NoAdjust)
							!
							Call SalTblSetContext( tbl, SalTblInsertRow( tbl, TBL_MaxRow) )
							Set tbl.NBS  = sNBS
							Set tbl.NAME = sNAME
							Set tbl.AP   = sPAP 
							Return TRUE
					!
					Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Window Handle: hWndLost
			Number: nRow
			Window Handle: hWndCol
			! Number: nSch
			! Number: nTmp
			String: sPAP
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalSetWindowText( hWndForm, strPar01 )
				! Call SetWindowFullSize(hWndForm)
				Call SalShowWindow(cVSpl)
				Call SalShowWindow(cHSpl)
				!
				Call cVSpl.setBarPosition(600)
				Call cVSpl.setLeftFrame(cHSpl)
				Call cVSpl.setRightFrame(tbl3)
				!
				Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tbl)
				Call cHSpl.setBottomFrame(tbl2)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Set rb1 = TRUE
				Set rb2 = FALSE
				Call F_Rb()
			On UM_Close
				! If SalTblAnyRows( tbl, ROW_Edited | ROW_MarkDeleted | ROW_New, 0 )
					                                                                                                                                                                                            Call SalMessageBeep( MB_IconQuestion )
					                                                                                                                                                                                            If SalMessageBox(CurrentLangTable.GetAtomTitle('cGTQuestion'), 
							   CurrentLangTable.GetAtomTitle('cMsgWarning'), MB_IconQuestion | MB_YesNo) != IDYES
						                                                                                                                                                                                            Return FALSE
				Call SalDestroyWindow( hWndForm )
	Table Window: CUT
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.05"
				Top:    0.073"
				Width:  16.7"
				Width Editable? Class Default
				Height: 7.286"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63212
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.65"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63213
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Line
					Resource Id: 63214
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: Ir
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.183"
							Top:    0.071"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Зміна % ст на')
				Pushbutton: pb_Ir
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.383"
						Top:    0.071"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок Чутливості до змін % ст.'
						On SAM_Click
							Call F_Cut()
				Data Field: P_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: P_KV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.883"
							Top:    0.071"
							Width:  3.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: P_TOBO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.071"
							Width:  3.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: s240
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						240
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						240
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл
						днів
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Активи
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ср.зв.
						% ст
						Акт
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IRA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: + або - 
						% ст
						Акт
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пасиви
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ср.зв.
						% ст
						Пас
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: + або -
						% ст
						Пас
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: POZ1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Позиція
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Позиція
						накопичена
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POZK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Позиція
						комулятивна
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CUT1 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Чутливість 
						до змін % ст. 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: ###0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nPOZ1 = 0
					Set IDP = 0
					Set IKP = 0
					Set IDP5 = 0
					Set IKP5 = 0
					Set IDP7 = 0
					Set IKP7 = 0
					Set IDPB = 0
					Set IKPB = 0
					Call F_Stroka('1', I01,J01)
					Call F_Stroka('2', I02,J02)
					Call F_Stroka('3', I03,J03)
					Call F_Stroka('4', I04,J04)
					Call F_Stroka('5', I05,J05)
					Call F_Stroka('6', I06,J06)
					Call F_Stroka('7', I07,J07)
					Call F_Stroka('A', I0A,J0A)
					Call F_Stroka('B', I0B,J0B)
					Call F_Stroka('C', I0C,J0C)
					Call F_Stroka('D', I0D,J0D)
					Call F_Stroka('E', I0E,J0E)
					Call F_Stroka('F', I0F,J0F)
					Call F_Stroka('G', I0G,J0G)
					Call F_Stroka('H', I0H,J0H)
					!
					Call F_Stroka('X', I0X,J0X)
					! 
							после строки "более10лет"  и перед "всього" 
							добавляется строка "просроченные" (количество дней в периоде = 0), 
							 алгоритм подсчета позиций и 
							чуствительности  не меняется. 
					Call F_Stroka('0', I00,J00)
			Function: F_Stroka
				Description:
				Returns
				Parameters
					String: p240
					! Number: pDni
					Number: I[*]
					Number: J[*]
				Static Variables
				Local variables
				Actions
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					If p240='0'
						Set NAME ='Всього'
					Else If p240='X'
						Set NAME ='Прострочені'
						Set DNI = 0
					Else
						If SqlPrepareAndExecute( hSql(),
								"select k.txt,d.dni into :NAME, :DNI 
								 from kl_s240 k, S240_DNI d 
								 where k.s240=:p240 and k.s240=d.s240 " )
								and SqlFetchNext(hSql(),nFetchRes)
					Set s240 = p240
					Set AKT  = I[1]
					If I[1] != 0
						Set RA   = J[1]/I[1]
					Else
						Set RA   = 0
					Set PAS  = I[2]
					If I[2] != 0
						Set RP   = J[2]/I[2]
					Else
						Set RP   = 0
					!
					Set POZ1 = AKT - PAS
					Set nPOZ1= nPOZ1 + POZ1
					Set POZN = nPOZ1
					Set POZK = POZN * DNI
					!
					If p240='0' OR p240='X'
					Else
						If POZ1  > 0
							Set IDP = IDP + POZ1
						Else
							Set IKP = IKP + POZ1
						If p240<='5'
							If POZ1  > 0
								Set IDP5 = IDP5 + POZ1
							Else
								Set IKP5 = IKP5 + POZ1
						If p240<='7'
							If POZ1  > 0
								Set IDP7 = IDP7 + POZ1
							Else
								Set IKP7 = IKP7 + POZ1
						If p240<='B'
							If POZ1  > 0
								Set IDPB = IDPB + POZ1
							Else
								Set IKPB = IKPB + POZ1
			Function: F_Cut
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nPOZ1a
					Number: nPOZ1p
				Actions
					Set nRow = TBL_MinRow
					Set IDC = 0
					Set IKC = 0
					Set nPOZ1a = 0
					Set nPOZ1p = 0
					While SalTblFindNextRow(hWndForm, nRow, 0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If IRA = NUMBER_Null
							Set IRA = Ir
						!
						If IRP = NUMBER_Null
							Set IRP = Ir
						! Set POZ1 = AKT - PAS
						Set nPOZ1a= nPOZ1a + AKT
						Set nPOZ1p= nPOZ1p + PAS
						Set CUT1 = ( nPOZ1a * IRA - nPOZ1p * IRP ) * DNI / 36500 
						If CUT1 > 0 
							Set IDC = IDC +CUT1
						Else
							Set IKC = IKC +CUT1
						If s240 <= '5'
							If CUT1 > 0 
								Set IDC5 = IDC5 +CUT1
							Else
								Set IKC5 = IKC5 +CUT1
						If s240 <= '7'
							If CUT1 > 0 
								Set IDC7 = IDC7 +CUT1
							Else
								Set IKC7 = IKC7 +CUT1
						If s240 <= 'B'
							If CUT1 > 0 
								Set IDCB = IDCB +CUT1
							Else
								Set IKCB = IKCB +CUT1
						Call XSalTblSetCellBackColor( CUT1, COLOR_LightGreen )
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='Всього довгих позицій'
					Set POZ1 = IDP
					Set CUT1 = IDC
					Call F_ColorI()
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='Всього коротких  позицій'
					Set POZ1 = IKP
					Set CUT1 = IKC
					Call F_ColorI()
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='Чиста позиція (ЧП)'
					Set POZ1 = IKP + IDP
					Set CUT1 = IKC + IDC
					Call F_ColorI()
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='ЧП (1+2+3+4+5)'
					Set POZ1 = IKP5 + IDP5
					Set CUT1 = IKC5 + IDC5
					Call F_ColorI()
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='ЧП(1+2+3+4+5+6+7)'
					Set POZ1 = IKP7 + IDP7
					Set CUT1 = IKC7 + IDC7
					Call F_ColorI()
					!
					Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME ='ЧП(1+2+3+4+5+6+7+A+B)'
					Set POZ1 = IKPB + IDPB
					Set CUT1 = IKCB + IDCB
					Call F_ColorI()
					!
					Return TRUE
			Function: F_ColorI
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call XSalTblSetCellBackColor( s240, COLOR_LightGray )
					Call XSalTblSetCellBackColor( NAME, COLOR_LightGray )
					Call XSalTblSetCellBackColor( DNI, COLOR_LightGray )
					Call XSalTblSetCellBackColor( AKT, COLOR_LightGray )
					Call XSalTblSetCellBackColor( RA, COLOR_LightGray )
					Call XSalTblSetCellBackColor( PAS, COLOR_LightGray )
					Call XSalTblSetCellBackColor( RP, COLOR_LightGray )
					Call XSalTblSetCellBackColor( POZ1, COLOR_LightGray )
					Call XSalTblSetCellBackColor( POZN, COLOR_LightGray )
					Call XSalTblSetCellBackColor( POZK, COLOR_LightGray )
					Call XSalTblSetCellBackColor( CUT1, COLOR_LightGreen )
		Window Parameters
			String: sTitle
			String: cmb_KV
			String: cmb_TOBO
			String: sDAT
			! I01[1] - итог сумм-активов cmb_KV, cmb_TOBO, sDAT,
			! I01[2] - итог сумм-пассивов
			Number: I0X[*]
			Number: I01[*]
			Number: I02[*]
			Number: I03[*]
			Number: I04[*]
			Number: I05[*]
			Number: I06[*]
			Number: I07[*]
			Number: I0A[*]
			Number: I0B[*]
			Number: I0C[*]
			Number: I0D[*]
			Number: I0E[*]
			Number: I0F[*]
			Number: I0G[*]
			Number: I0H[*]
			Number: I00[*]
			! J01[1] - для расчета середн.зв ставка активов 
			! J01[2] - для расчета середн.зв ставка пассивов
			Number: J0X[*]
			Number: J01[*]
			Number: J02[*]
			Number: J03[*]
			Number: J04[*]
			Number: J05[*]
			Number: J06[*]
			Number: J07[*]
			Number: J0A[*]
			Number: J0B[*]
			Number: J0C[*]
			Number: J0D[*]
			Number: J0E[*]
			Number: J0F[*]
			Number: J0G[*]
			Number: J0H[*]
			Number: J00[*]
		Window Variables
			Number: nPOZ1
			Number: nRow
			Number: IDP ! - итог дл (положительное) поз
			Number: IKP ! - итог кор(отрицательных) поз
			Number: IDP5 ! - итог дл (положительное) поз
			Number: IKP5 ! - итог кор(отрицательных) поз
			Number: IDP7 ! - итог дл (положительное) поз
			Number: IKP7 ! - итог кор(отрицательных) поз
			Number: IDPB ! - итог дл (положительное) поз
			Number: IKPB ! - итог кор(отрицательных) поз
			Number: IDC ! - чутл дл (положительное) поз
			Number: IKC ! - чутл кор(отрицательных) поз
			Number: IDC5 ! - чутл дл (положительное) поз
			Number: IKC5 ! - чутл кор(отрицательных) поз
			Number: IDC7 ! - чутл дл (положительное) поз
			Number: IKC7 ! - чутл кор(отрицательных) поз
			Number: IDCB ! - чутл дл (положительное) поз
			Number: IKCB ! - чутл кор(отрицательных) поз
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, sTitle )
				Set CUT.strPrintFileName = 'CUT'
				Call SalTblSetLockedColumns(hWndForm, 3)
				Set P_DAT = sDAT
				Set P_KV  = cmb_KV
				Set P_TOBO= cmb_TOBO
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				! Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call NASELENIE()
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
	Table Window: OB2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналiз балансу за перiод
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -1.363"
				Top:    -0.135"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.869"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.631"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.883"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call NASELENIE()
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15456
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.85"
						Begin Y:  0.071"
						End X:  5.85"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.383"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.883"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.383"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15457
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.883"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15458
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Group Box: Групувати  по
					Resource Id: 43847
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.071"
						Width:  3.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Group Box: Сортувати  по
					Resource Id: 43848
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.483"
						Top:    0.071"
						Width:  8.2"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Check Box: cb_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Бранч
					Window Location and Size
						Left:   0.583"
						Top:    0.238"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Check Box: cb_KV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вал
					Window Location and Size
						Left:   1.883"
						Top:    0.238"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Check Box: cb_OB22
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Об22
					Window Location and Size
						Left:   2.983"
						Top:    0.238"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Frame
					Resource Id: 9734
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  9.6"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Data Field: FDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.238"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							If nPar != 0
								Call SalHideWindow( FDAT )
							Else
								Set FDAT = GetBankDate() -1 
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Задайте звітну дату')
				Combo Box: YYYYMM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.683"
						Top:    0.238"
						Width:  1.933"
						Width Editable? Yes
						Height: 4.44"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If nPar != 0
								Call SalHideWindow( YYYYMM )
							Else
								If SqlPrepareAndExecute(hSql(),
										"SELECT distinct to_char(fdat,'yyyy-MM') INTO :sTmp
										 FROM fdat  
										 WHERE to_char(fdat,'yyyy-MM') < to_char(gl.BD,'yyyy-MM')
										ORDER BY 1 DESC")
									While SqlFetchNext(hSql(), nFetchRes)
										Call SalListAdd(YYYYMM, sTmp)
									Call SalListSetSelect(hWndItem, 0)
						On SAM_SetFocus
							Call SalStatusSetText(hWndForm, 'Виберіть звітний місяць')
				Data Field: YYYY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 4
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.238"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Dark Green
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							If nPar != 0
								Call SalHideWindow( YYYY )
							Else
								Set YYYY = SalDateYear(GetBankDate()) - 1
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Задайте звітний рік')
				!
				Radio Button: rbD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За дату
					Window Location and Size
						Left:   6.183"
						Top:    0.238"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Баланс за звiтну дату')
						On SAM_Create
							Set rbD = TRUE
				Radio Button: rbM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За місяць
					Window Location and Size
						Left:   9.683"
						Top:    0.238"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Баланс за звiтний МIСЯЦЬ (з корр.)')
						On SAM_Create
							Set rbM = FALSE
				Radio Button: rbY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За рік
					Window Location and Size
						Left:   12.283"
						Top:    0.238"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Баланс за звiтний РІК (розгорнений)')
						On SAM_Create
							Set rbY = FALSE
				Check Box: cb_Sql
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Отл.Sql
					Window Location and Size
						Left:   16.383"
						Top:    0.321"
						Width:  2.5"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Check Box: cb_Name
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: З назвою рах
					Window Location and Size
						Left:   13.883"
						Top:    -0.012"
						Width:  2.5"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Т
						и
						п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						бранчу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						бранчу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бал
						рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.567"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ОБ22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OSTDN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зал.
						Дебет
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTDQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зал.
						Дебет
						Екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTKN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зал.
						Кредит
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTKQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зал.
						Кредит
						Екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DOSTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пот.об.
						Дебет
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOSTQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пот.об.
						Дебет
						Екві
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пот.об.
						Кредит
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSTQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пот.об.
						Кредит
						Екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOSZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кор.об.
						Дебет
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOSZQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кор.об.
						Дебет
						Екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кор.об.
						Кредит
						Ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSZQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кор.об.
						Кредит
						Екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  6.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ZN50
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ZN50
						Надра
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SEGM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сегм
						Надра
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NASELENIE
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: Di_
					String: sFilter
					String: sSql0
					String: sSql1
					String: SELE
					String: INTO
					String: GROU
					String: sAcc
					String: sAgg
					Date/Time: CALDT_DATE
					String: sTitle
					String: sTitle1
				Actions
					If OB2.rbD
						Set CALDT_DATE = FDAT
						Set sTitle1 = "за дату " 
					Else If OB2.rbM
						Set CALDT_DATE = 
								SalDateConstruct( Val(Subs(YYYYMM,1,4)), Val(Subs(YYYYMM,6,2)), 01, 0,0,0 )
						Set sTitle1 = "на звiтний МIСЯЦЬ (з корр.)" 
					Else If OB2.rbY
						Set CALDT_DATE = 
								SalDateConstruct( YYYY, 01, 01, 0,0,0 )
						Set sTitle1 = "на звiтний РIК (розгорнений) " 
					!
					Set sTitle = "Баланс " || sTitle1 || SalFmtFormatDateTime( CALDT_DATE, 'dd.MM.yyyy' )
					Call SalSetWindowText( hWndForm, sTitle  )
					!
					If SqlPrepareAndExecute(hSql(),
							"select caldt_ID into :Di_ from accm_calendar where caldt_DATE = :CALDT_DATE") 
							and NOT SqlFetchNext(hSql(), nFetchRes)
						Return FALSE
					! спросить фильтр
					If NOT SetQueryFilter( cF )
						If cb_BRANCH =1
							Call SalMessageBox('Запит Тяжкий !','Без фільтру вхід неможливий!', MB_IconStop)
							Return FALSE
					!
					Set sFilter = cF.GetFilterWhereClause(FALSE)
					If sFilter = '' 
						If cb_BRANCH =1
							Call SalMessageBox('Запит Тяжкий !','Недостатньо параметрів фільтру !', MB_IconStop)
							Return FALSE
					Call SalWaitCursor(TRUE)
					!
					Set sAcc = 
							"(select a.acc,a.branch,a.nbs,a.kv,a.ob22 from accounts a where a.nbs not like '8%' ) "
					If OB2.rbM
						Set sAgg = 
								"(select * from ACCM_AGG_MONBALS 
								  where (ostQ<>0 or CRdosQ<>0 or CRkosQ<>0 or CUdosQ<>0 or CUkosQ<>0 or dosQ<>0 or kosQ<>0) 
								  and caldt_ID= " || Str(Di_) || " ) "
					Else If OB2.rbD
						Set sAgg = 
								"(select * from ACCM_SNAP_BALANCES where (ostQ<>0 or dosQ<>0 or kosQ<>0) 
								  and caldt_ID= " || Str(Di_) || " ) "
					Else If OB2.rbY
						Set sAgg = "(select * from ACCM_AGG_YEARBALS where caldt_ID= " || Str(Di_) || " ) "
					!
					Set SELE = "SELECT b.NBS, " 
					Set INTO = "INTO :OB2.NBS, " 
					Set GROU = "GROUP BY b.NBS "
					If cb_BRANCH =1
						Call SalShowWindow( TIP )
						Call SalShowWindow( BRANCH )
						Call SalShowWindow( NAME )
						Set SELE = SELE || "b.BRANCH, " 
						Set INTO = INTO || ":OB2.BRANCH, " 
						Set GROU = GROU || ", b.BRANCH "
					Else
						Call SalHideWindow( TIP )
						Call SalHideWindow( BRANCH )
						Call SalHideWindow( NAME )
					If cb_KV =1
						Call SalShowWindow( KV )
						Call SalShowWindow( OSTDN )
						Call SalShowWindow( OSTKN )
						Call SalShowWindow( DOSTN )
						Call SalShowWindow( KOSTN )
						Call SalShowWindow( DOSZN )
						Call SalShowWindow( KOSZN )
						Set SELE = SELE || "b.KV, " 
						Set INTO = INTO || ":OB2.KV, "
						Set GROU = GROU || ", b.KV "
					Else
						Call SalHideWindow( KV )
						Call SalHideWindow( OSTDN )
						Call SalHideWindow( OSTKN )
						Call SalHideWindow( DOSTN )
						Call SalHideWindow( KOSTN )
						Call SalHideWindow( DOSZN )
						Call SalHideWindow( KOSZN )
					If cb_OB22 =1
						Call SalShowWindow( OB22 )
						Set SELE = SELE || "b.OB22, " 
						Set INTO = INTO || ":OB2.OB22, " 
						Set GROU = GROU || ", b.OB22 "
					Else
						Call SalHideWindow( OB22 )
					!
					If OB2.rbM
						Set sSql0 =
								"(select ACCM.BRANCH, ACCM.NBS, ACCM.KV, ACCM.ob22, 
								         d.ACC, d.ost -d.CRdos +d.CRkos  OST, d.ostq-d.CRdosq+d.CRkosq OSTQ,
								         d.dosQ - d.CUdosQ  P50, d.kosQ - d.CUkosQ  P60,
								         d.dos  - d.CUdos   P51, d.kos  - d.CUkos   P61,
								         d.CRdosQ           P70, d.CRkosQ           P80,
								         d.CRdos            P71, d.CRkos            P81
								  from "  || sAcc || " ACCM, " || sAgg || " d   
								  where " || IifS (sFilter = "", "", sFilter || "  and " ) || " ACCM.acc=d.acc ) "
						Call SalShowWindow( DOSTN )
						Call SalShowWindow( DOSTQ )
						Call SalShowWindow( KOSTN )
						Call SalShowWindow( KOSTQ )
						Call SalShowWindow( DOSZN )
						Call SalShowWindow( DOSZQ )
						Call SalShowWindow( KOSZN )
						Call SalShowWindow( KOSZQ )
					Else If OB2.rbD
						Set sSql0 =
								"(select ACCM.BRANCH, ACCM.NBS, ACCM.KV, ACCM.ob22, 
								         d.ACC, d.OST, d.OSTQ, d.dosQ P50, d.kosQ P60,   d.dos  P51, d.kos  P61,
								         0 P70, 0 P80, 0 P71, 0 P81
								  from "  || sAcc || " ACCM, " || sAgg || " d   
								  where " || IifS (sFilter = "", "", sFilter || "  and " ) || " ACCM.acc=d.acc ) "
						Call SalShowWindow( DOSTN )
						Call SalShowWindow( DOSTQ )
						Call SalShowWindow( KOSTN )
						Call SalShowWindow( KOSTQ )
						Call SalHideWindow( DOSZN )
						Call SalHideWindow( DOSZQ )
						Call SalHideWindow( KOSZN )
						Call SalHideWindow( KOSZQ )
					Else If OB2.rbY
						Set sSql0 =
								"(select ACCM.BRANCH, ACCM.NBS, ACCM.KV, ACCM.ob22, 
								         d.ACC, d.OST, d.OSTQ, 0 P50, 0 P60, 0 P51, 0 P61, 0 P70, 0 P80, 0 P71, 0 P81
								  from "  || sAcc || " ACCM, " || sAgg || " d   
								  where " || IifS (sFilter = "", "", sFilter || "  and " ) || " ACCM.acc=d.acc ) "
						Call SalHideWindow( DOSTN )
						Call SalHideWindow( DOSTQ )
						Call SalHideWindow( KOSTN )
						Call SalHideWindow( KOSTQ )
						Call SalHideWindow( DOSZN )
						Call SalHideWindow( DOSZQ )
						Call SalHideWindow( KOSZN )
						Call SalHideWindow( KOSZQ )
					!
					Set sSql1 = 
							SELE || " 
							     sum(b.P11)/100, sum(b.P10)/100, sum(b.P21)/100, sum(b.P20)/100, 
							     sum(b.P51)/100, sum(b.P50)/100, sum(b.P61)/100, sum(b.P60)/100,
							     sum(b.P71)/100, sum(b.P70)/100, sum(b.P81)/100, sum(b.P80)/100 " ||
							INTO || " 
							     :OB2.OSTDN, :OB2.OSTDQ, :OB2.OSTKN, :OB2.OSTKQ, 
							     :OB2.DOSTN, :OB2.DOSTQ, :OB2.KOSTN, :OB2.KOSTQ,
							     :OB2.DOSZN, :OB2.DOSZQ, :OB2.KOSZN, :OB2.KOSZQ 
							from ( select ACC,BRANCH, NBS, KV, OB22,
							            decode( sign(ostq),1, 0, -ostq) P10,
							            decode( sign(ostq),1, ostq, 0 ) P20,
							            decode( sign(ost ),1, 0, -ost ) P11,
							            decode( sign(ost ),1, ost , 0 ) P21, 
							            P50,P60,P51,P61,P70,P80,P71,P81
							       from " || sSql0 || " 
							      ) b   " || GROU || "  ORDER BY 1,2,3,4 " 
					!
					Set sBR='*'
					Set IOSTDQ = 0
					Set IOSTKQ = 0
					Set IDOSTQ = 0
					Set IKOSTQ = 0
					Set IDOSZQ = 0
					Set IKOSZQ = 0
					If cb_Sql = 1
						Call Debug( Subs(sSql1,0001,500 ) )
						Call Debug( Subs(sSql1,0501,500 ) )
						Call Debug( Subs(sSql1,1001,500 ) )
						Call Debug( Subs(sSql1,1501,500 ) )
					Call SalTblPopulate(hWndForm, hSql(), sSql1, TBL_FillAll)
					Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME='Пiдсумок'
					Set OSTDQ = IOSTDQ 
					Set OSTKQ = IOSTKQ 
					Set DOSTQ = IDOSTQ 
					Set KOSTQ = IKOSTQ 
					Set DOSZQ = IDOSZQ 
					Set KOSZQ = IKOSZQ 
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sSql2
			String: aMfo
			String: sTmp 
			String: sTmpB
			String: sTmpT
			Number: nRow
			String: sBR
			Date/Time: dDat
			Number: n980
			Number: nCol
			Number: IOSTDQ
			Number: IOSTKQ
			Number: IDOSTQ
			Number: IKOSTQ
			Number: IDOSZQ
			Number: IKOSZQ
		Message Actions
			On SAM_Create
				Set hWndForm.OB2.fFilterAtStart = TRUE
				Set hWndForm.OB2.nTabInstance = 1
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set cb_Sql = 0
				Set cb_Name = 1
				If nPar = 0
					Set hWndForm.OB2.strFilterTblName = 'ACCM'
					Set hWndForm.OB2.strPrintFileName = 'ACCM'
				Else
					Set hWndForm.OB2.strFilterTblName = 'ACCOUNTS'
					Set hWndForm.OB2.strPrintFileName = 'ACCOUNTS'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If nPar = 0
					Set cb_BRANCH =1
					Set cb_KV =1
					Set cb_OB22 =1
					Set rbD = TRUE
					Set rbM = FALSE
					Set rbY = FALSE
					Set cb_Name = 1
				Else
					Call SalHideWindow( cb_BRANCH )
					Call SalHideWindow( cb_OB22 )
					Call SalHideWindow( rbD )
					Call SalHideWindow( rbM )
					Call SalHideWindow( rbY )
				If aMfo != '380764'
					Call SalHideWindow( ZN50 )
					Call SalHideWindow( SEGM )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If cb_BRANCH = 1 OR nPar != 0
					If sBR ! = BRANCH
						Set sBR = BRANCH
						If SqlPrepareAndExecute(hSqlAux2(),
								"select name into :sTmpB from branch where branch=:BRANCH  ") 
								and  SqlFetchNext(hSqlAux2(), nFetchRes) 
						If SqlPrepareAndExecute(hSqlAux2(),
								"select VAL into :sTmpT from BRANCH_PARAMETERS
								 where branch=:BRANCH  and tag='TIP'") 
								and  SqlFetchNext(hSqlAux2(), nFetchRes) 
					Set NAME = sTmpB
					Set TIP  = sTmpT
				Call XSalTblSetCellBackColor( OSTDQ, COLOR_LightGray )
				Call XSalTblSetCellBackColor( OSTKQ, COLOR_LightGray )
				Call XSalTblSetCellBackColor( DOSTQ, COLOR_LightGray )
				Call XSalTblSetCellBackColor( KOSTQ, COLOR_LightGray )
				Call XSalTblSetCellBackColor( DOSZQ, COLOR_LightGray )
				Call XSalTblSetCellBackColor( KOSZQ, COLOR_LightGray )
				Set IOSTDQ = IOSTDQ + OSTDQ
				Set IOSTKQ = IOSTKQ + OSTKQ
				Set IDOSTQ = IDOSTQ + DOSTQ 
				Set IKOSTQ = IKOSTQ + KOSTQ 
				Set IDOSZQ = IDOSZQ + DOSZQ
				Set IKOSZQ = IKOSZQ + KOSZQ
				If cb_KV = 1 OR nPar != 0
					If KV != n980
						If KV=840 ! Зеленые
							Set nCol = SalColorFromRGB( 0,255,0 )
						Else If KV=978 ! Голубые
							Set nCol = COLOR_Cyan
						Else If KV=643 ! Красные
							Set nCol = SalColorFromRGB( 250,200,180 )
						Else If KV=959 ! Желтый
							Set nCol =  COLOR_Yellow
						Else If KV=961 ! Серебристый
							Set nCol = SalColorFromRGB( 230,250,255 )
						Else If KV=962 ! ??
							Set nCol = SalColorFromRGB( 200,250,200 )
						Else ! Орхидея
							Set nCol = COLOR_Orchid
						Call XSalTblSetCellBackColor( OSTDN, nCol )
						Call XSalTblSetCellBackColor( OSTKN, nCol )
						Call XSalTblSetCellBackColor( DOSTN, nCol )
						Call XSalTblSetCellBackColor( KOSTN, nCol )
						Call XSalTblSetCellBackColor( DOSZN, nCol )
						Call XSalTblSetCellBackColor( KOSZN, nCol )
						Call XSalTblSetCellBackColor( KV, nCol )
				If cb_Name = 1 
					If cb_OB22 =1
						If aMfo = '380764'
							Set sSql2 = 
									"select substr(txt,1,100), zn50, SEGMENT
									 into :TXT, :ZN50, :SEGM 
									 from sb_ob22 where r020 = :NBS and ob22=:OB22 "
						Else
							Set sSql2 = 
									"select substr(txt,1,100) into :TXT 
									from sb_ob22 where r020 = :NBS and ob22=:OB22 "
					Else
						Set sSql2 = 
								"select substr(name,1,100) into :TXT from ps where nbs = :NBS "
					If SqlPrepareAndExecute( hSqlAux2(),sSql2 )
							and  SqlFetchNext( hSqlAux2(), nFetchRes)
	Table Window: RT0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Побудова планів бюджету
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    1.375"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.821"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.821"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43896
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43897
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.583"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43898
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Group Box: Перенести данi
					Resource Id: 43899
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.783"
						Top:    0.071"
						Width:  10.6"
						Width Editable? Yes
						Height: 0.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_Koef
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути/Змінити % проросту плану бюджету'
						On SAM_Click
							Call FunNSIEditF("BU1", 2|0x0010)
									
				Radio Button: rPY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: План поперед.року
					Window Location and Size
						Left:   5.483"
						Top:    0.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rPQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: План поперед.кварталу
					Window Location and Size
						Left:   7.983"
						Top:    0.155"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rFY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Факт поперед.року
					Window Location and Size
						Left:   5.483"
						Top:    0.405"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rFQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Факт поперед.кварталу
					Window Location and Size
						Left:   7.983"
						Top:    0.405"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Перенести данi з попереднього періоду на указаний' 
						On SAM_Click
							If rPY OR rFY
								Set dTmp =  AddMonths( dQ, -12 )
							Else If rPQ OR rFQ
								Set dTmp =  AddMonths( dQ, -3 )
							If SalMessageBox(
									'Ви дійсно бажаєте перенести '|| IifS( rPY OR rPQ, "План","Факт" )|| '-данi з  
									' ||
									SalFmtFormatDateTime( dTmp, "dd.MM.yyyy" ) ||
									' на '||
									SalFmtFormatDateTime( dQ, "dd.MM.yyyy" ) || 
									' з урахуванням % приросту ?', 
									'Увага!', MB_IconQuestion | MB_YesNo) = IDYES
								Call SalWaitCursor(TRUE)
								!
								If SqlPrepareAndExecute( hSql(), 
										"insert into BU_PLAN (PDAT, ID, BRANCH ) 
										 select :dQ, u.id, b.branch   from bu1 u, branch b
										 where length(b.branch) in (8,15)      and not exists 
										(select 1 from BU_PLAN where PDAT= :dQ and ID=u.id and BRANCH=b.branch) " )
								!
								If rPY OR rPQ
									If SqlPrepareAndExecute( hSql(),
											"update bu_plan u set sp = (select sp from bu_plan where pdat = :dTmp and id=u.id and branch=u.branch )
											 Where pdat= :dQ ") 
								Else If rFY OR rFQ
									If rFQ
										Set YYYYMM = SalFmtFormatDateTime( AddMonths( dQ, -1 ), 'yyyy-MM' )
									Else If rFY 
										Set YYYYMM = SalFmtFormatDateTime( AddMonths( dQ, -10 ), 'yyyy-MM' )
									! Call Debug(YYYYMM)
									! по МФО
									If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 1, 1, YYYYMM, dTmp)" ) 
										If SqlPrepareAndExecute( hSql(),
												"update bu_plan u 
												 set sp = (select ABS( (s6-s7)-(k6-k7) )/100 from ANI_BU where  id=u.id and branch=u.branch )
												 where length(branch) = 8   and pdat= :dQ ") 
									! по Бранч-2
									If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 1, 2, YYYYMM, dTmp)" ) 
										If SqlPrepareAndExecute( hSql(),
												"update bu_plan u 
												 set sp = (select ABS( (s6-s7)-(k6-k7) )/100 from ANI_BU where  id=u.id and branch=u.branch ) 
												 where length (branch) = 15  and pdat= :dQ ") 
								If SqlPrepareAndExecute( hSql(),
										"update bu_plan u   set sp = sp + sp * (select nvl(KOEF_PLAN,0)/100 from bu1 where id = u.id)
										 Where pdat= :dQ ") 
									Call SqlCommitEx(hSql(), strTip )
									Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( strTip || '
											 Виконано !','Повідомлення',3,0)
				Data Field: dQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.321"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Set dQ = SalDateQuarterBegin( GetBankDate() )
				Pushbutton: pb_Itog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.583"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 
									'<= Авто-Розрахунок планів по підсумковим статтям за квартальну дату '
						On SAM_Click
							Set sTmp = 
									SalFmtFormatDateTime( dQ, 'dd.MM.yyyy' ) || strTip 
							If SalMessageBox(
									 ' Ви дійсно бажаєте виконати 
									' || sTmp || ' ? ',
									'Увага ! ', MB_IconQuestion | MB_YesNo) = IDYES
								! - nUr  = -1 - Планы по МФО,  - nUr  = -2 - Планы по Бранч-2, 
								! Set nUr = IifN (rb_1,1, IifN (rb_2,2,IifN (rb_3,3,4 ) ) ) 
								!
								! С 26-07-2011 Всегда -1 ( т.е. сразу и для МФО и для Бранч-2)
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), "ANI4_BU_ex( 2,  -1  , YYYYMM, dQ )" )
									Call SqlCommitEx(hSql(), sTmp   )
									Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( sTmp || '
											 Виконано !','Повідомлення',3,0)
								Call SalWaitCursor(FALSE)
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						пок.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMEU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Бранча
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMEB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						Бранча
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOEF_PLAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % 
						приросту
						до плану
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SP4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: IV кв.
						поперед.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ST1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: I кв.
						поточ.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ST2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: II кв.
						поточ.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ST3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: III кв.
						поточ.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ST4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: IV кв.
						поточ.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: I кв.
						наступ.року
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_BU
				Description:
				Returns
				Parameters
					Number: nId
					String: sBr
					Date/Time: dDt
					Number: nSP
				Static Variables
				Local variables
					Number: nS
				Actions
					! Call DebugN( nId )
					! Call Debug( sBr )
					! Call Debug( SalFmtFormatDateTime( dDt, 'dd.MM.yyyy') )
					! Call DebugN( nSP )
					If SqlPrepareAndExecute(hSql(), 
							 "select Nvl(sp,0) into :nS from bu_plan 
							  where id = :nId and branch = :sBr and pdat = :dDt " )
							and SqlFetchNext(hSql(),nFetchRes) 
						If nS != nSP
							Return SqlPrepareAndExecute(hSql(), 
									"update bu_plan set sp= :nSP 
									 where id = :nId and branch = :sBr and pdat = :dDt " )
						Return TRUE
					Else
						Return SqlPrepareAndExecute(hSql(),
								 "insert into bu_plan(id,branch,pdat,sp) values ( :nId, :sBr, :dDt, :nSP )" )
		Window Parameters
			Number: nMode
			Number: nPar 
			String: strPar01 
			String: strPar02
		Window Variables
			Number: nYYYYp    
			Number: nYYYYt 
			Number: nYYYYb
			Date/Time: dP4
			Date/Time: dT1
			Date/Time: dT2
			Date/Time: dT3
			Date/Time: dT4
			Date/Time: dB1
			Date/Time: dTmp
			String: YYYYMM
			String: sTmp
		Message Actions
			On SAM_Create
				! Set nCol[1] = SalColorFromRGB( 255,240,255 )
				! Set nCol[2] = SalColorFromRGB( 220,255,255 )
				! Set nCol[3] = SalColorFromRGB( 230,255,230 
				Call SalTblSetLockedColumns(hWndForm, 5)
				Set rPQ = TRUE
				Set rPY = FALSE
				Set RT0.strPrintFileName = 'RT0'
				Set nYYYYt = SalDateYear ( SalDateCurrent ( ) ) 
				Set nYYYYp = SalDateYear ( SalDateCurrent ( ) )-1 
				Set nYYYYb = SalDateYear ( SalDateCurrent ( ) )+1 
				!
				Set dP4 = SalDateConstruct( nYYYYp, 10, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( SP4, "IV кв.
						поперед.року
						" || SalFmtFormatDateTime( dP4, "dd.MM.yyyy" ) )
				!
				Set dT1 = SalDateConstruct( nYYYYt, 01, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( ST1, "I кв.
						поточ.року
						" || SalFmtFormatDateTime( dT1, "dd.MM.yyyy" ) )
				!
				Set dT2 = SalDateConstruct( nYYYYt, 04, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( ST2, "II кв.
						поточ.року
						" || SalFmtFormatDateTime( dT2, "dd.MM.yyyy" ) )
				!
				Set dT3 = SalDateConstruct( nYYYYt, 07, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( ST3, "III кв.
						поточ.року
						" || SalFmtFormatDateTime( dT3, "dd.MM.yyyy" ) )
				!
				Set dT4 = SalDateConstruct( nYYYYt, 10, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( ST4, "IV кв.
						поточ.року
						" || SalFmtFormatDateTime( dT4, "dd.MM.yyyy" ) )
				!
				Set dB1 = SalDateConstruct( nYYYYb, 01, 1, 0, 0, 0 )
				Call SalTblSetColumnTitle( SB1, "I кв.
						наступ.року
						" || SalFmtFormatDateTime( dB1, "dd.MM.yyyy" ) )
				!
				Set RT0.strFilterTblName = 'V_BUPLAN'
				!
				Set RT0.strSqlPopulate =
						"SELECT ID, NAMEU, BRANCH, NAMEB, SP4, ST1, ST2, ST3, ST4, SB1,  nvl(KOEF_PLAN,0)
						 INTO :RT0.ID, :RT0.NAMEU, :RT0.BRANCH, :RT0.NAMEB, 
						      :RT0.SP4, :RT0.ST1, :RT0.ST2, :RT0.ST3, :RT0.ST4, :RT0.SB1 , :RT0.KOEF_PLAN 
						 FROM v_BUPLAN  ORDER BY BRANCH,  ID "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Call SalWaitCursor(TRUE)
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow, ROW_Edited , 0)
					Call SalTblSetContext(hWndForm, nRow)
					Call F_BU ( ID, BRANCH, dP4, SP4) 
					Call F_BU ( ID, BRANCH, dT1, ST1) 
					Call F_BU ( ID, BRANCH, dT2, ST2) 
					Call F_BU ( ID, BRANCH, dT3, ST3) 
					Call F_BU ( ID, BRANCH, dT4, ST4) 
					Call F_BU ( ID, BRANCH, dB1, SB1) 
				Call SqlCommit( hSql() )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
