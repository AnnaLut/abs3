.head 0 +  Application Description: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! Импорт / Экспорт данных в АБС  !
! ООО УНИТИ-Барс (C) 1996-2012   !
! Разработчик: Костров С.В. & Ko !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B20000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFF000000 0000000000360300 00A4010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730E646C
0080: 675F496D706F7274 53424F4E
.enddata
.data DT_MAKERUNDLG
0000: 0200000000015C0B 5C524547434C4E2E 646C6C0B5C524547 434C4E2E61706300
0020: 000101011C713A5C 6261727339385C6C 6962726172795C52 4547434C4E2E7275
0040: 6E1C713A5C626172 7339385C6C696272 6172795C52454743 4C4E2E646C6C1C71
0060: 3A5C626172733938 5C6C696272617279 5C524547434C4E2E 6170630000010101
0080: 165C424152533938 5C62696E5C696D70 6578702E61706416 5C4241525339385C
00A0: 62696E5C696D7065 78702E646C6C165C 4241525339385C62 696E5C696D706578
00C0: 702E617063000001 0101001C713A5C62 61727339385C6C69 62726172795C5245
00E0: 47434C4E2E646C6C 1C713A5C62617273 39385C6C69627261 72795C524547434C
0100: 4E2E617063000001 0101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Nokk.apd
.head 2 -  Dynalib: impexp7.apd
.head 2 -  Dynalib: DOCVIEW.APD
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Docfun6.apl
.head 2 -  File Include: VTCOMDLG.APL
.head 2 -  File Include: dsdll.apl
.head 2 -  File Include: Gentimer.apl
.head 2 -  File Include: GenButn.apl
.head 2 -  File Include: GenFcls.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: Vtdos.apl
.head 2 -  File Include: Vtlbx.apl
.head 2 -  File Include: Vttblwin.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Vtarray.apl
.head 2 -  File Include: GENLIST.APL
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: DOCWIS6.APL
.head 2 -  File Include: QCKTABS.APL
.head 2 -  Dynalib: CUSTACNT.APD
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MMddyy
.head 3 -  Date/Time: ddMMMyyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: #0.
.head 3 -  Date/Time: dd.MM.yyyy hh:mm:ss
.head 3 -  Date/Time: dd.MM.yyyy hhhh:mm:ss
.head 3 -  Number: #########
.head 3 -  Date/Time: dd/MM/yy
.head 3 -  Date/Time: dd.MM.yyyy
.head 2 +  External Functions
.head 3 +  Library name: IctBob.Dll
.head 4 +  Function: llopen
.head 5 -  Description: открытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: llcreat
.head 5 -  Description: создание файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: llclose
.head 5 -  Description: закрытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 4 +  Function: llread
.head 5 -  Description: чтение файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: UINT
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  String: LPVOID
.head 6 -  Number: UINT
.head 4 +  Function: llwrite
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: UINT
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  String: LPCSTR
.head 6 -  Number: UINT
.head 4 +  Function: lllseek
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: LONG
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  Number: LONG
.head 6 -  Number: INT
.head 4 +  Function: llstr2str
.head 5 -  Description: преобразование строки HEXtoBIN
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 6 -  Receive String: LPVOID
.head 6 -  Number: ULONG
.head 3 +  Library name: xml_loader.dll
.head 4 +  Function: getLoadDllVersionCent
.head 5 -  Description: function GetVersion: PChar; cdecl;
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  Number: INT
.head 4 +  Function: getLoadDllLibsConfig
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  Number: INT
.head 4 +  Function: getLoadDllDescription
.head 5 -  Description: function getLoadDllDescription(iDllNum : Integer): PChar; cdecl; Описание загруженной библиотеки
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  Number: INT
.head 4 +  Function: Convert
.head 5 -  Description: function Convert(iDllNum : Integer; 
               ParamsFile: PChar;  
                InputFile: PChar;  
               OutputFile: PChar;                
               ErrMessage: PChar; 
            ErrMessageLen: Integer): Integer; cdecl;
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: INT
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  Number: INT
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  ! Если при импорте таблица сущетсвует то
.head 4 -  Number: IMP_TAB_NEWTIME = 0      ! если табл. существ, создать такоеже имя + время создания
.head 4 -  Number: IMP_TAB_RECR = 1         ! если табл. существ, пересоздать ее
.head 4 -  Number: IMP_TAB_DELDAT = 2       ! если табл. существ, удалить все данные из таблицы
.head 4 -  Number: IMP_TAB_ADD = 3          ! если табл. существ, ничего не далать c таблицей , при импорте строки будут добавлены
.head 4 -  Number: IMP_TAB_IGNOREFILE = -1  ! не импортить данный файл
.head 4 -  !
.head 4 -  Number: IMP_BY_MEMORY = 0  ! импорт через память оракла (переменную а bars_dbf)
.head 4 -  Number: IMP_BY_TMPTAB = 1  ! импорт через временн. таблицу оракла (tmp_lob)
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! Импорт документов СберБанка
.head 4 -  !
.head 4 -  Number: IMPDOC_OK = 0    
.head 4 -  Number: IMPDOC_FAIL = 1  
.head 4 -  ! ! Константы типа импорта для Сбербанка
.head 4 -  Number: G_IMPSBR_LOCAL    = 1  ! Документы локальных задч (дневник)
.head 4 -  Number: G_IMPSBR_KOMMUNAL = 2  ! Документы коммунальных задч
.head 4 -  Number: G_IMPSBR_ZARPL    = 3  ! Файл зарплатного проекта
.head 4 -  Number: G_IMPSBR_INKAS    = 4  ! Файлы инкасации
.head 4 -  Number: G_IMPSBR_BARS     = 5  ! Импорт XML структуры БАРС
.head 4 -  !
.head 4 -  ! ! Константы статусов док-тов при импорте
.head 4 -  Number: DOC_ALL = -1        ! Все документы
.head 4 -  Number: DOC_IMPORTED = 0    ! Только заимпортированные 
.head 4 -  Number: DOC_VALIDATED = 1   ! Валидированные, готовы к лплате
.head 4 -  Number: DOC_PAYED = 2       ! Оплаченные
.head 4 -  Number: DOC_DELETED = 3     ! Удаленные
.head 4 -  Number: DOC_NOVALID = 4     ! Провалидированы с ошибками
.head 4 -  ! ! Опреации над импортированными документами
.head 4 -  Number: OP_DELETE = 1        ! Удаление
.head 4 -  Number: OP_VALIDATE = 2      ! Валидирование
.head 4 -  Number: OP_PAY = 3           ! Оплата
.head 4 -  ! ! Мнемонич описание поля для показа справочника в форме редактирования импортированного док-та
.head 4 -  Number: FLD_NLSA = 1 
.head 4 -  Number: FLD_NLSB = 2 
.head 4 -  Number: FLD_MFOA = 3 
.head 4 -  Number: FLD_MFOB = 4 
.head 4 -  Number: FLD_SK   = 5   
.head 4 -  Number: FLD_NONE = 6   
.head 4 -  !
.head 4 -  Number: CHOOSE_BY_REF = 10 ! Выбор значения поля для документа из справочника
.head 4 -  !
.head 4 -  !
.head 4 -  Number: MODE_EDIT = 1  
.head 4 -  Number: MODE_VIEW = 0
.head 4 -  !
.head 4 -  Number: IMP_MODE_OWN = 1    ! Открыть форму д\импортированных документов со всеми документами
.head 4 -  Number: IMP_MODE_ALLNOVAID = 0 ! Открыть форму для импортированных документов с документами всех пользователей и только те которіе ошибочніе
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 2755435821
0000: 6C0000002F000000 0000000000000000 02000004000000B7 000000E0010D0000
0020: 00FF3FC400B80000 0100FFFFE0D10000 0001FE00FF03DE00 00000204FA0000FF
0040: 0F
.enddata
.head 3 -  ! Переменные для обязательных реквизитов клиентов банка
.head 3 -  ! Number: nRnk
.head 3 -  ! Number: nCusttype
.head 3 -  ! Number: nCountry
.head 3 -  ! String: strNmk
.head 3 -  ! String: strNmkv
.head 3 -  ! String: strNmkk
.head 3 -  ! Number: nCodcagent
.head 3 -  ! Number: nPrinsider
.head 3 -  ! String: strAdr
.head 3 -  ! String: strSab
.head 3 -  ! String: sTaxf
.head 3 -  ! Number: nTaxf
.head 3 -  ! Number: nC_reg
.head 3 -  ! Number: nC_dst
.head 3 -  ! Number: nRgtax
.head 3 -  ! String: sRgtax
.head 3 -  ! Date/Time: dtDateA
.head 3 -  ! String: strAdm
.head 3 -  ! Date/Time: dtDateT
.head 3 -  ! Number: nStmt
.head 3 -  ! Date/Time: dtDateOn
.head 3 -  ! Date/Time: dtDateOff
.head 3 -  ! String: strNotes
.head 3 -  ! Number: nCrisk
.head 3 -  ! Long String: lstrNotesSec
.head 3 -  ! String: strPinCode
.head 3 -  Date/Time: dTempDate
.head 3 -  ! Переменные для дополнительных реквизитов клиентов (Юридические лица)
.head 3 -  ! String: strNmku
.head 3 -  ! String: strRuk
.head 3 -  ! String: strTelr
.head 3 -  ! String: strBuh
.head 3 -  ! String: strTelb
.head 3 -  ! String: strIse
.head 3 -  ! String: strFs
.head 3 -  ! String: strOe
.head 3 -  ! String: strSed
.head 3 -  ! String: strVed
.head 3 -  ! Переменные для дополнительных реквизитов клиентов (Физические лица)
.head 3 -  ! Number: nSex
.head 3 -  ! Number: nPassp
.head 3 -  ! String: strSer
.head 3 -  ! String: strNumDoc
.head 3 -  ! Date/Time: dtPdate
.head 3 -  ! String: strOrgan
.head 3 -  ! Date/Time: dtBday
.head 3 -  ! String: strBplace
.head 3 -  ! String: strTeld
.head 3 -  ! String: strTelw
.head 3 -  ! Переменные для дополнительных реквизитов клиентов (Банки)
.head 3 -  ! String: strMfoEx
.head 3 -  ! String: strBic
.head 3 -  ! String: strAltBic
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  Window Handle: hWnd
.head 3 -  Boolean: fLibInit
.head 3 -  String: sBINPath ! Путь к корневому каталогу BIN
.head 3 -  !
.head 2 +  Internal Functions
.head 3 +  ! Function: ClearCustomerData
.head 4 -    Description: 
.head 4 -    Returns 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 -    Local variables 
.head 4 +    Actions 
.head 5 -  ! Очистка переменных для обязательных реквизитов клиентов
.head 5 -    Set nRnk = 0
.head 5 -    Set strNmk = ''
.head 5 -    Set strNmkv = ''
.head 5 -    Set strNmkk = ''
.head 5 -    Set nCountry = 0
.head 5 -    Set nCodcagent = 0
.head 5 -    Set nPrinsider = 0
.head 5 -  ! Set nOkpo = 0
.head 5 -    Set strAdr = ''
.head 5 -    Set strSab = ''
.head 5 -    Set nTaxf = 0
.head 5 -    Set nC_reg = 0
.head 5 -    Set nC_dst = 0
.head 5 -  ! Set nRgtax = 0
.head 5 -    Set dtDateT = DATETIME_Null
.head 5 -    Set strAdm = ''
.head 5 -    Set dtDateA = DATETIME_Null
.head 5 -  ! Set nStmt = NUMBER_Null
.head 5 -    Set dtDateOn = DATETIME_Null
.head 5 -    Set dtDateOff = DATETIME_Null
.head 5 -    Set strNotes = ''
.head 5 -  ! Set nCrisk = NUMBER_Null
.head 5 -    Set lstrNotesSec = ''
.head 5 -  ! Очистка переменных для необязательных реквизитов клиентов Юридических лиц
.head 5 -    Set strNmku = ''
.head 5 -    Set strRuk = ''
.head 5 -    Set strTelr = ''
.head 5 -    Set strBuh = ''
.head 5 -    Set strTelb = ''
.head 5 -  ! Set strDov = ''
.head 5 -  ! Set dtBdov = DATETIME_Null
.head 5 -  ! Set dtEdov = DATETIME_Null
.head 5 -    Set strIse = ''
.head 5 -    Set strFs = ''
.head 5 -    Set strOe = ''
.head 5 -    Set strSed = ''
.head 5 -    Set strVed = ''
.head 5 -    Set sMB = ''
.head 5 -  ! Set nMfoNew = NUMNULL
.head 5 -  ! Set nNlsNew = NUMNULL
.head 5 -  ! Очистка переменных для необязательных реквизитов клиентов Физических лиц
.head 5 -    Set nSex = 0
.head 5 -    Set nPassp = 99
.head 5 -  ! Set strSer = ''
.head 5 -  ! Set strNumDoc = ''
.head 5 -  ! Set dtPdate = DATETIME_Null
.head 5 -  ! Set strOrgan = ''
.head 5 -  ! Set dtBday = DATETIME_Null
.head 5 -  ! Set strBplace = ''
.head 5 -  ! Set strTeld = ''
.head 5 -  ! Set strTelw = ''
.head 5 -  ! Очистка переменных для необязательных реквизитов клиентов Банков
.head 5 -    Set strMfoEx = ''
.head 5 -    Set strBic = ''
.head 5 -    Set strAltBic = ''
.head 3 +  Function: InitImpExp
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fLibInit
.head 6 -  ! Формировать квитанцию D?
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  !
.head 6 -  ! Инициализация LNG-файла
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\impexp.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_Docs','Документ')
.head 7 -  ! ====================================================
.head 7 -  ! frm_ImpDoc
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.menuDocs.cTMenuDoc','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.cTabs0','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.cTabs1','Доп.реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.cTabs2','БИСы')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.bgGeneral','Основные')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.bgSEP','Система электронных платежей')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tValueDateTitle','Дата валютирования:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tDebetTitle','ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tSenderTitle','Отправитель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tSenderOKPOTitle','Код ОКПО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tAccATitle','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tCcyATitle','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tBankATitle','Банк отправителя:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tMfoATitle','МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tSummATitle','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tKreditTitle','КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tReceiverTitle','Получатель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tReceiverOKPOTitle','Код ОКПО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tAccBTitle','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tCcyBTitle','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tBankBTitle','Банк получателя:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tMfoBTitle','МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tSummBTitle','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tDetailsTitle','Назначение платежа:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tPostedTitle','Дата ввода:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tReceivedTitle','Получен в файле:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.tSendedTitle','Отправлен:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tBaseCcy','грн')
.head 7 -  Call CurrentLangTable.AddAtom('tBaseCcyUnit','коп.')
.head 7 -  Call CurrentLangTable.AddAtom('tSummByChar','Сумма прописью: ')
.head 7 -  Call CurrentLangTable.AddAtom('tTimeFrom','от')
.head 7 -  Call CurrentLangTable.AddAtom('tYear','г.')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewCheck.tDocNumber','Документ №')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewCheck.tDocDate','От')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tDocNumber','Документ №')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tDocDate','От')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tSVobDk2','ІНФОРМАЦІЙНИЙ ЗАПИТ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tSVobDk3','ІНФОРМАЦІЙНЕ ПОВІДОМЛЕННЯ')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.cBTipPrint','Распечатать документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ImpDoc.cBTipExit', 'Закрыть документ')
.head 7 -  ! ====================================================
.head 6 -  !
.head 6 -  Call DocWisInit('frm_ImpDoc')
.head 6 -  Call DocWisInit('frm_ImpXML')
.head 6 -  Set bStaticsAsWindows = TRUE
.head 6 -  Set fLibInit = TRUE
.head 5 -  Return fLibInit
.head 3 +  Function: ShowImportData			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalModalDialog(dlg_ImportData, hWndForm)
.head 3 +  Function: ImportDataSkarb			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportSkarb, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataFSkarb5			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportFSkarb5, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataFSkarb6			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportFSkarb6, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataFHitc			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportFHitc, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataAsvo63			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportAsvo63, hWndForm)
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  !
.head 5 -  Return SalModalDialog(dlg_ImportAsvo63, hWndForm)
.head 3 +  Function: ImportDataAsvo65			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportAsvo65, hWndForm)
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Return SalModalDialog(dlg_ImportAsvo65, hWndForm)
.head 3 +  Function: ImportDataUnicorn			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportUnicorn, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataFUnicorn			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportFUnicorn, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataMegabank			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportMegabank, hWndForm)
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Return SalModalDialog(dlg_ImportMegabank, hWndForm)
.head 3 +  Function: ImportDataImmobile			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportImmobile, hWndForm)
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Return SalModalDialog(dlg_ImportImmobile, hWndForm)
.head 3 +  Function: ImportDataSBON			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportSBON, hWndForm)
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Return SalModalDialog(dlg_ImportSBON, hWndForm)
.head 3 +  Function: ImportDataDeltabank			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  ! Return SalModalDialog(dlg_ImportDeltabank, hWndForm)
.head 6 -  Return FALSE
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Call MessageNoWait('Функция не может быть выполнена !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataMMF				! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  ! Return SalModalDialog(dlg_ImportMMF, hWndForm)
.head 6 -  Return FALSE
.head 5 +  ! Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 5 -  Call MessageNoWait('Функция не может быть выполнена !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataNadra			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportNadra, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ImportDataFNadra			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrUpperX(SqlUser) = 'BARS'
.head 6 -  Return SalModalDialog(dlg_ImportFNadra, hWndForm)
.head 5 +  Else
.head 6 -  Call MessageNoWait('Функция может быть выполнена ТОЛЬКО пользователем BARS !', 'ВНИМАНИЕ !', 7, 1)
.head 3 +  Function: ShowExportData			! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return TRUE
.head 5 -  ! Return SalModalDialog(dlg_ExportData, hWndForm)
.head 3 +  Function: ImpOper				! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 5 -  Number: nOper
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nOper = 0       ! OPER
.head 6 -  Call SalModalDialog(dlg_ImpOper, hW, 5)
.head 5 +  Else If nOper = 1  ! OPERV
.head 6 -  Call SalModalDialog(dlg_ImpOperV, hW, 5)
.head 5 +  Else If nOper = 2  ! OPERNB
.head 6 -  Call SalModalDialog(dlg_ImpOperNB, hW, 5)
.head 5 -  !
.head 5 +  Else If nOper =100 or nOper = 101 or nOper = 102 ! OPER, OPERV, OPERNB с эквивалентами
.head 6 -  Call ImpOper7(hW, nOper-100)
.head 5 -  !
.head 5 +  Else If nOper = 10 ! OPER (sos=0)
.head 6 -  Call SalModalDialog(dlg_ImpOper, hW, 0)
.head 5 +  Else If nOper = 11 ! OPERV (sos=0)
.head 6 -  Call SalModalDialog(dlg_ImpOperV, hW, 0)
.head 5 +  Else If nOper = 12 ! OPERNB (sos=0)
.head 6 -  Call SalModalDialog(dlg_ImpOperNB, hW, 0)
.head 5 +  Else If nOper = 13 ! SPR_MOD Імпорт довідника монет з Paradox
.head 6 -  Call SalModalDialog(dlg_ImpSprMon, hW)
.head 5 +  Else If nOper = 3  ! KART_
.head 6 -  Call SalModalDialog(dlg_ImpK2_, hWndNULL)
.head 5 +  Else If nOper = 4 or nOper = 7 or nOper = 6 or nOper >100 !!!! NOKK
.head 6 -  Call NOKK(hWndMDI, nOper)
.head 6 -  Return TRUE
.head 5 +  Else If nOper = 5  ! KL_NBU
.head 6 -  Call SalMessageBox('Данная функция устарела, используйте новый вызов: <ShowQueryEditor(hWndMDI,1)> '||
                   ' для редактирования синхронизируемых таблиц и <ShowQueryEditor(hWndMDI,4)> для синхронизации справочников ',
                   'Внимание!',  MB_Ok)
.head 6 -  ! Call SalCreateWindow(KL, hWndMDI, nOper)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: ShowUpdateBanks			! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_UpdateBanks, hWndForm)
.head 3 +  Function: ModyTok				! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_ModyTok, hWndNULL, 0)
.head 3 +  Function: ModyTokWithCopy			! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_ModyTok, hWndNULL, 1)
.head 3 +  Function: Perenos
.head 4 -  Description: Разбиение назначения платежа
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTxt	! текст
.head 5 -  Number: nLen	! длина
.head 5 -  Number: nSpaces ! количество пробелов слева
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNana[*]
.head 5 -  Number: nL
.head 5 -  String: sI
.head 5 -  Number: nJ
.head 5 -  Number: nC
.head 5 -  String: sRes
.head 4 +  Actions
.head 5 -  Set nL = 0
.head 5 -  Set sI = SalStrTrimX(sTxt)
.head 5 +  Loop
.head 6 +  If Len(sI) = 0
.head 7 -  Break
.head 6 +  If Len(sI) < nLen+1
.head 7 -  Set sNana[nL] = sI
.head 7 -  Break
.head 6 -  Set nJ = nLen + 1
.head 6 -  Set sNana[nL] = Left(sI, nJ)
.head 6 +  While nJ > 0
.head 7 +  If Subs(sNana[nL], nJ, 1) = ' ' or
   Subs(sNana[nL], nJ, 1) = ',' or
   Subs(sNana[nL], nJ, 1) = '.' or
   Subs(sNana[nL], nJ, 1) = ';' or
   Subs(sNana[nL], nJ, 1) = ':' or
   Subs(sNana[nL], nJ, 1) = '-'
.head 8 -  Set sNana[nL] = SalStrTrimX(Left(sNana[nL], nJ))
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nJ+1, Len(sI)-nJ))
.head 8 -  Break
.head 7 -  Set nJ = nJ - 1
.head 7 +  If nJ = 0
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nLen+1, Len(sI)-nLen))
.head 6 -  Set nL = nL + 1
.head 5 -  Set nC = 0
.head 5 -  Set sRes = ''
.head 5 +  While nC <= nL
.head 6 -  Set sRes = sRes || Spac(nSpaces) || sNana[nC] || PutCrLf()
.head 6 -  Set nC = nC + 1
.head 5 -  Return sRes
.head 3 +  Function: PrestartTOKUpdate			! __exported
.head 4 -  Description: модификация TOK НБУ на старте дня
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_UpdateTok, hWndNULL)
.head 3 +  Function: GetRENEWMsg
.head 4 -  Description: возвращает строку описания ошибки RENEW
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strMsg
.head 4 +  Actions
.head 5 +  Select Case (Abs(nCode))
.head 6 +  Case 0
.head 7 -  Set strMsg = 'Ok'
.head 7 -  Break
.head 6 +  Case 1
.head 7 -  Set strMsg = 'Файл сертификата поврежден'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set strMsg = 'Отсутствует выделенный каталог по указанному вторым аргументом пути'
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set strMsg = 'Банковская дата недопустима (раньше начала 1980 г.)'
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set strMsg = 'Недостаточно памяти'
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set strMsg = 'Ошибка открытия файла протокола: "protocol.rsa"'
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set strMsg = 'Потерян старый файл протокола (*.bak) при создании нового'
.head 7 -  Break
.head 6 +  Case 7
.head 7 -  Set strMsg = 'Ошибка открытия файла сообщений "report.pub"'
.head 7 -  Break
.head 6 +  Case 8
.head 7 -  Set strMsg = 'Отсутствует файл "pub_odb.ind" в выделенном каталоге'
.head 7 -  Break
.head 6 +  Case 9
.head 7 -  Set strMsg = 'Отсутствует файл "pub_odb.key" в выделенном каталоге'
.head 7 -  Break
.head 6 +  Case 10
.head 7 -  Set strMsg = 'Размер индексного файла превышает 64К'
.head 7 -  Break
.head 6 +  Case 12
.head 7 -  Set strMsg = 'Ошибка открытия очередного файла сертификатов открытых ключей'
.head 7 -  Break
.head 6 +  Case 13
.head 7 -  Set strMsg = 'Ошибка чтения файла сертификатов'
.head 7 -  Break
.head 6 +  Case 14
.head 7 -  Set strMsg = 'Ошибка открытия индексного файла "pub_odb.ind"'
.head 7 -  Break
.head 6 +  Case 15
.head 7 -  Set strMsg = 'Недостаточно памяти для хранения таблицы индексов'
.head 7 -  Break
.head 6 +  Case 16
.head 7 -  Set strMsg = 'Ошибка чтения файла "pub_odb.ind"'
.head 7 -  Break
.head 6 +  Case 17
.head 7 -  Set strMsg = 'Файл "pub_odb.ind" поврежден'
.head 7 -  Break
.head 6 +  Case 18
.head 7 -  Set strMsg = 'Испорчен заголовок индексного файла "pub_odb.ind"'
.head 7 -  Break
.head 6 +  Case 19
.head 7 -  Set strMsg = 'Ошибка открытия файла "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 20
.head 7 -  Set strMsg = 'Недостаточно памяти для буфера таблицы "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 21
.head 7 -  Set strMsg = 'Ошибка чтения файла "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 22
.head 7 -  Set strMsg = 'Файл "pub_odb.key" поврежден'
.head 7 -  Break
.head 6 +  Case 23
.head 7 -  Set strMsg = 'Ошибка чтения файла "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 24
.head 7 -  Set strMsg = 'Испорчен файл сертификатов открытых ключей'
.head 7 -  Break
.head 6 +  Case 25
.head 7 -  Set strMsg = 'Испорчен открытый ключ в файле сертификатов'
.head 7 -  Break
.head 6 +  Case 26
.head 7 -  Set strMsg = 'Переименован файл сертификатов открытых ключей'
.head 7 -  Break
.head 6 +  Case 27
.head 7 -  Set strMsg = 'Дата ввода ключа в действие еще не наступила'
.head 7 -  Break
.head 6 +  Case 28
.head 7 -  Set strMsg = 'Файл сертификата неверно создан'
.head 7 -  Break
.head 6 +  Case 29
.head 7 -  Set strMsg = 'Ошибка чтения  файла "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 30
.head 7 -  Set strMsg = 'Ошибка записи в файл "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 31
.head 7 -  Set strMsg = 'Ошибка закрытия файла "pub_odb.key" или "pub_odb.ind"'
.head 7 -  Break
.head 6 +  Case 32
.head 7 -  Set strMsg = 'Ошибка записи в файл "pub_odb.ind"'
.head 7 -  Break
.head 6 +  Case 33
.head 7 -  Set strMsg = 'Ключ, подлежащий операции удаления, отсутствует в таблице'
.head 7 -  Break
.head 6 +  Case 34
.head 7 -  Set strMsg = 'Испорчен индексный файл pub_odb.ind (или "pub_odb.key")'
.head 7 -  Break
.head 6 +  Case 35
.head 7 -  Set strMsg = 'Испорчена строка в таблице открытых ключей'
.head 7 -  Break
.head 6 +  Case 36
.head 7 -  Set strMsg = 'Ошибка удаления файла сертификатов после обработки'
.head 7 -  Break
.head 6 +  Case 40
.head 7 -  Set strMsg = 'Ошибка записи в файл резервной копии таблиц'
.head 7 -  Break
.head 6 +  Case 41
.head 7 -  Set strMsg = 'Отсутствует указанный файл резервной копии для восстановления таблиц'
.head 7 -  Break
.head 6 +  Case 42
.head 7 -  Set strMsg = 'Ошибка чтения файла резервной копии таблиц'
.head 7 -  Break
.head 6 +  Case 43
.head 7 -  Set strMsg = 'Файл резервной копии таблиц поврежден'
.head 7 -  Break
.head 6 +  Case 47
.head 7 -  Set strMsg = 'Несоответствие файлов "pub_odb.ind" и "pub_odb.key"'
.head 7 -  Break
.head 6 +  Case 71
.head 7 -  Set strMsg = 'Были ошибки по ходу при вставке ключей - см. файл "report.pub"'
.head 7 -  Break
.head 6 +  Case 72
.head 7 -  Set strMsg = 'Отсутствуют файлы сертификатов открытых ключей'
.head 7 -  Break
.head 6 +  Case 91
.head 7 -  Set strMsg = 'Недопустимый первый аргумент'
.head 7 -  Break
.head 6 +  Case 93
.head 7 -  Set strMsg = 'Несоответствие третьего аргумента с первым при вызове функции'
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set strMsg = ''
.head 7 -  Break
.head 5 -  Return strMsg
.head 3 +  Function: PrestartVegaTOKUpdate			! __exported
.head 4 -  Description: модификация TOK НБУ на старте дня
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_UpdateVegaTok, hWndNULL)
.head 3 -  !
.head 3 -  ! deleted by anny (moved to GeneralImpExp)
.head 3 +  Function: GeneralImport				! __exported
.head 4 -  Description: Импорт файлов общий
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nMode = 1
.head 6 -  !
.head 6 -  If nPar = -1
.head 6 +  Else If nPar = 110  ! импорт dbf через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFImport, hWndParent)
.head 6 +  Else If nPar = 111  ! импорт всех dbf в указанном каталоге через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFImportDir, hWndParent)
.head 6 -  !
.head 6 -  ! Экспорт (101..)
.head 6 +  Else If nPar = 210 ! экспорт dbf через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFExport, hWndParent)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Функция устарела, функциональность перенесена в функцию GeneralImpExp',
      'Внимание!', MB_Ok)
.head 5 +  Else If nMode = 2  ! Импорт файлов Сбербанка 
.head 6 +  If nPar = 1
.head 7 -  Call SalMessageBox('Дана функція вже не підтримується (застаріла)', 'Увага', MB_Ok)
.head 6 +  Else If nPar = 2
.head 7 -  Call SalMessageBox('Дана функція вже не підтримується (застаріла)', 'Увага', MB_Ok)
.head 5 +  Else
.head 6 -  Call SalMessageBox('Функция устарела, функциональность перенесена в функцию GeneralImpExp',
      'Внимание!', MB_Ok)
.head 5 -  ! !
.head 3 +  Function: GeneralImpExp				! __exported
.head 4 -  Description: глобальная функа импорта экспорта. Импорт nPar=0..100,  экспорт nPar= 101...
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nImportType
.head 5 -  Number: nNumTokens
.head 5 -  String: tokenArray[6]
.head 5 -  String: sErrMsg
.head 5 -  ! для nMode=3
.head 5 -  String: strFilters[2]
.head 5 -  Number: nIndex
.head 5 -  String: sFileName
.head 5 -  String: sFilePath
.head 5 -  String: sFilePathArc
.head 5 -  String: sSqlProc
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call SalFileGetCurrentDirectory(sBINPath)
.head 5 -  !
.head 5 -  Call InitImpExp() 
.head 5 -  !
.head 5 -  If nMode = -1      
.head 5 +  Else If nMode = 0 ! Разный импорт экспорт
.head 6 -  ! Импорт (0..100)
.head 6 -  If nPar = -1      
.head 6 +  Else If nPar = 0   ! импорт бинарных файлов
.head 7 -  ! 
Window Handle: hWndParent - hWndMDI
Number: nMode     - всегда 0
Number: nPar        - 0 - импорт бинарных файлов, 1 - текстовых
String: strPar01     - начальная директория импорта
String: strPar02     - процедура для обработки файла
.head 7 -  Call SalModalDialog(dlg_GeneralImport, hWndParent, nPar, strPar01, strPar02)
.head 6 +  Else If nPar = 1   ! импорт текстовых файлов
.head 7 -  ! 
Window Handle: hWndParent - hWndMDI
Number: nMode     - всегда 0
Number: nPar        - 0 - импорт бинарных файлов, 1 - текстовых
String: strPar01     - начальная директория импорта
String: strPar02     - процедура для обработки файла
.head 7 -  Call SalModalDialog(dlg_GeneralImport, hWndParent, nPar, strPar01, strPar02)
.head 6 +  Else If nPar = 10  ! импорт dbf через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFImport, hWndParent)
.head 6 +  Else If nPar = 11  ! импорт всех dbf в указанном каталоге через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFImportDir, hWndParent)
.head 6 -  !
.head 6 -  ! Экспорт (101..)
.head 6 +  Else If nPar = 110 ! экспорт dbf через bars_dbf
.head 7 -  Call SalModalDialog(dlg_DBFExport, hWndParent)
.head 6 -  !
.head 5 +  Else If nMode = 2 ! Импорт файлов Сбербанка (anny)
.head 6 -  If nPar = -1      
.head 6 +  Else If nPar = 0   ! разбор импортированных документов
.head 7 +  If not IsWindow(hWnd)
.head 8 -  Set hWnd =  SalCreateWindow(frm_ImpXML, hWndParent, IMP_MODE_OWN)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_ImpXML)
.head 6 +  Else If nPar = 1   ! импорт файлов
.head 7 -  Set nImportType = SalStrToNumber(strPar01)
.head 7 -  ! !!CB!! 222
! ! Константы типа импорта для Сбербанка
Number: G_IMPSBR_LOCAL    = 1  ! Документы локальных задч (дневник, АСВО) $B
Number: G_IMPSBR_KOMMUNAL = 2  ! Файл коммунальных задч ($A)
Number: G_IMPSBR_ZARPL    = 3  ! Файл зарплатного проекта
Number: G_IMPSBR_INKAS    = 4  ! Файли інкасації
Number: G_IMPSBR_BARS     = 5  ! Импорт XML структуры БАРС

!strPar02 - имя файла паремтетров, перекрывающих настройки по-умолчанию
.head 7 -  Call SalModalDialog(dlg_ImpXmlFile, hWndParent, nImportType, strPar02) ! Импорт файлов локальных задач (дневник)
.head 6 +  ! Else If nPar = 2   ! импорт файла из коммунала
.head 7 -  Call SalModalDialog(dlg_ImpXmlFile, hWndParent, G_IMPSBR_KOMMUNAL) ! Импорт файлов коммунала
.head 6 +  Else If nPar = 3   ! Редактирование блокированных от всех пользователей
.head 7 +  If not IsWindow(hWnd)
.head 8 -  Set hWnd =  SalCreateWindow(frm_ImpXML, hWndParent, IMP_MODE_ALLNOVAID)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_ImpXML)
.head 6 +  Else If nPar = 4   ! Вызов функции импорта DBF через память ImportUseMomory
.head 7 -  ! в параметр strPar01 - вноситься через запятую такие парарметры:  
!!
String: sFilePath        ! путь к файлу dbf (без имени файла)
String: sFileName        ! имя файла dbf
String: sTableName       ! имя таблицы для импорта
String: sEncode          ! кодировка DBF файла
Number: nForceMode       ! =0-пересоздать таблицу,
		           =1-создать новую с хвостом времени,
		           =2-не создавать
Number: nForceMemo       ! =0-если не нашли соотв.файл с мемо-выдать ошибку,
		           =1 если соответсв.файл не найден делать вставку пустого значения в колонку с мемо		                              полем.

.head 7 -  Set nNumTokens = SalStrTokenize(strPar01, '', ',', tokenArray)
.head 7 -  ! Call Debug(tokenArray[0] ||'-'|| tokenArray[1] ||'-'||tokenArray[2]||'-'||tokenArray[3]||'-'||tokenArray[4]||'-'||tokenArray[5])
.head 7 -  Call ImportUseMomory(tokenArray[0],
                     tokenArray[1],
                     tokenArray[2],
                     tokenArray[3],
                     SalStrToNumber(tokenArray[4]),
                     SalStrToNumber(tokenArray[5]),
                     sErrMsg) 
.head 7 +  If SalStrLength(sErrMsg) > 0 
.head 8 -  Call SalMessageBox(sErrMsg,'Увага!',MB_IconAsterisk|MB_Ok)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Імпорт виконано успішно','', MB_Ok)
.head 5 +  Else If nMode = 3 ! Импорт/экспорт xml
.head 6 -  Set sSqlProc = strPar01
.head 6 -  ! импорт в clob/blob
.head 6 +  If nPar = 1 or nPar = 3
.head 7 +  While TRUE
.head 8 -  ! Выбор файла для импорта
.head 8 +  If not SalDlgOpenFile(hWndParent, 'Open File', strFilters, 2, nIndex, sFileName, sFilePath)
.head 9 -  Break
.head 8 -  Call SaveInfoToLog("Імпорт файлу " || sFileName)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  ! Импорт файла во временную таблицу
.head 8 +  If nPar = 1
.head 9 +  If not PutFileToClob(hSql(), sFilePath, 'imp_file', 'file_name', 'file_clob', NUMBER_Null, sFileName, STRING_Null, 1)
.head 10 -  Break
.head 8 +  Else
.head 9 +  If not PutFileToBlob(hSql(), sFilePath, 'imp_file', 'file_name', 'file_blob', NUMBER_Null, sFileName, STRING_Null, 1)
.head 10 -  Break
.head 8 -  ! Обработка файла
.head 8 -  ! процедура импорта sSqlProc должна содержать параметр sFileName (имя файла), напр. bars_sv.import_tick(sFileName), bars_sv.import_file(sFileName, 1)
.head 8 +  If not SqlPLSQLCommand(hSql(), sSqlProc)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SaveInfoToLog("Помилка обробки файлу " || sFileName)
.head 9 -  Call SalMessageBox("Помилка обробки файлу " || sFileName, "Інформація", MB_IconExclamation | MB_Ok)
.head 8 +  Else
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveInfoToLog("Імпортовано файл " || sFileName)
.head 9 -  Call SalMessageBox("Імпортовано файл " || sFileName, "Інформація", MB_IconAsterisk | MB_Ok)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "delete from imp_file where file_name = :sFileName")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Break
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 -  ! экспорт
.head 6 +  Else If nPar = 2
.head 7 +  While TRUE
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  ! формируем данные для файла
.head 8 -  ! процедура экспорта sSqlProc должна содержать параметр sFileName (имя файла), напр. bars_sv.form_p7(sFileName)
.head 8 +  If not SqlPLSQLCommand(hSql(), sSqlProc)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Break
.head 8 -  Call SqlCommit(hSql())
.head 8 +  If not sFileName
.head 9 -  Break
.head 8 +  If not PutClobToFile(hSql(), sFileName, 'IMP_FILE', 'FILE_NAME', 'FILE_CLOB', NUMBER_Null, sFileName, STRING_Null)
.head 9 -  Call SalMessageBox('Помилка формування файлу', 'Помилка', MB_IconStop | MB_Ok)
.head 8 +  Else
.head 9 -  Call SaveInfoToLog("Сформовано файл " || sFileName)
.head 9 -  Call SalMessageBox("Сформовано файл " || sFileName, "Інформація", MB_IconAsterisk | MB_Ok)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "delete from imp_file where file_name = :sFileName")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Break
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Некорректный вызов функции', 'Внимание!', MB_Ok)
.head 5 +  Else If nMode = 4 ! Импорт Инсайдеров
.head 6 +  If nPar = 1 !Вспливающе окно
.head 7 -  Set strFilters[0] = '*.dbf'
.head 7 -  Set strFilters[1] = '*.dbf'
.head 7 +  If SalDlgOpenFile(hWndParent, 'Import File', strFilters, 2, nIndex, sFileName, sFilePath)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set sFilePath = SalStrMidX(sFilePath, 0, SalStrLength(sFilePath)-SalStrLength(sFileName)-1 )
.head 8 -  Call ImportPrInsider(sFileName, sFilePath)
.head 6 +  Else If nPar=2 !З іні файла
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'NadraPrinsPath', '', sFilePath, GetIniFileName())
.head 7 -  Set sFilePath = IifS(Right(sFilePath, 1)='\\', Left(sFilePath, Len(sFilePath)-1), sFilePath) 
.head 7 -  Set sFileName = 'IMPPRINS'||SalFmtFormatDateTime(GetBankDate(), 'yyyyMMdd')||'.DBF'
.head 7 -  Call ImportPrInsider(sFileName, sFilePath)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Некорректный вызов функции', 'Внимание!', MB_Ok)
.head 5 +  Else
.head 6 -  Call SalMessageBox('Некорректный вызов функции', 'Внимание!', MB_Ok)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: LoadDBFfile
.head 4 -  Description: Загрузить файл в переменную пакета bars_dbf
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! SQL соединение
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Имя файла загружаемого в БД
.head 5 -  String: strFileName
.head 5 -  ! Тип файла (DBF - тело дбф, 
!            DBT - мемо для FoxBase, 
!            FPT - мемо для FoxPro, 
!            *   - существует мемо, но невозможно выяснить версию)
.head 5 -  String: strFileType  
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Файл
.head 5 -  File Handle: hFile
.head 5 -  ! Ошибка при открытии файла
.head 5 -  Number: nErrCode
.head 5 -  ! Буфер чтения файла
.head 5 -  Long String: sBuffer
.head 5 -  ! Максимальный размер буфера (3999)
.head 5 -  Number: nBufferSize
.head 5 -  ! Количество прочитанных байт
.head 5 -  Number: nBytesRead
.head 4 +  Actions
.head 5 -  ! Это максимальный теоритический предел для вставки в БД
.head 5 -  Set nBufferSize = 3999
.head 5 -  ! Здесь мы удаляем даные из временной таблицы
.head 5 -  ! Открываем файл для чтения
.head 5 -  Set nErrCode = VisFileOpen(hFile, strFileName, OF_Binary | OF_Read)
.head 5 +  If nErrCode
.head 6 -  Set sErrMsg =  'Не удалось открыть файл ' || strFileName
.head 6 -  Return FALSE
.head 5 -  ! В цикле по частям вычитываем файл и складываем его во временую таблицу БД
.head 5 +  Loop
.head 6 +  If SalStrSetBufferLength(sBuffer, nBufferSize+1)
.head 7 -  Set nBytesRead = VisFileRead(hFile, sBuffer, nBufferSize)
.head 7 -  Call SalStrSetBufferLength(sBuffer, nBufferSize+1)
.head 7 +  If nBytesRead
.head 8 +  If not SqlPLSQLCommand(hSql(),"bars_dbf.set_buffer(sBuffer,strFileType,nBytesRead)")
.head 9 -  Call SqlRollback(hSqlHandle)
.head 9 -  Set sErrMsg =  'Ошибка вычитки файла в буффер. Размер буффера - '||SalNumberToStrX(nBytesRead,0) 
.head 9 -  Return FALSE
.head 8 +  If nBytesRead < nBufferSize
.head 9 -  Break
.head 7 +  Else
.head 8 -  Break
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  ! Закрываем файл
.head 5 -  Call VisFileClose(hFile)
.head 5 -  ! Сохраняем изменения
.head 5 -  Call SqlCommit(hSqlHandle)
.head 5 -  Return TRUE
.head 3 +  Function: DownloadDBFfile
.head 4 -  Description: Выгрузить в файл значение переменной пакета bars_dbf, которая содержит текст DBF файла
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! SQL соединение
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Имя файла загружаемого в БД
.head 5 -  String: strFileName
.head 5 -  ! Дозаписать файл или создать новый (OF_Create  или OF_Append)
.head 5 -  Number: nFileOpenMode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Файл
.head 5 -  File Handle: hFile
.head 5 -  ! Ошибка при открытии файла
.head 5 -  Number: nErrCode
.head 5 -  ! Буфер чтения файла
.head 5 -  Long String: sBuffer
.head 5 -  ! Максимальный размер буфера
.head 5 -  Number: nBufferSize
.head 5 -  ! Начало чтения буфера
.head 5 -  Number: nOffset
.head 5 -  ! Количество байт в LOBе
.head 5 -  Number: nLobSize
.head 5 -  ! Количество байт, записанное в файл
.head 5 -  Number: nBytesWrote
.head 4 +  Actions
.head 5 -  ! Это максимальный теоритический предел
.head 5 -  Set nBufferSize = 2000
.head 5 -  Set nOffset = 1
.head 5 -  !
.head 5 -  !
.head 5 -  Set nErrCode = VisFileOpen(hFile, strFileName, OF_Binary | nFileOpenMode)
.head 5 +  If (nFileOpenMode = OF_Append and nErrCode = -2) ! файла еще нету - создать
.head 6 -  Set nErrCode = VisFileOpen(hFile, strFileName, OF_Binary | OF_Create)
.head 5 +  If nErrCode
.head 6 -  Call SalMessageBox('Ошибка открытия файла: '||SalNumberToStrX(nErrCode,0), '', MB_Ok | MB_IconAsterisk)
.head 6 -  Call SqlRollback(hSqlHandle)
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! В цикле по частям вычитываем файл 
.head 6 +  Loop
.head 7 +  If SalStrSetBufferLength(sBuffer, nBufferSize+1)
.head 8 +  If SqlPLSQLCommand(hSqlHandle, "bars_dbf.get_buffer(sBuffer, nLobSize, nOffset, nBufferSize)")
.head 9 +  If nLobSize = 0
.head 10 -  Break
.head 9 -  ! Call Debug('Кусок размером в '||SalNumberToStrX(nLobSize,0))
.head 9 -  Set nBytesWrote = VisFileWrite(hFile, sBuffer, nLobSize)
.head 8 +  Else
.head 9 -  Call SalMessageBox('Невозможно выполнить процедуру bars_dbf.get_buffer', '', MB_Ok | MB_IconAsterisk)
.head 9 -  Call SqlRollback(hSqlHandle)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SalMessageBox('Невозможно установить размер буффера', '', MB_Ok | MB_IconAsterisk)
.head 8 -  Call SqlRollback(hSqlHandle)
.head 8 -  Return FALSE
.head 7 -  Set nOffset = nOffset + nBufferSize
.head 5 -  ! Закрываем файл
.head 5 -  Call VisFileClose(hFile)
.head 5 -  Return TRUE
.head 3 +  Function: IsTableExists
.head 4 -  Description: Проверяет наличие таблицы в БД. Возвращает 
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTableName            !  имя таблицы для проверки
.head 5 -  Receive Number: nTableExists  !  ответ:  0- табл.не существ.,  1-существует 
.head 5 -  Receive String: sErrMsg       !  тектс ошибки выполнения процедуры 
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_ies.tab_exists(sTableName, nTableExists)")
.head 6 -  Set sErrMsg = 'Ошибка проверки наличия данной таблицы в БД (схема БАРС)' 
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: GetTimeInterval
.head 4 -  Description: Отдает разницу двух дат во времени
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dtDatFrom
.head 5 -  Date/Time: dtDatTo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFromSeconds
.head 5 -  Number: nToSeconds
.head 4 +  Actions
.head 5 -  Set nFromSeconds = SalDateHour(dtDatFrom)*60*60 + SalDateMinute(dtDatFrom)*60 + SalDateSecond(dtDatFrom)
.head 5 -  Set nToSeconds = SalDateHour(dtDatTo)*60*60 + SalDateMinute(dtDatTo)*60 + SalDateSecond(dtDatTo)
.head 5 -  ! Call Debug('Разница: '||SalNumberToStrX(nToSeconds - nFromSeconds,0))
.head 5 -  Return GetFormatedSeconds(nToSeconds - nFromSeconds)
.head 3 +  Function: GetFormatedSeconds
.head 4 -  Description: Представить значение в секундах в тесктовое значение hh:mm:ss
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nPeriodSeconds
.head 4 +  Static Variables
.head 5 -  Number: nHours
.head 5 -  Number: nMinutes
.head 5 -  Number: nSeconds
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nMinutes = 0
.head 5 -  Set nHours = 0
.head 5 -  Set nSeconds = 0
.head 5 -  ! Call Debug('Осталось секунд : '||SalNumberToStrX(nPeriodSeconds,0))
.head 5 -  Set nHours = SalNumberTruncate(nPeriodSeconds/(60*60),10,0)
.head 5 -  ! Call Debug('Чистых часов:'||SalNumberToStrX(nHours,0))
.head 5 -  Set nPeriodSeconds = nPeriodSeconds - nHours *(60*60)
.head 5 -  ! Call Debug('Осталось секунд :'||SalNumberToStrX(nPeriodSeconds,0))
.head 5 -  !
.head 5 -  Set nMinutes = SalNumberTruncate(nPeriodSeconds/60,10,0)
.head 5 -  ! Call Debug('Чистых минут:'||SalNumberToStrX(nMinutes,0))
.head 5 -  Set nPeriodSeconds = nPeriodSeconds - nMinutes * 60
.head 5 -  Set nSeconds = nPeriodSeconds
.head 5 -  Return 
   IifS(nHours>=10, '', '0')||SalNumberToStrX(nHours,0)||':'||
   IifS(nMinutes>=10, '', '0')||SalNumberToStrX(nMinutes,0)||':'||
   IifS(nSeconds>=10, '', '0')||SalNumberToStrX(nSeconds,0)  
.head 3 -  !
.head 3 -  !
.head 3 +  Function: GetDBFDescription
.head 4 -  Description: Получить по DBF файлу его описание (структура, его тип, использует ли или нет мемо поле)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFilePath                ! путь к файлу dbf
.head 5 -  String: sFileName                ! имя файла dbf
.head 5 -  Receive Number: nIsMemoExists    ! есть ли МЕМО
.head 5 -  Receive String: sDBFMemoExt      ! расширение для МЕМО файла
.head 5 -  Receive Number: nDBFVersion      ! номер DBF версии
.head 5 -  Receive String: sDBFVersionDesc  ! описание DBF версии
.head 5 -  Receive String: sErrMsg          ! Ошибка выполнения ф-ции
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFilePathName
.head 4 +  Actions
.head 5 -  Set sFilePathName = sFilePath||'\\'||sFileName
.head 5 +  If not LoadDBFfile(hSql(), sFilePathName, 'DBF', sErrMsg)
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! Существует ли мемо поле
.head 6 +  If not SqlPLSQLCommand(hSql(),
    "bars_dbf.get_dbf_description_cnt(
                    nDBFVersion,
                    sDBFVersionDesc,
                    nIsMemoExists,
                    sDBFMemoExt)")
.head 7 -  Set sErrMsg = 'Ошибка проверки на наличия МЕМО поля' 
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 3 +  Function: ImportUseMomory
.head 4 -  Description: Импорт через память (переменная в bars_dbf)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFilePath        ! путь к файлу dbf
.head 5 -  String: sFileName        ! имя файла dbf
.head 5 -  String: sTableName       ! имя таблицы для импорта
.head 5 -  String: sEncode          ! кодировка DBF файла
.head 5 -  Number: nForceMode       ! =0-пересоздать таблицу,
                           =1-создать новую с хвостом времени,
                           =2-не создавать
.head 5 -  Number: nForceMemo       ! =0-если не нашли соотв.файл с мемо-выдать ошибку,
                           =1 если соответсв.файл не найден делать вставку пустого значения в колонку с мемо
                              полем.
.head 5 -  Receive String: sErrMsg  ! текст ошибки обработки
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFilePathName
.head 5 -  String: sTmp
.head 5 -  Number: nIsMemoExists
.head 5 -  Number: nDBFVersion
.head 5 -  String: sDBFVersionDesc
.head 5 -  String: sDBFMemoExt      ! расширение для поля мемо
.head 4 +  Actions
.head 5 -  ! загрузка DBF файла в переменную пакета, вытяжка информации о файле
.head 5 -  Set sFilePathName = sFilePath|| '\\' ||sFileName
.head 5 +  If not LoadDBFfile(hSql(), sFilePathName, 'DBF', sErrMsg)
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! Существует ли мемо поле
.head 6 +  If not SqlPLSQLCommand(hSql(), "
   bars_dbf.get_dbf_description_cnt(sTableName,
                                    nDBFVersion,
                                    sDBFVersionDesc,
                                    nIsMemoExists,
                                    sDBFMemoExt)")
.head 7 -  Set sErrMsg = 'Ошибка вычитки структуры DBF'
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  ! Существует мемо поле - подтянуть файл для него
.head 7 -  ! импорт DBF файла из переменной пакета
.head 7 +  If nIsMemoExists = 1
.head 8 -  !
.head 8 -  Set sFilePathName = sFilePath || '\\' || SalStrLeftX(sFileName, SalStrScan(sFileName, '.')) || '.' ||
    sDBFMemoExt
.head 8 -  !
.head 8 -  ! Проверим наличие файлов мемо соответсвующего типа
.head 8 -  Set sFilePathName =  VisFileFind(sFilePathName)
.head 8 -  !
.head 8 +  If sFilePathName != STRING_Null
.head 9 +  If not LoadDBFfile(hSql(), sFilePathName, 'MEMO', sErrMsg)
.head 10 -  Set sErrMsg = 'Неуспешная загрузка файла *.DBT для мемо поля в БД: ' ||sErrMsg
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  ! Если принудительный импорт, даже если не найден файл
.head 9 +  If nForceMemo = 1
.head 10 -  ! Все ОК. В колонки с мемо полями будет вставлено просто пустое значение
.head 9 +  Else
.head 10 -  Set sErrMsg = 'Неуспешная загрузка файла *.' || sDBFMemoExt || ' для мемо поля в БД: ' ||sErrMsg
.head 10 -  Return FALSE
.head 7 +  If not SqlPLSQLCommand(hSql(), "
   bars_dbf.import_dbf_cnt(sTableName,
                           nForceMode,
                           sEncode,
                           'WIN')")
.head 8 -  Set sErrMsg = 'Ошибка импорта DBF файла'
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SqlCommitEx(hSql(), 'Выполнен импорт данных файла ' || sFilePath || '\\' || sFileName ||
     ' в таблицу ' || sTableName)
.head 6 -  Return TRUE
.head 3 +  Function: ImportUseTmpTable
.head 4 -  Description: Импорт через временную таблицу tmp_lob
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFilePath          ! имя файла dbf
.head 5 -  String: sTableName         ! имя таблицы для импорта
.head 5 -  String: sEncode            ! кодировка DBF файла 
.head 5 -  Number: nForceMode         ! =0-пересоздать таблицу, =1-создать новую с хвостом времени, =2-не создавать
.head 5 -  Receive String: sErrMsg    ! текст ошибки обработки
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! загрузка DBF файла во временную таблицу tmp_lob
.head 5 +  If not PutFileToTmpLob(hSql(), sFilePath, 'B')
.head 6 -  Set sErrMsg = 'Неуспешная загрузка файла в БД'
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! импорт DBF файла из временной таблицы tmp_lob
.head 6 +  If not SqlPLSQLCommand(hSql(),"bars_ies.import_from_dbf(sTableName, sEncode)")
.head 7 -  Set sErrMsg = 'Ошибка импорта DBF файла'
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  ! Function: ImportDbfToDataBase
.head 4 -  Description: Непосредсвенный импорт в БД. 
Предполагается, что в переменных пакета bars_dbf уже находятся 
блобы импортируемого DBF и если есть его МЕМО файла
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: nIsMemoExists      ! наличие мемо поля
.head 5 -  String: sTableName         ! имя таблицы для импорта
.head 5 -  String: sEncode            ! кодировка DBF файла 
.head 5 -  Number: nForceMode         ! = переменная IMP_TAB_*
.head 5 -  Receive String: sErrMsg    ! текст ошибки обработки
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If nIsMemoExists = 1
.head 6 -  !
.head 6 -  !
.head 6 -  Set sFilePathName = sFilePath||'\\'||SalStrLeftX(sFileName, SalStrScan(sFileName,'.'))||'.'||sDBFMemoExt
.head 6 -  !
.head 6 -  ! Проверим наличие файлов мемо соответсвующего типа
.head 6 -  Set sFilePathName =  VisFileFind(sFilePathName)
.head 6 -  !
.head 6 +  If sFilePathName != STRING_Null 
.head 7 +  If not LoadDBFfile(hSql(), sFilePathName, sDBFMemoExt, sErrMsg)
.head 8 -  Set sErrMsg = 'Неуспешная загрузка файла *.DBT для мемо поля в БД: ' ||sErrMsg
.head 8 -  Return FALSE
.head 6 +  Else 
.head 7 -  ! Если принудительный импорт, даже если не найден файл
.head 7 +  If nForceMemo = 1
.head 8 -  ! Все ОК. В колонки с мемо полями будет вставлено просто пустое значение
.head 7 +  Else 
.head 8 -  Set sErrMsg = 'Неуспешная загрузка файла *.'||sDBFMemoExt||' для мемо поля в БД: ' ||sErrMsg
.head 8 -  Return FALSE
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_dbf.import_dbf_cnt(sTableName, nForceMode, sEncode, 'WIN')")
.head 6 -  Set sErrMsg = 'Ошибка импорта DBF файла' 
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SqlCommitEx(hSql(),'Выполнен импорт данных файла '||sFilePathName||' в таблицу '||sTableName)
.head 5 -  Return TRUE
.head 3 +  Function: ImportDbf				! __exported
.head 4 -  Description: Импорт DBF(автомат)
Включает в себя полный цикл без каких-либо диалогов внутри:
 1) Загрузка DBF
 2) Определение версии DBF (имеется ли мемо поле, имя файла для мемо)
 3) Непосредственный импорт в БД

.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFilePath          ! путь к файлу dbf
.head 5 -  String: sFileName          ! имя файла dbf
.head 5 -  String: sTableName         ! имя таблицы для импорта
.head 5 -  String: sEncode            ! кодировка DBF файла 
.head 5 -  Number: nForceMode         ! = переменная IMP_TAB_*
.head 5 -  Number: nForceMemo         ! =0-если не нашли соотв.файл с мемо-выдать ошибку, =1 если соответсв.файл не найден делать вставку пустого значения в колонку с мемо полем.
.head 5 -  Number: nImportType        ! =0-через oracle память(переменная в bars_dbf), =1 через временную таблицу tmp_lob
.head 5 -  Receive String: sErrMsg    ! текст ошибки обработки
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nImportType = 0
.head 6 -  Return ImportUseMomory(sFilePath,sFileName, sTableName,sEncode, nForceMode, nForceMemo, sErrMsg)
.head 5 +  If nImportType = 1
.head 6 -  Return ImportUseTmpTable(sFilePath,sTableName,sEncode, nForceMode, sErrMsg)
.head 5 -  Return TRUE
.head 3 +  Function: ImportPrInsider			! __exported
.head 4 -  Description: Импорт признаков инсайдеров
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sFileName
.head 5 -  String: sFilePath
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sEncode 
.head 5 -  String: sErrMsg
.head 5 -  String: sFilePathArc
.head 5 -  Number: nRet
.head 5 -  String: sErr
.head 4 +  Actions
.head 5 -  Set sFilePath = IifS(Right(sFilePath, 1)='\\', Left(sFilePath, Len(sFilePath)-1), sFilePath)
.head 5 -  Call SalGetProfileString('Import', 'NadraPrinsArcPath', '', sFilePathArc, GetIniFileName())
.head 5 -  Set sFilePathArc = IifS(Right(sFilePathArc, 1)='\\', Left(sFilePathArc, Len(sFilePathArc)-1), sFilePathArc) 
.head 5 +  If File(sFilePath||'\\'||sFileName)
.head 6 -  Set sEncode='WIN'
.head 6 -  Set nRet=0
.head 6 -  Set sErr=''
.head 6 +  If ImportDbf(sFilePath, sFileName, 'PRINSIDER_EDIT', sEncode, 1, 1, 0, sErrMsg)
.head 7 +  If SqlPLSQLCommand(hSql(),"bars.edit_prinsider(nRet,sErr)")
.head 8 +  If nRet!=0
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call MessageNoWait( sErr, 'Импорт признаков инсайдеров', 0, 1)
.head 8 +  Else
.head 9 -  Call VisFileCopy(sFilePath||'\\'||sFileName, sFilePathArc||'\\'||sFileName)
.head 9 +  If File(sFilePathArc||'\\'||sFileName)
.head 10 -  Call VisFileDelete(sFilePath||'\\'||sFileName)
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait( 'Изменения из файла '||sFilePath||'\\'||sFileName||' принято ', 'Импорт признаков инсайдеров', 0, 0)
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait( 'Файл '||sFilePath||'\\'||sFileName||' не скопировано в архивный каталог', 'Ошибка!', 0, 1)
.head 7 +  Else
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call MessageNoWait( 'Ошибка функции SqlPLSQLCommand', 'Импорт признаков инсайдеров', 0, 1)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait( 'Импорт признаков инсайдеров:'||sErrMsg, 'Файл '||sFilePath||'\\'||sFileName||' не импортировано', 0, 1)
.head 5 +  Else
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call MessageNoWait( 'Файл '||sFilePath||'\\'||sFileName||' не найдено','Импорт признаков инсайдеров', 0, 1)
.head 3 -  !
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 487135908
0000: E404000017020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F8F003C00 000F63004465736B
0040: 746F704C00697374 426F782201C00000 0B00000083010D00 0000FFFFE40D0000
0060: 01FE00FF831A0000 0001FB00FF0F2700 0000EE0100FF3F34 00B800000100FFFF
0080: E04100000001FE00 FF834E00000001FB 00FF0F5B000000EE 0100FF3F6800B800
00A0: 000100FFFFE07500 000001FE00FF8382 00000001FB00FF0F 0180340011000100
00C0: 000B63E04469724C 69036C0000000400 3C0000010DFB00FF 6F0D00EE0100FFBF
00E0: 1AB9000100FFFFE6 270001FE00FF4301 80270000E0020000 000F81547265654C
0100: 690F52000000F003 000000EC010D00FF BF0DB9000100FFFF E61A0001FE00FF43
0120: 01805B0000060300 0C634669F86C654C 41BA00000007009E 00010DFD00FF370D
0140: 0001F700FFDF1ADC 000100FF7F277300 0100FFFFCD340001 FD00FF37410001F7
0160: 00FFDF4EDC000100 FF7F01C880410000 0400000D63526164 696F7C4C69868000
0180: 0000050000006701 0D00FFFFC90D0000 01FD00FF371A0001 F700FFDF27DC0001
01A0: 00FF7F3473000100 FFFF010180220000 000503000A634765 6E04466974657274
01C0: 00D8000004002302 04000001FA000007 8001000000FFC604 00010DFE00FF8311
01E0: 00000002FB00FF0F 15000000EE0100FF 3F01800622000600 00001A0B47444669
0200: 7F00F604008E0200 0100FE00C9800100 00BF04B100010D00 FFFFE6110002FE00
0220: FF9B150001FB00FF 0F
.enddata
.head 3 +  ! Functional Class: cDocNOKK
.winattr
.end
.head 4 -    Description: Класс документа для электронных клиентов
.head 4 +    Derived From 
.head 5 -    Class: cDoc
.head 4 -    Class Variables 
.head 4 +    Instance Variables 
.head 5 -    Boolean: bSignInited
.head 4 +    Functions 
.head 5 +    Function: sIni
.head 6 -    Description: Инициализировать ЭЦП
.head 6 +    Returns 
.head 7 -    Boolean: 
.head 6 -    Parameters 
.head 6 +    Static Variables 
.head 7 -  ! Boolean: bSignInited
.head 7 -    Number: nTim
.head 6 +    Local variables 
.head 7 -  ! String: strUxDateTime
.head 7 -    String: strDay
.head 7 -    Number: nDay
.head 7 -    Number: nErrorSign
.head 7 -    String: strErrorSign
.head 7 -    String: strPinCode
.head 6 +    Actions 
.head 7 -  ! Call Debug('bSignInited:'||Str(bSignInited))
.head 7 +    If bSignInited
.head 8 -    Return TRUE
.head 7 +    If GetSignType() = 'UKR' or GetSignType() = 'NBU'
.head 8 -    Set nErrorSign = NUMBER_Null
.head 8 -    Set strPinCode = ''
.head 8 +    While TRUE
.head 9 +    If SalModalDialog(dlgAskPinCode, hWndForm,strPinCode)
.head 10 +    If GetSignType() = 'NBU'
.head 11 +    If bSignInited
.head 12 -    Set nErrorSign = CLOSE_ZAH()
.head 11 -  ! Set strUxDateTime = '1998/01/18 08:08:08'
    !!! ТОЛЬКО ДЛЯ ОТЛАДКИ !!!
.head 11 -  ! Set strUxDateTime = SalFmtFormatDateTime(
    GetBankDate(), 'yyyy/MM/dd') ||
    ' 07:07:07'
.head 11 -    Set nErrorSign = INIT_ZAH(GetOpenKeyDir(),
    GetSecretKeyDrv(), GetIdOper(),
    GetKeyDate(), strPinCode)
.head 11 +    If nErrorSign = -70
.head 12 -    Call MessageErrorEx('>> RSA. Последний ' ||
     'день действия секретного ключа')
.head 11 +    Else If nErrorSign > -77 And nErrorSign < -70
.head 12 -    Set nDay = - nErrorSign - 70
.head 12 +    If nDay = 1
.head 13 -    Set strDay = 'день'
.head 12 +    Else If nDay = 2 Or nDay = 3 Or nDay = 4
.head 13 -    Set strDay = 'дня'
.head 12 +    Else If nDay = 5 Or nDay = 6
.head 13 -    Set strDay = 'дней'
.head 12 -    Call MessageErrorEx('>> RSA. Срок действия'
     || 'секретного ключа прекращается ' ||
     'через ' || NumberToStr(nDay) || ' '
     || strDay)
.head 11 +    Else If nErrorSign != 0
.head 12 -    Break 
.head 10 +    Else 
.head 11 +    If bSignInited
.head 12 -    Set nErrorSign = nsignExitOPSign()
.head 11 -  ! Cipher 98
.head 11 -  ! Set nErrorSign = nsignInitOPSign(
    GetOpenKeyDir(), GetSecretKeyDrv(),
    strPinCode, GetBankMfo())
.head 11 -  ! Cipher 99 с ОперИдом
.head 11 -    Set nErrorSign = nsignInitOPSign(
    GetOpenKeyDir(), GetSecretKeyDrv(),
    strPinCode, GetBankMfo(),GetIdOper())
.head 11 -  ! Отладка
.head 11 -  ! Set nErrorSign = nsignInitOPSign(
    GetOpenKeyDir(), GetSecretKeyDrv(),
    strPinCode, '351447', GetIdOper())
.head 11 +    If nErrorSign != 0
.head 12 -    Break 
.head 10 -    Call SaveInfoToLog('>> RSA - инициализация - OK')
.head 10 -    Set bSignInited = TRUE
.head 10 -    Return TRUE
.head 9 +    Else 
.head 10 -    Break 
.head 8 +    If nErrorSign != NUMBER_Null ! обработка ошибок ЭЦП
.head 9 +    If GetSignType() = 'NBU'
.head 10 -    Set strErrorSign = '>> RSA. Ошибка инициализации ЭЦП: '||NumberToStr(nErrorSign)
.head 10 -  ! Call CLOSE_ZAH()
.head 10 -    Call MessageErrorEx(strErrorSign)
.head 9 +    Else 
.head 10 -    Set strErrorSign = Spac(129)
.head 10 -    Call nsignMapError2Text(strErrorSign,
     nErrorSign)
.head 10 -    Call MessageErrorEx('>> CIP. ' ||
     StrDosToWinX(strErrorSign))
.head 10 -    Call nsignExitOPSign()
.head 8 -    Return FALSE
.head 7 +    Else 
.head 8 -    Return MessageErrorEx('Неизвестная система ЭЦП: '|| GetSignType())
.head 7 +  ! Комментарий
.head 8 -  ! 'NBU' -- используется ЭЦП НБУ
.head 8 -  ! 'UKR' -- используется ЭЦП Банка 'Украина'
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbInsert
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box: cGenComboBox_StrId
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlg_ImportData
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "Барс" --> "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.375"
.head 4 -  Top:    0.948"
.head 4 -  Width:  18.067"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.893"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных из DBF -> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Загрузка/Импорт
.head 4 -  Window Location and Size
.head 5 -  Left:   15.35"
.head 5 -  Top:    7.5"
.head 5 -  Width:  2.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colDBF, tbl1.colPROC, tbl1.colFL, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   15.35"
.head 5 -  Top:    8.167"
.head 5 -  Width:  2.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   15.35"
.head 5 -  Top:    7.833"
.head 5 -  Width:  2.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Check Box: сbOemToAnsi
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перекодировать (DOS -> WIN)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    7.548"
.head 5 -  Width:  4.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  17.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 7.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colObj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Объект
 импорта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.886"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDBF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Источник
 импорта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.071"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура
 импорта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг импорта:
0 - полный импорт (1+2)
1- загрузка источника
2 - выполнение процедуры
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Заимпор-
тировано
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.029"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
К-во ошибок
при импорте
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.186"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
 процедуры
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
 процедуры
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT dbfname,procname,errmask,object,0
     INTO :tbl1.colDBF,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.colObj,:tbl1.colFL
     FROM p_migra
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 -  Background Text: Каталог импорта
.head 4 -  Resource Id: 57067
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.717"
.head 5 -  Top:    8.214"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfImp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.35"
.head 6 -  Top:    8.179"
.head 6 -  Width:  7.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not VisDosExist(dfImp)
.head 7 -  Call MessageNoWait('Отсутствует каталог ' || dfImp, 'Ошибка !!!', 17, 1)
.head 7 -  Return VALIDATE_Cancel	
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDBF
.head 5 -  String: sPROC
.head 5 -  Number: nFL
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If nFL < 2
.head 6 +  If tbl1.colDBF
.head 7 -  ! импорт DBF
.head 7 -  Set nCode = TabSqlFromDbf(dfImp, sDBF, сbOemToAnsi)
.head 7 +  If nCode > 0
.head 8 +  Select Case (nCode)
.head 9 +  Case 1
.head 10 -  Set sErr = 'неверно имя DBF (первый символ - цифра)'
.head 10 -  Break
.head 9 +  Case 2
.head 10 -  Set sErr = 'не удалось открыть файл ' || SalStrUpperX(sDBF)
.head 10 -  Break
.head 9 +  Case 3
.head 10 -  Set sErr = 'нет доступа к базе данных: ' || SqlDatabase
.head 10 -  Break
.head 9 +  Case 4
.head 10 -  Set sErr = 'отсутствует таблица ' || SalStrUpperX(Left(sDBF, Len(sDBF)-4))
.head 10 -  Break
.head 9 +  Case 5
.head 10 -  Set sErr = 'невозможно удалить записи из таблицы ' || SalStrUpperX(Left(sDBF, Len(sDBF)-4))
.head 10 -  Break
.head 9 +  Case 6
.head 10 -  Set sErr = 'невозможно вставить запись в таблицу ' || SalStrUpperX(Left(sDBF, Len(sDBF)-4))
.head 10 -  Break
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colErr = 1
.head 8 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 8 +  Else
.head 9 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 9 -  Call SalTblSetContext(tbl1, nRow)
.head 9 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 8 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || ': ошибка - ' || sErr)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Отсутствует источник загрузки!', 'ОШИБКА', 17, 1)
.head 5 +  If nFL = 0 or nFL = 2
.head 6 +  If tbl1.colPROC
.head 7 -  ! выполнение процедуры
.head 7 -  Set nNum = 0
.head 7 -  Set nErr = 0
.head 7 -  Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 7 -  ! Call Debug('SqlPLSQLCommand = ' || sCommand)
.head 7 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colDone = nNum
.head 8 -  Set tbl1.colErr = nErr
.head 7 +  Else
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colErr = 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Отсутствует процедура импорта!', 'ОШИБКА', 17, 1)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: checkForValidTableName
.head 4 -  Description: Проверить имя таблицы, которая будет создана по имени DBF файла - валидная или нет
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sDBFFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nChrCode
.head 4 +  Actions
.head 5 -  ! Если певый сивол  - цыфра - вылетаем
.head 5 -  Call SalStrFirstC(sDBFFileName, nChrCode)
.head 5 -  Return not (nChrCode >= 48 and nChrCode <= 57)
.head 3 +  Function: TableExists
.head 4 -  Description: Находит таблицу по синониму или в схеме текущего ползователя
Возвращает True если таблица есть
Параметр sTabName возвращает полностью квалифицированное имя таблицы OWNER.TABLE
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: sTabName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Number: nFetchRes
.head 5 -  ! String: sOwner
.head 5 -  ! String: sTable
.head 5 -  Number: nExists
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   select f_tableexists(:sTabName)
   into :nExists
   from dual") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return nExists
.head 5 -  Return FALSE
.head 3 +  Function: TabSqlFromDbf
.head 4 -  Description: Наполнение таблицы из DBF-файла
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 5 -  String: sDbf
.head 5 -  Boolean: bTrans
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlOdbc
.head 5 -  File Handle: hFile
.head 5 -  String: sBuf
.head 5 -  String: sItem
.head 5 -  String: sTyp
.head 5 -  String: sLen1
.head 5 -  String: sLen2
.head 5 -  Number: i
.head 5 -  Number: j
.head 5 -  Number: nLen1
.head 5 -  Number: nLen2
.head 5 -  String: sSqlItm
.head 5 -  String: sSqlSel
.head 5 -  String: sSqlBin
.head 5 -  String: sTab
.head 5 -  Number: NTmp[*]
.head 5 -  Number: LTmp[*]
.head 5 -  String: CTmp[*]
.head 5 -  Date/Time: DTmp[*]
.head 5 -  Number: nRec
.head 5 -  Number: nDelta
.head 5 -  Number: nFetchRes
.head 5 -  Number: nBound
.head 5 -  Boolean: fRecreate
.head 5 -  Boolean: fExists
.head 5 -  ! Boolean: fInsertRow
.head 5 -  Number: nRowsCount
.head 5 -  Number: nRow
.head 5 -  Number: nChoose
.head 5 -  !
.head 5 -  String: sSqlDel
.head 5 -  Number: nKp
.head 5 -  Number: nKv
.head 5 -  Number: nI
.head 5 -  String: smPer[*]
.head 5 -  String: smVal[*]
.head 5 -  Boolean: bDel
.head 5 -  Boolean: bDelZ
.head 5 -  !
.head 5 -  String: sTable
.head 5 -  String: sSqlText
.head 5 -  String: sSynonym
.head 5 -  String: sRole
.head 5 -  String: sGrant
.head 5 -  String: sPolicy
.head 5 -  String: sValues
.head 5 -  ! String: sValueDel
.head 5 -  String: sImpMod
.head 5 -  String: sErrMessage
.head 4 +  Actions
.head 5 -  ! Импорт sDbf
.head 5 +  If not checkForValidTableName(sDir || '\\' || sDbf)
.head 6 -  ! неверно имя DBF (первый символ - цифра)
.head 6 -  Return 1 ! неверно имя DBF (первый символ - цифра)
.head 5 +  Else
.head 6 +  If SalFileOpen(hFile, sDir || '\\' || sDbf, OF_Read)
.head 7 -  ! Читаем структуру таблицы dbf
.head 7 -  Call SalFileRead(hFile, sBuf, 32)
.head 7 -  Set sSqlItm = ''
.head 7 -  Set j = 0
.head 7 +  While SalFileRead(hFile, sBuf, 32) > 0
.head 8 -  Set sItem = SalStrTrimX(sBuf)
.head 8 +  If SalStrLop(sBuf) = 13
.head 9 -  Set sSqlItm = sSqlItm || ')'
.head 9 -  Break
.head 8 +  Else
.head 9 +  If SalStrLength(sSqlItm) = 0
.head 10 -  Set i = SalStrLength(sDbf)
.head 10 +  While i > 0
.head 11 +  If SalStrMidX(sDbf, i-1, 1) = '\\' or SalStrMidX(sDbf, i-1, 1) = ':'
.head 12 -  Break
.head 11 -  Set i = i - 1
.head 10 -  Set sTab = SalStrMidX(sDbf, i, SalStrLength(sDbf) - i)
.head 10 -  Set i = SalStrScan(sTab, '.')
.head 10 +  If i >= 0
.head 11 -  Set sTab = SalStrLeftX(sTab, SalStrScan(sTab, '.'))
.head 10 -  Set sSqlItm = '('
.head 10 -  Set sSqlSel = ''
.head 10 -  Set sSqlBin = ''
.head 9 +  Else
.head 10 -  Set sSqlItm = sSqlItm || ','
.head 10 -  Set sSqlSel = sSqlSel || ','
.head 10 -  Set sSqlBin = sSqlBin || ','
.head 8 -  Set i = 0
.head 8 +  While i < 10
.head 9 -  Call SalStrLop(sBuf)
.head 9 -  Set i = i + 1
.head 8 -  Set sTyp = SalNumberToChar(SalStrLop(sBuf))
.head 8 +  If not (sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L')
.head 9 -  Set sSqlItm = SalStrMidX(sSqlItm, 0, SalStrLength(sSqlItm)-2)
.head 9 -  Set sSqlSel = SalStrMidX(sSqlSel, 0, SalStrLength(sSqlSel)-1)
.head 9 -  Set sSqlBin = SalStrMidX(sSqlBin, 0, SalStrLength(sSqlBin)-1)
.head 8 -  Set i = 0
.head 8 +  While i < 4
.head 9 -  Call SalStrLop(sBuf)
.head 9 -  Set i = i + 1
.head 8 -  Set nLen1 = SalStrLop(sBuf)
.head 8 -  Set sLen1 = SalNumberToStrX(nLen1, 0)
.head 8 -  Set nLen2 = SalStrLop(sBuf)
.head 8 -  Set sLen2 = SalNumberToStrX(nLen2, 0)
.head 8 +  If sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L'
.head 9 -  Set sSqlBin = sSqlBin || ':' || sTyp || 'Tmp[' || SalNumberToStrX(j, 0) || ']'
.head 9 -  Set j = j + 1
.head 9 +  If sTyp = 'C'
.head 10 +  If nLen1 < 11
.head 11 -  Set sTyp = 'CHAR'
.head 10 +  Else
.head 11 -  Set sTyp = 'VARCHAR'
.head 9 +  Else If sTyp = 'N'
.head 10 +  If nLen1 < 5 and nLen2 = 0
.head 11 -  Set sTyp = 'SMALLINT'
.head 11 -  Set sLen1 = ''
.head 10 +  Else If nLen1 < 10 and nLen2 = 0
.head 11 -  Set sTyp = 'INTEGER'
.head 11 -  Set sLen1 = ''
.head 10 +  Else
.head 11 -  Set sTyp = 'DECIMAL'
.head 11 -  Set sLen1 = sLen1 || ',' || sLen2
.head 9 +  Else If sTyp = 'D'
.head 10 -  Set sTyp = 'DATE'
.head 10 -  Set sLen1 = ''
.head 9 +  Else If sTyp = 'L'
.head 10 -  Set sTyp = 'CHAR'
.head 10 -  Set sLen1 = '1'
.head 9 +  If sLen1 = ''
.head 10 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp
.head 9 +  Else
.head 10 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp || '(' || sLen1 || ')'
.head 9 -  Set sSqlSel = sSqlSel || sItem
.head 7 +  If hFile
.head 8 -  Call SalFileClose(hFile)
.head 7 -  !
.head 7 -  Set fExists   = FALSE
.head 7 -  Set fRecreate = FALSE
.head 7 -  Set bDel  = FALSE
.head 7 -  Set bDelZ = FALSE
.head 7 -  Set sImpMod = ''
.head 7 -  Set SqlDatabase = 'dBase_Files'
.head 7 -  Call SalFileSetCurrentDirectory(sDir)
.head 7 +  If SqlConnect(hSqlOdbc)
.head 8 -  ! Есть таблица?
.head 8 +  If not TableExists(sTab)
.head 9 -  Call SqlDisconnect(hSqlOdbc)
.head 9 -  ! отсутствует таблица
.head 9 -  Return 4 ! отсутствует таблица
.head 8 -  ! удаляем записи
.head 8 +  If not SqlPrepareAndExecute(hSql(), 'DELETE FROM ' || sTab)
.head 9 -  Call SqlDisconnect(hSqlOdbc)
.head 9 -  ! Невозможно удалить записи из таблицы
.head 9 -  Return 5 ! невозможно удалить записи из таблицы
.head 8 -  !
.head 8 -  ! Читаем кол-во строк в dbf
.head 8 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT count(*) FROM ' || sTab || ' INTO :nRec')
.head 8 -  Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 8 +  If nRec > 0
.head 9 -  ! Добавление записей в таблицу sTab
.head 9 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT ' || sSqlSel || ' INTO ' || sSqlBin || ' FROM ' || sTab)
.head 9 +  While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 10 -  Set j = 0
.head 10 -  Call SalArrayGetUpperBound(CTmp, 1, nBound)
.head 10 +  While j <= nBound
.head 11 +  If SalStrLength(CTmp[j]) > 0
.head 12 -  Set CTmp[j] = SalStrTrimX(IifS(bTrans, StrDosToWinX(CTmp[j]), CTmp[j]))
.head 11 -  Set j = j + 1
.head 10 -  !
.head 10 -  ! nKp - кол-во переменных из select
.head 10 -  Set nKp = SalStrTokenize(sSqlSel, '', ',', smPer)
.head 10 -  ! nKv - кол-во бинд-переменных из into
.head 10 -  Set nKv = SalStrTokenize(sSqlBin, '', ',', smVal)
.head 10 -  Call SalArrayGetUpperBound(smVal, 1, nBound)
.head 10 -  !
.head 10 -  ! delete по условию (замена)
.head 10 -  ! insert
.head 10 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO " || sTab || " (" || sSqlSel || ") VALUES(" || sSqlBin || ")")
.head 11 -  ! Невозможно всавить запись в таблицу sTab
.head 11 -  Return 6 ! невозможно всавить запись в таблицу sTab
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SqlDisconnect(hSqlOdbc)
.head 8 -  !
.head 8 -  Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  ! Обработка файла завершена
.head 7 +  Else
.head 8 -  ! Нет доступа к базе данных: SqlDatabase
.head 8 -  Return 3 ! нет доступа к базе данных: SqlDatabase
.head 6 +  Else
.head 7 -  ! Не удалось открыть файл: sDbf
.head 7 -  Return 2 ! не удалось открыть файл DBF
.head 6 -  Return 0
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sODBCDir
.head 3 -  ! Date/Time: dTmp
.head 3 -  ! String: strBankA
.head 3 -  ! Sql Handle: hSqlOdbcTemp
.head 3 -  ! Boolean: bStatus
.head 3 -  ! Number: nRecCount
.head 3 -  ! Number: nRecCntCustomer
.head 3 -  ! Number: nRecCntCorps
.head 3 -  ! Number: nRecCntPerson
.head 3 -  ! Number: nRecCntCustbank
.head 3 -  ! Number: nCountry
.head 3 -  ! String: strPbox
.head 3 -  ! String: strOkpo
.head 3 -  ! String: strPg
.head 3 -  ! String: strTemp
.head 3 -  ! Number: nTgr
.head 3 -  ! Number: nLastAcc
.head 3 -  ! Number: nRnkCount
.head 3 -  ! Number: nPos
.head 3 -  ! Number: nDelta
.head 3 -  ! String: SavDatabase
.head 3 -  ! String: SavUser
.head 3 -  ! String: SavPassword
.head 3 -  ! Date/Time: dBankDate
.head 3 -  ! Number: nIr_c
.head 3 -  ! Number: nIr_d
.head 3 -  ! Number: nPR
.head 3 -  ! String: sPR
.head 3 -  ! Number: nFlagPR
.head 3 -  !
.head 3 -  ! Number: nIspNone
.head 3 -  ! String: sIspNone
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  ! Window Handle: hRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  ! Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call ConPara('PUSH')
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'InitImp', 'С:\\IMPORT', sODBCDir, GetIniFileName())
.head 4 +  If not VisDosExist(sODBCDir)
.head 5 -  Call MessageNoWait('Отсутствует каталог ' || sODBCDir, 'Ошибка!!!', 17, 1)
.head 4 -  Set dfImp = sODBCDir
.head 3 +  On SAM_CreateComplete
.head 4 -  Set сbOemToAnsi = 1
.head 3 -  ! On SAM_Destroy
.head 1 +  Dialog Box: dlg_LookErr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр ошибок
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.063"
.head 4 -  Top:    0.083"
.head 4 -  Width:  14.543"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.167"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblPs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.043"
.head 6 -  Top:    0.06"
.head 6 -  Width:  14.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 7.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 64000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colNum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRecDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRecMess
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ошибка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  11.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRowT
.head 5 -  Long String: sRecMess
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set nK = 0
.head 6 -  Call SalTblSetTableFlags(tblPs, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Set strSql = "
    SELECT rec_date,rec_message
    INTO :colRecDate,:sRecMess
    FROM sec_audit
    WHERE rec_uid=:nUserId and rec_date between :dBeg and :dEnd and rec_message like '" || sErrMask || "%'
    ORDER BY rec_id"
.head 6 -  Set sRecMess = Spac(4000)
.head 6 -  Call SqlSetLongBindDatatype(2, 22)
.head 6 -  Call SalTblPopulate(tblPs, hSql(), strSql, TBL_FillAll)
.head 6 -  Call SalTblSetFocusRow(tblPs, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nK = nK + 1
.head 6 -  Set colNum = nK
.head 6 -  Set colRecMess = sRecMess
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLook, SAM_Click, 0, 0)
.head 3 +  Pushbutton: pbLook
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подробно
.head 4 -  Window Location and Size
.head 5 -  Left:   0.129"
.head 5 -  Top:    7.488"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRowT = SalTblQueryContext(tblPs)
.head 6 -  Call SalModalDialog(dlg_ViewErr, hWndForm, nRowT)
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Печать
.head 4 -  Window Location and Size
.head 5 -  Left:   1.629"
.head 5 -  Top:    7.488"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call TablePrint(tblPs, 'Ошибки', GetPrnDir() || '\\Errors', '')
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   3.129"
.head 5 -  Top:    7.488"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(dlg_LookErr, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 11802
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.029"
.head 5 -  Top:    7.405"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.44"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Date/Time: dBeg
.head 3 -  Date/Time: dEnd
.head 3 -  String: sErrMask
.head 2 +  Window Variables
.head 3 -  String: strSql
.head 3 -  Number: nUserId
.head 3 -  Number: nK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call WaitCursorOn()
.head 4 -  Set nUserId = GetUserId()
.head 4 -  ! Call SetWindowFont(hWndForm)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_ViewErr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр сообщений
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.888"
.head 4 -  Top:    1.042"
.head 4 -  Width:  8.657"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.881"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Форма просмотра сообщений
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Дата:
.head 4 -  Resource Id: 11803
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.048"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: df_time
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    0.06"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: dd.MM.yyyy hh:mm:ss
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: ml_text
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4096
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.333"
.head 6 -  Width:  8.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.729"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb_close
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.8"
.head 5 -  Top:    2.107"
.head 5 -  Width:  0.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nRow
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 3 +  On SAM_CreateComplete
.head 4 -  Set df_time = dlg_LookErr.tblPs.colRecDate
.head 4 -  Set ml_text = dlg_LookErr.tblPs.colRecMess
.head 4 -  Call SalSetFocus(pb_close)
.head 1 +  Table Window: KL1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Изменения в справочнике
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.84"
.head 4 -  Top:    0.617"
.head 4 -  Width:  12.014"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Синхронизировать расхождения'
.head 6 +  On SAM_Click
.head 7 -  !
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If SqlPrepareAndExecute(hSql(), KL1.strSqlUpdate)
.head 8 -  Call SqlCommitEx(hSql(),'Обновление ' || sTABNAME)
.head 7 -  ! Call SalWaitCursor(FALSE)
.head 7 -  ! Call SalWaitCursor(TRUE)
.head 7 +  If SqlPrepareAndExecute(hSql(), KL1.strSqlInsert)
.head 8 -  Call SqlCommitEx(hSql(), 'Добавка в ' || sTABNAME)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Line
.head 5 -  Resource Id: 53547
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53548
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53549
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: KOD1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.914"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
 новое
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.214"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PAR1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пар
новый
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
 старое
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PAR2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пар
старый
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.771"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sTABNAME 
.head 3 -  String: sTBLNAMENBU
.head 3 -  String: sSEMANTIC
.head 2 +  Window Variables
.head 3 -  Number: nKol
.head 3 -  String: sNBU
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, 'Синхронизация справочника '
     || sSEMANTIC)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 1)
.head 4 -  Set KL1.strPrintFileName = 'KL1'
.head 4 -  Set nKol = 0
.head 4 +  If sTABNAME = 'PS' and sTBLNAMENBU = 'KL_R020'
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sNBU
   FROM   params
   WHERE  par='NBUBANK'") 
.head 5 -  ! Убираем различия в наименованиях бал. счетов
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)  !! КБ
.head 6 -  Set KL1.strSqlPopulate = "
    SELECT n.r020,n.txt,s.name,n.t020,s.pap || ''
    INTO   :KL1.KOD1,:KL1.NAME1,:KL1.NAME2,:KL1.PAR1,:KL1.PAR2
    FROM   kl_r020 n, ps s
    WHERE  n.prem='КБ' AND to_number(n.r020)=to_number(s.nbs) AND n.t020<>s.pap
    UNION ALL 
    SELECT n.r020,n.txt,'',n.t020,''
    FROM   kl_r020 n
    WHERE  n.prem='КБ' AND n.r020 not in (select nbs from ps)
    ORDER BY 1"
.head 6 -  Set KL1.strSqlUpdate = "
    UPDATE ps s
    SET    s.pap=(select n.t020
                  from   kl_r020 n
                  where  n.prem='КБ' AND
                         to_number(n.r020)=to_number(s.nbs))"
.head 6 -  Set KL1.strSqlInsert = "
    INSERT
    INTO   ps (NBS,PAP,NAME,CLASS)
    SELECT substr(r020||'    ',1,4),t020,substr(txt,1,175),99
    FROM   kl_r020 
    WHERE  prem='КБ' AND r020 not in (select nbs from ps)"
.head 5 +  Else !! НБУ
.head 6 -  Set KL1.strSqlPopulate = "
    SELECT n.r020,n.txt,s.name,n.t020,s.pap||''
    INTO   :KL1.KOD1,:KL1.NAME1,:KL1.NAME2,:KL1.PAR1,:KL1.PAR2
    FROM   kl_r020 n, ps s
    WHERE  n.prem='НБУ' AND to_number(n.r020)=to_number(s.nbs) AND n.t020<>s.pap
    UNION ALL 
    SELECT n.r020,n.txt,'',n.t020,''
    FROM   kl_r020 n
    WHERE  n.prem='НБУ' AND n.r020 not in (select nbs from ps)
    ORDER BY 1"
.head 6 -  Set KL1.strSqlUpdate = "
    UPDATE ps s
    SET    s.pap=(select n.t020
                  from   kl_r020 n
                  where  n.prem='НБУ' AND
                         to_number(n.r020)=to_number(s.nbs))"
.head 6 -  Set KL1.strSqlInsert = "
    INSERT
    INTO   ps (NBS,PAP,NAME,CLASS)
    SELECT substr(r020||'    ',1,4),t020,substr(txt,1,175),99
    FROM   kl_r020 
    WHERE  prem='НБУ' AND r020 not in (select nbs from ps)"
.head 4 +  Else If sTABNAME = 'CODCAGENT' and sTBLNAMENBU = 'KL_K010'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k010,n.txt,s.name,n.k030,s.rezid||''
    INTO   :KL1.KOD1,:KL1.NAME1,:KL1.NAME2,:KL1.PAR1,:KL1.PAR2
    FROM   kl_k010 n, codcagent s
    WHERE  to_number(n.k010)=to_number(s.codcagent) AND
           (n.k030<>s.rezid or ltrim(rtrim(substr(n.txt,1,35)))<>ltrim(rtrim(s.name)))
    UNION ALL
    SELECT n.k010,n.txt,'',n.k030,''
    FROM   kl_k010 n
    WHERE  n.k010 not in (select codcagent from codcagent)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE codcagent s
    SET    s.name=(select substr(n.txt,1,35)
                   from   kl_k010 n
                   where to_number(n.k010)=to_number(s.codcagent)),s.rezid=(select n.k030
                                                                            from   kl_k010 n
                                                                            where  to_number(n.k010)=
                                                                                   to_number(s.codcagent))"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO   codcagent (CODCAGENT,NAME,REZID)
    SELECT k010,substr(txt,1,35),k030
    FROM   kl_k010
    WHERE  k010 not in (select codcagent from codcagent)"
.head 4 +  Else If sTABNAME = 'COUNTRY' and sTBLNAMENBU = 'KL_K040'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k040,n.txt,s.name
    INTO   :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM   kl_k040 n, country s
    WHERE  to_number(n.k040)=to_number(s.country) AND ltrim(rtrim(n.txt))<>ltrim(rtrim(s.name))
    UNION ALL 
    SELECT n.k040,n.txt,''
    FROM   kl_k040 n
    WHERE  n.k040 not in (select country from country)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE country s
    SET    s.name=(select n.txt
                   from   kl_k040 n
                   where  to_number(n.k040)=to_number(s.country))"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO   country (country,NAME)
    SELECT k040,txt
    FROM   kl_k040
    WHERE  k040 not in (select country from country)"
.head 4 +  Else If sTABNAME = 'FS' and sTBLNAMENBU = 'KL_K080'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k080,n.txt,s.name
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM kl_k080 n, fs s
    WHERE n.k080=s.fs AND
          ltrim(rtrim(n.txt))<>ltrim(rtrim(s.name))
    UNION ALL 
    SELECT n.k080,n.txt,''
    FROM kl_k080 n
    WHERE n.k080 not in (select fs from fs)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE fs s
    SET s.name=(select n.txt
                from kl_k080 n
                where n.k080=s.fs)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO fs (fs,NAME)
    SELECT k080,txt
    FROM kl_k080
    WHERE k080 not in (select fs from fs)"
.head 4 +  Else If sTABNAME = 'ISE' and sTBLNAMENBU = 'KL_K070'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k070,n.txt,s.name
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM kl_k070 n, ise s
    WHERE n.k070=s.ise AND
          ltrim(rtrim(n.txt))<>ltrim(rtrim(s.name))
    UNION ALL
    SELECT n.k070,n.txt,''
    FROM kl_k070 n
    WHERE n.k070 not in (select ise from ise)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE ise s
    SET s.name=(select n.txt
                from kl_k070 n
                where n.k070=s.ise)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO ise (ise,NAME)
    SELECT k070,txt
    FROM kl_k070
    WHERE k070 not in (select ise from ise)"
.head 4 +  Else If sTABNAME = 'OE' and sTBLNAMENBU = 'KL_K090'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k090,n.txt,s.name
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM kl_k090 n, oe s
    WHERE n.k090=s.oe AND
          ltrim(rtrim(n.txt))<>ltrim(rtrim(s.name))
    UNION ALL 
    SELECT n.k090,n.txt,''
    FROM kl_k090 n
    WHERE n.k090 not in (select oe from oe)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE oe s
    SET s.name=(select n.txt
                from kl_k090 n
                where n.k090=s.oe)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO oe (oe,NAME)
    SELECT k090,txt
    FROM kl_k090
    WHERE k090 not in (select oe from oe)"
.head 4 +  Else If sTABNAME = 'VED' and sTBLNAMENBU = 'KL_K110'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.k110,n.txt,s.name
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM kl_k110 n,ved s
    WHERE n.k110=s.ved AND
          ltrim(rtrim(substr(n.txt,1,70)))<>
          ltrim(rtrim(s.name))
    UNION ALL 
    SELECT n.k110,n.txt,''
    FROM kl_k110 n
    WHERE n.k110 not in (select ved from ved)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE ved s
    SET s.name=(select substr(n.txt,1,70)
                from kl_k110 n
                where n.k110=s.ved)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO ved (ved,NAME)
    SELECT k110,substr(txt,1,70)
    FROM kl_k110
    WHERE k110 not in (select ved from ved)"
.head 4 +  Else If sTABNAME = 'SPR_REG' and sTBLNAMENBU = 'SPR_REG_'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.c_reg, n.name_sti, n.c_dst || '', s.name_sti
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.PAR1,:KL1.NAME2
    FROM spr_reg_ n, spr_reg s 
    WHERE n.c_reg=s.c_reg AND n.c_dst=s.c_dst AND (
          ltrim(rtrim(n.name_sti))<>
          ltrim(rtrim(s.name_sti)) or n.t_sti<>s.t_sti or
          n.zip_code<>s.zip_code or
          ltrim(rtrim(n.adress))<>ltrim(rtrim(s.address)))
    UNION ALL 
    SELECT n.c_reg,n.name_sti,n.c_dst || '',''
    FROM spr_reg_ n
    WHERE (n.c_reg,n.c_dst) not in (select c_reg,c_dst
                                    from spr_reg)
    ORDER BY 1,3"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE spr_reg s
    SET s.t_sti=(select n.t_sti
                 from spr_reg_ n
                 where n.c_reg=s.c_reg AND
                       n.c_dst=s.c_dst),
        s.name_sti=(select n.name_sti
                    from spr_reg_ n
                    where n.c_reg=s.c_reg AND
                          n.c_dst=s.c_dst),
        s.zip_code=(select n.zip_code
                    from spr_reg_ n
                    where n.c_reg=s.c_reg AND
                          n.c_dst=s.c_dst),
        s.address=(select n.adress
                   from spr_reg_ n
                   where n.c_reg=s.c_reg AND
                         n.c_dst=s.c_dst)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO spr_reg (C_REG,C_DST,T_STI,NAME_STI,ZIP_CODE,
                  ADDRESS) 
    SELECT C_REG,C_DST,T_STI,NAME_STI,ZIP_CODE,ADRESS
    FROM spr_reg_
    WHERE (C_REG,C_DST) not in (select C_REG,C_DST
                                from spr_reg)"
.head 4 +  Else If sTABNAME = 'SPR_OBL' and sTBLNAMENBU = 'SPR_OBL_'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.c_reg,n.name_reg,n.kod_reg,s.name_reg,
           s.kod_reg
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.PAR1,:KL1.NAME2,
         :KL1.PAR2
    FROM spr_obl_ n, spr_obl s
    WHERE n.c_reg=s.c_reg AND (n.kod_reg<>s.kod_reg or
          ltrim(rtrim(n.name_reg))<>
          ltrim(rtrim(s.name_reg)))
    UNION ALL 
    SELECT n.c_reg,n.name_reg,n.kod_reg,'',''
    FROM spr_obl_ n
    WHERE n.c_reg not in (select c_reg from spr_obl)
    ORDER BY 1,3"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE spr_obl s
    SET s.name_reg=(select n.name_reg
                    from spr_obl_ n
                    where n.c_reg=s.c_reg),
        s.kod_reg =(select n.kod_reg
                    from spr_obl_ n
                    where n.c_reg=s.c_reg)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO spr_obl (C_REG,NAME_REG,KOD_REG)
    SELECT C_REG,NAME_REG,KOD_REG 
    FROM spr_obl_
    WHERE C_REG not in (select C_REG from spr_obl)"
.head 4 +  Else If sTABNAME = 'SK' and sTBLNAMENBU = 'KL_D010'
.head 5 -  Set KL1.strSqlPopulate = "
    SELECT n.d010,n.txt,s.name
    INTO :KL1.KOD1,:KL1.NAME1,:KL1.NAME2
    FROM kl_d010 n, sk s
    WHERE n.d010+0=s.sk AND
          ltrim(rtrim(n.txt))<>ltrim(rtrim(s.name))
    UNION ALL
    SELECT n.d010,n.txt,''
    FROM kl_d010 n
    WHERE n.d010+0 not in (select sk from sk)
    ORDER BY 1"
.head 5 -  Set KL1.strSqlUpdate = "
    UPDATE sk s
    SET s.name=(select n.txt
                from kl_d010 n
                where n.d010+00=s.sk)"
.head 5 -  Set KL1.strSqlInsert = "
    INSERT
    INTO sk (sk,NAME)
    SELECT d010+0,txt
    FROM kl_d010
    WHERE d010+0 not in (select sk from sk)"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set nKol = 0
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(),
     KL1.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 +  If nKol = 0
.head 5 -  Call SalDisableWindow(KL1.pbUpdate)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set nKol = nKol + 1
.head 4 +  If KL1.NAME2 = ''
.head 5 -  Call SalTblSetCellTextColor(KL1.NAME1, COLOR_Red, FALSE)
.head 5 -  Call SalTblSetCellTextColor(KL1.KOD1, COLOR_Red, FALSE)
.head 1 +  ! cGenericTable: KL
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Синхронизация внешних и внутренних справочников
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.84"
.head 4 -  Top:    0.617"
.head 4 -  Width:  13.467"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.048"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.end
.head 2 -    Description: 
.head 2 -    Named Menus 
.head 2 -    Menu 
.head 2 +    Tool Bar 
.head 3 +    Contents 
.head 4 +    Pushbutton: pbIns
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set strTip = 'Импорт внешненго справочника'
.head 6 +    On SAM_Click
.head 7 -    Call SalWaitCursor(TRUE)
.head 7 -    Call CreTabSqlFromDbf(strPath || '\\' || KL.sTBLNAMENBU
     || '.dbf', KL.sTBLNAMENBU ||
     IifS(KL.sTBLNAMENBU=KL.sTABNAME, '_', ''), TRUE)
.head 7 -    Call SalWaitCursor(FALSE)
.head 4 +    Pushbutton: pbDel
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbRefresh
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbUpdate
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set strTip = 'Синхронизировать расхождения'
.head 6 +    On SAM_Click
.head 7 -    Call SalCreateWindow(KL1, hWndMDI, KL.sTABNAME,
     KL.sTBLNAMENBU ||
     IifS(KL.sTBLNAMENBU=KL.sTABNAME, '_', ''),
     KL.sSEMANTIC)
.head 4 -    Line 
.head 4 +    Pushbutton: pbSearch
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbFilter
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbDetails
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set strTip = 'Просмотр справочника АБС'
.head 6 +    On SAM_Click
.head 7 -    Call FunNSIEditF(KL.sTABNAME, 1)
.head 4 +    Pushbutton: pbPrint
.head 5 -    Message Actions 
.head 4 -    Line 
.head 4 +    Pushbutton: pbExit
.head 5 -    Message Actions 
.head 4 -    Line 
.head 2 +    Contents 
.head 3 +    Column: sSEMANTIC
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 3 +    Column: sTBLNAMENBU 
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 3 +    Column: nTYPE
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 3 +    Column: sNANE
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 3 +    Column: sTABNAME
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 3 +    Column: nTABID 
.head 4 -    List Values 
.head 4 -    Message Actions 
.head 2 +    Functions 
.head 3 +    Function: CreTabSqlFromDbf
.head 4 -    Description: 
.head 4 +    Returns 
.head 5 -    Boolean: 
.head 4 +    Parameters 
.head 5 -    String: sDbf   ! имя dbf-файла
.head 5 -    String: sTable ! имя таблицы-аналога в БД
.head 5 -    Boolean: bTrans
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    Sql Handle: hSqlOdbc
.head 5 -    File Handle: hFile
.head 5 -    String: sBuf
.head 5 -    String: sItem
.head 5 -    String: sTyp
.head 5 -    String: sLen1
.head 5 -    String: sLen2
.head 5 -    Number: i
.head 5 -    Number: j
.head 5 -    Number: nLen1
.head 5 -    Number: nLen2
.head 5 -    String: sSqlItm
.head 5 -    String: sSqlSel
.head 5 -    String: sSqlBin
.head 5 -    String: sTab
.head 5 -    Number: NTmp[*]
.head 5 -    String: CTmp[*]
.head 5 -    Date/Time: DTmp[*]
.head 5 -    Number: nRec
.head 5 -    Number: nDelta
.head 5 -    Number: nFetchRes
.head 5 -    Number: nBound
.head 4 +    Actions 
.head 5 +    If SalFileOpen(hFile, sDbf, OF_Read)
.head 6 -    Call SalFileRead(hFile, sBuf, 32)
.head 6 -    Set sSqlItm = ''
.head 6 -    Set j = 0
.head 6 +    While SalFileRead(hFile, sBuf, 32) > 0
.head 7 -    Set sItem = SalStrTrimX(sBuf)
.head 7 +    If SalStrLop(sBuf) = 13
.head 8 -    Set sSqlItm = sSqlItm || ')'
.head 8 -    Break 
.head 7 +    Else 
.head 8 +    If SalStrLength(sSqlItm) = 0
.head 9 -    Set i = SalStrLength(sDbf)
.head 9 +    While i > 0
.head 10 -  ! Call SalMessageBox(SalStrMidX(sDbf, i-1, 1),
     'MMM', MB_OK)
.head 10 +    If SalStrMidX(sDbf, i-1, 1) = '\\' or
   SalStrMidX(sDbf, i-1, 1) = ':'
.head 11 -    Break 
.head 10 -    Set i = i - 1
.head 9 -    Set sTab = SalStrMidX(sDbf, i,
    SalStrLength(sDbf) - i)
.head 9 -    Set i=SalStrScan(sTab,'.')
.head 9 +    If i >= 0
.head 10 -    Set sTab = SalStrLeftX(sTab,
    SalStrScan(sTab, '.'))
.head 9 -    Set sSqlItm = '('
.head 9 -    Set sSqlSel = ''
.head 9 -    Set sSqlBin = ''
.head 9 -  ! Call SalMessageBox(sSql, 'SSS', MB_OK)
.head 9 -  ! Return FALSE
.head 8 +    Else 
.head 9 -    Set sSqlItm = sSqlItm || ',' || SalNumberToChar(10)
.head 9 -    Set sSqlSel = sSqlSel || ','
.head 9 -    Set sSqlBin = sSqlBin || ','
.head 7 -    Set i = 0
.head 7 +    While i < 10
.head 8 -    Call SalStrLop(sBuf)
.head 8 -    Set i = i + 1
.head 7 -    Set sTyp = SalNumberToChar(SalStrLop(sBuf))
.head 7 -    Set i = 0
.head 7 +    While i < 4
.head 8 -    Call SalStrLop(sBuf)
.head 8 -    Set i = i + 1
.head 7 -    Set nLen1 = SalStrLop(sBuf)
.head 7 -    Set sLen1 = SalNumberToStrX(nLen1, 0)
.head 7 -    Set nLen2 = SalStrLop(sBuf)
.head 7 -    Set sLen2 = SalNumberToStrX(nLen2, 0)
.head 7 -    Set sSqlBin = sSqlBin || ':' || sTyp || 'Tmp[' ||
    SalNumberToStrX(j, 0) || ']'
.head 7 -    Set j = j + 1
.head 7 +    If sTyp = 'C'
.head 8 +    If nLen1 < 11
.head 9 -    Set sTyp = 'CHAR'
.head 8 +    Else 
.head 9 -    Set sTyp = 'VARCHAR'
.head 7 +    Else If sTyp = 'N'
.head 8 +    If nLen1 < 5 and nLen2 = 0
.head 9 -    Set sTyp = 'SMALLINT'
.head 9 -    Set sLen1 = ''
.head 8 +    Else If nLen1 < 10 and nLen2 = 0
.head 9 -    Set sTyp = 'INTEGER'
.head 9 -    Set sLen1 = ''
.head 8 +    Else 
.head 9 -    Set sTyp = 'DECIMAL'
.head 9 -    Set sLen1 = sLen1 || ',' || sLen2
.head 7 +    Else If sTyp = 'D'
.head 8 -    Set sTyp = 'DATE'
.head 8 -    Set sLen1 = ''
.head 7 +    If sLen1 = ''
.head 8 -    Set sSqlItm = sSqlItm || sItem || ' ' || sTyp
.head 7 +    Else 
.head 8 -    Set sSqlItm = sSqlItm || sItem || ' ' || sTyp || '('
    || sLen1 || ')'
.head 7 -    Set sSqlSel = sSqlSel || sItem
.head 6 -    Call SalFileSetCurrentDirectory(strPath)
.head 6 -    Set SqlDatabase = 'dBase_Files'
.head 6 +    If SqlConnect(hSqlOdbc)
.head 7 -  ! Call SqlPrepareAndExecute(hSql(), '
     DROP TABLE BARS.' || sTable)
.head 7 -  ! Call SqlPrepareAndExecute(hSql(), '
     CREATE TABLE BARS.' || sTable || ' ' || sSqlItm)
.head 7 -    Call SqlPrepareAndExecute(hSql(), '
     delete
     from ' || sTable)
.head 7 +    If SqlPrepareAndExecute(hSqlOdbc, '
   SELECT count(*)
   FROM ' || sTab || ' INTO :nRec')
.head 8 -    Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 8 +    If nRec > 0
.head 9 -    Set i = 0
.head 9 -    Set nDelta = 100 / nRec
.head 9 -    Call SqlPrepareAndExecute(hSqlOdbc, '
     SELECT ' || sSqlSel || '
     INTO ' || sSqlBin || '
     FROM ' || sTab)
.head 9 +    While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 10 -  ! If bTrans
.head 10 -    Set j = 0
.head 10 -    Call SalArrayGetUpperBound(CTmp, 1, nBound)
.head 10 +    While j <= nBound
.head 11 +    If SalStrLength(CTmp[j]) > 0
.head 12 -    Set CTmp[j] = SalStrTrimX(IifS(bTrans,
    StrDosToWinX(CTmp[j]), CTmp[j]))
.head 11 -    Set j = j + 1
.head 10 -    Call SqlPrepareAndExecute(hSql(),'
     INSERT
     INTO ' || sTable || ' (' || sSqlSel || ')
     VALUES(' || sSqlBin || ')')
.head 10 -    Set i = i + nDelta
.head 10 -  ! Call ccProgressBar.SetProgress(i)
.head 7 -    Call SqlCommit(hSql())
.head 7 -    Call SqlDisconnect(hSqlOdbc)
.head 7 -    Call SalMessageBeep(MB_IconAsterisk)
.head 7 -    Call SalMessageBox('Обработка файла завершена !',
     'Загрузка', MB_IconAsterisk | MB_Ok)
.head 6 +    Else 
.head 7 -    Call SalMessageBox('Нет доступа к базе данных: ' ||
     SqlDatabase, 'Ошибка', MB_OK)
.head 7 -    Return FALSE
.head 6 -    Call SalFileSetCurrentDirectory(strPath_Tek)
.head 6 -    Return TRUE
.head 5 +    Else 
.head 6 -    Call SalMessageBox('Не удалось открыть файл: ' || sDbf,
     'Ошибка', MB_OK)
.head 6 -    Return FALSE
.head 2 +    Window Parameters 
.head 3 -    Number: nPar
.head 2 +    Window Variables 
.head 3 -  ! Number: nTEK
.head 3 -    String: strPath
.head 3 -    String: strPath_Tek
.head 2 +    Message Actions 
.head 3 +    On SAM_Create
.head 4 -    Call SalUseRegistry(FALSE, '')
.head 4 -    Call SalGetProfileString('Import', 'Kl_Nbu', '', strPath,
     GetIniFileName())
.head 4 -    Call SalFileGetCurrentDirectory(strPath_Tek)
.head 4 -    Call SalTblSetLockedColumns(hWndForm, 1)
.head 4 -    Set KL.strPrintFileName = 'KL'
.head 4 -    Set KL.strSqlPopulate = "
    SELECT m.SEMANTIC,r.TBLNAMENBU,r.TYPE,t.NAME,m.TABNAME,
           m.TABID
    INTO :KL.sSEMANTIC,:KL.sTBLNAMENBU,:KL.nTYPE,:KL.sNANE,
         :KL.sTABNAME,:KL.nTABID
    FROM meta_tables m, references r, TYPEREF t
    WHERE m.TABID=r.TABID and r.TYPE=t.TYPE and
          r.TBLNAMENBU is not null and r.DLGNAME is null and
          m.TABNAME in ('PS','CODCAGENT','COUNTRY','FS','ISE',
                        'OE','VED','SPR_OBL','SPR_REG','SK')
    ORDER BY 1"
.head 4 -    Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Dialog Box: dlg_ImpOper
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов  из 'старого' БАРСа (BARS-3.01 ОДБ-БАРС 1.98.01)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.138"
.head 4 -  Top:    0.094"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.798"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Прием документов и оплата документов из 'старого' БАРСа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 35602
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 6452
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 6453
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.983"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow(dfBD)
.head 6 +  If IsBankDayOpen()
.head 7 -  Set sAn = dfAn
.head 7 +  If MessageQuestion('Прием/Оплата ' || IifS(nISOS=5, '', 'M') || 'OPER ' || sAn ||
   ' ?') = IDNO
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'OperPath', SalStrLeftX(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC.DSN\\OPER', sODBCDir, GetIniFileName())
.head 7 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPER' ||
     sAn)
.head 7 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SalFileGetDateTime(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPER' || sAn
   || '.dbf', dTmp)
.head 9 -  ! проверить, есть ли поле ref99bm в operxx, если нет, то добавить его
.head 9 -  Set n99 = -1
.head 9 -  Set dfDone = "Подождите ..."
.head 9 -  Call SalLoadAppAndWait("FindVar " || sODBCDir || '\\' || IifS(nISOS=5, '', 'M')
     || 'OPER' || sAn || " ref99bm", Window_NotVisible, n99)
.head 9 -  Set dfDone = ""
.head 9 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT DA
     FROM " || IifS(nISOS=5, '', 'm') || "oper" || sAn || "
     INTO :dTempDate")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 +  If dTempDate != dfBD
.head 11 -  Call SqlDisconnect(hSqlA)
.head 11 -  Call SqlDisconnect(hSqlB)
.head 11 -  Call MessageAttention(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPER'
     || sAn || '.dbf не за требуемую (текущую) дату. Выход.')
.head 11 -  Call SalEnableWindow(pbExit)
.head 11 -  Return FALSE
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM " || IifS(nISOS=5, '', 'm') || "oper" || sAn || "
     INTO :nRecCount")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  ! Call SalGetWindowText(hWndForm, sText, 100)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText || ' (' || Str(nRecCount) || ')')
.head 10 -  Call SalShowWindow(dfStart)
.head 10 -  Call SalShowWindow(dfEnd)
.head 10 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(SalDateCurrent())
.head 10 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 10 -  Set dfReccount = nRecCount
.head 10 -  Set dfCurrent = 0
.head 10 -  Set dfAll = 0
.head 10 -  Set nPos = 0
.head 10 -  Set nTek = 0
.head 10 -  Set nRecn = 1
.head 10 -  Set nDelta = 100 / nRecCount
.head 10 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM fdat
     WHERE fdat=:dfBD")
.head 10 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO fdat (fdat)
     VALUES (:dfBD)")
.head 10 +  If dfBD != dBat
.head 11 -  Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 10 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 10 -  Call SqlPrepare(hSqlA, "
     SELECT nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,vspo,kod,
            kodb,kisp,sign,ns,np,sos,ref99bm,vdate,kw
     INTO :nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,:dPat,:sPlat,
          :sPolu,:sNaz1,:sVspo,:sKod,:sKodB,:sKisp,:sSign,:NS,:nNp,:nSos,
          :nRef99bm,:dVdate,:nKw
     FROM " || IifS(nISOS=5, '', 'm') || "oper" || sAn || "
     FOR UPDATE OF sos")
.head 10 -  Call SqlOpen(hSqlA, IifS(nISOS=5, '', 'm') || "oper")
.head 10 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 11 -  Set sNls = SalStrTrimX(sNls)
.head 11 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 11 -  ! Перекодировка
.head 11 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 11 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 11 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 11 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 11 -  Set sVspo = SalStrTrimX(StrDosToWinX(sVspo))
.head 11 -  !
.head 11 -  Set sMfo = Str(nMfo)
.head 11 +  If dDat = DATETIME_Null
.head 12 -  Set dDat = dBat
.head 11 +  If dPat = DATETIME_Null
.head 12 -  Set dPat = dBat
.head 11 -  Set sKod  = SalStrTrimX(sKod)
.head 11 -  Set sKodB = SalStrTrimX(sKodB)
.head 11 -  Set lsSign = sSign
.head 11 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 11 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 11 -  Set tbl1.colNPP = nRecn
.head 11 -  Set tbl1.colND = sNd
.head 11 -  Set tbl1.colVOB = nVob
.head 11 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', GetBankMfo())
.head 11 -  Set tbl1.colNLSA = sNls
.head 11 -  Set tbl1.colNAMA = sPlat
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALA = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALA = 980
.head 11 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', IifS(nMfo=0, GetBankMfo(), sMfo))
.head 11 -  Set tbl1.colNLSB = sNlsk
.head 11 -  Set tbl1.colNAMB = sPolu
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALB = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALB = 980
.head 11 -  Set tbl1.colS = nS/100
.head 11 -  Set tbl1.colVDATE = dVdate
.head 11 -  Set tbl1.colNAZN = sNaz1
.head 11 -  Set tbl1.colREF98 = nRef99bm
.head 11 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 11 +  If Val(sNls) = 0
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 11 +  If (nNm = 1 or nNm = 2) and nSos = nISOS and nS > 0 and (not (nNp = 380 and nNm = 1 and
   (Left(sNls,4) = '3801' or Left(sNlsk,4) = '3801')) and not (nNp = 991 and nNm = 1 and
   (Left(sNls,4) = '1200' or Left(sNlsk,4) = '1200')))
.head 12 +  If nNm = 1
.head 13 -  Set sMfo = sBankMfo
.head 12 +  If sMfo = sBankMfo
.head 13 -  Set nNm = 1
.head 12 -  Set sTT = ''
.head 12 +  If nSk > 0
.head 13 -  Set sTmp = sNls
.head 13 -  Set sNls = sNlsk
.head 13 -  Set sNlsk = sTmp
.head 13 +  If not cbRevPP
.head 14 -  Set sTmp = sPolu
.head 14 -  Set sPolu = sPlat
.head 14 -  Set sPlat = sTmp
.head 13 +  If nDk = 1
.head 14 -  Set nDk = 0
.head 13 +  Else If nDk = 0
.head 14 -  Set nDk = 1
.head 13 -  Set nNm = nDk + 1085 ! добавлено для UPB и для всех остальных
.head 13 -  ! свежак
.head 13 +  If Len(sNLSKASSA) > 0
.head 14 -  Call SalArrayGetUpperBound(smNLSKASSA, 1, nI)
.head 14 -  Set nC = 0
.head 14 +  While nC <= nI
.head 15 +  If SalStrScan(sNlsk, smNLSKASSA[nC]) and Len(smDK0KASSA[nC]) = 3 and
   Len(smDK1KASSA[nC]) = 3
.head 16 -  Set sTT = IifS(nDk=1, smDK0KASSA[nC], smDK1KASSA[nC])
.head 16 -  Break
.head 15 -  Set nC = nC + 1
.head 12 +  Else
.head 13 -  Set nSk = NUMBER_Null
.head 13 +  If nDk = nKw
.head 14 -  Set nDk = nDk + 2
.head 12 +  If nNm = 2 and NS = 8
.head 13 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT nls
     INTO :sNls
     FROM accounts
     WHERE tip='90D'"))
.head 13 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 12 -  Set nRef = NUMBER_Null
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 12 +  If (Len(sTT) = 0 and Len(sNLSKASSA) > 0) or Len(sNLSKASSA) = 0
.head 13 -  Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', Str(nNm)), 3)
.head 12 +  If bNBU and (sTT = '085' or sTT = '086' or
   VisArrayFindString(smDK0KASSA, sTT) >= 0 or
   VisArrayFindString(smDK1KASSA, sTT) >= 0) and nISOS != 5 and
   SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO :nVOBtts
   FROM tts_vob
   WHERE tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 13 -  Set nVob = nVOBtts 
.head 13 -  Set tbl1.colVOB = nVob
.head 12 +  If bControlOKPO and (sKod = '' or sKod != V_Okpo(sKod) or sKodB = '' or
   sKodB != V_Okpo(sKodB))
.head 13 -  Call SalMessageBox('Документ на сумму ' || Str(nS) ||
     ' не принят. Отсутствует(ош) ОКРО А или ОКРО Б', 'Внимание', 0)
.head 12 -  ! Modify by ANNY 18-10-2001
.head 12 +  Else
.head 13 +  If nVob = 96 or nVob = 99
.head 14 -  ! Set dTemp = SalDateMonthBegin(dfBD)-1
.head 14 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD),
    SalDateYearBegin(dfBD)) - 1
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO :dValu
     FROM fdat
     WHERE fdat<=:dTemp")
.head 14 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 15 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 15 -  Set dValu = dTemp
.head 14 +  If dValu = DATETIME_Null
.head 15 -  Set dValu = dTemp
.head 14 +  ! If dValu != dfBD
.head 15 -    Call Pl_dat(dValu) ! Установить банковскую дату
.head 13 +  Else
.head 14 -  Set dValu = dfBD
.head 13 -  Call ccDoc.SetDoc(0, sTT, nDk, nVob, sNd, dDat, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '', 980, nS,
     sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, GetIdOper(), '', nSk, 0)
.head 13 -  Set dfAll = dfAll + 1
.head 13 +  If ccDoc.oDoc() 
.head 14 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || IifS(nISOS=5, '', 'm') || "oper" || sAn || "
   SET sos=9
   WHERE CURRENT OF " || IifS(nISOS=5, '', 'm') || "oper")
.head 15 -  Call SqlCommit(hSql())
.head 15 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 15 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 15 -  Set tbl1.colTT = sTT
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 15 -  Set dfCurrent = dfCurrent + 1
.head 15 +  If n99 = 0
.head 16 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || IifS(nISOS=5, '', 'm') || "oper" || sAn || "
     SET sos=9,ref99bm=:ccDoc.m_nRef
     WHERE CURRENT OF " || IifS(nISOS=5, '', 'm') || "oper")
.head 14 +  Else
.head 15 -  Call SqlRollback(hSql())
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 11 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Set nRecn = nRecn + 1
.head 11 +  If Int(nPos) != nTek
.head 12 -  Set nTek = Int(nPos)
.head 12 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 12 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 12 -  ! Call Debug('nPos=' || Str(nPos) || ', nTimeStart=' || Str(nTimeStart) ||
    ', nTimeEnd=' || Str(nTimeEnd))
.head 12 -  Set nHour = Int(nTimeEnd/3600)
.head 12 -  Set nTemp = nTimeEnd - nHour*3600
.head 12 -  Set nMinu = Int(nTemp/60)
.head 12 -  Set dfStart = dfStart
.head 12 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 12 -  Set dfReccount = dfReccount
.head 12 -  Set dfCurrent = dfCurrent
.head 12 -  Set dfAll = dfAll
.head 11 -  Call ccProgressBar.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 10 -  ! Set dfCurrent = NUMBER_Null
.head 10 -  Call ccProgressBar.SetProgress(100)
.head 10 -  Call SqlCommitEx(hSql(), 'OK')
.head 10 -  Call SqlCommit(hSqlB)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlB)
.head 10 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPER'
     || sAn || ' ОКОНЧЕН')
.head 10 -  Set dfDone = "Готово"
.head 10 -  Set dfEnd = Left(dfEnd, 15)
.head 10 +  If dfCurrent > 0
.head 11 -  ! сформировать файл оплаченных документов
.head 11 -  Set nCurrentRow = TBL_MinRow
.head 11 -  Set nP = 1
.head 11 -  Set nItog = 0
.head 11 -  Set sFr = GetPrnDir() || '\\' || IifS(nISOS=5, 'O', 'M') || 'O' || Right(Str(SalDateMonth(dBat)+100), 2) ||
    Right(Str(SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || '.' || Right(
    Str(SalDateMinute(SalDateCurrent())+100), 2)
.head 11 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 11 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(GetBankMfo()) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') || Right('0' ||
    SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() || Spac(15) ||
    'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || IifS(nISOS=5, '', 'M') ||
    'OPER) сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 12 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 12 -  Set nColor = SalColorGet(tbl1.colNLSA,
    COLOR_IndexCellText)
.head 12 +  If nColor = COLOR_DarkGreen
.head 13 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' ||
    SalStrTrimX(tbl1.colND) || ', оп.' || Str(tbl1.colVOB)
.head 13 -  Set sBuff = PadR(Str(nP) || '.', 4) || GetBankMfo() || ' ' ||
    PadR(tbl1.colNLSA || '(' || Right(Str(tbl1.colVALA+1000), 3) ||
    ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA) || PutCrLf() ||
    '    ' || IifS(Val(tbl1.colMFOB)=0, GetBankMfo(), tbl1.colMFOB) ||
    ' ' || PadR(tbl1.colNLSB || '(' || Right(Str(tbl1.colVALB+1000), 3)
    || ')', 20) || SalStrTrimX(tbl1.colNAMB) || PutCrLf() || sLev ||
    PadL('сумма ' || SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) ||
    PutCrLf() || Perenos(tbl1.colNAZN, 65, 4)) || PutCrLf()
.head 13 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 13 -  Set nP = nP + 1
.head 13 -  Set nItog = nItog + tbl1.colS
.head 11 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) || 'На сумму:')
    || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(PutCrLf(), 3)
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 -  Call SalFileClose(hF)
.head 10 -  Call SalMessageBeep(-1)
.head 10 +  If dfAll > dfCurrent
.head 11 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны не ВСЕ выбранные документы. ' ||
     'Примите меры для исправления ошибок.', 'Строгое предупреждение', 0, 1)
.head 10 +  Else
.head 11 +  If bNBU and nISOS !=5
.head 12 -  ! удалить MOPER для НБУ только
.head 12 +  If not MessageNoWait('Файл ' || sODBCDir || '\\MOPER' || sAn ||
   '.dbf будет удален (если Вы не закроете это окно, нажав клавишу ESC) ' || '!!!', 'ВНИМАНИЕ !!!', 60, 0)
! не нажималось ESC
.head 13 -  Call VisFileDelete(sODBCDir || '\\MOPER' || sAn || '.dbf')
.head 10 -  Call SalSetFocus(tbl1)
.head 10 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText)
.head 10 -  Call SalDisableWindow(pbExecute)
.head 9 +  Else
.head 10 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 8 +  Else
.head 9 -  Call MessageAttention('Нет файла: ' || sODBCDir || '\\' ||
     IifS(nISOS=5, '', 'M') || 'OPER' || sAn ||
     '.dbf или он занят другим пользователем.')
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 7 -  ! Call SalEnableWindow(pbExecute)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.383"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 29213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.738"
.head 5 -  Width:  12.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    5.762"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    6.012"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.317"
.head 6 -  Top:    5.81"
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    5.845"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  10.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзакция
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow(tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Data Field: dfOPER
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    5.845"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !',
     'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Pushbutton: pbBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.321"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 3 +  Check Box: cbRevPP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Не переворачивать Плательщика и Получателя для кассовых документов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.217"
.head 5 -  Top:    6.143"
.head 5 -  Width:  6.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nISOS
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  String: ND
.head 3 -  String: NLS
.head 3 -  String: NLSK
.head 3 -  Number: KVS
.head 3 -  Number: SK
.head 3 -  Number: REF
.head 3 -  Number: ISV
.head 3 -  String: NAZN
.head 3 -  String: sTmp
.head 3 -  Number: nCount
.head 3 -  Number: NS
.head 3 -  String: sAn
.head 3 -  String: sNbw
.head 3 -  Number: nNls
.head 3 -  String: sMfo
.head 3 -  String: sMdl
.head 3 -  Number: nMfop
.head 3 -  Number: nFetchRes
.head 3 -  String: sBlk
.head 3 -  String: sFv
.head 3 -  String: sFs
.head 3 -  String: sBankDay
.head 3 -  String: sBankMfo
.head 3 -  Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dPat
.head 3 -  Date/Time: dBat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  String: sKod
.head 3 -  String: sKodB
.head 3 -  String: sKisp
.head 3 -  String: sSign
.head 3 -  Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNp
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sTT
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 3 -  !
.head 3 -  Boolean: bNBU
.head 3 -  Number: nVOBtts
.head 3 -  !
.head 3 -  Number: nKw
.head 3 -  !
.head 3 -  String: sTemp
.head 3 -  Number: n3
.head 3 -  Number: nC
.head 3 -  Number: nI
.head 3 -  String: sNLSKASSA
.head 3 -  String: smNLSKASSA[*]
.head 3 -  String: smDK0KASSA[*]
.head 3 -  String: smDK1KASSA[*]
.head 3 -  !
.head 3 -  String: sControlOKPO
.head 3 -  Boolean: bControlOKPO
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set cbRevPP = FALSE
.head 4 -  Call WaitCursorOn()
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set dfOPER = IifS(nISOS=5, '', 'M') || 'OPER'
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set bNBU = GetGlobalOption('NBUBANK')='1'
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'ControlOKPO', '1', sControlOKPO, GetIniFileName())
.head 4 -  Set bControlOKPO = Val(sControlOKPO)>0
.head 4 -  Call SalGetProfileString('Import', 'NLSKASSA', '', sNLSKASSA, GetIniFileName())
.head 4 -  Call SalArraySetUpperBound(smNLSKASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK0KASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK1KASSA, 1, -1)
.head 4 -  Set sTemp = sNLSKASSA
.head 4 +  If Len(sTemp) > 0
.head 5 -  Set n3 = 0
.head 5 -  Set nC = 0
.head 5 +  Loop
.head 6 -  Set nI = At(',', sTemp)
.head 6 +  If nI = 0
.head 7 +  If Len(sTemp) > 0
.head 8 +  If n3 = 0
.head 9 -  Set smNLSKASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK0KASSA[nC] = ''
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else If n3 = 1
.head 9 -  Set smDK0KASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else
.head 9 -  Set smDK1KASSA[nC] = SalStrTrimX(sTemp)
.head 7 -  Break
.head 6 +  If n3 = 0
.head 7 -  Set smNLSKASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else If n3 = 1
.head 7 -  Set smDK0KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else
.head 7 -  Set smDK1KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 -  Set n3 = n3 + 1
.head 6 +  If n3 = 3
.head 7 -  Set nC = nC + 1
.head 7 -  Set n3 = 0
.head 6 -  Set sTemp = Right(sTemp, Len(sTemp)-nI)
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call Pl_dat(dBat)
.head 4 -  ! Disactivation of function's role, which activated for
  calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ImpOper(hWndMDI, ' || IifS(nISOS=5,
     '', '1') || '0)')
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_ImpOperNB
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов  из 'старого' БАРСа (BARS-3.01 ОДБ-БАРС 1.98.01)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.138"
.head 4 -  Top:    0.094"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.607"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Прием документов и оплата
внебалансовых документов из 'старого' БАРСа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 35607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 35603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 35604
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.383"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If IsBankDayOpen()
.head 7 -  Set sAn = dfAn
.head 7 +  If MessageQuestion('Прием/Оплата ' || IifS(nISOS=5, '', 'M') || 'OPERNB ' || sAn ||
   ' ?') = IDNO
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'OperNBPath', SalStrLeftX(SalFileGetDrive(), 1)
     || ':\\BARS98\\ODBC.DSN\\OPER', sODBCDir, GetIniFileName())
.head 7 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPERNB' ||
     sAn)
.head 7 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SalFileGetDateTime(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERNB' ||
   sAn || '.dbf', dTmp)
.head 9 -  ! проверить, есть ли поле ref99bm в operxx если нет, то добавить его
.head 9 -  Set n99 = -1
.head 9 -  Set dfDone = "Подождите ..."
.head 9 -  Call SalLoadAppAndWait("FindVar " || sODBCDir || '\\' || IifS(nISOS=5, '', 'M')
     || 'OPERNB' || sAn || " ref99bm", Window_NotVisible, n99)
.head 9 -  Set dfDone = ""
.head 9 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT VDATE
     FROM " || IifS(nISOS=5, '', 'm') || "opernb" || sAn || "
     INTO :dTempDate")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 +  If dTempDate != dfBD
.head 11 -  Call SqlDisconnect(hSqlA)
.head 11 -  Call SqlDisconnect(hSqlB)
.head 11 -  Call MessageAttention(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERNB' || sAn ||
     '.dbf не за требуемую (текущую) дату. Выход.')
.head 11 -  Return FALSE
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM " || IifS(nISOS=5, '', 'm') || "opernb" || sAn || "
     INTO :nRecCount")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  ! Call SalGetWindowText(hWndForm, sText, 100)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText || ' (' || Str(nRecCount) || ')')
.head 10 -  Call SalShowWindow(dfStart)
.head 10 -  Call SalShowWindow(dfEnd)
.head 10 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(SalDateCurrent())
.head 10 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 10 -  Set dfReccount = nRecCount
.head 10 -  Set dfCurrent = 0
.head 10 -  Set dfAll = 0
.head 10 -  Set nPos = 0
.head 10 -  Set nTek = 0
.head 10 -  Set nRecn = 1
.head 10 -  Set nDelta = 100 / nRecCount
.head 10 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM fdat
     WHERE fdat=:dfBD")
.head 10 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dfBD)")
.head 10 +  If dfBD != dBat
.head 11 -  Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 10 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 10 -  Call SqlPrepare(hSqlA, "
     SELECT nd,nbsd,nbsk,s,nazn,kv,sos,ref99bm,vdate,vob
     INTO :sNd,:sNls,:sNlsk,:nS,:sNaz1,:nKv,:nSos,:nRef99bm,:dVdate,:nVob
     FROM " || IifS(nISOS=5, '', 'm') || "opernb" || sAn || "
     FOR UPDATE OF sos")
.head 10 -  Call SqlOpen(hSqlA, IifS(nISOS=5, '', 'm') || "opernb")
.head 10 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 11 +  If nKv = 0 or nKv = NUMBER_Null
.head 12 -  Set nKv = 980
.head 11 -  Set sNls = SalStrTrimX(sNls)
.head 11 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 11 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 11 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 11 -  Set sMfo = sBankMfo
.head 11 -  Set sDatP = sDatA
.head 11 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 11 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 11 -  Set tbl1.colNPP = nRecn
.head 11 -  Set tbl1.colND = sNd
.head 11 -  Set tbl1.colVOB = nVob
.head 11 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', sBankMfo)
.head 11 -  Set tbl1.colNLSA = sNls
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALA = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALA = nKv
.head 11 -  Set tbl1.colNAMA = ''
.head 11 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', sBankMfo)
.head 11 -  Set tbl1.colNLSB = sNlsk
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALB = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALB = nKv
.head 11 -  Set tbl1.colNAMB = ''
.head 11 -  Set tbl1.colS = nS/100
.head 11 -  Set tbl1.colVDATE = dVdate
.head 11 -  Set tbl1.colNAZN = sNaz1
.head 11 -  Set tbl1.colREF98 = nRef99bm
.head 11 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 11 +  If Val(sNls) = 0
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 11 +  If nSos = nISOS and nS > 0 and Val(sNls) > 0
.head 12 -  Set nRef = NUMBER_Null
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 12 +  If nVob = 96 or nVob = 99
.head 13 -  ! Set dTemp = SalDateMonthBegin(dfBD)-1
.head 13 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD),
    SalDateYearBegin(dfBD)) - 1
.head 13 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     INTO :dValu
     FROM fdat
     WHERE fdat<=:dTemp")
.head 13 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 14 -  Set dValu = dTemp
.head 13 +  If dValu != dfBD
.head 14 -  Call Pl_dat(dValu) ! Установить банковскую дату
.head 12 +  Else
.head 13 -  Set dValu = dfBD
.head 12 -  Call ccDoc.SetDoc(0, 'VMO', 1, nVob, sNd, dValu, dValu, dValu, dValu,
     sNls, '', sBankMfo, '', nKv, nS, '', sNlsk, '', sBankMfo, '', nKv,
     nS, '', sNaz1, '', '', '', 0, 0)
.head 12 +  If ccDoc.oDoc()
.head 13 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || IifS(nISOS=5, '', 'm') || "opernb" || sAn || "
   SET sos=9
   WHERE CURRENT OF " || IifS(nISOS=5, '', 'm') || "opernb")
.head 14 -  Call SqlCommit(hSql())
.head 14 -  Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 14 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 14 -  Set tbl1.colTT = 'VMO'
.head 14 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 14 -  Set dfCurrent = dfCurrent + 1
.head 14 +  If n99 = 0
.head 15 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || IifS(nISOS=5, '', 'm') || "opernb" || sAn || "
     SET sos=9,ref99bm=:ccDoc.m_nRef
     WHERE CURRENT OF " || IifS(nISOS=5, '', 'm') || "opernb")
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 12 +  Else
.head 13 -  Call SqlRollback(hSql())
.head 12 -  Set dfAll = dfAll + 1
.head 11 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Set nRecn = nRecn + 1
.head 11 +  If Int(nPos) != nTek
.head 12 -  Set nTek = Int(nPos)
.head 12 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 12 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 12 -  ! Call Debug('nPos=' || Str(nPos) || ', nTimeStart=' || Str(nTimeStart) || ', nTimeEnd=' || Str(nTimeEnd))
.head 12 -  Set nHour = Int(nTimeEnd/3600)
.head 12 -  Set nTemp = nTimeEnd - nHour*3600
.head 12 -  Set nMinu = Int(nTemp/60)
.head 12 -  Set dfStart = dfStart
.head 12 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 12 -  Set dfReccount = dfReccount
.head 12 -  Set dfCurrent = dfCurrent
.head 12 -  Set dfAll = dfAll
.head 11 -  Call ccProgressBar.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Call ccProgressBar.SetProgress(100)
.head 10 -  Call SqlCommitEx(hSql(), 'OK')
.head 10 -  Call SqlCommit(hSqlB)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlB)
.head 10 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPERNB' || sAn || ' ОКОНЧЕН')
.head 10 -  Set dfDone = "Готово"
.head 10 -  Set dfEnd = Left(dfEnd, 15)
.head 10 +  If dfCurrent > 0
.head 11 -  ! сформировать файл оплаченных документов
.head 11 -  Set nCurrentRow = TBL_MinRow
.head 11 -  Set nP = 1
.head 11 -  Set nItog = 0
.head 11 -  Set sFr = GetPrnDir() || '\\' || IifS(nISOS=5, 'O', 'M') || 'N' || Right(Str(SalDateMonth(dBat)+100), 2) ||
    Right(Str(SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || '.' || Right(
    Str(SalDateMinute(SalDateCurrent())+100), 2)
.head 11 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 11 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(GetBankMfo()) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') || Right('0' ||
    SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() || Spac(15) ||
    'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || IifS(nISOS=5, '', 'M') ||
    'OPERNB) сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 12 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 12 -  Set nColor = SalColorGet(tbl1.colNLSA,
    COLOR_IndexCellText)
.head 12 +  If nColor = COLOR_DarkGreen
.head 13 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' ||
    SalStrTrimX(tbl1.colND) || ', оп.' || Str(tbl1.colVOB)
.head 13 -  Set sBuff = PadR(Str(nP) || '.', 4) || GetBankMfo() || ' ' || IifS(
    Len(tbl1.colNAMA)=0, tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', PadR(tbl1.colNLSA || '(' ||
    Right(Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(
    SalStrTrimX(tbl1.colNAMA))) || PutCrLf() || '    ' || IifS(
    Val(tbl1.colMFOB)=0, GetBankMfo(), tbl1.colMFOB) || ' ' || IifS(
    Len(tbl1.colNAMB)=0, tbl1.colNLSB || '(' || Right(
    Str(tbl1.colVALB+1000), 3) || ')', PadR(tbl1.colNLSB || '(' ||
    Right(Str(tbl1.colVALB+1000), 3) || ')', 20) || StrWinToDosX(
    SalStrTrimX(tbl1.colNAMB))) || PutCrLf() || StrWinToDosX(sLev ||
    PadL('сумма ' || SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) ||
    PutCrLf() || Perenos(tbl1.colNAZN, 65, 4)) || PutCrLf()
.head 13 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 13 -  Set nP = nP + 1
.head 13 -  Set nItog = nItog + tbl1.colS
.head 11 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' ||
    PadR(Str(nP-1), 20) || 'На сумму:') || PadL(
    SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(
    PutCrLf(), 3)
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 -  Call SalFileClose(hF)
.head 10 -  Call SalMessageBeep(-1)
.head 10 +  If dfAll > dfCurrent
.head 11 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны не ВСЕ выбранные документы. ' ||
     'Примите меры для исправления ошибок.', 'Строгое предупреждение', 0, 1)
.head 10 -  Call SalSetFocus(tbl1)
.head 10 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText)
.head 10 -  Call SalDisableWindow(pbExecute)
.head 9 +  Else
.head 10 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 8 +  Else
.head 9 -  Call MessageAttention('Нет файла: ' || sODBCDir || '\\' ||
     IifS(nISOS=5, '', 'M') || 'OPERNB' || sAn ||
     '.dbf или он занят другим пользователем.')
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 7 -  ! Call SalEnableWindow(pbExecute)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.383"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 35605
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.738"
.head 5 -  Width:  12.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.512"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    5.762"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    6.012"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.617"
.head 6 -  Top:    5.81"
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.383"
.head 6 -  Top:    5.845"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзакция
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow(tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Data Field: dfOPERNB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    5.845"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !',
     'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Pushbutton: pbBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.083"
.head 5 -  Top:    5.321"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nISOS
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  String: ND
.head 3 -  String: NLS
.head 3 -  String: NLSK
.head 3 -  Number: KVS
.head 3 -  Number: SK
.head 3 -  Number: nKv
.head 3 -  Number: nKvD
.head 3 -  Number: nKvK
.head 3 -  Number: REF
.head 3 -  Number: ISV
.head 3 -  String: NAZN
.head 3 -  String: sTmp
.head 3 -  Number: nCount
.head 3 -  String: sAn
.head 3 -  String: sNbw
.head 3 -  Number: nNls
.head 3 -  String: sMfo
.head 3 -  String: sMdl
.head 3 -  Number: nMfop
.head 3 -  ! Number: nFetchRes
.head 3 -  String: sBlk
.head 3 -  String: sFv
.head 3 -  String: sFs
.head 3 -  String: sBankDay
.head 3 -  String: sBankMfo
.head 3 -  Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Number: nS1
.head 3 -  Number: SD1
.head 3 -  Number: SK1
.head 3 -  Date/Time: dBat
.head 3 -  Date/Time: dPat
.head 3 -  String: sDatA
.head 3 -  String: sDatP
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  String: sKod
.head 3 -  String: sKisp
.head 3 -  ! String: sSign
.head 3 -  ! Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNd
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sTT
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set dfOPERNB = IifS(nISOS=5, '', 'M') || 'OPERNB'
.head 4 -  Set sDatA = SalFmtFormatDateTime(GetBankDate(), 'MM/dd/yyyy')
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call Pl_dat(dBat)
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -    Call XRoleUnset(hSql(), 'ImpOper(hWndMDI, ' || IifS(nISOS=5, '', '1') || '2)')
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_ImpOperV
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов  из 'старого' БАРСа (BARS-3.01 ОДБ-БАРС 1.98.01) вал
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.038"
.head 4 -  Top:    0.354"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.786"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Прием документов и оплата "валютных" документов из 'старого' БАРСа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 30472
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 30473
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 30474
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.3"
.head 5 -  Top:    6.06"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow(dfBD)
.head 6 +  If IsBankDayOpen()
.head 7 -  Set sAn = dfAn
.head 7 +  If MessageQuestion('Прием/Оплата ' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn || ' ?') = IDNO
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'OperVPath', SalStrLeftX(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\OPER',
     sODBCDir, GetIniFileName())
.head 7 -  ! разбор параметра описания транзакций
.head 7 -  Call SalGetProfileString('Import', IifS(nISOS=5, 'O', 'Mo') || 'perVTTS', '', sTTSi, GetIniFileName())
.head 7 -  Call SalGetProfileString('Import', IifS(nISOS=5, 'O', 'Mo') || 'perVTTV', '', sTTSv, GetIniFileName())
.head 7 -  Call SalArraySetUpperBound(smNT, 1, -1)
.head 7 -  Call SalArraySetUpperBound(smNO, 1, -1)
.head 7 -  Call SalArraySetUpperBound(smTT, 1, -1)
.head 7 -  Set sTemp = ''
.head 7 +  If Len(sTTSi) > 0
.head 8 -  Set sTemp = sTTSi
.head 7 +  Else If Len(sTTSv) > 0
.head 8 -  Set sTemp = sTTSv
.head 7 +  If Len(sTemp) > 0
.head 8 -  Set n3 = 0
.head 8 -  Set nC = 0
.head 8 +  Loop
.head 9 -  Set nI = At(',', sTemp)
.head 9 +  If nI = 0
.head 10 +  If Len(sTemp) > 0
.head 11 +  If n3 = 0
.head 12 -  Set smNT[nC] = SalStrTrimX(sTemp)
.head 12 -  Set smNO[nC] = ''
.head 12 -  Set smTT[nC] = ''
.head 12 -  ! Call Debug(Str(nC) || Str(n3) || ' ' || smNT[nC])
.head 11 +  Else If n3 = 1
.head 12 -  Set smNO[nC] = SalStrTrimX(sTemp)
.head 12 -  Set smTT[nC] = ''
.head 12 -  ! Call Debug(Str(nC) || Str(n3) || ' '|| smNO[nC])
.head 11 +  Else
.head 12 -  Set smTT[nC] = SalStrTrimX(sTemp)
.head 12 -  ! Call Debug(Str(nC) || Str(n3) || ' '|| smTT[nC])
.head 10 -  Break
.head 9 +  If n3 = 0
.head 10 -  Set smNT[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 10 -  ! Call Debug(Str(nC) || Str(n3) || ' '|| smNT[nC])
.head 9 +  Else If n3 = 1
.head 10 -  Set smNO[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 10 -  ! Call Debug(Str(nC) || Str(n3) || ' '|| smNO[nC])
.head 9 +  Else
.head 10 -  Set smTT[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 10 -  ! Call Debug(Str(nC) || Str(n3) || ' '|| smTT[nC])
.head 9 -  Set n3 = n3 + 1
.head 9 +  If n3 = 3
.head 10 -  Set nC = nC + 1
.head 10 -  Set n3 = 0
.head 9 -  Set sTemp = Right(sTemp, Len(sTemp)-nI)
.head 7 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn)
.head 7 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SalFileGetDateTime(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn || '.dbf', dTmp)
.head 9 -  ! проверить, есть ли поле ref99bm в operxx если нет, то добавить его
.head 9 -  Set n99 = -1
.head 9 -  Set dfDone = "Подождите ..."
.head 9 -  Call SalLoadAppAndWait("FindVar " || sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn || " ref99bm",
     Window_NotVisible, n99)
.head 9 -  Set dfDone = ""
.head 9 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 10 +  If File(sODBCDir || '\\S1S2.dbf')
.head 11 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT S2
     FROM   s1s2
     INTO   :nS2")
.head 11 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 11 -  ! Set bS1S2 = SalDateConstruct((nS2-Mod(nS2, 10000))/10000, Mod((nS2-Mod(nS2, 100))/100,100), Mod(nS2, 100),
    0, 0, 0) = dBat
.head 11 -  Set bS1S2 = SalFmtFormatStrDateTime(Str(nS2), 'yyyyMMdd') = dBat
.head 10 +  Else
.head 11 -  Set bS1S2 = FALSE
.head 10 +  If bS1S2
.head 11 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT REF,S2
     FROM   s1s2
     INTO   :nREFO,:nS2")
.head 11 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 11 -  Set nIs2 = 0
.head 11 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 12 -  Set nmREF[nIs2] = nREFO
.head 12 -  Set nmS2[nIs2] = nS2
.head 12 -  Set nIs2 = nIs2 + 1
.head 11 -  ! Call MessageNoWait('Lines=' || SalStrTrimX(Str(nIs2)), 'S1S2 exist and Ok', 3, 0)
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT VDATE
     FROM   " || IifS(nISOS=5, '', 'm') || "operv" || sAn || "
     INTO   :dTempDate")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 +  If dTempDate != dfBD
.head 11 -  Call SqlDisconnect(hSqlA)
.head 11 -  Call SqlDisconnect(hSqlB)
.head 11 -  Call MessageAttention(sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn ||
     '.dbf не за требуемую (текущую) дату. Выход.')
.head 11 -  Return FALSE
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM   " || IifS(nISOS=5, '', 'm') || "operv" || sAn || "
     INTO   :nRecCount")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  ! Call SalGetWindowText(hWndForm, sText, 100)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText || ' (' || Str(nRecCount) || ')')
.head 10 -  Call SalShowWindow(dfStart)
.head 10 -  Call SalShowWindow(dfEnd)
.head 10 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 10 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 10 -  Set dfReccount = nRecCount
.head 10 -  Set dfCurrent = 0
.head 10 -  Set dfAll = 0
.head 10 -  Set nPos = 0
.head 10 -  Set nTek = 0
.head 10 -  Set nRecn = 1
.head 10 -  Set nDelta = 100 / nRecCount
.head 10 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM   fdat
     WHERE  fdat=:dfBD")
.head 10 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dfBD)")
.head 10 +  If dfBD != dBat
.head 11 -  Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 10 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 10 -  Set n99r = Mod(n99, 16)
.head 10 -  Set n99a = n99r
.head 10 -  ! Call DebugN(n99)
.head 10 -  ! Call DebugN(n99a)
.head 10 -  Set dfText = ''
.head 10 +  If VisNumberBitClear(n99a, 1) != n99r
.head 11 -  Set dfText = dfText || ' отсутствует ОКПО-А (KODA)'
.head 10 -  Set n99a = n99r
.head 10 +  If VisNumberBitClear(n99a, 2) != n99r
.head 11 -  Set dfText = dfText || ' отсутствует ОКПО-Б (KODB)'
.head 10 -  Set n99a = n99r
.head 10 +  If VisNumberBitClear(n99a, 4) != n99r
.head 11 -  Set dfText = dfText || ' отсутствует наим.А (PLAT)'
.head 10 -  Set n99a = n99r
.head 10 +  If VisNumberBitClear(n99a, 8) != n99r
.head 11 -  Set dfText = dfText || ' отсутствует наим.Б (POLU)'
.head 10 +  If Len(dfText) = 0
.head 11 -  Call SqlPrepare(hSqlA, "
     SELECT nd,nls,nlsk,isv,nazn,kvS,kvD,kvK,isr,sk,nlst,nlso,kod_s,kod_n,kod_b,ref,sos,ref99bm,vdate,vob,
            koda,kodb,plat,polu
     INTO   :nNd,:sNls,:sNlsk,:nS,:sNaz1,:nKv,:nKvD,:nKvK,:nS1,:nSk,:sNLST,:sNLSO,:sKod_G,:sKod_N,:sKod_B,
            :nRefOperv,:nSos,:nRef99bm,:dVdate,:nVob,:sKoda,:sKodb,:sPlat,:sPolu
     FROM   " || IifS(nISOS=5, '', 'M') || "operv" || sAn || "
     FOR UPDATE OF sos")
.head 10 +  Else
.head 11 -  Set sKoda = ''
.head 11 -  Set sKodb = ''
.head 11 -  Set sPlat = ''
.head 11 -  Set sPolu = ''
.head 11 -  Call SqlPrepare(hSqlA, "
     SELECT nd,nls,nlsk,isv,nazn,kvS,kvD,kvK,isr,sk,nlst,nlso,kod_s,kod_n,kod_b,ref,sos,ref99bm,vdate,vob
     INTO   :nNd,:sNls,:sNlsk,:nS,:sNaz1,:nKv,:nKvD,:nKvK,:nS1,:nSk,:sNLST,:sNLSO,:sKod_G,:sKod_N,:sKod_B,
            :nRefOperv,:nSos,:nRef99bm,:dVdate,:nVob
     FROM   " || IifS(nISOS=5, '', 'M') || "operv" || sAn || "
     FOR UPDATE OF sos")
.head 10 -  Call SqlOpen(hSqlA, IifS(nISOS=5, '', 'm') || "operv")
.head 10 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 11 -  Set nKvD = IifN(nKvD=NUMBER_Null, 0, nKvD)
.head 11 -  Set nKvK = IifN(nKvK=NUMBER_Null, 0, nKvK)
.head 11 -  Set sNLST = SalStrTrimX(sNLST)
.head 11 -  Set sNLSO = SalStrTrimX(sNLSO)
.head 11 -  Set sNls = SalStrTrimX(sNls)
.head 11 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 11 -  Set sNd = SalNumberToStrX(nNd, 0)
.head 11 -  Set sNaz1 = SalStrLeftX(SalStrTrimX(StrDosToWinX(sNaz1)), 160)
.head 11 -  Set sPlat = SalStrLeftX(SalStrTrimX(StrDosToWinX(sPlat)), 38)
.head 11 -  Set sPolu = SalStrLeftX(SalStrTrimX(StrDosToWinX(sPolu)), 38)
.head 11 -  Set sMfo = sBankMfo
.head 11 -  Set sDatP = sDatA
.head 11 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 11 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 11 -  Set tbl1.colNPP = nRecn
.head 11 -  Set tbl1.colND = sNd
.head 11 -  Set tbl1.colVOB = nVob
.head 11 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', sBankMfo)
.head 11 -  Set tbl1.colNLSA = sNls
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALA = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALA = IifN(nKvD=0, 980, nKvD)
.head 11 -  Set tbl1.colNAMA = ''
.head 11 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', sBankMfo)
.head 11 -  Set tbl1.colNLSB = sNlsk
.head 11 +  If Val(sNls) = 0
.head 12 -  Set tbl1.colVALB = NUMBER_Null
.head 11 +  Else
.head 12 -  Set tbl1.colVALB = IifN(nKvK=0, 980, nKvK)
.head 11 -  Set tbl1.colNAMB = ''
.head 11 -  Set tbl1.colS = nS / 100
.head 11 -  Set tbl1.colSE = nS1 / 100
.head 11 -  Set tbl1.colVDATE = dVdate
.head 11 -  Set tbl1.colNAZN = sNaz1
.head 11 -  Set tbl1.colREF98 = nRef99bm
.head 11 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 11 +  If Val(sNls) = 0
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 11 +  If nSos = nISOS and nS > 0 and Val(sNls) > 0
.head 12 -  Set nDk = 1
.head 12 -  Set nRef = NUMBER_Null
.head 12 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 12 +  If nKvD != nKvK ! разновалютная
.head 13 +  If nKvK = 0
.head 14 -  Set nKvK = 980
.head 14 -  Set SD1 = nS
.head 14 -  Set SK1 = nS1
.head 13 +  Else If nKvD = 0
.head 14 -  Set nDk = 0
.head 14 -  Set nKvK = 980
.head 14 -  Set nKvD = nKv
.head 14 -  Set SK1 = nS1
.head 14 -  Set SD1 = nS
.head 14 -  Set sTmp = sNls
.head 14 -  Set sNls = sNlsk
.head 14 -  Set sNlsk = sTmp
.head 13 +  Else
.head 14 +  If nKvD = nKv
.head 15 -  Set SD1 = nS
.head 15 -  Set SK1 = -1
.head 15 +  If bS1S2 and nIs2 > 0
.head 16 -  Set n12 = 0
.head 16 +  While n12 < nIs2
.head 17 +  If nmREF[n12] = nRefOperv
.head 18 -  Set SK1 = nmS2[n12]
.head 18 -  ! Call Debug('SK1=' || Str(SK1))
.head 18 -  Break
.head 17 -  Set n12 = n12 + 1
.head 15 +  If SK1 = -1
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT gl.p_Ncurval(:nKvK,:nS1,:dBat)
     INTO   :SK1
     FROM   dk
     WHERE  dk=1"))
.head 16 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 14 +  Else
.head 15 -  Set SK1 = nS
.head 15 -  Set SD1 = -1
.head 15 +  If bS1S2 and nIs2 > 0
.head 16 -  Set n12 = 0
.head 16 +  While n12 < nIs2
.head 17 +  If nmREF[n12] = nRefOperv
.head 18 -  Set SD1 = nmS2[n12]
.head 18 -  ! Call Debug('SD1=' || Str(SD1))
.head 18 -  Break
.head 17 -  Set n12 = n12 + 1
.head 15 +  If SD1 = -1
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT gl.p_Ncurval(:nKvD,:nS1,:dBat)
     INTO   :SD1
     FROM   dk
     WHERE  dk=1"))
.head 16 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 13 +  ! If sNLST = '380062' ! ТОЛЬКО ДЛЯ АЖИО
.head 14 -  Set sTT = 'VM2'
.head 13 +  ! Else If sNLST = '380091'
.head 14 -  Set sTT = 'VM3'
.head 13 +  ! Else
.head 14 -  Set sTT = 'VM1'
.head 13 -  Set sTT = 'VM1'
.head 13 +  If Len(sTTSi) > 0
.head 14 -  Call SalArrayGetUpperBound(smTT, 1, nI)
.head 14 -  Set nC = 0
.head 14 +  While nC <= nI
.head 15 +  If sNLST = smNT[nC] and sNLSO = smNO[nC] and Len(smTT[nC]) = 3
.head 16 -  Set sTT = smTT[nC]
.head 16 -  Break
.head 15 -  Set nC = nC + 1
.head 13 +  Else If Len(sTTSv) > 0
.head 14 -  Call SalArrayGetUpperBound(smTT, 1, nI)
.head 14 -  Set nC = 0
.head 14 +  While nC <= nI
.head 15 +  If ((nDk = 1 and Left(smNT[nC], 1) = '?' and Val(smNO[nC]) = 0) or (nDk = 0 and
   Val(smNT[nC]) = 0 and Left(smNO[nC], 1) = '?')) and Len(smTT[nC]) = 3
.head 16 -  Set sTT = smTT[nC]
.head 16 -  Break
.head 15 -  Set nC = nC + 1
.head 13 -  ! ВМЕСТО закомментареного выше в Ini-файл в секцию [IMPORT] добавлены параметры:
  для OPERV  - OperVTTS
  для MOPERV - MoperVTTS
  для OPERV  - OperVTTV
  для MOPERV - MoperVTTV
  ОПИСЫВАЕТСЯ СЛЕДУЮЩИМ ОБРАЗОМ:
  ------------------------------------------
OperVTTS=3800X,6204X,VM2,3800Y,6204Y,VM3...
  т.е. указываются триады через ',':
  - счет валютной позиции (3800) / NLST;
  - счет доходов/расходов (6204) / NLSO;
  - код транзакции для разновалютной проводки.
  По умолчанию устанавливается код транзакции VM1 (валюная позиция и доходы/расходы по TABVAL).
  ------------------------------------------
  Вторая возможность (для разделения ПОКУПКИ и ПРОДАЖИ наличной валюты на различные
  операции/транзакции):
OperVTTV=?,0,VM4,0,?,VM5
  В этом параметре ОБЯЗАТЕЛЬНО описываются ДВЕ триады !!!
  Первая триада указывает на ПОКУПКУ (операция - VM4), а вторая триада - на ПРОДАЖУ (операция - VM5).
  ------------------------------------------
  Следует обратить внимание на то, что приоритет имеет параметр {Mo,O}perVTTS при наличии обеих
  параметров, т.е. если в Ini-файле присутствуют, например, такие строки:
OperVTTS=380001,620401,VR0,380002,620402,VS0
OperVTTV=?,0,VR0,0,?,VS0
  ------------------------------------------
  При отсутствии описанных параметров для разновалютных проводок используется транзакция VM1.
.head 13 +  If nVob = 96 or nVob = 99
.head 14 -  ! Set dTemp = SalDateMonthBegin(dfBD)-1
.head 14 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD), SalDateYearBegin(dfBD)) - 1
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     INTO   :dValu
     FROM   fdat
     WHERE  fdat<=:dTemp")
.head 14 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 15 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 15 -  Set dValu = dTemp
.head 14 +  If dValu != dfBD
.head 15 -  Call Pl_dat(dValu) ! Установить банковскую дату
.head 13 +  Else
.head 14 -  Set dValu = dfBD
.head 13 -  Call ccDoc.SetDoc(0, sTT, nDk, nVob, sNd, dValu, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '', nKvD,
     SD1, sKoda, sNlsk, sPolu, sBankMfo, '', nKvK, SK1, sKodb, sNaz1, '', '', '', nSk, 0)
.head 13 +  If ccDoc.oDoc()
.head 14 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || IifS(nISOS=5, '', 'm') || "operv" || sAn || "
   SET    sos=9
   WHERE  CURRENT OF " || IifS(nISOS=5, '', 'm') || "operv")
.head 15 -  Call SqlCommit(hSql())
.head 15 -  Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 15 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 15 -  Set tbl1.colTT = sTT
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 15 -  Set dfCurrent = dfCurrent + 1
.head 15 +  If n99 < 16
.head 16 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || IifS(nISOS=5, '', 'm') || "operv" || sAn || "
     SET    sos=9,ref99bm=:ccDoc.m_nRef
     WHERE  CURRENT OF " || IifS(nISOS=5, '', 'm') || "operv")
.head 15 +  If Len(SalStrTrimX(sKod_N)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_N',:sKod_N)")
.head 15 +  If Len(SalStrTrimX(sKod_G)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_G',:sKod_G)")
.head 15 +  If Len(SalStrTrimX(sKod_B)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_B',:sKod_B)")
.head 15 -  Call SqlCommit(hSql())
.head 14 +  Else
.head 15 -  Call SqlRollback(hSql())
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 12 +  Else ! одновалютная
.head 13 -  Set sTT = 'VMO'
.head 13 -  !
.head 13 +  If Len(sNLSKASSA) > 0
.head 14 -  Call SalArrayGetUpperBound(smNLSKASSA, 1, nI)
.head 14 -  Set nC = 0
.head 14 +  While nC <= nI
.head 15 -  ! Call DebugN(nC)
.head 15 -  ! Call Debug('smNLSKASSA[nC]=' || smNLSKASSA[nC])
.head 15 -  ! Call Debug('smDK0KASSA[nC]=' || smDK0KASSA[nC])
.head 15 -  ! Call Debug('smDK1KASSA[nC]=' || smDK1KASSA[nC])
.head 15 +  If SalStrScan(sNlsk, smNLSKASSA[nC]) >= 0 and Len(smDK0KASSA[nC]) = 3 and
   Len(smDK1KASSA[nC]) = 3
.head 16 -  Set sTT = IifS(nDk=1, smDK0KASSA[nC], smDK1KASSA[nC])
.head 16 -  Break
.head 15 -  Set nC = nC + 1
.head 13 -  !
.head 13 +  If nVob = 96
.head 14 -  Set dTemp = SalDateMonthBegin(dfBD)-1
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     INTO   :dValu
     FROM   fdat
     WHERE  fdat<=:dTemp")
.head 14 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 15 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 15 -  Set dValu = dTemp
.head 14 +  If dValu != dfBD
.head 15 -  Call Pl_dat(dValu) ! Установить банковскую дату
.head 13 +  Else
.head 14 -  Set dValu = dfBD
.head 13 -  Call ccDoc.SetDoc(0, sTT, 1, nVob, sNd, dValu, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '', nKv, nS,
     sKoda, sNlsk, sPolu, sBankMfo, '', nKv, nS, sKodb, sNaz1, '', '', '', 0, 0)
.head 13 +  If ccDoc.oDoc()
.head 14 -  ! ccDoc.m_nRef
.head 14 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || IifS(nISOS=5, '', 'm') ||  "operv" || sAn || "
   SET    sos=9
   WHERE  CURRENT OF " || IifS(nISOS=5, '', 'm') || "operv")
.head 15 -  Call SqlCommit(hSql())
.head 15 -  Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 15 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 15 -  Set tbl1.colTT = sTT
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 15 -  Set dfCurrent = dfCurrent + 1
.head 15 +  If n99 < 16
.head 16 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || IifS(nISOS=5, '', 'm') || "operv" || sAn || "
     SET    sos=9,ref99bm=:ccDoc.m_nRef
     WHERE  CURRENT OF " || IifS(nISOS=5, '', 'm') || "operv")
.head 15 +  If Len(SalStrTrimX(sKod_N)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_N',:sKod_N)")
.head 15 +  If Len(SalStrTrimX(sKod_G)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_G',:sKod_G)")
.head 15 +  If Len(SalStrTrimX(sKod_B)) > 0
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'KOD_B',:sKod_B)")
.head 15 -  Call SqlCommit(hSql())
.head 14 +  Else
.head 15 -  Call SqlRollback(hSql())
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 12 -  Set dfAll = dfAll + 1
.head 11 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Set nRecn = nRecn + 1
.head 11 +  If Int(nPos) != nTek
.head 12 -  Set nTek = Int(nPos)
.head 12 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 12 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 12 -  ! Call Debug('nPos=' || Str(nPos) || ', nTimeStart=' || Str(nTimeStart) || ', nTimeEnd=' || Str(nTimeEnd))
.head 12 -  Set nHour = Int(nTimeEnd/3600)
.head 12 -  Set nTemp = nTimeEnd - nHour*3600
.head 12 -  Set nMinu = Int(nTemp/60)
.head 12 -  Set dfStart = dfStart
.head 12 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 12 -  Set dfReccount = dfReccount
.head 12 -  Set dfCurrent = dfCurrent
.head 12 -  Set dfAll = dfAll
.head 11 -  Call ccProgressBar.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Call ccProgressBar.SetProgress(100)
.head 10 -  Call SqlCommitEx(hSql(), 'OK')
.head 10 -  Call SqlCommit(hSqlB)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlB)
.head 10 -  Call SaveInfoToLog('Прием документов из ' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn || ' ОКОНЧЕН')
.head 10 -  Set dfDone = "Готово"
.head 10 -  Set dfEnd = Left(dfEnd, 15)
.head 10 +  If dfCurrent > 0
.head 11 -  ! сформировать файл оплаченных документов
.head 11 -  Set nCurrentRow = TBL_MinRow
.head 11 -  Set nP = 1
.head 11 -  Set nItog = 0
.head 11 -  Set sFr = GetPrnDir() || '\\' || IifS(nISOS=5, 'O', 'M') || 'V' || Right(Str(SalDateMonth(dBat)+100), 2) ||
    Right(Str(SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || '.' || Right(
    Str(SalDateMinute(SalDateCurrent())+100), 2)
.head 11 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 11 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(GetBankMfo()) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') || Right('0' ||
    SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() || Spac(15) ||
    'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || IifS(nISOS=5, '', 'M') ||
    'OPERV) сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 12 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 12 -  Set nColor = SalColorGet(tbl1.colNLSA, COLOR_IndexCellText)
.head 12 +  If nColor = COLOR_DarkGreen
.head 13 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' || SalStrTrimX(tbl1.colND) || ', оп.'
    || Str(tbl1.colVOB)
.head 13 -  Set sBuff = PadR(Str(nP) || '.', 4) || GetBankMfo() || ' ' || IifS(Len(tbl1.colNAMA)=0, tbl1.colNLSA ||
    '(' || Right(Str(tbl1.colVALA+1000), 3) || ')', PadR(tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA))) || PutCrLf() ||
    '    ' || IifS(Val(tbl1.colMFOB)=0, GetBankMfo(), tbl1.colMFOB) || ' ' || IifS(Len(tbl1.colNAMB)=0,
    tbl1.colNLSB || '(' || Right(Str(tbl1.colVALB+1000), 3) || ')', PadR(tbl1.colNLSB || '(' || Right(
    Str(tbl1.colVALB+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMB))) || PutCrLf() ||
    StrWinToDosX(sLev || PadL('сумма ' || SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) || PutCrLf() ||
    Perenos(tbl1.colNAZN, 65, 4)) || PutCrLf()
.head 13 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 13 -  Set nP = nP + 1
.head 13 -  Set nItog = nItog + tbl1.colS
.head 11 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) || 'На сумму:')
    || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(PutCrLf(), 3)
.head 11 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 11 -  Call SalFileClose(hF)
.head 10 -  Call SalMessageBeep(-1)
.head 10 +  If dfAll > dfCurrent
.head 11 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны не ВСЕ выбранные документы. Примите меры для исправления ошибок.',
     'Строгое предупреждение', 0, 1)
.head 10 -  Call SalSetFocus(tbl1)
.head 10 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText)
.head 10 -  Call SalDisableWindow(pbExecute)
.head 9 +  Else
.head 10 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 8 +  Else
.head 9 -  Call MessageAttention('Нет файла: ' || sODBCDir || '\\' || IifS(nISOS=5, '', 'M') || 'OPERV' || sAn ||
     '.dbf или он занят другим пользователем.')
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 7 -  ! Call SalEnableWindow(pbExecute)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.4"
.head 5 -  Top:    6.06"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 30475
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.952"
.head 5 -  Width:  12.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.512"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    6.0"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    6.25"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.533"
.head 6 -  Top:    6.048"
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.3"
.head 6 -  Top:    6.083"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    5.56"
.head 6 -  Width:  10.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма экв.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.957"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзакция
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow(tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Data Field: dfOPERV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    6.083"
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.0"
.head 6 -  Top:    5.56"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !', 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Pushbutton: pbBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.386"
.head 5 -  Top:    5.323"
.head 5 -  Width:  0.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 3 +  Data Field: dfText
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    5.298"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nISOS
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  ! String: ND
.head 3 -  ! String: NLS
.head 3 -  ! String: NLSK
.head 3 -  ! Number: KVS
.head 3 -  ! Number: SK
.head 3 -  Number: nKv
.head 3 -  Number: nKvD
.head 3 -  Number: nKvK
.head 3 -  ! Number: REF
.head 3 -  ! Number: ISV
.head 3 -  ! String: NAZN
.head 3 -  String: sTmp
.head 3 -  ! Number: nCount
.head 3 -  String: sAn
.head 3 -  ! String: sNbw
.head 3 -  ! Number: nNls
.head 3 -  String: sMfo
.head 3 -  ! String: sMdl
.head 3 -  ! Number: nMfop
.head 3 -  ! Number: nFetchRes
.head 3 -  ! String: sBlk
.head 3 -  ! String: sFv
.head 3 -  ! String: sFs
.head 3 -  String: sBankDay
.head 3 -  String: sBankMfo
.head 3 -  ! Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  ! String: strMessage
.head 3 -  ! Number: nNm
.head 3 -  Number: nDk
.head 3 -  ! Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  String: sNLST
.head 3 -  String: sNLSO
.head 3 -  String: sTT
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Number: nS1
.head 3 -  Number: SD1
.head 3 -  Number: SK1
.head 3 -  Date/Time: dBat
.head 3 -  ! Date/Time: dPat
.head 3 -  String: sDatA
.head 3 -  String: sDatP
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  ! String: sVspo
.head 3 -  ! String: sKod
.head 3 -  ! String: sKisp
.head 3 -  ! String: sSign
.head 3 -  ! Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  !
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNd
.head 3 -  String: sKod_B
.head 3 -  String: sKod_N
.head 3 -  String: sKod_G
.head 3 -  Number: n99
.head 3 -  Boolean: bS1S2
.head 3 -  Number: nIs2
.head 3 -  Number: nmREF[*]
.head 3 -  Number: nmS2[*]
.head 3 -  Number: n12
.head 3 -  Number: nS2
.head 3 -  Number: nREFO
.head 3 -  Number: nRefOperv
.head 3 -  Number: nSos
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  String: sTTSi
.head 3 -  String: sTTSv
.head 3 -  String: smNT[*]
.head 3 -  String: smNO[*]
.head 3 -  String: smTT[*]
.head 3 -  String: sTemp
.head 3 -  Number: n3
.head 3 -  Number: nC
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 3 -  !
.head 3 -  Number: n99a
.head 3 -  Number: n99r
.head 3 -  String: sKoda
.head 3 -  String: sKodb
.head 3 -  !
.head 3 -  String: sNLSKASSA
.head 3 -  String: smNLSKASSA[*]
.head 3 -  String: smDK0KASSA[*]
.head 3 -  String: smDK1KASSA[*]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set dfOPERV = IifS(nISOS=5, '', 'M') || 'OPERV'
.head 4 -  Set sDatA = SalFmtFormatDateTime(GetBankDate(), 'MM/dd/yyyy')
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'NLSKASSA', '', sNLSKASSA, GetIniFileName())
.head 4 -  Call SalArraySetUpperBound(smNLSKASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK0KASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK1KASSA, 1, -1)
.head 4 -  Set sTemp = sNLSKASSA
.head 4 +  If Len(sTemp) > 0
.head 5 -  Set n3 = 0
.head 5 -  Set nC = 0
.head 5 +  Loop
.head 6 -  Set nI = At(',', sTemp)
.head 6 +  If nI = 0
.head 7 +  If Len(sTemp) > 0
.head 8 +  If n3 = 0
.head 9 -  Set smNLSKASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK0KASSA[nC] = ''
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else If n3 = 1
.head 9 -  Set smDK0KASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else
.head 9 -  Set smDK1KASSA[nC] = SalStrTrimX(sTemp)
.head 7 -  Break
.head 6 +  If n3 = 0
.head 7 -  Set smNLSKASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else If n3 = 1
.head 7 -  Set smDK0KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else
.head 7 -  Set smDK1KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 -  Set n3 = n3 + 1
.head 6 +  If n3 = 3
.head 7 -  Set nC = nC + 1
.head 7 -  Set n3 = 0
.head 6 -  Set sTemp = Right(sTemp, Len(sTemp)-nI)
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call Pl_dat(dBat)
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ImpOper(hWndMDI, ' || IifS(nISOS=5, '', '1') || '1)')
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_ImpK2_
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт документов КАРТОТЕКИ-2
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.138"
.head 4 -  Top:    0.094"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.595"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт К2
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 45349
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 45350
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 45351
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.383"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If IsBankDayOpen()
.head 7 -  Set sAn = SalStrTrimX(dfAn)
.head 7 +  If MessageQuestion('Прием/Оплата KART_' || sAn || '.dbf ?') = IDNO
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'Kart_Path', SalStrLeftX(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\KART_',
     sODBCDir, GetIniFileName())
.head 7 -  Call SaveInfoToLog("Прием документов из KART_" || sAn)
.head 7 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SalFileGetDateTime(sODBCDir || '\\KART_' || sAn || '.dbf', dTmp)
.head 9 -  ! проверить, есть ли поле ref99bm в kart_xx если нет, то добавить его
.head 9 -  Set n99 = -1
.head 9 -  Set dfDone = "Подождите ..."
.head 9 -  Call SalLoadAppAndWait("FindVar " || sODBCDir || '\\KART_' || sAn || " ref99bm", Window_NotVisible, n99)
.head 9 -  Set dfDone = ""
.head 9 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 10 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM   kart_" || sAn || "
     INTO   :nRecCount")
.head 10 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  ! Call SalGetWindowText(hWndForm, sText, 100)
.head 10 -  ! Call SalSetWindowText(hWndForm, sText || ' (' || Str(nRecCount) || ')')
.head 10 -  Call SalShowWindow(dfStart)
.head 10 -  Call SalShowWindow(dfEnd)
.head 10 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 10 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 10 -  Set dfReccount = nRecCount
.head 10 -  Set dfCurrent = 0
.head 10 -  Set dfAll = 0
.head 10 -  Set nPos = 0
.head 10 -  Set nTek = 0
.head 10 -  Set nRecn = 1
.head 10 -  Set nDelta = 100 / nRecCount
.head 10 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 10 -  Call SqlPrepare(hSqlA, "
     SELECT nls,mfo,nlsk,nd,ostatok,datd,plat,polu,naz1,kod,kod_a,ref99bm,vob
     INTO   :sNls,:nMfo,:sNlsk,:sNd,:nS,:dDat,:sPlat,:sPolu,:sNaz1,:nKod,:sKod,:nRef99bm,:nVob
     FROM   kart_" || sAn || "
     ORDER BY datd
     FOR UPDATE OF ref99bm")
.head 10 -  Call SqlOpen(hSqlA, "kart")
.head 10 -  ! Call Debug(IifS(bSFN, 'TRUE', 'FALSE'))
.head 10 -  ! Set bSFN = SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  ! Call DebugN(nFetchRes)
.head 10 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 11 -  Set sNls = SalStrTrimX(sNls)
.head 11 -  Set sMfo = IifS(nMfo=0 or nMfo=NUMBER_Null, GetBankMfo(), Str(nMfo))
.head 11 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 11 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 11 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 11 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 11 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 11 -  Set sKod = SalStrTrimX(sKod)
.head 11 -  Set nNewRow = SalTblInsertRow(tbl2, TBL_MaxRow)
.head 11 -  Call SalTblSetContext(tbl2, nNewRow)
.head 11 -  Set tbl2.colNPP = nRecn
.head 11 -  Set tbl2.colND = sNd
.head 11 -  Set tbl2.colMFOA = IifS(Val(sNls)=0, '', GetBankMfo())
.head 11 -  Set tbl2.colNLSA = sNls
.head 11 -  Set tbl2.colMFOB = IifS(Val(sNls)=0, '', sMfo)
.head 11 -  Set tbl2.colNLSB = sNlsk
.head 11 -  Set tbl2.colS = nS / 100
.head 11 -  Set tbl2.colVDATE = dDat
.head 11 -  Set tbl2.colREF98 = nRef99bm
.head 11 -  Call SalTblSetFocusRow(tbl2, nNewRow)
.head 11 -  Call SalTblSetRowFlags(tbl2, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 11 +  If Val(sNls) = 0
.head 12 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_Gray)
.head 11 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 11 -  ! Call Debug(sAn)
.head 11 +  If dDat != DATETIME_Null and Abs(nS) > 0 and (nRef99bm = 0 or nRef99bm = NUMBER_Null)
.head 12 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_Blue)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 12 -  ! Call Debug(sKod || '-' || V_Okpo(sKod))
.head 12 +  If sKod=V_Okpo(sKod)
.head 13 -  Call ccDoc.SetDoc(0, 'K2A', 1, nVob, sNd, dDat, dDat, dDat, dDat, sNls, sPlat, sBankMfo, '', 980, nS,
     sKodSvoj, sNlsk, sPolu, sMfo, '', 980, nS, sKod, sNaz1, '', sAn, '', 0, 0)
.head 13 -  Set dfAll = dfAll + 1
.head 13 +  If ccDoc.oDoc() and sKod=V_Okpo(sKod)
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     SET    userid=:sAn
     WHERE  ref=:ccDoc.m_nRef")
.head 14 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE kart_" || sAn || "
   SET    ref99bm=:ccDoc.m_nRef
   WHERE  CURRENT OF kart")
.head 15 -  Set sKodk = IifS(nKod=0 or NUMBER_Null, '99', Str(nKod))
.head 15 -  Call SqlPrepareAndExecute(hSql(),"
     INSERT
     INTO   operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'VIDPL',:sKodk)")
.head 15 -  Call SqlCommit(hSql())
.head 15 -  Set tbl2.colREF98 = ccDoc.m_nRef
.head 15 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_DarkGreen)
.head 15 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 15 -  Set dfCurrent = dfCurrent + 1
.head 14 +  Else
.head 15 -  Call SqlRollback(hSql())
.head 13 +  Else
.head 14 -  Call SqlRollback(hSql())
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Set nRecn = nRecn + 1
.head 11 +  If Int(nPos) != nTek
.head 12 -  Set nTek = Int(nPos)
.head 12 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 12 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 12 -  Set nHour = Int(nTimeEnd/3600)
.head 12 -  Set nTemp = nTimeEnd - nHour*3600
.head 12 -  Set nMinu = Int(nTemp/60)
.head 12 -  Set dfStart = dfStart
.head 12 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 12 -  Set dfReccount = dfReccount
.head 12 -  Set dfCurrent = dfCurrent
.head 12 -  Set dfAll = dfAll
.head 11 -  Call ccProgressBar.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Call ccProgressBar.SetProgress(100)
.head 10 -  Call SqlCommitEx(hSql(), 'OK')
.head 10 -  Call SqlCommit(hSqlB)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlB)
.head 10 -  Call SaveInfoToLog("Прием документов из KART_" || sAn || " ОКОНЧЕН")
.head 10 -  Set dfDone = "Готово"
.head 10 -  Set dfEnd = Left(dfEnd, 15)
.head 10 -  Call SalMessageBeep(-1)
.head 10 +  If dfAll > dfCurrent
.head 11 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны не ВСЕ выбранные документы. Примите меры для исправления ошибок.',
     'Строгое предупреждение', 0, 1)
.head 10 -  Call SalSetFocus(tbl2)
.head 10 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 10 -  Call SalDisableWindow(pbExecute)
.head 9 +  Else
.head 10 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 8 +  Else
.head 9 -  Call MessageAttention('Нет файла: ' || sODBCDir || '\\KART_' || sAn ||
     '.dbf или он занят другим пользователем.')
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.383"
.head 5 -  Top:    5.821"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 55147
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.738"
.head 5 -  Width:  12.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    5.762"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    6.012"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    5.821"
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbExecute)
.head 6 -  Set dfStart = ''
.head 6 -  Set dfEnd = ''
.head 3 -  Background Text: KART_
.head 4 -  Resource Id: 45348
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.845"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    5.845"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Teal
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.229"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.657"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.657"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.971"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl2, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl2)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl2, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow(tbl2, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl2, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl2, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl2, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  ! Date/Time: dTempDate
.head 3 -  String: sAn
.head 3 -  String: sMfo
.head 3 -  String: sBankDay
.head 3 -  String: sBankMfo
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sKod
.head 3 -  Number: nKod
.head 3 -  String: sKodk
.head 3 -  ! Number: nRow
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: n99
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nRecn
.head 3 -  Number: nTek
.head 3 -  !
.head 3 -  Boolean: bSFN
.head 3 -  !
.head 3 -  Number: nVob
.head 3 -  String: sKodSvoj
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call Debug(SalFmtFormatDateTime(SalDateCurrent(), 'DDMMYYYYhhhmmss'))
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set sKodSvoj = Right('00000000' || Str(GetBankOkpo()), 8)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call WaitCursorOff()
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ImpOper(hWndMDI, 3)')
.head 1 +  Dialog Box: dlg_UpdateBanks
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Обновление списка участников СЭП из S_UCH.DBF
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.025"
.head 4 -  Top:    2.313"
.head 4 -  Width:  6.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.738"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Обновление таблицы BANKS из S_UCH.DBF
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: МФО банка:
.head 4 -  Resource Id: 6870
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.113"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.07"
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: сbOemToAnsi
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перекодировать (DOS -> WIN)
.head 4 -  Window Location and Size
.head 5 -  Left:   3.0"
.head 5 -  Top:    0.071"
.head 5 -  Width:  3.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.4"
.head 6 -  Width:  6.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbUpdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   3.883"
.head 5 -  Top:    0.988"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If MessageQuestion('Выполнить обновление списка участников СЭП?') = IDNO
.head 7 -  Return FALSE
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  Call SalGetProfileString('Import', 'S_uchPath', SalStrLeftX(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\S_UCH',
     sODBCDir, GetIniFileName())
.head 6 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 7 -  Set SqlDatabase = 'dBase_Files'
.head 7 +  If SalFileGetDateTime(sODBCDir || '\\S_UCH.dbf', dTmp)
.head 8 +  If SqlConnect(hSqlOdbc)
.head 9 -  Call SqlPrepareAndExecute(hSqlOdbc, T("
     SELECT count(*)
     INTO   :nHdr
     FROM   S_uch"))
.head 9 -  Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 9 +  If nHdr
.head 10 -  Call SqlPrepareAndExecute(hSql(), T("
     UPDATE banks
     SET    blk=4
     WHERE  mfop<>" || GetBankMfo()))
.head 9 -  Set nPos = 0
.head 9 -  Set nDelta = 100 / nHdr
.head 9 -  Set sFn = '$UXXXX' || Sep98md(SalDateCurrent()) || '.000'
.head 9 -  Set dDat = SalDateCurrent()
.head 9 -  ! Call SqlPrepareAndExecute(hSqlOdbc, T("
     SELECT 0,m_ba,e_ba,h_ba,n_ba,k_sc,n_mo,u_mo,m_bg,m_ur,f_bl,f_va,f_sl,s_ss
     INTO   :nTmp,:nMfo,:sSab,:sSab_p,:sNb,:nNls,:sMod,:sMdl,:nMfop,:nMfou,:sBlk,:sFv,:sFs,:sArm2
     FROM   S_uch
     WHERE  m_ba=m_ur
  UNION
     SELECT 1,m_ba,e_ba,h_ba,n_ba,k_sc,n_mo,u_mo,m_bg,m_ur,f_bl,f_va,f_sl,s_ss
     FROM   S_uch
     WHERE  m_ba<>m_ur
     ORDER by 1"))
.head 9 -  ! Call SqlPrepareAndExecute(hSqlOdbc, T("
     SELECT 0,m_ba,e_ba,h_ba,n_ba,k_sc,n_mo,u_mo,m_bg,m_ur,f_bl,f_va,f_sl
     INTO   :i,:nMfo,:sSab,:sSab_p,:sNb,:nNls,:sMod,:sMdl,:nMfop,:nMfou,:sBlk,:sFv,:sFs
     FROM   S_uch
     WHERE  m_ba=m_ur
  UNION
     SELECT 1,m_ba,e_ba,h_ba,n_ba,k_sc,n_mo,u_mo,m_bg,m_ur,f_bl,f_va,f_sl
     FROM   S_uch
     WHERE  m_ba<>m_ur
     ORDER by 1"))
.head 9 -  Call SqlPrepareAndExecute(hSqlOdbc, T("
     SELECT 0,m_ba,e_ba,h_ba,n_ba,n_mo,u_mo,m_bg,m_ur,f_ba_onl,f_bb_onl
     INTO   :i,:nMfo,:sSab,:sSab_p,:sNb,:sMod,:sMdl,:nMfop,:nMfou,:sSSP,:sTemp
     FROM   S_uch
     WHERE  m_ba=m_ur
  UNION
     SELECT 1,m_ba,e_ba,h_ba,n_ba,n_mo,u_mo,m_bg,m_ur,f_ba_onl,f_bb_onl
     FROM   S_uch
     WHERE  m_ba<>m_ur
     ORDER by 1"))
.head 9 -  Call SqlPrepareAndExecute(hSql(), T("
     INSERT
     INTO   banks_update_hdr (fn,dat,n,rec_start,rec_finish,acc1,acc2)
     VALUES (:sFn,:dDat,:nHdr,:nHdr,:nHdr,:nHdr,:nHdr)"))
.head 9 -  ! SqlCommit поставлено, чтобы работало дальше при ошибке, потому-что потом есть неявный ROLLBACK
.head 9 -  Call SqlCommit(hSql())
.head 9 -  !
.head 9 -  ! Call SqlPrepareAndExecute(hSql(), T("
     SELECT ID,FN,DAT,N,REC_START,REC_FINISH,ACC1,ACC2
     INTO   :i,:sFn,:dDat,:nHdr,:nHdr,:nHdr,:nHdr,:nHdr
     FROM   banks_update_hdr
     WHERE  rownum<2"))
.head 9 -  ! Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Call DebugN(i)
.head 9 -  !
.head 9 -  Set j = 0
.head 9 -  Set nHdr = Read_SQ2("s_Banks_update_hdr")
.head 9 -  ! Call DebugN(nHdr)
.head 9 +  While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 10 +  ! If сbOemToAnsi
.head 11 -  Set sNbw = StrDosToWinX(sNb)
.head 10 +  ! Else
.head 11 -  Set sNbw = sNb
.head 10 -  Set sNbw = IifS(сbOemToAnsi, StrDosToWinX(sNb), sNb)
.head 10 -  Set j = j + 1
.head 10 -  Set dfMfo = nMfo
.head 10 -  Set nSSP = IifN(sSSP='Y', 1, 0)
.head 10 -  ! nSSP пока не используется (как и sSSP)
.head 10 +  ! If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO   banks_update (ord,header,op,mfo,nb,nbw,nls,sab,sabp,model,model_no,mfop,mfou,kv,gate,blk,arm2)
   VALUES (:i,:nHdr,'A',:nMfo,:sNb,:sNbw,:nNls,:sSab,:sSab_p,:sMod,:sMdl,:nMfop,:nMfou,980,null,:sBlk,' ')"))
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SaveInfoToLog('Обновляется информация для банка: ' || NumberToStr(nMfo))
.head 10 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO   banks_update (ord,header,op,mfo,nb,nbw,sab,sabp,model,model_no,mfop,mfou,kv,gate,blk,arm2)
   VALUES (:j,:nHdr,'A',:nMfo,:sNb,:sNbw,:sSab,:sSab_p,:sMod,:sMdl,:nMfop,:nMfou,980,null,null,' ')"))
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SaveInfoToLog('Обновляется информация для банка: ' || NumberToStr(nMfo))
.head 10 +  Else
.head 11 -  Call MessageNoWait('Ошибка при обновлении информация для банка:' || PutCrLf() || sNbw || PutCrLf() || 'МФО='
     || Str(nMfo) || ', SAB=' || sSab, 'ВНИМАНИЕ!', 0, 1)
.head 10 -  Set nPos = nPos + nDelta
.head 10 -  Call ccProgressBar.SetProgress(nPos)
.head 10 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Set dfMfo = NUMNULL
.head 9 -  Call ccProgressBar.SetProgress(100)
.head 9 -  Set strMessage = 'Обновление списка участников СЭП успешно завершено!'
.head 9 -  Call SqlCommitEx(hSql(), strMessage)
.head 9 -  Call SqlDisconnect(hSqlOdbc)
.head 9 -  Call MessageInfoEx(strMessage)
.head 8 +  Else
.head 9 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет файла: ' || sODBCDir || '\\S_UCH.dbf или он занят другим пользователем.')
.head 6 +  Else
.head 7 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 6 -  Call SalEnableWindow(pbUpdate)
.head 6 -  Call SalSetFocus(pbExit)
.head 6 -  Call WaitCursorOff()
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.183"
.head 5 -  Top:    0.988"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 6871
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.893"
.head 5 -  Width:  6.46"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    1.024"
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sODBCDir
.head 3 -  ! Number: nCount
.head 3 -  Number: nMfo
.head 3 -  String: sSab
.head 3 -  String: sSab_p
.head 3 -  String: sNb
.head 3 -  String: sNbw
.head 3 -  ! Number: nNls
.head 3 -  String: sMod
.head 3 -  String: sMdl
.head 3 -  Number: nMfop
.head 3 -  Number: nMfou
.head 3 -  ! String: sBlk
.head 3 -  String: sFv
.head 3 -  String: sFs
.head 3 -  ! String: sArm2
.head 3 -  String: sFn
.head 3 -  ! String: sDta
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nHdr
.head 3 -  Sql Handle: hSqlOdbc
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  String: strMessage
.head 3 -  Number: i
.head 3 -  Number: j
.head 3 -  ! Number: nTmp
.head 3 -  !
.head 3 -  String: sSSP
.head 3 -  String: sTemp
.head 3 -  Number: nSSP
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call ConPara('PUSH')
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call WaitCursorOff()
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSqlOdbc, 'ShowUpdatesBanks()')
.head 1 +  Dialog Box: dlg_ModyTok
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр / Обновление  таблицы  открытых ключей
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.413"
.head 4 -  Top:    0.656"
.head 4 -  Width:  11.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.012"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Модификация таблицы открытых ключей
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обновление
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    3.619"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(114,STRING_Null)
.head 6 -  Call InvokReNew(118, SalStrRightX(GetBankSab()||'???',6))
.head 5 +  On SAM_Create
.head 6 +  If VisDosExist(dfTokPath || '\\p_*.*') or
   VisDosExist(dfTokPath || '\\!*.*')
.head 7 -  Call SalEnableWindow(hWndItem)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(hWndItem)
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Восстановление
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    4.452"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(120, SalStrLowerX(cmb1))
.head 5 +  On SAM_Create
.head 6 +  If VisDosExist(dfTokPath || '\\*.rct')
.head 7 -  Call SalEnableWindow(hWndItem)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(hWndItem)
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    4.869"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 44143
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    3.405"
.head 5 -  Width:  3.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Маска ключа
.head 4 -  Resource Id: 44146
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    0.512"
.head 5 -  Width:  1.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKeyMask
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.483"
.head 6 -  Top:    0.476"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfKeyMask = '*'
.head 5 +  On SAM_Validate
.head 6 -  Call SalEnableWindow(pb2)
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    4.036"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(118, dfKeyMask)
.head 5 +  ! On SAM_Create
.head 6 -    Call SalDisableWindow(hWndItem)
.head 3 -  Background Text: Файл архива
.head 4 -  Resource Id: 44147
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    0.845"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    1.071"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListClear(hWndItem)
.head 6 -  Set nCount = VisDosEnumFiles(dfTokPath || '\\*.rct',
    FA_Standard, sFiles)
.head 6 +  If nCount > 0
.head 7 -  Call VisListArrayPopulate(hWndItem, sFiles)
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 7 -  Call SalEnableWindow(hWndItem)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(hWndItem)
.head 3 -  Background Text: Каталог ТОК
.head 4 -  Resource Id: 44144
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    1.512"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTokPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    1.738"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(pb1, SAM_Create, 0, 0)
.head 6 -  ! Call SalSendMsg(pb2, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml1, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml2, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(cmb1, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(pb3, SAM_Create, 0, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 44145
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    0.298"
.head 5 -  Width:  3.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.857"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог копии ТОК
.head 4 -  Resource Id: 43019
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    2.512"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCopyTOKDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    2.738"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(pb1, SAM_Create, 0, 0)
.head 6 -  ! Call SalSendMsg(pb2, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml1, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml2, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(cmb1, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(pb3, SAM_Create, 0, 0)
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 24000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.25"
.head 6 -  Width:  7.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If SalFileOpen(hFile, dfTokPath || '\\protocol.rsa',
   OF_Read)
.head 7 -  Call SalFileRead(hFile, ml1, 24000)
.head 7 -  Set ml1 = StrDosToWinX(ml1)
.head 7 -  Call SalFileClose(hFile)
.head 3 +  Multiline Field: ml2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 24000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.298"
.head 6 -  Width:  7.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.107"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If SalFileOpen(hFile, strReportPub,
   OF_Read)
.head 7 -  Call SalFileRead(hFile, ml2, 24000)
.head 7 -  Set ml2 = StrDosToWinX(ml2)
.head 7 -  Call SalFileClose(hFile)
.head 3 +  Check Box: cbCopyTOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Копировать ТОК для просмотра
.head 4 -  Window Location and Size
.head 5 -  Left:   8.083"
.head 5 -  Top:    2.155"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbCopyTOK
.head 7 -  Call SalEnableWindow(dfCopyTOKDir)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(dfCopyTOKDir)
.head 2 +  Functions
.head 3 +  Function: InvokReNew
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOp
.head 5 -  String: sTmp
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTokPath
.head 5 -  Number: nStatus
.head 5 -  File Handle: hCopyDir
.head 4 +  Actions
.head 5 -  ! Предварительно копируем таблицу для просмотра, если просят
.head 5 +  If nOp = 118 and cbCopyTOK
.head 6 -  ! проверка: директория существует ?
.head 6 +  If not SalFileOpen(hCopyDir, dfCopyTOKDir, OF_Exist)
.head 7 +  If not SalFileCreateDirectory(dfCopyTOKDir)
.head 8 -  Call SalMessageBox('Невозможно создать директорию:'||PutCrLf()||dfCopyTOKDir,
'Ошибка при создании директории', MB_IconExclamation)
.head 8 -  Return FALSE
.head 6 -  Set nStatus = SalFileCopy(dfTokPath || '\\pub_odb.key', dfCopyTOKDir|| '\\pub_odb.key', TRUE)
.head 6 +  If nStatus != FILE_CopyOK
.head 7 -  Call SalMessageBox('Невозможно скопировать файл:'||PutCrLf()||
dfTokPath||'\\pub_odb.key ==> '||dfCopyTOKDir||'\\pub_odb.key', 
'Ошибка при копировании ТОК', MB_IconExclamation)
.head 7 -  Return FALSE
.head 6 -  Set nStatus = SalFileCopy(dfTokPath || '\\pub_odb.ind', dfCopyTOKDir|| '\\pub_odb.ind', TRUE)
.head 6 +  If nStatus != FILE_CopyOK
.head 7 -  Call SalMessageBox('Невозможно скопировать файл:'||PutCrLf()||
dfTokPath||'\\pub_odb.ind ==> '||dfCopyTOKDir||'\\pub_odb.ind', 
'Ошибка при копировании ТОК', MB_IconExclamation)
.head 7 -  Return FALSE
.head 6 -  Set strTokPath = dfCopyTOKDir 
.head 5 +  Else
.head 6 -  Set strTokPath = dfTokPath
.head 5 -  Set nErrorSign = RENEW_ZAH(nOp, strTokPath, sTmp, strUxDateTime)
.head 5 +  If nErrorSign != 0
.head 6 -  Call SalMessageBox('RENEW(' || SalNumberToChar(nOp) ||
     ',' || strTokPath || ',' || sTmp || ',..), RC=' ||
     SalNumberToStrX(nErrorSign,0)||PutCrLf()||
     GetRENEWMsg(nErrorSign),
     'Ошибка при вызове', MB_IconExclamation)
.head 5 +  If nOp=118 and cbCopyTOK
.head 6 -  Set strReportPub = dfCopyTOKDir||'\\report.pub'
.head 5 +  Else
.head 6 -  Set strReportPub = dfTokPath||'\\report.pub'
.head 5 -  Call SalSendMsg(dfTokPath, SAM_Validate, 0, 0)
.head 5 -  Set strReportPub = dfTokPath||'\\report.pub'
.head 2 +  Window Parameters
.head 3 -  Number: nCopyTOK
.head 2 +  Window Variables
.head 3 -  String: strUxDateTime
.head 3 -  Number: nErrorSign
.head 3 -  File Handle: hFile
.head 3 -  Number: nCount
.head 3 -  String: sFiles[*]
.head 3 -  String: sTmp
.head 3 -  String: szSignType
.head 3 -  String: strReportPub
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Set szSignType=SalStrRepeatX(' ', 256)
.head 4 -  Call SalGetProfileString('Digital Signature', 'SignType',
     'NBU', szSignType, GetIniFileName())
.head 4 +  If szSignType='NBU'
.head 5 -  Call SalGetProfileString('Digital Signature', 'OpenKey',
     SalStrLeftX(SalFileGetDrive(), 1) ||
     ':\\BARS98\\NBU_KEY', dfTokPath, GetIniFileName())
.head 4 +  Else
.head 5 -  Call SalGetProfileString('Digital Signature', 'OpenKeyNBU',
     SalStrLeftX(SalFileGetDrive(), 1) ||
     ':\\BARS98\\NBU_KEY', dfTokPath, GetIniFileName())
.head 4 -  Set strUxDateTime = SalFmtFormatDateTime(GetBankDate(),'yyyy/MM/dd') ||' 20:20:20'
.head 4 +  If nCopyTOK=0
.head 5 -  Call SalDisableWindow(cbCopyTOK)
.head 5 -  Call SalDisableWindow(dfCopyTOKDir)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(cbCopyTOK)
.head 5 -  Call SalEnableWindow(dfCopyTOKDir)
.head 5 -  Set cbCopyTOK = TRUE
.head 5 -  Call SalGetProfileString('Digital Signature', 'OpenKeyCopy', dfTokPath||'.bak', dfCopyTOKDir, GetIniFileName())
.head 4 -  Set strReportPub = dfTokPath||'\\report.pub'
.head 4 -  Call SalSetFocus(pb2)
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of function's role, which activated for
  calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ModyTok()')
.head 1 +  Dialog Box: dlg_UpdateTok
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Обновление  таблицы  открытых ключей НБУ
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.413"
.head 4 -  Top:    0.656"
.head 4 -  Width:  11.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.274"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Модификация таблицы открытых ключей
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обновление
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    2.786"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(114,STRING_Null)
.head 6 -  ! Call InvokReNew(118, SalStrRightX(GetBankSab()||'???',6))
.head 5 +  On SAM_Create
.head 6 +  If VisDosExist(dfUpdateTokPath || '\\p_*.*') or
   VisDosExist(dfUpdateTokPath || '\\!*.*')
.head 7 -  Call SalEnableWindow(hWndItem)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(hWndItem)
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Восстановление
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    3.619"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(120, SalStrLowerX(cmb1))
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow(hWndItem)
.head 6 +  ! If VisDosExist(dfUpdateTokPath || '\\*.rct')
.head 7 -    Call SalEnableWindow(hWndItem)
.head 6 +  ! Else
.head 7 -    Call SalDisableWindow(hWndItem)
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    4.036"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 27933
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    2.476"
.head 5 -  Width:  3.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.214"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Маска ключа
.head 4 -  Resource Id: 27934
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    0.524"
.head 5 -  Width:  1.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKeyMask
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.9"
.head 6 -  Top:    0.476"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfKeyMask = '*'
.head 5 +  On SAM_Validate
.head 6 -  Call SalEnableWindow(pb2)
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр
.head 4 -  Window Location and Size
.head 5 -  Left:   8.683"
.head 5 -  Top:    3.202"
.head 5 -  Width:  2.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call InvokReNew(118, dfKeyMask)
.head 5 +  ! On SAM_Create
.head 6 -    Call SalDisableWindow(hWndItem)
.head 3 -  Background Text: Файл архива
.head 4 -  Resource Id: 27935
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    0.917"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    1.107"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListClear(hWndItem)
.head 6 -  Call SalDisableWindow(hWndItem)
.head 6 -  ! Set nCount = VisDosEnumFiles(dfUpdateTokPath || '\\*.rct',
    FA_Standard, sFiles)
.head 6 +  ! If nCount > 0
.head 7 -    Call VisListArrayPopulate(hWndItem, sFiles)
.head 7 -    Call SalListSetSelect(hWndItem, 0)
.head 7 -    Call SalEnableWindow(hWndItem)
.head 6 +  ! Else
.head 7 -    Call SalDisableWindow(hWndItem)
.head 3 -  Background Text: Каталог ТОК
.head 4 -  Resource Id: 27936
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    1.571"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUpdateTokPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.333"
.head 6 -  Top:    1.738"
.head 6 -  Width:  2.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  ! Call SalSendMsg(pb1, SAM_Create, 0, 0)
.head 6 -  ! Call SalSendMsg(pb2, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml1, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(ml2, SAM_Create, 0, 0)
.head 6 -  ! Call SalSendMsg(cmb1, SAM_Create, 0, 0)
.head 6 -  ! Call SalSendMsg(pb3, SAM_Create, 0, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 27937
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    0.298"
.head 5 -  Width:  3.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.012"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 24000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.25"
.head 6 -  Width:  7.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If SalFileOpen(hFile, dfUpdateTokPath || '\\protocol.rsa',
   OF_Read)
.head 7 -  Call SalFileRead(hFile, ml1, 24000)
.head 7 -  Set ml1 = StrDosToWinX(ml1)
.head 7 -  Call SalFileClose(hFile)
.head 3 +  Multiline Field: ml2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 24000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    0.298"
.head 6 -  Width:  7.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.393"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If SalFileOpen(hFile, dfUpdateTokPath || '\\report.pub',
   OF_Read)
.head 7 -  Call SalFileRead(hFile, ml2, 24000)
.head 7 -  Set ml2 = StrDosToWinX(ml2)
.head 7 -  Call SalFileClose(hFile)
.head 2 +  Functions
.head 3 +  Function: InvokReNew
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOp
.head 5 -  String: sTmp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nErrorSign = RENEW_ZAH(nOp, dfUpdateTokPath, sTmp, strUxDateTimeUpdate)
.head 5 +  If nErrorSign != 0
.head 6 +  If nErrorSign=-72 ! Это предупреждение об отсутствии сертификатов
.head 7 -  Call SalMessageBox(GetRENEWMsg(nErrorSign),
     'Сообщение: ТОК НБУ', MB_IconAsterisk)
.head 6 +  Else
.head 7 -  Call SalMessageBox('RENEW(' || SalNumberToChar(nOp) ||
     ',' || dfUpdateTokPath || ',' || sTmp || ',..), RC=' ||
     SalNumberToStrX(nErrorSign,0)||PutCrLf()||
     GetRENEWMsg(nErrorSign),
     'Ошибка при вызове', MB_IconExclamation)
.head 5 -  ! Call SalSendMsg(dfUpdateTokPath,SAM_Validate, 0, 0)
.head 5 -  Call SalSendMsg(ml1, SAM_Create, 0, 0)
.head 5 -  Call SalSendMsg(ml2, SAM_Create, 0, 0)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strUxDateTimeUpdate
.head 3 -  Number: nErrorSign
.head 3 -  File Handle: hFile
.head 3 -  Number: nCount
.head 3 -  String: sFiles[*]
.head 3 -  String: sTmp
.head 3 -  String: szSignType
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Digital Signature', 'SignType',
     'NBU', szSignType, GetIniFileName())
.head 4 +  If szSignType='NBU'
.head 5 -  Call SalGetProfileString('Digital Signature', 'OpenKey',
     SalStrLeftX(SalFileGetDrive(), 1) ||
     ':\\BARS98\\NBU_KEY', dfUpdateTokPath, GetIniFileName())
.head 4 +  Else
.head 5 -  Call SalGetProfileString('Digital Signature', 'OpenKeyNBU',
     SalStrLeftX(SalFileGetDrive(), 1) ||
     ':\\BARS98\\NBU_KEY', dfUpdateTokPath, GetIniFileName())
.head 4 -  Set strUxDateTimeUpdate = SalFmtFormatDateTime(GetBankDate(),'yyyy/MM/dd') ||' 20:20:20'
.head 4 -  Set dfKeyMask = SalStrRightX(GetBankSab()||'???',6)
.head 4 -  Call SalSendMsg(pb1, SAM_Click, 0, 0)
.head 4 -  Call SalDisableWindow(dfKeyMask)
.head 4 -  Call SalDisableWindow(cmb1)
.head 4 -  Call SalDisableWindow(pb1)
.head 4 -  Call SalDisableWindow(dfUpdateTokPath)
.head 4 -  Call SalDisableWindow(pb2)
.head 4 -  Call SalDisableWindow(pb3)
.head 4 -  Call SalSetFocus(pb4)
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of function's role, which activated for
  calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'ModyTok()')
.head 1 +  Dialog Box: dlg_UpdateVegaTok
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Обновление ТОК ВЕГА (ВПС)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.683"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.595"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pb_Close
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Close
.head 4 -  Window Location and Size
.head 5 -  Left:   2.7"
.head 5 -  Top:    2.905"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Multiline Field: ml_Info
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 65536
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Init
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  String: sBuf
.head 4 +  Local variables
.head 5 -  Number: nErrorSign
.head 5 -  String: strErrorSign
.head 4 +  Actions
.head 5 -  Set m_isInited = FALSE
.head 5 -  Set m_bOnlyElapsed = FALSE
.head 5 -  Call SalStrSetBufferLength(sBuf, 11024+4104+1)
.head 5 -  Set nErrorSign = VegaSetBuf(sBuf,11024+4104)
.head 5 -  Set strErrorSign = SalStrRepeatX(' ', 129)
.head 5 -  Call VegaSetFmode(0, 0)
.head 5 +  If nErrorSign
.head 6 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 6 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 6 -  Return nErrorSign
.head 5 -  Set nErrorSign = VegaSetDate(SalFmtFormatDateTime(SalDateCurrent(),'dd/MM/yyyy'))
.head 5 +  If nErrorSign
.head 6 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 6 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 6 -  Return nErrorSign
.head 5 -  Set nErrorSign = VegaOpen(szOpenKeyPath||'\\Vega.cfg',szOpenKeyPath||'\\',0)
.head 5 +  If nErrorSign
.head 6 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 6 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 6 -  Return nErrorSign
.head 5 -  Set m_isInited = TRUE
.head 3 +  Function: FillInfoWnd
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set szReceipt = SalStrRepeatX(' ', 128)
.head 5 -  Set szCrtPath = SalStrRepeatX(' ', 128)
.head 5 +  If VisDosExist(szOpenKeyPath||'\\*.crt')
.head 6 -  Set nCount = VisDosEnumFiles(szOpenKeyPath||'\\*.crt', FA_Standard, sFiles)
.head 6 -  Set nIter = 0
.head 6 +  While nIter<nCount
.head 7 -  Set ml_Info = ml_Info||'Обработка сертификата '||sFiles[nIter]||PutCrLf()
.head 7 -  Set szCrtPath = szOpenKeyPath||'\\'||sFiles[nIter]
.head 7 -  Call VegaRcpName(szReceipt, GetOpenKeyDir()||'\\', 
	GetOpenKeyDir()||'\\'||'receipt.num', 0)
.head 7 -  ! Set szReceipt = szOpenKeyPath||'\\'||SalStrMidX(sFiles[nIter],0,8)||'.00#'
.head 7 -  Set nRes = VegaMail(szCrtPath, szReceipt, 0)
.head 7 +  If nRes
.head 8 -  Set szBuf = SalStrRepeatX(' ', 128)
.head 8 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 8 -  Set ml_Info = ml_Info||' - ошибка: '||szBuf||PutCrLf()
.head 7 +  Else
.head 8 -  Set ml_Info = ml_Info||' - успешно принят'||PutCrLf()
.head 8 -  Call VisFileDelete(szCrtPath)
.head 8 -  Set ml_Info = ml_Info||' - файл '||sFiles[nIter]||' удален'||PutCrLf()
.head 7 -  Set ml_Info = ml_Info||' - квитанция: '||SalStrMidX(sFiles[nIter],0,8)||'.00#'||PutCrLf()
.head 7 -  Set ml_Info = ml_Info||PutCrLf()
.head 7 -  Set nIter = nIter + 1
.head 5 +  Else
.head 6 -  Set ml_Info = ml_Info || 'Отсутствуют файлы сертификатов.'||PutCrLf()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Boolean: m_isInited	! признак инициализации
.head 3 -  Number: m_nCrtFilter	! фильтр для сертификатов(0-все, 1-текущие)
.head 3 -  String: m_szCrtID	! ID сертификата для фильтра
.head 3 -  Number: CN		! уникальный номер сертификата
.head 3 -  String: m_szCN
.head 3 -  Number: KN		! номер ключа
.head 3 -  String: m_szKN
.head 3 -  Number: CA		! номер сертификата которым подписан данный
.head 3 -  String: m_szCA
.head 3 -  String: szID		! идентификатор владельца
.head 3 -  String: m_szID
.head 3 -  String: szNM		! фио владельца
.head 3 -  String: m_szNM
.head 3 -  Number: Db		! дата начала действия сертификата
.head 3 -  Date/Time: m_dtDb
.head 3 -  Number: De		! дата завершения действия сертификата
.head 3 -  Date/Time: m_dtDe
.head 3 -  Number: Di		! дата с которой серт. считается отмененным
.head 3 -  Date/Time: m_dtDi
.head 3 -  Number: Df		! дата факта отмены сертификата
.head 3 -  Date/Time: m_dtDf
.head 3 -  Number: SrchId		! зарезервировано
.head 3 -  Number: SrchCur		! зарезервировано
.head 3 -  String: SrchKey
.head 3 -  Number: nCrtFilter
.head 3 -  String: szCrtID
.head 3 -  Number: nRes
.head 3 -  Number: m_nCrtCount	! Кол-во сертификатов в активном списке
.head 3 -  Boolean: m_bOnlyElapsed ! показывать только истекающие сертификаты
.head 3 -  String: szSignType      ! Тип ЭЦП
.head 3 -  Number: nCount ! кол-во файлов *.crt
.head 3 -  String: sFiles[*] ! массив имен файлов
.head 3 -  Number: nIter
.head 3 -  String: szReceipt
.head 3 -  String: szCrtPath
.head 3 -  String: szBuf
.head 3 -  String: szOpenKeyPath
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! Проверка типа ЭЦП
.head 4 -  Set szSignType=SalStrRepeatX(' ', 256)
.head 4 -  Call SalGetProfileString('Digital Signature', 'SignType', 'NBU', szSignType, GetIniFileName())
.head 4 +  If not szSignType = 'VEG'
.head 5 -  Call SalMessageBox('Неверный тип ЭЦП: ' || szSignType || PutCrLf() || 'Требуется: SignType=VEG', 'Ошибка',
     MB_IconStop | MB_Ok)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return 0
.head 4 -  Set ml_Info = ''
.head 4 -  ! ! Обработка основной таблицы (параметр "OpenKey")
.head 4 -  Set szOpenKeyPath=GetOpenKeyDir()
.head 4 -  Set ml_Info = ml_Info||'  ++  Таблица '||szOpenKeyPath||'  ++  '||PutCrLf()
.head 4 -  Set ml_Info = ml_Info||'--------------------------------------------------------------------------------------------------------------------'||PutCrLf()
.head 4 -  Set nRes = Init()
.head 4 +  If nRes  ! что-то не в порядке
.head 5 -  ! Нафиг с поля
.head 5 -  Call SalMessageBox('Error during initialize VEGA system', 'Error', MB_Ok | MB_IconHand)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return 0
.head 4 -  Call FillInfoWnd()
.head 4 -  Set ml_Info = ml_Info||'--------------------------------------------------------------------------------------------------------------------'||PutCrLf()
.head 4 -  ! ! Обработка дополнительной таблицы (параметр "OpenKeyAdd")
.head 4 -  Call SalGetProfileString('Digital Signature', 'OpenKeyAdd',
     '', szOpenKeyPath, GetIniFileName())
.head 4 +  If szOpenKeyPath='' ! то бишь параметр отсутствует
.head 5 -  Return 0
.head 4 -  Set ml_Info = ml_Info||PutCrLf()
.head 4 -  Set ml_Info = ml_Info||'  ++  Таблица '||szOpenKeyPath||'  ++  '||PutCrLf()
.head 4 -  Set ml_Info = ml_Info||'--------------------------------------------------------------------------------------------------------------------'||PutCrLf()
.head 4 -  Set nRes = Init()
.head 4 +  If nRes  ! что-то не в порядке
.head 5 -  ! Нафиг с поля
.head 5 -  Call SalMessageBox('Error during initialize VEGA system', 'Error', MB_Ok | MB_IconHand)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return 0
.head 4 -  Call FillInfoWnd()
.head 4 -  Set ml_Info = ml_Info||'--------------------------------------------------------------------------------------------------------------------'||PutCrLf()
.head 3 +  On SAM_Close
.head 4 -  ! ! Закрываем все
.head 4 -  Call VegaClose(0)
.head 1 +  Dialog Box: dlg_GeneralImport
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт файлов
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.317"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.762"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pb_DoImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить импорт
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    0.905"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set isOk = TRUE
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  Loop ! имитация блока try-finally
.head 7 +  If NOT SqlPrepareAndExecute(hSql(), 'begin p_trunc_tmp_sgi; end;')
.head 8 -  Set isOk = FALSE
.head 8 -  Break
.head 7 +  If nPar = 0
.head 8 +  If not PutFileToBlob(hSql(), dfPath, 'tmp_sgi', 'id', 'bin_data', 0, '', '', 1)
.head 9 -  Set isOk = FALSE
.head 9 -  Break
.head 7 +  Else If nPar = 1
.head 8 +  If not PutFileToClob(hSql(), dfPath, 'tmp_sgi', 'id', 'txt_data', 0, '', '', 1)
.head 9 -  Set isOk = FALSE
.head 9 -  Break
.head 7 +  If not SqlPrepareAndExecute(hSql(), 'begin ' || strProcedure || '; end;')
.head 8 -  Set isOk = FALSE
.head 8 -  Break
.head 7 -  Break
.head 6 +  If isOk
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalMessageBox('Импорт выполнен успешно', 'Импорт файла', MB_Ok)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Return isOk
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.171"
.head 6 -  Top:    0.405"
.head 6 -  Width:  5.217"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSetFocus(hWndItem)
.head 3 +  Pushbutton: pbChoose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать...
.head 4 -  Window Location and Size
.head 5 -  Left:   5.55"
.head 5 -  Top:    0.405"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalDlgOpenFile(hWndForm, 'Open File', strFilters, nFilters, nIndex, strFile, strPath)
.head 7 -  Set dfPath = strPath
.head 3 -  Background Text: Путь к файлу:
.head 4 -  Resource Id: 21117
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.171"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar         ! 0-трактовать файл как бинарный, 1-как текстовый
.head 3 -  String: strDirectory ! Путь к директории, из которой необходимо выбрать файл
.head 3 -  String: strProcedure ! Имя процедуры(без параметров) для обработки содержимого файла
.head 2 +  Window Variables
.head 3 -  String: strFile
.head 3 -  String: strPath
.head 3 -  String: strFilters[0:2]
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  Boolean: isOk
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set strFilters[0] = 'All files'
.head 4 -  Set strFilters[1] = '*.*'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  Set strPath = strDirectory
.head 4 +  If nPar != 0 and nPar != 1
.head 5 -  Call MessageError('Тип файла задан неверно: ' || SalNumberToStrX(nPar, 0)
||' Ожидалось значение 0/1.')
.head 5 -  Return FALSE
.head 1 +  Dialog Box: dlg_DBFExport
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экспорт данных в DBF файл
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.167"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.952"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfTableName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseTable
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.083"
.head 5 -  Top:    0.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 +  If FunNSIGet('META_TABLES', 'TABNAME', sTableId, sTableName)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Set dfDBFFilePath = GetPrnDir()||'\\'||sTableName||'.dbf'
.head 7 -  Set dfTableName =sTableName
.head 3 -  Background Text: Имя таблицы для экспорта
.head 4 -  Resource Id: 46749
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.179"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDBFFilePath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.012"
.head 6 -  Width:  5.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.583"
.head 5 -  Top:    3.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set sEncode = cmbDBFEncode.GetKey(SalListQuerySelection(cmbDBFEncode))
.head 6 -  !
.head 6 -  Set dtStart = SalDateCurrent()
.head 6 -  !
.head 6 -  ! =0, через память,  = 1 через временн табл tmp_lob
.head 6 -  Set nExportType =  rbTransTmpTable
.head 6 -  !
.head 6 -  !
.head 6 +  If ExportDbf(sTableName, dfDBFFilePath, sEncode, nExportType, sErrMsg)
.head 7 -  Call SalMessageBox('Экспорт таблицы в DBF файл выполнен!', 'Внимание', MB_Ok | MB_IconAsterisk)
.head 7 -  Call SqlCommitEx(hSql(),'Выполнен экспорт таблицы '||sTableName||' в файл '||dfDBFFilePath)
.head 7 -  Set dfFileLength = VisFileGetSize(dfDBFFilePath)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Ошибка экспорта таблицы в DBF файл: ' || sErrMsg, 'Внимание', MB_IconAsterisk)
.head 6 -  !
.head 6 -  !
.head 6 -  Set dtStop = SalDateCurrent()
.head 6 -  Set dfTime = GetTimeInterval(dtStart,dtStop)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    3.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm,0)
.head 3 +  Combo Box: cmbDBFEncode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    2.071"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call cmbDBFEncode.Init(hWndItem)
.head 6 -  Call SalListClear(hWndItem)
.head 6 -  Call cmbDBFEncode.Add('DOS', 'DOS - cp866')
.head 6 -  Call cmbDBFEncode.Add('UKG', 'UKG - укр.гост')
.head 6 -  Call cmbDBFEncode.Add('WIN', 'WIN - win1251')
.head 6 -  Call cmbDBFEncode.SetSelectById('DOS')
.head 3 -  Group Box:
.head 4 -  Resource Id: 46751
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  6.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box:
.head 4 -  Resource Id: 46752
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    2.833"
.head 5 -  Width:  6.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.81"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbTransTmpTable
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: времм.табл.
.head 4 -  Window Location and Size
.head 5 -  Left:   4.183"
.head 5 -  Top:    2.06"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTransMemory = FALSE
.head 6 -  Set rbTransTmpTable = TRUE
.head 3 +  Radio Button: rbTransMemory
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: память
.head 4 -  Window Location and Size
.head 5 -  Left:   2.95"
.head 5 -  Top:    2.06"
.head 5 -  Width:  1.033"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTransMemory = TRUE
.head 6 -  Set rbTransTmpTable = FALSE
.head 3 -  Background Text: Время экспорта:
.head 4 -  Resource Id: 46753
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.536"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTime
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    2.488"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Экспорт через:
.head 4 -  Resource Id: 46754
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.883"
.head 5 -  Top:    1.821"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Кодировка DBF файла
.head 4 -  Resource Id: 46755
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.821"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Размер файла:
.head 4 -  Resource Id: 56980
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.44"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFileLength
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.717"
.head 6 -  Top:    1.357"
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #########
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Имя DBF файла для экспорта
.head 4 -  Resource Id: 56981
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.762"
.head 5 -  Width:  5.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: ExportUseMemory
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTableName
.head 5 -  String: sDBFFilePath
.head 5 -  String: sEncode
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! выгрузка dbf в переменную пакета bars_dbf
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_dbf.export_dbf_cnt(sTableName, sEncode)")
.head 6 -  Set sErrMsg = 'Ошибка выгрузки данных таблицы'
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! выгрузка переменной пакета bars_dbf в файл
.head 6 +  If not DownloadDBFfile(hSql(), sDBFFilePath, OF_Create)
.head 7 -  Set sErrMsg = 'Ошибка выгрузки данных в файл'
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: ExportUseTmpTable
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTableName
.head 5 -  String: sDBFFilePath
.head 5 -  String: sEncode
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! выгрузка dbf и помещение его во временную таблицу tmp_lob
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_ies.export_to_dbf(sTableName, sEncode)")
.head 6 -  Set sErrMsg = 'Ошибка выгрузки данных таблицы'
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  ! выгрузка данных из временной таблицы tmp_lob в файл
.head 6 +  If not PutTmpLobToFile(hSql(),sDBFFilePath,'B', OF_Create)
.head 7 -  Set sErrMsg = 'Ошибка выгрузки данных таблицы в файл'
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: ExportDbf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTableName
.head 5 -  String: sDBFFilePath
.head 5 -  String: sEncode
.head 5 -  Number: nExportType
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nExportType = 0
.head 6 -  Return ExportUseMemory(sTableName, sDBFFilePath, sEncode, sErrMsg)
.head 5 +  If nExportType = 1
.head 6 -  Return ExportUseTmpTable(sTableName, sDBFFilePath, sEncode,  sErrMsg)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sTableName
.head 3 -  String: sTableId
.head 3 -  String: sEncode
.head 3 -  String: sErrMsg
.head 3 -  Date/Time: dtStart
.head 3 -  Date/Time: dtStop
.head 3 -  Number: nExportType
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set dfDBFFilePath  = GetPrnDir()
.head 4 -  Set rbTransMemory = TRUE
.head 4 -  Set rbTransTmpTable = FALSE
.head 1 +  Dialog Box: dlg_DBFImport
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт DBF файла
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.75"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilePath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.383"
.head 5 -  Top:    0.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalDlgOpenFile(dlg_DBFImport, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 7 -  Set dfFilePath = sFilePathName
.head 7 -  Set dfTableName = SalStrUpperX(SalStrLeftX(sFileName, SalStrScan(sFileName,'.')))
.head 7 -  Set dfFileLength = VisFileGetSize(sFilePathName)
.head 7 -  !
.head 7 -  ! Если есть DBT
.head 7 -  Set sFileMEMOPathName = SalStrLeftX(sFilePathName, SalStrScan(sFilePathName,sFileName))
.head 7 -  Set sFileMEMOPathName = sFileMEMOPathName|| dfTableName ||'.DBT'
.head 7 -  !
.head 7 -  !
.head 7 -  Set s = VisFileFind(sFileMEMOPathName||'.DBT')
.head 7 +  If s = STRING_Null
.head 8 -  Set s = VisFileFind(sFileMEMOPathName||'.FPT')
.head 7 -  !
.head 7 +  If s != STRING_Null
.head 8 -  Call SalShowWindow(dLblFieSizeMemo)
.head 8 -  Call SalShowWindow(dfLblMemo)
.head 8 -  Set sFileMEMOPathName = s
.head 8 -  Set dLblFieSizeMemo = VisFileGetSize(sFileMEMOPathName)
.head 8 -  Set dfLblMemo = 'МЕМО файл:'
.head 7 +  Else
.head 8 -  Call SalHideWindow(dLblFieSizeMemo)
.head 8 -  Call SalHideWindow(dfLblMemo)
.head 3 +  Data Field: dfTableName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.238"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Имя таблицы, куда импортировать данные
.head 4 -  Resource Id: 2612
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.036"
.head 5 -  Width:  4.233"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.683"
.head 5 -  Top:    2.81"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set sEncode = cmbSrcEncode.GetKey(SalListQuerySelection(cmbSrcEncode))
.head 6 -  !
.head 6 -  Set dtStart = SalDateCurrent()
.head 6 -  !
.head 6 +  If not IsTableExists(dfTableName, nTableExists, sErrMsg)
.head 7 -  Call SalMessageBox(sErrMsg,'Внимание', MB_IconAsterisk)
.head 6 +  If nTableExists = 1  
.head 7 -  Set nAnswer = SalMessageBox('Таблица с таким именем уже существует, создать новую?','Внимание',  MB_OkCancel | MB_IconAsterisk)
.head 6 -  !
.head 6 -  !
.head 6 -  ! =0, через память,  = 1 через временн табл tmp_lob
.head 6 -  Set nImportType =  rbTransTmpTable
.head 6 -  !
.head 6 -  Set dtStart = SalDateCurrent()
.head 6 -  !
.head 6 +  If nTableExists = 0 or (nTableExists = 1 and nAnswer = IDOK)
.head 7 -  !
.head 7 -  Set sFilePath = SalStrLeftX(sFilePathName, SalStrScan(sFilePathName, sFileName) - 1)
.head 7 +  If ImportDbf(sFilePath, 
             sFileName, 
             dlg_DBFImport.dfTableName, 
             sEncode, 
             IMP_TAB_RECR, 
             1,
             rbTransTmpTable, 
             sErrMsg)
.head 8 -  Call SalMessageBox('Импорт DBF файла выполнен!', 'Внимание', MB_Ok | MB_IconAsterisk)
.head 8 -  Call SqlCommitEx(hSql(),'Выполнен импорт данных файла '||sFilePath||'\\'||sFileName||' в таблицу '||dlg_DBFImport.dfTableName)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Ошибка импорта файла: ' || sErrMsg, 'Внимание', MB_IconAsterisk)
.head 7 -  Set dtStop = SalDateCurrent()
.head 7 -  Set dfTime = GetTimeInterval(dtStart,dtStop)
.head 6 -  !
.head 6 -  !
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    2.81"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm,0)
.head 3 +  Combo Box: cmbSrcEncode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.929"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call cmbSrcEncode.Init(hWndItem)
.head 6 -  Call SalListClear(hWndItem)
.head 6 -  Call cmbSrcEncode.Add('DOS', 'DOS - cp866')
.head 6 -  Call cmbSrcEncode.Add('UKG', 'UKG - укр.гост')
.head 6 -  Call cmbSrcEncode.Add('WIN', 'WIN - win1251')
.head 6 -  Call cmbSrcEncode.SetSelectById('DOS')
.head 3 -  Group Box:
.head 4 -  Resource Id: 30263
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    -0.02"
.head 5 -  Width:  6.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.595"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box:
.head 4 -  Resource Id: 30264
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    2.583"
.head 5 -  Width:  6.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Время импорта:
.head 4 -  Resource Id: 53869
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    2.405"
.head 5 -  Width:  1.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTime
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    2.321"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Radio Button: rbTransTmpTable
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: времм.табл.
.head 4 -  Window Location and Size
.head 5 -  Left:   4.583"
.head 5 -  Top:    1.917"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTransMemory = FALSE
.head 6 -  Set rbTransTmpTable = TRUE
.head 3 +  Radio Button: rbTransMemory
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: память
.head 4 -  Window Location and Size
.head 5 -  Left:   3.417"
.head 5 -  Top:    1.917"
.head 5 -  Width:  1.033"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTransMemory = TRUE
.head 6 -  Set rbTransTmpTable = FALSE
.head 3 -  Group Box: Импорт через:
.head 4 -  Resource Id: 46758
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    1.679"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Кодировка DBF файла
.head 4 -  Resource Id: 46757
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.679"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Размер DBF:
.head 4 -  Resource Id: 56978
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.667"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFileLength
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.55"
.head 6 -  Top:    0.667"
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #########
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: DBF файл для импорта
.head 4 -  Resource Id: 56979
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dLblFieSizeMemo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.667"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLblMemo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbForceMemo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.383"
.head 5 -  Top:    0.655"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sFileName
.head 3 -  String: sFilePath
.head 3 -  String: sFilePathName
.head 3 -  String: sFileMEMOPathName
.head 3 -  String: sFilters[0:2]
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  Number: nImportType
.head 3 -  String: sEncode
.head 3 -  String: s
.head 3 -  String: sErrMsg
.head 3 -  Number: nTableExists
.head 3 -  Number: nAnswer
.head 3 -  Date/Time: dtStop
.head 3 -  Date/Time: dtStart
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sFilters[0] = 'DBF files'
.head 4 -  Set sFilters[1] = '*.dbf'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  Set rbTransMemory = TRUE
.head 4 -  Set rbTransTmpTable = FALSE
.head 4 -  Call SalHideWindow(dLblFieSizeMemo)
.head 4 -  Call SalHideWindow(cbForceMemo)
.head 4 -  Call SalHideWindow(dfLblMemo)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(dlg_DBFImport)
.head 1 +  ! Dialog Box: dlg_ImpXMLFmt
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Імпорт документів із зовнішніх задач через формат XML
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.317"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.06"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -   Description: 
.head 2 +   Tool Bar 
.head 3 -   Contents 
.head 2 +   Contents 
.head 3 +   Data Field: dfFilePath
.head 4 -   Message Actions 
.head 3 +   Pushbutton: pbChooseFile
.head 4 +   Message Actions 
.head 5 +   On SAM_Click
.head 6 -  ! Call ClearAllProtocols()
.head 6 +   If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 7 -   Set dfFilePath = sFilePathName
.head 7 -   Set sPath =  SalStrLeftX(sFilePathName, SalStrScan(sFilePathName, sFileName)-1)
.head 3 -   Background Text: Файл для імпорту
.head 3 +   Pushbutton: pbOk
.head 4 +   Message Actions 
.head 5 +   On SAM_Click
.head 6 -  !
.head 6 -   Call ClearAllProtocols()
.head 6 -   Call SalWaitCursor(TRUE)
.head 6 +  If MakeImport(sErrMessage) != 0 
.head 7 -  Call SalMessageBox(sErrMessage, 'Увага!', MB_Ok | MB_IconExclamation)
.head 6 +   Else 
.head 7 -  Call SalMessageBox('Імпорт виконано успішно. Файл буде перенесено в архів ' || sFileBckpPathName || '\\' ||
      sFileName, '', MB_Ok | MB_IconAsterisk)
.head 7 -  Call VisFileRename(dfFilePath, sFileBckpPathName || '\\' || sFileName)
.head 6 -   Call SalWaitCursor(FALSE)
.head 6 -  !
.head 6 -  ! Показать ко-во обр. док-тов свего, успешно обработтаных, неуспешно обработанных
.head 3 +   Pushbutton: pbCancel
.head 4 +   Message Actions 
.head 5 +   On SAM_Click
.head 6 -   Call SalEndDialog(hWndForm,0)
.head 3 -   Frame 
.head 3 +   Data Field: dfFileProcessStatusOk
.head 4 -   Message Actions 
.head 3 +   Data Field: dfOkDocCnt
.head 4 -   Message Actions 
.head 3 +   Data Field: dfBadDocCnt
.head 4 -   Message Actions 
.head 3 -   Background Text: Неуспішно оброблено:
.head 3 -   Background Text: Всього у файлі док-тів:
.head 3 -   Background Text: Із них успішно оброблено:  
.head 3 -   Background Text: 
Протокол дій по імпорту
.head 3 -   Frame 
.head 3 -   Frame 
.head 3 -   Background Text: Тип імпорту
.head 3 +   Child Table: tblImpLog
.head 4 +   Contents 
.head 5 +   Column: colN
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colErrCode
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colNlsa
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colNlsb
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colS
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colKv
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colSK
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colNazn
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colErrMsg
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 4 -   Functions 
.head 4 -   Window Variables 
.head 4 +   Message Actions 
.head 5 +   On SAM_FetchRowDone
.head 6 -  !
.head 6 +   If tblImpLog.colErrCode != '0000'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255,220,255))
.head 3 +   List Box: lbLog
.head 4 -   List Initialization 
.head 4 -   Message Actions 
.head 3 -   Group Box: Протокол сплати докумнтів
.head 3 +   Combo Box: cmbImpType
.head 4 -   List Initialization 
.head 4 -   Message Actions 
.head 3 -   Background Text: Результат обробки:
.head 3 +   Data Field: dfAllDocCnt
.head 4 -   Message Actions 
.head 3 -   Background Text: успішно оброблено:
.head 3 +   Data Field: dfFileProcessStatusBad
.head 4 -   Message Actions 
.head 3 -   Background Text: Сума файлу:
.head 3 +   Data Field: dfFileSum
.head 4 -   Message Actions 
.head 2 +   Functions 
.head 3 +  ! Function: ImportDocsFile
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 +   Parameters 
.head 5 -   String: sFilePathName
.head 5 -   String: sCfgFilePathName
.head 4 -   Static Variables 
.head 4 -   Local variables 
.head 4 +   Actions 
.head 5 +   If Convert(sFilePathName, 'output.xml', sCfgFilePathName) != 0
.head 6 -  Call SalMessageBox(GetLastError(), 'Увага', MB_Ok | MB_IconAsterisk)
.head 5 +   Else 
.head 6 -  Call SalMessageBox('Converted!', 'Увага', MB_Ok | MB_IconAsterisk)
.head 3 +   Function: LogStep
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 +   Parameters 
.head 5 -   String: sMess
.head 5 -   Number: sMessType
.head 4 -   Static Variables 
.head 4 -   Local variables 
.head 4 +   Actions 
.head 5 -  Call SalListAdd(lbLog, IifS(sMessType = 0, '+', '-') || ' ' || sMess)
.head 3 +   Function: LogJournal
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 -   Parameters 
.head 4 -   Static Variables 
.head 4 -   Local variables 
.head 4 +   Actions 
.head 5 -   Call SalTblPopulate(tblImpLog, hSql(), 
T('select n, nlsa, nlsb, s, nazn, sk, substr(errmsg,1,150), kv, errcode
   into 
         :tblImpLog.colN, :tblImpLog.colNlsa,:tblImpLog.colNlsb, 
         :tblImpLog.colS, :tblImpLog.colNazn,:tblImpLog.colSK, 
         :tblImpLog.colErrMsg, :tblImpLog.colKv, :tblImpLog.colErrCode
   from tmp_impklbx 
   order by n '), TBL_FillAll)
.head 5 -  ! While SqlFetchNext(hSql(), nFetchRes)
.head 3 +   Function: MakeImport
.head 4 -   Description: 
.head 4 +   Returns 
.head 5 -   Number: nErrCode
.head 4 +   Parameters 
.head 5 -   Receive String: nErrMessage
.head 4 -   Static Variables 
.head 4 +   Local variables 
.head 5 -   Number: nImpType
.head 5 -   Number: nReturnCode
.head 5 -   String: sConvertErr
.head 5 -   Long String: sErrMess
.head 5 -   Number: iErrMessLen
.head 4 +   Actions 
.head 5 -  Set nImpType = SalListQuerySelection(cmbImpType)
.head 5 -  !
.head 5 -  !
.head 5 +   If nImpType = -1
.head 6 -   Set nErrMessage = 'Не вибрано тип імпорту'
.head 6 -   Return 1
.head 5 -  !
.head 5 -  !
.head 5 +   If dfFilePath= '' OR  dfFilePath = STRING_Null
.head 6 -   Set nErrMessage = 'Не вибрано файл для імпорту'
.head 6 -   Return 1
.head 5 -  !
.head 5 -   Call LogStep('Початок конвертації файлу в XML формат', IMPDOC_OK)
.head 5 -  !
.head 5 -  ! Конвертация из ихнего формата в наi XML
.head 5 -   Set iErrMessLen = 3072
.head 5 -   Call SalStrSetBufferLength(sErrMess, iErrMessLen)
.head 5 +   If Convert(nImpType, dfFilePath, sFileOutPathName, sErrMess, iErrMessLen) = 0
.head 6 -   Call LogStep('Файл ушпішно сконвертовано', IMPDOC_OK)
.head 6 -  ! загрузка output.xml файла во временную таблицу tmp_lob
.head 6 +  If PutFileToTmpLob(hSql(), sFileOutPathName,'C')
.head 7 -   Call LogStep('Успішно загрузили файл в БД', IMPDOC_OK)
.head 7 +   If SqlPLSQLCommand(hSql(),"bars_xmlklb.import_doc_cnt(sFileName, nReturnCode)")
.head 8 -   Call LogStep('Успішно виканали функцію обробки', IMPDOC_OK)
.head 8 +   If nReturnCode = 0
.head 9 -   Call LogStep('Всі докумнти сплачені', IMPDOC_OK)
.head 9 -   Call LogJournal()
.head 9 -   Call ShowImportResults()
.head 9 -   Call SqlCommit(hSql())
.head 9 -   Return 0
.head 8 +   Else 
.head 9 -   Call LogStep('Деякі документи не сплачені', IMPDOC_FAIL)
.head 9 -   Call LogStep('Вцілому файл - відбраковано', IMPDOC_FAIL)
.head 9 -   Call LogJournal()
.head 9 -   Call ShowImportResults()
.head 9 -   Call SqlRollback(hSql())
.head 9 -   Set nErrMessage = 'Помилки при сплаті документів'
.head 9 -   Return 1
.head 7 +   Else 
.head 8 -   Call LogStep('Неуспішне виконання сплати документів', IMPDOC_FAIL)
.head 8 -   Set nErrMessage = 'Неуспішне виконання функції обробки'
.head 8 -   Return 1
.head 6 +   Else 
.head 7 -   Call LogStep('Неуспешная загрузка файла в БД', IMPDOC_FAIL)
.head 7 -  Call SalMessageBox('Неуспешная загрузка файла в БД', 'Увага', MB_Ok | MB_IconAsterisk)
.head 7 -   Set nErrMessage = 'Неуспішна загрузка файла в БД'
.head 7 -   Return 1
.head 5 +   Else 
.head 6 -   Set sConvertErr = sErrMess 
.head 6 -   Call LogStep('Ошибка конвертации файла в XML формат:', IMPDOC_FAIL)
.head 6 -   Call LogStep(sConvertErr, IMPDOC_FAIL)
.head 6 -   Set nErrMessage = sConvertErr
.head 6 -   Return 1
.head 5 -  !
.head 3 +   Function: ShowImportResults
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 -   Parameters 
.head 4 -   Static Variables 
.head 4 +   Local variables 
.head 5 -   Number: nAllCnt
.head 5 -   Number: nBadCnt
.head 5 -   Number: nOkCnt
.head 5 -   Number: nFetchRes
.head 4 +   Actions 
.head 5 -   Call SqlPrepareAndExecute(hSql(),
    "select count(*) allcnt, 
            sum(decode(errcode,'0000', 1, 0)) okcnt, 
            sum(decode(errcode,'0000', 0, 1)) badcnt,
            sum(s)/100
     into :nAllCnt, :nOkCnt, :nBadCnt , :dfFileSum 
     from tmp_impklbx")
.head 5 +  If SqlFetchNext(hSql(), nFetchRes)
.head 6 -   Set dfAllDocCnt = nAllCnt
.head 6 -   Set dfOkDocCnt = nOkCnt
.head 6 -   Set dfBadDocCnt = nBadCnt
.head 6 +   If nBadCnt = 0
.head 7 -   Call SalHideWindow(dfFileProcessStatusBad)
.head 7 -   Call SalShowWindow(dfFileProcessStatusOk)
.head 7 -   Set dfFileProcessStatusOk = 'Файл успішно оброблено'
.head 6 +   Else 
.head 7 -   Call SalShowWindow(dfFileProcessStatusBad)
.head 7 -   Call SalHideWindow(dfFileProcessStatusOk)
.head 7 -   Set dfFileProcessStatusBad = 'Файл відбраковано'
.head 3 +   Function: ClearAllProtocols
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 -   Parameters 
.head 4 -   Static Variables 
.head 4 -   Local variables 
.head 4 +   Actions 
.head 5 -   Call SalShowWindow(dfFileProcessStatusOk)
.head 5 -   Call SalHideWindow(dfFileProcessStatusBad)
.head 5 -   Set dfFileProcessStatusOk = ''
.head 5 -   Set dfFileProcessStatusBad = ''
.head 5 -   Set dfOkDocCnt = NUMBER_Null
.head 5 -   Set dfBadDocCnt = NUMBER_Null
.head 5 -   Set dfAllDocCnt = NUMBER_Null
.head 5 -   Call SalListClear(lbLog)
.head 2 -   Window Parameters 
.head 2 +   Window Variables 
.head 3 -   String: sFilters[0:2]
.head 3 -   Number: nFilters
.head 3 -   Number: nIndex
.head 3 -   Date/Time: dtStartImp
.head 3 -   Date/Time: dtStopImp
.head 3 -   Date/Time: dtStartImpAll
.head 3 -   Date/Time: dtStopImpAll
.head 3 -   String: sFilePathName
.head 3 -   String: sFileOutPathName
.head 3 -   String: sFileName
.head 3 -   String: sPath
.head 3 -   Number: nImpTypeCnt
.head 3 -   Number: i
.head 3 -  !
.head 3 -   String: sErrMessage
.head 3 -   Number: nErrCode
.head 3 -   String: sFileBckpPathName ! директория архива
.head 3 -  !
.head 2 +   Message Actions 
.head 3 +   On SAM_Create
.head 4 -   Set sFilters[0] = 'Al files'
.head 4 -   Set sFilters[1] = '*.*'
.head 4 -   Set nFilters = 2
.head 4 -   Set dfFilePath = ''
.head 4 -   Set nIndex = 1
.head 4 -   Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -   Call SalGetProfileString('Import', 'XMLDocPath', 'c:\\', sFilePathName, 'Bars98')
.head 4 -  !
.head 4 -   Call SalUseRegistry(FALSE, '')
.head 4 -   Call SalGetProfileString('Import', 'XMLDocBckp', '', sFileBckpPathName, GetIniFileName())
.head 4 -  !
.head 4 +   If sFileBckpPathName = STRING_Null
.head 5 -  Call SalMessageBox('В файле ini не вказано параметр XMLDocBckp(секція [Import])-директорія для архіву файлів импорту!',
      'Увага', MB_Ok | MB_IconAsterisk)
.head 4 +   If sFilePathName = STRING_Null
.head 5 -  Call SalMessageBox('В файле ini не вказано параметр XMLDocPath(секція [Import])-директорія для файлів импорту!',
      'Увага', MB_Ok | MB_IconAsterisk)
.head 4 +   Else 
.head 5 -   Set dfFilePath = sFilePathName
.head 5 -   Set sFileOutPathName = sFilePathName||'\\out.xml'
.head 4 -  !
.head 4 -   Set nImpTypeCnt = getLoadDllCount()
.head 4 -  !
.head 4 -   Set i = 0
.head 4 +  While i < nImpTypeCnt
.head 5 -   Call SalListAdd(cmbImpType, getLoadDllDescription(i))
.head 5 -   Set i = i+1
.head 3 +   On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
.head 3 +   On SAM_Destroy
.head 4 -   Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -   Call SalSetProfileString('Import', 'XMLDocBckp', sPath , 'bars98')
.head 1 +  Dialog Box: dlg_DirSelect
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Директория отчета
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: System Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.267"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.536"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.5"
.head 5 -  Top:    2.667"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText(hWndForm, 'Завершить')
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    2.667"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sChooseDir = SalStrLeftX(lbDir.GetSelectedDir(), SalStrLength(lbDir.GetSelectedDir())-1)
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Combo Box: cmbDrive
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDriveComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.014"
.head 5 -  Top:    2.156"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.063"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call lbDir.Populate(cmbDrive.GetSelectedDrive())
.head 3 -  Frame
.head 4 -  Resource Id: 26340
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.014"
.head 5 -  Top:    2.488"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 26341
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.014"
.head 5 -  Top:    0.031"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.542"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 26342
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.014"
.head 5 -  Top:    2.156"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  List Box: lbDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDirListBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.014"
.head 5 -  Top:    0.073"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sInitDir
.head 3 -  Receive String: sChooseDir
.head 2 +  Window Variables
.head 3 -  String: strCurrDir
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call lbDir.Populate(sInitDir)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_ImportSkarb
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "СКАРБ6"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.063"
.head 4 -  Top:    0.073"
.head 4 -  Width:  16.933"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.119"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных SKARB6 --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.036"
.head 6 -  Width:  16.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
К-во ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM P_MIGRASK
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Check Box: cb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнять проверку наличия БАЛАНСА
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    6.798"
.head 5 -  Width:  4.45"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nBal
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set nBal = cb1
.head 6 -  Set sCommand = tbl1.colPROC || '(nNum,nErr,nBal)'
.head 6 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call MessageNoWait('Отсутствует процедура импорта!', 'ОШИБКА', 17, 1)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! String: sODBCDir
.head 3 -  ! Date/Time: dTmp
.head 3 -  ! String: strBankA
.head 3 -  ! Sql Handle: hSqlOdbcTemp
.head 3 -  ! Boolean: bStatus
.head 3 -  ! Number: nRecCount
.head 3 -  ! Number: nRecCntCustomer
.head 3 -  ! Number: nRecCntCorps
.head 3 -  ! Number: nRecCntPerson
.head 3 -  ! Number: nRecCntCustbank
.head 3 -  ! Number: nCountry
.head 3 -  ! String: strPbox
.head 3 -  ! String: strOkpo
.head 3 -  ! String: strPg
.head 3 -  ! String: strTemp
.head 3 -  ! Number: nTgr
.head 3 -  ! Number: nLastAcc
.head 3 -  ! Number: nRnkCount
.head 3 -  ! Number: nPos
.head 3 -  ! Number: nDelta
.head 3 -  ! String: SavDatabase
.head 3 -  ! String: SavUser
.head 3 -  ! String: SavPassword
.head 3 -  ! Date/Time: dBankDate
.head 3 -  ! Number: nIr_c
.head 3 -  ! Number: nIr_d
.head 3 -  ! Number: nPR
.head 3 -  ! String: sPR
.head 3 -  ! Number: nFlagPR
.head 3 -  !
.head 3 -  ! Number: nIspNone
.head 3 -  ! String: sIspNone
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  ! Window Handle: hRow
.head 3 -  Number: nC
.head 3 -  ! String: sErr
.head 3 -  ! Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set cb1 = 1
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO   :nC
   FROM   oper
   WHERE  sos>0 and tt not in ('013','REV','PVP','МГР')") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set nC = 0
.head 4 +  If nC > 0
.head 5 -  Call MessageNoWait('Функция импорта не может быть выполнена: в OPER уже есть оплаченные документы (' || Str(nC) ||
     ') !', 'ОШИБКА!', 17, 1)
.head 5 -  Call SalEndDialog(hWndForm, FALSE)
.head 1 +  Dialog Box: dlg_ImportFSkarb5
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "СКАРБ5" (ф)  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   -2.263"
.head 4 -  Top:    -0.021"
.head 4 -  Width:  16.967"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.119"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных SKARB5 (филиал) --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM P_MIGRASKS5
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    6.881"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.131"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.381"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 5267
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    7.155"
.head 5 -  Width:  1.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 5268
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF-файлов СКАРБа5
.head 4 -  Resource Id: 5269
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    6.821"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов СКАРБа5
.head 4 -  Resource Id: 7115
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.367"
.head 5 -  Top:    7.286"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSKARB5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.024"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSKARB5arc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.488"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 5270
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    6.75"
.head 5 -  Width:  4.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код филиала (МФО)
.head 4 -  Resource Id: 5271
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFILIAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    6.833"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    7.119"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата перевода филиала
.head 4 -  Resource Id: 5272
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.15"
.head 5 -  Top:    7.143"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 5273
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.117"
.head 5 -  Begin Y:  6.857"
.head 5 -  End X:  9.117"
.head 5 -  End Y:  7.643"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  String: sKodirowka
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 11) != 'SKARB5TABLE'
.head 6 +  If dfFILIAL != STRING_Null
.head 7 -  ! выполнение процедуры
.head 7 -  Call SalInvalidateWindow(tbl1)
.head 7 -  Set nNum = 0
.head 7 -  Set nErr = 0
.head 7 -  Set sCommand = tbl1.colPROC || '(dfFILIAL,nNum,nErr,dfDATX)'
.head 7 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 7 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colDone = nNum
.head 8 -  Set tbl1.colErr = nErr
.head 7 +  Else
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colErr = 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - не задан Код филиала (МФО)')
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'SKARB5TABLE'
.head 7 -  ! загрузка DBF-файлов SKARBа5
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\ANKETA.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'ANKETA.DBF',
             'S6_S5_ANKETA',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\ANKETA.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\ANKETA.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\ANKETA.dbf', sSkarb5ArcDir || '\\ANKETA.dbf')
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT name
   INTO   :dfFILIAL
   FROM   S6_S5_ANKETA
   WHERE  sign='МФО'") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dfFILIAL = STRING_Null
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error ANKETA.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\ANKETA.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ANKETA.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'USERS.DBF',
             'S6_S5_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\USERS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\USERS.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\USERS.dbf', sSkarb5ArcDir || '\\USERS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\USERS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): Load error USERS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\CLIENT.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'CLIENT.DBF',
             'S6_S5_CLIENT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\CLIENT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\CLIENT.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\CLIENT.dbf', sSkarb5ArcDir || '\\CLIENT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error CLIENT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\CLIENT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6): Load error CLIENT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\SALDO.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'SALDO.DBF',
             'S6_S5_SALDO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\SALDO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\SALDO.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\SALDO.dbf', sSkarb5ArcDir || '\\SALDO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error SALDO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\SALDO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error SALDO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\HIST_PR.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'HIST_PR.DBF',
             'S6_S5_HIST_PR',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\HIST_PR.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\HIST_PR.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\HIST_PR.dbf', sSkarb5ArcDir || '\\HIST_PR.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error HIST_PR.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\HIST_PR.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error HIST_PR.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\SPECPARA.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'SPECPARA.DBF',
             'S6_S5_SPECPARA',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\SPECPARA.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\SPECPARA.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\SPECPARA.dbf', sSkarb5ArcDir || '\\SPECPARA.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error SPECPARA.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\SPECPARA.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(12): Load error SPECPARA.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  ! Здесь продолжить грузить дополнительные (справочные) таблицы
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\FILIAL.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'FILIAL.DBF',
             'S6_S5_FILIAL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\FILIAL.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\FILIAL.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\FILIAL.dbf', sSkarb5ArcDir || '\\FILIAL.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error FILIAL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\FILIAL.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error FILIAL.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\SHABLON.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'SHABLON.DBF',
             'S6_S5_SHABLON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\SHABLON.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\SHABLON.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\SHABLON.dbf', sSkarb5ArcDir || '\\SHABLON.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error SHABLON.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\SHABLON.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error SHABLON.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\DEPO.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'DEPO.DBF',
             'S6_S5_DEPO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\DEPO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\DEPO.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\DEPO.dbf', sSkarb5ArcDir || '\\DEPO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error DEPO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\DEPO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error DEPO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\GROUP_C.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'GROUP_C.DBF',
             'S6_S5_GROUP_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\GROUP_C.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\GROUP_C.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\GROUP_C.dbf', sSkarb5ArcDir || '\\GROUP_C.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error GROUP_C.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\GROUP_C.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error GROUP_C.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb5Dir || '\\TRANSIT.DBF')
.head 8 +  If ImportDbf(sSkarb5Dir,
             'TRANSIT.DBF',
             'S6_S5_TRANSIT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb5ArcDir || '\\TRANSIT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb5ArcDir || '\\TRANSIT.dbf')
.head 9 -  Call VisFileRename(sSkarb5Dir || '\\TRANSIT.dbf', sSkarb5ArcDir || '\\TRANSIT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(21): Load error TRANSIT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb5ArcDir || '\\TRANSIT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(22): Load error TRANSIT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraSK.copy_skarb5_tables(dfFILIAL)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sSkarb5Dir
.head 3 -  String: sSkarb5ArcDir
.head 3 -  Number: nT
.head 3 -  String: sDATX
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'Skarb5Path', '', sSkarb5Dir, GetIniFileName())
.head 4 -  Set sSkarb5Dir = IifS(Right(sSkarb5Dir, 1)='\\', Left(sSkarb5Dir, Len(sSkarb5Dir)-1), sSkarb5Dir) ! каталог СКАРБа5
.head 4 -  Set dfSKARB5 = sSkarb5Dir
.head 4 -  Call SalGetProfileString('Import', 'Skarb5ArcPath', '', sSkarb5ArcDir, GetIniFileName())
.head 4 -  Set sSkarb5ArcDir = IifS(Right(sSkarb5ArcDir, 1)='\\', Left(sSkarb5ArcDir, Len(sSkarb5ArcDir)-1), sSkarb5ArcDir) ! архив
.head 4 -  Set dfSKARB5arc = sSkarb5ArcDir
.head 4 -  !
.head 4 -  Set rbWin = 0
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 1
.head 4 -  ! Set dfDATX = SalDateCurrent()
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DATX', '', sDATX, '')
.head 4 +  If Len(sDATX) = 0
.head 5 -  Set dfDATX = SalDateCurrent()
.head 4 +  Else
.head 5 -  Set dfDATX = SalStrToDate(sDATX)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('S6_S5_ANKETA')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT name
   INTO   :dfFILIAL
   FROM   S6_S5_ANKETA
   WHERE  sign='МФО'") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDATX, sDATX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DATX', sDATX, '')
.head 1 +  Dialog Box: dlg_ImportFSkarb6
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "СКАРБ6" (ф)  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.038"
.head 4 -  Top:    0.073"
.head 4 -  Width:  16.95"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.119"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных SKARB6 (филиал) --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.024"
.head 6 -  Width:  16.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM P_MIGRASKS6
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    6.881"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.131"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.381"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 5274
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    7.155"
.head 5 -  Width:  1.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 5275
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF-файлов СКАРБа6
.head 4 -  Resource Id: 5276
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    6.821"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов СКАРБа6
.head 4 -  Resource Id: 8502
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    7.31"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSKARB6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.036"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSKARB6arc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.524"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 5277
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    6.738"
.head 5 -  Width:  4.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.071"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код филиала (МФО)
.head 4 -  Resource Id: 5278
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFILIAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    6.833"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    7.119"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата перевода филиала
.head 4 -  Resource Id: 5279
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.15"
.head 5 -  Top:    7.143"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 5280
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.117"
.head 5 -  Begin Y:  6.857"
.head 5 -  End X:  9.117"
.head 5 -  End Y:  7.643"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  String: sKodirowka
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 11) != 'SKARB6TABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sCommand = tbl1.colPROC || '(dfFILIAL,nNum,nErr,dfDATX)'
.head 6 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'SKARB6TABLE'
.head 7 -  ! загрузка DBF-файлов SKARBа6
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\addresses.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'addresses.dbf',
             'S6_S6_addresses',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\addresses.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\addresses.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\addresses.dbf', sSkarb6ArcDir || '\\addresses.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error addresses.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\addresses.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error addresses.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Certificates.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Certificates.dbf',
             'S6_S6_Certificates',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Certificates.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Certificates.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Certificates.dbf', sSkarb6ArcDir || '\\Certificates.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error Certificates.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Certificates.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): Load error Certificates.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\ChargePr.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'ChargePr.dbf',
             'S6_S6_ChargePr',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\ChargePr.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\ChargePr.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\ChargePr.dbf', sSkarb6ArcDir || '\\ChargePr.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error ChargePr.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\ChargePr.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6): Load error ChargePr.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Clients.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Clients.dbf',
             'S6_S6_Clients',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Clients.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Clients.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Clients.dbf', sSkarb6ArcDir || '\\Clients.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error Clients.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Clients.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error Clients.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Contract.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Contract.dbf',
             'S6_S6_Contract',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Contract.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Contract.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Contract.dbf', sSkarb6ArcDir || '\\Contract.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error Contract.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Contract.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error Contract.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\ContractEVT.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'ContractEVT.dbf',
             'S6_S6_ContractEVT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\ContractEVT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\ContractEVT.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\ContractEVT.dbf', sSkarb6ArcDir || '\\ContractEVT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error ContractEVT.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\ContractEVT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(12): Load error ContractEVT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\ContractPr.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'ContractPr.dbf',
             'S6_S6_ContractPr',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\ContractPr.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\ContractPr.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\ContractPr.dbf', sSkarb6ArcDir || '\\ContractPr.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error ContractPr.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\ContractPr.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error ContractPr.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Credit_NLS.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Credit_NLS.dbf',
             'S6_S6_Credit_NLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Credit_NLS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Credit_NLS.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Credit_NLS.dbf', sSkarb6ArcDir || '\\Credit_NLS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error Credit_NLS.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Credit_NLS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error Credit_NLS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Credit_Percent.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Credit_Percent.dbf',
             'S6_S6_Credit_Percent',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Credit_Percent.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Credit_Percent.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Credit_Percent.dbf', sSkarb6ArcDir || '\\Credit_Percent.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error Credit_Percent.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Credit_Percent.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error Credit_Percent.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\DEPARTAMENT.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'DEPARTAMENT.dbf',
             'S6_S6_DEPARTAMENT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\DEPARTAMENT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\DEPARTAMENT.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\DEPARTAMENT.dbf', sSkarb6ArcDir || '\\DEPARTAMENT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error DEPARTAMENT.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\DEPARTAMENT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error DEPARTAMENT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\EXT_SALDO.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'EXT_SALDO.dbf',
             'S6_S6_EXT_SALDO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\EXT_SALDO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\EXT_SALDO.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\EXT_SALDO.dbf', sSkarb6ArcDir || '\\EXT_SALDO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(21): Load error EXT_SALDO.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\EXT_SALDO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(22): Load error EXT_SALDO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\FORM_XOZ.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'FORM_XOZ.dbf',
             'S6_S6_FORM_XOZ',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\FORM_XOZ.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\FORM_XOZ.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\FORM_XOZ.dbf', sSkarb6ArcDir || '\\FORM_XOZ.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(23): Load error FORM_XOZ.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\FORM_XOZ.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(24): Load error FORM_XOZ.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\HIST_PR.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'HIST_PR.dbf',
             'S6_S6_HIST_PR',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\HIST_PR.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\HIST_PR.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\HIST_PR.dbf', sSkarb6ArcDir || '\\HIST_PR.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(25): Load error HIST_PR.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\HIST_PR.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(26): Load error HIST_PR.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\LockSaldo.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'LockSaldo.dbf',
             'S6_S6_LockSaldo',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\LockSaldo.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\LockSaldo.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\LockSaldo.dbf', sSkarb6ArcDir || '\\LockSaldo.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(27): Load error LockSaldo.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\LockSaldo.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(28): Load error LockSaldo.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\MailNLS.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'MailNLS.dbf',
             'S6_S6_MailNLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\MailNLS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\MailNLS.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\MailNLS.dbf', sSkarb6ArcDir || '\\MailNLS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(29): Load error MailNLS.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\MailNLS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(30): Load error MailNLS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\P__Clients.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'P__Clients.dbf',
             'S6_S6_P__Clients',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\P__Clients.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\P__Clients.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\P__Clients.dbf', sSkarb6ArcDir || '\\P__Clients.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(31): Load error P__Clients.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\P__Clients.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(32): Load error P__Clients.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\P__SALDO.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'P__SALDO.dbf',
             'S6_S6_P__SALDO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\P__SALDO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\P__SALDO.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\P__SALDO.dbf', sSkarb6ArcDir || '\\P__SALDO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(33): Load error P__SALDO.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\P__SALDO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(34): Load error P__SALDO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\PercenRate.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'PercenRate.dbf',
             'S6_S6_PercenRate',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\PercenRate.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\PercenRate.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\PercenRate.dbf', sSkarb6ArcDir || '\\PercenRate.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(35): Load error PercenRate.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\PercenRate.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(36): Load error PercenRate.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\PercenVid.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'PercenVid.dbf',
             'S6_S6_PercenVid',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\PercenVid.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\PercenVid.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\PercenVid.dbf', sSkarb6ArcDir || '\\PercenVid.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(37): Load error PercenVid.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\PercenVid.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(38): Load error PercenVid.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\SALDO.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'SALDO.dbf',
             'S6_S6_SALDO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\SALDO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\SALDO.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\SALDO.dbf', sSkarb6ArcDir || '\\SALDO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(39): Load error SALDO.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\SALDO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(40): Load error SALDO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\SETUP_BANK.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'SETUP_BANK.dbf',
             'S6_S6_SETUP_BANK',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\SETUP_BANK.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\SETUP_BANK.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\SETUP_BANK.dbf', sSkarb6ArcDir || '\\SETUP_BANK.dbf')
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(C_MFO)
   INTO   :dfFILIAL
   FROM   S6_S6_SETUP_BANK
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dfFILIAL = STRING_Null
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(41): Load error SETUP_BANK.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\SETUP_BANK.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(42): Load error SETUP_BANK.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\SWIFT_BIC.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'SWIFT_BIC.dbf',
             'S6_S6_SWIFT_BIC',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\SWIFT_BIC.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\SWIFT_BIC.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\SWIFT_BIC.dbf', sSkarb6ArcDir || '\\SWIFT_BIC.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(43): Load error SWIFT_BIC.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\SWIFT_BIC.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(44): Load error SWIFT_BIC.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Target.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Target.dbf',
             'S6_S6_Target',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Target.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Target.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Target.dbf', sSkarb6ArcDir || '\\Target.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(45): Load error Target.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Target.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(46): Load error Target.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\USERS.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'USERS.dbf',
             'S6_S6_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\USERS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\USERS.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\USERS.dbf', sSkarb6ArcDir || '\\USERS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(47): Load error USERS.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\USERS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(48): Load error USERS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\VID_Contract.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'VID_Contract.dbf',
             'S6_S6_VID_Contract',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\VID_Contract.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\VID_Contract.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\VID_Contract.dbf', sSkarb6ArcDir || '\\VID_Contract.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(49): Load error VID_Contract.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\VID_Contract.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(50): Load error VID_Contract.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\P__Contract.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'P__Contract.dbf',
             'S6_S6_P__Contract',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\P__Contract.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\P__Contract.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\P__Contract.dbf', sSkarb6ArcDir || '\\P__Contract.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(61): Load error P__Contract.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\P__Contract.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(62): Load error P__Contract.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Cur_Hist.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Cur_Hist.dbf',
             'S6_S6_Cur_Hist',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Cur_Hist.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Cur_Hist.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Cur_Hist.dbf', sSkarb6ArcDir || '\\Cur_Hist.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(63): Load error Cur_Hist.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\Cur_Hist.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(64): Load error Cur_Hist.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\Currency.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'Currency.dbf',
             'S6_S6_Currency',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\Currency.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\Currency.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\Currency.dbf', sSkarb6ArcDir || '\\Currency.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(65): Load error Currency.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\VID_Contract.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(66): Load error Currency.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sSkarb6Dir || '\\ClientsAddBankInfo.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'ClientsAddBankInfo.dbf',
             'S6_S6_ClientsAddBankInfo',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\ClientsAddBankInfo.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\ClientsAddBankInfo.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\ClientsAddBankInfo.dbf', sSkarb6ArcDir || '\\ClientsAddBankInfo.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error ClientsAddBankInfo.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 +  If not File(sSkarb6ArcDir || '\\ClientsAddBankInfo.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error ClientsAddBankInfo.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sSkarb6Dir || '\\GROUP_U.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'GROUP_U.dbf',
             'S6_S6_GROUP_U',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\GROUP_U.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\GROUP_U.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\GROUP_U.dbf', sSkarb6ArcDir || '\\GROUP_U.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error GROUP_U.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 +  If not File(sSkarb6ArcDir || '\\GROUP_U.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error GROUP_U.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sSkarb6Dir || '\\REG_C.dbf')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'REG_C.dbf',
             'S6_S6_REG_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\REG_C.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\REG_C.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\REG_C.dbf', sSkarb6ArcDir || '\\REG_C.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error REG_C.dbf - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 +  If not File(sSkarb6ArcDir || '\\REG_C.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(x): Load error REG_C.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  ! Здесь продолжить грузить дополнительные (справочные) таблицы
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\FILIAL.DBF')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'FILIAL.DBF',
             'S6_S6_FILIAL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\FILIAL.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\FILIAL.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\FILIAL.dbf', sSkarb6ArcDir || '\\FILIAL.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(51): Load error FILIAL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\FILIAL.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(52): Load error FILIAL.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\SHABLON.DBF')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'SHABLON.DBF',
             'S6_S6_SHABLON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\SHABLON.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\SHABLON.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\SHABLON.dbf', sSkarb6ArcDir || '\\SHABLON.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(53): Load error SHABLON.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\SHABLON.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(54): Load error SHABLON.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\DEPO.DBF')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'DEPO.DBF',
             'S6_S6_DEPO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\DEPO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\DEPO.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\DEPO.dbf', sSkarb6ArcDir || '\\DEPO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(55): Load error DEPO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\DEPO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(56): Load error DEPO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\GROUP_C.DBF')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'GROUP_C.DBF',
             'S6_S6_GROUP_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\GROUP_C.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\GROUP_C.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\GROUP_C.dbf', sSkarb6ArcDir || '\\GROUP_C.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(57): Load error GROUP_C.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\GROUP_C.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(58): Load error GROUP_C.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sSkarb6Dir || '\\TRANSIT.DBF')
.head 8 +  If ImportDbf(sSkarb6Dir,
             'TRANSIT.DBF',
             'S6_S6_TRANSIT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSkarb6ArcDir || '\\TRANSIT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSkarb6ArcDir || '\\TRANSIT.dbf')
.head 9 -  Call VisFileRename(sSkarb6Dir || '\\TRANSIT.dbf', sSkarb6ArcDir || '\\TRANSIT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(59): Load error TRANSIT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sSkarb6ArcDir || '\\TRANSIT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(60): Load error TRANSIT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraSK.copy_skarb6_tables(dfFILIAL)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sSkarb6Dir
.head 3 -  String: sSkarb6ArcDir
.head 3 -  String: sDATX
.head 3 -  Number: nT
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'Skarb6Path', '', sSkarb6Dir, GetIniFileName())
.head 4 -  Set sSkarb6Dir = IifS(Right(sSkarb6Dir, 1)='\\', Left(sSkarb6Dir, Len(sSkarb6Dir)-1), sSkarb6Dir) ! каталог СКАРБа6
.head 4 -  Set dfSKARB6 = sSkarb6Dir
.head 4 -  Call SalGetProfileString('Import', 'Skarb6ArcPath', '', sSkarb6ArcDir, GetIniFileName())
.head 4 -  Set sSkarb6ArcDir = IifS(Right(sSkarb6ArcDir, 1)='\\', Left(sSkarb6ArcDir, Len(sSkarb6ArcDir)-1), sSkarb6ArcDir) ! архив
.head 4 -  Set dfSKARB6arc = sSkarb6ArcDir
.head 4 -  !
.head 4 -  Set rbWin = 1
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 0
.head 4 -  ! Set dfDATX = SalDateCurrent()
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DATX', '', sDATX, '')
.head 4 +  If Len(sDATX) = 0
.head 5 -  Set dfDATX = SalDateCurrent()
.head 4 +  Else
.head 5 -  Set dfDATX = SalStrToDate(sDATX)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('S6_S6_SETUP_BANK')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(C_MFO)
   INTO   :dfFILIAL
   FROM   S6_S6_SETUP_BANK
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDATX, sDATX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DATX', sDATX, '')
.head 1 +  Dialog Box: dlg_ImportFHitc
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "ХИТЦ" (ф)  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.063"
.head 4 -  Top:    0.063"
.head 4 -  Width:  16.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.119"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных HITC (филиал) --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM P_MIGRASKHI
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    6.881"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.131"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.381"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 37599
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    7.155"
.head 5 -  Width:  1.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 37600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF-файлов ХИТЦа
.head 4 -  Resource Id: 37601
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    6.821"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов ХИТЦа
.head 4 -  Resource Id: 37602
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    7.31"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfHITC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.036"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfHITCarc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.524"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 37603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    6.738"
.head 5 -  Width:  4.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.071"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код филиала (МФО)
.head 4 -  Resource Id: 37604
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFILIAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    6.833"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    7.119"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата перевода филиала
.head 4 -  Resource Id: 37605
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.15"
.head 5 -  Top:    7.143"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 37606
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.117"
.head 5 -  Begin Y:  6.857"
.head 5 -  End X:  9.117"
.head 5 -  End Y:  7.643"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  String: sKodirowka
.head 5 -  String: sErrMsg
.head 5 -  !
.head 5 -  Number: n99
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'HITCTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sCommand = tbl1.colPROC || '(dfFILIAL,nNum,nErr,dfDATX)'
.head 6 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'HITCTABLE'
.head 7 -  ! загрузка DBF-файлов ХИТЦ
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\VAR.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'VAR.DBF',
             'S6_HI_VAR',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\VAR.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\VAR.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\VAR.DBF', sHitcArcDir || '\\VAR.DBF')
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT trim(MFOBANK)
   INTO   :dfFILIAL
   FROM   S6_HI_VAR
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dfFILIAL = STRING_Null
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error VAR.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\VAR.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error VAR.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'USERS.DBF',
             'S6_HI_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\USERS.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\USERS.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\USERS.DBF', sHitcArcDir || '\\USERS.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\USERS.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): Load error USERS.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\BCL.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCL.DBF',
             'S6_HI_BCL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCL.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCL.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCL.DBF', sHitcArcDir || '\\BCL.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error BCL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\BCL.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6): Load error BCL.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\BAC.DBF')
.head 8 -  ! приводим поля дат в божеский вид
.head 8 -  Call SalLoadAppAndWait("HITCBAC " || sHitcDir || " BAC.DBF", Window_NotVisible, n99)
.head 8 +  If n99 = 0
.head 9 +  If ImportDbf(sHitcDir,
             'BAC.DBF',
             'S6_HI_BAC',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set nA = nA + 1
.head 10 -  Call VisFileSetAttribute(sHitcArcDir || '\\BAC.DBF', FA_Standard, TRUE)
.head 10 -  Call VisFileDelete(sHitcArcDir || '\\BAC.DBF')
.head 10 -  Call VisFileRename(sHitcDir || '\\BAC.DBF', sHitcArcDir || '\\BAC.DBF')
.head 9 +  Else
.head 10 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error BAC.DBF - ' || sErrMsg)
.head 10 -  Set nE = nE + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error BAC.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\BAC.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error BAC.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\ODM.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'ODM.DBF',
             'S6_HI_ODM',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\ODM.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\ODM.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\ODM.DBF', sHitcArcDir || '\\ODM.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error ODM.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\ODM.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error ODM.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sHitcDir || '\\BCD.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCD.DBF',
             'S6_HI_BCD',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCD.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCD.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCD.DBF', sHitcArcDir || '\\BCD.DBF')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error BCD.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sHitcArcDir || '\\BCD.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(12): Load error BCD.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sHitcDir || '\\BCG.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCG.DBF',
             'S6_HI_BCG',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCG.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCG.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCG.DBF', sHitcArcDir || '\\BCG.DBF')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error BCG.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sHitcArcDir || '\\BCG.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error BCG.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sHitcDir || '\\BCH.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCH.DBF',
             'S6_HI_BCH',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCH.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCH.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCH.DBF', sHitcArcDir || '\\BCH.DBF')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error BCH.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sHitcArcDir || '\\BCH.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error BCH.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sHitcDir || '\\BCO.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCO.DBF',
             'S6_HI_BCO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCO.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCO.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCO.DBF', sHitcArcDir || '\\BCO.DBF')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error BCO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sHitcArcDir || '\\BCO.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error BCO.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\BCR.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'BCR.DBF',
             'S6_HI_BCR',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\BCR.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\BCR.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\BCR.DBF', sHitcArcDir || '\\BCR.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error BCR.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\BCR.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error BCR.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  ! Здесь продолжить грузить дополнительные (справочные) таблицы
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\FILIAL.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'FILIAL.DBF',
             'S6_HI_FILIAL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\FILIAL.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\FILIAL.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\FILIAL.DBF', sHitcArcDir || '\\FILIAL.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(51): Load error FILIAL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\FILIAL.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(52): Load error FILIAL.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\SHABLON.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'SHABLON.DBF',
             'S6_HI_SHABLON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\SHABLON.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\SHABLON.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\SHABLON.DBF', sHitcArcDir || '\\SHABLON.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(53): Load error SHABLON.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\SHABLON.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(54): Load error SHABLON.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\DEPO.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'DEPO.DBF',
             'S6_HI_DEPO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\DEPO.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\DEPO.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\DEPO.DBF', sHitcArcDir || '\\DEPO.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(55): Load error DEPO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\DEPO.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(56): Load error DEPO.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\GROUP_C.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'GROUP_C.DBF',
             'S6_HI_GROUP_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\GROUP_C.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\GROUP_C.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\GROUP_C.DBF', sHitcArcDir || '\\GROUP_C.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(57): Load error GROUP_C.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\GROUP_C.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(58): Load error GROUP_C.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sHitcDir || '\\TRANSIT.DBF')
.head 8 +  If ImportDbf(sHitcDir,
             'TRANSIT.DBF',
             'S6_HI_TRANSIT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sHitcArcDir || '\\TRANSIT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sHitcArcDir || '\\TRANSIT.DBF')
.head 9 -  Call VisFileRename(sHitcDir || '\\TRANSIT.DBF', sHitcArcDir || '\\TRANSIT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(59): Load error TRANSIT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sHitcArcDir || '\\TRANSIT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(60): Load error TRANSIT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraSK.copy_hitc_tables(dfFILIAL)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sHitcDir
.head 3 -  String: sHitcArcDir
.head 3 -  String: sDATX
.head 3 -  Number: nT
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'HitcPath', '', sHitcDir, GetIniFileName())
.head 4 -  Set sHitcDir = IifS(Right(sHitcDir, 1)='\\', Left(sHitcDir, Len(sHitcDir)-1), sHitcDir) ! каталог ХИТЦа
.head 4 -  Set dfHITC = sHitcDir
.head 4 -  Call SalGetProfileString('Import', 'HitcArcPath', '', sHitcArcDir, GetIniFileName())
.head 4 -  Set sHitcArcDir = IifS(Right(sHitcArcDir, 1)='\\', Left(sHitcArcDir, Len(sHitcArcDir)-1), sHitcArcDir) ! архив
.head 4 -  Set dfHITCarc = sHitcArcDir
.head 4 -  !
.head 4 -  Set rbWin = 0
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 1
.head 4 -  ! Set dfDATX = SalDateCurrent()
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DATX', '', sDATX, '')
.head 4 +  If Len(sDATX) = 0
.head 5 -  Set dfDATX = SalDateCurrent()
.head 4 +  Else
.head 5 -  Set dfDATX = SalStrToDate(sDATX)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('S6_HI_VAR')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT trim(MFOBANK)
   INTO   :dfFILIAL
   FROM   S6_HI_VAR
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDATX, sDATX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DATX', sDATX, '')
.head 1 +  Dialog Box: dlg_ImportAsvo63
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "АСВО6.3"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.388"
.head 4 -  Top:    0.948"
.head 4 -  Width:  16.833"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.107"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.655"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 +  If tbl1.PROV_SQL != STRING_Null
.head 8 -  Set sTmpF3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 8 -  ! Call Debug(sTmpF3)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini('FFF',sTmpF3,'ТВБВ в АСВО')")
.head 9 -  ! Set strPrintFileName = tbl1.PROV_SQL
.head 9 -  Call FunNSIGetFilteredEx(PROV_SQL, "FFF", "", sTmp1, sTmp2)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.488"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.071"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROV_SQL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя вюшки
Пров.SQL
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung,PROV_SQL
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP,:tbl1.PROV_SQL
     FROM   P_MIGRAAS
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If PROV_SQL != STRING_Null
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 210, 250))
.head 6 +  If Left(colPROC,9) = 'ASVOTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 +  List Box: lbTVBV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    6.0"
.head 5 -  Width:  9.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выделить ВСЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   14.883"
.head 5 -  Top:    5.964"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 -  Call SalListSetMultiSelect(lbTVBV, nI, TRUE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 +  Pushbutton: pbNo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Очистить ВСЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   14.883"
.head 5 -  Top:    6.262"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 -  Call SalListSetMultiSelect(lbTVBV, nI, FALSE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 +  Pushbutton: pbInv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Инвертировать
.head 4 -  Window Location and Size
.head 5 -  Left:   14.883"
.head 5 -  Top:    6.56"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 +  If SalListQueryState(lbTVBV, nI)
.head 8 -  Call SalListSetMultiSelect(lbTVBV, nI, FALSE)
.head 7 +  Else
.head 8 -  Call SalListSetMultiSelect(lbTVBV, nI, TRUE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 -  Frame
.head 4 -  Resource Id: 22437
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.567"
.head 5 -  Top:    5.905"
.head 5 -  Width:  11.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.012"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог АСВО
.head 4 -  Resource Id: 46800
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    6.988"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF
.head 4 -  Resource Id: 33990
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.783"
.head 5 -  Top:    7.012"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF счетов
.head 4 -  Resource Id: 33991
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.267"
.head 5 -  Top:    7.036"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF %% ставок
.head 4 -  Resource Id: 33988
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.267"
.head 5 -  Top:    7.274"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF картотек NOT
.head 4 -  Resource Id: 33989
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.267"
.head 5 -  Top:    7.512"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfASVO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    6.952"
.head 6 -  Width:  3.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDBF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    7.262"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.767"
.head 6 -  Top:    6.988"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPRC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.767"
.head 6 -  Top:    7.238"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNOT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.767"
.head 6 -  Top:    7.488"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 33992
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.567"
.head 5 -  Top:    6.952"
.head 5 -  Width:  11.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.821"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Загружать файлы D
.head 4 -  Window Location and Size
.head 5 -  Left:   2.533"
.head 5 -  Top:    7.262"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Gray
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Загружать файлы G
.head 4 -  Window Location and Size
.head 5 -  Left:   2.533"
.head 5 -  Top:    7.5"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Periwinkle
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.633"
.head 6 -  Top:    5.595"
.head 6 -  Width:  11.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата миграции ТВБВ
.head 4 -  Resource Id: 23951
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.317"
.head 5 -  Top:    6.036"
.head 5 -  Width:  2.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDASVOX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    6.238"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfPR = 'Проценты в АСВО должны быть начислены по ' || SalFmtFormatDateTime(dfDASVOX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'ASVOTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  ! Set nI = 0
.head 6 +  ! While nI <= SalListQueryCount(lbTVBV) 
.head 7 +  If SalListQueryState(lbTVBV, nI)
.head 8 -  Set s3 = Left(SalListQueryTextX(lbTVBV, nI), 3)
.head 8 -  ! Call Debug(s3)
.head 8 -  Set nNum = 0
.head 8 -  Set nErr = 0
.head 8 -  Set sErrMask = tbl1.colErrMask
.head 8 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask)'
.head 8 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 9 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 9 -  Call SalTblSetContext(tbl1, nRow)
.head 9 -  Set tbl1.colDone = nNum
.head 9 -  Set tbl1.colErr = nErr
.head 9 -  Call SalListSetSelect(lbTVBV, nI)
.head 8 +  Else 
.head 9 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 9 -  Call SalTblSetContext(tbl1, nRow)
.head 9 -  Set tbl1.colErr = 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 7 -  Set nI = nI +1
.head 6 -  Set s3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 6 -  ! Call Debug(s3)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask,dfDASVOX)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 7 -  Call SalListSetSelect(lbTVBV, nI)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'ASVOTABLE0'
.head 7 -  ! загрузка справочников из DBF
.head 7 +  If fAsvoDBF
.head 8 -  Set tbl1.colDone = 0
.head 8 -  Set tbl1.colErr = 0
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP_NLS')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP_NLS')
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), "begin
                                     execute immediate 'DROP TABLE ASVO_TEMP_NLS';
                                   end;")
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP_NLS')")
.head 8 +  If File(sAsvoDBF || '\\' || dfNLS)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfNLS,
             'ASVO_TEMP_NLS',
             'UKG',
             1,
             1,
             0,
             sErrMsg) ! ImportDbf('d:\\','IB23.DBF','IB23','UKG',1,1,0,SqlPassword)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfNLS
     || ' в таблицу ASVO_TEMP_NLS')
.head 10 -  !
.head 10 -  ! заполнение DPT_VIDD_ASVO и ASVO_NLS
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NLStoSPR(nNum,nErr,sErrMask,sAsvoNlsMask,dfNLS)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(1) - невозможно выполнить процедуру migraAS.NLStoSPR')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2) отсутствует файл ' || sAsvoDBF || '\\' || dfNLS)
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP_PRC')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP_PRC')
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), "begin
                                     execute immediate 'DROP TABLE ASVO_TEMP_PRC';
                                   end;")
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP_PRC')")
.head 8 +  If File(sAsvoDBF || '\\' || dfPRC)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfPRC,
             'ASVO_TEMP_PRC',
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfPRC
     || ' в таблицу ASVO_TEMP_PRC')
.head 10 -  !
.head 10 -  ! заполнение ASVO_FFF_PERCENT
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.PRCtoSPR(nNum,nErr,sErrMask,dfPRC)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(3) - невозможно выполнить процедуру migraAS.PRCtoSPR')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4) отсутствует файл ' || sAsvoDBF || '\\' || dfPRC)
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP_NOT')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP_NOT'
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), "begin
                                     execute immediate 'DROP TABLE ASVO_TEMP_NOT';
                                   end;")
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP_NOT')")
.head 8 +  If File(sAsvoDBF || '\\' || dfNOT)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfNOT,
             'ASVO_TEMP_NOT',
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfNOT
     || ' в таблицу ASVO_TEMP_NOT')
.head 10 -  !
.head 10 -  ! заполнение ASVO_FFF_NOT
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NOTtoSPR(nNum,nErr,sErrMask,dfNOT)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(5) - невозможно выполнить процедуру migraAS.NOTtoSPR')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6) отсутствует файл ' || sAsvoDBF || '\\' || dfNOT)
.head 7 +  Else
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): отсутствует каталог DBF - ' || sAsvoDBF)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  If tbl1.colPROC = 'ASVOTABLE1'
.head 7 -  ! загрузка системных ресурсов АСВО
.head 7 +  If fAsvoDir
.head 8 -  Set tbl1.colDone = 0
.head 8 -  Set tbl1.colErr = 0
.head 8 -  ! 
String: sFilePath        ! путь к файлу dbf
String: sFileName        ! имя файла dbf
String: sTableName       ! имя таблицы для импорта
String: sEncode          ! кодировка DBF файла 
Number: nForceMode       ! = переменная IMP_TAB_*
Number: nImportType      ! =0-через oracle память(переменная в bars_dbf), =1 через временную таблицу tmp_lob
Receive String: sErrMsg  ! текст ошибки обработки
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_OBJ')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_OBJ')
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), "begin
                                     execute immediate 'DROP TABLE ASVO_OBJ';
                                   end;")
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_OBJ')")
.head 8 +  If ImportDbf(sAsvoDir,
             'OBJ.DBF',
             'ASVO_OBJ',
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set tbl1.colDone = tbl1.colDone + 1
.head 9 -  Call SqlCommitEx(hSql(), tbl1.colErrMask || ' - выполнен импорт файла OBJ.DBF в таблицу ASVO_OBJ')
.head 9 +  If SqlPLSQLCommand(hSql(), 'migraAS.get_tvbv_from_asvo(nNum,nErr,sTVBV)')
.head 10 -  Call SalListClear(lbTVBV)
.head 10 +  While Len(sTVBV) > 0
.head 11 -  Set s3 = Left(sTVBV, 3)
.head 11 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 11 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2) OBJ.DBF : ' || sErrMsg)
.head 7 +  Else
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): отсутствует каталог АСВО - ' || sAsvoDir)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  If tbl1.colPROC = 'ASVOTABLE2'
.head 7 -  ! загрузка таблиц вкладов АСВО
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 7 -  ! Call Debug(sFFF)
.head 7 +  If SqlPLSQLCommand(hSql(), 'migraAS.get_fff_for_tvbv(sFFF,nNum,nErr,sTVBVFFF)')
.head 8 -  ! Call Debug(sTVBVFFF)
.head 8 -  ! Set nL = 0
.head 8 +  While Len(sTVBVFFF)>=3
.head 9 -  Set sFFFactual = Left(sTVBVFFF, 3)
.head 9 -  ! Call Debug(sFFFactual)
.head 9 -  Set sTVBVFFF = Right(sTVBVFFF, Len(sTVBVFFF)-3)
.head 9 -  ! Set nL = nL + 3
.head 9 -  !
.head 9 -  ! sFFFactual - каталог ТВБВ с подкаталогами
.head 9 -  ! надо:
.head 9 -  ! 1. в каталоге sFFFactual найти все подкаталоги
.head 9 -  ! 2. идти в цикле по подкаталогам и вычитывать имена файлов S?????.DBF и A?????.DBF
.head 9 -  ! 3. грузить эти файлы в таблицы базы с именами ASVO_Sxxxxx.DBF и ASVO_Axxxxx.DBF
.head 9 -  ! 4. после загрузки каждой пары файлов записать в таблицу ASVO_FFF_LOAD
     (FFF=:sFFF, FFFACTUAL=:sFFFactual, KKFFFACTUAL=:sKKFFFactual, FL=0)
.head 9 -  Set nNumDirs2 = VisDosEnumDirs(sAsvoDir || '\\' || sFFFactual || '\\??', sDirs2)
.head 9 -  ! Call DebugN(nNumDirs2)
.head 9 -  Set nJ = 0
.head 9 +  While nJ < nNumDirs2
.head 10 -  Set sKK = sDirs2[nJ]
.head 10 -  Set sKKFFFactual = sKK || sFFFactual
.head 10 -  ! Call Debug(sKKFFFactual)
.head 10 -  If SqlPrepareAndExecute(hSql(), "
   SELECT count(1)
   INTO   :nKKnot
   FROM   ASVO_FFF_NOT
   WHERE  fff=:sFFF and kknot=:sKK") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set nKKnot = 0
.head 10 +  If nKKnot = 0
.head 11 +  If File(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ] || '\\A' || sDirs2[nJ] || sFFFactual || '.DBF')
   and
   File(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ] || '\\S' || sDirs2[nJ] || sFFFactual || '.DBF')
.head 12 -  ! файлы есть, можно грузить в таблицы
.head 12 -  ! Call Debug(sAsvoDir || '\\' || sFFF || '\\' || sDirs2[nJ])
.head 12 -  ! Call Debug('A' || sDirs2[nJ] || sFFFactual || '.DBF')
.head 12 -  ! Call Debug('ASVO_A' || sDirs2[nJ] || sFFFactual)
.head 12 +  If ImportDbf(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ],
             'A' || sDirs2[nJ] || sFFFactual || '.DBF',
             'ASVO_A' || sDirs2[nJ] || sFFFactual,
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 13 +  If ImportDbf(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ],
             'S' || sDirs2[nJ] || sFFFactual || '.DBF',
             'ASVO_S' || sDirs2[nJ] || sFFFactual,
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 14 +  If cbD and File(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ] || '\\D' || sDirs2[nJ] ||
   sFFFactual || '.DBF')
.head 15 -  If ImportDbf(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ],
             'D' || sDirs2[nJ] || sFFFactual || '.DBF',
             'ASVO_D' || sDirs2[nJ] || sFFFactual,
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 15 +  Else
.head 16 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): '|| sFFF || ' ' || sFFFactual || ' ' || sKKFFFactual
     || ' - ' || sErrMsg)
.head 14 +  If cbG and File(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ] || '\\G' || sDirs2[nJ] ||
   sFFFactual || '.DBF')
.head 15 -  If ImportDbf(sAsvoDir || '\\' || sFFFactual || '\\' || sDirs2[nJ],
             'G' || sDirs2[nJ] || sFFFactual || '.DBF',
             'ASVO_G' || sDirs2[nJ] || sFFFactual,
             'UKG',
             1,
             1,
             0,
             sErrMsg)
.head 15 +  Else
.head 16 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): '|| sFFF || ' ' || sFFFactual || ' ' || sKKFFFactual
     || ' - ' || sErrMsg)
.head 14 +  If SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO ASVO_FFF_LOAD (FFF,FFFACTUAL,KKFFFACTUAL,FL)
               VALUES (:sFFF,:sFFFactual,:sKKFFFactual,0)') and SqlCommit(hSql())
.head 15 -  Set nA = nA + 1
.head 14 +  Else
.head 15 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): INSERT INTO ASVO_FFF_LOAD ' || sFFF || ' ' ||
     sFFFactual || ' ' || sKKFFFactual)
.head 13 +  Else
.head 14 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): '|| sFFF || ' ' || sFFFactual || ' ' || sKKFFFactual ||
     ' - ' || sErrMsg)
.head 12 +  Else
.head 13 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): '|| sFFF || ' ' || sFFFactual || ' ' || sKKFFFactual ||
     ' - ' || sErrMsg)
.head 10 -  Set nJ = nJ + 1
.head 8 -  ! создание копий таблиц ASVO_OBJ, ASVO_Akkkk, ASVO_Skkkk, ASVO_Dkkkk
.head 8 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_asvo_tables(sFFF)')
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask ||
     '(0): Ошибка - невозможно выполнить процедуру migraAS.get_fff_for_tvbv для) ' || sFFF)
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 7 -  Set tbl1.colDone = nA
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: Dir
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDirs[*]
.head 4 +  Actions
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  String: sAsvoDir
.head 3 -  Boolean: fAsvoDir
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: s3
.head 3 -  String: sFFF
.head 3 -  String: sFFFactual
.head 3 -  String: sKKFFFactual
.head 3 -  String: sTVBVFFF
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  Number: nNumDirs2
.head 3 -  String: sDirs2[*]
.head 3 -  !
.head 3 -  String: sAsvoDBF
.head 3 -  Boolean: fAsvoDBF
.head 3 -  String: sAsvoNlsMask
.head 3 -  !
.head 3 -  String: sDPR
.head 3 -  String: sDASVOX
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'AsvoPath', '', sAsvoDir, GetIniFileName())
.head 4 -  Set sAsvoDir = IifS(Right(sAsvoDir, 1)='\\', Left(sAsvoDir, Len(sAsvoDir)-1), sAsvoDir) ! каталог АСВО
.head 4 -  Set dfASVO = sAsvoDir
.head 4 -  Set fAsvoDir = Dir(sAsvoDir)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'Asvo_DBF', '', sAsvoDBF, GetIniFileName())
.head 4 -  Set sAsvoDBF = IifS(Right(sAsvoDBF, 1)='\\', Left(sAsvoDBF, Len(sAsvoDBF)-1), sAsvoDBF) ! каталог DBF
.head 4 -  Set dfDBF = sAsvoDBF
.head 4 -  Set fAsvoDBF = Dir(sAsvoDBF)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'AsvoNlsMask', '', sAsvoNlsMask, GetIniFileName())
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_OBJ')
   INTO   :nT
   FROM   dual") and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 +  If SqlPLSQLCommand(hSql(), 'migraAS.get_tvbv_from_asvo(nNum,nErr,sTVBV)')
.head 7 -  Call SalListClear(lbTVBV)
.head 7 +  While Len(sTVBV) > 0
.head 8 -  Set s3 = Left(sTVBV, 3)
.head 8 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 8 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 4 -  Set dfNLS = 'NLS.dbf'
.head 4 -  Set dfPRC = 'PRC.dbf'
.head 4 -  Set dfNOT = 'NOT.dbf'
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbAll)
.head 4 -  Call SalDisableWindow(pbNo)
.head 4 -  Call SalDisableWindow(pbInv)
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sDPR
   FROM   params$base
   WHERE  par='BANKDATE'") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set sDPR = SalFmtFormatDateTime(SalDateCurrent(), 'MM/dd/yyyy')
.head 4 -  Set dfDASVOX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DASVOX', '', sDASVOX, '')
.head 4 +  If Len(sDASVOX) = 0
.head 5 -  Set dfDASVOX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 +  Else
.head 5 -  Set dfDASVOX = SalStrToDate(sDASVOX)
.head 4 -  !
.head 4 -  Set dfPR = 'Проценты в АСВО должны быть начислены по ' || SalFmtFormatDateTime(dfDASVOX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDASVOX, sDASVOX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DASVOX', sDASVOX, '')
.head 1 +  Dialog Box: dlg_ImportAsvo65
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "АСВО6.5"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.95"
.head 4 -  Top:    1.021"
.head 4 -  Width:  17.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.143"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.655"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 +  If tbl1.PROV_SQL65 != STRING_Null
.head 8 -  Set sTmpF3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 8 -  ! Call Debug(sTmpF3)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini('FFF',sTmpF3,'ТВБВ в АСВО')")
.head 9 -  ! Set strPrintFileName = tbl1.PROV_SQL65
.head 9 -  Call FunNSIGetFilteredEx(PROV_SQL65, "FFF", "", sTmp1, sTmp2)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.488"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.071"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROV_SQL65
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя вюшки
Пров.SQL
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung,PROV_SQL
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP,:tbl1.PROV_SQL65
     FROM   P_MIGRAAS65
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If PROV_SQL65 != STRING_Null
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 210, 250))
.head 6 +  If Left(colPROC,9) = 'ASVOTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 +  List Box: lbTVBV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.667"
.head 5 -  Top:    5.976"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выделить ВСЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   15.167"
.head 5 -  Top:    5.952"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 -  Call SalListSetMultiSelect(lbTVBV, nI, TRUE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 +  Pushbutton: pbNo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Очистить ВСЕ
.head 4 -  Window Location and Size
.head 5 -  Left:   15.167"
.head 5 -  Top:    6.25"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 -  Call SalListSetMultiSelect(lbTVBV, nI, FALSE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 +  Pushbutton: pbInv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Инвертировать
.head 4 -  Window Location and Size
.head 5 -  Left:   15.167"
.head 5 -  Top:    6.548"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nI = 0
.head 6 +  While nI <= SalListQueryCount(lbTVBV) 
.head 7 +  If SalListQueryState(lbTVBV, nI)
.head 8 -  Call SalListSetMultiSelect(lbTVBV, nI, FALSE)
.head 7 +  Else
.head 8 -  Call SalListSetMultiSelect(lbTVBV, nI, TRUE)
.head 7 -  Set nI = nI +1
.head 6 -  Call SalListSetMultiSelect(lbTVBV, 0, SalListQueryState(lbTVBV, 0))
.head 3 -  Frame
.head 4 -  Resource Id: 59624
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.567"
.head 5 -  Top:    5.893"
.head 5 -  Width:  11.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.024"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог АСВО
.head 4 -  Resource Id: 59625
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    6.988"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF
.head 4 -  Resource Id: 59626
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    7.012"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF счетов
.head 4 -  Resource Id: 59627
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.867"
.head 5 -  Top:    7.024"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF %% ставок
.head 4 -  Resource Id: 59629
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.867"
.head 5 -  Top:    7.286"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: DBF картотек NOT
.head 4 -  Resource Id: 30297
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.867"
.head 5 -  Top:    7.548"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfASVO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    6.952"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDBF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.65"
.head 6 -  Top:    7.226"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.367"
.head 6 -  Top:    6.976"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPRC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.367"
.head 6 -  Top:    7.25"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNOT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.367"
.head 6 -  Top:    7.524"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 59630
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.583"
.head 5 -  Top:    6.952"
.head 5 -  Width:  11.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.869"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 49481
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    7.56"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 49484
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    7.286"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   2.433"
.head 5 -  Top:    7.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   3.5"
.head 5 -  Top:    7.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   4.567"
.head 5 -  Top:    7.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 49483
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.35"
.head 5 -  Top:    7.238"
.head 5 -  Width:  3.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbDWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   7.75"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   8.817"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.883"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 49482
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.667"
.head 5 -  Top:    7.5"
.head 5 -  Width:  3.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.583"
.head 6 -  Top:    5.607"
.head 6 -  Width:  11.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата миграции ТВБВ
.head 4 -  Resource Id: 30022
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    5.988"
.head 5 -  Width:  2.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDASVO65X
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    6.226"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfPR = 'Проценты в АСВО должны быть начислены по ' || SalFmtFormatDateTime(dfDASVO65X, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'ASVOTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  ! Set nI = 0
.head 6 +  ! While nI <= SalListQueryCount(lbTVBV) 
.head 7 +  If SalListQueryState(lbTVBV, nI)
.head 8 -  Set s3 = Left(SalListQueryTextX(lbTVBV, nI), 3)
.head 8 -  ! Call Debug(s3)
.head 8 -  Set nNum = 0
.head 8 -  Set nErr = 0
.head 8 -  Set sErrMask = tbl1.colErrMask
.head 8 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask)'
.head 8 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 9 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 9 -  Call SalTblSetContext(tbl1, nRow)
.head 9 -  Set tbl1.colDone = nNum
.head 9 -  Set tbl1.colErr = nErr
.head 9 -  Call SalListSetSelect(lbTVBV, nI)
.head 8 +  Else 
.head 9 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 9 -  Call SalTblSetContext(tbl1, nRow)
.head 9 -  Set tbl1.colErr = 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 7 -  Set nI = nI +1
.head 6 -  Set s3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 6 -  ! Call Debug(s3)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask,dfDASVO65X)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 7 -  Call SalListSetSelect(lbTVBV, nI)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'ASVOTABLE0'
.head 7 -  ! загрузка справочников из DBF
.head 7 +  If fAsvoDBF
.head 8 -  Set tbl1.colDone = 0
.head 8 -  Set tbl1.colErr = 0
.head 8 -  !
.head 8 +  If rbDWin
.head 9 -  Set sKodirowka = 'WIN'
.head 8 +  If rbDDos
.head 9 -  Set sKodirowka = 'DOS'
.head 8 +  If rbDUkg
.head 9 -  Set sKodirowka = 'UKG'
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP65_NLS')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP65_NLS')
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP65_NLS')")
.head 8 +  If File(sAsvoDBF || '\\' || dfNLS)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfNLS,
             'ASVO_TEMP65_NLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfNLS
     || ' в таблицу ASVO_TEMP65_NLS')
.head 10 -  !
.head 10 -  ! заполнение DPT_VIDD_ASVO и ASVO_NLS
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NLStoSPR65(nNum,nErr,sErrMask,sAsvoNlsMask,dfNLS)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(1) - невозможно выполнить процедуру migraAS.NLStoSPR65')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2) отсутствует файл ' || sAsvoDBF || '\\' || dfNLS)
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP65_PRC')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP65_PRC')
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP65_PRC')")
.head 8 +  If File(sAsvoDBF || '\\' || dfPRC)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfPRC,
             'ASVO_TEMP65_PRC',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfPRC
     || ' в таблицу ASVO_TEMP65_PRC')
.head 10 -  !
.head 10 -  ! заполнение ASVO_FFF_PERCENT
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.PRCtoSPR65(nNum,nErr,sErrMask,dfPRC)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(3) - невозможно выполнить процедуру migraAS.PRCtoSPR65')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4) отсутствует файл ' || sAsvoDBF || '\\' || dfPRC)
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMP65_NOT')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMP65_NOT')
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMP65_NOT')")
.head 8 +  If File(sAsvoDBF || '\\' || dfNOT)
.head 9 +  If ImportDbf(sAsvoDBF,
             dfNOT,
             'ASVO_TEMP65_NOT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' || dfNOT
     || ' в таблицу ASVO_TEMP65_NOT')
.head 10 -  !
.head 10 -  ! заполнение ASVO_FFF_NOT
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NOTtoSPR65(nNum,nErr,sErrMask,dfNOT)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(5) - невозможно выполнить процедуру migraAS.NOTtoSPR65')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6) отсутствует файл ' || sAsvoDBF || '\\' || dfNOT)
.head 7 +  Else
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): отсутствует каталог DBF - ' || sAsvoDBF)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  If tbl1.colPROC = 'ASVOTABLE1'
.head 7 -  ! загрузка таблиц вкладов АСВО6.5
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\CARDFILE.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'CARDFILE.DBF',
             'ASVO_65_CARDFILE',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error CARDFILE.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error CARDFILE.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\CLIENT.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'CLIENT.DBF',
             'ASVO_65_CLIENT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error CLIENT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error CLIENT.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\CONDV.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'CONDV.DBF',
             'ASVO_65_CONDV',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(12): Load error CONDV.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error CONDV.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\DEPARTAMENT.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'DEPARTAMENT.DBF',
             'ASVO_65_DEPARTAMENT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  !
.head 9 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT lpad(to_char(depart),3,'0')
   INTO   :sTVBV
   FROM   ASVO_65_DEPARTAMENT
   WHERE  depart in (
          SELECT min(depart)
          FROM   ASVO_65_CARDFILE)") and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalListClear(lbTVBV)
.head 10 +  While Len(sTVBV) > 0
.head 11 -  Set s3 = Left(sTVBV, 3)
.head 11 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 11 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 10 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 9 -  Set sTVBV = STRING_Null
.head 9 -  Call SqlPLSQLCommand(hSql(), "get65_tvbv(sTVBV)")
.head 9 +  If sTVBV != STRING_Null
.head 10 -  Call SalListClear(lbTVBV)
.head 10 +  While Len(sTVBV) > 0
.head 11 -  Set s3 = Left(sTVBV, 3)
.head 11 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 11 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 10 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 9 +  Else
.head 10 -  Call SaveErrorToLog(tbl1.colErrMask ||
     '(7): Load error DEPARTAMENT.DBF - возможно в CARDFILE.DBF несколько департаментов, что недопустимо')
.head 10 -  Set nE = nE + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error DEPARTAMENT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error DEPARTAMENT.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\LS.DBF')
.head 8 -  ! приводим поле NSC в божеский вид
.head 8 -  Call SalLoadAppAndWait("ASVO65LS " || sAsvoDir || " LS.DBF", Window_NotVisible, n99)
.head 8 +  If n99 = 0
.head 9 +  If ImportDbf(sAsvoDir,
             'LS.DBF',
             'ASVO_65_LS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set nA = nA + 1
.head 9 +  Else
.head 10 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error LS.DBF - ' || sErrMsg)
.head 10 -  Set nE = nE + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error LS.DBF - невозможно выполнить ASVO65LS.EXE')
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error LS.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\SYMB.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'SYMB.DBF',
             'ASVO_65_SYMB',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error SYMB.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error SYMB.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\TRUST.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'TRUST.DBF',
             'ASVO_65_TRUST',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(21): Load error TRUST.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(22): Load error TRUST.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\WILL.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'WILL.DBF',
             'ASVO_65_WILL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(23): Load error WILL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(24): Load error WILL.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sAsvoDir || '\\CFP_GACC.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'CFP_GACC.DBF',
             'ASVO_65_CFP_GACC',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(25): Load error CFP_GACC.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(26): Load error CFP_GACC.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sAsvoDir || '\\RATEHIST.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'RATEHIST.DBF',
             'ASVO_65_RATEHIST',
             sKodirowka,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error RATEHIST.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(12): Load error RATEHIST.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sAsvoDir || '\\RH.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'RH.DBF',
             'ASVO_65_RH',
             sKodirowka,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error RH.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error RH.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sAsvoDir || '\\OPDAY.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'OPDAY.DBF',
             'ASVO_65_OPDAY',
             sKodirowka,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(23): Load error OPDAY.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(24): Load error OPDAY.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sAsvoDir || '\\OPER.DBF')
.head 8 +  If ImportDbf(sAsvoDir,
             'OPER.DBF',
             'ASVO_65_OPER',
             sKodirowka,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(25): Load error OPER.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(26): Load error OPER.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_as65_tables(sFFF)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: Dir
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDirs[*]
.head 4 +  Actions
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  String: sAsvoDir
.head 3 -  ! Boolean: fAsvoDir
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: s3
.head 3 -  String: sFFF
.head 3 -  String: sFFFactual
.head 3 -  String: sKKFFFactual
.head 3 -  String: sTVBVFFF
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  Number: nNumDirs2
.head 3 -  String: sDirs2[*]
.head 3 -  !
.head 3 -  String: sAsvoDBF
.head 3 -  Boolean: fAsvoDBF
.head 3 -  String: sAsvoNlsMask
.head 3 -  !
.head 3 -  String: sDPR
.head 3 -  String: sDASVO65X
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'Asvo65Path', '', sAsvoDir, GetIniFileName())
.head 4 -  Set sAsvoDir = IifS(Right(sAsvoDir, 1)='\\', Left(sAsvoDir, Len(sAsvoDir)-1), sAsvoDir) ! каталог АСВО6.5
.head 4 -  Set dfASVO = sAsvoDir
.head 4 -  ! Set fAsvoDir = Dir(sAsvoDir)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'Asvo65_DBF', '', sAsvoDBF, GetIniFileName())
.head 4 -  Set sAsvoDBF = IifS(Right(sAsvoDBF, 1)='\\', Left(sAsvoDBF, Len(sAsvoDBF)-1), sAsvoDBF) ! каталог DBF
.head 4 -  Set dfDBF = sAsvoDBF
.head 4 -  Set fAsvoDBF = Dir(sAsvoDBF)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'AsvoNlsMask', '', sAsvoNlsMask, GetIniFileName())
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_65_DEPARTAMENT')
   INTO   :nT
   FROM   dual") and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1 and SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_65_CARDFILE')
   INTO   :nT
   FROM   dual") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nT = 1
.head 7 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT lpad(to_char(depart),3,'0')
   INTO   :sTVBV
   FROM   ASVO_65_DEPARTAMENT
   WHERE  depart in (
          SELECT min(depart)
          FROM   ASVO_65_CARDFILE)") and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalListClear(lbTVBV)
.head 8 +  While Len(sTVBV) > 0
.head 9 -  Set s3 = Left(sTVBV, 3)
.head 9 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 9 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 7 -  Set sTVBV = STRING_Null
.head 7 -  Call SqlPLSQLCommand(hSql(), "get65_tvbv(sTVBV)")
.head 7 +  If sTVBV != STRING_Null
.head 8 -  Call SalListClear(lbTVBV)
.head 8 +  While Len(sTVBV) > 0
.head 9 -  Set s3 = Left(sTVBV, 3)
.head 9 -  Call SalListAdd(lbTVBV, s3 || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||s3||"'"))
.head 9 -  Set sTVBV = Right(sTVBV, Len(sTVBV)-3)
.head 8 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 4 -  Set dfNLS = 'NLS65.dbf'
.head 4 -  Set dfPRC = 'PRC65.dbf'
.head 4 -  Set dfNOT = 'NOT65.dbf'
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbAll)
.head 4 -  Call SalDisableWindow(pbNo)
.head 4 -  Call SalDisableWindow(pbInv)
.head 4 -  !
.head 4 -  Set rbWin = 1
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 0
.head 4 -  Set rbDWin = 0
.head 4 -  Set rbDDos = 0
.head 4 -  Set rbDUkg = 1
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sDPR
   FROM   params$base
   WHERE  par='BANKDATE'") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set sDPR = SalFmtFormatDateTime(SalDateCurrent(), 'MM/dd/yyyy')
.head 4 -  Set dfDASVO65X = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DASVO65X', '', sDASVO65X, '')
.head 4 +  If Len(sDASVO65X) = 0
.head 5 -  Set dfDASVO65X = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 +  Else
.head 5 -  Set dfDASVO65X = SalStrToDate(sDASVO65X)
.head 4 -  !
.head 4 -  Set dfPR = 'Проценты в АСВО должны быть начислены по ' || SalFmtFormatDateTime(dfDASVO65X, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDASVO65X, sDASVO65X)
.head 4 -  Call SalSetProfileString('MigrDate', 'DASVO65X', sDASVO65X, '')
.head 1 +  Dialog Box: dlg_ImportMegabank
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "МЕГАБАНК"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.113"
.head 4 -  Top:    1.073"
.head 4 -  Width:  17.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.179"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.655"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 +  If tbl1.PROV_SQLMEGA != STRING_Null
.head 8 -  Set sTmpF3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 8 -  ! Call Debug(sTmpF3)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini('FFF',sTmpF3,'ТВБВ в АСВО')")
.head 9 -  ! Set strPrintFileName = tbl1.PROV_SQLMEGA
.head 9 -  Call FunNSIGetFilteredEx(PROV_SQLMEGA, "FFF", "", sTmp1, sTmp2)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.488"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.071"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROV_SQLMEGA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя вюшки
Пров.SQL
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung,PROV_SQL
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP,:tbl1.PROV_SQLMEGA
     FROM   P_MIGRAMEGA
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If PROV_SQLMEGA != STRING_Null
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 210, 250))
.head 6 +  If Left(colPROC,9) = 'MEGATABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 +  List Box: lbTVBV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.067"
.head 5 -  Top:    5.976"
.head 5 -  Width:  10.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 36901
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    5.893"
.head 5 -  Width:  10.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.024"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог МЕГАБАНК
.head 4 -  Resource Id: 36902
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    6.988"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив МЕГАБАНК
.head 4 -  Resource Id: 36913
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    7.274"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF
.head 4 -  Resource Id: 36903
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    7.012"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: имя DBF-файла
.head 4 -  Resource Id: 36904
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.117"
.head 5 -  Top:    7.012"
.head 5 -  Width:  2.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDBF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.133"
.head 6 -  Top:    7.25"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMEGA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    6.952"
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMEGAArc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    7.25"
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.367"
.head 6 -  Top:    6.976"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 36907
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.033"
.head 5 -  Top:    6.952"
.head 5 -  Width:  10.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.869"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 36908
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    7.56"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 36909
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    7.571"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   5.067"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 36910
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.817"
.head 5 -  Top:    7.524"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbDWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   8.233"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.3"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   10.367"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 36911
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.15"
.head 5 -  Top:    7.5"
.head 5 -  Width:  3.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    5.607"
.head 6 -  Width:  10.917"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата миграции ТВБВ
.head 4 -  Resource Id: 36912
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    6.0"
.head 5 -  Width:  2.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDMEGAX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    6.238"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfPR = 'Проценты в МЕГАБАНК должны быть начислены по ' || SalFmtFormatDateTime(dfDMEGAX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 5 -  !
.head 5 -  Number: nNumFiles
.head 5 -  String: smFiles[*]
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'MEGATABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set s3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 6 -  ! Call Debug(s3)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask,dfDMEGAX)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 7 -  Call SalListSetSelect(lbTVBV, nI)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'MEGATABLE0'
.head 7 -  ! загрузка справочников из DBF
.head 7 +  If fMegaDBF
.head 8 -  Set tbl1.colDone = 0
.head 8 -  Set tbl1.colErr = 0
.head 8 -  !
.head 8 +  If rbDWin
.head 9 -  Set sKodirowka = 'WIN'
.head 8 +  If rbDDos
.head 9 -  Set sKodirowka = 'DOS'
.head 8 +  If rbDUkg
.head 9 -  Set sKodirowka = 'UKG'
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMPMEGA_NLS')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMPMEGA_NLS')
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMPMEGA_NLS')")
.head 8 +  If File(sMegaDBF || '\\' || dfNLS)
.head 9 +  If ImportDbf(sMegaDBF,
             dfNLS,
             'ASVO_TEMPMEGA_NLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' ||
     dfNLS || ' в таблицу ASVO_TEMPMEGA_NLS')
.head 10 -  !
.head 10 -  ! заполнение DPT_VIDD_ASVO и ASVO_NLS
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NLStoSPRMEGA(nNum,nErr,sErrMask,sMegaNlsMask,dfNLS)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(1) - невозможно выполнить процедуру migraAS.NLStoSPRMEGA')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2) отсутствует файл ' || sMegaDBF || '\\' || dfNLS)
.head 8 -  !
.head 7 +  Else
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): отсутствует каталог DBF - ' || sMegaDBF)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  If tbl1.colPROC = 'MEGATABLE1'
.head 7 -  ! загрузка файла вкладов МЕГАБАНК
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 -  Set nNumFiles = VisDosEnumFiles(sMegaDir || '\\MEGA0???.???', FA_Standard, smFiles)
.head 7 +  If nNumFiles = 1 and File(sMegaDir || '\\' || smFiles[0])
.head 8 +  If ImportDbf(sMegaDir,
             smFiles[0],
             'ASVO_MEGA',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sMegaArcDir || '\\' || smFiles[0], FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sMegaArcDir || '\\' || smFiles[0])
.head 9 -  Call VisFileRename(sMegaDir || '\\' || smFiles[0], sMegaArcDir || '\\' || smFiles[0])
.head 9 -  !
.head 9 -  Set sFFF = Subs(smFiles[0], 6, 3)
.head 9 -  Call SalListClear(lbTVBV)
.head 9 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='" || sFFF || "'"))
.head 9 -  !
.head 9 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_mega_tables(sFFF)')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error ' || smFiles[0] || ' - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error MEGA0???.??? - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: Dir
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDirs[*]
.head 4 +  Actions
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  String: sMegaDir
.head 3 -  String: sMegaArcDir
.head 3 -  !
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: sFFF
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  Number: nNumDirs2
.head 3 -  String: sDirs2[*]
.head 3 -  !
.head 3 -  String: sMegaDBF
.head 3 -  Boolean: fMegaDBF
.head 3 -  String: sMegaNlsMask
.head 3 -  !
.head 3 -  String: sDPR
.head 3 -  String: sDMEGAX
.head 3 -  !
.head 3 -  String: sRadioButtonsMB
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'MegaPath', '', sMegaDir, GetIniFileName())
.head 4 -  Set sMegaDir = IifS(Right(sMegaDir, 1)='\\', Left(sMegaDir, Len(sMegaDir)-1), sMegaDir) ! каталог МЕГАБАНК
.head 4 -  Set dfMEGA = sMegaDir
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'MegaArcPath', '', sMegaArcDir, GetIniFileName())
.head 4 -  Set sMegaArcDir = IifS(Right(sMegaArcDir, 1)='\\', Left(sMegaArcDir, Len(sMegaArcDir)-1), sMegaArcDir) ! архив
.head 4 -  Set dfMEGAArc = sMegaArcDir
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'Mega_DBF', '', sMegaDBF, GetIniFileName())
.head 4 -  Set sMegaDBF = IifS(Right(sMegaDBF, 1)='\\', Left(sMegaDBF, Len(sMegaDBF)-1), sMegaDBF) ! каталог с NLS.DBF
.head 4 -  Set dfDBF = sMegaDBF
.head 4 -  Set fMegaDBF = Dir(sMegaDBF)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'MegaNlsMask', '', sMegaNlsMask, GetIniFileName())
.head 4 -  Set dfNLS = 'NLS.dbf'
.head 4 -  !
.head 4 -  ! Set rbWin = 0
.head 4 -  ! Set rbDos = 0
.head 4 -  ! Set rbUkg = 1
.head 4 -  ! Set rbDWin = 0
.head 4 -  ! Set rbDDos = 0
.head 4 -  ! Set rbDUkg = 1
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('RadioButtonsMB', 'Values', '001001', sRadioButtonsMB, '')
.head 4 -  Set rbWin = Left(sRadioButtonsMB, 1) = '1'
.head 4 -  Set rbDos = Subs(sRadioButtonsMB, 2, 1) = '1'
.head 4 -  Set rbUkg = Subs(sRadioButtonsMB, 3, 1) = '1'
.head 4 -  Set rbDWin = Subs(sRadioButtonsMB, 4, 1) = '1'
.head 4 -  Set rbDDos = Subs(sRadioButtonsMB, 5, 1) = '1'
.head 4 -  Set rbDUkg = Subs(sRadioButtonsMB, 6, 1) = '1'
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sDPR
   FROM   params$base
   WHERE  par='BANKDATE'") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set sDPR = SalFmtFormatDateTime(SalDateCurrent(), 'MM/dd/yyyy')
.head 4 -  Set dfDMEGAX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DMEGAX', '', sDMEGAX, '')
.head 4 -  Call SalGetProfileString('MigrDate', 'SMEGA3', '', sFFF, '')
.head 4 -  Call SalListClear(lbTVBV)
.head 4 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='" || sFFF || "'"))
.head 4 +  If Len(sDMEGAX) = 0
.head 5 -  Set dfDMEGAX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 +  Else
.head 5 -  Set dfDMEGAX = SalStrToDate(sDMEGAX)
.head 4 -  !
.head 4 -  Set dfPR = 'Проценты в МЕГАБАНК должны быть начислены по ' || SalFmtFormatDateTime(dfDMEGAX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDMEGAX, sDMEGAX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DMEGAX', sDMEGAX, '')
.head 4 -  Call SalSetProfileString('MigrDate', 'SMEGA3', sFFF, '')
.head 4 -  Call SalSetProfileString('RadioButtonsMB', 'Values', IifS(rbWin, '1', '0') || IifS(rbDos, '1', '0') ||
     IifS(rbUkg, '1', '0') || IifS(rbDWin, '1', '0') || IifS(rbDDos, '1', '0') || IifS(rbDUkg, '1', '0'), '')
.head 1 +  Dialog Box: dlg_ImportImmobile
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция неподвижных  вкладов -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.425"
.head 4 -  Top:    1.01"
.head 4 -  Width:  17.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.25"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.655"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 +  If tbl1.PROV_SQLIMMO != STRING_Null
.head 8 -  Set sTmpF3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 8 -  ! Call Debug(sTmpF3)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini('FFF',sTmpF3,'ТВБВ в АСВО')")
.head 9 -  ! Set strPrintFileName = tbl1.PROV_SQLIMMO
.head 9 -  Call FunNSIGetFilteredEx(PROV_SQLIMMO, "FFF", "", sTmp1, sTmp2)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.488"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.071"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROV_SQLIMMO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя вюшки
Пров.SQL
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung,PROV_SQL
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP,:tbl1.PROV_SQLIMMO
     FROM   P_MIGRAASIM
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If PROV_SQLIMMO != STRING_Null
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 210, 250))
.head 6 +  If Left(colPROC,9) = 'ASVOTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 +  List Box: lbTVBV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.333"
.head 5 -  Top:    6.631"
.head 5 -  Width:  10.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.262"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 39188
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    6.607"
.head 5 -  Width:  13.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог файлов неподвижных вкладов
.head 4 -  Resource Id: 39189
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    5.667"
.head 5 -  Width:  4.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив файлов неподвижных вкладов
.head 4 -  Resource Id: 39190
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    5.952"
.head 5 -  Width:  4.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfIMMO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.467"
.head 6 -  Top:    5.667"
.head 6 -  Width:  6.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfIMMOArc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.467"
.head 6 -  Top:    5.94"
.head 6 -  Width:  6.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 39195
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.517"
.head 5 -  Top:    6.286"
.head 5 -  Width:  2.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   11.2"
.head 5 -  Top:    6.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   12.45"
.head 5 -  Top:    6.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   13.7"
.head 5 -  Top:    6.262"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 39196
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.467"
.head 5 -  Top:    6.226"
.head 5 -  Width:  6.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата миграции
.head 4 -  Resource Id: 39198
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   14.767"
.head 5 -  Top:    5.798"
.head 5 -  Width:  1.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDIMMOX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   15.183"
.head 6 -  Top:    6.06"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: dd.MM.yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код ТВБВ
.head 4 -  Resource Id: 19875
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.4"
.head 5 -  Top:    6.679"
.head 5 -  Width:  1.217"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: df5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.717"
.head 6 -  Top:    6.631"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 61649
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  10.95"
.head 5 -  Begin Y:  6.226"
.head 5 -  End X:  10.95"
.head 5 -  End Y:  6.56"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Dark Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 5 -  !
.head 5 -  Number: nNumFiles
.head 5 -  String: smFiles[*]
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'ASVOTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set s3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 6 -  ! Call Debug(s3)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask,dfDIMMOX)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 7 -  Call SalListSetSelect(lbTVBV, nI)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'ASVOTABLEI'
.head 7 -  ! загрузка файла вкладов МЕГАБАНК
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 -  Set nNumFiles = VisDosEnumFiles(sImmoDir || '\\FDEP0???.DBF', FA_Standard, smFiles)
.head 7 +  If nNumFiles = 1 and File(sImmoDir || '\\' || smFiles[0])
.head 8 +  If ImportDbf(sImmoDir,
             smFiles[0],
             'ASVO_FDEP',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sImmoArcDir || '\\' || smFiles[0], FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sImmoArcDir || '\\' || smFiles[0])
.head 9 -  Call VisFileRename(sImmoDir || '\\' || smFiles[0], sImmoArcDir || '\\' || smFiles[0])
.head 9 -  !
.head 9 -  Set sFFF = Subs(smFiles[0], 6, 3)
.head 9 -  Call SalListClear(lbTVBV)
.head 9 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||sFFF||"'"))
.head 9 -  Set df5 = sFFF
.head 9 -  !
.head 9 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_immo_table_dep(sFFF)')
.head 9 -  !
.head 9 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 9 -  Call SalSetProfileString('MigrDate', 'SIMMO3', sFFF, '')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error ' || smFiles[0] || ' - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error FDEP0???.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set nNumFiles = VisDosEnumFiles(sImmoDir || '\\FDPI0' || sFFF || '.DBF', FA_Standard, smFiles)
.head 7 +  If nNumFiles = 1 and File(sImmoDir || '\\' || smFiles[0])
.head 8 +  If ImportDbf(sImmoDir,
             smFiles[0],
             'ASVO_FDPI',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sImmoArcDir || '\\' || smFiles[0], FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sImmoArcDir || '\\' || smFiles[0])
.head 9 -  Call VisFileRename(sImmoDir || '\\' || smFiles[0], sImmoArcDir || '\\' || smFiles[0])
.head 9 -  !
.head 9 -  ! Set sFFF = Subs(smFiles[0], 6, 3)
.head 9 -  ! Call SalListClear(lbTVBV)
.head 9 -  ! Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||sFFF||"'"))
.head 9 -  !
.head 9 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_immo_table_dpi(sFFF)')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error ' || smFiles[0] || ' - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error FDPI0' || sFFF || '.DBF - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: Dir
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDirs[*]
.head 4 +  Actions
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  String: sImmoDir
.head 3 -  String: sImmoArcDir
.head 3 -  !
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: sFFF
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  Number: nNumDirs2
.head 3 -  String: sDirs2[*]
.head 3 -  !
.head 3 -  ! String: sImmoDBF
.head 3 -  ! Boolean: fImmoDBF
.head 3 -  ! String: sImmoNlsMask
.head 3 -  !
.head 3 -  String: sDPR
.head 3 -  String: sDIMMOX
.head 3 -  !
.head 3 -  String: sRadioButtonsIM
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'ImmoPath', '', sImmoDir, GetIniFileName())
.head 4 -  Set sImmoDir = IifS(Right(sImmoDir, 1)='\\', Left(sImmoDir, Len(sImmoDir)-1), sImmoDir) ! каталог н.вклалов
.head 4 -  Set dfIMMO = sImmoDir
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'ImmoArcPath', '', sImmoArcDir, GetIniFileName())
.head 4 -  Set sImmoArcDir = IifS(Right(sImmoArcDir, 1)='\\', Left(sImmoArcDir, Len(sImmoArcDir)-1), sImmoArcDir) ! архив
.head 4 -  Set dfIMMOArc = sImmoArcDir
.head 4 -  !
.head 4 -  ! Call SalGetProfileString('Import', 'Immo_DBF', '', sImmoDBF, GetIniFileName())
.head 4 -  ! Set sImmoDBF = IifS(Right(sImmoDBF, 1)='\\', Left(sImmoDBF, Len(sImmoDBF)-1), sImmoDBF) ! каталог с NLS.DBF
.head 4 -  ! Set dfIMMO = sImmoDBF
.head 4 -  ! Set fImmoDBF = Dir(sImmoDBF)
.head 4 -  !
.head 4 -  ! Call SalGetProfileString('Import', 'ImmoNlsMask', '', sImmoNlsMask, GetIniFileName())
.head 4 -  !
.head 4 -  ! Set rbWin = 0
.head 4 -  ! Set rbDos = 0
.head 4 -  ! Set rbUkg = 1
.head 4 -  ! Set rbDWin = 0
.head 4 -  ! Set rbDDos = 0
.head 4 -  ! Set rbDUkg = 1
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('RadioButtonsIM', 'Values', '001001', sRadioButtonsIM, '')
.head 4 -  Set rbWin = Left(sRadioButtonsIM, 1) = '1'
.head 4 -  Set rbDos = Subs(sRadioButtonsIM, 2, 1) = '1'
.head 4 -  Set rbUkg = Subs(sRadioButtonsIM, 3, 1) = '1'
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sDPR
   FROM   params$base
   WHERE  par='BANKDATE'") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set sDPR = SalFmtFormatDateTime(SalDateCurrent(), 'MM/dd/yyyy')
.head 4 -  Set dfDIMMOX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DIMMOX', '', sDIMMOX, '')
.head 4 -  Call SalGetProfileString('MigrDate', 'SIMMO3', '', sFFF, '')
.head 4 -  Call SalListClear(lbTVBV)
.head 4 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='" || sFFF || "'"))
.head 4 -  Set df5 = sFFF
.head 4 +  If Len(sDIMMOX) = 0
.head 5 -  Set dfDIMMOX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 +  Else
.head 5 -  Set dfDIMMOX = SalStrToDate(sDIMMOX)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDIMMOX, sDIMMOX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DIMMOX', sDIMMOX, '')
.head 4 -  Call SalSetProfileString('MigrDate', 'SIMMO3', sFFF, '')
.head 4 -  Call SalSetProfileString('RadioButtonsIM', 'Values', IifS(rbWin, '1', '0') || IifS(rbDos, '1', '0') ||
     IifS(rbUkg, '1', '0'), '')
.head 1 +  Dialog Box: dlg_ImportSBON
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "СБОН"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.113"
.head 4 -  Top:    1.073"
.head 4 -  Width:  17.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.179"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.655"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 +  If tbl1.PROV_SQLSBON != STRING_Null
.head 8 -  Set sTmpF3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 8 -  ! Call Debug(sTmpF3)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini('FFF',sTmpF3,'ТВБВ в СБОН')")
.head 9 -  ! Set strPrintFileName = tbl1.PROV_SQLSBON
.head 9 -  Call FunNSIGetFilteredEx(PROV_SQLSBON, "FFF", "", sTmp1, sTmp2)
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.488"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    6.071"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROV_SQLSBON
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя вюшки
Пров.SQL
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung,PROV_SQL
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP,:tbl1.PROV_SQLSBON
     FROM   P_MIGRASBON
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If PROV_SQLSBON != STRING_Null
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 210, 250))
.head 6 +  If Left(colPROC,9) = 'SBONTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 +  List Box: lbTVBV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.067"
.head 5 -  Top:    5.976"
.head 5 -  Width:  10.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 21462
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    5.893"
.head 5 -  Width:  10.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.024"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог СБОН
.head 4 -  Resource Id: 21463
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    6.988"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив СБОН
.head 4 -  Resource Id: 21464
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    7.274"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF
.head 4 -  Resource Id: 21465
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    7.012"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: имя DBF-файла
.head 4 -  Resource Id: 21466
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.117"
.head 5 -  Top:    7.012"
.head 5 -  Width:  2.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDBF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.133"
.head 6 -  Top:    7.25"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSBON
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    6.952"
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSBONArc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    7.25"
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.367"
.head 6 -  Top:    6.976"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 21467
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.033"
.head 5 -  Top:    6.952"
.head 5 -  Width:  10.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.869"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 21468
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    7.56"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кодировка DBF
.head 4 -  Resource Id: 21469
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    7.571"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   5.067"
.head 5 -  Top:    7.548"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 21470
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.817"
.head 5 -  Top:    7.524"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbDWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   8.233"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.3"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   10.367"
.head 5 -  Top:    7.524"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 21471
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.15"
.head 5 -  Top:    7.5"
.head 5 -  Width:  3.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    5.607"
.head 6 -  Width:  10.917"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата миграции ТВБВ
.head 4 -  Resource Id: 21472
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    6.0"
.head 5 -  Width:  2.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDSBONX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    6.238"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfPR = 'Проценты в СБОН должны быть начислены по ' || SalFmtFormatDateTime(dfDSBONX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 5 -  !
.head 5 -  Number: nNumFiles
.head 5 -  String: smFiles[*]
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'SBONTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set s3 = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 6 -  ! Call Debug(s3)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(s3,nNum,nErr,sErrMask,dfDSBONX)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 7 -  Call SalListSetSelect(lbTVBV, nI)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'SBONTABLE0'
.head 7 -  ! загрузка справочников из DBF
.head 7 +  If fSBONDBF
.head 8 -  Set tbl1.colDone = 0
.head 8 -  Set tbl1.colErr = 0
.head 8 -  !
.head 8 +  If rbDWin
.head 9 -  Set sKodirowka = 'WIN'
.head 8 +  If rbDDos
.head 9 -  Set sKodirowka = 'DOS'
.head 8 +  If rbDUkg
.head 9 -  Set sKodirowka = 'UKG'
.head 8 -  !
.head 8 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('ASVO_TEMPSBON_NLS')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nT = 1
.head 10 -  ! Call SqlPrepareAndExecute(hSql(), 'DROP TABLE ASVO_TEMPSBON_NLS')
.head 10 -  Call SqlPLSQLCommand(hSql(), "drop_table('ASVO_TEMPSBON_NLS')")
.head 8 +  If File(sSBONDBF || '\\' || dfNLS)
.head 9 +  If ImportDbf(sSBONDBF,
             dfNLS,
             'ASVO_TEMPSBON_NLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 10 -  Set tbl1.colDone = tbl1.colDone + 1
.head 10 -  Call SqlCommitEx(hSql(), Left(tbl1.colErrMask, Len(tbl1.colErrMask)-5) || ' - выполнен импорт файла ' ||
     dfNLS || ' в таблицу ASVO_TEMPSBON_NLS')
.head 10 -  !
.head 10 -  ! заполнение DPT_VIDD_ASVO и ASVO_NLS
.head 10 -  Set nNum = tbl1.colDone
.head 10 -  Set nErr = tbl1.colErr
.head 10 -  Set sErrMask = tbl1.colErrMask
.head 10 +  If SqlPLSQLCommand(hSql(), 'migraAS.NLStoSPRSBON(nNum,nErr,sErrMask,sSBONNlsMask,dfNLS)')
.head 11 -  Set tbl1.colDone = nNum
.head 11 -  Set tbl1.colErr = nErr
.head 10 +  Else
.head 11 -  Set tbl1.colErr = tbl1.colErr + 1
.head 11 -  Call SaveErrorToLog(tbl1.colErrMask || '(1) - невозможно выполнить процедуру migraAS.NLStoSPRSBON')
.head 8 +  Else
.head 9 -  Set tbl1.colErr = tbl1.colErr + 1
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2) отсутствует файл ' || sSBONDBF || '\\' || dfNLS)
.head 8 -  !
.head 7 +  Else
.head 8 -  Set tbl1.colErr = tbl1.colErr + 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): отсутствует каталог DBF - ' || sSBONDBF)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  If tbl1.colPROC = 'SBONTABLE1'
.head 7 -  ! загрузка файла вкладов СБОН
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  Set sFFF = Left(SalListQueryTextX(lbTVBV, 0), 3)
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 -  Set nNumFiles = VisDosEnumFiles(sSBONDir || '\\SBON0???.???', FA_Standard, smFiles)
.head 7 +  If nNumFiles = 1 and File(sSBONDir || '\\' || smFiles[0])
.head 8 +  If ImportDbf(sSBONDir,
             smFiles[0],
             'ASVO_SBON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sSBONArcDir || '\\' || smFiles[0], FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sSBONArcDir || '\\' || smFiles[0])
.head 9 -  Call VisFileRename(sSBONDir || '\\' || smFiles[0], sSBONArcDir || '\\' || smFiles[0])
.head 9 -  !
.head 9 -  Set sFFF = Subs(smFiles[0], 6, 3)
.head 9 -  Call SalListClear(lbTVBV)
.head 9 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||sFFF||"'"))
.head 9 -  !
.head 9 -  Call SqlPLSQLCommand(hSql(), 'migraAS.copy_SBON_tables(sFFF)')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error ' || smFiles[0] || ' - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ' || smFiles[0] || ' - no file')
.head 8 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  Function: Dir
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDir
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDirs[*]
.head 4 +  Actions
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  String: sSBONDir
.head 3 -  String: sSBONArcDir
.head 3 -  !
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: sFFF
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  Number: nNumDirs2
.head 3 -  String: sDirs2[*]
.head 3 -  !
.head 3 -  String: sSBONDBF
.head 3 -  Boolean: fSBONDBF
.head 3 -  String: sSBONNlsMask
.head 3 -  !
.head 3 -  String: sDPR
.head 3 -  String: sDSBONX
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'SBONPath', '', sSBONDir, GetIniFileName())
.head 4 -  Set sSBONDir = IifS(Right(sSBONDir, 1)='\\', Left(sSBONDir, Len(sSBONDir)-1), sSBONDir) ! каталог SBON
.head 4 -  Set dfSBON = sSBONDir
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'SBONArcPath', '', sSBONArcDir, GetIniFileName())
.head 4 -  Set sSBONArcDir = IifS(Right(sSBONArcDir, 1)='\\', Left(sSBONArcDir, Len(sSBONArcDir)-1), sSBONArcDir) ! архив
.head 4 -  Set dfSBONArc = sSBONArcDir
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'SBON_DBF', '', sSBONDBF, GetIniFileName())
.head 4 -  Set sSBONDBF = IifS(Right(sSBONDBF, 1)='\\', Left(sSBONDBF, Len(sSBONDBF)-1), sSBONDBF) ! каталог с NLS.DBF
.head 4 -  Set dfDBF = sSBONDBF
.head 4 -  Set fSBONDBF = Dir(sSBONDBF)
.head 4 -  !
.head 4 -  Call SalGetProfileString('Import', 'SBONNlsMask', '', sSBONNlsMask, GetIniFileName())
.head 4 -  Set dfNLS = 'NLS.dbf'
.head 4 -  !
.head 4 -  Set rbWin = 0
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 1
.head 4 -  Set rbDWin = 0
.head 4 -  Set rbDDos = 0
.head 4 -  Set rbDUkg = 1
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT val
   INTO   :sDPR
   FROM   params$base
   WHERE  par='BANKDATE'") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set sDPR = SalFmtFormatDateTime(SalDateCurrent(), 'MM/dd/yyyy')
.head 4 -  Set dfDSBONX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DSBONX', '', sDSBONX, '')
.head 4 -  Call SalGetProfileString('MigrDate', 'SSBON3', '', sFFF, '')
.head 4 -  Call SalListClear(lbTVBV)
.head 4 -  Call SalListAdd(lbTVBV, sFFF || '  ' || GetValueStr("
     SELECT rpad(b.branch, 30)||' '||b.name
     FROM   branch b, asvo_fff_branch a
     WHERE  a.branch=b.branch and a.fff='"||sFFF||"'"))
.head 4 +  If Len(sDSBONX) = 0
.head 5 -  Set dfDSBONX = SalDateConstruct(Val(Right(sDPR, 4)), Val(Left(sDPR, 2)), Val(Subs(sDPR, 4, 2)), 0, 0, 0)
.head 4 +  Else
.head 5 -  Set dfDSBONX = SalStrToDate(sDSBONX)
.head 4 -  !
.head 4 -  Set dfPR = 'Проценты в СБОН должны быть начислены по ' || SalFmtFormatDateTime(dfDSBONX, 'dd/MM/yyyy') ||
    ' ВКЛЮЧИТЕЛЬНО !'
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDSBONX, sDSBONX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DSBONX', sDSBONX, '')
.head 4 -  Call SalSetProfileString('MigrDate', 'SSBON3', sFFF, '')
.head 1 +  Dialog Box: dlg_ImportUnicorn
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "Unicorn"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.975"
.head 4 -  Top:    0.927"
.head 4 -  Width:  16.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.702"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.083"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.917"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.5"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.071"
.head 6 -  Width:  16.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.964"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP
     FROM   P_MIGRAUNIC
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If Left(colPROC,9) = 'UNICTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 -  Background Text: Каталог DBF-файлов UNICORN
.head 4 -  Resource Id: 5151
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    7.19"
.head 5 -  Width:  4.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов UNICORN
.head 4 -  Resource Id: 5155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    7.774"
.head 5 -  Width:  4.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUNICORN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    7.452"
.head 6 -  Width:  4.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfArcUNICORN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    8.036"
.head 6 -  Width:  4.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 5152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    7.607"
.head 5 -  Width:  1.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.226"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.595"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.964"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 5154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.617"
.head 5 -  Begin Y:  7.119"
.head 5 -  End X:  9.617"
.head 5 -  End Y:  8.345"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Dark Gray
.head 3 -  Frame
.head 4 -  Resource Id: 5156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    7.083"
.head 5 -  Width:  7.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.274"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 35175
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  7.867"
.head 5 -  Begin Y:  7.095"
.head 5 -  End X:  7.867"
.head 5 -  End Y:  8.333"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'UNICTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  ! Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'UNICTABLE'
.head 7 -  ! загрузка DBF-файлов Unicorn
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'USERS.DBF',
             'S6_UN_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\USERS.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\USERS.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\USERS.DBF', sUnicornArcDir || '\\USERS.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\USERS.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error USERS.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\CLIOUT.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'CLIOUT.DBF',
             'S6_UN_CLIOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\CLIOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\CLIOUT.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\CLIOUT.DBF', sUnicornArcDir || '\\CLIOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error CLIOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\CLIOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error CLIOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\ALCOUT.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'ALCOUT.DBF',
             'S6_UN_ALCOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\ALCOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\ALCOUT.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\ALCOUT.DBF', sUnicornArcDir || '\\ALCOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error ALCOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\ALCOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALCOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\ALNLSN.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'ALNLSN.DBF',
             'S6_UN_ALNLSN',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\ALNLSN.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\ALNLSN.DBF', sUnicornArcDir || '\\ALNLSN.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error ALNLSN.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\ALNLSN.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALNLSN.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\ALMOUT.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'ALMOUT.DBF',
             'S6_UN_ALMOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\ALMOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\ALMOUT.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\ALMOUT.DBF', sUnicornArcDir || '\\ALMOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error ALMOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\ALMOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALMOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornDir || '\\OBNLS.DBF')
.head 8 +  If ImportDbf(sUnicornDir,
             'OBNLS.DBF',
             'S6_UN_OBNLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornArcDir || '\\OBNLS.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornArcDir || '\\OBNLS.DBF')
.head 9 -  Call VisFileRename(sUnicornDir || '\\OBNLS.DBF', sUnicornArcDir || '\\OBNLS.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error OBNLS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornArcDir || '\\OBNLS.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error OBNLS.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatEnd
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  ! Function: Dir
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sDir
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sDirs[*]
.head 4 +  Actions 
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  ! Boolean: fAsvoDir
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: s3
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  !
.head 3 -  String: sUnicornDir
.head 3 -  String: sUnicornArcDir
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'UnicornPath', '', sUnicornDir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'UnicornArcPath', '', sUnicornArcDir, GetIniFileName())
.head 4 -  Set sUnicornDir = IifS(Right(sUnicornDir, 1)='\\', Left(sUnicornDir, Len(sUnicornDir)-1), sUnicornDir)
.head 4 -  Set sUnicornArcDir = IifS(Right(sUnicornArcDir, 1)='\\', Left(sUnicornArcDir, Len(sUnicornArcDir)-1), sUnicornArcDir)
.head 4 -  Set dfUNICORN = sUnicornDir
.head 4 -  Set dfArcUNICORN = sUnicornArcDir
.head 4 -  !
.head 4 -  Set rbWin = 0
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 1
.head 1 +  Dialog Box: dlg_ImportNadra
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "Надра"  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.975"
.head 4 -  Top:    0.927"
.head 4 -  Width:  16.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.702"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.083"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.917"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    7.5"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.071"
.head 6 -  Width:  16.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.964"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NPP 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.129"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask,ordnung
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask,:tbl1.NPP
     FROM   P_MIGRANADR
     ORDER  BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If Left(colPROC,9) = 'NADRTABLE'
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(243, 227, 211))
.head 3 -  Background Text: Каталог DBF-файлов NADRA
.head 4 -  Resource Id: 59459
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    7.19"
.head 5 -  Width:  4.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов NADRA
.head 4 -  Resource Id: 59460
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    7.774"
.head 5 -  Width:  4.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNADRA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    7.452"
.head 6 -  Width:  4.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfArcNADRA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    8.036"
.head 6 -  Width:  4.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 59461
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    7.607"
.head 5 -  Width:  1.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.226"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.595"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    7.964"
.head 5 -  Width:  0.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 59462
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.617"
.head 5 -  Begin Y:  7.119"
.head 5 -  End X:  9.617"
.head 5 -  End Y:  8.345"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Dark Gray
.head 3 -  Frame
.head 4 -  Resource Id: 59463
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    7.083"
.head 5 -  Width:  7.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.274"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 59464
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  7.867"
.head 5 -  Begin Y:  7.095"
.head 5 -  End X:  7.867"
.head 5 -  End Y:  8.333"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  Number: nI
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  Number: n99
.head 5 -  String: sTVBV
.head 5 -  String: s3
.head 5 -  Number: nKKnot
.head 5 -  String: sKK
.head 5 -  !
.head 5 -  String: sErrMask
.head 5 -  String: sKodirowka
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'NADRTABLE'
.head 6 -  ! выполнение процедуры
.head 6 -  Call SalInvalidateWindow(tbl1)
.head 6 -  Set nNum = 0
.head 6 -  Set nErr = 0
.head 6 -  ! Set sErrMask = tbl1.colErrMask
.head 6 -  Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 6 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colDone = nNum
.head 7 -  Set tbl1.colErr = nErr
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || '(0): Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'NADRTABLE'
.head 7 -  ! загрузка DBF-файлов NADRA
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'USERS.DBF',
             'S6_NA_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\USERS.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\USERS.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\USERS.DBF', sNadraArcDir || '\\USERS.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\USERS.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error USERS.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\CLIOUT.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'CLIOUT.DBF',
             'S6_NA_CLIOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\CLIOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\CLIOUT.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\CLIOUT.DBF', sNadraArcDir || '\\CLIOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error CLIOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\CLIOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error CLIOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\ALCOUT.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'ALCOUT.DBF',
             'S6_NA_ALCOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\ALCOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\ALCOUT.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\ALCOUT.DBF', sNadraArcDir || '\\ALCOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error ALCOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\ALCOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALCOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\ALNLSN.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'ALNLSN.DBF',
             'S6_NA_ALNLSN',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\ALNLSN.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\ALNLSN.DBF', sNadraArcDir || '\\ALNLSN.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error ALNLSN.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\ALNLSN.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALNLSN.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\ALMOUT.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'ALMOUT.DBF',
             'S6_UN_ALMOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\ALMOUT.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\ALMOUT.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\ALMOUT.DBF', sNadraArcDir || '\\ALMOUT.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error ALMOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\ALMOUT.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error ALMOUT.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraDir || '\\OBNLS.DBF')
.head 8 +  If ImportDbf(sNadraDir,
             'OBNLS.DBF',
             'S6_UN_OBNLS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraArcDir || '\\OBNLS.DBF', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraArcDir || '\\OBNLS.DBF')
.head 9 -  Call VisFileRename(sNadraDir || '\\OBNLS.DBF', sNadraArcDir || '\\OBNLS.DBF')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(11): Load error OBNLS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraArcDir || '\\OBNLS.DBF')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error OBNLS.DBF - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatEnd
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 3 +  ! Function: Dir
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sDir
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sDirs[*]
.head 4 +  Actions 
.head 5 -  Return VisDosEnumDirs(sDir, sDirs)=1
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  String: sTmpF3
.head 3 -  ! Boolean: fAsvoDir
.head 3 -  String: sErrMsg
.head 3 -  String: sTVBV
.head 3 -  String: s3
.head 3 -  Number: nT
.head 3 -  Number: nI
.head 3 -  Number: nJ
.head 3 -  ! Number: nL
.head 3 -  Number: nNum
.head 3 -  Number: nErr
.head 3 -  !
.head 3 -  String: sNadraDir
.head 3 -  String: sNadraArcDir
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'NadraPath', '', sNadraDir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'NadraArcPath', '', sNadraArcDir, GetIniFileName())
.head 4 -  Set sNadraDir = IifS(Right(sNadraDir, 1)='\\', Left(sNadraDir, Len(sNadraDir)-1), sNadraDir)
.head 4 -  Set sNadraArcDir = IifS(Right(sNadraArcDir, 1)='\\', Left(sNadraArcDir, Len(sNadraArcDir)-1), sNadraArcDir)
.head 4 -  Set dfNADRA = sNadraDir
.head 4 -  Set dfArcNADRA = sNadraArcDir
.head 4 -  !
.head 4 -  Set rbWin = 1
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 0
.head 1 +  Dialog Box: dlg_ImportFUnicorn
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "Unicorn" (ф)  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   3.038"
.head 4 -  Top:    0.917"
.head 4 -  Width:  16.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.107"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных Unicorn (филиал) --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM P_MIGRAUNIF
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    6.881"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.131"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.381"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 33835
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    7.155"
.head 5 -  Width:  1.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 33836
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF-файлов Unicorn
.head 4 -  Resource Id: 33837
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    6.821"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов Unicorn
.head 4 -  Resource Id: 33838
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.367"
.head 5 -  Top:    7.286"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUnicornF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.024"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfUnicornFarc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.488"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 33839
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    6.75"
.head 5 -  Width:  4.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код филиала (МФО)
.head 4 -  Resource Id: 33840
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFILIAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    6.833"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    7.119"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата перевода филиала
.head 4 -  Resource Id: 33841
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.15"
.head 5 -  Top:    7.143"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 33842
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.117"
.head 5 -  Begin Y:  6.857"
.head 5 -  End X:  9.117"
.head 5 -  End Y:  7.643"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  String: sKodirowka
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatBeg
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'UNIFTABLE'
.head 6 +  If dfFILIAL != STRING_Null
.head 7 -  ! выполнение процедуры
.head 7 -  Call SalInvalidateWindow(tbl1)
.head 7 -  Set nNum = 0
.head 7 -  Set nErr = 0
.head 7 -  Set sCommand = tbl1.colPROC || '(dfFILIAL,nNum,nErr,dfDATX)'
.head 7 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 7 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colDone = nNum
.head 8 -  Set tbl1.colErr = nErr
.head 7 +  Else
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colErr = 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - не задан Код филиала (МФО)')
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'UNIFTABLE'
.head 7 -  ! загрузка DBF-файлов UnicornF
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\MFOOUT.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'MFOOUT.DBF',
             'S6_UF_MFOOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\MFOOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\MFOOUT.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\MFOOUT.dbf', sUnicornFArcDir || '\\MFOOUT.dbf')
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(mfo)
   INTO   :dfFILIAL
   FROM   S6_UF_MFOOUT
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dfFILIAL = STRING_Null
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error MFOOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\MFOOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error MFOOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'USERS.DBF',
             'S6_UF_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\USERS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\USERS.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\USERS.dbf', sUnicornFArcDir || '\\USERS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\USERS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): Load error USERS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\CLIOUT.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'CLIOUT.DBF',
             'S6_UF_CLIOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\CLIOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\CLIOUT.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\CLIOUT.dbf', sUnicornFArcDir || '\\CLIOUT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error CLIOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\CLIOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6): Load error CLIOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\ALCOUT.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'ALCOUT.DBF',
             'S6_UF_ALCOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\ALCOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\ALCOUT.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\ALCOUT.dbf', sUnicornFArcDir || '\\ALCOUT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error ALCOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\ALCOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error ALCOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\ALNLSN.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'ALNLSN.DBF',
             'S6_UF_ALNLSN',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\ALNLSN.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\ALNLSN.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\ALNLSN.dbf', sUnicornFArcDir || '\\ALNLSN.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error ALNLSN.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\ALNLSN.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error ALNLSN.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  ! Здесь продолжить грузить дополнительные (справочные) таблицы
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\FILIAL.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'FILIAL.DBF',
             'S6_UF_FILIAL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\FILIAL.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\FILIAL.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\FILIAL.dbf', sUnicornFArcDir || '\\FILIAL.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error FILIAL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\FILIAL.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error FILIAL.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\SHABLON.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'SHABLON.DBF',
             'S6_UF_SHABLON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\SHABLON.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\SHABLON.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\SHABLON.dbf', sUnicornFArcDir || '\\SHABLON.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error SHABLON.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\SHABLON.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error SHABLON.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\DEPO.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'DEPO.DBF',
             'S6_UF_DEPO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\DEPO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\DEPO.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\DEPO.dbf', sUnicornFArcDir || '\\DEPO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error DEPO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\DEPO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error DEPO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sUnicornFDir || '\\GROUP_C.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'GROUP_C.DBF',
             'S6_UF_GROUP_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\GROUP_C.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\GROUP_C.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\GROUP_C.dbf', sUnicornFArcDir || '\\GROUP_C.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error GROUP_C.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sUnicornFArcDir || '\\GROUP_C.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error GROUP_C.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sUnicornFDir || '\\TRANSIT.DBF')
.head 8 +  If ImportDbf(sUnicornFDir,
             'TRANSIT.DBF',
             'S6_UF_TRANSIT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sUnicornFArcDir || '\\TRANSIT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sUnicornFArcDir || '\\TRANSIT.dbf')
.head 9 -  Call VisFileRename(sUnicornFDir || '\\TRANSIT.dbf', sUnicornFArcDir || '\\TRANSIT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(21): Load error TRANSIT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sUnicornFArcDir || '\\TRANSIT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(22): Load error TRANSIT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraSK.copy_iniF_tables(dfFILIAL)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sUnicornFDir
.head 3 -  String: sUnicornFArcDir
.head 3 -  Number: nT
.head 3 -  String: sDATX
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'UnicornFPath', '', sUnicornFDir, GetIniFileName())
.head 4 -  Set sUnicornFDir = IifS(Right(sUnicornFDir, 1)='\\', Left(sUnicornFDir, Len(sUnicornFDir)-1), sUnicornFDir)
    ! каталог Unicorn(ф)
.head 4 -  Set dfUnicornF = sUnicornFDir
.head 4 -  Call SalGetProfileString('Import', 'UnicornFArcPath', '', sUnicornFArcDir, GetIniFileName())
.head 4 -  Set sUnicornFArcDir = IifS(Right(sUnicornFArcDir, 1)='\\', Left(sUnicornFArcDir, Len(sUnicornFArcDir)-1),
    sUnicornFArcDir) ! архив
.head 4 -  Set dfUnicornFarc = sUnicornFArcDir
.head 4 -  !
.head 4 -  Set rbWin = 0
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 1
.head 4 -  ! Set dfDATX = SalDateCurrent()
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DATX', '', sDATX, '')
.head 4 +  If Len(sDATX) = 0
.head 5 -  Set dfDATX = SalDateCurrent()
.head 4 +  Else
.head 5 -  Set dfDATX = SalStrToDate(sDATX)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('S6_UF_MFOOUT')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(mfo)
   INTO   :dfFILIAL
   FROM   S6_UF_MFOOUT
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDATX, sDATX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DATX', sDATX, '')
.head 1 +  Dialog Box: dlg_ImportFNadra
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Миграция "НАДРА" (ф)  -->  "АБС Барс-98"
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.063"
.head 4 -  Top:    0.208"
.head 4 -  Width:  16.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.107"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Импорт данных НАДРА (филиал) --> "АБС БАРС"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнение действия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    6.798"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblQueryContext(tbl1)
.head 6 +  If SalTblQueryRowFlags(tbl1, nRow, ROW_Selected)
.head 7 -  Call Import(tbl1.colACTION, tbl1.colPROC, nRow)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.464"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbLookErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр ошибок
.head 4 -  Window Location and Size
.head 5 -  Left:   0.033"
.head 5 -  Top:    7.131"
.head 5 -  Width:  3.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colErr > 0
.head 7 -  Call LookErr(tbl1.colDatBeg, tbl1.colDatEnd, tbl1.colErrMask)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  16.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Процедура (SQL)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDone
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Выполнено
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: К-во
ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErrMask
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Маска ошибок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatBeg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
начала
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatEnd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата и время
окончания
выполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.786"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm:ss
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalTblPopulate(tbl1, hSql(), '
     SELECT action,procname,errmask
     INTO   :tbl1.colACTION,:tbl1.colPROC,:tbl1.colErrMask
     FROM   P_MIGRANADF
     ORDER BY ordnung', TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalTblSetContext(tbl1, TBL_MinRow)
.head 6 -  Call SalTblSetFocusRow(tbl1, TBL_MinRow)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbLookErr, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbWin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WIN
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    6.881"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOS
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.131"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUkg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: UKG
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    7.381"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Кодировка
.head 4 -  Resource Id: 59465
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    7.155"
.head 5 -  Width:  1.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 59466
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Каталог DBF-файлов Nadra
.head 4 -  Resource Id: 59467
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    6.821"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 -  Background Text: Архив DBF-файлов Nadra
.head 4 -  Resource Id: 59468
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.367"
.head 5 -  Top:    7.286"
.head 5 -  Width:  3.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNadraF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.024"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNadraFarc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    7.488"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 59469
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    6.75"
.head 5 -  Width:  4.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код филиала (МФО)
.head 4 -  Resource Id: 59470
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.55"
.head 5 -  Top:    6.857"
.head 5 -  Width:  2.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFILIAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    6.833"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.35"
.head 6 -  Top:    7.119"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата перевода филиала
.head 4 -  Resource Id: 59471
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.15"
.head 5 -  Top:    7.143"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 59472
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  9.117"
.head 5 -  Begin Y:  6.857"
.head 5 -  End X:  9.117"
.head 5 -  End Y:  7.643"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Gray
.head 2 +  Functions
.head 3 +  Function: LookErr
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dBeg
.head 5 -  Date/Time: dEnd
.head 5 -  String: sErrMask
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog(dlg_LookErr, hWndForm, dBeg, dEnd, sErrMask)
.head 3 +  Function: Import
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sACTION
.head 5 -  String: sPROC
.head 5 -  Number: nRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 5 -  Number: nErr
.head 5 -  Number: nA
.head 5 -  Number: nE
.head 5 -  String: sCommand
.head 5 -  Number: nFetchRes
.head 5 -  String: sKodirowka
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Set tbl1.colDone = NUMBER_Null
.head 5 -  Set tbl1.colErr = NUMBER_Null
.head 5 -  Set tbl1.colDatBeg = DATETIME_Null
.head 5 -  Set tbl1.colDatEnd = DATETIME_Null
.head 5 -  Call SalUpdateWindow(tbl1)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO   :tbl1.colDatBeg
   FROM   dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatBeg = SalDateCurrent()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 5 +  If tbl1.colPROC and Left(tbl1.colPROC, 9) != 'NADFTABLE'
.head 6 +  If dfFILIAL != STRING_Null
.head 7 -  ! выполнение процедуры
.head 7 -  Call SalInvalidateWindow(tbl1)
.head 7 -  Set nNum = 0
.head 7 -  Set nErr = 0
.head 7 -  Set sCommand = tbl1.colPROC || '(dfFILIAL,nNum,nErr,dfDATX)'
.head 7 -  ! Set sCommand = tbl1.colPROC || '(nNum,nErr)'
.head 7 +  If SqlPLSQLCommand(hSql(), sCommand)
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colDone = nNum
.head 8 -  Set tbl1.colErr = nErr
.head 7 +  Else
.head 8 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 8 -  Call SalTblSetContext(tbl1, nRow)
.head 8 -  Set tbl1.colErr = 1
.head 8 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - невозможно выполнить процедуру ' || tbl1.colPROC)
.head 6 +  Else
.head 7 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colErr = 1
.head 7 -  Call SaveErrorToLog(tbl1.colErrMask || ': Ошибка - не задан Код филиала (МФО)')
.head 5 +  Else
.head 6 +  If tbl1.colPROC = 'NADFTABLE'
.head 7 -  ! загрузка DBF-файлов NadraF
.head 7 -  !
.head 7 -  Set tbl1.colDone = 0
.head 7 -  Set tbl1.colErr = 0
.head 7 -  Set nA = 0
.head 7 -  Set nE = 0
.head 7 -  !
.head 7 +  If rbWin
.head 8 -  Set sKodirowka = 'WIN'
.head 7 +  If rbDos
.head 8 -  Set sKodirowka = 'DOS'
.head 7 +  If rbUkg
.head 8 -  Set sKodirowka = 'UKG'
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\MFOOUT.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'MFOOUT.DBF',
             'S6_NF_MFOOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\MFOOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\MFOOUT.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\MFOOUT.dbf', sNadraFArcDir || '\\MFOOUT.dbf')
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(mfo)
   INTO   :dfFILIAL
   FROM   S6_NF_MFOOUT
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dfFILIAL = STRING_Null
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error MFOOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\MFOOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error MFOOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\USERS.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'USERS.DBF',
             'S6_NF_USERS',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\USERS.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\USERS.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\USERS.dbf', sNadraFArcDir || '\\USERS.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(3): Load error USERS.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\USERS.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(4): Load error USERS.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\CLIOUT.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'CLIOUT.DBF',
             'S6_NF_CLIOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\CLIOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\CLIOUT.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\CLIOUT.dbf', sNadraFArcDir || '\\CLIOUT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(5): Load error CLIOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\CLIOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(6): Load error CLIOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\ALCOUT.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'ALCOUT.DBF',
             'S6_NF_ALCOUT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\ALCOUT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\ALCOUT.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\ALCOUT.dbf', sNadraFArcDir || '\\ALCOUT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(7): Load error ALCOUT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\ALCOUT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(8): Load error ALCOUT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sNadraFDir || '\\ALNLSN.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'ALNLSN.DBF',
             'S6_NF_ALNLSN',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\ALNLSN.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\ALNLSN.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\ALNLSN.dbf', sNadraFArcDir || '\\ALNLSN.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(9): Load error ALNLSN.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 +  If not File(sNadraFArcDir || '\\ALNLSN.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(10): Load error ALNLSN.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  ! Здесь продолжить грузить дополнительные (справочные) таблицы
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\FILIAL.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'FILIAL.DBF',
             'S6_NF_FILIAL',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\FILIAL.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\FILIAL.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\FILIAL.dbf', sNadraFArcDir || '\\FILIAL.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(13): Load error FILIAL.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\FILIAL.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(14): Load error FILIAL.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sNadraFDir || '\\SHABLON.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'SHABLON.DBF',
             'S6_NF_SHABLON',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\SHABLON.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\SHABLON.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\SHABLON.dbf', sNadraFArcDir || '\\SHABLON.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(15): Load error SHABLON.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else 
.head 8 +  If not File(sNadraFArcDir || '\\SHABLON.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(16): Load error SHABLON.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\DEPO.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'DEPO.DBF',
             'S6_NF_DEPO',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\DEPO.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\DEPO.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\DEPO.dbf', sNadraFArcDir || '\\DEPO.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(17): Load error DEPO.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\DEPO.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(18): Load error DEPO.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  ! If File(sNadraFDir || '\\GROUP_C.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'GROUP_C.DBF',
             'S6_NF_GROUP_C',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\GROUP_C.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\GROUP_C.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\GROUP_C.dbf', sNadraFArcDir || '\\GROUP_C.dbf')
.head 8 +  Else 
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(19): Load error GROUP_C.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  ! Else
.head 8 +  If not File(sNadraFArcDir || '\\GROUP_C.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(20): Load error GROUP_C.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\TRANSIT.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'TRANSIT.DBF',
             'S6_NF_TRANSIT',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\TRANSIT.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\TRANSIT.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\TRANSIT.dbf', sNadraFArcDir || '\\TRANSIT.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(21): Load error TRANSIT.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\TRANSIT.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(22): Load error TRANSIT.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 +  If File(sNadraFDir || '\\MIGR_MC.DBF')
.head 8 +  If ImportDbf(sNadraFDir,
             'MIGR_MC.DBF',
             'S6_NF_MIGR_MC',
             sKodirowka,
             1,
             1,
             0,
             sErrMsg)
.head 9 -  Set nA = nA + 1
.head 9 -  Call VisFileSetAttribute(sNadraFArcDir || '\\MIGR_MC.dbf', FA_Standard, TRUE)
.head 9 -  Call VisFileDelete(sNadraFArcDir || '\\MIGR_MC.dbf')
.head 9 -  Call VisFileRename(sNadraFDir || '\\MIGR_MC.dbf', sNadraFArcDir || '\\MIGR_MC.dbf')
.head 8 +  Else
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(23): Load error MIGR_MC.DBF - ' || sErrMsg)
.head 9 -  Set nE = nE + 1
.head 7 +  Else
.head 8 +  If not File(sNadraFArcDir || '\\MIGR_MC.dbf')
.head 9 -  Call SaveErrorToLog(tbl1.colErrMask || '(24): Load error MIGR_MC.dbf - no file')
.head 9 -  Set nE = nE + 1
.head 7 -  !
.head 7 -  !
.head 7 -  Call SqlPLSQLCommand(hSql(), 'migraSK.copy_nadF_tables(dfFILIAL)')
.head 7 -  !
.head 7 -  Set tbl1.colDone = nA
.head 7 -  Set tbl1.colErr = nE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT sysdate
   INTO :tbl1.colDatEnd
   FROM dual') and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 -  Set tbl1.colDatEnd = SalDateCurrent()
.head 5 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 5 -  Call SalTblSetContext(tbl1, nRow)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nCode
.head 3 -  String: sErr
.head 3 -  String: sNadraFDir
.head 3 -  String: sNadraFArcDir
.head 3 -  Number: nT
.head 3 -  String: sDATX
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! читаем INI-файл
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'NadraFPath', '', sNadraFDir, GetIniFileName())
.head 4 -  Set sNadraFDir = IifS(Right(sNadraFDir, 1)='\\', Left(sNadraFDir, Len(sNadraFDir)-1), sNadraFDir) ! каталог Nadra(ф)
.head 4 -  Set dfNadraF = sNadraFDir
.head 4 -  Call SalGetProfileString('Import', 'NadraFArcPath', '', sNadraFArcDir, GetIniFileName())
.head 4 -  Set sNadraFArcDir = IifS(Right(sNadraFArcDir, 1)='\\', Left(sNadraFArcDir, Len(sNadraFArcDir)-1), sNadraFArcDir) ! архив
.head 4 -  Set dfNadraFarc = sNadraFArcDir
.head 4 -  !
.head 4 -  Set rbWin = 1
.head 4 -  Set rbDos = 0
.head 4 -  Set rbUkg = 0
.head 4 -  ! Set dfDATX = SalDateCurrent()
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('MigrDate', 'DATX', '', sDATX, '')
.head 4 +  If Len(sDATX) = 0
.head 5 -  Set dfDATX = SalDateCurrent()
.head 4 +  Else
.head 5 -  Set dfDATX = SalStrToDate(sDATX)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT f_tableexists('S6_NF_MFOOUT')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nT = 1
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT to_char(mfo)
   INTO   :dfFILIAL
   FROM   S6_NF_MFOOUT
   WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalDateToStr(dfDATX, sDATX)
.head 4 -  Call SalSetProfileString('MigrDate', 'DATX', sDATX, '')
.head 1 +  Dialog Box: dlg_DBFImportDir
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт DBF файлов из директории
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.44"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilesDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.488"
.head 6 -  Width:  7.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.883"
.head 5 -  Top:    0.4"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog(dlg_DirSelect, hWndForm, GetPrnDir(), sFilePath)
.head 6 -  Set dfFilesDir = sFilePath
.head 3 -  Background Text: Каталог для импорта DBF файлов
.head 4 -  Resource Id: 18306
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.202"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.883"
.head 5 -  Top:    5.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set sEncode = cmbSrcEncode.GetKey(SalListQuerySelection(cmbSrcEncode))
.head 6 -  !
.head 6 -  !
.head 6 -  Call SalTblReset(tblLog)
.head 6 +  If rbTabRecreate
.head 7 -  Set nTabCreateMode = IMP_TAB_RECR
.head 6 +  If rbTabNewTabName
.head 7 -  Set nTabCreateMode = IMP_TAB_NEWTIME
.head 6 +  If rbTabIgnore
.head 7 -  Set nTabCreateMode = IMP_TAB_IGNOREFILE
.head 6 +  If rbTabAdd
.head 7 -  Set nTabCreateMode = IMP_TAB_ADD
.head 6 -  !
.head 6 +  If rbByMemory
.head 7 -  Set nImportBy = IMP_BY_MEMORY 
.head 6 +  Else
.head 7 -  Set nImportBy = IMP_BY_TMPTAB
.head 6 -  !
.head 6 -  Set dtStartImpAll = SalDateCurrent()
.head 6 -  Set nFilesCnt = VisDosEnumFiles(dfFilesDir||'\\'||'*.DBF', FA_Archive, sFiles)
.head 6 +  If nFilesCnt > 0
.head 7 -  Set nFilesCnt = VisArraySort(sFiles, SORT_Descending, DT_String)
.head 7 -  !
.head 7 -  Set nRow=0
.head 7 -  !
.head 7 +  While nFilesCnt > 0
.head 8 -  Set nFilesCnt = nFilesCnt - 1
.head 8 -  Set dtStartImp = SalDateCurrent()
.head 8 -  Set sFileName = sFiles[nFilesCnt]
.head 8 -  Set sFilePath = dfFilesDir||'\\'||sFileName
.head 8 -  Set sTableName = SalStrUpperX(SalStrLeftX(sFileName, SalStrScan(sFileName,'.')))
.head 8 -  !
.head 8 -  Call SalTblInsertRow(tblLog, nRow)
.head 8 -  Call SalTblSetContext(tblLog, nRow)
.head 8 -  Call SalTblSetFocusRow(tblLog, nRow)
.head 8 -  Call SalTblSetRowFlags(tblLog, nRow, ROW_New, FALSE)
.head 8 -  Set tblLog.colFileName = sFileName
.head 8 -  Set tblLog.colTabName = sTableName
.head 8 -  Set tblLog.colSize = VisFileGetSize(sFilePath)
.head 8 -  Call SalUpdateWindow(hWndForm)
.head 8 -  !
.head 8 -  !
.head 8 +  If nTabCreateMode = IMP_TAB_IGNOREFILE
.head 9 +  If not IsTableExists(sTableName, nTabExists,sErrMsg) 
.head 10 -  Set tblLog.colErr = sErrMsg
.head 8 -  !
.head 8 -  !
.head 8 +  If nTabCreateMode = IMP_TAB_IGNOREFILE AND nTabExists = 1
.head 9 -  Set tblLog.colErr = 'Пропущен'
.head 8 +  Else
.head 9 +  If not ImportDbf(dfFilesDir, sFileName, sTableName, sEncode, nTabCreateMode, 1, nImportBy, sErrMsg)
.head 10 -  Set tblLog.colErr = sErrMsg
.head 9 +  Else
.head 10 -  Set tblLog.colErr = 'Выполнено'
.head 8 -  !
.head 8 -  !
.head 8 -  Set dtStopImp = SalDateCurrent()
.head 8 -  Set tblLog.colTime = GetTimeInterval(dtStartImp,dtStopImp)
.head 8 -  Set nRow = nRow+1
.head 8 -  Call SalUpdateWindow(hWndForm)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Set dtStopImpAll = SalDateCurrent()
.head 6 -  Set dfImportTime = GetTimeInterval(dtStartImpAll,dtStopImpAll)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    5.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm,0)
.head 3 +  Combo Box: cmbSrcEncode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    1.095"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call cmbSrcEncode.Init(hWndItem)
.head 6 -  Call SalListClear(hWndItem)
.head 6 -  Call cmbSrcEncode.Add('DOS', 'DOS - cp866')
.head 6 -  Call cmbSrcEncode.Add('UKG', 'UKG - укр.гост')
.head 6 -  Call cmbSrcEncode.Add('WIN', 'WIN - win1251')
.head 6 -  Call cmbSrcEncode.SetSelectById('DOS')
.head 3 -  Background Text: Общее время импорта:
.head 4 -  Resource Id: 18307
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    5.131"
.head 5 -  Width:  2.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfImportTime
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    5.15"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Процесс выполнения:
.head 4 -  Resource Id: 18308
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.464"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbTabRecreate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пересоздать таблицу
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.0"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTabRecreate = TRUE
.head 6 -  Set rbTabNewTabName = FALSE
.head 6 -  Set rbTabIgnore = FALSE
.head 6 -  Set rbTabAdd = FALSE
.head 6 -  Set nTabCreateMode = IMP_TAB_RECR
.head 3 +  Radio Button: rbTabNewTabName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Создать табл. с хвостом времени
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.262"
.head 5 -  Width:  3.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTabRecreate = FALSE
.head 6 -  Set rbTabIgnore = FALSE
.head 6 -  Set rbTabAdd = FALSE
.head 6 -  Set rbTabNewTabName = TRUE
.head 6 -  Set nTabCreateMode = IMP_TAB_NEWTIME
.head 3 +  Radio Button: rbTabIgnore
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пропустить файл, не импортить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.036"
.head 5 -  Width:  3.033"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTabRecreate = FALSE
.head 6 -  Set rbTabNewTabName = FALSE
.head 6 -  Set rbTabAdd = FALSE
.head 6 -  Set rbTabIgnore = TRUE
.head 6 -  Set nTabCreateMode = IMP_TAB_IGNOREFILE
.head 3 +  Radio Button: rbTabAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Импортить, добавляя данные
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.512"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTabRecreate = FALSE
.head 6 -  Set rbTabNewTabName = FALSE
.head 6 -  Set rbTabIgnore = FALSE
.head 6 -  Set rbTabAdd = TRUE
.head 6 -  Set nTabCreateMode = IMP_TAB_ADD
.head 3 +  Radio Button: rbTabDellData
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Удалить существующие данные
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.774"
.head 5 -  Width:  3.767"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbTabRecreate = FALSE
.head 6 -  Set rbTabDellData = TRUE
.head 6 -  Set rbTabNewTabName = FALSE
.head 6 -  Set rbTabIgnore = FALSE
.head 6 -  Set rbTabAdd = FALSE
.head 6 -  Set nTabCreateMode = IMP_TAB_DELDAT
.head 3 +  Child Table: tblLog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.655"
.head 6 -  Width:  8.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colFileName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Файл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSize
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Размер
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #########
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTabName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Таблица
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTime
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Время
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colErr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Статус
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  6.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_GrayedHeaders | TBL_Flag_SingleSelection, FALSE)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SuppressRowLines | TBL_Flag_SuppressLastColLine, TRUE)
.head 3 -  Frame
.head 4 -  Resource Id: 18309
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.021"
.head 5 -  Top:    2.405"
.head 5 -  Width:  8.61"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.012"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 18310
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    5.422"
.head 5 -  Width:  8.61"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Group Box: Если таблица c именем файла существует:
.head 4 -  Resource Id: 18311
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    0.821"
.head 5 -  Width:  4.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbByMemory
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: память
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    1.821"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbByTmpTable = FALSE
.head 6 -  Set rbByMemory = TRUE
.head 3 +  Radio Button: rbByTmpTable
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: времм. табл.
.head 4 -  Window Location and Size
.head 5 -  Left:   6.05"
.head 5 -  Top:    1.845"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set rbByTmpTable = TRUE
.head 6 -  Set rbByMemory = FALSE
.head 3 -  Group Box: Кодировка DBF файлов
.head 4 -  Resource Id: 18312
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    0.821"
.head 5 -  Width:  4.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Импорт через
.head 4 -  Resource Id: 18313
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    1.571"
.head 5 -  Width:  4.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 18314
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.017"
.head 5 -  Top:    0.071"
.head 5 -  Width:  8.61"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sFilters[0:2]
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  String: sEncode
.head 3 -  Date/Time: dtStartImp
.head 3 -  Date/Time: dtStopImp
.head 3 -  Date/Time: dtStartImpAll
.head 3 -  Date/Time: dtStopImpAll
.head 3 -  Number: nFilesCnt
.head 3 -  String: sFiles[*]
.head 3 -  String: sTableName
.head 3 -  String: sFilePath
.head 3 -  String: sFileName
.head 3 -  String: sErrMsg
.head 3 -  Number: nTabCreateMode
.head 3 -  Number: nTabExists
.head 3 -  Number: nRow
.head 3 -  Number: nImportBy
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sFilters[0] = 'DBF directory'
.head 4 -  Set sFilters[1] = '*'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  Set nRow  = 0
.head 4 -  ! Call SalTblInsertRow(tblLog, nRow)
.head 4 -  ! Call SalTblSetContext(tblLog, nRow)
.head 4 -  ! Call SalTblSetRowFlags(tblLog, nRow, ROW_New, FALSE)
.head 4 -  ! Set tblLog.colFileName = 'SSSSS'
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Table Window: frm_ImpXML
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ымопр
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  14.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.107"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPay
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call processDoc(OP_PAY)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ImpXML.pbPay')

.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call processDoc(OP_DELETE)
.head 6 +  On SAM_Create
.head 7 -  Set strTip =CurrentLangTable.GetAtomTitle('frm_ImpXML.pbDel')

.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.117"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32560
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.55"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.55"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 1803
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.317"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  4.317"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 12031
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.017"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  0.017"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbValidate
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.488"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call processDoc(OP_VALIDATE)
.head 6 +  On SAM_Create
.head 7 -  Set strTip =CurrentLangTable.GetAtomTitle('frm_ImpXML.pbValidate')

.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUnused
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.55"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32561
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.583"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.583"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.717"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32562
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.6"
.head 6 -  Begin Y:  1.321"
.head 6 -  End X:  0.6"
.head 6 -  End Y:  1.786"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Check Box: cbChooseForAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Помітка для всіх документів
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    0.12"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  Call SalTblSetContext(hWndForm,nRow)
.head 7 +  If cbChooseForAll = 0
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblSetRowFlags(hWndForm,nRow, ROW_Selected, FALSE)
.head 7 +  Else
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 9 -  Call SalTblSetRowFlags(hWndForm,nRow, ROW_Selected, TRUE)
.head 4 +  Data Field: dfCurrCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.15"
.head 7 -  Top:    0.11"
.head 7 -  Width:  0.733"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.24"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Док-тів (на суму):
.head 5 -  Resource Id: 12030
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.16"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfCurrSum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.85"
.head 7 -  Top:    0.11"
.head 7 -  Width:  1.533"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.24"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbEdit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbEdit
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =CurrentLangTable.GetAtomTitle('frm_ImpXML.pbEdit')
.head 6 +  On SAM_Click
.head 7 +  If frm_ImpXML.status != DOC_PAYED AND
   frm_ImpXML.status != DOC_DELETED
.head 8 -  Call SalCreateWindow(frm_ImpDoc, hWndForm, frm_ImpXML.impref, MODE_EDIT)
.head 2 +  Contents
.head 3 +  Column: mfoa
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО А
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: fio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исполнитель
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nlsa
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рах.А
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nama
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва платника
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.283"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ida
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЗКПО А
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: mfob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nlsb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рах.Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: idb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЗКПО Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: namb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва отримувача
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.3"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nazn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  3.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СКП
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № докум.
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: datd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата документа
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: impref
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: status
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: txtstatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.883"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
імпорту
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: fn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл
імпорту
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ref
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: errmsg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: changeCheckStatus
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 3 +  Function: processDoc
.head 4 -  Description: Выполнение операци над выбранными импортированными документами
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOperationCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPLCommand
.head 5 -  String: sErrCode
.head 5 -  Number: nCntAll
.head 5 -  Number: nCntBadProc ! Обработано с ошибками
.head 5 -  Number: nCntOkProc  ! Успешно обработано
.head 5 -  Number: nProcSumOk ! 
.head 5 -  Number: nProcSumBad  !
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  Select Case nOperationCode
.head 6 +  Case OP_DELETE
.head 7 -  Set sPLCommand = "delete_doc"
.head 7 -  Break
.head 6 +  Case OP_VALIDATE
.head 7 -  Set sPLCommand = "validate_doc"
.head 7 -  Break
.head 6 +  Case OP_PAY
.head 7 -  Set sPLCommand = "pay_doc"
.head 7 -  Break
.head 5 -  !
.head 5 -  Set nCntBadProc = 0
.head 5 -  Set nCntOkProc = 0
.head 5 -  Set sPLCommand = 'bars_xmlklb_imp.'||sPLCommand||'(frm_ImpXML.impref,sErrCode)'
.head 5 -  !
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  !
.head 6 +  If SqlPLSQLCommand(hSql(), sPLCommand)
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 6 +  If sErrCode != '0000'
.head 7 -  Set nCntBadProc = nCntBadProc + 1
.head 7 -  Set nProcSumBad = nProcSumBad + frm_ImpXML.s
.head 6 +  Else
.head 7 -  Set nCntOkProc = nCntOkProc + 1
.head 7 -  Set nProcSumOk = nProcSumOk + frm_ImpXML.s
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 5 -  !
.head 5 +  If nOperationCode  = OP_PAY 
.head 6 +  If nCntBadProc = 0
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgProcAll')||PutLf()||PutLf()||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcCnt') ||' '||SalNumberToStrX(nCntOkProc,0)||', '||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcSum')||' '||SalNumberToStrX(nProcSumOk,2)
               
.head 6 +  Else
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgProcBad')||' '||PutLf()||PutLf()||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgProcPay') ||' '||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcCnt') ||' '||SalNumberToStrX(nCntOkProc,0)||', '||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcSum')||' '||SalNumberToStrX(nProcSumOk,2)||PutLf()||PutLf()||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgProcNPay') ||' '||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcCnt') ||' '||SalNumberToStrX(nCntBadProc,0)||', '||
              CurrentLangTable.GetAtomTitle('frm_ImpDoc.ProcSum')||' '||SalNumberToStrX(nProcSumBad,2)
               
.head 6 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgProc'), MB_Ok)
.head 5 -  Return VALIDATE_Cancel
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nOpenMode
.head 2 +  Window Variables
.head 3 -  String: sDeleteConstrSql 
.head 3 -  Number: nCheckedStatus
.head 3 -  Number: nCurrCount
.head 3 -  Number: nCurrSum
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set strPrintFileName = 'V_XMLIMPDOCS'
.head 4 -  Set strFilterTblName = 'V_XMLIMPDOCS'
.head 4 -  Set fFilterAtStart  = TRUE
.head 4 -  Set frm_ImpXML.nTabInstance = 1
.head 4 -  Set nCheckedStatus = DOC_ALL
.head 4 -  Set strSqlPopulate =
"select 
    FN, DAT, IMPREF, 
    MFOA, NLSA, ID_A, NAM_A, 
    MFOB, NLSB, ID_B, NAM_B, 
    S/100,  nazn, impref, status, txtstatus, ref, substr(errmsg,1,254), dk, fio 
 into
   :frm_ImpXML.fn,
   :frm_ImpXML.dat,
   :frm_ImpXML.impref,
   :frm_ImpXML.mfoa,
   :frm_ImpXML.nlsa,
   :frm_ImpXML.ida,
   :frm_ImpXML.nama,
   :frm_ImpXML.mfob,
   :frm_ImpXML.nlsb,
   :frm_ImpXML.idb,
   :frm_ImpXML.namb,
   :frm_ImpXML.s,
   :frm_ImpXML.nazn,
   :frm_ImpXML.impref,
   :frm_ImpXML.status,
   :frm_ImpXML.txtstatus,
   :frm_ImpXML.ref,
   :frm_ImpXML.errmsg,
   :frm_ImpXML.dk,
   :frm_ImpXML.fio  " 
.head 4 +  If nOpenMode = IMP_MODE_OWN 
.head 5 -  Set strSqlPopulate =strSqlPopulate ||
" from v_xmlimpdocs where userid = user_id order by status, s" 
.head 5 -  Call SalHideWindow(frm_ImpXML.fio)
.head 4 +  Else
.head 5 -  Set strSqlPopulate =strSqlPopulate ||
" from v_xmlimpdocs order by status, s " 
.head 4 -  !
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 4 -  Set sDeleteConstrSql = "delete from xml_impdocsw where impref = :frm_ImpXML.impref"
.head 4 -  ! !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_ImpXML.title'))
.head 3 -  On SAM_Destroy
.head 3 +  On SAM_DoubleClick
.head 4 +  If frm_ImpXML.status = DOC_PAYED
.head 5 -  Call DocView(hWndMDI, frm_ImpXML.ref, 2, 0, '')
.head 4 +  Else
.head 5 -  Call SalCreateWindow(frm_ImpDoc, hWndForm, frm_ImpXML.impref, MODE_VIEW)
.head 3 +  On SAM_FetchRowDone
.head 4 -  !
.head 4 +  If frm_ImpXML.status  =  DOC_NOVALID
.head 5 -  Call SalTblSetCellTextColor(frm_ImpXML.txtstatus, COLOR_Red, TRUE)
.head 4 +  If frm_ImpXML.status  =  DOC_DELETED
.head 5 -  Call SalTblSetCellTextColor(frm_ImpXML.txtstatus, COLOR_DarkGreen, TRUE)
.head 4 +  If frm_ImpXML.status  =  DOC_PAYED
.head 5 -  Call SalTblSetCellTextColor(frm_ImpXML.txtstatus, COLOR_Blue, TRUE)
.head 4 -  Set dfCurrCount = dfCurrCount+1
.head 4 -  Set dfCurrSum = dfCurrSum + frm_ImpXML.s
.head 4 -  ! SalTblSetCellTextColor
.head 3 +  On SAM_RowHeaderClick
.head 4 +  If frm_ImpXML.status = DOC_NOVALID
.head 5 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_LightGray)
.head 5 -  Call XSalTooltipShow(hWndForm, frm_ImpXML.errmsg)
.head 5 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On UM_Populate
.head 4 -  Set dfCurrCount = 0
.head 4 -  Set dfCurrSum = 0
.head 4 -  Call SalSendClassMessage(UM_Populate, wParam, lParam)
.head 3 +  On SAM_TblDoDetails
.head 4 +  If status = DOC_PAYED OR status = DOC_DELETED
.head 5 -  Call SalDisableWindow(pbEdit)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalDisableWindow(pbPay)
.head 5 -  Call SalDisableWindow(pbValidate)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbEdit)
.head 5 -  Call SalEnableWindow(pbDel)
.head 5 -  Call SalEnableWindow(pbPay)
.head 1 +  Form Window: frm_ImpDoc
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Документ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.025"
.head 4 -  Top:    0.813"
.head 4 -  Width:  11.417"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.893"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Default
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: None
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Просмотр атрибутов документа вместе с
дополнительной информацией.
.head 2 +  Named Menus
.head 3 +  Menu: menuDocs
.head 4 -  Resource Id: 50064
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Закр&ыть
.head 5 -  Resource Id: 50066
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.375"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbExit
.data CLASSPROPSSIZE
0000: 2900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001600 746162446F630974 6162445245430974
0020: 6162424953000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.067"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Закрыть документ'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ImpDoc.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  ! ctb_pbUpdate: pbSave
.head 5 +    Message Actions
.head 6 +    On SAM_Click
.head 7 -  Call SalSendMsg(dlg_TabViewModel.tblModel, UM_ObjActivate, 0, 0)
.head 6 +    On SAM_Create
.head 7 -    Set strTip = 'Сохранить изменения (F2)'
.head 4 +  ! Check Box: cbAlign
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Выровнять по данным
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  3.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +   Message Actions
.head 6 +   On SAM_Click
.head 7 -   Set bAlign = cbAlign
.head 4 +  Pushbutton: pbSave
.data CLASSPROPSSIZE
0000: 1400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000100 00000000
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.06"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Распечатать документ (F5)'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ImpDoc.pbSave') || ' (F5)'
.head 6 +  On SAM_Click
.head 7 +  If saveChanges(sErrMsg)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgOkUpdate'), '',  MB_Ok)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'),  MB_Ok|MB_IconStop)
.head 7 -  !
.head 7 +  If bOpenDopTab
.head 8 -  Call SalSendMsg(dlg_TabViewDop, UM_Populate,0,0)
.head 7 +  If bOpenBisTab
.head 8 -  Call SalSendMsg(dlg_TabViewBIS, UM_Populate,0,0)
.head 7 -  !
.head 7 -  !
.head 7 -  ! Call SalSendMsg(frm_ImpXML.pbRefresh, SAM_Click,0,0)
.head 7 -  ! Call SalDestroyWindow(hWndForm)
.head 4 -  Line
.head 5 -  Resource Id: 6948
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.0"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  2.0"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipDocHelp')||'
F12'
.head 6 +  On SAM_Click
.head 7 -  Set bTryChooseWithRef = TRUE
.head 7 -  Call SalSendMsg(hWndForm, UM_HotAccountList, 0, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.63"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If bOpenDopTab
.head 8 -  Call SalTblSetRowFlags(dlg_TabViewDop.tblDop, SalTblQueryContext(dlg_TabViewDop.tblDop), ROW_MarkDeleted, TRUE)
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.19"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If bOpenDopTab
.head 8 -  Call SalEnableWindow(pbHelp)
.head 8 -  Call SalSendMsg(dlg_TabViewDop, UM_Insert, 0,0)
.head 4 -  Line
.head 5 -  Resource Id: 55413
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.267"
.head 6 -  Begin Y:  0.202"
.head 6 -  End X:  2.267"
.head 6 -  End Y:  0.571"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162557365466F 6E74000700506172 656E740000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 0000546162546F70 4D617267696E0002
0040: 0030000054616246 6F726D5061676573 001F0009646C675F 5461625669657744
0060: 6F7009646C675F54 6162566965774249 5300005461624472 61775374796C6500
0080: 0B0057696E393553 74796C6500005461 6252696768744D61 7267696E00020030
00A0: 00005461624E616D 6573001600746162 446F630974616244 5245430974616242
00C0: 495300005461624C 6162656C73001900 26C4EEEAF3ECE5ED F209C4EEEF2ED0E5
00E0: EAE22E09C1C8D1FB 0000546162506167 65436F756E740002 0031000054616242
0100: 6F74746F6D4D6172 67696E0002003000 0054616243757272 656E740007007461
0120: 62446F6300005461 624C6566744D6172 67696E0002003000 00546162466F6E74
0140: 53697A6500020038 00005461624F7269 656E746174696F6E 000A00546162734F
0160: 6E546F7000000000 0000000000000000 0000000000000000 0000000000000000
0180: 0000
.enddata
.data CLASSPROPSSIZE
0000: 8201
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  !
.head 6 -  Call picTabs.SetLabel(0,CurrentLangTable.GetAtomTitle('frm_ImpDoc.cTabs0'), TRUE)
.head 6 -  Call picTabs.SetLabel(1,CurrentLangTable.GetAtomTitle('frm_ImpDoc.cTabs1'), TRUE)
.head 6 -  Call picTabs.SetLabel(2,CurrentLangTable.GetAtomTitle('frm_ImpDoc.cTabs2'), TRUE)
.head 6 -  !
.head 6 +  If NOT nBISCount
.head 7 -  Call picTabs.Delete(2, TRUE)
.head 6 -  Call picTabs.InitializeFormPages('0;' || SalNumberToStrX(nImpRef, 0) || ';' || SalNumberToStrX(nImpRef, 0) || ';' ||
     SalNumberToStrX(nImpRef, 0))
.head 3 -  !
.head 3 +  Data Field: tDocTitle
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.405"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: tDocDate
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.667"
.head 6 -  Width:  4.443"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: tValueDateTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.214"
.head 6 -  Top:    0.917"
.head 6 -  Width:  2.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfValueDate
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    0.845"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tDebetTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.6"
.head 6 -  Top:    0.917"
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: tSenderTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    1.25"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSenderOKPOTitle
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSenderOKPO
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.417"
.head 6 -  Top:    1.202"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgIdA = dfSenderOKPO
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NONE)
.head 3 +  Data Field: tAccATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.586"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tCcyATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSender
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    1.505"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.438"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NLSA)
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 -  Set nValidateResult = VALIDATE_OkClearFlag
.head 6 -  !
.head 6 -  ! если следующий фокус переходит в нажатие кнопки  pbHelp
.head 6 +  If isChooseToolKey(wParam)
.head 7 -  Return nValidateResult
.head 6 -  !
.head 6 -  !
.head 6 -  !
.head 6 -  ! если значение ввели сами руками, а не выбрали из справочника  - валидация нужна
.head 6 +  If lParam != CHOOSE_BY_REF 
.head 7 -  Set nDkChk  = IifN(nDk=1, 0, 1)
.head 7 -  Set nFli =  IifN(dfMfoA = dfMfoB, 0, 1)
.head 7 +  If not validateOurNLS(nDkChk,dfAccA,nCcyA,nFli,dfSenderOKPO,dfSender,sErrMsg)
.head 8 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 8 -  Set nValidateResult =  VALIDATE_Cancel
.head 6 -  !
.head 6 -  Set sChgNlsA = dfAccA
.head 6 -  Set sChgNamA = dfSender
.head 6 -  Set sChgIdA = dfSenderOKPO
.head 6 -  !
.head 6 -  Return nValidateResult
.head 6 -  !
.head 3 +  Data Field: dfCcyA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.438"
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NONE)
.head 3 +  Data Field: tBankATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.329"
.head 6 -  Top:    1.74"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tMfoATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.1"
.head 6 -  Top:    1.74"
.head 6 -  Width:  0.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSummATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.74"
.head 6 -  Width:  1.171"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    1.929"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMfoA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.917"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgMfoA = dfMfoA
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_MFOA)
.head 3 +  Data Field: dfSummA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.917"
.head 6 -  Width:  2.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set nChgS = SalStrToNumber(dfSummA) * SalNumberPower(10,nDigA)
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NONE)
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50067
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.155"
.head 5 -  Width:  7.971"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: tKreditTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.6"
.head 6 -  Top:    2.25"
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Инвертируем названия Дебет/Кредит в зависимости от nDk
.head 6 +  If nDk = 0 OR nDk = 2
.head 7 -  Call FunSwapLabelsName(tDebetTitle, tKreditTitle)
.head 7 -  ! Call FunSwapLabelsName(dfSender, dfReceiver)
.head 7 -  ! Call FunSwapLabelsName(dfAccA, dfAccB)
.head 7 -  ! Call FunSwapLabelsName(dfBankA, dfBankB)
.head 7 -  ! Call FunSwapLabelsName(dfMfoA, dfMfoB)
.head 7 -  ! Call FunSwapLabelsName(dfSenderOKPO, dfReceiverOKPO)
.head 7 +  ! If dfCcyA != dfCcyB AND (NOT SalIsNull(dfCcyA)) AND (NOT SalIsNull(dfCcyB))
.head 8 -  Call FunSwapLabelsName(dfCcyA, dfCcyB)
.head 7 +  ! If dfSummA != dfSummB AND (NOT SalIsNull(dfSummA)) AND (NOT SalIsNull(dfSummB)) AND SalStrToNumber(dfSummB) != 0
.head 8 -  Call FunSwapLabelsName(dfSummA, dfSummB)
.head 3 +  Data Field: tReceiverTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    2.552"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tReceiverOKPOTitle
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    2.548"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfReceiverOKPO
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.417"
.head 6 -  Top:    2.5"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgIdB = dfReceiverOKPO
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NONE)
.head 3 +  Data Field: tAccBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    2.552"
.head 6 -  Width:  1.586"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tCcyBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    2.552"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSKTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    2.286"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfReceiver
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    2.738"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgNamB = dfReceiver
.head 3 +  Data Field: dfAccB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    2.74"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If dfMfoB = GetBankMfo() and SqlPrepareAndExecute(hSql(), "
   SELECT acc
   INTO   :nAcc
   FROM   saldo
   WHERE  nls=:dfAccB and kv=:nCcyB") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call ShowTurnForAccount(nAcc, GetBankDateEx())
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgNlsB = dfAccB
.head 6 -  Set sChgNamB = dfReceiver
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NLSB)
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 -  Set nValidateResult = VALIDATE_OkClearFlag
.head 6 -  !
.head 6 -  ! если следующий фокус переходит в нажатие кнопки  pbHelp
.head 6 +  If isChooseToolKey(wParam)
.head 7 -  Return nValidateResult
.head 6 -  !
.head 6 -  ! если значение ввели сами руками, а не выбрали из справочника  - валидация нужна
.head 6 +  If lParam != CHOOSE_BY_REF 
.head 7 -  Set nValidateResult = validate_NLSMFO_B()
.head 7 -  ! межбанк - проверить на контрольн. разряд счета и МФО
.head 6 -  !
.head 6 -  Set sChgNlsB = dfAccB
.head 6 -  Set sChgNamB = dfReceiver
.head 6 -  Set sChgIdB = dfReceiverOKPO
.head 6 -  !
.head 6 -  Return nValidateResult
.head 6 -  !
.head 3 +  Data Field: dfCcyB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    2.74"
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.917"
.head 6 -  Top:    2.262"
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set nChgSK = dfSk
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_SK)
.head 3 +  Data Field: tBankBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    3.042"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tMfoBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    3.042"
.head 6 -  Width:  0.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSummBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    3.042"
.head 6 -  Width:  1.171"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    3.262"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMfoB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    3.219"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_MFOB)
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 -  Set nValidateResult = VALIDATE_OkClearFlag
.head 6 -  !
.head 6 -  ! если следующий фокус переходит в нажатие кнопки  pbHelp
.head 6 +  If isChooseToolKey(wParam)
.head 7 -  Return nValidateResult
.head 6 -  !
.head 6 -  ! если значение ввели сами руками, а не выбрали из справочника  - валидация нужна
.head 6 +  If lParam != CHOOSE_BY_REF 
.head 7 -  ! Return validate_NLSMFO_B()
.head 7 -  ! межбанк - проверить на контрольн. разряд счета и МФО
.head 7 +  If dfMfoB!=''
.head 8 +  If SqlPrepareAndExecute(hSql(), 'select mfo, nb into :dfMfoB, :dfBankB from banks where mfo = :dfMfoB and blk<>4')
.head 9 +  If SqlFetchNext(hSql(), nRow)
.head 10 -  Set nValidateResult = VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgNoMFO') || ' - ' || dfMfoB,
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 10 -  Set nValidateResult = VALIDATE_Cancel
.head 6 -  !
.head 6 -  ! Если внутрибанк - закрыть наим отправителя
.head 6 +  If dfMfoB = GetBankMfo()
.head 7 -  Call SalDisableWindow(dfReceiver)
.head 7 -  Call SalDisableWindow(dfReceiverOKPO)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfReceiver)
.head 7 -  Call SalEnableWindow(dfReceiverOKPO)
.head 6 -  !
.head 6 -  Set sChgMfoB = dfMfoB
.head 6 -  !
.head 6 -  Return VALIDATE_OkClearFlag
.head 6 -  !
.head 3 +  Data Field: dfSummB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    3.219"
.head 6 -  Width:  2.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50068
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.452"
.head 5 -  Width:  7.971"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50069
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    1.155"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.375"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Multiline Field: mlSummPr
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    3.563"
.head 6 -  Width:  10.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.396"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Data Field: tDetailsTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    3.917"
.head 6 -  Width:  3.443"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.177"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlDetails
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 240
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.083"
.head 6 -  Width:  10.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.542"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_FieldEdit
.head 6 -  Set sChgNazn = mlDetails
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_MFOA)
.head 3 -  !
.head 3 -  ! ВременнАя статистика по документу
.head 3 -  !
.head 3 -  ! Group Box: Основные
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.271"
.head 5 -  Top:    0.417"
.head 5 -  Width:  9.286"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.762"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Times New Roman
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: tPostedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.631"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPosted
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.607"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Group Box: Система электронных платежей
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.271"
.head 5 -  Top:    1.229"
.head 5 -  Width:  9.286"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.438"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Times New Roman
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 +  Picture: pic2
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    0.524"
.head 5 -  Width:  9.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Основные
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50070
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.44"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgGeneral
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    1.333"
.head 5 -  Width:  9.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Система электронных платежей
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50071
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.25"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.217"
.head 6 -  Top:    0.381"
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call setFocusedField(FLD_NONE)
.head 2 +  Functions
.head 3 +  Function: TabActivateFinish
.head 4 -  Description: Indicates that a tab has been activated.
This function is called after the child windows have been shown
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nTab = 0
.head 6 +  If nCcyA = nCcyB 
.head 7 -  Call picTabs.HideWindow(tCcyBTitle)
.head 7 -  Call picTabs.HideWindow(dfCcyB)
.head 7 -  Call picTabs.HideWindow(tSummBTitle)
.head 7 -  Call picTabs.HideWindow(dfSummB)
.head 7 +  If Not isNeedSK(dfAccA, dfAccB,nCcyA)
.head 8 -  Call SalHideWindow(tSKTitle)
.head 8 -  Call SalHideWindow(dfSk)
.head 6 -  Set bOpenDocTab = TRUE
.head 6 -  Set bOpenDopTab = FALSE
.head 6 -  Set bOpenBisTab = FALSE
.head 6 -  !
.head 6 -  Call SalDisableWindow(pbDel)
.head 6 -  Call SalDisableWindow(pbIns)
.head 5 +  If nTab = 1 ! Доп. реквизиты
.head 6 -  Set bOpenDopTab = TRUE
.head 6 -  Set bOpenDocTab = FALSE
.head 6 -  Set bOpenBisTab = FALSE
.head 6 -  Call SalEnableWindow(pbDel)
.head 6 -  Call SalEnableWindow(pbIns)
.head 5 +  If nTab = 2 ! БИСЫ
.head 6 -  Set bOpenBisTab = TRUE
.head 6 -  Set bOpenDopTab = FALSE
.head 6 -  Set bOpenDocTab = FALSE
.head 6 -  Call SalDisableWindow(pbDel)
.head 6 -  Call SalDisableWindow(pbIns)
.head 5 +  If OpenMode = MODE_VIEW
.head 6 -  Call disableAllButtons()
.head 3 +  Function: FunSwapLabelsName
.head 4 -  Description: Поменять названия ярлыкоа местами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWinA
.head 5 -  Window Handle: hWinB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strNameA
.head 5 -  String: strNameB
.head 4 +  Actions
.head 5 +  If hWinA = hWndNULL OR hWinB = hWndNULL
.head 6 -  Return FALSE
.head 5 -  Call SalGetWindowText(hWinA, strNameA, 250)
.head 5 -  Call SalGetWindowText(hWinB, strNameB, 250)
.head 5 -  !
.head 5 -  Call SalSetWindowText(hWinA, strNameB)
.head 5 -  Call SalSetWindowText(hWinB, strNameA)
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: setFocusedField
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nFieldCode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bFocusAccA = FALSE
.head 5 -  Set bFocusAccB = FALSE
.head 5 -  Set bFocusSK = FALSE
.head 5 -  Set bFocusMfoB = FALSE
.head 5 -  Set bFocusMfoA = FALSE
.head 5 -  !
.head 5 +  Select Case nFieldCode
.head 6 +  Case FLD_NLSA
.head 7 -  Set bFocusAccA = TRUE
.head 7 -  Break
.head 6 +  Case FLD_NLSB
.head 7 -  Set bFocusAccB = TRUE
.head 7 -  Break
.head 6 +  Case FLD_SK
.head 7 -  Set bFocusSK = TRUE
.head 7 -  Break
.head 6 +  Case FLD_MFOA
.head 7 -  Set bFocusMfoA = TRUE
.head 7 -  Break
.head 6 +  Case FLD_MFOB
.head 7 -  Set bFocusMfoB = TRUE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 5 +  If bFocusAccA OR bFocusAccB OR bFocusSK OR bFocusMfoA OR bFocusMfoB
.head 6 -  Call SalEnableWindow(pbHelp)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(pbHelp)
.head 3 +  Function: isNeedSK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNlsA
.head 5 -  String: sNlsB
.head 5 -  Number: nKv
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If (SalStrLeftX(sNlsA, 4) = '1001' OR SalStrLeftX(sNlsA, 4) = '1002' OR SalStrLeftX(sNlsA, 4) = '1003' OR
    SalStrLeftX(sNlsA, 4) = '1004' OR SalStrLeftX(sNlsB, 4) = '1001' OR SalStrLeftX(sNlsB, 4) = '1002' OR
    SalStrLeftX(sNlsB, 4) = '1003' OR SalStrLeftX(sNlsB, 4) = '1004') AND nKv = 980
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: isChooseToolKey
.head 4 -  Description: Если во время набоа в поле клацнули кнопку помощи или Выхода
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: wPramEdit 
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If wPramEdit = SalWindowHandleToNumber(pbHelp) OR wPramEdit = SalWindowHandleToNumber(pbExit)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: validateOurNLS
.head 4 -  Description: Проверка НАШЕГО счета на валидность. 
Если такой счте есть отдать наименование контрагента и его ОКПО 
.head 4 +  Returns
.head 5 -  Boolean: ! FALSE - ошибка выплния, TRUE - все нормально
.head 4 +  Parameters
.head 5 -  Number: nDk  !  0 - счет дебетуется, 1 - счет кредитуется
.head 5 -  String: nNls !  лицевой счет
.head 5 -  Number: nKv  !  валюта
.head 5 -  Number: nFli !  признак  0 - внутрибанк  1 - межбанк
.head 5 -  Receive String: sChooseOkpo
.head 5 -  Receive String: sChooseNmk
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNmk
.head 5 -  String: sNms
.head 5 -  Number: nFetchRes 
.head 4 +  Actions
.head 5 -  Set sTmp=IifS(nDk=0, 'D', 'K')
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute(hSql(), T("
   select substr(s.nms,1,38),substr(k.nmk,1,38),k.okpo
   into   :sNms,:sNmk,:sChooseOkpo
   from   saldo" || sTmp || " s, customer k, cust_acc a
   where  nls=:nNls and kv=:nKv and a.rnk=k.rnk and s.acc=a.acc and s.dazs IS NULL"))
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sChooseNmk = IifS(nFli=1, sNmk, sNms)
.head 7 -  !
.head 7 +  If NOT sChooseOkpo
.head 8 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgNoOkpoA')
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Set sErrMsg = IifS(nDk=0,'A', 'B')
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgNoNls' || sErrMsg) || ' ' || nNls || '(' ||
    SalNumberToStrX(nKv, 0) || ')'
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgNotExec')
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: validate_NLSMFO_B
.head 4 -  Description: Валидация связкки СЧЕТ-МФО стороны Б
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! внутрибанк - проверить свой счет
.head 5 +  If dfAccB!=''
.head 6 +  If dfMfoB = GetBankMfo()  AND dfMfoB = dfMfoA
.head 7 -  Set nDkChk  = IifN(nDk=1, 1, 0)
.head 7 -  Set nFli =  0
.head 7 +  If not validateOurNLS(nDkChk,dfAccB,nCcyB,nFli,dfReceiverOKPO,dfReceiver,sErrMsg)
.head 8 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  ! межбанк - проверить на контрольн. разряд счета и МФО
.head 6 +  Else
.head 7 +  If dfMfoB!=''
.head 8 -  Set sTmp = Vkrz2(dfMfoB, dfAccB)
.head 8 +  If dfAccB != sTmp
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgNoValidNls') || ' ' || sTmp,
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 5 -  Return VALIDATE_OkClearFlag
.head 3 +  Function: saveChanges
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAction
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand(hSql(), 
   "bars_xmlklb_imp.update_doc(
       nImpRef,
       sChgMfoA, 
       sChgNlsA,
       sChgIdA,
       sChgNamA,
       sChgMfoB, 
       sChgNlsB,
       sChgIdB,
       sChgNamB,
       sChgNazn,
       nChgS,
       nChgSK,
       nCcyA)")
.head 6 -  !
.head 6 -  !
.head 6 -  ! Изменение строк бис реквизитов
.head 6 +  If bOpenBisTab
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(dlg_TabViewBIS.tblBIS, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm,nRow)
.head 8 +  If not SqlPLSQLCommand(hSql(), 
   "bars_xmlklb_imp.update_docbis(nImpRef, dlg_TabViewBIS.tblBIS.colTag,  dlg_TabViewBIS.tblBIS.colNazn)")
.head 9 -  ! Ошибки при обновлении БИС строк
.head 9 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgErrUpdBis') 
.head 9 -  Return FALSE
.head 7 -  !
.head 6 -  !
.head 6 -  ! Изменение доп. реквизитов
.head 6 +  If bOpenDopTab
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(dlg_TabViewDop.tblDop, nRow, ROW_Edited|ROW_MarkDeleted|ROW_New, 0)
.head 8 -  Call SalTblSetContext(hWndForm,nRow)
.head 8 -  !
.head 8 +  If SalTblQueryRowFlags(dlg_TabViewDop.tblDop, nRow, ROW_Edited)
.head 9 -  Set nAction = 1
.head 9 -  ! Ошибки при обновлении доп.реквизитов
.head 9 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgErrUpdDop') 
.head 8 +  If SalTblQueryRowFlags(dlg_TabViewDop.tblDop, nRow, ROW_MarkDeleted)
.head 9 -  Set nAction = 0
.head 9 -  ! 'Помилка видалення доп. реквізиту'
.head 9 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgErrDelDop') 
.head 8 +  If SalTblQueryRowFlags(dlg_TabViewDop.tblDop, nRow, ROW_New)
.head 9 -  Set nAction = 2
.head 9 -  ! 'Помилка вставки доп. реквізитіу'
.head 9 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgErrInsDop') 
.head 8 +  If dlg_TabViewDop.tblDop.colTag != STRING_Null
.head 9 +  If not SqlPLSQLCommand(hSql(), 
   "bars_xmlklb_imp.update_docdrec(nImpRef, dlg_TabViewDop.tblDop.colTag,  dlg_TabViewDop.tblDop.colValue, nAction)")
.head 10 -  Set sErrMsg = sErrMsg||' '||dlg_TabViewDop.tblDop.colTag
.head 10 -  Return FALSE
.head 6 -  !
.head 6 -  !
.head 5 +  Else
.head 6 -  ! Помилка поновлення реквізитів документу'
.head 6 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_ImpDoc.msgErrUpdDoс') 
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 5 -  !
.head 5 -  !
.head 3 +  Function: disableAllButtons
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalDisableWindow(pbSave)
.head 5 -  Call SalDisableWindow(pbHelp)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalDisableWindow(pbIns)
.head 2 +  Window Parameters
.head 3 -  Number: nImpRef		! Идентификатор документа (Rec/Ref)
.head 3 -  Number: OpenMode        ! MODE_EDIT,  MODE_VIEW
.head 2 +  Window Variables
.head 3 -  : TDoc
.head 4 -  Class: cABSConnect
.head 3 -  ! cChildMenuEngine: cDocMenu
.head 3 -  !
.head 3 -  String: strWinTitle
.head 3 -  Window Handle: hTitle
.head 3 -  !
.head 3 -  String: strSqlFields
.head 3 -  String: strSqlBinds
.head 3 -  String: strSqlTblName
.head 3 -  String: strSqlMTblName
.head 3 -  String: strSqlPKName
.head 3 -  !
.head 3 -  Number: nIntRef
.head 3 -  Number: nSWRef
.head 3 -  Number: nDk
.head 3 -  Number: nSk
.head 3 -  Number: nCcyA
.head 3 -  Number: nCcyB
.head 3 -  String: nCcyAUnit
.head 3 -  String: nCcyBUnit
.head 3 -  String: strOkpoA
.head 3 -  String: strOkpoB
.head 3 -  Number: nVob
.head 3 -  String: strMonth
.head 3 -  String: strVob
.head 3 -  String: strFaceNum
.head 3 -  Date/Time: dtDocDate
.head 3 -  !
.head 3 -  ! Измененные значения
.head 3 -  String: sChgMfoA
.head 3 -  String: sChgNlsA
.head 3 -  String: sChgIdA
.head 3 -  String: sChgNamA
.head 3 -  String: sChgMfoB
.head 3 -  String: sChgNlsB
.head 3 -  String: sChgIdB
.head 3 -  String: sChgNamB
.head 3 -  String: sChgNazn
.head 3 -  Number: nChgS
.head 3 -  Number: nChgSK
.head 3 -  !
.head 3 -  Number: nKSCount
.head 3 -  Number: nBISCount
.head 3 -  Number: nDkChk
.head 3 -  Number: nlParam
.head 3 -  Number: nProcSumOk
.head 3 -  Number: nProcSumBad
.head 3 -  String: sErrMsg
.head 3 -  Boolean: bOpenBisTab
.head 3 -  !
.head 3 -  Number: nDigA
.head 3 -  Number: nDigB
.head 3 -  Number: nSummA
.head 3 -  Number: nSummB
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nAcc
.head 3 -  Number: nKv
.head 3 -  String: sNls
.head 3 -  String: sLcv
.head 3 -  String: sOkpo
.head 3 -  String: sNms
.head 3 -  String: sMfo
.head 3 -  String: sNb
.head 3 -  String: sTT
.head 3 -  String: str50
.head 3 -  String: sNmk
.head 3 -  Number: nFli
.head 3 -  Number: nRow
.head 3 -  Number: nValidateResult
.head 3 -  Number: nChangedBisCnt
.head 3 -  !
.head 3 -  String: sSQL
.head 3 -  !
.head 3 -  Boolean: bFocusAccA
.head 3 -  Boolean: bFocusAccB
.head 3 -  Boolean: bFocusSK
.head 3 -  Boolean: bFocusMfoB
.head 3 -  Boolean: bFocusMfoA
.head 3 -  Boolean: bTryChooseWithRef 
.head 3 -  Boolean: bOpenDopTab
.head 3 -  Boolean: bOpenDocTab
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If OpenMode = MODE_VIEW
.head 5 -  Call SalDisableWindow(dfSenderOKPO)
.head 5 -  Call SalDisableWindow(dfAccA)
.head 5 -  Call SalDisableWindow(dfMfoA)
.head 5 -  !
.head 5 -  Call SalDisableWindow(dfReceiver)
.head 5 -  Call SalDisableWindow(dfReceiverOKPO)
.head 5 -  ! Call SalColorSet(dfReceiver, COLOR_IndexWindow, COLOR_3DFace)
.head 5 -  ! Call SalColorSet(dfReceiver, COLOR_IndexWindowText, COLOR_SysWindowText)
.head 5 -  !
.head 5 -  Call SalDisableWindow(dfAccB)
.head 5 -  Call SalDisableWindow(dfMfoB)
.head 5 -  !
.head 5 -  Call SalDisableWindow(dfSk)
.head 5 -  Call SalDisableWindow(dfCcyA)
.head 5 -  Call SalDisableWindow(dfSummA)
.head 5 -  Call SalDisableWindow(mlDetails)
.head 5 -  !
.head 5 -  !
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  ! Здесь не удалять! єто временно закомментировал MIK
.head 4 -  Call XConnectGetParams(TDoc)
.head 4 +  If NOT TDoc.Connect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('cTHEADER_Docs')||' реф.імпорту = '||SalNumberToStrX(nImpRef,0))
.head 4 -  !
.head 4 -  Set strSqlFields = ' mfoa, id_a,  nlsa, nam_a,
                     mfob, id_b,  nlsb, nam_b,
                     s, sk, s2, nd,
                     nazn,  
                     datd, vdat, dk, 
                     kv, kv2, vob, bis, tt'
.head 4 -  Set strSqlBinds  = ':dfMfoA, :dfSenderOKPO,  :dfAccA, :dfSender,
                    :dfMfoB,:dfReceiverOKPO, :dfAccB, :dfReceiver,
                    :nSummA, :dfSk, :nSummB, :strFaceNum, 
                    :mlDetails, 
                    :dtDocDate, :dfValueDate, 
                    :nDk, :nCcyA, :nCcyB, :nVob, :nBISCount, :sTT'
.head 4 -  Set strSqlPKName = 'impref'
.head 4 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Int')
.head 4 -  Set strSqlTblName = 'V_XMLIMPDOCS'
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(TDoc.hSql(), T(
'SELECT ' || strSqlFields  || '
   INTO ' || strSqlBinds   || '
   FROM ' || strSqlTblName || '
  WHERE ' || strSqlPKName  || '=:nImpRef'))
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  !
.head 4 -  ! Get Document type and number
.head 4 -  Call SqlPrepareAndExecute(TDoc.hSql(),'SELECT name INTO :strVob FROM vob WHERE vob=:nVob')
.head 4 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  Set tDocTitle = SalStrTrimX(SalStrUpperX(strVob))
.head 4 -  !
.head 4 -  ! Get document date in word
.head 4 -  Set tDocDate = CurrentLangTable.GetAtomTitle('tTimeFrom') || ' ' || SalNumberToStrX(SalDateDay(dtDocDate), 0) || ' ' ||
    GetMonthName(SalDateMonth(dtDocDate), TRUE) || ' ' || SalNumberToStrX(SalDateYear(dtDocDate), 0) || ' ' ||
    CurrentLangTable.GetAtomTitle('tYear')
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get banks names
.head 4 +  If dfMfoA != STRING_Null
.head 5 -  Call SqlPrepareAndExecute(TDoc.hSql(), '
     SELECT nb
     INTO   :dfBankA
     FROM   banks
     WHERE  mfo=:dfMfoA')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  If dfMfoB != STRING_Null
.head 5 -  Call SqlPrepareAndExecute(TDoc.hSql(), '
     SELECT nb
     INTO   :dfBankB
     FROM   banks
     WHERE  mfo=:dfMfoB')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get currency nams and units
.head 4 +  If nCcyA != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT lcv,unit,dig
   INTO   :dfCcyA,:nCcyAUnit,:nDigA
   FROM   tabval
   WHERE  kv=:nCcyA')
.head 6 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  If nCcyA != nCcyB 
.head 5 +  If nCcyB != NUMBER_Null
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT lcv,unit,dig
   INTO   :dfCcyB,:nCcyBUnit,:nDigB
   FROM   tabval
   WHERE  kv=:nCcyB')
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set dfCcyB = dfCcyA
.head 5 -  Set nCcyBUnit = nCcyAUnit
.head 5 -  Set nDigB  = nDigA
.head 5 -  Call picTabs.HideWindow(tCcyBTitle)
.head 5 -  Call picTabs.HideWindow(dfCcyB)
.head 5 -  Call picTabs.HideWindow(tSummBTitle)
.head 5 -  Call picTabs.HideWindow(dfSummB)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get summ by characters
.head 4 +  If nCcyA = GetBaseVal()
.head 5 -  Set mlSummPr = SumPr(nSummA,'F',CurrentLangTable.GetAtomTitle('tBaseCcy'),CurrentLangTable.GetAtomTitle('tBaseCcyUnit'))
.head 4 +  Else
.head 5 -  Set mlSummPr = SumPr(nSummA,'F',dfCcyA, nCcyAUnit||'.')
.head 4 -  ! проверка на 3 знака
.head 4 -  Set dfSummA = Dig4(nSummA/100, nDigA, nDigA)
.head 4 -  Set dfSummB = Dig4(nSummB/100, nDigB, nDigB)
.head 4 -  ! -------------------------------------------
.head 4 -  !
.head 4 +  If Not isNeedSK(dfAccA, dfAccB,nCcyA)
.head 5 -  Call SalHideWindow(tSKTitle)
.head 5 -  Call SalHideWindow(dfSk)
.head 4 -  !
.head 4 -  ! Если внутрибанк - закрыть наим отправителя
.head 4 +  If dfMfoB != GetBankMfo()  AND OpenMode = MODE_EDIT
.head 5 -  Call SalEnableWindow(dfReceiver)
.head 5 -  Call SalEnableWindow(dfReceiverOKPO)
.head 4 -  !
.head 4 -  !
.head 4 -  ! sChgMfoA, 
            sChgNlsA,
            sChgIdA,
            sChgNamA,
            sChgMfoB, 
            sChgNlsB,
            sChgIdB,
            sChgNamB
.head 4 -  Set sChgMfoA = dfMfoA
.head 4 -  Set sChgNlsA = dfAccA
.head 4 -  Set sChgIdA = dfSenderOKPO
.head 4 -  Set sChgNamA = dfSender
.head 4 -  !
.head 4 -  Set sChgMfoB = dfMfoB
.head 4 -  Set sChgIdB = dfReceiverOKPO
.head 4 -  Set sChgNlsB = dfAccB
.head 4 -  Set sChgNamB = dfReceiver
.head 4 -  !
.head 4 -  Set sChgNazn = mlDetails        
.head 4 -  Set nChgS = nSummA 
.head 4 -  Set nChgSK = dfSk
.head 4 -  Set bOpenDocTab = TRUE
.head 4 -  !
.head 4 -  Call SalSetFocus(hWndForm.frm_ImpDoc.picTabs)
.head 4 -  Call setFocusedField(FLD_NONE)
.head 3 +  On SAM_CreateComplete
.head 4 +  If OpenMode = MODE_VIEW
.head 5 -  Call disableAllButtons()
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg(frm_ImpXML.pbRefresh, SAM_Click,0,0)
.head 4 +  If TDoc.IsConnected()
.head 5 -  Call TDoc.Disconnect()
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 3 +  On UM_HotAccountList
.head 4 +  If OpenMode = MODE_EDIT
.head 5 +  If bOpenDocTab
.head 6 +  If bFocusAccA or bFocusAccB
.head 7 -  Set sLcv  = ''
.head 7 -  Set sOkpo = ''
.head 7 -  Set sNms  = ''
.head 7 -  Set sMfo  = ''
.head 7 -  Set sNb   = ''
.head 7 +  If bFocusAccA
.head 8 -  Set nKv=nCcyA
.head 8 -  Set sLcv=dfCcyA
.head 8 -  Set sNls=dfAccA||'*'
.head 8 +  If nDk = 0 
.head 9 -  Set nDkChk = 1
.head 8 +  Else
.head 9 -  Set nDkChk = 0
.head 7 +  Else
.head 8 -  Set nKv=nCcyA
.head 8 -  Set sLcv=dfCcyA
.head 8 -  Set sNls=dfAccB||'*'
.head 8 +  If nDk = 0 
.head 9 -  Set nDkChk = 0
.head 8 +  Else
.head 9 -  Set nDkChk = 1
.head 7 -  !
.head 7 -  !
.head 7 +  If (dfMfoA != dfMfoB and bFocusAccB)   ! В случае межбанка
.head 8 -  Set sMfo=dfMfoB
.head 8 +  If SalModalDialog(dlgAlien,hWndForm,1,nKv,sLcv,sNls,sOkpo,sNms,sMfo,sNb)
.head 9 -  Set dfAccB=sNls
.head 9 -  Set dfReceiver=sNms
.head 9 -  Set dfMfoB=sMfo
.head 9 -  Set dfBankB=sNb
.head 9 -  ! Set nKvB=nKv
.head 9 -  Set dfCcyB=sLcv
.head 9 -  Set dfReceiverOKPO=sOkpo
.head 7 +  Else
.head 8 +  If SalModalDialog(dlgClient, hWndForm, 0, sTT, nDkChk, 1, sNls, sNms, sNmk, nKv, sLcv, sOkpo, str50)
.head 9 +  If bFocusAccA      ! Поищем счет А
.head 10 -  Set dfAccA = sNls
.head 10 +  If dfMfoA != dfMfoB
.head 11 -  Set dfSender=SalStrLeftX(SalStrTrimX(sNmk),38)
.head 10 +  Else
.head 11 -  Set dfSender=SalStrLeftX(SalStrTrimX(sNms),38)
.head 10 -  Set nCcyA = nKv
.head 10 -  Set dfCcyA = sLcv
.head 10 -  Set dfSenderOKPO = sOkpo
.head 10 -  Call SalSendMsg(dfCcyA, SAM_Validate, 0, 0)
.head 9 +  Else ! Поищем счет B
.head 10 -  Set dfAccB = sNls
.head 10 -  Set dfReceiver = sNms
.head 10 -  Set nCcyB = nKv
.head 10 -  Set dfCcyB = sLcv
.head 10 -  Set dfReceiverOKPO = sOkpo
.head 10 -  Call SalSendMsg(dfCcyB, SAM_Validate, 0, 0)
.head 7 -  !
.head 7 -  ! Если всетаки что-то в справочнике выбрали
.head 7 -  !
.head 7 +  If sNls
.head 8 -  Set nlParam = CHOOSE_BY_REF
.head 7 +  Else
.head 8 -  Set nlParam = 0
.head 7 +  If bFocusAccA 
.head 8 -  Call SalSetFocus(dfAccA)
.head 8 -  Call SalSendMsg(dfAccA, SAM_Validate, 0, nlParam)
.head 7 +  Else If bFocusAccB
.head 8 -  Call SalSetFocus(dfAccB)
.head 8 -  Call SalSendMsg(dfAccB, SAM_Validate, 0, nlParam)
.head 6 +  If bFocusMfoB
.head 7 +  If not SalModalDialog(dlgMFO, hWndForm, sMfo,sNb)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set dfMfoB=sMfo
.head 8 -  Set dfBankB=sNb
.head 8 -  ! Call SalSetFieldEdit(dfBankB, TRUE)
.head 8 -  Call SalSendMsg(dfMfoB, SAM_Validate, 0, 0)
.head 8 -  Call SalSetFocus(dfBankB)
.head 6 +  If bFocusSK
.head 7 -  Set sSQL = 'select sk,name from sk where '
.head 7 +  If (nDk = 1 AND SalStrLeftX(dfAccA,3) = '100') OR (nDk = 0 AND SalStrLeftX(dfAccB,3) = '100')
.head 8 -  Set sSQL = sSQL || ' sk < 40 '
.head 7 +  Else
.head 8 -  Set sSQL = sSQL || ' sk >= 40 '
.head 7 -  Set sSQL = sSQL ||' and (d_close is null or d_close>gl.bd) order by sk'
.head 7 +  If not SalModalDialog(dlgTagBrowse, hWndForm, sSQL, sTmp)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set dfSk = SalStrToNumber(sTmp)
.head 8 -  Call SalSetFieldEdit(dfSk, TRUE)
.head 8 -  Call SalSendMsg(dfSk, SAM_FieldEdit, 0, 0)
.head 8 -  Call SalSetFocus(dfSk)
.head 5 +  If bOpenDopTab
.head 6 +  If FunNSIGet('V_XMLIMPDREC', 'NAME', sTag, sTagName)
.head 7 -  Set dlg_TabViewDop.tblDop.colTagName= sTagName
.head 7 -  Set dlg_TabViewDop.tblDop.colTag= sTag
.head 4 -  Else
.head 1 +  Dialog Box: dlg_ImpXmlFile
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.85"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.476"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 1796
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 1797
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    3.155"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFilePathName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.321"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.183"
.head 5 -  Top:    0.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dfImpStatus = ''
.head 6 -  Set dfFileDocSum = NUMBER_Null
.head 6 -  Set dfFileDocCnt = NUMBER_Null
.head 6 +  If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePath)
.head 7 -  Set sFilePathName = sFilePath
.head 7 -  Set sFileChoosePath =  SalStrLeftX(sFilePathName, SalStrScan(sFilePathName, sFileName)-1)
.head 7 -  Set dfFilePathName = sFilePathName
.head 3 -  Background Text: Файл для імпорту:
.head 4 -  Resource Id: 1798
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbRunImport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Імортувати
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    3.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! Call Debug('sFilePathName='||sFilePathName||', sFileName='||sFileName)
.head 6 -  Set nConvertErrCode = ImportFile(nImportType, sFilePathName, sFileName, sTmpFilePath, sImportConfigFile,
    sFileNameInPack, sErrMsg)
.head 6 +  If nConvertErrCode != 0 
.head 7 -  Call SalMessageBox('Помилки при імпорті: ' || sErrMsg, 'Увага!', MB_Ok | MB_IconAsterisk)
.head 7 -  Set dfImpStatus = 'Файл відбраковано'
.head 6 +  Else
.head 7 -  ! Call Debug('sFilePathName='||sFilePathName||', sFileBckpPath='||sFileBckpPath||'\\'||sFileName)
.head 7 -  Call VisFileRename(sFilePathName, sFileBckpPath||'\\'||sFileName)
.head 7 -  Set dfImpStatus = 'Файл проімпортовано'
.head 7 -  ! Call Debug('sFileNameInPack='||sFileNameInPack)
.head 7 -  Call GetImportResults(sFileNameInPack, GetBankDate(), dfFileDocCnt, dfFileDocSum)
.head 7 -  Set dfFileDocSum = dfFileDocSum/100
.head 7 -  Set nAnswer = SalMessageBox('Імпорт виконано успішно' || PutLf() || 'Кількість документів: ' ||
    SalNumberToStrX(dfFileDocCnt, 0) || ', cума файлу: ' || SalNumberToStrX(dfFileDocSum, 2) || PutLf() ||
    'Файл буде перенесено в архів ' || sFileBckpPath || '\\' || sFileName || PutLf() || PutLf() ||
    'Виконати сплату всіх проімпортованих докумнетів?', '', MB_OkCancel | MB_IconAsterisk)
.head 7 -  ! Оплатить все документы по данному файлу
.head 7 +  If nAnswer  = IDOK
.head 8 -  ! Call Debug(' Оплата: sFileNameInPack='||sFileNameInPack)
.head 8 +  If PayFileDocs(sFileName, GetBankDate(), nDocCnt, nDocSum, nDocBadCnt, nDocBadSum)
.head 9 +  If nDocBadCnt = 0
.head 10 -  Set dfDocsStatus = 'Всі документи сплачено'               
.head 10 -  Set dfDocOk = SalNumberToStrX(nDocCnt, 0) || ' (' || SalNumberToStrX(nDocSum/100, 2) || ')'
.head 9 +  Else
.head 10 -  Set dfDocsStatus = 'Не всі документи сплачено'               
.head 10 -  Set dfDocOk  = SalNumberToStrX(nDocCnt, 0) || ' (' || SalNumberToStrX(nDocSum/100, 2) || ')'
.head 10 -  Set dfDocBad = SalNumberToStrX(nDocBadCnt, 0) || ' (' || SalNumberToStrX(nDocBadSum/100, 2) || ')'
.head 8 +  Else
.head 9 -  Call SalMessageBox('Помилки при сплаті докмуентів', 'Увага', MB_Ok | MB_IconStop)
.head 7 -  !
.head 7 -  !
.head 7 -  !
.head 6 -  !
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    3.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Data Field: dfFileDocCnt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    1.17"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Результати імпорту файла:
.head 4 -  Resource Id: 1799
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    0.655"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Кількість документів
.head 4 -  Resource Id: 1800
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.225"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Загальна сума файлу
.head 4 -  Resource Id: 1801
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.45"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfVersion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    3.988"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFileDocSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    1.415"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Статус імпорту
.head 4 -  Resource Id: 1802
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.0"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfImpStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.92"
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Результати сплати докумнтів:
.head 4 -  Resource Id: 55409
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    1.821"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Статус сплати
.head 4 -  Resource Id: 55412
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.226"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDocsStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    2.14"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Успішно сплачених:
.head 4 -  Resource Id: 55411
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.47"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDocOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    2.393"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: НЕсплачених:
.head 4 -  Resource Id: 55410
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.69"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDocBad
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    2.643"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbEditFileDocs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.15"
.head 5 -  Top:    0.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EDIT.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 6 -  Call GeneralImpExp(hWndMDI,2, 0, '','')
.head 5 +  On SAM_Create
.head 6 -  Set strTip =CurrentLangTable.GetAtomTitle('dlg_ImpXmlFile.pbEditFileDocs')

.head 2 +  Functions
.head 3 +  Function: ImportFile
.head 4 -  Description: Сконвертировть их формат в наш и затянутьфайл в БД
.head 4 +  Returns
.head 5 -  Number: nErrCode            ! Код выполнения функции (=0 - успешно, =1 - с ошибками) 
.head 4 +  Parameters
.head 5 -  Number: nImpType            ! Тип импорта
.head 5 -  String: sFilePathName       ! Полный путь к имени файла для импорта
.head 5 -  String: sFileNameIn         ! Имя файла для импорта 
.head 5 -  String: sTmpFilePath        ! Путь для создания временного файла трансформации
.head 5 -  String: sParamFileName      ! Имя файла параметра, перекрывающего настройки по-умолчанию
.head 5 -  Receive String: sFileName   ! Имя файла из пакета
.head 5 -  Receive String: sErrMsg     ! Ошибки импорта 
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: iErrMessLen
.head 5 -  Number: iErrCode
.head 4 +  Actions
.head 5 -  !
.head 5 +  If SalStrLength(sBINPath)=0
.head 6 -  Call SalFileGetCurrentDirectory(sBINPath)
.head 5 -  !
.head 5 -  Set sTmpFilePath = sTmpFilePath||'\\out.xml'
.head 5 -  ! Конвертация из ихнего формата в наi XML
.head 5 -  Set iErrMessLen = 3072
.head 5 -  Call SalStrSetBufferLength(sErrMsg, iErrMessLen)
.head 5 -  !
.head 5 -  ! Call Debug('Временный файл: '||sTmpFilePath||', настроки: '||sBINPath||'\\'||sParamFileName)
.head 5 -  ! прямой импорт файла формата BARS XML в базу без преобразований
.head 5 +  If nImportType = 5
.head 6 -  Set sTmpFilePath = sFilePathName
.head 6 -  Set iErrCode = 0
.head 5 +  Else
.head 6 -  ! Set iErrCode = Convert(nImpType, 
                       sBINPath||'\\'||sParamFileName, 
                       sFilePathName, 
                       sTmpFilePath,  
                       sErrMsg, 
                       iErrMessLen) 
.head 6 -  Set iErrCode = Convert(nImpType, 
                       sParamFileName, 
                       sFilePathName, 
                       sTmpFilePath,  
                       sErrMsg, 
                       iErrMessLen) 
.head 5 -  ! загрузка output.xml файла во временную таблицу tmp_lob
.head 5 -  !
.head 5 -  ! Call Debug('Временный файл 2 '||sTmpFilePath)
.head 5 -  !
.head 5 +  If iErrCode = 0
.head 6 +  If PutFileToTmpLob(hSql(), sTmpFilePath, 'C')
.head 7 -  Set sFileName = sFileNameIn
.head 7 -  ! Call Debug('sFileName='||sFileName)
.head 7 -  ! Call Debug('sFileNameIn='||sFileNameIn)
.head 7 -  ! Call Debug('sFilePathName='||sFilePathName)
.head 7 +  If SqlPLSQLCommand(hSql(),"bars_xmlklb_imp.import_doc_cnt(sFileNameIn)")
.head 8 -  Call SqlCommit(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Set sErrMsg = 'Помилки при імпорті документів'
.head 8 -  Return 1
.head 6 +  Else
.head 7 -  Set sErrMsg = 'Неуспішна загрузка файла в БД'
.head 7 -  Return 1
.head 5 +  Else
.head 6 -  Return 1
.head 5 -  !
.head 3 +  Function: GetImportResults
.head 4 -  Description: Получить общее кол-во док-тов и их сумму при импорте
.head 4 +  Returns
.head 5 -  Boolean: bReuslt
.head 4 +  Parameters
.head 5 -  String: sFileName
.head 5 -  Date/Time: dtDate
.head 5 -  Receive Number: nDocCnt
.head 5 -  Receive Number: nDocSum
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPLSQLCommand(hSql(), "bars_xmlklb_imp.import_results(sFileName, dtDate, nDocCnt, nDocSum)")
.head 6 -  Return FALSE
.head 4 -  ! If ! file_import_results
.head 3 +  Function: PayFileDocs
.head 4 -  Description: Оплатить все документы по файлу. Как рез-т получить кол-во и сумму успешно и неуспешно оплаченных
.head 4 +  Returns
.head 5 -  Boolean: bReuslt
.head 4 +  Parameters
.head 5 -  String: sFileName
.head 5 -  Date/Time: dtDate
.head 5 -  Receive Number: nDocCnt
.head 5 -  Receive Number: nDocSum
.head 5 -  Receive Number: nDocBadCnt
.head 5 -  Receive Number: nDocBadSum
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_xmlklb_imp.pay_file_docs(sFileName, dtDate, nDocCnt, nDocSum, nDocBadCnt, nDocBadSum)")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Return TRUE
.head 4 -  ! If ! file_import_results
.head 2 +  Window Parameters
.head 3 -  Number: nImportType
.head 3 -  String: sImportConfigFile ! файл, который содержит параметры, которые перекрывают параметры по-умолчанию
наприме операция, символ касс.п плана и т.д.
.head 2 +  Window Variables
.head 3 -  !
.head 3 -  String: sFilters[2]
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  !
.head 3 -  String: sFileBckpPath    ! Имя бекап ди ретории для имортированных файлов
.head 3 -  String: sFilePath        ! Имя диретории для входящих файлов импорта
.head 3 -  String: sFileChoosePath  ! Имя выбранной диретории для импорта
.head 3 -  String: sFileName        ! Выбранное имя файла для импорта
.head 3 -  String: sFilePathName    ! Полный путь с именем выбраного файла
.head 3 -  String: sTmpFilePath     ! Директория временного файла преобразования
.head 3 -  String: sFileNameInPack  ! Имя файла, прописанное в пакете
.head 3 -  !
.head 3 -  Number: nConvertErrCode  ! Ошибка конвертации ихнего формата в наш
.head 3 -  Number: nAnswer  
.head 3 -  String: sErrMsg
.head 3 -  !
.head 3 -  Number: nDocCnt
.head 3 -  Number: nDocSum
.head 3 -  Number: nDocBadCnt
.head 3 -  Number: nDocBadSum
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set sFilters[0] = 'All files'
.head 4 -  Set sFilters[1] = '*.*'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  !
.head 4 -  ! Директория входгых файлоы для импорта
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString('Import', 'XMLDocPath', 'c:\\', sFilePath, '')
.head 4 -  !
.head 4 -  ! Директория для бекапа файлов импорта
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'XMLDocBckp', '', sFileBckpPath, GetIniFileName())
.head 4 -  !
.head 4 +  If sFileBckpPath = STRING_Null
.head 5 -  Call SalMessageBox('В файле ini не вказано параметр XMLDocBckp(секція [Import])-директорія для архіву файлів импорту!',
     'Увага', MB_Ok | MB_IconAsterisk)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  ! Проверка наличия директории бекапа
.head 5 -  Call SalFileCreateDirectory(sFileBckpPath)
.head 5 -  !
.head 5 +  If sFilePath = STRING_Null
.head 6 -  Set sFilePath = 'c:\\'
.head 5 -  !
.head 5 -  ! Временную диреторию установим в бекап диреторию
.head 5 -  Set sTmpFilePath = sFileBckpPath
.head 5 -  !
.head 5 +  If nImportType = G_IMPSBR_BARS
.head 6 -  Call SalSetWindowText(hWndForm,CurrentLangTable.GetAtomTitle('dlg_ImpXmlFile.titleImp5'))
.head 6 -  Set dfVersion = ''
.head 5 +  Else
.head 6 -  Call SalSetWindowText(hWndForm, getLoadDllDescription(nImportType))
.head 6 -  Set dfVersion = '(v.'||getLoadDllVersionCent(nImportType)||')  '||getLoadDllLibsConfig(nImportType)
.head 5 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 +  If sFileChoosePath = STRING_Null OR sFileChoosePath =''
.head 5 -  Set sFileChoosePath = sFilePath
.head 4 -  Call SalSetProfileString('Import', 'XMLDocPath', sFileChoosePath , '')
.head 1 +  Form Window: frmDoc
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1805
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 1806
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 1807
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 1808
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1809
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 1804
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlg_TabViewBIS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: БИСы
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.929"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список БИСов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.0"
.head 6 -  Width:  8.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №п.п.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 240
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  !
.head 5 +  On SAM_FetchRowDone
.head 6 +  ! If SalStrLength(SalStrTrimX(sTmp))=1
.head 7 -    Set s1ChrList=s1ChrList||SalStrTrimX(sTmp)
.head 6 -  If GetGlobalOptionEx('SEPNUM')=2
.head 6 +  Else
.head 7 -  Set colNazn = StrDosToWinX(colNazn)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  Number: nDRec
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: strSQL
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber(InParam[0])
.head 4 -  Set nDId   = SalStrToNumber(InParam[1])
.head 4 -  Set nDRef  = SalStrToNumber(InParam[2])
.head 4 -  Set nDRec  = SalStrToNumber(InParam[3])
.head 4 -  Call XConnectGetParams(TabC)
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  !
.head 4 -  ! anny - 26-04-2007 неправильно отображались бисы
.head 4 -  Set strSQL = T(
"SELECT value, substr(tag,2), tag 
 INTO :tblBIS.colNazn, :tblBIS.colId, :tblBIS.colTag
 FROM xml_impdocsw
 WHERE impref = :nDId and bars_xmlklb_imp.is_bistag(tag)=1
 ORDER BY substr(tag,2)")
.head 4 -  Call SalTblPopulate(hWndForm.dlg_TabViewBIS.tblBIS, TabC.hSql(), strSQL, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nTabXSize, nTabYSize)
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels(hWndForm, nTabXSize, FALSE) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels(hWndForm, nTabYSize, TRUE) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.dlg_TabViewBIS.tblBIS, SalPixelsToFormUnits(hWndForm, 3, FALSE),
     SalPixelsToFormUnits(hWndForm, 3, TRUE))
.head 4 -  Call SalSetWindowSize(hWndForm.dlg_TabViewBIS.tblBIS,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewBIS.tblBIS, nTabXSize, FALSE),
     SalPixelsToFormUnits(hWndForm.dlg_TabViewBIS.tblBIS, nTabYSize, TRUE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewBIS.tblBIS.colNazn,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewBIS.tblBIS.colNazn, nTabXSize-40, FALSE))
.head 4 -  ! Call SalTblSetColumnWidth(hWndForm.dlg_TabViewDop.tblDop.colValue,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop.colValue, (nTabXSize)*2/3-40, FALSE))
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 3 +  On UM_Populate
.head 4 -  Call SalTblPopulate(hWndForm.dlg_TabViewBIS.tblBIS, TabC.hSql(), strSQL, TBL_FillAll)
.head 1 +  Dialog Box: dlg_TabViewDop
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Дополнительные реквизиты документа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.929"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список доп.реквизитов документа (Закладка)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblDop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.0"
.head 6 -  Width:  8.757"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTagName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реквизит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If FunNSIGet('V_XMLIMPDREC', 'NAME', sTag, sTagName)
.head 9 -  Set colTagName= sTagName
.head 9 -  Set colTag= sTag
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.686"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_AnyEdit
.head 8 -  Set colValue = sTmp2
.head 8 -  ! Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  !
.head 2 +  Functions
.head 3 +  Function: GetFirstEditableColumn
.head 4 -  Description: Получить первую редактируюмую колонку
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCol
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 -  Set nCol=1
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol,
    COL_GetPos)
.head 6 +  If hWndCol = hWndNULL
.head 7 -  Break
.head 6 +  If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
   SalIsWindowVisible(hWndCol)
.head 7 -  Break
.head 6 -  Set nCol = nCol + 1
.head 5 -  Return hWndCol
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: strSQL
.head 3 -  String: strDRec
.head 3 -  String: strDRecTag
.head 3 -  String: strDRecVal
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 3 -  String: sTagName
.head 3 -  String: sTag
.head 3 -  Window Handle: hWnd
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 3
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber(InParam[0])
.head 4 -  Set nDId   = SalStrToNumber(InParam[1])
.head 4 -  Set nDRef  = SalStrToNumber(InParam[2])
.head 4 +  If nDRef
.head 5 -  Set strSQL = T(' select f.name, x.value, x.tag
                 into :tblDop.colTagName,  :tblDop.colValue, :tblDop.colTag
                 from xml_impdocsw x, v_xmlimpdrec f
                 where  x.impref = :nDRef and x.tag = f.tag(+) 
                        and bars_xmlklb_imp.is_bistag(x.tag)=0 ')
.head 4 -  Call XConnectGetParams(TabC)
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If nDRef
.head 5 -  Call SalTblPopulate(hWndForm.dlg_TabViewDop.tblDop, TabC.hSql(), strSQL, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nTabXSize, nTabYSize)
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels(hWndForm, nTabXSize, FALSE) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels(hWndForm, nTabYSize, TRUE) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.dlg_TabViewDop.tblDop, SalPixelsToFormUnits(hWndForm, 3, FALSE),
     SalPixelsToFormUnits(hWndForm, 3, TRUE))
.head 4 -  Call SalSetWindowSize(hWndForm.dlg_TabViewDop.tblDop,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop, nTabXSize, FALSE),
     SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop, nTabYSize, TRUE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewDop.tblDop.colTag,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop.colTag, (nTabXSize)/3, FALSE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewDop.tblDop.colValue,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop.colValue, (nTabXSize)*2/3-45, FALSE))
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 3 +  On UM_Insert
.head 4 +  If not SalTblAnyRows(tblDop, ROW_New, 0)
.head 5 -  Call SalTblDefineSplitWindow(tblDop, 3,  TBL_Split_Adjustable)
.head 4 -  Set nRow = SalTblInsertRow(tblDop, TBL_MinRow)
.head 4 -  Call SalTblSetContext(tblDop, nRow)
.head 4 -  Call SalTblSetFocusCell(tblDop, nRow, GetFirstEditableColumn(tblDop), 0, 1)
.head 3 +  On UM_Populate
.head 4 -  Call SalTblPopulate(hWndForm.dlg_TabViewDop.tblDop, TabC.hSql(), strSQL, TBL_FillAll)
.head 4 -  Call SalDisableWindow(frm_ImpDoc.pbHelp)
.head 1 +  Dialog Box: dlg_ImpSprMon  ! Імпорт довідника монет з Paradox
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Імпорт довіідника монет
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  6.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.583"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilePath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.383"
.head 5 -  Top:    0.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 7 -  Set dfFilePath=sFilePathName
.head 7 -  Set sTabName = SalStrUpperX(SalStrLeftX(sFileName, SalStrScan(sFileName,'.')))
.head 7 -  Set sFilePathName = SalStrLeftX(sFilePathName, SalStrScan(sFilePathName,sFileName))
.head 7 -  ! Set dfFilePath = SalStrLeftX(sFileName,SalStrScan(sFileName,'.'))
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.683"
.head 5 -  Top:    1.476"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  !
.head 6 -  Set dtStart = SalDateCurrent()
.head 6 -  !
.head 6 +  ! If not IsTableExists(dfTableName, nTableExists, sErrMsg)
.head 7 -  Call SalMessageBox(sErrMsg,'Внимание', MB_IconAsterisk)
.head 6 +  ! If nTableExists = 1  
.head 7 -  Set nAnswer = SalMessageBox('Таблица с таким именем уже существует, создать новую?','Внимание',  MB_OkCancel | MB_IconAsterisk)
.head 6 -  !
.head 6 -  !
.head 6 -  ! =0, через память,  = 1 через временн табл tmp_lob
.head 6 -  ! Set nImportType =  rbTransTmpTable
.head 6 -  !
.head 6 -  Set dtStart = SalDateCurrent()
.head 6 -  !
.head 6 +  If nTableExists = 0 or (nTableExists = 1 and nAnswer = IDOK)
.head 7 -  !
.head 7 -  !
.head 7 -  Set sFilePath = SalStrLeftX(sFilePathName, SalStrScan(sFilePathName, sFileName) - 1)
.head 7 +  ! If ImportDbf(sFilePath, 
             sFileName, 
             dlg_DBFImport.dfTableName, 
             sEncode, 
             IMP_TAB_RECR, 
             1,
             rbTransTmpTable, 
             sErrMsg)
.head 8 -  Call SalMessageBox('Импорт DBF файла выполнен!', 'Внимание', MB_Ok | MB_IconAsterisk)
.head 8 -  Call SqlCommitEx(hSql(),'Выполнен импорт данных файла '||sFilePath||'\\'||sFileName||' в таблицу '||dlg_DBFImport.dfTableName)
.head 7 +  ! Else
.head 8 -  Call SalMessageBox('Ошибка импорта файла: ' || sErrMsg, 'Внимание', MB_IconAsterisk)
.head 7 -  Set dtStop = SalDateCurrent()
.head 7 -  Set dfTime = GetTimeInterval(dtStart,dtStop)
.head 6 -  !
.head 6 -  !
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_Click
.head 6 -  Set dfRecN = 0
.head 6 +  If not VisDosExist(dfFilePath)
.head 7 -  Call SalMessageBox('Немає файла:' || dfFilePath, 'Увага', MB_IconStop)
.head 7 -  Return FALSE
.head 6 -  ! Call SalFileCopy(dfFilePath, 'C:\\'||sFileName, TRUE)
.head 6 -  Set sTabName = SalStrLeftX(sFileName,SalStrScan(sFileName,'.'))
.head 6 -  Set sFilePathName = SalStrLeftX(sFilePathName, SalStrLength(sFilePathName) - IifN(Right(sFilePathName, 1)='\\', 1, 0))
.head 6 +  If SalFileSetCurrentDirectory(sFilePathName)
.head 7 -  ! Call Debug(sFilePathName)
.head 7 -  ! Call Debug(sFileName)
.head 7 -  ! Call Debug(sTabName)
.head 7 -  Set SqlDatabase = 'Paradox'
.head 7 +  If SqlConnect(hSqlA)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'DELETE FROM spr_mon')
.head 8 -  ! Call SqlPrepareAndExecute(hSqlA, 'CREATE TABLE mik_paradox (n CHAR(10))')
.head 8 -  ! Set sTmp='SELECT Kod_money,  NameMoney,  NameMetal,
                 Nominal, Price, Pr_kupon, Pr_no
    INTO :sKod_money,  :sNameMoney, :sNameMetal,
         :nNominal,    :nPrice,     :nPr_kupon,  :nPr_no 
    FROM '||sTabName   
.head 8 -  Call SqlPrepareAndExecute(hSqlA, '
     SELECT Kod_money,NameMoney,NameMetal,Nominal,Price,Pr_kupon,Pr_no
     INTO   :sKod_money,:sNameMoney,:sNameMetal,:nNominal,:nPrice,:nPr_kupon,:nPr_no
     FROM   ' || sTabName)
.head 8 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO   spr_mon (Kod_money,NameMoney,NameMetal,Nominal,Price,Pr_kupon,Pr_no)
     VALUES (:sKod_money,:sNameMoney,:sNameMetal,:nNominal,:nPrice,:nPr_kupon,:nPr_no)')
.head 9 -  Set dfRecN = dfRecN + 1
.head 8 -  Call SqlDisconnect(hSqlA)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  ! !
.head 8 -  ! Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  Call SalMessageBox('Загружено ' || Str(dfRecN) || ' записів', 'Імпорт', MB_Ok | MB_IconExclamation)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    1.476"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm,0)
.head 3 -  Group Box:
.head 4 -  Resource Id: 5215
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.321"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Зап. №
.head 4 -  Resource Id: 5216
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.783"
.head 5 -  Top:    0.929"
.head 5 -  Width:  1.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRecN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.905"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Файл довідника монет
.head 4 -  Resource Id: 5217
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sFileName
.head 3 -  String: sFilePath
.head 3 -  String: sFilePathName
.head 3 -  String: sFileMEMOPathName
.head 3 -  String: sFilters[0:2]
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  Number: nImportType
.head 3 -  String: sEncode
.head 3 -  String: s
.head 3 -  String: sErrMsg
.head 3 -  Number: nTableExists
.head 3 -  Number: nAnswer
.head 3 -  String: sTmp
.head 3 -  String: sTabName
.head 3 -  !
.head 3 -  Sql Handle: hSqlA
.head 3 -  String: sKod_money
.head 3 -  String: sNameMoney
.head 3 -  String: sNameMetal
.head 3 -  Number: nNominal
.head 3 -  Number: nPrice
.head 3 -  Number: nPr_kupon
.head 3 -  Number: nPr_no
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sFilters[0] = 'DB files'
.head 4 -  Set sFilters[1] = '*.db'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  ! Set sFileName = 'spr_mon.db'
.head 4 -  ! Set sFilePathName = ''
.head 4 -  Set dfRecN = 0
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
