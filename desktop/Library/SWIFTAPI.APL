.head 0 +  Application Description: Bars98: Работа с  документами SWIFT
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000800000 002C000000020000 0003000000000000 0043020000FCFFFF
0040: FFE4FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001A713A 5C6261727339385C 62696E5C73776966 746170692E617064
0020: 18713A5C62617273 39385C62696E5C6E 65776170702E646C 6C18713A5C626172
0040: 7339385C62696E5C 6E65776170702E61 7063000001010115 433A5C43454E5455
0060: 52415C6E65776170 702E72756E15433A 5C43454E54555241 5C6E65776170702E
0080: 646C6C15433A5C43 454E545552415C6E 65776170702E6170 6300000101011A51
00A0: 3A5C424152533938 5C42494E5C535749 46544150492E4150 4418513A5C424152
00C0: 5339385C42494E5C 6E65776170702E64 6C6C18513A5C4241 525339385C42494E
00E0: 5C6E65776170702E 6170630000010101 15433A5C43454E54 5552415C6E657761
0100: 70702E61706C1543 3A5C43454E545552 415C6E6577617070 2E646C6C15433A5C
0120: 43454E545552415C 6E65776170702E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0218B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: DocWis3.apl
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Vtstr.apl
.head 2 -  ! !
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genctl.apl
.head 2 -  ! !
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Number: #00000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  Number: UM_Disable          = SAM_User + 110
.head 3 +  User
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 655220463
0000: 1E00000011000000 0000000000000000 020000010000004D 000000E003040000
0020: 00FF3F
.enddata
.head 2 +  Internal Functions
.head 3 +  Function: SwftDovv              ! __exported
.head 4 -  Description: Доввод / оплата принятых и отправленных SWIFT-сообщений
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalCreateWindow(frmDoc,hWndForm,nMod)
.head 3 +  Function: RunSwIORule                !__exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog (fwSwIORule, hWndForm)
.head 3 +  Function: RunSwFields                !__exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog (fwSwFields, hWndForm)
.head 3 +  Function: ShowSWIFTbanks                     ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: str1
.head 4 +  Actions
.head 5 -  Set str1 = ''
.head 5 -  Call SalModalDialog( dlg_SWIFTbanks, hWndForm, str1, 0x0017)
.head 3 +  Function: ShowSWIFTbanksForSelect            ! __exported
.head 4 -  Description: Браузер банков-членов SWIFT
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strBic
.head 4 +  Actions
.head 5 -  Set strBic = ''
.head 5 -  Call SalModalDialog( dlg_SWIFTbanks, hWndForm, strBic, 0x0288 )
.head 5 -  Return strBic
.head 3 +  Function: ShowSWIFTmessages                  ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalCreateWindow( dlg_SWIFTmessages, hWndMDI)
.head 3 +  Function: ShowSWIFTeditor                    ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: str0[50, 0:2, 1:2]
.head 4 +  Actions
.head 5 -  Call SalModalDialog( dlg_SWIFTEditor, hWndForm, NUMBER_Null, str0, 0, 0x000F)
.head 3 +  Function: GetNextOutSwRef                            ! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strValues[50, 0:2, 1:2]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nMaxRow
.head 5 -  String: strRef
.head 4 +  Actions
.head 5 -  ! Return "MT" || strValues[1,1,1] || "/01/" || strRef
.head 5 -  Set nMaxRow = SalStrToNumber(strValues[0,0,1])
.head 5 -  Set nRow = 1
.head 5 +  While nRow < nMaxRow
.head 6 +  If strValues[nRow,0,1] = "20"
.head 7 -  Set strRef = strValues[nRow,1,0]
.head 7 -  Break
.head 6 -  Call Inc(nRow)
.head 5 +  If strRef = ""
.head 6 -  Set strRef = "MT" || strValues[1,1,1] || "/01/ZZZZZ"
.head 5 -  Return strRef
.head 3 +  Function: PrintSwiftMsg              ! __exported
.head 4 -  Description: Печать SWIFT-сообщения
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nSwRef
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 33494326
0000: 4A010000C3000000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F11003C00 000F63006C734572
0040: 726F7243006F6E74 726F6C3800C00000 0200000083020400 0000FFFF04040000
0060: 010D0000FE00FF03 01801A0000000001 0000000463446F88 6338000002009E00
0080: 010DFD00FF270D00 0001F700FF1F0180 223000000002000A 006347656E46696C
00A0: 7400657274000000 04003D000204A300 0100007F80F00100 00006F0400EC010D
00C0: 00FF3F1100B90002 00FFFFE015000000 01FE00FF03
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cpbRelation
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  ! cDocW: frmDoc2  ! до того
.head 2 -    Description: 
.head 2 -    Named Menus 
.head 2 -    Menu 
.head 2 +    Tool Bar 
.head 3 +    Contents 
.head 4 +    Pushbutton: pbPayDoc
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbExit
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Call SalDisableWindow(hWndItem)
.head 4 +    Pushbutton: pbPrtDoc
.head 5 -    Message Actions 
.head 4 -    Line 
.head 4 -    Line 
.head 4 -    Line 
.head 4 +    Data Field: dfZn
.head 5 -    Message Actions 
.head 4 +    Data Field: dfOst
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbNewDoc
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbNewTTs
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set strTip = 'Переити к другому SWIFT сообщению'
.head 4 +    Pushbutton: pbHelp
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbSaveKor
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbDocBal
.head 5 -    Message Actions 
.head 4 -    Background Text: Остаток:
.head 4 +    Pushbutton: pbLocalD
.head 5 -    Message Actions 
.head 4 -    Line 
.head 2 +    Contents 
.head 3 +    Combo Box: cmbVob
.head 4 -    List Initialization 
.head 4 -    Message Actions 
.head 3 -    Background Text: №
.head 3 +    Data Field: dfNd
.head 4 -    Message Actions 
.head 3 -    Background Text: от
.head 3 +    Data Field: dfDocD
.head 4 -    Message Actions 
.head 3 +    Data Field: dfBankA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfKvA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNlsA
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Call frmDoc.UnHideIt( hWndItem )
.head 6 +    If frmDoc.sNlsA
.head 7 -    Set dfNlsA=frmDoc.sNlsA
.head 7 +    If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 +    If frmDoc.sTT='SWO'
.head 9 -    Call frmDoc.HideIt( hWndItem )
.head 3 +    Data Field: dfPlat
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNamA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfPlatB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNbA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfBankB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfPoluB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNbB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfKvB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNlsB
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Call frmDoc.UnHideIt( hWndItem )
.head 6 +    If frmDoc.sNlsB
.head 7 -    Set dfNlsB=frmDoc.sNlsB
.head 7 +    If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 +    If frmDoc.sTT='SWI'
.head 9 -    Call frmDoc.HideIt( hWndItem )
.head 3 +    Data Field: dfPolu
.head 4 -    Message Actions 
.head 3 +    Data Field: dfNamB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumNA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumA
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumNB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumB
.head 4 -    Message Actions 
.head 3 +    Data Field: dfRatN
.head 4 -    Message Actions 
.head 3 +    Data Field: dfRat
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumNC
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSumC
.head 4 -    Message Actions 
.head 3 +    Multiline Field: dfNazn
.head 4 -    Message Actions 
.head 3 +    Multiline Field: dfSwtMes
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Set dfNazn=''
.head 6 -    Set dfSwtMes='From: ' || sSndr ||','||SalNumberToChar(13)||SalNumberToChar(10)||
'To: '||sRcvr||SalNumberToChar(13)||SalNumberToChar(10)
.head 6 -    Call SqlPrepareAndExecute(hSql(),T(
"SELECT tag,opt,value INTO :sTag,:sOpt,:sValu
 FROM sw_operw WHERE swref=:nSwRef ORDER BY tag"))
.head 6 +    While SqlFetchNext(hSql(),nInd)
.head 7 -    Set sTmp=':'||sTag||sOpt||':'||VisStrSubstitute( sValu, SalNumberToChar(13)||SalNumberToChar(10),' ' )
.head 7 -    Set dfSwtMes=dfSwtMes||SalNumberToChar(13)||SalNumberToChar(10)||sTmp
.head 7 +    If sTag='70' or sTag='72'
.head 8 -    Set dfNazn=dfNazn||VisStrSubstitute( sValu, SalNumberToChar(13)||SalNumberToChar(10),' ' )||' '
.head 5 +    On SAM_Validate
.head 6 -    Return VALIDATE_Ok
.head 3 +    Data Field: dfSkN
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSk
.head 4 -    Message Actions 
.head 3 +    Data Field: dfValD
.head 4 -    Message Actions 
.head 3 +    Data Field: dfD
.head 4 -    Message Actions 
.head 3 +    Data Field: dfK
.head 4 -    Message Actions 
.head 3 -    Frame 
.head 3 -    Frame 
.head 3 +    Data Field: dfMTN
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Set dfMTN='SWIFT сообщение MT'||SalNumberToStrX(nMt,0)
.head 3 +    Data Field: dfValD1N
.head 4 -    Message Actions 
.head 3 +    Data Field: dfValD2N
.head 4 -    Message Actions 
.head 3 +    Data Field: dfValD2
.head 4 -    Message Actions 
.head 3 +    List Box: lb1
.head 4 -    List Initialization 
.head 4 -    Message Actions 
.head 3 -    Frame 
.head 2 +    Functions 
.head 3 +    Function: oDoc
.head 4 -    Description: Оплатить  документ с прибамбасами
.head 4 +    Returns 
.head 5 -    Boolean: 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 -    Local variables 
.head 4 +    Actions 
.head 5 +    If cDocW.oDoc()
.head 6 +    While TRUE
.head 7 +    If not SqlPrepareAndExecute(hSql(),
"UPDATE sw_journal SET date_pay=:frmDoc.m_dDatV1
 WHERE swref=:nSwRef")
.head 8 -    Break 
.head 7 +    If not SqlPrepareAndExecute(hSql(),
"INSERT INTO sw_oper (ref,swref)
 VALUES (:frmDoc.m_nRef,:nSwRef)")
.head 8 -    Break 
.head 7 -    Return TRUE
.head 5 -    Return FALSE
.head 2 +    Window Parameters 
.head 3 -    Number: nMod
.head 2 +    Window Variables 
.head 3 -    Number: nSwRef
.head 3 -    Number: nMt
.head 3 -    String: sTTf
.head 3 -    String: sSndr
.head 3 -    String: sRcvr
.head 3 -  !
.head 3 -    String: sTag
.head 3 -    String: sOpt
.head 3 -    String: sValu
.head 3 -  !
.head 3 -    String: sTmp
.head 3 -    Number: nInd
.head 2 +    Message Actions 
.head 3 +    On UM_Choose
.head 4 +    If nMod            ! 0 - Новые /  1- по исполнителю
.head 5 -    Set nInd=GetUserId()
.head 4 +    Else 
.head 5 -    Set nInd=0
.head 4 +    If not SalModalDialog( dlgSwtMsgJrn, hWndForm,nInd,nSwRef,nMt,sTTf,sLcv,nS,sSndr,sRcvr,sNlsA_TT,sNlsB_TT )
.head 5 -    Call SalDestroyWindow( hWndForm )
.head 5 -    Return TRUE
.head 4 -    Set bDocStart=TRUE
.head 4 -    Set sTT='SW'||sTTf
.head 4 -    Set nId=GetUserId()
.head 4 -    Call SqlPrepareAndExecute(hSql(),T("
SELECT t.name,t.flags[38,38],t.flags[10,10],t.flags[61,61],t.fli,t.flv,t.dk,t.sk
INTO :sTTN,:nFpy,:nFsk,:nFbk,:nFli,:nFlv,:nDk,:nSk  FROM tts t   WHERE t.tt=:sTT"))
.head 4 +    If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -    Call SalMessageBox( "Не описана операция "||sTT,DlgMSG_Error, MB_IconExclamation )
.head 5 -    Call SalDestroyWindow( hWndForm )
.head 4 -    Call SqlPrepareAndExecute(hSql(),T("SELECT kv,dig INTO :nKvA_TT,:nDigA FROM tabval WHERE lcv=:sLcv"))
.head 4 +    If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -    Call SalMessageBox( "Не найдена валюта "||sLcv,DlgMSG_Error, MB_IconExclamation )
.head 5 -    Call SalDestroyWindow( hWndForm )
.head 4 -    Set nKvB_TT=nKvA_TT
.head 4 -    Set nS=nS/SalNumberPower( 10, nDigA )
.head 4 -    Call SalSetWindowText( hWndForm, 'Ввод документа - [ ' ||sTTN|| ' ]' )
.head 4 +    If not nFsk
.head 5 -    Set nSk_TT=NUMBER_Null
.head 4 -    Call SalSendClassMessage( UM_Clear, 0, 0 )
.head 3 +    On UM_Insert
.head 4 -    Call SalSendClassMessage( UM_Insert, 0, 0 )
.head 4 -    Call SalDisableWindow(pbNewDoc)
.head 1 +  Form Window: frmDoc
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.071"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51767
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 51768
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 51769
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 51770
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Переити к другому SWIFT сообщению'
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 73
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51771
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 51762
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 51763
.head 4 -  Class Child Ref Key: 37
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call frmDoc.UnHideIt( hWndItem )
.head 6 +  If frmDoc.sNlsA
.head 7 -  Set dfNlsA=frmDoc.sNlsA
.head 7 +  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 +  If frmDoc.sTT='SWO'
.head 9 -  Call frmDoc.HideIt( hWndItem )
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call frmDoc.UnHideIt( hWndItem )
.head 6 +  If frmDoc.sNlsB
.head 7 -  Set dfNlsB=frmDoc.sNlsB
.head 7 +  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 +  If frmDoc.sTT='SWI'
.head 9 -  Call frmDoc.HideIt( hWndItem )
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfSwtMes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    4.06"
.head 6 -  Width:  7.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.927"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call frmDoc.UnHideIt( hWndItem )
.head 6 -  Set dfNazn=''
.head 6 -  Set dfSwtMes='From: ' || sSndr ||','||SalNumberToChar(13)||SalNumberToChar(10)||
'To: '||sRcvr||SalNumberToChar(13)||SalNumberToChar(10)
.head 6 -  Call SqlPrepareAndExecute(hSql(),T(
"SELECT tag,opt,value INTO :sTag,:sOpt,:sValu
 FROM sw_operw WHERE swref=:nSwRef ORDER BY tag"))
.head 6 +  While SqlFetchNext(hSql(),nInd)
.head 7 -  Set sTmp=':'||sTag||sOpt||':'||VisStrSubstitute( sValu, SalNumberToChar(13)||SalNumberToChar(10),' ' )
.head 7 -  Set dfSwtMes=dfSwtMes||SalNumberToChar(13)||SalNumberToChar(10)||sTmp
.head 7 +  If sTag='70' or sTag='72'
.head 8 -  Set dfNazn=dfNazn||VisStrSubstitute( sValu, SalNumberToChar(13)||SalNumberToChar(10),' ' )||' '
.head 5 +  On SAM_Validate
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfMTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    3.857"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfMTN='SWIFT сообщение MT'||SalNumberToStrX(nMt,0)
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.583"
.head 6 -  Top:    4.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    4.202"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    4.595"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 51764
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Frame
.head 4 -  Resource Id: 51765
.head 4 -  Class Child Ref Key: 45
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Frame
.head 4 -  Resource Id: 51766
.head 4 -  Class Child Ref Key: 88
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.286"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 116
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 134
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cDocW.oDoc()
.head 6 +  While TRUE
.head 7 +  If not SqlPrepareAndExecute(hSql(),
"UPDATE sw_journal SET date_pay=:frmDoc.m_dDatV1
 WHERE swref=:nSwRef")
.head 8 -  Break
.head 7 +  If not SqlPrepareAndExecute(hSql(),
"INSERT INTO sw_oper (ref,swref)
 VALUES (:frmDoc.m_nRef,:nSwRef)")
.head 8 -  Break
.head 7 -  Return TRUE
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Number: nMod
.head 2 +  Window Variables
.head 3 -  Number: nSwRef
.head 3 -  Number: nMt
.head 3 -  String: sTTf
.head 3 -  String: sSndr
.head 3 -  String: sRcvr
.head 3 -  !
.head 3 -  String: sTag
.head 3 -  String: sOpt
.head 3 -  String: sValu
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  Number: nInd
.head 2 +  Message Actions
.head 3 +  On UM_Choose
.head 4 +  If nMod            ! 0 - Новые /  1- по исполнителю
.head 5 -  Set nInd=GetUserId()
.head 4 +  Else
.head 5 -  Set nInd=0
.head 4 +  If not SalModalDialog( dlgSwtMsgJrn, hWndForm,nInd,nSwRef,nMt,sTTf,sLcv,nS,sSndr,sRcvr,sNlsA_TT,sNlsB_TT )
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Return TRUE
.head 4 -  Set bDocStart=TRUE
.head 4 -  Set sTT='SW'||sTTf
.head 4 -  Set nId=GetUserId()
.head 4 -  Call SqlPrepareAndExecute(hSql(),T("
SELECT t.name,t.flags[38,38],t.flags[10,10],t.flags[61,61],t.fli,t.flv,t.dk,t.sk
INTO :sTTN,:nFpy,:nFsk,:nFbk,:nFli,:nFlv,:nDk,:nSk  FROM tts t   WHERE t.tt=:sTT"))
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox( "Не описана операция "||sTT,'DlgMSG_Error', MB_IconExclamation )
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Call SqlPrepareAndExecute(hSql(),T("SELECT kv,dig INTO :nKvA_TT,:nDigA FROM tabval WHERE lcv=:sLcv"))
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox( "Не найдена валюта "||sLcv,'DlgMSG_Error', MB_IconExclamation )
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Set nKvB_TT=nKvA_TT
.head 4 -  Set nS=nS/SalNumberPower( 10, nDigA )
.head 4 -  Call SalSetWindowText( hWndForm, 'Ввод документа - [ ' ||sTTN|| ' ]' )
.head 4 +  If not nFsk
.head 5 -  Set nSk_TT=NUMBER_Null
.head 4 -  Call SalSendClassMessage( UM_Clear, 0, 0 )
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage( UM_Insert, 0, 0 )
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 3 +  On SAM_Destroy
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' SwftDovv(' || SalNumberToStrX(nMod,0) || ')' )
.head 1 +  Dialog Box: dlgSwtMsgJrn
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Журнал принятых/отправленных  SWIFT  сообщений
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.513"
.head 4 -  Top:    0.365"
.head 4 -  Width:  8.417"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.69"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48015
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48016
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Доввод/Оплата'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tbl, UM_DoubleClick, 0, 0 )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48017
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.0"
.head 6 -  Width:  7.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.702"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: cSwRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № п/п
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cIoInd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вх-
Исх
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.367"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cTrn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SWIFT
референция
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cSndr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отправитель
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cRcvr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Получатель
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cPayer
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Плательщик
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cPayee
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Получатель
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cCurr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cAmnt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cAccD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
Деб
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cAccK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
Кре
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cDatI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
поступл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cUser
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Исп.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.233"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SqlPrepareAndExecute( hSql(), 
 "SELECT s.id,s.fio INTO :nId,:sTmp FROM staff s,staff_tts t 
WHERE s.id=t.id AND substr(t.tt,1,2)='SW' ORDER BY 1" )
.head 8 -  Set nTmp=0
.head 8 -  Call SalArraySetUpperBound( mId,1,-1 )
.head 8 -  Call SalListClear( hWndItem )
.head 8 +  While SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalListAdd( hWndItem, sTmp )
.head 9 -  Set mId[nTmp] = nId
.head 9 -  Set nTmp=nTmp+1
.head 7 +  On SAM_Validate
.head 8 -  Set nId=SalListQuerySelection( hWndItem )
.head 8 +  If nId>=0
.head 9 -  Set cId = mId[nId]
.head 5 +  Column: cId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
исп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cDatO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
отправки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cDatR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
регистр
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cDatP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
оплаты
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nSwRef=cSwRef
.head 6 -  Set nMt=cMT
.head 6 -  Set sTTf=cIoInd
.head 6 -  Set sKv=cCurr
.head 6 -  Set nS=cAmnt
.head 6 -  Set sSndr=cSndr
.head 6 -  Set sRcvr=cRcvr
.head 6 +  If cAccD
.head 7 -  Call SqlPrepareAndExecute(hSql(),"SELECT nls INTO :sNlsA FROM accounts WHERE acc=:cAccD")
.head 7 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 6 +  Else
.head 7 -  Set sNlsA=STRING_Null
.head 6 +  If cAccK
.head 7 -  Call SqlPrepareAndExecute(hSql(),"SELECT nls INTO :sNlsB FROM accounts WHERE acc=:cAccK")
.head 7 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 6 +  Else
.head 7 -  Set sNlsB=STRING_Null
.head 6 -  Call SalSendClassMessage( SAM_DoubleClick, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set mlBody='From: ' || cSndr ||','||SalNumberToChar(13)||SalNumberToChar(10)||
'To: '||cRcvr||SalNumberToChar(13)||SalNumberToChar(10)
.head 6 -  Call SqlPrepareAndExecute(hSqlAux(),T(
"SELECT tag,opt,value INTO :sTag,:sOpt,:sValu 
 FROM sw_operw WHERE swref=:cSwRef ORDER BY tag"))
.head 6 +  While SqlFetchNext(hSqlAux(),nFetchRes)
.head 7 -  Set sTmp=':'||sTag||sOpt||':'||VisStrSubstitute( sValu, SalNumberToChar(13)||SalNumberToChar(10),' ' )
.head 7 -  Set mlBody=mlBody||SalNumberToChar(13)||SalNumberToChar(10)||sTmp
.head 3 +  Multiline Field: mlBody
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    2.976"
.head 6 -  Width:  7.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.69"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: SWIFT message
.head 4 -  Resource Id: 45822
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.217"
.head 5 -  Top:    2.762"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nIsp
.head 3 -  Receive Number: nSwRef
.head 3 -  Receive Number: nMt
.head 3 -  Receive String: sTTf
.head 3 -  Receive String: sKv
.head 3 -  Receive Number: nS
.head 3 -  Receive String: sSndr
.head 3 -  Receive String: sRcvr
.head 3 -  Receive String: sNlsA
.head 3 -  Receive String: sNlsB
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  String: strFileName
.head 3 -  Number: i
.head 3 -  Date/Time: dDatTmp
.head 3 -  String: sTmp
.head 3 -  String: sTag
.head 3 -  String: sOpt
.head 3 -  String: sValu
.head 3 -  String: sFilt
.head 3 -  Number: nId
.head 3 -  Number: mId[*]
.head 3 -  Number: nTmp
.head 3 -  Number: nBound
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If nIsp
.head 5 -  Set sFilt=' AND j.id=:dlgSwtMsgJrn.nIsp'
.head 4 +  Else
.head 5 -  Set sFilt=' AND j.id IS NULL'
.head 4 -  Set strSqlPopulate="
SELECT j.swref, j.mt, j.trn, j.sender, j.receiver, j.payer, j.payee, j.currency, j.amount, j.accd, j.acck,
j.io_ind, j.date_in, j.date_out, j.date_rec, j.date_pay, j.id, i.fio 
 INTO  :dlgSwtMsgJrn.tbl.cSwRef,  :dlgSwtMsgJrn.tbl.cMT,   :dlgSwtMsgJrn.tbl.cTrn,
       :dlgSwtMsgJrn.tbl.cSndr,   :dlgSwtMsgJrn.tbl.cRcvr,
       :dlgSwtMsgJrn.tbl.cPayer,  :dlgSwtMsgJrn.tbl.cPayee,
       :dlgSwtMsgJrn.tbl.cCurr,   :dlgSwtMsgJrn.tbl.cAmnt,
       :dlgSwtMsgJrn.tbl.cAccD,   :dlgSwtMsgJrn.tbl.cAccK, :dlgSwtMsgJrn.tbl.cIoInd,
       :dlgSwtMsgJrn.tbl.cDatI,   :dlgSwtMsgJrn.tbl.cDatO, 
       :dlgSwtMsgJrn.tbl.cDatR,   :dlgSwtMsgJrn.tbl.cDatP,
       :dlgSwtMsgJrn.tbl.cId,     :dlgSwtMsgJrn.tbl.cUser
 FROM sw_journal j, OUTER staff i  WHERE j.date_pay IS NULL  AND j.id=i.id (+) "||sFilt||" ORDER BY j.swref"
.head 4 -  Set strSqlUpdate="
UPDATE sw_journal SET id=:dlgSwtMsgJrn.tbl.cId
                                          WHERE swref=:dlgSwtMsgJrn.tbl.cSwRef"
.head 4 -  Call SqlPrepareAndExecute( hSql(), 
 "SELECT DISTINCT s.id,s.fio INTO :nId,:sTmp FROM staff s,staff_tts t 
   WHERE s.id=t.id AND substr(t.tt,1,2)='SW' ORDER BY 1" )
.head 4 -  ! Set dlgSwtMsgJrn.nFlags=GT_NoRet
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Print
.head 4 -  Set i=0
.head 4 +  Loop
.head 5 -  Set strFileName=GetPrnDir()||'\\'||'SWJOURNL.'||
SalFmtFormatNumber(i,'000')
.head 5 +  If SalFileGetDateTime(strFileName,dDatTmp)
.head 6 -  Set i=i+1
.head 6 +  If i>999
.head 7 -  Break
.head 5 +  Else
.head 6 -  Break
.head 4 -  Call TablePrint( tbl, 'Журнал SWIFT сообщений',strFileName,'')
.head 1 +  Dialog Box: fwSwIORule
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Управление импортом сообщений SWIFT
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.971"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Управление импортом SWIFT-сообщений
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 35205
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 35206
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 35207
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblIoRule
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  13.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: MT
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[0])
.head 7 +  On SAM_DoubleClick
.head 8 -  Set nInd = colMT
.head 8 -  Set colMT = NUMBER_Null
.head 8 +  If FunNSIGet  ('sw_mt', 'name', strPK, strSK)
.head 9 -  Set colMT = SalStrToNumber( strPK )
.head 9 -  Set colMsgType = strSK
.head 9 -  Call SalTblSetRowFlags (tblIoRule, SalTblQueryContext (tblIoRule), ROW_Edited, TRUE )
.head 8 +  Else
.head 9 -  Set colMT = nInd
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 -  Return VALIDATE_Ok
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(),
 "SELECT name INTO :colMsgType
    FROM sw_mt WHERE mt = :colMT")
.head 9 -  Set bOk = SqlFetchNext ( hSql(), nInd )
.head 9 +  If bOk
.head 10 -  Return VALIDATE_Ok
.head 9 +  Else
.head 10 -  Call SalMessageBox ( 'Недопустимый тип сообщения SWIFT!'
                    ,'Ошибка', MB_IconExclamation | MB_Ok )
.head 10 -  Return VALIDATE_Cancel
.head 7 +  On WM_KeyDown
.head 8 -  ! Нажали F3 ? => Double click
.head 8 +  If wParam = 114
.head 9 -  Call SalSendMsg( hWndItem, SAM_DoubleClick, 0, 0 )
.head 5 +  Column: colMsgType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип сообщения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.429"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIO_ind
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 'I' - начальные
'О' - ответные
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[1])
.head 7 +  On SAM_Validate
.head 8 +  If colIO_ind != 'I' AND colIO_ind != 'O'
.head 9 -  Call SalMessageBox ( "Задайте 'I' для начального потока
  или   'O' для ответного
(буквы латинские)!"
                    ,'Ошибка', MB_IconExclamation | MB_Ok )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPK
.head 5 -  String: strSK
.head 5 -  Boolean: bOk
.head 5 -  Number: nInd
.head 5 -  String: strTmp
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strMessage[*]
.head 3 -  Boolean: bOk
.head 2 +  Message Actions
.head 3 -  On UM_DoubleClick
.head 3 +  On SAM_Create
.head 4 -  Set strMessage[0] = "Введите тип сообщения (F3 - список)"
.head 4 -  Set strMessage[1] = "Задайте направление импорта"
.head 4 -  ! ----------- SQL-запросы на обработку данных
.head 4 -  Set strSqlPopulate = "SELECT sw_iorule.mt
      , sw_iorule.io_ind
      , sw_mt.name
      , sw_iorule.ROWID
 INTO   :tblIoRule.colMT
      , :tblIoRule.colIO_ind
      , :tblIoRule.colMsgType
      , :tblIoRule.colRowid
 FROM   sw_iorule
      , sw_mt
 WHERE sw_mt.mt = sw_iorule.mt
 ORDER BY 1,2"
.head 4 -  Set strSqlDelete = "DELETE FROM sw_iorule
    WHERE ROWID = :tblIoRule.colRowid"
.head 4 -  Set strSqlInsert = "INSERT INTO sw_iorule
                          (   mt
                            , io_ind )
          VALUES          (   :tblIoRule.colMT
                            , :tblIoRule.colIO_ind )"
.head 4 -  Set strSqlUpdate = "UPDATE sw_iorule
                      SET   mt       = :tblIoRule.colMT
                          , io_ind   = :tblIoRule.colIO_ind
                    WHERE ROWID = :tblIoRule.colRowid"
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_Destroy
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' RunSwIORule()  ')
.head 1 +  Dialog Box: fwSwFields
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Шаблоны анализа полей SWIFT при импорте
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.414"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Шаблоны анализа полей SWIFT-сообщений при импорте
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14922
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14923
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14924
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblSwFld
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  13.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код поля
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.029"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[0])
.head 7 +  On SAM_DoubleClick
.head 8 -  Set nInd = colTag
.head 8 -  Set colTag = NUMBER_Null
.head 8 +  If FunNSIGet  ('sw_tag', 'tag', strPK, strSK)
.head 9 -  Set colTag = SalStrToNumber( strPK )
.head 9 -  Call SalTblSetRowFlags (tblSwFld, SalTblQueryContext (tblSwFld), ROW_Edited, TRUE )
.head 8 +  Else
.head 9 -  Set colTag = nInd
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 -  Return VALIDATE_Ok
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(),
 "SELECT tag INTO :nInd
    FROM sw_tag WHERE tag = :colTag")
.head 9 -  Set bOk = SqlFetchNext ( hSql(), nInd )
.head 9 +  If bOk
.head 10 -  Return VALIDATE_Ok
.head 9 +  Else
.head 10 -  Call SalMessageBox ( 'Недопустимый тип поля SWIFT!'
                    ,'Ошибка', MB_IconExclamation | MB_Ok )
.head 10 -  Return VALIDATE_Cancel
.head 7 +  On WM_KeyDown
.head 8 -  ! Нажали F3 ? => Double click
.head 8 +  If wParam = 114
.head 9 -  Call SalSendMsg( hWndItem, SAM_DoubleClick, 0, 0 )
.head 5 +  Column: colTempl
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Шаблон
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.071"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[1])
.head 5 +  Column: colAccId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счета
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.329"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[2])
.head 5 +  Column: colIflag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: T - принимать
F - отвергать
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText (hWndForm, strMessage[3])
.head 7 +  On SAM_Validate
.head 8 +  If colIflag != 'F' AND colIflag != 'T'
.head 9 -  Call SalMessageBox ( "Задайте 'T' чтобы принимать сообщение
  или   'F' чтобы не принимать сообщение
(буквы латинские)!"
                    ,'Ошибка', MB_IconExclamation | MB_Ok )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPK
.head 5 -  String: strSK
.head 5 -  Boolean: bOk
.head 5 -  Number: nInd
.head 5 -  String: strTmp
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strMessage[*]
.head 3 -  Boolean: bOk
.head 3 -  Number: i
.head 3 -  String: strFileName
.head 3 -  Date/Time: dDatTmp
.head 2 +  Message Actions
.head 3 -  On UM_DoubleClick
.head 3 +  On SAM_Create
.head 4 -  Set strMessage[0] = "Введите тип поля (F3 - список)"
.head 4 -  Set strMessage[1] = "Задайте строку поиска(шаблон)"
.head 4 -  Set strMessage[2] = "Задайте идентификатор счета или '#FLD' для подстановки шаблона"
.head 4 -  Set strMessage[3] = "Задайте флаг импорта сообщения: 'T'-принять, 'F'-отвергнуть"
.head 4 -  ! ----------- SQL-запросы на обработку данных
.head 4 -  Set strSqlPopulate = "SELECT tag
      , templ
      , acc_id
      , i_flag
      , ROWID
 INTO   :tblSwFld.colTag
      , :tblSwFld.colTempl
      , :tblSwFld.colAccId
      , :tblSwFld.colIflag
      , :tblSwFld.colRowid
 FROM   sw_fld
 ORDER BY 1,2"
.head 4 -  Set strSqlDelete = "DELETE FROM sw_fld
    WHERE ROWID = :tblSwFld.colRowid"
.head 4 -  Set strSqlInsert = "INSERT INTO sw_fld
                          (   tag
                            , templ
                            , acc_id
                            , i_flag
                          )
          VALUES          (   :tblSwFld.colTag
                            , :tblSwFld.colTempl
                            , :tblSwFld.colAccId
                            , :tblSwFld.colIflag )"
.head 4 -  Set strSqlUpdate = "UPDATE sw_fld
                      SET   tag     = :tblSwFld.colTag
                          , templ   = :tblSwFld.colTempl
                          , acc_id  = :tblSwFld.colAccId
                          , i_flag  = :tblSwFld.colIflag
                    WHERE ROWID = :tblSwFld.colRowid"
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Print
.head 4 -  Set i=0
.head 4 +  Loop
.head 5 -  Set strFileName=GetPrnDir()||'\\'||'SWfld.'||
SalFmtFormatNumber(i,'000')
.head 5 +  If SalFileGetDateTime(strFileName,dDatTmp)
.head 6 -  Set i=i+1
.head 6 +  If i>999
.head 7 -  Break
.head 5 +  Else
.head 6 -  Break
.head 4 -  Call TablePrint( tblSwFld, 'Шаблоны полей SWIFT сообщений',strFileName,'')
.head 1 -  ! !
.head 1 -  ! ! Dialogs for S.W.I.F.T.
.head 1 -  ! !
.head 1 +  Dialog Box: dlg_SWIFTEditor
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подготовка S.W.I.F.T - сообщения
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.988"
.head 4 -  Top:    1.24"
.head 4 -  Width:  8.267"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.083"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Ввод любого S.W.I.F.T.-сообщения
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: MT:
.head 4 -  Resource Id: 35208
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbMT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.383"
.head 5 -  Top:    0.155"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.214"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText (hWndForm, "Задайте тип сообщения")
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText (hWndForm, "")
.head 5 +  ! On WM_Char
.head 6 -          Call SalMessageBox("w=" || NumberToHexSX(wParam), "l=" || NumberToHexSX(lParam), MB_OK)
.head 3 -  Background Text: From:
.head 4 -  Resource Id: 35209
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.405"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText (hWndForm, "Задайте Отправителя сообщения")
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText (hWndForm, "")
.head 3 -  Background Text: To:
.head 4 -  Resource Id: 35210
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.679"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.655"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText (hWndForm, "Задайте Получателя сообщения (F3 - выбор)")
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText (hWndForm, "")
.head 5 +  On WM_KeyDown
.head 6 +  If wParam = 114
.head 7 -  Set dfTo = STRING_Null
.head 7 -  Call FunNSIGetFiltered ('sw_banks', 'bic',
     'bic IN (SELECT bic FROM sw_auth)', strPK, strSK)
.head 7 -  Set dfTo = strSK
.head 6 -  Call SalSetFieldEdit( dfTo, TRUE )
.head 3 +  Pushbutton: pbSend
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Записать
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    3.74"
.head 5 -  Width:  1.329"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nSwRef = Get_SQ( "s_sw_journal" )
.head 6 -  Set strSQL = T("INSERT INTO sw_journal
                           ( swref
                           , mt
                           , sender
                           , receiver
                           , io_ind )
                   VALUES ( :nSwRef
                           , " || SalStrLeftX(cmbMT, 3) || "
                           , :dfFrom
                           , :dfTo
                           , 'I' )")
.head 6 -  Set nSwRef = Read_SQ( nSwRef )
.head 6 -  Set bOK = SqlPrepareAndExecute( hSql(), strSQL )
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While bOK AND SalTblFindNextRow ( tblFields, nRow, 0, 0 )
.head 7 -  Call SalTblFetchRow ( tblFields, nRow )
.head 7 -  ! Call SalMessageBox(tblFields.colValue, tblFields.colTag, MB_Ok)
.head 7 +  ! If tblFields.colTag = "20"
.head 8 -          Set strV = GetNextOutSwRef(strValues)
.head 7 +  ! Else
.head 8 -          Set strV = tblFields.colValue
.head 7 -  Set strV = tblFields.colValue
.head 7 -  Set strT = tblFields.colTag
.head 7 -  Set strO = tblFields.colOpt
.head 7 -  Set strS = tblFields.colSeq
.head 7 +  If strV != ''
.head 8 -  Set strSQL = T('INSERT INTO sw_operw
                           (  swref
                           ,  tag
                           ,  seq
                           ,  n
                           ,  opt
                           ,  value )
                    VALUES ( :nSwRef
                           , :strT
                           , :strS
                           , :nRow
                           , :strO
                           , :strV)')
.head 8 -  Set bOK =  SqlPrepareAndExecute( hSql(), strSQL )
.head 7 -  Call SalTblSetRowFlags( tblFields, nRow, ROW_Edited | ROW_New, FALSE )
.head 6 +  If bOK
.head 7 -  Call SqlCommitEx( hSql(), 'Введено S.W.I.F.T.-сообщение № '||
     Str( nSwRef ) ||' !')
.head 7 -  Call SalMessageBox('Введено S.W.I.F.T.-сообщение № '||
     Str( nSwRef ) ||' !', 'Новое сообщение SWIFT', MB_Ok)
.head 7 -  Call SalDisableWindow( pbSend )
.head 6 +  Else
.head 7 -  Call SqlRollbackEx( hSql()
, 'Ошибка ввода нового SWIFT сообщения!' )
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Новое
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    3.156"
.head 5 -  Width:  1.329"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \Bars98\RESOURCE\BMP\Newrec.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call tblFields.Init()
.head 6 -  Call SalEnableWindow( pbSend )
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    4.323"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 3 +  Pushbutton: pbHelp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    4.906"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbInsert
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    0.906"
.head 5 -  Width:  1.329"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCurRow=SalTblQueryContext( tblFields )+1
.head 6 -  Set strT = tblFields.colTag
.head 6 -  Set strO = tblFields.colOpt
.head 6 -  Set strS = tblFields.colSeq
.head 6 -  Call SalTblInsertRow( tblFields, nCurRow )
.head 6 -  Set nRow = nRow+1
.head 6 -  Set tblFields.colTag = strT
.head 6 -  Set tblFields.colOpt = strO
.head 6 -  Set tblFields.colSeq = strS
.head 3 +  Pushbutton: pbDelete
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.686"
.head 5 -  Top:    1.49"
.head 5 -  Width:  1.329"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \Bars98\RESOURCE\BMP\Delete.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCurRow=SalTblQueryContext( tblFields )
.head 6 -  Call SalTblDeleteRow( tblFields, nCurRow, TBL_Adjust)
.head 6 -  Set nRow = nRow-1
.head 3 +  Child Table: tblFields
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsSortedTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.905"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Поле
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_FetchRowDone
.head 8 +  If colStatus = "M"
.head 9 -  Call SalColorSet( colTag, COLOR_IndexCellText, COLOR_Red )
.head 8 +  If ((nFunction & 0x000F) = 0)
 OR (((nFunction & 0x000F) != 0x000F) AND
         (SalNumberMod(SalStrToNumber(colTag), 2) = 0))
.head 9 -  Call SalColorSet( colValue, COLOR_IndexCellText, COLOR_DarkRed )
.head 8 -  Call RepopulateTags(  )
.head 5 +  Column: colSeq
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Opt
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.586"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalListClear( colOpt )
.head 8 -  Call SalListPopulate( colOpt, hSql(),
 "SELECT valid.opt
    FROM sw_valid valid,
         sw_rule  rule
    WHERE rule.swrule = valid.swrule
      AND rule.tag = :colTag
      AND rule.seq = :colSeq
      AND rule.mt  = " || SalStrLeftX(cmbMT, 3) )
.head 5 +  Column: colStatus
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Popup Edit
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 +  If ((nFunction & 0x000F) = 0)
 OR (((nFunction & 0x000F) != 0x000F) AND
         (SalNumberMod(SalStrToNumber(colTag), 2) = 0))
.head 9 -  Call SalTblSetColumnFlags ( tblFields.colValue, COL_Editable, FALSE )
.head 9 -  Call SalDisableWindow( tblFields.colValue )
.head 8 +  Else
.head 9 -  Call SalEnableWindow( tblFields.colValue )
.head 9 -  Call SalTblSetColumnFlags ( tblFields.colValue, COL_Editable, TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( colValue ) AND colStatus = 'M'
.head 9 -  Call SalMessageBox ( 'Не заполнено обязательное поле!','Ошибка', MB_IconExclamation | MB_Ok )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return ufValidateSWField ( colTag, colOpt, colValue )
.head 5 +  Column: colUniq
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Init
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set strSQL = T("SELECT seq
                     , tag
                     , status
                     , uniq_ind
                  FROM sw_rule
                  INTO :colSeq
                     , :colTag
                     , :colStatus
                     , :colUniq
                 WHERE mt = " || SalStrLeftX(cmbMT, 3) || " ORDER BY 1, 2")
.head 7 -  Call SalTblPopulate( tblFields, hSql(), strSQL, TBL_FillAll )
.head 7 -  Call SalPostMsg( tblFields, SAM_RowSetContext, 0, 0 )
.head 7 -  ! Call SqlPrepareAndExecute( hSql(), strSQL)
.head 7 -  ! Set nRow = 0
.head 7 +  ! Loop
.head 8 -          Call SqlFetchNext( hSql(), nRet )
.head 8 +          If nRet = FETCH_EOF
.head 9 -          Break 
.head 8 -          Set strModif[nRow, 1] = strTag
.head 8 -          Set strModif[nRow, 2] = strOpt
.head 8 -          Set nRow = nRow+1
.head 7 -  ! Set nMaxRow = nRow
.head 7 -  ! Set strSQL = T("SELECT tag, opt
FROM sw_rules
INTO :hWndForm.colTag, :hWndForm.colOpt
WHERE mt = " || SalStrLeftX(cmbMT, 3) || "
ORDER BY 1")
.head 7 -  ! Call tblFields.SetSql( strSQL, hSql())
.head 7 -  ! Call tblFields.BuildFieldList( 'SW_VALID.tag' )
.head 7 -  ! Call tblFields.Refresh(  )
.head 7 -  ! !!!!!!!!! Call SalTblSetRow ( tblFields, TBL_SetLastRow )
.head 7 -  ! !!!!!!!!!!Call SalTblSetFocusRow( hWndItem, 0 )
.head 7 -  ! !!!!!!!!!Call SalSetFocus( cmbMT )
.head 5 +  Function: AfterRefreshHook
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nInArray >0
.head 8 -  Set nTableRow = TBL_MinRow
.head 8 +  Loop
.head 9 +  If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
.head 10 -  Call SalTblFetchRow ( tblFields, nTableRow )
.head 10 -  Set nRow = 0
.head 10 +  Loop
.head 11 +  If nRow > SalStrToNumber(strValues[0, 0, nInArray])
.head 12 -  Break
.head 11 +  Else If strValues[nRow, 0, nInArray] = tblFields.colTag
.head 12 -  Set tblFields.colValue = VSStrTrim(strValues[nRow, 1, nInArray])
.head 11 -  Call Inc(nRow)
.head 9 +  Else
.head 10 -  Break
.head 7 +  Else
.head 8 -  Set nTableRow = TBL_MinRow
.head 8 +  Loop
.head 9 +  If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
.head 10 -  Call SalTblFetchRow ( tblFields, nTableRow )
.head 10 -  ! Set nFunction = 0x0001
.head 10 -  Call SalColorSet( colValue, COLOR_IndexCellText, COLOR_Black )
.head 9 +  Else
.head 10 -  Break
.head 5 +  Function: RepopulateTags
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRow = 0
.head 7 -  ! Call SalListClear( colOpt )
.head 7 +  While nRow != nMaxRow
.head 8 +  If strModif[nRow, 1] = colTag
.head 9 -  ! Call SalListAdd ( colOpt, colTag || strModif[nRow, 2] )
.head 9 -  Set colOpt = strModif[nRow, 2]
.head 8 -  Set nRow = nRow+1
.head 7 +  ! If SalListQueryCount( colOpt ) = 0
.head 8 -          Call SalListAdd ( colOpt, colTag )
.head 7 -  ! Call SalListSetSelect( colOpt, 0 )
.head 5 +  Function: ufValidateSWField
.head 6 -  Description: Performs checking for correspondence the structure of a SWIFT field
to the predefined format (from SW_FORMAT table), if the latter
exists.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 7 -  String: sOpt
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sFmt
.head 7 -  Number: nInd
.head 7 -  Boolean: bOK
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute ( hSql(), T(
'SELECT fmt
 INTO   :sFmt
 FROM   sw_format
 WHERE  opt = :sOpt
   AND  tag = :sTag'))
.head 7 +  If SqlFetchNext ( hSql(), nInd )
.head 8 -  ! --- А здесь предполагается проверка на соответствие формату
.head 8 -  Set bOK = VALIDATE_Ok
.head 7 -  Set bOK = VALIDATE_Ok
.head 7 -  Return bOK
.head 4 +  Window Variables
.head 5 -  String: strModif[0:*, 1:2]
.head 5 -  String: strTag
.head 5 -  String: strOpt
.head 5 -  Number: nRet
.head 5 -  Number: nMaxRow
.head 5 -  Number: nTableRow
.head 5 -  Window Handle: hwCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call Init()
.head 5 +  ! On SAM_Click
.head 6 -          Call RepopulateTags(  )
.head 5 +  On WM_SysKeyDown
.head 6 -  Call SalSendMsg( cmbMT, WM_Char, wParam, lParam - 0x20000000 )
.head 5 +  On WM_KeyDown
.head 6 -  ! Call SalMessageBox("syskeydown w="||NumberToHexSX(  wParam ), "l="||NumberToHexSX(lParam), MB_OK)
.head 6 -  Call SalSendMsg( cmbMT, WM_Char, 0x8, 0x0E0001 )
.head 5 +  ! On WM_SysKeyUp
.head 6 +          If wParam = 18
.head 7 -          Call SalMessageBox("syskeydown w="||NumberToHexSX(  wParam ), "l="||NumberToHexSX(lParam), MB_OK)
.head 7 -          Call SalSendMsg( cmbMT, WM_Char, 0x8, 0x0E0001 )
.head 5 +  ! On SAM_RowSetContext
.head 6 -          Call SalPostMsg( dlg_SWIFTEditor, UM_Choose, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set strS = "SELECT name
FROM sw_filnm n, sw_format f
WHERE f.id = n.r_format
AND f.tag = :tblFields.colTag
AND f.opt = :tblFields.colOpt"
.head 6 -  Call SalPostMsg( dlg_SWIFTEditor, UM_Choose, 0, 0 )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nRef
.head 3 -  Receive String: strValues[50, 0:2, 1:2]
.head 3 -  Number: nInArray
.head 3 -  Number: nFunction
.head 3 -  ! 0x0000    - Disable Editing table
  0x0001    - Enable Editing only some fields
  0x000F    - Enable Edititng entire table
  0x0010    - Enable Add Field
  0x0020    - Enable Remove Field
  0x0040    - Enable Edit To:
  0x0080    - Enable Edit To:
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  String: strDefMT
.head 3 -  Number: nSwRef
.head 3 -  String: strV
.head 3 -  String: strT
.head 3 -  String: strO
.head 3 -  String: strS
.head 3 -  String: strPK
.head 3 -  String: strSK
.head 3 -  Number: nCurRow
.head 3 -  Number: N
.head 3 -  Boolean: bOK
.head 2 +  Message Actions
.head 3 +  On SAM_DoInit
.head 4 -  Call tblFields.Init()
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  ! Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 4 -  Set strSQL = T("SELECT mt || ' - ' || name FROM sw_mt")
.head 4 -  Call SalListPopulate( cmbMT, hSql(), strSQL )
.head 4 +  If nInArray > 0
.head 5 -  Set nRow = 0
.head 5 +  Loop
.head 6 +  If nRow > SalStrToNumber(strValues[0, 0, nInArray])
.head 7 -  Break
.head 6 +  If strValues[nRow, 0, nInArray] = "#1 MT"
.head 7 -  Set strDefMT = strValues[nRow, 1, nInArray]
.head 6 +  Else If strValues[nRow, 0, nInArray] = "#2 FROM"
.head 7 -  Set dfFrom = strValues[nRow, 1, nInArray]
.head 6 +  Else If strValues[nRow, 0, nInArray] = "#3 TO"
.head 7 -  Set dfTo = strValues[nRow, 1, nInArray]
.head 6 -  Set nRow = nRow+1
.head 5 -  Call SalDisableWindow( dfTo )
.head 5 -  Call SalListSelectString( cmbMT, 0, strDefMT )
.head 5 -  Call SalDisableWindow( cmbMT )
.head 5 -  Call SalDisableWindow( tblFields.colValue )
.head 4 +  Else
.head 5 -  Set dfFrom = GetGlobalOption( "BICCODE" )
.head 4 -  Call SalDisableWindow( dfFrom )
.head 4 -  Call SalListSetSelect( cmbMT, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On UM_Choose
.head 4 +  If tblFields.colUniq = 'N'
.head 5 -  Call SalEnableWindow( pbInsert )
.head 5 -  Call SalEnableWindow( pbDelete )
.head 4 +  Else
.head 5 -  Call SalDisableWindow( pbInsert )
.head 5 -  Call SalDisableWindow( pbDelete )
.head 3 +  On SAM_Destroy
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' ShowSWIFTeditor()  ')
.head 1 +  Dialog Box: dlg_SWIFTbanks
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Список банков-участников S.W.I.F.T.
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.838"
.head 4 -  Top:    0.958"
.head 4 -  Width:  10.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.375"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список банков-участников S.W.I.F.T.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsSortedTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    0.74"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colbic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIC
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.443"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.486"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAuth0
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ключ
аутентификации
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAuth1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ключ
аутентификации
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCorrNostro
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кол-во корр.
(НОСТРО)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.414"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCorrLoro
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кол-во корр.
(ЛОРО)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.286"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Init
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call UpdateDB(  )
.head 7 -  ! vvvvvvvvvvvvvvvvvvvvvvvvvvvvvv Так должно быть
.head 7 -  Set strSQL = T('
SELECT a.bic
     , a.name
     , DECODE(b.bic, a.bic, 1, 0) auth
     , DECODE(c.bic, a.bic, 1, 0) auth2
     , COUNT(r.nostro) count1
     , COUNT(q.bank) count2
INTO :hWndForm.colbic
   , :hWndForm.colName
   , :hWndForm.colAuth0
   , :hWndForm.colAuth1
   , :hWndForm.colCorrLoro
   , :hWndForm.colCorrNostro
FROM  sw_banks a
    , sw_auth  b OUTER
    , sw_auth  c OUTER
    , sw_route r OUTER
    , sw_route q OUTER
WHERE b.bic   (+)= a.bic
  AND c.bic   (+)= a.bic
  AND r.nostro(+)= a.bic
  AND q.bank  (+)= a.bic
GROUP BY a.bic
       , a.name
       , DECODE(b.bic, a.bic, 1, 0)
       , DECODE(c.bic, a.bic, 1, 0)
@FILTER')
.head 7 -  Call tblBanks.SetSql( strSQL, hSql())
.head 7 -  Call tblBanks.BuildFieldList( 'a.bic, a.name, auth, count1, count2' )
.head 7 -  Call tblBanks.Refresh(  )
.head 7 -  Call SalTblSetRow ( tblBanks, TBL_SetFirstRow )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call Init()
.head 6 +  If strbic != ''
.head 7 -  Call SalTblSetFocusRow ( tblBanks, VisTblFindString (tblBanks, 0, colbic, strbic) )
.head 5 +  ! On WM_LbuttonDblClick
.head 6 +          If strbic != ''
.head 7 -          Call SalSendMsg( pbView, SAM_Click, 0, 0 )
.head 3 +  Pushbutton: pbView
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подробно...
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strbic = tblBanks.colbic
.head 6 +  If strbic != ''
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call SalModalDialog( dlg_SWIFTbank, hWndForm, strbic )
.head 7 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 7 -  Call SalWaitCursor( FALSE )
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавить...
.head 4 -  Window Location and Size
.head 5 -  Left:   1.586"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog( dlg_SWIFTbank, hWndForm, '' )
.head 6 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.986"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox( 'Удалить банк ' || tblBanks.colbic || ' и все связи с ним?', 'Подтверждение', MB_YesNo ) = IDYES
.head 7 -  Set strSQL = 'DELETE FROM sw_route
WHERE (bank = :tblBanks.colbic ) OR (nostro = :tblBanks.colbic )'
.head 7 +  If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 8 -  Call MessageError( 'CNTR00000: Не могу удалить записи о корреспондентах банка ' || tblBanks.colbic)
.head 8 -  Call SqlRollback( hSql() )
.head 7 +  Else
.head 8 -  Set strSQL = 'DELETE FROM sw_banks
WHERE bic = :tblBanks.colbic'
.head 8 +  If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 9 -  Call MessageError( 'CNTR00000: Не могу удалить запись о банке ' || tblBanks.colbic)
.head 9 -  Call SqlRollback( hSql() )
.head 8 +  Else
.head 9 -  Call SqlCommitEx( hSql(), 'CNTR00000: Удаляю запись о банке ' || tblBanks.colbic)
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  Pushbutton: pbSelect
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   4.386"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If (nFunction & 0x0200) != 0
.head 7 -  Set strbic = tblBanks.colbic
.head 7 -  Call SalEndDialog( hWndForm, 0 )
.head 6 +  Else
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow ( tblBanks, nRow, ROW_Selected, 0 )
.head 9 -  Call SalTblFetchRow ( tblBanks, nRow )
.head 9 -  Set strSQL = 'INSERT INTO sw_route
(route, bank, nostro)
VALUES (0, :strbic, :tblBanks.colbic)'
.head 9 +  If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 10 -  Call MessageError( 'Не могу cвязать! ' )
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Break
.head 8 +  Else
.head 9 -  Call SqlCommitEx( hSql(), 'CNTR00000: Связываю ')
.head 9 -  Break
.head 7 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.786"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call UpdateDB(  )
.head 6 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 3 +  Pushbutton: pbHelp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.186"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: UpdateDB
.head 4 -  Description: Обновляет информацию об аутентифицированных банках
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  If SalTblFindNextRow( tblBanks, nRow, ROW_Edited, 0 )
.head 6 +  If SalMessageBox("Изменена информация о наличии ключей аутентификации. Сохранить?", "Информация", MB_YesNo) = IDYES
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow( tblBanks, nRow, ROW_Edited, 0 )
.head 9 -  Call SalTblFetchRow( tblBanks, nRow )
.head 9 +  If not(tblBanks.colAuth0 = tblBanks.colAuth1)
.head 10 +  If tblBanks.colAuth0 = 1
.head 11 -  Set strSQL = "INSERT INTO sw_auth (bic) VALUES (:tblBanks.colbic)"
.head 10 +  Else
.head 11 -  Set strSQL = "DELETE FROM sw_auth WHERE bic=(:tblBanks.colbic)"
.head 10 -  Call SqlPrepareAndExecute( hSql(), strSQL )
.head 8 +  Else
.head 9 -  Break
.head 7 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_Edited, FALSE, 0, 0 )
.head 7 -  Call SqlCommitEx( hSql(), "Обновляю информацию об аутентификации банков..." )
.head 2 +  Window Parameters
.head 3 -  Receive String: strbic
.head 3 -  Number: nFunction
.head 3 -  ! 0x0001    - Enable Details
  0x0002    - Enable Add
  0x0004    - Enable Remove
  0x0008    - Enable Select

  0x0010    - Default Details
  0x0080    - Default Select

  0x0100    - On Select Do Link
  0x0200    - On Select Do Return
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_DoInit
.head 4 -  Call tblBanks.Init()
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 4 +  If (nFunction & 0x0001) = 0
.head 5 -  Call SalDisableWindow( pbView )
.head 4 +  If (nFunction & 0x0002) = 0
.head 5 -  Call SalDisableWindow( pbNew )
.head 4 +  If (nFunction & 0x0004) = 0
.head 5 -  Call SalDisableWindow( pbDel )
.head 4 +  If (nFunction & 0x0008) = 0
.head 5 -  Call SalDisableWindow( pbSelect )
.head 4 +  If (nFunction & 0x0010) != 0
.head 5 -  Call SalSetDefButton( pbView )
.head 5 -  Call tblBanks.Link( pbView )
.head 4 +  If (nFunction & 0x0080) != 0
.head 5 -  Call SalSetDefButton( pbSelect )
.head 5 -  Call tblBanks.Link( pbSelect )
.head 4 +  ! If strbic = ''
.head 5 -          Call SalDisableWindow( pbView )
.head 5 -          Call SalSetDefButton( pbSelect )
.head 5 -          Call tblBanks.Link( pbSelect )
.head 4 +  ! Else
.head 5 -          Call SalDisableWindow( pbSelect )
.head 5 -          Call tblBanks.Link( pbView )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 1 +  Dialog Box: dlg_SWIFTbank
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Банк-участник S.W.I.F.T.
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   3.8"
.head 4 -  Top:    2.51"
.head 4 -  Width:  7.683"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.262"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Корреспонденты банка-участника S.W.I.F.T.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: BIC
.head 4 -  Resource Id: 35211
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    0.179"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfbic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.155"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Наименование
.head 4 -  Resource Id: 35212
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.405"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Корреспонденты
.head 4 -  Resource Id: 35213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.905"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Child Table: tblBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsSortedTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.071"
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.667"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colbic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIC
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 12
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Init
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set strSQL = T('SELECT sw_banks.bic, sw_banks.name
FROM sw_route, sw_banks
INTO :hWndForm.colbic, :hWndForm.colName
WHERE sw_route.bank = :dfbic AND sw_banks.bic = sw_route.nostro')
.head 7 -  ! Call SalMessageBox(strSQL, '!', MB_Ok)
.head 7 -  Call tblBanks.SetSql( strSQL, hSql() )
.head 7 -  Call tblBanks.BuildFieldList( "SW_BANKS.bic, SW_BANKS.name" )
.head 7 -  Call tblBanks.Refresh(  )
.head 7 -  Call SalTblSetRow ( tblBanks, TBL_SetFirstRow )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  ! Call Init()
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавить...
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    1.071"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog( dlg_SWIFTbanks, hWndForm, strMain, 0x0088)
.head 6 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    1.655"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox( 'Удалить связь с банком ' || tblBanks.colbic || ' ?', 'Подтверждение', MB_YesNo ) = IDYES
.head 7 -  Set strSQL = 'DELETE FROM sw_route
WHERE nostro = :tblBanks.colbic AND bank = :strMain'
.head 7 +  If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 8 -  Call MessageError( 'Не могу удалить записи о корреспондентах банка ' || tblBanks.colbic)
.head 8 -  Call SqlRollback( hSql() )
.head 7 +  Else
.head 8 -  Call SqlCommitEx( hSql(), 'Удаляю запись о банке ' || tblBanks.colbic)
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    2.238"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If strMain = ''
.head 7 -  Set strSQL = 'INSERT INTO sw_banks
(bic, name)
VALUES (:dfbic, :dfName)'
.head 6 +  Else
.head 7 -  Set strSQL = 'UPDATE sw_banks
SET bic = :dfbic, name=:dfName
WHERE bic=:dfbic'
.head 6 -  ! Call SalMessageBox( strSQL, ':-)', MB_Ok )
.head 6 +  If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 7 -  Call MessageError( 'Не могу сохранить запись о банке.' )
.head 7 -  Call SqlRollback( hSql() )
.head 6 +  Else
.head 7 -  Call SqlCommitEx( hSql(), 'Сохраняю запись о банке.')
.head 6 -  ! Call SalSendMsg( hwCalledFrom, SAM_DoInit, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    2.821"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 3 +  Pushbutton: pbHelp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    3.405"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strMain
.head 2 +  Window Variables
.head 3 -  String: strbic
.head 3 -  Number: nRow
.head 3 -  String: strSqlAdd
.head 2 +  Message Actions
.head 3 +  On SAM_DoInit
.head 4 +  If strMain != ''
.head 5 -  ! Set strSQL = T('SELECT bic, name
FROM sw_banks
INTO :dfbic, :dfName
WHERE bic = "' || strMain || '"')
.head 5 -  Set strSQL = T('SELECT bic, name
FROM sw_banks
INTO :dfbic, :dfName
WHERE bic = :strMain')
.head 5 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 5 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 +  Else
.head 5 -  Call SalDisableWindow( tblBanks )
.head 5 -  Call SalDisableWindow( pbNew )
.head 5 -  Call SalDisableWindow( pbDel )
.head 4 -  Call tblBanks.Init()
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 4 -  ! Call SalDisableWindow( pbSelect )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 1 +  Dialog Box: dlg_FindSWIFTpath
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выбор маршрута сообщения SWIFT
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.883"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.24"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Ищем пути от SWIFT-узла к другому
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Group Box: Возможные пути
.head 4 -  Resource Id: 35214
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.656"
.head 5 -  Width:  10.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Child Table: tblPaths
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsSortedTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.823"
.head 6 -  Width:  10.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.833"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colRec
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Receiver
MT100
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colInter
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intermediary
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAccw
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Account With
Institution
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDesc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Комментарий
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.557"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   7.486"
.head 5 -  Top:    0.74"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \Bars98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  If not SalTblFindNextRow ( tblPaths, nRow, ROW_Selected, 0 )
.head 7 -  Call SalMessageBox( "Выберите путь SWIFT сообщения!", "Внимание!", MB_Ok )
.head 6 +  Else
.head 7 -  Set str0 = tblPaths.colRec
.head 7 -  Set str1 = tblPaths.colInter
.head 7 -  Set str2 = tblPaths.colAccw
.head 7 -  Call SalEndDialog( dlg_FindSWIFTpath, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.886"
.head 5 -  Top:    0.74"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_FindSWIFTpath, FALSE )
.head 3 +  ! cpbHelp: pbHelp
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Помощь
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    3.821"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.end
.head 4 -          Message Actions 
.head 3 -  Background Text: Банк Получателя
.head 4 -  Resource Id: 61114
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.094"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк NOSTRO
.head 4 -  Resource Id: 61115
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.344"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Счет NOSTRO
.head 4 -  Resource Id: 61116
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.594"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDestination
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNostroAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    0.573"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNostroBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    0.323"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 61113
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.386"
.head 5 -  Top:    0.073"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbView
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Документ...
.head 4 -  Window Location and Size
.head 5 -  Left:   7.486"
.head 5 -  Top:    0.156"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call DocViewContentsEx( hWndMDI,nRef )
.head 2 +  Functions
.head 3 +  Function: Init
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! заполнение основных полей
.head 5 -  !
.head 5 -  Set dfDestination = strDestination
.head 5 -  Set dfNostroBank = strNostro
.head 5 -  Set strSQL = T("
SELECT a.nls || '/' || t.lcv
INTO   :dfNostroAcc
FROM   accounts a
     , operw o
     , tabval t
WHERE  t.kv  = a.kv
AND    a.acc = o.value
AND    o.ref = :nRef
AND    o.tag = 'NOS_A'
")
.head 5 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 5 -  Call SqlFetchNext (hSql(), nRet)
.head 5 -  !
.head 5 -  ! заполнение таблицы возможный путей
.head 5 -  !
.head 5 -  ! ========= 1) Прямой путь   (MT100)
! ========= 2) Один посредник (MT100, 57)
! ========= 3) Прямой МТ100 + МТ202
! ========= 4) Два посредника (МТ100, 56+57)
.head 5 -  Set strSQL = T("
SELECT a.bic recv
     , ''    intr
     , ''    accw
     , '' descr
INTO :hWndForm.colRec
   , :hWndForm.colInter
   , :hWndForm.colAccw
   , :hWndForm.colDesc
FROM sw_auth a
WHERE a.bic = '"||strDestination||"'
  AND a.bic = '"||strNostro||"'
UNION
SELECT a.bic
     , ''   
     , ''   
     , 'MT202->"||strNostro||"'
FROM sw_auth a
WHERE a.bic = '"||strDestination||"'
  AND a.bic <>'"||strNostro||"'
UNION
SELECT a.bic    
     , ''       
     , r.nostro
     , ''
FROM sw_auth a
   , sw_route r
WHERE a.bic    = '"||strNostro||"'
 AND  r.bank   = a.bic
 AND  r.nostro = '"||strDestination||"'
UNION
SELECT a.bic    
     , q.bank   
     , q.nostro
     , ''
FROM sw_auth  a
   , sw_route r
   , sw_route q
WHERE a.bic    = '"||strNostro||"'
 AND  r.bank   = a.bic
 AND  r.nostro = q.bank
 AND  q.nostro = '"||strDestination||"'
ORDER BY 1,3,2")
.head 5 -  ! Call Debug( strSQL )
.head 5 -  Call tblPaths.SetSql( strSQL,  hSql() )
.head 5 -  Call tblPaths.BuildFieldList("recv, intr, accw, descr")
.head 5 -  Call tblPaths.Refresh(  )
.head 2 +  Window Parameters
.head 3 -  Number: nRef
.head 3 -  String: strSource
.head 3 -  String: strDestination
.head 3 -  String: strNostro
.head 3 -  Receive String: str0
.head 3 -  Receive String: str1
.head 3 -  Receive String: str2
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nRet
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Call Init()
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsgToChildren( hWndForm, SAM_DoInit, 0, 0 )
.head 1 +  Form Window: dlg_SWIFTmessages
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подбор маршрута платежа
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.03"
.head 4 -  Top:    0.558"
.head 4 -  Width:  11.614"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.521"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Отбор S.W.I.F.T.-сообщений
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblMessages
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsSortedTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.014"
.head 6 -  Top:    0.573"
.head 6 -  Width:  11.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
документа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.443"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLcv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsMoneyColumn
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.671"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.671"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVdat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
вал
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colInvS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Transaction
Reference Number
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colInvDig
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Transaction
Reference Number
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Init
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! ========= Выбираем документы, у которых"
- Флаг межбанка = 2 (SWIFT)
- Нет еще записей в SW_OPER
.head 7 -  Set strSQL = T("
SELECT o.ref, o.tt, o.nd, t.lcv, t.dig, o.s, o.nlsa, o.nlsb, o.vdat
FROM oper o, tabval t, tts tt
INTO :hWndForm.colRef,  :hWndForm.colTt,     :hWndForm.colNd,
     :hWndForm.colLcv,  :hWndForm.colInvDig, :hWndForm.colInvS,
     :hWndForm.colNlsa, :hWndForm.colNlsb,   :hWndForm.colVdat
WHERE t.kv=o.kv AND o.sos in (5,7)
  AND o.nlsa IS NOT NULL
  AND o.nlsb IS NOT NULL
  AND o.tt = tt.tt
  AND (tt.fli = 2
  AND o.ref NOT IN (SELECT ref FROM sw_oper) ORDER BY o.ref")
.head 7 -  ! Set strSQL = T("
SELECT o.ref, o.tt, o.nd, t.lcv, t.dig, o.s, o.nlsa, o.nlsb, o.vdat
FROM oper o, tabval t, tts tt
INTO :hWndForm.colRef,  :hWndForm.colTt,     :hWndForm.colNd,
     :hWndForm.colLcv,  :hWndForm.colInvDig, :hWndForm.colInvS,
     :hWndForm.colNlsa, :hWndForm.colNlsb,   :hWndForm.colVdat
WHERE t.kv=o.kv AND o.sos=7
  AND o.nlsa IS NOT NULL
  AND o.nlsb IS NOT NULL
  AND o.tt = tt.tt
  AND tt.fli = 2
  AND o.ref NOT IN (SELECT ref FROM sw_oper) ORDER BY o.ref")
.head 7 -  Call colS.Bind( colInvS, colInvDig )
.head 7 -  Call tblMessages.SetSql( strSQL, hSql())
.head 7 -  Call tblMessages.BuildFieldList(
 'OPER.ref,  OPER.tt,   OPER.nd, TABVAL.lcv, TABVAL.dig, OPER.s,
  OPER.nlsa, OPER.nlsb, OPER.vdat' )
.head 7 -  Call tblMessages.Refresh(  )
.head 7 -  Call SalTblSetRow ( tblMessages, TBL_SetFirstRow )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call Init()
.head 5 +  On WM_LbuttonDblClick
.head 6 -  Call SalSendMsg( pbView, SAM_Click, 0, 0 )
.head 3 +  Pushbutton: pbView
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Документ...
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call DocViewContentsEx( hWndMDI, tblMessages.colRef )
.head 3 +  ! cpbEdit: pbViewExtAttr
.head 4 +          Message Actions 
.head 5 +          On SAM_Click
.head 6 +          If NOT SalModalDialog( dlg_SWIFTkeys, hWndForm, SalStrToNumber(tblMessages.colRef), 0 )
.head 7 -  ! Call MessageError( 'CNTR00000: Ошибка при заполнении SWIFT-ключей' )
.head 3 +  ! cpbInsert: pbNew
.head 4 +          Message Actions
.head 5 +          On SAM_Click
.head 6 -          Call SalModalDialog( dlg_SWIFTbank, hWndForm, '' )
.head 6 -          Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  ! cpbDelete: pbDel
.head 4 +          Message Actions 
.head 5 +          On SAM_Click
.head 6 +  ! If SalMessageBox( 'CNTR00000: Удалить сообщение номер ' || tblMessages.colTRN || '?', 'Подтверждение', MB_YesNo ) = IDYES
.head 7 -          Set strSQL = 'DELETE FROM sw_route
WHERE (bank = :tblBanks.colbic ) OR (nostro = :tblBanks.colbic )'
.head 7 +          If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 8 -          Call MessageError( 'CNTR00000: Не могу удалить записи о корреспондентах банка ' || tblBanks.colbic)
.head 8 -          Call SqlRollback( hSql() )
.head 7 +          Else
.head 8 -          Set strSQL = 'DELETE FROM sw_banks
WHERE bic = :tblBanks.colbic'
.head 8 +          If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 9 -          Call MessageError( 'CNTR00000: Не могу удалить запись о банке ' || tblBanks.colbic)
.head 9 -          Call SqlRollback( hSql() )
.head 8 +          Else
.head 9 -          Call SqlCommitEx( hSql(), 'CNTR00000: Удаляю запись о банке ' || tblBanks.colbic)
.head 7 -          Call SalSendMsg( hWndForm, SAM_DoInit, 0, 0 )
.head 3 +  Pushbutton: pbSelect
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: F5-Отобрать
.head 4 -  Window Location and Size
.head 5 -  Left:   1.586"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F5
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Click       -------------Сивякова
.head 6 -          Set nRow2 = TBL_MinRow
.head 6 +          Loop 
.head 7 +          If SalTblFindNextRow ( tblMessages, nRow2, ROW_Selected, 0 )
.head 8 -          Call SalTblFetchRow ( tblMessages, nRow2 )
.head 8 -  !
.head 8 -          Set strResult[0,0,1] = ""
.head 8 -          Set strResult[0,0,2] = ""
.head 8 -  !
.head 8 -          Set strSQL = 'SELECT a.ref, a.pdat, a.kv, a.s, a.nam_a, a.nlsa, a.nam_b, a.nlsb, a.nazn, a.vdat, b.lcv, b.dig
FROM oper a, tabval b
INTO :nRef, :dtPdat, :nkv, :nSum, :strNama, :strNlsa :strNamb, :strNlsb, :strNazn, :dtVdat, :strLCV, :nDig
WHERE (b.kv=a.kv) AND (a.ref=:tblMessages.colTRN)'
.head 8 +          If NOT SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 9 -          Call SalMessageBox( "CNTR15001: Не найдена запись в OPER", "Ошибка", MB_Ok )
.head 8 +          Else 
.head 9 -          Call SqlFetchNext( hSql(), nRet )
.head 9 -          Set strSQL = 'SELECT c.bic
FROM oper a, accounts d, cust_acc b, custbank c
INTO :strDestbicPay
WHERE  (a.nlsb=d.nls) AND (b.acc=d.acc) AND (a.kv=d.kv) AND (c.rnk=b.rnk) AND (a.ref=:tblMessages.colTRN)'
.head 9 +          If SqlPrepareAndExecute (hSql(), strSQL) = FALSE
.head 10 -          Call SalMessageBox( "CNTR15002: Не найдена запись о банке в CUSTBANK: Документ-->СчётБ-->Банк", "Ошибка", MB_Ok )
.head 9 +          Else 
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 -  ! Получаем значения из OPERW
.head 10 -          Set strSQL = 'SELECT a.tag, a.value
FROM operw a
INTO :strTag, :strValue
WHERE ref=:tblMessages.colTRN'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 +          Loop 
.head 11 -          Call SqlFetchNext( hSql(), nRet )
.head 11 +          If nRet = FETCH_EOF
.head 12 -          Break 
.head 11 +          If strTag = "20"
.head 12 -          Set str20 = strValue
.head 11 +          If strTag = "ROUT0"
.head 12 -          Set strRoute0 = strValue
.head 11 +          If strTag = "ROUT1"
.head 12 -          Set strRoute1 = strValue
.head 11 +          If strTag = "ROUT2"
.head 12 -          Set strRoute2 = strValue
.head 11 +          If strTag = "ROUT3"
.head 12 -          Set strRoute3 = strValue
.head 11 +          If strTag = "ROUT9"
.head 12 -          Set strRoute9 = strValue
.head 11 +          If strTag = "50"
.head 12 -          Set str50 = strValue
.head 11 +          If strTag = "57"
.head 12 -          Set strDestbicContr = strValue
.head 11 +          If strTag = "59"
.head 12 -          Set str59 = strValue
.head 11 +          If strTag = "70"
.head 12 -          Set str70 = strValue
.head 11 +          If strTag = "71"
.head 12 -          Set str71 = strValue
.head 11 +          If strTag = "72"
.head 12 -          Set str72 = strValue
.head 10 -  !
.head 10 -          Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuth1 WHERE bic=:strRoute1'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 +          If strAuth1 != ""
.head 11 -          Set bAuthRoute1 = TRUE
.head 10 -  !
.head 10 -          Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuth2 WHERE bic=:strRoute2'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 +          If strAuth2 != ""
.head 11 -          Set bAuthRoute2 = TRUE
.head 10 -  !
.head 10 -          Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuth3 WHERE bic=:strRoute3'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 +          If strAuth3 != ""
.head 11 -          Set bAuthRoute3 = TRUE
.head 10 -  !
.head 10 -          Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuth9 WHERE bic=:strRoute9'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 +          If strAuth9 != ""
.head 11 -          Set bAuthRoute9 = TRUE
.head 10 -  !
.head 10 -          Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuthPay WHERE bic=:strDestbicPay'
.head 10 -          Call SqlPrepareAndExecute (hSql(), strSQL)
.head 10 -          Call SqlFetchNext( hSql(), nRet )
.head 10 +          If strAuthPay != ""
.head 11 -          Set bAuthPay = TRUE
.head 10 -  !
.head 10 +          If bAuthPay = FALSE
.head 11 -          Call SalMessageBox("CNTR00000: Банк, в котором расположен корр. счёт, не авторизован! Отбор этого сообщения невозможен.", "Ошибка", MB_Ok)
.head 11 -          Break 
.head 10 -          Set nSum2 = nSum/SalNumberPower( 10, nDig )
.head 10 -          Set str32 = SalNumberToStrX(SalDateYear( dtVdat )-1900, 0) || SalStrRightX( "00" || SalNumberToStrX(SalDateMonth( dtVdat ),0), 2) || SalNumberToStrX(SalDateDay( dtVdat ),0) || strLCV || SalNumberToStrX( nSum2, nDig )
.head 10 +          If (nSum2 = SalNumberRound( nSum2 )) AND (nDig = 0)
.head 11 -          Set str32 = str32 || ","
.head 10 -  ! Message bodiES
.head 10 -          Call Add1(1, "32", str32)
.head 10 -          Call Add1(1, "50", str50)
.head 10 -          Call Add1(1, "59", str59)
.head 10 -          Call Add1(1, "70", str70)
.head 10 -          Call Add1(1, "71", str71)
.head 10 -          Call Add1(1, "72", str72)
.head 10 -  !
.head 10 -          Call Add1(2, "32", str32)
.head 10 -          Call Add1(2, "50", str50)
.head 10 -          Call Add1(2, "59", str59)
.head 10 -          Call Add1(2, "70", str70)
.head 10 -          Call Add1(2, "71", str71)
.head 10 -          Call Add1(2, "72", str72)
.head 10 -  !
.head 10 -          Call Add1(1,"#1 MT", "100")
.head 10 -          Call Add1(1,"#2 FROM", strRoute0)
.head 10 -          Call Add1(1,"20", "MT100/01/" || tblMessages.colTRN)
.head 10 -          Set strResult[0,1,1] = "YES"
.head 10 -  !
.head 10 -          Call Add1(2, "#1 MT", "202")
.head 10 -          Call Add1(2, "#2 FROM", strRoute0)
.head 10 -          Call Add1(2, "20", "MT202/01/" || tblMessages.colTRN)
.head 10 -          Call Add1(2, "21", "MT100/01/" || tblMessages.colTRN)
.head 10 -          Set strResult[0,1,2] = "YES"
.head 10 +          If (strRoute1 = "") AND (strRoute2 = "") AND (strRoute3="")
.head 11 +          If strDestbicPay = strDestbicContr
.head 12 -          Call SalMessageBox("банк корр. счёта == банк получателя ==> только MT100", "info", MB_Ok)
.head 12 -          Call Add1(1,"TO", strRoute9)
.head 12 -          Set strResult[0,1,2] = "NO"
.head 11 +          Else 
.head 12 -          Call SalMessageBox("Указан прямой путь, но банк корр. счёта != банк получателя", "Ошибка", MB_Ok)
.head 12 -          Set strResult[0,1,1] = "NO"
.head 12 -          Set strResult[0,1,2] = "NO"
.head 10 +  ! Else If (strRoute1 = "") AND (strRoute2 = "") AND (strRoute3="")
.head 11 +          If bAuthRoute9                      ! проверка наличия ключа с банком клиента
.head 12 -          Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 12 -          Call Add1(1, "#3 TO: ", strRoute9)
.head 12 -          Call Add1(1, ":53:", strDestbicPay)
.head 12 -          Call Add1(2, "#3 TO: ", strDestbicPay)
.head 11 +          Else
.head 12 -          Call SalMessageBox("банк получателя НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк коррсчёта", "info", MB_Ok)
.head 12 -          Set strResult[0,1,2] = "NO"
.head 12 -          Call Add1(1, "#3 TO: ", strDestbicPay)
.head 12 -          Call Add1(1, ":57:", strRoute9)
.head 10 +          Else If (strRoute2 = "") AND (strRoute3="")
.head 11 +          If strDestbicPay = strRoute1
.head 12 +          If bAuthRoute9                      ! проверка наличия ключа с банком клиента
.head 13 -          Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call Add1(2, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(2, "57", strRoute9)
.head 12 +  ! Else If bAuthRoute1                       ! проверка наличия ключа с банком #1
.head 13 -          Call SalMessageBox("банк получателя не авторизован, банк #1 авторизован ==> MT100 в #1", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO: ", strRoute1)
.head 13 -          Call Add1(1, ":53:", strRoute1)
.head 13 -          Call Add1(1, ":57:", strRoute9)
.head 13 -          Call Add1(2, "#3 TO: ", strDestbicPay)
.head 13 -          Call Add1(2, ":57:", strRoute9)
.head 12 +          Else 
.head 13 -  ! Call SalMessageBox("банк получателя НЕ авторизован, банк #1 НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк корр. счёта", "info", MB_Ok)
.head 13 -          Call SalMessageBox("банк получателя не авторизован, банк #1 авторизован ==> только MT100 в #1", "info", MB_Ok)
.head 13 -          Set strResult[0,1,2] = "NO"
.head 13 -          Call Add1(1, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(1, "57", strRoute9)
.head 11 +          Else 
.head 12 -          Call SalMessageBox("Указан путь #1, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 12 -          Set strResult[0,1,1] = "NO"
.head 12 -          Set strResult[0,1,2] = "NO"
.head 10 +          Else If (strRoute3="")
.head 11 +          If strDestbicPay = strRoute1
.head 12 +          If bAuthRoute9                      ! проверка наличия ключа с банком клиента
.head 13 -          Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call Add1(1, "54", strRoute2)
.head 13 -          Call Add1(2, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(2, "57", strRoute2)
.head 13 -          Call Add1(2, "58", strRoute9)
.head 12 +          Else If bAuthRoute2
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, но авторизован транзитный банк #2 ==> MT100 в #2", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute2)
.head 13 -          Call Add1(1, "57", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call SalMessageBox("Здесь я не знаю, что надо писать в MT202", "info", MB_Ok)
.head 12 +  ! Else If bAuthRoute1
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, банк #2 НЕ авторизован, но авторизован транзитный банк #1 ==> MT100 в #1", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO: ", strRoute2)
.head 13 -          Call Add1(1, ":57A:", strRoute9)
.head 13 -          Call Add1(1, ":53A:", strRoute1)
.head 13 -          Call SalMessageBox("Здесь я не знаю, что надо писать в MT202", "info", MB_Ok)
.head 12 +          Else 
.head 13 -  ! Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #2 НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк коррсчёта", "info", MB_Ok)
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, банк #2 НЕ авторизован, но авторизован транзитный банк #1 ==> только MT100 в #1", "info", MB_Ok)
.head 13 -          Set strResult[0,1,2] = "NO"
.head 13 -          Call Add1(1, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(1, "56", strRoute2)
.head 13 -          Call Add1(1, "57", strRoute9)
.head 11 +          Else 
.head 12 -          Call SalMessageBox("Указан путь #2, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 12 -          Set strResult[0,1,1] = "NO"
.head 12 -          Set strResult[0,1,2] = "NO"
.head 10 +          Else 
.head 11 +          If strDestbicPay = strRoute1
.head 12 +          If bAuthRoute9                      ! проверка наличия ключа с банком клиента
.head 13 -          Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call Add1(1, "54", strRoute2)
.head 13 -          Call Add1(1, "72", "/RCB:/" || strRoute2)
.head 13 -          Call Add1(2, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(2, "56", strRoute2)
.head 13 -          Call Add1(2, "57", strRoute3)
.head 13 -          Call Add1(2, "58", strRoute9)
.head 12 +          Else If bAuthRoute3
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, но авторизован транзитный банк #3 ==> MT100 в #3", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute3)
.head 13 -          Call Add1(1, "57", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call Add1(1, "54", strRoute2)
.head 13 -          Call Add1(2, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(2, "56", strRoute2)
.head 13 -          Call Add1(2, "57", strRoute3)
.head 13 -          Call Add1(2, "58", strRoute9)
.head 12 +          Else If bAuthRoute2
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #3 НЕ авторизован, но авторизован транзитный банк #2 ==>  MT100 в #2", "info", MB_Ok)
.head 13 -          Call Add1(1, "#3 TO", strRoute2)
.head 13 -          Call Add1(1, "57", strRoute9)
.head 13 -          Call Add1(1, "53", strRoute1)
.head 13 -          Call Add1(1, "56", strRoute3)
.head 13 -          Call Add1(2, "#3 TO", strDestbicPay)
.head 13 -          Call Add1(2, "56", strRoute2)
.head 13 -          Call Add1(2, "57", strRoute3)
.head 13 -          Call Add1(2, "58", strRoute9)
.head 12 +          Else 
.head 13 -          Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #3 НЕ авторизован,  транзитный банк #2 НЕ авторизован ==> только MT100 в #1", "info", MB_Ok)
.head 13 -          Set strResult[0,1,2] = "NO"
.head 13 -          Call Add1(1, "#3 TO", strRoute1)
.head 13 -          Call Add1(1, "56", strRoute2)
.head 13 -          Call Add1(1, "57", strRoute3)
.head 13 +          If str72 != ""
.head 14 -          Set str72 = "/RCB:/" || strRoute9 || "
" || str72
.head 13 +          Else 
.head 14 -          Set str72 = "/RCB:/" || strRoute9
.head 13 -          Call Kill1(1, "72")
.head 13 -          Call Add1(1, "72",  str72)
.head 11 +          Else 
.head 12 -          Call SalMessageBox("Указан путь #3, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 12 -          Set strResult[0,1,1] = "NO"
.head 12 -          Set strResult[0,1,2] = "NO"
.head 10 -  !
.head 10 +          If strResult[0,1,1] = "YES"
.head 11 -          Set nRow = 1
.head 11 +          Loop !                                              Sort array1
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 13 -          Break 
.head 12 +          If strResult[nRow,0,1] > strResult[nRow+1,0,1]
.head 13 -          Set strDebug = strResult[nRow+1,0,1]
.head 13 -          Set strResult[nRow+1,0,1] = strResult[nRow,0,1]
.head 13 -          Set strResult[nRow,0,1] = strDebug
.head 13 -  !
.head 13 -          Set strDebug = strResult[nRow+1,1,1]
.head 13 -          Set strResult[nRow+1,1,1] = strResult[nRow,1,1]
.head 13 -          Set strResult[nRow,1,1] = strDebug
.head 13 +          If nRow > 1
.head 14 -          Set nRow = nRow-2
.head 12 -          Set nRow = nRow+1
.head 11 -          Set nRow = 1
.head 11 -          Set strDebug=""
.head 11 +          Loop !                                              Display array2
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,1])
.head 13 -          Break 
.head 12 -          Set strDebug = strDebug || "
" || strResult[nRow, 0,1] || " " || strResult[nRow, 1,1]
.head 12 -          Set nRow = nRow+1
.head 11 -          Call SalMessageBox(strDebug, "Debug 1st msg", MB_Ok)
.head 11 -          Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x0000)
.head 11 -          Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x0002)
.head 11 -          Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x000F)
.head 10 -  !
.head 10 +          If strResult[0,1,2] = "YES"
.head 11 -          Set nRow = 1
.head 11 +          Loop !                                               Sort array2
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 13 -          Break 
.head 12 +          If strResult[nRow,0,2] > strResult[nRow+1,0,2]
.head 13 -          Set strDebug = strResult[nRow+1,0,2]
.head 13 -          Set strResult[nRow+1,0,2] = strResult[nRow,0,2]
.head 13 -          Set strResult[nRow,0,2] = strDebug
.head 13 -  !
.head 13 -          Set strDebug = strResult[nRow+1,1,2]
.head 13 -          Set strResult[nRow+1,1,2] = strResult[nRow,1,2]
.head 13 -          Set strResult[nRow,1,2] = strDebug
.head 13 +          If nRow > 1
.head 14 -          Set nRow = nRow-2
.head 12 -          Set nRow = nRow+1
.head 11 -          Set nRow = 1
.head 11 -          Set strDebug=""
.head 11 +          Loop !                                              Display array2
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,2])
.head 13 -          Break 
.head 12 -          Set strDebug = strDebug || "
" || strResult[nRow, 0,2] || " " || strResult[nRow, 1,2]
.head 12 -          Set nRow = nRow+1
.head 11 -          Call SalMessageBox(strDebug, "Debug 2nd msg", MB_Ok)
.head 11 -          Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 2, 0x0000)
.head 10 -  !
.head 10 -  ! Проверка, все ли необходимые поля есть в массиве 1
.head 10 -  !
.head 10 +          If strResult[0,1,1] = "YES"
.head 11 -          Set strSQL = "SELECT tag, opt
FROM sw_rules
INTO :strTag, :strOpt
WHERE mt = " || strResult[1,1,1]
.head 11 -          Call SqlPrepareAndExecute( hSql(), strSQL)
.head 11 +          Loop Fields
.head 12 -          Call SqlFetchNext( hSql(), nRet )
.head 12 +          If nRet = FETCH_EOF
.head 13 -          Break Fields
.head 12 -          Set nRow = 1
.head 12 +          Loop Marker
.head 13 +          If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 14 +          If strOpt = "M"
.head 15 -          Call SalMessageBox("Поле "|| strTag || " объявлено обязательным для MT" || strResult[1,1,1] || ", но отсутствует в массиве - продолжение невозможно.", "Ошибка", MB_Ok)
.head 14 +          Else 
.head 15 -          Call SalMessageBox("Поле "|| strTag || " объявлено необязательным для MT" || strResult[1,1,1] || ", отсутствует в массиве - продолжаем.", "Предупреждение", MB_Ok)
.head 14 -          Break 
.head 13 +          If strResult[nRow,0,1] = strTag
.head 14 -          Set strResult[nRow,2,1] = "YES"
.head 14 -          Break Marker
.head 13 -          Set nRow = nRow+1
.head 11 -          Set nRow = 1
.head 11 +          Loop 
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 13 -          Break 
.head 12 +          If (strResult[nRow,2,1] != "YES") AND (SalStrLeftX( strResult[nRow,0,1], 1 ) !="#")
.head 13 -          Call SalMessageBox("Поле "|| strResult[nRow,0,1] || " не объявлено для MT" || strResult[1,1,1] || ", но присутствует в массиве - удаляем.", "Ошибка", MB_Ok)
.head 12 -          Set nRow = nRow+1
.head 10 -  !
.head 10 -  ! Проверка, все ли необходимые поля есть в массиве 2
.head 10 -  !
.head 10 +          If strResult[0,1,2] = "YES"
.head 11 -          Set strSQL = "SELECT tag, opt
FROM sw_rules
INTO :strTag, :strOpt
WHERE mt = " || strResult[1,1,2]
.head 11 -          Call SqlPrepareAndExecute( hSql(), strSQL)
.head 11 +          Loop Fields
.head 12 -          Call SqlFetchNext( hSql(), nRet )
.head 12 +          If nRet = FETCH_EOF
.head 13 -          Break Fields
.head 12 -          Set nRow = 1
.head 12 +          Loop Marker
.head 13 +          If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 14 +          If strOpt = "M"
.head 15 -          Call SalMessageBox("Поле "|| strTag || " объявлено обязательным для MT" || strResult[1,1,2] || ", но отсутствует в массиве - продолжение невозможно.", "Ошибка", MB_Ok)
.head 14 +          Else 
.head 15 -          Call SalMessageBox("Поле "|| strTag || " объявлено необязательным для MT" || strResult[1,1,2] || ", отсутствует в массиве - продолжаем.", "Предупреждение", MB_Ok)
.head 14 -          Break 
.head 13 +          If strResult[nRow,0,2] = strTag
.head 14 -          Set strResult[nRow,2,2] = "YES"
.head 14 -          Break Marker
.head 13 -          Set nRow = nRow+1
.head 11 -          Set nRow = 1
.head 11 +          Loop 
.head 12 +          If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 13 -          Break 
.head 12 +          If (strResult[nRow,2,2] != "YES") AND (SalStrLeftX( strResult[nRow,0,2], 1 ) !="#")
.head 13 -          Call SalMessageBox("Поле "|| strResult[nRow,0,2] || " не объявлено для MT" || strResult[1,1,2] || ", но присутствует в массиве - удаляем.", "Предупреждение", MB_Ok)
.head 12 -          Set nRow = nRow+1
.head 7 +          Else 
.head 8 -          Call SqlCommitEx( hSql(), 'CNTR00000:  ')
.head 8 -          Break 
.head 6 -  ! Call SalEndDialog( hWndForm, 0 )
.head 5 +  On SAM_Click
.head 6 -  Set nRow2 = TBL_MinRow
.head 6 +  If SalTblFindNextRow ( tblMessages, nRow2, ROW_Selected, 0 )
.head 7 -  ! ----------- Наш BIC
.head 7 -  Set strFrom = GetGlobalOption( "BICCODE" )
.head 7 -  Call SqlPrepareAndExecute (hSql(), T(
  "SELECT tag,value INTO :strTag,:strValue FROM operw 
   WHERE ref=:tblMessages.colRef 
     AND tag in ('50','57','59','70','71','72','NOS_B')"))
.head 7 +  While SqlFetchNext (hSql(), nRet)
.head 8 -  Set strTag=SalStrTrimX( strTag )
.head 8 -  Set strValue=SalStrTrimX( strValue )
.head 8 +  If strTag='50'
.head 9 -  Set str50 = StrWintToVolapjukX( strValue )
.head 8 +  If strTag='57'
.head 9 -  Set str57 = strValue
.head 9 -  Set strTo = strValue
.head 8 +  If strTag='59'
.head 9 -  Set str59 = StrWintToVolapjukX( strValue )
.head 8 +  If strTag='70'
.head 9 -  ! Здесь надо /RFB/
.head 9 -  Set str70 = StrWintToVolapjukX( strValue )
.head 8 +  If strTag='71'
.head 9 -  Set str71 = strValue
.head 8 +  If strTag='72'
.head 9 -  Set str72 = StrWintToVolapjukX( strValue )
.head 8 +  If strTag='NOS_B'
.head 9 -  Set strNostro = strValue
.head 8 -  ! Call Debug(strTag||':'||strValue)
.head 7 -  ! ----------- Банк-NOSTRO
.head 7 +  If strNostro
.head 8 -  ! ----------- Банк-получатель
.head 8 +  If strTo
.head 9 -  ! ===== Выбираем путь и метод отправки свифтовки
.head 9 +  If SalModalDialog( dlg_FindSWIFTpath, hWndForm,tblMessages.colRef,
         strFrom, strTo, strNostro, strRoute0, strRoute1, strRoute2 )
.head 10 -  ! ======= Выбрали путь, теперь пишем свифтовки
.head 10 -  ! Call Debug('FROM:'||strFrom||PutCrLf()||
             'TO:'||strTo||PutCrLf()||
         'Route0:'||strRoute0||PutCrLf()||
         'Route1:'||strRoute1||PutCrLf()||
         'Route2:'||strRoute2)
.head 10 +  If strRoute0 = strTo
.head 11 +  If strRoute0 = strNostro
.head 12 -  ! 1) МТ100 в банк получателя, который является банком НОСТРО
.head 12 -  Set strDebug = 'MT100 ->'||strNostro
.head 12 -  Set nSwRef1 = PutInJou(100,strFrom,strNostro,tblMessages.colLcv,tblMessages.colInvS,tblMessages.colRef)
.head 11 +  Else
.head 12 -  ! 3) ===== Метод покрытия:
.head 12 -  ! МТ100 в банк получателя
.head 12 -  ! MT202 в банк держатель нашего счета НОСТРО
.head 12 -  Set strDebug = 'MT100 ->'||strRoute0 || 'MT202 ->'||strNostro
.head 12 -  Set nSwRef1 = PutInJou(100,strFrom,strRoute0,tblMessages.colLcv,tblMessages.colInvS,tblMessages.colRef)
.head 12 -  Call PutSwTag(nSwRef1,'53','A',53,'A',strNostro)
.head 12 -  Set nSwRef2 = PutInJou(202,strFrom,strNostro,tblMessages.colLcv,tblMessages.colInvS,tblMessages.colRef)
.head 12 -  Call PutSwTag(nSwRef2,'58','A',58,'A',strRoute0)
.head 10 +  Else
.head 11 -  ! ==== Последовательный метод 
.head 11 -  Set strDebug = 'MT100->'||strRoute0
.head 11 -  Set nSwRef1 = PutInJou(100,strFrom,strRoute0,tblMessages.colLcv,tblMessages.colInvS,tblMessages.colRef)
.head 11 +  If strRoute1
.head 12 -  ! 4) Два посредника (МТ100, 56+57)
.head 12 -  Set strDebug = strDebug ||':56:'||strRoute1
.head 12 -  Call PutSwTag(nSwRef1,'56','A',56,'A',strRoute1)
.head 11 +  If strRoute2
.head 12 -  ! 2) Один посредник (MT100, 57)
.head 12 -  Set strDebug = strDebug ||':57:'||strRoute2
.head 12 -  Call PutSwTag(nSwRef1,'57','A',57,'A',strRoute2)
.head 10 -  ! Кусок куска Сивякова
.head 10 +  While TRUE
.head 11 -  Set nSum2 = tblMessages.colInvS/SalNumberPower( 10, tblMessages.colInvDig )
.head 11 -  Set nSum3 = SalNumberMod( tblMessages.colInvS, SalNumberPower( 10, tblMessages.colInvDig ) )
.head 11 -  Set str32 = SalFmtFormatDateTime(tblMessages.colVdat,'yyMMdd' ) || tblMessages.colLcv || 
            SalNumberToStrX( nSum2, 0 )||','
.head 11 +  If nSum3
.head 12 -  Set str32 = str32 || SalStrRightX('00000'||SalNumberToStrX( nSum3, 0 ),tblMessages.colInvDig)
.head 11 +  If nSwRef1
.head 12 -  Call PutSwTag(nSwRef1,'20','A',20,'',SalNumberToStrX( nSwRef1, 0 )||'/'||SalNumberToStrX( tblMessages.colRef, 0 ))
.head 12 -  Call PutSwTag(nSwRef1,'32','A',32,'A',str32)
.head 12 -  Call PutSwTag(nSwRef1,'50','A',50,'',str50)
.head 12 -  Call PutSwTag(nSwRef1,'59','A',59,'',str59)
.head 12 +  If str71='OUR'   ! Default BEN
.head 13 -  Call PutSwTag(nSwRef1,'71','A',71,'A',str71)
.head 12 +  If str72
.head 13 -  Call PutSwTag(nSwRef1,'72','A',72,'A',str72)
.head 11 +  If nSwRef2
.head 12 -  Call PutSwTag(nSwRef2,'20','A',20,'',SalNumberToStrX( nSwRef2, 0 )||'/'||SalNumberToStrX( tblMessages.colRef, 0 ))
.head 12 -  Call PutSwTag(nSwRef2,'21','A',21,'',SalNumberToStrX( nSwRef1, 0 )||'/'||SalNumberToStrX( tblMessages.colRef, 0 ))
.head 12 -  Call PutSwTag(nSwRef2,'32','A',32,'A',str32)
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call tblMessages.Refresh(  )
.head 11 -  Break
.head 11 +  ! If SqlFetchNext( hSql(), nFetchRes )
.head 12 -         Call SqlPrepareAndExecute (hSql(), 
'SELECT c.bic INTO :strDestbicPay
   FROM oper a, accounts d, cust_acc b, custbank c
  WHERE a.nlsb=d.nls AND b.acc=d.acc AND a.kv=d.kv AND c.rnk=b.rnk
                     AND a.ref=:tblMessages.colTRN')
.head 12 +         If SqlFetchNext( hSql(), nRet )
.head 13 -  ! Получаем значения из OPERW
.head 13 -         Call SqlPrepareAndExecute (hSql(),
'SELECT a.tag, a.value INTO :strTag, :strValue
 FROM operw a 
 WHERE ref=:tblMessages.colTRN')
.head 13 +         While SqlFetchNext( hSql(), nRet )
.head 14 +         If strTag = "20"
.head 15 -         Set str20 = strValue
.head 14 +         If strTag = "ROUT0"
.head 15 -         Set strRoute0 = strValue
.head 14 +         If strTag = "ROUT1"
.head 15 -         Set strRoute1 = strValue
.head 14 +         If strTag = "ROUT2"
.head 15 -         Set strRoute2 = strValue
.head 14 +         If strTag = "ROUT3"
.head 15 -         Set strRoute3 = strValue
.head 14 +         If strTag = "ROUT9"
.head 15 -         Set strRoute9 = strValue
.head 14 +         If strTag = "50"
.head 15 -         Set str50 = strValue
.head 14 +         If strTag = "57"
.head 15 -         Set strDestbicContr = strValue
.head 14 +         If strTag = "59"
.head 15 -         Set str59 = strValue
.head 14 +         If strTag = "70"
.head 15 -         Set str70 = strValue
.head 14 +         If strTag = "71"
.head 15 -         Set str71 = strValue
.head 14 +         If strTag = "72"
.head 15 -         Set str72 = strValue
.head 13 -         Call SqlPrepareAndExecute (hSql(),
'SELECT bic FROM sw_auth INTO :strAuth1 WHERE bic=:strRoute1')
.head 13 -         Call SqlFetchNext( hSql(), nRet )
.head 13 +         If strAuth1 != ""
.head 14 -         Set bAuthRoute1 = TRUE
.head 13 -         Call SqlPrepareAndExecute (hSql(),
'SELECT bic FROM sw_auth INTO :strAuth2 WHERE bic=:strRoute2')
.head 13 -         Call SqlFetchNext( hSql(), nRet )
.head 13 +         If strAuth2 != ""
.head 14 -         Set bAuthRoute2 = TRUE
.head 13 -         Call SqlPrepareAndExecute (hSql(),
'SELECT bic FROM sw_auth INTO :strAuth3 WHERE bic=:strRoute3')
.head 13 -         Call SqlFetchNext( hSql(), nRet )
.head 13 +         If strAuth3 != ""
.head 14 -         Set bAuthRoute3 = TRUE
.head 13 -  !
.head 13 -         Set strSQL = 
.head 13 -         Call SqlPrepareAndExecute (hSql(),
'SELECT bic FROM sw_auth INTO :strAuth9 WHERE bic=:strRoute9')
.head 13 -         Call SqlFetchNext( hSql(), nRet )
.head 13 +         If strAuth9 != ""
.head 14 -         Set bAuthRoute9 = TRUE
.head 13 -  !
.head 13 -         Set strSQL = 'SELECT bic FROM sw_auth INTO :strAuthPay WHERE bic=:strDestbicPay'
.head 13 -         Call SqlPrepareAndExecute (hSql(), strSQL)
.head 13 -         Call SqlFetchNext( hSql(), nRet )
.head 13 +         If strAuthPay != ""
.head 14 -         Set bAuthPay = TRUE
.head 13 -  !
.head 13 +         If bAuthPay = FALSE
.head 14 -         Call SalMessageBox("CNTR00000: Банк, в котором расположен корр. счёт, не авторизован! Отбор этого сообщения невозможен.", "Ошибка", MB_Ok)
.head 14 -         Break 
.head 13 -         Set nSum2 = nSum/SalNumberPower( 10, nDig )
.head 13 -         Set str32 = SalNumberToStrX(SalDateYear( dtVdat )-1900, 0) || SalStrRightX( "00" || SalNumberToStrX(SalDateMonth( dtVdat ),0), 2) || SalNumberToStrX(SalDateDay( dtVdat ),0) || strLCV || SalNumberToStrX( nSum2, nDig )
.head 13 +         If (nSum2 = SalNumberRound( nSum2 )) AND (nDig = 0)
.head 14 -         Set str32 = str32 || ","
.head 13 -  ! Message bodiES
.head 13 -         Call Add1(1, "32", str32)
.head 13 -         Call Add1(1, "50", str50)
.head 13 -         Call Add1(1, "59", str59)
.head 13 -         Call Add1(1, "70", str70)
.head 13 -         Call Add1(1, "71", str71)
.head 13 -         Call Add1(1, "72", str72)
.head 13 -  !
.head 13 -         Call Add1(2, "32", str32)
.head 13 -         Call Add1(2, "50", str50)
.head 13 -         Call Add1(2, "59", str59)
.head 13 -         Call Add1(2, "70", str70)
.head 13 -         Call Add1(2, "71", str71)
.head 13 -         Call Add1(2, "72", str72)
.head 13 -  !
.head 13 -         Call Add1(1,"#1 MT", "100")
.head 13 -         Call Add1(1,"#2 FROM", strRoute0)
.head 13 -         Call Add1(1,"20", "MT100/01/" || tblMessages.colTRN)
.head 13 -         Set strResult[0,1,1] = "YES"
.head 13 -  !
.head 13 -         Call Add1(2, "#1 MT", "202")
.head 13 -         Call Add1(2, "#2 FROM", strRoute0)
.head 13 -         Call Add1(2, "20", "MT202/01/" || tblMessages.colTRN)
.head 13 -         Call Add1(2, "21", "MT100/01/" || tblMessages.colTRN)
.head 13 -         Set strResult[0,1,2] = "YES"
.head 13 +         If (strRoute1 = "") AND (strRoute2 = "") AND (strRoute3="")
.head 14 +         If strDestbicPay = strDestbicContr
.head 15 -         Call SalMessageBox("банк корр. счёта == банк получателя ==> только MT100", "info", MB_Ok)
.head 15 -         Call Add1(1,"TO", strRoute9)
.head 15 -         Set strResult[0,1,2] = "NO"
.head 14 +         Else 
.head 15 -         Call SalMessageBox("Указан прямой путь, но банк корр. счёта != банк получателя", "Ошибка", MB_Ok)
.head 15 -         Set strResult[0,1,1] = "NO"
.head 15 -         Set strResult[0,1,2] = "NO"
.head 13 +  ! Else If (strRoute1 = "") AND (strRoute2 = "") AND (strRoute3="")
.head 14 +          If bAuthRoute9                      ! проверка наличия ключа с банком клиента
.head 15 -          Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 15 -          Call Add1(1, "#3 TO: ", strRoute9)
.head 15 -          Call Add1(1, ":53:", strDestbicPay)
.head 15 -          Call Add1(2, "#3 TO: ", strDestbicPay)
.head 14 +          Else
.head 15 -          Call SalMessageBox("банк получателя НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк коррсчёта", "info", MB_Ok)
.head 15 -          Set strResult[0,1,2] = "NO"
.head 15 -          Call Add1(1, "#3 TO: ", strDestbicPay)
.head 15 -          Call Add1(1, ":57:", strRoute9)
.head 13 +         Else If (strRoute2 = "") AND (strRoute3="")
.head 14 +         If strDestbicPay = strRoute1
.head 15 +         If bAuthRoute9                       ! проверка наличия ключа с банком клиента
.head 16 -         Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call Add1(2, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(2, "57", strRoute9)
.head 15 +  ! Else If bAuthRoute1                       ! проверка наличия ключа с банком #1
.head 16 -          Call SalMessageBox("банк получателя не авторизован, банк #1 авторизован ==> MT100 в #1", "info", MB_Ok)
.head 16 -          Call Add1(1, "#3 TO: ", strRoute1)
.head 16 -          Call Add1(1, ":53:", strRoute1)
.head 16 -          Call Add1(1, ":57:", strRoute9)
.head 16 -          Call Add1(2, "#3 TO: ", strDestbicPay)
.head 16 -          Call Add1(2, ":57:", strRoute9)
.head 15 +         Else 
.head 16 -  ! Call SalMessageBox("банк получателя НЕ авторизован, банк #1 НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк корр. счёта", "info", MB_Ok)
.head 16 -         Call SalMessageBox("банк получателя не авторизован, банк #1 авторизован ==> только MT100 в #1", "info", MB_Ok)
.head 16 -         Set strResult[0,1,2] = "NO"
.head 16 -         Call Add1(1, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(1, "57", strRoute9)
.head 14 +         Else 
.head 15 -         Call SalMessageBox("Указан путь #1, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 15 -         Set strResult[0,1,1] = "NO"
.head 15 -         Set strResult[0,1,2] = "NO"
.head 13 +         Else If (strRoute3="")
.head 14 +         If strDestbicPay = strRoute1
.head 15 +         If bAuthRoute9                       ! проверка наличия ключа с банком клиента
.head 16 -         Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call Add1(1, "54", strRoute2)
.head 16 -         Call Add1(2, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(2, "57", strRoute2)
.head 16 -         Call Add1(2, "58", strRoute9)
.head 15 +         Else If bAuthRoute2
.head 16 -         Call SalMessageBox("банк получателя НЕ авторизован, но авторизован транзитный банк #2 ==> MT100 в #2", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute2)
.head 16 -         Call Add1(1, "57", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call SalMessageBox("Здесь я не знаю, что надо писать в MT202", "info", MB_Ok)
.head 15 +  ! Else If bAuthRoute1
.head 16 -          Call SalMessageBox("банк получателя НЕ авторизован, банк #2 НЕ авторизован, но авторизован транзитный банк #1 ==> MT100 в #1", "info", MB_Ok)
.head 16 -          Call Add1(1, "#3 TO: ", strRoute2)
.head 16 -          Call Add1(1, ":57A:", strRoute9)
.head 16 -          Call Add1(1, ":53A:", strRoute1)
.head 16 -          Call SalMessageBox("Здесь я не знаю, что надо писать в MT202", "info", MB_Ok)
.head 15 +         Else 
.head 16 -  ! Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #2 НЕ авторизован ==> указанный путь MT100-шки игнорирется, отправляем только MT100 в банк коррсчёта", "info", MB_Ok)
.head 16 -         Call SalMessageBox("банк получателя НЕ авторизован, банк #2 НЕ авторизован, но авторизован транзитный банк #1 ==> только MT100 в #1", "info", MB_Ok)
.head 16 -         Set strResult[0,1,2] = "NO"
.head 16 -         Call Add1(1, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(1, "56", strRoute2)
.head 16 -         Call Add1(1, "57", strRoute9)
.head 14 +         Else 
.head 15 -         Call SalMessageBox("Указан путь #2, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 15 -         Set strResult[0,1,1] = "NO"
.head 15 -         Set strResult[0,1,2] = "NO"
.head 13 +         Else 
.head 14 +         If strDestbicPay = strRoute1
.head 15 +         If bAuthRoute9                       ! проверка наличия ключа с банком клиента
.head 16 -         Call SalMessageBox("банк получателя авторизован ==> MT100 напрямик", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call Add1(1, "54", strRoute2)
.head 16 -         Call Add1(1, "72", "/RCB:/" || strRoute2)
.head 16 -         Call Add1(2, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(2, "56", strRoute2)
.head 16 -         Call Add1(2, "57", strRoute3)
.head 16 -         Call Add1(2, "58", strRoute9)
.head 15 +         Else If bAuthRoute3
.head 16 -         Call SalMessageBox("банк получателя НЕ авторизован, но авторизован транзитный банк #3 ==> MT100 в #3", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute3)
.head 16 -         Call Add1(1, "57", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call Add1(1, "54", strRoute2)
.head 16 -         Call Add1(2, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(2, "56", strRoute2)
.head 16 -         Call Add1(2, "57", strRoute3)
.head 16 -         Call Add1(2, "58", strRoute9)
.head 15 +         Else If bAuthRoute2
.head 16 -         Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #3 НЕ авторизован, но авторизован транзитный банк #2 ==>  MT100 в #2", "info", MB_Ok)
.head 16 -         Call Add1(1, "#3 TO", strRoute2)
.head 16 -         Call Add1(1, "57", strRoute9)
.head 16 -         Call Add1(1, "53", strRoute1)
.head 16 -         Call Add1(1, "56", strRoute3)
.head 16 -         Call Add1(2, "#3 TO", strDestbicPay)
.head 16 -         Call Add1(2, "56", strRoute2)
.head 16 -         Call Add1(2, "57", strRoute3)
.head 16 -         Call Add1(2, "58", strRoute9)
.head 15 +         Else 
.head 16 -         Call SalMessageBox("банк получателя НЕ авторизован, транзитный банк #3 НЕ авторизован,  транзитный банк #2 НЕ авторизован ==> только MT100 в #1", "info", MB_Ok)
.head 16 -         Set strResult[0,1,2] = "NO"
.head 16 -         Call Add1(1, "#3 TO", strRoute1)
.head 16 -         Call Add1(1, "56", strRoute2)
.head 16 -         Call Add1(1, "57", strRoute3)
.head 16 +         If str72 != ""
.head 17 -         Set str72 = "/RCB:/" || strRoute9 || "
" || str72
.head 16 +         Else 
.head 17 -         Set str72 = "/RCB:/" || strRoute9
.head 16 -         Call Kill1(1, "72")
.head 16 -         Call Add1(1, "72",  str72)
.head 14 +         Else 
.head 15 -         Call SalMessageBox("Указан путь #3, но банк корр. счёта != банк #1", "Ошибка", MB_Ok)
.head 15 -         Set strResult[0,1,1] = "NO"
.head 15 -         Set strResult[0,1,2] = "NO"
.head 13 -  !
.head 13 +         If strResult[0,1,1] = "YES"
.head 14 -         Set nRow = 1
.head 14 +         Loop !                                               Sort array1
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 16 -         Break 
.head 15 +         If strResult[nRow,0,1] > strResult[nRow+1,0,1]
.head 16 -         Set strDebug = strResult[nRow+1,0,1]
.head 16 -         Set strResult[nRow+1,0,1] = strResult[nRow,0,1]
.head 16 -         Set strResult[nRow,0,1] = strDebug
.head 16 -  !
.head 16 -         Set strDebug = strResult[nRow+1,1,1]
.head 16 -         Set strResult[nRow+1,1,1] = strResult[nRow,1,1]
.head 16 -         Set strResult[nRow,1,1] = strDebug
.head 16 +         If nRow > 1
.head 17 -         Set nRow = nRow-2
.head 15 -         Set nRow = nRow+1
.head 14 -         Set nRow = 1
.head 14 -         Set strDebug=""
.head 14 +         Loop !                                               Display array2
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,1])
.head 16 -         Break 
.head 15 -         Set strDebug = strDebug || "
" || strResult[nRow, 0,1] || " " || strResult[nRow, 1,1]
.head 15 -         Set nRow = nRow+1
.head 14 -         Call SalMessageBox(strDebug, "Debug 1st msg", MB_Ok)
.head 14 -         Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x0000)
.head 14 -         Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x0002)
.head 14 -         Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 1, 0x000F)
.head 13 -  !
.head 13 +         If strResult[0,1,2] = "YES"
.head 14 -         Set nRow = 1
.head 14 +         Loop !                                                Sort array2
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 16 -         Break 
.head 15 +         If strResult[nRow,0,2] > strResult[nRow+1,0,2]
.head 16 -         Set strDebug = strResult[nRow+1,0,2]
.head 16 -         Set strResult[nRow+1,0,2] = strResult[nRow,0,2]
.head 16 -         Set strResult[nRow,0,2] = strDebug
.head 16 -  !
.head 16 -         Set strDebug = strResult[nRow+1,1,2]
.head 16 -         Set strResult[nRow+1,1,2] = strResult[nRow,1,2]
.head 16 -         Set strResult[nRow,1,2] = strDebug
.head 16 +         If nRow > 1
.head 17 -         Set nRow = nRow-2
.head 15 -         Set nRow = nRow+1
.head 14 -         Set nRow = 1
.head 14 -         Set strDebug=""
.head 14 +         Loop !                                               Display array2
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,2])
.head 16 -         Break 
.head 15 -         Set strDebug = strDebug || "
" || strResult[nRow, 0,2] || " " || strResult[nRow, 1,2]
.head 15 -         Set nRow = nRow+1
.head 14 -         Call SalMessageBox(strDebug, "Debug 2nd msg", MB_Ok)
.head 14 -         Call SalModalDialog(dlg_SWIFTEditor, hWndForm, nRef, strResult, 2, 0x0000)
.head 13 -  !
.head 13 -  ! Проверка, все ли необходимые поля есть в массиве 1
.head 13 -  !
.head 13 +         If strResult[0,1,1] = "YES"
.head 14 -         Set strSQL = "SELECT tag, opt
FROM sw_rules
INTO :strTag, :strOpt
WHERE mt = " || strResult[1,1,1]
.head 14 -         Call SqlPrepareAndExecute( hSql(), strSQL)
.head 14 +         Loop Fields
.head 15 -         Call SqlFetchNext( hSql(), nRet )
.head 15 +         If nRet = FETCH_EOF
.head 16 -         Break Fields
.head 15 -         Set nRow = 1
.head 15 +         Loop Marker
.head 16 +         If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 17 +         If strOpt = "M"
.head 18 -         Call SalMessageBox("Поле "|| strTag || " объявлено обязательным для MT" || strResult[1,1,1] || ", но отсутствует в массиве - продолжение невозможно.", "Ошибка", MB_Ok)
.head 17 +         Else 
.head 18 -         Call SalMessageBox("Поле "|| strTag || " объявлено необязательным для MT" || strResult[1,1,1] || ", отсутствует в массиве - продолжаем.", "Предупреждение", MB_Ok)
.head 17 -         Break 
.head 16 +         If strResult[nRow,0,1] = strTag
.head 17 -         Set strResult[nRow,2,1] = "YES"
.head 17 -         Break Marker
.head 16 -         Set nRow = nRow+1
.head 14 -         Set nRow = 1
.head 14 +         Loop 
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,1])-1
.head 16 -         Break 
.head 15 +         If (strResult[nRow,2,1] != "YES") AND (SalStrLeftX( strResult[nRow,0,1], 1 ) !="#")
.head 16 -         Call SalMessageBox("Поле "|| strResult[nRow,0,1] || " не объявлено для MT" || strResult[1,1,1] || ", но присутствует в массиве - удаляем.", "Ошибка", MB_Ok)
.head 15 -         Set nRow = nRow+1
.head 13 -  !
.head 13 -  ! Проверка, все ли необходимые поля есть в массиве 2
.head 13 -  !
.head 13 +         If strResult[0,1,2] = "YES"
.head 14 -         Set strSQL = "SELECT tag, opt
FROM sw_rules
INTO :strTag, :strOpt
WHERE mt = " || strResult[1,1,2]
.head 14 -         Call SqlPrepareAndExecute( hSql(), strSQL)
.head 14 +         Loop Fields
.head 15 -         Call SqlFetchNext( hSql(), nRet )
.head 15 +         If nRet = FETCH_EOF
.head 16 -         Break Fields
.head 15 -         Set nRow = 1
.head 15 +         Loop Marker
.head 16 +         If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 17 +         If strOpt = "M"
.head 18 -         Call SalMessageBox("Поле "|| strTag || " объявлено обязательным для MT" || strResult[1,1,2] || ", но отсутствует в массиве - продолжение невозможно.", "Ошибка", MB_Ok)
.head 17 +         Else 
.head 18 -         Call SalMessageBox("Поле "|| strTag || " объявлено необязательным для MT" || strResult[1,1,2] || ", отсутствует в массиве - продолжаем.", "Предупреждение", MB_Ok)
.head 17 -         Break 
.head 16 +         If strResult[nRow,0,2] = strTag
.head 17 -         Set strResult[nRow,2,2] = "YES"
.head 17 -         Break Marker
.head 16 -         Set nRow = nRow+1
.head 14 -         Set nRow = 1
.head 14 +         Loop 
.head 15 +         If nRow > SalStrToNumber(strResult[0,0,2])-1
.head 16 -         Break 
.head 15 +         If (strResult[nRow,2,2] != "YES") AND (SalStrLeftX( strResult[nRow,0,2], 1 ) !="#")
.head 16 -         Call SalMessageBox("Поле "|| strResult[nRow,0,2] || " не объявлено для MT" || strResult[1,1,2] || ", но присутствует в массиве - удаляем.", "Предупреждение", MB_Ok)
.head 15 -         Set nRow = nRow+1
.head 12 +         Else 
.head 13 -         Call SalMessageBox( "CNTR15002: Не найдена запись о банке в CUSTBANK: Документ-->СчётБ-->Банк", "Ошибка", MB_Ok )
.head 11 +  ! Else
.head 12 -         Call SalMessageBox( "CNTR15001: Не найдена запись в OPER", "Ошибка", MB_Ok )
.head 10 +  ! Else
.head 11 -          Call SqlCommitEx( hSql(), 'CNTR00000:  ')
.head 11 -          Break 
.head 10 -  ! Конец куска сивякова
.head 9 -  ! Call Debug ( strDebug )
.head 8 +  Else
.head 9 -  Call SalMessageBox( "CNTR15003: Не найдена информация о банке-получателе в OPERW!", "Ошибка", MB_Ok )
.head 7 +  Else
.head 8 -  Call SalMessageBox( "CNTR15002: Не найдена информация о NOSTRO-банке в OPERW!", "Ошибка", MB_Ok )
.head 6 +  Else
.head 7 -  Call SalMessageBox( "Выберите документ для отправки по SWIFT!", "Внимание!", MB_Ok )
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   2.986"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 2 +  Functions
.head 3 +  Function: Add1
.head 4 -  Description: Добавляет запись в массив #1
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMessageNumber
.head 5 -  String: strTag
.head 5 -  String: strValue
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set strResult[0,0,nMessageNumber] = SalNumberToStrX(SalStrToNumber(strResult[0,0,nMessageNumber]) + 1, 0)                    ! last element
.head 5 -  Set strResult[SalStrToNumber(strResult[0,0,nMessageNumber]), 0, nMessageNumber] = SalStrTrimX(strTag)
.head 5 -  Set strResult[SalStrToNumber(strResult[0,0,nMessageNumber]), 1, nMessageNumber] = VSStrTrim(strValue)
.head 3 +  Function: Kill1
.head 4 -  Description: Удаляет запись из массива #1
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMessageNumber
.head 5 -  String: strTag
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nMaxRow
.head 4 +  Actions
.head 5 -  Set nMaxRow = SalStrToNumber(strResult[0,0,nMessageNumber])
.head 5 -  Set nRow = 1
.head 5 +  While nRow <= nMaxRow
.head 6 +  If strResult[nRow, 0, nMessageNumber] = strTag
.head 7 -  Set strResult[nRow, 0, nMessageNumber] = ""
.head 6 -  Call Inc(nRow)
.head 3 +  Function: PutInJou
.head 4 -  Description: Вставка заголовка SWIFT в журнал  (MIK 13-12-1999)
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nMt
.head 5 -  String: sFrom
.head 5 -  String: sTo
.head 5 -  String: sLcv
.head 5 -  Number: nS
.head 5 -  Number: nRef
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSwRef
.head 4 +  Actions
.head 5 -  Set nSwRef = Get_SQ( "s_sw_journal" )
.head 5 -  Call SqlPrepareAndExecute( hSql(),T(
   "INSERT INTO sw_journal ( swref,mt,trn,io_ind,currency,sender,receiver,amount )
           VALUES ( :nSwRef,:nMt,:nSwRef,'I',:sLcv,:sFrom,:sTo,:nS )"))
.head 5 -  Set nSwRef = Read_SQ( nSwRef )
.head 5 -  Call SqlPrepareAndExecute( hSql(),T(
   "INSERT INTO sw_oper ( ref,swref ) VALUES ( :nRef,:nSwRef )"))
.head 5 -  Return nSwRef
.head 3 +  Function: PutSwTag
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nSwRef
.head 5 -  String: sSwTag
.head 5 -  String: sSwSeq
.head 5 -  Number: nSwRow
.head 5 -  String: sSwOpt
.head 5 -  String: sSwVal
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute( hSql(), T(
'INSERT INTO sw_operw(  swref, tag, seq, n, opt, value )
 VALUES ( :nSwRef, :sSwTag, :sSwSeq, :nSwRow, :sSwOpt, :sSwVal)') )
.head 2 +  Window Parameters
.head 3 -  ! String: strbic
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nRow2
.head 3 -  Number: nRet
.head 3 -  Number: nRef
.head 3 -  Date/Time: dtPdat
.head 3 -  Number: nkv
.head 3 -  Number: nSum
.head 3 -  Number: nSum3
.head 3 -  String: strNama
.head 3 -  String: strNlsa
.head 3 -  String: strNamb
.head 3 -  String: strNlsb
.head 3 -  String: strNazn
.head 3 -  !
.head 3 -  String: strFrom
.head 3 -  String: strTo
.head 3 -  String: strNostro
.head 3 -  !
.head 3 -  String: strOpt
.head 3 -  String: strTag
.head 3 -  String: strValue
.head 3 -  !
.head 3 -  String: str20
.head 3 -  String: str32
.head 3 -  String: str50
.head 3 -  String: str57
.head 3 -  String: str59
.head 3 -  String: str70
.head 3 -  String: str71
.head 3 -  String: str72
.head 3 -  String: strDestbicContr
.head 3 -  String: strDestbicPay
.head 3 -  !
.head 3 -  Date/Time: dtVdat
.head 3 -  Number: nDig
.head 3 -  String: strLCV
.head 3 -  Number: nSum2
.head 3 -  !
.head 3 -  String: strRoute0
.head 3 -  String: strRoute1
.head 3 -  String: strAuth1
.head 3 -  Boolean: bAuthRoute1
.head 3 -  String: strAuth2
.head 3 -  String: strRoute2
.head 3 -  Boolean: bAuthRoute2
.head 3 -  String: strRoute3
.head 3 -  String: strAuth3
.head 3 -  Boolean: bAuthRoute3
.head 3 -  String: strRoute9
.head 3 -  String: strAuth9
.head 3 -  Boolean: bAuthRoute9
.head 3 -  String: strAuthPay
.head 3 -  Boolean: bAuthPay
.head 3 -  !
.head 3 -  String: strResult[50, 0:2, 1:2]
.head 3 -  String: strResult2[50, 2, 1:2]
.head 3 -  String: strDebug
.head 3 -  !
.head 3 -  Number: nSwRef1   ! MT100 - ref
.head 3 -  Number: nSwRef2   ! MT202 - ref
.head 2 +  Message Actions
.head 3 +  ! On SAM_DoInit
.head 4 -          Call tblMessages.Init()
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 +  ! If strbic = ''
.head 5 -          Call SalDisableWindow( pbSelect )
.head 4 +  ! Else
.head 5 -          Call SalDisableWindow( pbView )
.head 5 -          Call SalSetDefButton( pbSelect )
.head 4 -  ! Call SalSendMsg(  hWndForm, SAM_DoInit, 0, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On SAM_Destroy
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' ShowSWIFTmessages()  ')
.head 1 +  Dialog Box: dlg_SWIFTkeys
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расширенные атрибуты документа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.333"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.583"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Расширенные атрибуты документа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: ОТ:
.head 4 -  Resource Id: 35215
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    0.179"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.155"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: К:
.head 4 -  Resource Id: 35216
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.883"
.head 5 -  Top:    0.179"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.155"
.head 6 -  Width:  3.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Ключ
.head 4 -  Resource Id: 35217
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.595"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Наименование
.head 4 -  Resource Id: 35218
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.083"
.head 5 -  Top:    0.595"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Значение
.head 4 -  Resource Id: 35219
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.883"
.head 5 -  Top:    0.595"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  !
.head 3 -  !
.head 3 +  Data Field: cmb20
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.821"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd20
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.821"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df20
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.821"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: cmb32
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.071"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd32
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    1.071"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df32
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    1.071"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb50
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.321"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd50
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    1.321"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: df50
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    1.321"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb52
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.988"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd52
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    1.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df52
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    1.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb53
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd53
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    2.238"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df53
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    2.238"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb54
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.488"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd54
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    2.488"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df54
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    2.488"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    2.738"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    2.738"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb57
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.988"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd57
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    2.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df57
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    2.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    3.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    3.238"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: df59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    3.238"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb70
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    3.988"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd70
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.1"
.head 6 -  Top:    4.0"
.head 6 -  Width:  3.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: df70
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    3.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb71
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    4.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd71
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    4.738"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df71
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    4.738"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: cmb72
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    4.988"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfd72
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.1"
.head 6 -  Top:    5.0"
.head 6 -  Width:  3.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: df72
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    4.988"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Group Box: Путь док.
.head 4 -  Resource Id: 35220
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.783"
.head 5 -  Top:    1.488"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbSwift
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S.W.I.F.T.
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    1.738"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbTelex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Телекс
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    1.988"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbFindSwiftPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbChilds
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Путь...
.head 4 -  Window Location and Size
.head 5 -  Left:   8.783"
.head 5 -  Top:    2.488"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog( dlg_FindSWIFTpath
, hWndForm
, nRef
, dfFrom
, dfTo
, strCorAcc
, strRoute0
, strRoute1
, strRoute2 )
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.75"
.head 5 -  Top:    4.512"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If (SalStrTrimX( df20 ) = "")
.head 7 -  Call SalGetWindowText( cmb20, str1, 50 )
.head 7 -  Call SalMessageBox( "CNTR08001: Поле " || str1 || " должно быть заполнено!", "Ошибка", MB_OK )
.head 6 +  Else
.head 7 +  If (SalStrTrimX( df32 ) = "")
.head 8 -  Call SalGetWindowText( cmb32, str1, 50 )
.head 8 -  Call SalMessageBox( "CNTR08002: Поле " || str1 || " должно быть заполнено!", "Ошибка", MB_OK )
.head 7 +  Else
.head 8 +  If (SalStrTrimX( df50 ) = "")
.head 9 -  Call SalGetWindowText( cmb50, str1, 50 )
.head 9 -  Call SalMessageBox( "CNTR08003: Поле " || str1 || " должно быть заполнено!", "Ошибка", MB_OK )
.head 8 +  Else
.head 9 +  If (SalStrTrimX( df59 ) = "")
.head 10 -  Call SalGetWindowText( cmb59, str1, 50 )
.head 10 -  Call SalMessageBox( "CNTR08004: Поле " || str1 || " должно быть заполнено!", "Ошибка", MB_OK )
.head 9 +  Else
.head 10 +  If (SalStrTrimX( df56 ) != "") & (SalStrTrimX( df57 ) = "")
.head 11 -  Call SalGetWindowText( cmb59, str1, 50 )
.head 11 -  Call SalMessageBox( "CNTR08005: Наличие поля 56 подразумевает, что поле :57: должно быть заполнено! (Error Code C81)", "Ошибка", MB_OK )
.head 10 +  Else
.head 11 +  If (df71 != "OUR") AND (df71 != "BEN")
.head 12 -  Call SalGetWindowText( cmb71, str1, 50 )
.head 12 -  Call SalMessageBox( "CNTR08006: Поле " || str1 || " должно быть заполнено значением BEN или OUR!", "Ошибка", MB_OK )
.head 11 +  Else
.head 12 +  ! If rbSwift AND ((strRoute0 = "") OR (strRoute9 = ""))
.head 13 -          Call SalMessageBox( "CNTR08010: Не выбран путь движения SWIFT-документа!", "Ошибка", MB_OK )
.head 12 +  ! Else
.head 13 +          If SalMessageBox( "CNTR08007: расширенные поля документа готовы к записи. Продолжать?", "Вопрос", MB_YesNo ) = IDYES
.head 14 -          Call SaveKeys( cmb20, df20 )
.head 14 -  ! Call SaveKeys( cmb32, df32 )
.head 14 -          Call SaveKeys( cmb50, df50 )
.head 14 -          Call SaveKeys( cmb52, df52 )
.head 14 -          Call SaveKeys( cmb53, df53 )
.head 14 -          Call SaveKeys( cmb54, df54 )
.head 14 -          Call SaveKeys( cmb56, df56 )
.head 14 -          Call SaveKeys( cmb57, df57 )
.head 14 -          Call SaveKeys( cmb59, df59 )
.head 14 -          Call SaveKeys( cmb70, df70 )
.head 14 -          Call SaveKeys( cmb71, df71 )
.head 14 -          Call SaveKeys( cmb72, df72 )
.head 14 -          Call SaveKeys( "ROUT0", strRoute0 )
.head 14 -          Call SaveKeys( "ROUT1", strRoute1 )
.head 14 -          Call SaveKeys( "ROUT2", strRoute2 )
.head 14 -          Call SaveKeys( "ROUT3", strRoute3 )
.head 14 -          Call SaveKeys( "ROUT9", strRoute9 )
.head 14 -          Call SqlCommitEx( hSql(), "Сохраняю расширенные поля" )
.head 14 -          Call SalEndDialog ( hWndForm, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.75"
.head 5 -  Top:    5.095"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( hWndForm, FALSE )
.head 6 -  ! Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 3 +  Pushbutton: pbHelp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.75"
.head 5 -  Top:    5.679"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SaveKeys
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: bRet
.head 4 +  Parameters
.head 5 -  String: strTag
.head 5 -  String: strValue
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set strSQL = 'DELETE FROM operw
WHERE (ref = :nRef) AND (tag = :strTag)'
.head 5 -  Call SqlPrepareAndExecute( hSql(), strSQL )
.head 5 -  Set strValue = SalStrTrimX( strValue )
.head 5 +  If strValue != ""
.head 6 -  Set strSQL = 'INSERT INTO operw
(ref, tag, value)
VALUES (:nRef, :strTag, :strValue)'
.head 6 -  Return SqlPrepareAndExecute( hSql(), strSQL )
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: Init
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfFrom = strFrom
.head 5 -  Set dfTo = strTo
.head 5 -  Set cmb20 = "20"
.head 5 -  Set dfd20 = "Наш Reference"
.head 5 -  Set df20 = SalNumberToStrX( nRef, 0)
.head 5 -  Set cmb32 = "32"
.head 5 -  Set dfd32 = "Value Date, Currency Code, Amount"
.head 5 -  Set nSum2 = nS/SalNumberPower( 10, nDig )
.head 5 -  Set df32 = SalStrRightX( SalNumberToStrX(SalDateYear( dtVdat ), 0),2) || SalStrRightX( "00" || SalNumberToStrX(SalDateMonth( dtVdat ),0), 2) || SalNumberToStrX(SalDateDay( dtVdat ),0) || strLCV || SalNumberToStrX( nSum2, nDig )
.head 5 +  If (nSum2 = SalNumberRound( nSum2 )) AND (nDig = 0)
.head 6 -  Set df32 = df32 || ","
.head 5 -  Set cmb50 = "50"
.head 5 -  Set dfd50 = "Плательщик"
.head 5 -  Set df50 =  strNMKV || "
" || strNMK || "
" || strNMKK || "
" || strSAB
.head 5 -  Set cmb52 = "52"
.head 5 -  Set dfd52 = "Банк плательщика"
.head 5 -  Set cmb53 = "53"
.head 5 -  Set dfd53 = "Корреспондент отправителя"
.head 5 -  Set cmb54 = "54"
.head 5 -  Set dfd54 = "Корреспондент получателя"
.head 5 -  Set cmb56 = "56"
.head 5 -  Set dfd56 = "Промежуточный банк"
.head 5 -  Set cmb57 = "57"
.head 5 -  Set dfd57 = "Банк получателя"
.head 5 -  Set cmb59 = "59"
.head 5 -  Set dfd59 = "Получатель (не банк)"
.head 5 -  Set df59 = strBenefAcc
.head 5 -  Set cmb70 = "70"
.head 5 -  Set dfd70 = "Подробности платежа"
.head 5 -  Set df70 = strNazn
.head 5 -  Set cmb71 = "71"
.head 5 -  Set dfd71 = "Подробности комиссии"
.head 5 -  Set df71 = strCommission
.head 5 -  Set cmb72 = "72"
.head 5 -  Set dfd72 = "Дополнительная информация"
.head 5 -  !
.head 5 -  Call UpdateField( cmb52, dfd52 )
.head 5 -  Call UpdateField( cmb53, dfd53 )
.head 5 -  Call UpdateField( cmb54, dfd54 )
.head 5 -  Call UpdateField( cmb56, dfd56 )
.head 5 -  Call UpdateField( cmb57, dfd57 )
.head 3 +  Function: UpdateField
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hwList
.head 5 -  Window Handle: hwData
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: str1
.head 5 -  String: str2
.head 5 -  Number: n1
.head 5 -  Number: n2
.head 4 +  Actions
.head 5 -  Call SalGetWindowText( hwData, str1, 50 )
.head 5 -  Set n1 = SalStrScan( str1, "(" )
.head 5 +  If n1 > 0
.head 6 -  Set str1 = SalStrLeftX( str1, n1-1)
.head 5 -  Call SalGetWindowText( hwList, str2, 50 )
.head 5 -  Set str2 = SalStrUpperX( SalStrMidX(str2, 3, 1) )
.head 5 -  Call SalStrFirstC( str2, n2 )
.head 5 +  Select Case n2
.head 6 +  Case 65
.head 7 -  Set str1 = str1 || " (BIC-код)"
.head 7 -  Break
.head 6 +  Case 66
.head 7 -  Set str1 = str1 || " (отделение)"
.head 7 -  Break
.head 6 +  Case 67
.head 7 -  Set str1 = str1 || " (номер счёта/???)"
.head 7 -  Break
.head 6 +  Case 68
.head 7 -  Set str1 = str1 || " (наименование и адрес)"
.head 7 -  Break
.head 5 -  Call SalSetWindowText( hwData, str1 )
.head 2 +  Window Parameters
.head 3 -  Number: nID
.head 3 -  Number: nCorAcc
.head 2 +  Window Variables
.head 3 -  String: strFrom
.head 3 -  String: strTo
.head 3 -  Number: nRef
.head 3 -  Date/Time: dtVdat
.head 3 -  String: strLCV
.head 3 -  Number: nS
.head 3 -  Number: nDig
.head 3 -  String: strNama
.head 3 -  Window Handle: hwAAA
.head 3 -  String: strNLSA
.head 3 -  String: strBankA
.head 3 -  String: strNazn
.head 3 -  String: strNMK
.head 3 -  String: strNMKV
.head 3 -  String: strNMKK
.head 3 -  String: strSAB
.head 3 -  String: strBenefAcc
.head 3 -  String: strCorAcc
.head 3 -  String: strCommission
.head 3 -  String: strRoute0
.head 3 -  String: strRoute1
.head 3 -  String: strRoute2
.head 3 -  String: strRoute3
.head 3 -  String: strRoute9
.head 3 -  !
.head 3 -  String: str1
.head 3 -  Number: nSum2
.head 3 -  String: strControlTag
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  !
.head 4 +  If nCorAcc = 0
.head 5 -  Set strSQL = T("SELECT accounts.acc
FROM oper, accounts
INTO :nCorAcc
WHERE (oper.ref = :nID) AND (accounts.nls=oper.nlsb)")
.head 5 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 5 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 5 -  Set strControlTag = "ROUT9"
.head 4 +  Else
.head 5 -  Set strControlTag = "57"
.head 4 -  ! Set strSQL = T('SELECT custbank.bic, 1
FROM contracts, custbank,operw
INTO :str1
WHERE (operw.ref=:nID) AND (operw.tag="!NC")
AND (contracts.id=operw.value)
AND (custbank.rnk=contracts.r_benefbankrnk)
UNION
SELECT custbank.alt_bic, 2
FROM contracts, custbank, operw
WHERE (operw.ref=:nID) AND (operw.tag="!NC") AND (contracts.id=operw.value) AND (custbank.rnk=contracts.r_benefbankrnk)
ORDER BY 2')
.head 4 -  Set strSQL = T('
SELECT operw.value
FROM operw
INTO :strTo
WHERE (operw.ref=:nID) AND (operw.tag=:strControlTag)')
.head 4 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 4 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 -  Call Debug( strControlTag ||': '|| strTo )
.head 4 -  Set strFrom =  GetGlobalOption(CFG_BICCODE(  ))
.head 4 -  ! Call DebugN( nCorAcc )
.head 4 -  ! Call SalListInsert (dfTo, -1, str1)
.head 4 -  Set strSQL = T('SELECT custbank.bic
FROM cust_acc, custbank
INTO :strCorAcc
WHERE (cust_acc.acc = :nCorAcc) AND (custbank.rnk=cust_acc.rnk)')
.head 4 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 4 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 -  ! Call Debug('strCorAcc: '|| strCorAcc )
.head 4 -  ! Call SalListInsert (dfTo, -1, str1)
.head 4 -  !
.head 4 -  ! заполнение основных полей
.head 4 -  !
.head 4 -  Set strSQL = T('
SELECT a.ref
     , a.vdat
     , c.lcv
     , a.s
     , c.dig
     , a.nam_a
     , a.nlsa
     , a.mfoa
     , a.nazn
     , f.nmk
     , f.nmkv
     , f.nmkk
     , f.sab
FROM oper a
   , tabval c
   , accounts d
   , cust_acc e
   , customer f
INTO :nRef, :dtVdat, :strLCV, :nS, :nDig, :strNama, :strNLSA, :strBankA, :strNazn, :strNMK, :strNMKV, :strNMKK, :strSAB
WHERE (a.kv = c.kv) AND (a.nlsa = d.nls) AND (e.acc=d.acc) AND (f.rnk=e.rnk)
AND (a.ref=:nID)')
.head 4 -  ! Set strSQL = 'SELECT a.ref, a.vdat, c.lcv, a.s, c.dig, a.nama, a.nlsa, a.banka
FROM oper a, tabval c
INTO :nRef, :dtVdat, :strLCV, :nS, :nDig, :strNama, :strNLSA, :strBankA
WHERE a.kv = c.kv
AND a.ref = ' || SalNumberToStrX( nID, 0 )
.head 4 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 4 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 -  Set strSQL = T('SELECT value
FROM operw
INTO :strBenefAcc
WHERE (ref = :nRef) AND (tag=\'59\')')
.head 4 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 4 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 -  ! Call Debug('59: '|| strBenefAcc )
.head 4 -  !
.head 4 -  Set strSQL = T('SELECT value
FROM operw
INTO :strCommission
WHERE (ref = :nRef) AND (tag=\'71\')')
.head 4 -  Call SqlPrepareAndExecute (hSql(), strSQL)
.head 4 -  Call SqlFetchNext(hSql(), nSqlRes)
.head 4 -  ! Call Debug('71: '|| strCommission )
.head 4 -  !
.head 4 -  ! Заполнение defaults на combo-boxes
.head 4 -  !
.head 4 -  Call SalListSetSelect( cmb20, 0 )
.head 4 -  Call SalListSetSelect( cmb32, 0 )
.head 4 -  Call SalListSetSelect( cmb50, 0 )
.head 4 -  Call SalListSetSelect( cmb52, 0 )
.head 4 -  Call SalListSetSelect( cmb53, 0 )
.head 4 -  Call SalListSetSelect( cmb54, 0 )
.head 4 -  Call SalListSetSelect( cmb56, 0 )
.head 4 -  Call SalListSetSelect( cmb57, 2 )
.head 4 -  Call SalListSetSelect( cmb59, 0 )
.head 4 -  Call SalListSetSelect( cmb70, 0 )
.head 4 -  Call SalListSetSelect( cmb71, 0 )
.head 4 -  Call SalListSetSelect( cmb72, 0 )
.head 4 -  !
.head 4 -  Call Init(  )
.head 4 -  !
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalSendMsg( pbFindSwiftPath, SAM_Click, 0, 0 )
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsgToChildren( hWndForm, SAM_DoInit, 0, 0 )
.head 4 -  Call SalListSetSelect( dfTo, 0 )
