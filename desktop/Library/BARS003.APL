Application Description: МВО
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000004000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000010100 002C000000020000 0003000000000000 00BB010000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000000B0400 0064020000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773044D42
0080: 4F38000001800200 0200000000000000 000000002C000000 0000000001000000
00A0: FFFFFFFFFFFFFFFF FCFFFFFFE2FFFFFF 2C0000003A000000 380400009D020000
00C0: 0000000000000000 050000000F417070 6C69636174696F6E 4974656D0757696E
00E0: 646F77730F646C67 436172644D616E61 676541640D436869 6C642057696E646F
0100: 777306706246696E 6400000000018002 0002000000000000 00000000002C0000
0120: 0000000000010000 00FFFFFFFFFFFFFF FFF8FFFFFFE2FFFF FF32000000320000
0140: 001F0400009D0200 0000000000000000 00050000000F4170 706C69636174696F
0160: 6E4974656D075769 6E646F7773044D42 4F390946756E6374 696F6E7306465F53
0180: 41424F00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 30332E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: Nsiapi.apd
		Dynalib: Custacnt.apd
		! Dynalib: Cc_doc.apd
		Dynalib: Docview.apd
		Dynalib: Bars017.apd
		Dynalib: DEPO.apd
		!
		File Include: Gentbl.apl
		File Include: GenTblF.apl
		File Include: GENTBLS.APL
		File Include: Genlist.apl
		File Include: Genlabel.apl
		File Include: GENTIMER.APL
		!
		File Include: Docfun6MVO.apl
		File Include: DOCWIS6MVO.APL
		File Include: Winapi.apl
		File Include: vttblwin.apl
		File Include: Vtmeter.apl
		File Include: Vtfile.apl
		File Include: VTARRAY.APL
		File Include: VTMSGBOX.APL
		File Include: VTDOS.APL
		File Include: Xsalcpt.apl
		File Include: XSALIMG.APL
		File Include: XSALSPL.APL
		File Include: qckdvc.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd/MM/yy hh:mm:AMPM
			Date/Time: dd/MM/yyyy hh:mm:ss
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '02'
				String: ApdVer   =  '01'
				! История изменений: -----------------------------------------------------|
				! 01 30-11-01  MIK     Заложил новые apd                        |
		Resources
		Variables
.data RESOURCE 0 0 1 2363281122
0000: 1E00000011000000 0000000000000000 02000001000000DE 000000E0010D0000
0020: 00FF3F
.enddata
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin33
			Window Handle: hWin40
			Window Handle: hWin41
			Window Handle: hWin42
			Window Handle: hWin5
			Window Handle: hWin6
			Window Handle: hWin7
			Window Handle: hWin8
			Window Handle: hWin9
			Window Handle: hWin10
			Window Handle: hWin11
			Window Handle: hWin99
			Window Handle: hWin98
			Window Handle: hWin97
			Window Handle: hWinPK
			Window Handle: hTA2
			Number: nFetchRes
			Boolean: bApdInited
		Internal Functions
			Function: Sel003	! __exported
				Description: Bars003_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: sPar1
					String: sPar2
				Static Variables
				Local variables
				Actions
					! надо вставить инициализацию apd
					Call Ini003()
					Select Case nMode
						Case 0	! Прием зарплатных файлов МВО (НБУ) - уровень ТУ
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow(frmMVOZIK, hWndParent, nPar, sPar1)
								! nPar = 1 - ТУ
								! nPar = 2 - ЦА
							Else
								Call SalBringWindowToTop(frmMVOZIK)
							Break
						Case 1	! Оплата зарплатных файлов МВО (НБУ) - уровень ЦА
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(frmMVOZIKO, hWndParent)
							Else
								Call SalBringWindowToTop(frmMVOZIKO)
							Break
						Case 2	! Управление запросами
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(tblRequest, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin2)
							Break
						Case 3	! Управление состоянием карт
							If not IsWindow(hWin3)
								Set hWin3 = SalCreateWindow(tblCardManage, hWndParent, nPar, 0, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin3)
							Break
						Case 33 ! Управление состоянием карт (адаптированное)
							If not IsWindow(hWin33)
								Set hWin33 = SalCreateWindow(dlgCardManageAd, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin33)
							Break
						Case 4	! Перевод клиента в другое ТОБО
							Select Case nPar
								Case 0
									If not IsWindow(hWin40)
										Set hWin40 = SalCreateWindow(tblCustomerTobo, hWndParent, nPar, sPar1, sPar2)
									Else
										Call SalBringWindowToTop(hWin40)
									Break
								Case 1
									If not IsWindow(hWin41)
										Set hWin41 = SalCreateWindow(tblCustomerTobo, hWndParent, nPar, sPar1, sPar2)
									Else
										Call SalBringWindowToTop(hWin41)
									Break
								Case 2
									If not IsWindow(hWin42)
										Set hWin42 = SalCreateWindow(tblCustomerTobo, hWndParent, nPar, sPar1, sPar2)
									Else
										Call SalBringWindowToTop(hWin42)
									Break
							Break
						Case 5	! Открытие счетов
							If not IsWindow(hWin5)
								Set hWin5 = SalCreateWindow(frmSetCustomerAccNN, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin5)
							Break
						Case 6	! Управление статусом карт
							If not IsWindow(hWin6)
								Set hWin6 = SalCreateWindow(tblCardStatus, hWndParent, nPar, 0, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin6)
							Break
						Case 7	! Управление файловым обменом
							If not IsWindow(hWin7)
								Set hWin7 = SalCreateWindow(frmFileManage, hWndParent)
							Else
								Call SalBringWindowToTop(hWin7)
							Break
						Case 8	! Ввод Адресных платежей
							If not IsWindow(hWin8)
								Set hWin8 = SalCreateWindow(frmInputAdrDoc, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin8)
							Break
						Case 9	! Прием файлов зачисления (СБЕР)
							If not IsWindow(hWin9)
								Set hWin9 = SalCreateWindow(tblELPLAT, hWndParent)
							Else
								Call SalBringWindowToTop(tblELPLAT)
							Break
						Case 10	! Ввод Адресных платежей (СБЕР)
							If not IsWindow(hWin10)
								Set hWin10 = SalCreateWindow(frmInputAdrDocSber, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin10)
							Break
						Case 11 ! Выравнивание лимитов остатков на счетах загрузки
							If not IsWindow(hWin11)
								Set hWin11 = SalCreateWindow(frmLoadLimits, hWndMDI, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop (hWin11)
							Break
						Case 99 ! МВО9 -  Оплата буфера проводок ( от САБО) 
							If not IsWindow( hWin99 )
								Set hWin99 = SalCreateWindow( MBO9, hWndMDI, nMode, nPar, sPar1, sPar2 )
							Else
								Call SalBringWindowToTop ( hWin99 )
							Break
						Case 98 ! МВО8 -  Синхронные счета в МВО и САБО ( от МВО)
							If not IsWindow( hWin98 )
								Set hWin98 = SalCreateWindow( MBO8, hWndMDI, nMode, nPar, sPar1, sPar2 )
							Else
								Call SalBringWindowToTop ( hWin98 )
							Break
						Case 97 ! МВО7 -  Просморт буфера проводок  ( от МВО)
							If not IsWindow( hWin97 )
								Set hWin97 = SalCreateWindow( MBO7, hWndMDI, nMode, nPar, sPar1, sPar2 )
							Else
								Call SalBringWindowToTop ( hWin97 )
							Break
						Default
							Break
			Function: Ini003
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars003.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							If strLangId = 'UKR'
								Call CurrentLangTable.AddAtom('frmMVOZIKO.cBTipRun', 'Оплатити файл')
								Call CurrentLangTable.AddAtom('cTAt', 'Увага!')
								Call CurrentLangTable.AddAtom('cTErr','Помилка!')
								Call CurrentLangTable.AddAtom('cTInfo','Інформація')
								Call CurrentLangTable.AddAtom('cTMessage','Повідомлення')
								Call CurrentLangTable.AddAtom('cTFilial','Підрозділ')
								Call CurrentLangTable.AddAtom('cTBranch','Відділення')
							Else
								Call CurrentLangTable.AddAtom('frmMVOZIKO.cBTipRun', 'Оплатить файл')
						Call DocWisInit('frmInputAdrDoc')
						Set bApdInited = TRUE
					Return bApdInited
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: GetServerDate
				Description:
				Returns
					Date/Time:
				Parameters
				Static Variables
				Local variables
					Date/Time: Result
					Number: nFetchRes
				Actions
					If SqlPrepareAndExecute( hSql(), "SELECT SYSDATE INTO :Result FROM dual " )
						If SqlFetchNext( hSql(), nFetchRes )
							Return Result
					Return DATETIME_Null
			Function: GetMVOlz
				Description:
				Returns
					String:
				Parameters
					String: sPar
				Static Variables
				Local variables
					String: sValue
				Actions
					If SqlPrepareAndExecute(hSql(), '
							   SELECT value
							   INTO :sValue
							   FROM mvolzw
							   WHERE tag=:sPar') and SqlFetchNext(hSql(), nFetchRes)
						Return sValue
					Else
						Return ''
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1896366488
0000: 13040000DC010000 0000000000000000 0200000600FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F4D003C00 00046300446F63D4
0040: 0000000878000000 02F004000000FF9F 0400DC000200FF7F 0873000200FFFF01
0060: 0C000000010D00FC 0000FF0719000000 01F700FF1F260000 DC000100FF7F3370
0080: 0000000100FFFFC1 4000000001FD00FF 0701806100000000 010000000B5F5F00
00A0: 4572726F72426173 90655601000D009E 00010DFD00FF370D 0001F700FF1F1A00
00C0: 00DC000100FF7F27 700000000100FFFF C13400000002FD00 FF073800000002F7
00E0: 00FF1F3C0000DC00 0200FF7F40430003 040000FFFFC14400 000002FD00FF0748
0100: 00000002F700FF1F 4C0000DC000300FF 7F50700000000300 FFFFC15400000001
0120: FD00FF8701800D00 000002000000065F 5F00466C61671E00 0000F4010000EC01
0140: 0D00FF3F0180041A 000003000000000B 63517569636B5440 61626C65380000F6
0160: 0200EC010D00FFBF 0DB9000100FFFF80 0180220000000401 000A6347656E4600
0180: 696C746572740000 EC00040019020400 0100FD0083800100 00007F046300010D
01A0: 00FFFFC111000000 02FD00FF07150000 0001F700FF1F0180 220300050000000B
01C0: 8D474446693F0004 7B00024700010000 FFE480010000DF04 D800010D00FF7F11
01E0: 73000200FFFFCD15 0001FD00FF07
.enddata
			Form Window Class: cDocWMBO
				Title:
				Icon File:
				Accesories Enabled? Class Default
				Visible? Class Default
				Display Settings
					Display Style? Class Default
					Visible at Design time? Yes
					Automatically Created at Runtime? Class Default
					Initial State: Class Default
					Maximizable? Class Default
					Minimizable? Class Default
					System Menu? Class Default
					Resizable? Class Default
					Window Location and Size
						Left:  
						Top:   
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Form Size
						Width:  Class Default
						Height: Class Default
						Number of Pages: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Next Class Child Key: 67
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Description:
				Derived From
					Class: cDocW
				Menu
				Tool Bar
					Display Settings
						Display Style? Class Default
						Location? Class Default
						Visible? Class Default
						Size: Class Default
						Size Editable? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
					Contents
						Pushbutton: pbPayDoc
							Class Child Ref Key: 27
							Class ChildKey: 48
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbExit
							Class Child Ref Key: 29
							Class ChildKey: 49
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbPrtDoc
							Class Child Ref Key: 30
							Class ChildKey: 50
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Line
							Resource Id: 3912
							Class Child Ref Key: 33
							Class ChildKey: 51
							Class: cDocW
							Coordinates
								Begin X:  Class Default
								Begin Y:  Class Default
								End X:  Class Default
								End Y:  Class Default
							Visible? Class Default
							Line Style: Class Default
							Line Thickness: Class Default
							Line Color: Class Default
						Background Text:
							Resource Id: 3913
							Class Child Ref Key: 75
							Class ChildKey: 52
							Class: cDocW
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Justify: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
						Line
							Resource Id: 3914
							Class Child Ref Key: 34
							Class ChildKey: 53
							Class: cDocW
							Coordinates
								Begin X:  Class Default
								Begin Y:  Class Default
								End X:  Class Default
								End Y:  Class Default
							Visible? Class Default
							Line Style: Class Default
							Line Thickness: Class Default
							Line Color: Class Default
						Line
							Resource Id: 3915
							Class Child Ref Key: 59
							Class ChildKey: 54
							Class: cDocW
							Coordinates
								Begin X:  Class Default
								Begin Y:  Class Default
								End X:  Class Default
								End Y:  Class Default
							Visible? Class Default
							Line Style: Class Default
							Line Thickness: Class Default
							Line Color: Class Default
						Data Field: dfZn
							Class Child Ref Key: 35
							Class ChildKey: 55
							Class: cDocW
							Property Template:
							Class DLL Name:
							Data
								Maximum Data Length: Class Default
								Data Type: Class Default
								Editable? Class Default
							Display Settings
								Window Location and Size
									Left:   Class Default
									Top:    Class Default
									Width:  Class Default
									Width Editable? Class Default
									Height: Class Default
									Height Editable? Class Default
								Visible? Class Default
								Border? Class Default
								Justify: Class Default
								Format: Class Default
								Country: Class Default
								Font Name: Class Default
								Font Size: Class Default
								Font Enhancement: Class Default
								Text Color: Class Default
								Background Color: Class Default
								Input Mask: Class Default
							Message Actions
						Data Field: dfOst
							Class Child Ref Key: 31
							Class ChildKey: 56
							Class: cDocW
							Property Template:
							Class DLL Name:
							Data
								Maximum Data Length: Class Default
								Data Type: Class Default
								Editable? Class Default
							Display Settings
								Window Location and Size
									Left:   Class Default
									Top:    Class Default
									Width:  Class Default
									Width Editable? Class Default
									Height: Class Default
									Height Editable? Class Default
								Visible? Class Default
								Border? Class Default
								Justify: Class Default
								Format: Class Default
								Country: Class Default
								Font Name: Class Default
								Font Size: Class Default
								Font Enhancement: Class Default
								Text Color: Class Default
								Background Color: Class Default
								Input Mask: Class Default
							Message Actions
						Pushbutton: pbNewDoc
							Class Child Ref Key: 53
							Class ChildKey: 57
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbNewTTs
							Class Child Ref Key: 60
							Class ChildKey: 58
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbDocBal
							Class Child Ref Key: 72
							Class ChildKey: 59
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbHelp
							Class Child Ref Key: 62
							Class ChildKey: 60
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbSaveKor
							Class Child Ref Key: 64
							Class ChildKey: 61
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbLocalD
							Class Child Ref Key: 148
							Class ChildKey: 62
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Line
							Resource Id: 3916
							Class Child Ref Key: 77
							Class ChildKey: 63
							Class: cDocW
							Coordinates
								Begin X:  Class Default
								Begin Y:  Class Default
								End X:  Class Default
								End Y:  Class Default
							Visible? Class Default
							Line Style: Class Default
							Line Thickness: Class Default
							Line Color: Class Default
						Pushbutton: pbHotVytyag
							Class Child Ref Key: 138
							Class ChildKey: 64
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbHotFio
							Class Child Ref Key: 141
							Class ChildKey: 65
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbHotName
							Class Child Ref Key: 137
							Class ChildKey: 66
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
						Pushbutton: pbHotOstat
							Class Child Ref Key: 150
							Class ChildKey: 67
							Class: cDocW
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
				Contents
					Data Field: dfValD1
						Class Child Ref Key: 25
						Class ChildKey: 1
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Combo Box: cmbVob
						Class Child Ref Key: 39
						Class ChildKey: 2
						Class: cDocW
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Editable? Class Default
						String Type: Class Default
						Maximum Data Length: Class Default
						Sorted? Class Default
						Always Show List? Class Default
						Vertical Scroll? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
						List Initialization
						Message Actions
					Background Text:
						Resource Id: 3908
						Class Child Ref Key: 36
						Class ChildKey: 3
						Class: cDocW
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Justify: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
					Data Field: dfNd
						Class Child Ref Key: 23
						Class ChildKey: 4
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfDateFrom
						Class Child Ref Key: 155
						Class ChildKey: 5
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfDocD
						Class Child Ref Key: 22
						Class ChildKey: 6
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfBankA
						Class Child Ref Key: 4
						Class ChildKey: 7
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfKvA
						Class Child Ref Key: 50
						Class ChildKey: 8
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNlsA
						Class Child Ref Key: 2
						Class ChildKey: 9
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfPlat
						Class Child Ref Key: 8
						Class ChildKey: 10
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNamA
						Class Child Ref Key: 7
						Class ChildKey: 11
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfOkpoA
						Class Child Ref Key: 139
						Class ChildKey: 12
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfPlatB
						Class Child Ref Key: 9
						Class ChildKey: 13
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNbA
						Class Child Ref Key: 6
						Class ChildKey: 14
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfBankB
						Class Child Ref Key: 13
						Class ChildKey: 15
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfPoluB
						Class Child Ref Key: 18
						Class ChildKey: 16
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNbB
						Class Child Ref Key: 15
						Class ChildKey: 17
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfKvB
						Class Child Ref Key: 51
						Class ChildKey: 18
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNlsB
						Class Child Ref Key: 11
						Class ChildKey: 19
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfPolu
						Class Child Ref Key: 17
						Class ChildKey: 20
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfNamB
						Class Child Ref Key: 16
						Class ChildKey: 21
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfOkpoB
						Class Child Ref Key: 140
						Class ChildKey: 22
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumNA
						Class Child Ref Key: 135
						Class ChildKey: 23
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumA
						Class Child Ref Key: 20
						Class ChildKey: 24
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumNB
						Class Child Ref Key: 122
						Class ChildKey: 25
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumB
						Class Child Ref Key: 21
						Class ChildKey: 26
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfRatNomN
						Class Child Ref Key: 123
						Class ChildKey: 27
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfRatNom
						Class Child Ref Key: 57
						Class ChildKey: 28
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumNC
						Class Child Ref Key: 125
						Class ChildKey: 29
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSumC
						Class Child Ref Key: 44
						Class ChildKey: 30
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfEquivN
						Class Child Ref Key: 144
						Class ChildKey: 31
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfEquiv
						Class Child Ref Key: 145
						Class ChildKey: 32
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					List Box: lb1
						Class Child Ref Key: 85
						Class ChildKey: 33
						Class: cDocW
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Multiple selection? Class Default
						Sorted? Class Default
						Vertical Scroll? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Horizontal Scroll? Class Default
						List Initialization
						Message Actions
					Multiline Field: dfNazn
						Class Child Ref Key: 24
						Class ChildKey: 34
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							String Type: Class Default
							Editable? Class Default
						Display Settings
							Border? Class Default
							Word Wrap? Class Default
							Vertical Scroll? Class Default
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
						Message Actions
					Data Field: dfSkN
						Class Child Ref Key: 115
						Class ChildKey: 35
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfSk
						Class Child Ref Key: 48
						Class ChildKey: 36
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfValD1N
						Class Child Ref Key: 116
						Class ChildKey: 37
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfValD2N
						Class Child Ref Key: 131
						Class ChildKey: 38
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfValD2
						Class Child Ref Key: 66
						Class ChildKey: 39
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfD
						Class Child Ref Key: 132
						Class ChildKey: 40
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Data Field: dfK
						Class Child Ref Key: 133
						Class ChildKey: 41
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Frame
						Resource Id: 3910
						Class Child Ref Key: 10
						Class ChildKey: 42
						Class: cDocW
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Corners: Class Default
						Border Style: Class Default
						Border Thickness: Class Default
						Border Color: Class Default
						Background Color: Class Default
					Frame
						Resource Id: 3911
						Class Child Ref Key: 45
						Class ChildKey: 43
						Class: cDocW
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Corners: Class Default
						Border Style: Class Default
						Border Thickness: Class Default
						Border Color: Class Default
						Background Color: Class Default
					Frame
						Resource Id: 3909
						Class Child Ref Key: 88
						Class ChildKey: 44
						Class: cDocW
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Corners: Class Default
						Border Style: Class Default
						Border Thickness: Class Default
						Border Color: Class Default
						Background Color: Class Default
					Data Field: dfLocDat
						Class Child Ref Key: 149
						Class ChildKey: 45
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
					Check Box: cbUgrnt
						Class Child Ref Key: 130
						Class ChildKey: 46
						Class: cDocW
						Property Template:
						Class DLL Name:
						Title:
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Message Actions
					Data Field: dfVytyagN
						Class Child Ref Key: 142
						Class ChildKey: 47
						Class: cDocW
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Class Default
							Data Type: Class Default
							Editable? Class Default
						Display Settings
							Window Location and Size
								Left:   Class Default
								Top:    Class Default
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Justify: Class Default
							Format: Class Default
							Country: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Input Mask: Class Default
						Message Actions
				Class Variables
				Instance Variables
					Number: bAcc
				Functions
				Message Actions
					On UM_HotAccountList
						Set bAcc = FALSE
						If bAccA = 1 or bAccB = 1
							If (nDk = 0 or nDk = 2) and bAccB = 1
								Set bAcc  = bAccB
								Set bAccB = 0
							Else If (nDk = 1 or nDk = 3) and bAccA = 1
								Set bAcc  = bAccA
								Set bAccA = 0
						Call SalSendClassMessage(UM_HotAccountList, 0, 0)
						If bAcc
							If nDk = 0 or nDk = 2
								Set bAccB = bAcc
								If bAccB
									Set sNls = dfNlsB
							Else
								Set bAccA = bAcc
								If bAccA
									Set sNls = dfNlsA
							If bAcc
								If SalModalDialog(dlgAccMBO, hWndForm, sTT, IifN(nDk=0 or nDk=2,0,1), sNls, sNms, sOkpo)
									If bAccA = 1
										Set dfNlsA = sNls
										Set dfNamA = sNms
										Set dfOkpoA = sOkpo
										Call SalSetFocus(dfNlsA)
									Else If bAccB = 1
										Set dfNlsB = sNls
										Set dfNamB = sNms
										Set dfOkpoB = sOkpo
										Call SalSetFocus(dfNlsB)
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: cpbCancel
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_NumId
			Picture: cQuickPicture
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	!
	! Dialog Box: dlg_CreateDoc
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Новый документ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.429"
				Width Editable? Yes
				Height: 4.385"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                    Description: 
		                                                    Tool Bar 
			                                                    Contents 
		                                                    Contents 
			                                                    Background Text: Номер дополнительного соглашения:
			                                                    List Box: lbAdd
				                                                    List Initialization 
				                                                    Message Actions 
					! On SAM_Create
						                                                                                                                                            Call SalListPopulate( lbAdd, hSql(), "
								SELECT
								adds
								FROM
								cc_add
								WHERE
								nd = :nND ")
			                                                    Child Table: tblTemplates
				                                                    Contents 
					                                                    Column: colId
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: colName
						                                                    List Values 
						                                                    Message Actions 
				                                                    Functions 
				                                                    Window Variables 
				                                                    Message Actions 
					                                                    On SAM_Create
						                                                    If SalTblPopulate( dlg_CreateDoc.tblTemplates, hSql(),
								"SELECT r.id,s.name
								 INTO :dlg_CreateDoc.tblTemplates.colId,:dlg_CreateDoc.tblTemplates.colName
								 FROM doc_root r, doc_scheme s
								 WHERE  r.vidd =:nVidd AND s.id = r.id ", TBL_FillAll )
						                                                    If SalTblAnyRows( tblTemplates, 0, 0 ) != TRUE
							                                                    Call SalMessageBox( 'Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok  )
							                                                    Call SalEndDialog( dlg_CreateDoc, 0 )
						                                                    Else 
							                                                    Call SalTblSetContext( tblTemplates, TBL_MinRow )
			                                                    Pushbutton: pbOk
				                                                    Message Actions 
					                                                    On SAM_Click
						                                                    Call XConnectGetParams( cCnc )
						                                                    If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							                                                    Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
							                                                    If sDoc
								! Показываем документ с редактированием
								                                                    If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
									! Сохраняем документ в БД
									! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
											 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
										                                                    If SqlSetLongBindDatatype( 3, 23 )
											                                                    If SqlExecute( hSql() )
												                                                    Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
												! Return 1
									                                                    If NOT cdoc_SetDocText(hSql(), TRUE,
											  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
										                                                    Call SqlRollback(hSql())
									                                                    Else 
										                                                    Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!')
							                                                    Call cCnc.Disconnect()
							                                                    Call cCnc2.Disconnect()
						                                                    Call SalEndDialog( dlg_CreateDoc, 0 )
			                                                    Pushbutton: pbCancel
				                                                    Message Actions 
					                                                    On SAM_Click
						                                                    Call SalEndDialog( dlg_CreateDoc, 0 )
			                                                    Group Box: Выбор шаблона
		                                                    Functions 
		                                                    Window Parameters 
			                                                    Number: nND
			                                                    Number: nVidd
		                                                    Window Variables 
			                                                    : cCnc
			                                                    : cCnc2
			                                                    Long String: sDoc
		                                                    Message Actions 
			                                                    On SAM_Create
				                                                    Call SalSetWindowText( hWndForm, 'Новый документ к договору №'||
						                      SalNumberToStrX( nND, 0 ) )
				                                                    Call SalCenterWindow( hWndForm )
	!
	Table Window: MBO7
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перегляд буферу проводок для САБО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.113"
				Top:    1.271"
				Width:  13.833"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 4000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.1"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51577
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.983"
						Begin Y:  0.0"
						End X:  4.983"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.55"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.0"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SetQueryFilter(MBO7.cF)
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.9"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути документи МВО вибраного буферу'
						! On SAM_Click
							                                                                                         Call DocViewListInt( hWndMDI,
									"a.ref in (select ref from operw where tag='IDMVO' and value="||ID|| ")" ,
									"Документы МВО, що включені в буфур САБО № " || ID )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.45"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51578
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  7.417"
						Begin Y:  -0.012"
						End X:  7.417"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.533"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51579
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Check Box: cb_KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: З кількістю проводок в МВО
					Window Location and Size
						Left:   0.483"
						Top:    0.071"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_KOL
								Call SalShowWindow( MBO7.KOL )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Else
								Call SalHideWindow( MBO7.KOL )
				Pushbutton: pbArc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.467"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bArc = NOT bArc
							Set MBO7.strSqlPopulate = sPopulate
							If bArc
								Call SalSetWindowText(hWndForm, sTitle || ' (архів)')
							Else
								Set MBO7.strSqlPopulate = MBO7.strSqlPopulate || sWhere
								Call SalSetWindowText(hWndForm, sTitle)
							Set MBO7.strSqlPopulate = MBO7.strSqlPopulate || sOrder
							Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
						On SAM_TooltipSetText
							If bArc
								Return XSalTooltipSetText(lParam, 'Необроблені в САБО')
							Else
								Return XSalTooltipSetText(lParam, 'Архів проводок')
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф-1
						в МВО 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Дебет
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-Б
						(для СЕП)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Кредит
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.7"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість
						в МВО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.217"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SOS
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTitle
			Number: n980
			Date/Time: bDat
			Boolean: bArc
			String: sPopulate
			String: sWhere
			String: sOrder
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set sTitle = 'Перегляд буферу проводок для САБО'
				Call SalSetWindowText(hWndForm, sTitle)
				Set cb_KOL = FALSE
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set bArc = FALSE
				Call SalTblSetLockedColumns(hWndForm, 7)
				Set MBO7.strPrintFileName = 'MBO7'
				Set MBO7.strFilterTblName = 'MVO_SABO'
				Set MBO7.fFilterAtStart = 1
				Set sPopulate = 
						"SELECT to_char(MVO_SABO.ID), MVO_SABO.REF, MVO_SABO.NLSD, MVO_SABO.NLSK, 
						        MVO_SABO.S/100, MVO_SABO.PRZ, MVO_SABO.MFO, MVO_SABO.REF1 
						   INTO :MBO7.ID, :MBO7.REF,:MBO7.NLSD, :MBO7.NLSK, :MBO7.S, :MBO7.PRZ, :MBO7.MFO, :MBO7.REF1 
						   FROM MVO_SABO"
				Set sWhere = " WHERE ref is null "
				Set sOrder = " ORDER BY MVO_SABO.id desc "
				Set MBO7.strSqlPopulate = sPopulate || sWhere || sOrder
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call MBO7.ReInitQueryString()
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				If cb_KOL 
					If SqlPrepareAndExecute(hSqlAux2(),
							"SELECT count(*) INTO :KOL FROM operw w, oper o 
							  WHERE w.tag='IDMVO' AND w.value=:ID AND o.ref=w.ref AND o.sos>0")
							AND SqlFetchNext(hSqlAux2(), nFetchRes) 
				If REF > 0
					If SqlPrepareAndExecute(hSqlAux2(),
							"SELECT fdat,sos INTO :FDAT, :SOS FROM SABOopldok WHERE ref=:REF")
							AND SqlFetchNext(hSqlAux2(), nFetchRes) 
						If SOS = 5 ! по факту - серій
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
						Else If SOS = 1 ! по плану - зеленій
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Green)
						Else If SOS = 3 !  по форв - голубой
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Sky)
						Else ! другое желтій
							Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB( 255,255,220))
					Else ! не найдено в оплдок - розовій
						Call XSalTblSetRowBackColor(hWndForm, lParam,  SalColorFromRGB(255,210,250))
			On SAM_DoubleClick
				Call DocViewListInt(hWndMDI,
						"a.ref in (select ref from operw where tag='IDMVO' and value='" || ID || "')",
						"Документи МВО, що включені в буфер САБО № " || ID)
	Table Window: MBO8
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Синхронізація залишків на рахунках МВО та САБО "живих" коштів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.563"
				Top:    1.885"
				Width:  13.833"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 4000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: NM_KS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.071"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку згорнених коштів')
				Data Field: KS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.783"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ рахунку згорнених коштів')
				Data Field: nKS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.383"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Залишок рахунку згорнених коштів')
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16971
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  8.95"
						Begin Y:  -0.048"
						End X:  8.95"
						End Y:  0.417"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.95"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Історія рахунку'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16972
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  10.483"
						Begin Y:  -0.024"
						End X:  10.483"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16973
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.95"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Sky
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Урегулювати виділені рахунки "живими" коштами'
						On SAM_Click
							Call F_KS(ROW_Selected)
				Pushbutton: pb_BUFF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд буферу проводок для САБО'
						On SAM_Click
							Call Sel003(hWndMDI,97,0," "," ")
		Contents
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип 
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B_MVO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сума 
						в МВО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C_MVO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-Сума 
						в МВО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B_SABO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сума 
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C_SABO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-Сума 
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS_MVO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рах. в МВО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS_SABO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рах в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф оп
						синхрон.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_MVO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC_MVO
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_KS
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					Number: nRow
					Number: nDk
					Number: nRef
					Number: nS
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, nTipRow, 0)
						Call SalTblSetContext( hWndForm, nRow)
						If TIP = 'KS_' AND C_SABO != C_MVO AND B_SABO = C_SABO AND REF = NUMBER_Null
							Set nRef = NUMBER_Null
							If (B_MVO = C_MVO) 
									OR  (B_MVO != C_MVO AND 
									     SalMessageBox('По рахунку '||MBO8.NLS||' є незавізовані документи! Продовжити?', 
									                   'Увага!', 
									                   MB_IconAsterisk|MB_YesNo) = IDYES) 
								Set nS = (C_SABO - C_MVO) * 100
								If nS > 0 
									Set nDk = 1
								Else
									Set nDk = 0
								Set nS = SalNumberAbs(nS)
								Call cDoc.SetDoc(nRef, 'KS_', nDk, 6, Str(nRef), bDat, bDat, bDat, bDat,
										                 KS,              NM_KS, GetBankMfo(),'', n980, nS, GetBankOkpoS(),
										                 MBO8.NLS, MBO8.NMS_MVO, GetBankMfo(),'', n980, nS, GetBankOkpoS(),
										                 'Синхронізація залишків на рахунках МВО та САБО "живих" коштів',
										                 '', GetIdOper(), '', NUMBER_Null, 0)
								If cDoc.oDoc() AND SqlCommitEx(hSqlAux2(), "Синхронизовано рах = "||MBO8.NLS)
									Set MBO8.REF = cDoc.m_nRef
									Call XSalTblSetCellBackColor(MBO8.REF, COLOR_Orchid)
									Call XSalTblSetCellBackColor(MBO8.TIP, COLOR_LightGreen)
								Else
									Call SqlRollback(hSqlAux2())
					!
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: ACC_KS
			Number: n980
			Date/Time: bDat
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 6)
				Call SetWindowFullSize(hWndForm)
				Set MBO8.strPrintFileName = 'MBO8'
				Set MBO8.strFilterTblName = 'ACCOUNTS'
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				If SqlPrepareAndExecute(hSql(),
						"SELECT  a.acc, a.nms, a.nls, a.ostc/100 
						       INTO  :ACC_KS, :NM_KS, :KS, :nKS 
						     FROM  accounts a, params p 
						 WHERE  p.par = 'KORRACC' AND p.val = a.nls AND a.kv = 980")
						and not SqlFetchNext( hSql(), nFetchRes) 
					Call SalMessageBox('НЕ заповнені дані про "Згорнений рах.грошових коштів" !',
							                   "Params, par = 'KORRACC'", 
							                   MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				! << Наповнення таблиці MVO_SYNC_BALANCES >>
				If SqlPLSQLCommand( hSql(), "bars.SYNC_BALANCES_MVO( 'SYNC_BALANCES' )" )
					Call SqlCommit( hSql() )
				Else
					Call SqlRollback( hSql() )
					! Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'),
							                                            CurrentLangTable.GetAtomTitle('cTInfo'),
							                                            MB_IconInformation )
				Set MBO8.strSqlPopulate =
						"SELECT  acc, tip, nls, mvo_ostb/100, mvo_ostc/100, sabo_ostb/100, sabo_ostc/100, mvo_nms, sabo_nms
						        INTO :MBO8.ACC_MVO, :MBO8.TIP, :MBO8.NLS, :MBO8.B_MVO, :MBO8.C_MVO, 
						                    :MBO8.B_SABO, :MBO8.C_SABO, :MBO8.NMS_MVO, :MBO8.NMS_SABO
						      FROM  mvo_sync_balances"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If TIP = 'KS_'
					Call XSalTblSetCellBackColor(TIP, SalColorFromRGB(255,210,250))
					If (C_SABO != C_MVO AND B_SABO = C_SABO) 
						Call XSalTblSetCellBackColor(C_SABO, SalColorFromRGB(255,210,250))
						Call XSalTblSetCellBackColor(C_MVO,  SalColorFromRGB(255,210,250))
			On UM_Populate
				If SqlPrepareAndExecute( hSql(), 
						  "SELECT ostc/100 INTO :nKS FROM accounts WHERE acc = :ACC_KS")
						and not SqlFetchNext(hSql(), nFetchRes) 
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_DoubleClick
				If MBO8.ACC_MVO > 0 
					Call Show_Sal_Day_P(ACC_MVO, NMS_MVO, n980, AddMonths(SalDateCurrent(),-1), SalDateCurrent())
	Table Window: MBO9
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Включення в баланс САБО операцій від МВО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.963"
				Top:    2.063"
				Width:  13.833"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 4000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.0"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 61592
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.017"
						Begin Y:  0.0"
						End X:  5.017"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.433"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.867"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.3"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 61593
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.1"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 61594
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Sky
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Тільки ВІДМІЧЕНІ документи '
						On SAM_Click
							Call F_SABO( ROW_Selected )
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.467"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO1.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Sky
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'ВСІ документи '
						On SAM_Click
							Call F_SABO (0)
		Contents
			Column: REF1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф-1 
						в МВО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						в буферi 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф 
						в САБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відправник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отримувач
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення платежу
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  3.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЄДРПОУ
						відправн.
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  0.94"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЄДРПОУ
						отримув.
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  0.94"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						опер.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: STP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: СТП
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ДР
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_SABO
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					Number: nRow
					Number: nRef
					Number: nS
					Number: _dk
					Number: _sk
					String: _nlsa
					String: _nmsa
					String: _nlsb
					String: _nmsb
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, nTipRow, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If NAZN  != STRING_Null 
								AND     S > 0 
								AND   REF = NUMBER_Null 
								AND NMSD != STRING_Null 
								AND NMSK != STRING_Null
							! Залочить запись
							Set nRef = NUMBER_Null
							If SqlPrepareAndExecute(hSqlAux2(),
									  "SELECT s INTO :nS FROM mvo_sabo 
									    WHERE ref IS NULL 
									      AND prz = 0 
									      AND s > 0 
									      AND id = :ID 
									   FOR UPDATE OF prz NOWAIT") 
									and SqlFetchNext(hSqlAux2(), nFetchRes)
								Set S = nS/100
								! Оплата межбанковского платежа
								If MFOB != STRING_Null AND MFOB != GetBankMfo()
									Call cDoc.SetDoc(nRef, TT, 1, VOB, Str(ID), bDat, bDat, bDat, bDat,
											     NLSD, NMSD, GetBankMfo(),'', n980, nS, ID_A,
											     NLSK, NMSK, MFOB,        '', n980, nS, ID_B,
											     NAZN, DR, GetIdOper(), '', NUMBER_Null, STP)
								Else
									Set _dk = 1
									Set _sk = NUMBER_Null
									Set _nlsa  = NLSD
									Set _nmsa  = NMSD
									Set _nlsb  = NLSK
									Set _nmsb  = NMSK
									If Subs(NLSD,1,3) = '100'
										Set _dk = 0
										Set _sk = 5
										Set _nlsa  = NLSK
										Set _nmsa  = NMSK
										Set _nlsb  = NLSD
										Set _nmsb  = NMSD
										Call SalModalDialog(dlg_MBOSetSk, hWndForm, _dk, _sk)
									Else If Subs(NLSK,1,3) = '100'
										Set _sk = 55
										Call SalModalDialog(dlg_MBOSetSk, hWndForm, _dk, _sk)
									Call cDoc.SetDoc(nRef, TT, _dk, VOB, Str(ID), bDat, bDat, bDat, bDat,
											     _nlsa, _nmsa, GetBankMfo(), '', n980, nS, ID_A,
											     _nlsb, _nmsb, GetBankMfo(), '', n980, nS, ID_B,
											     NAZN, DR, GetIdOper(), '', _sk, 0)
								If cDoc.oDoc() 
										and SqlPLSQLCommand(hSqlAux2(),"MVO_OPER (ID,cDoc.m_nRef)")
										and SqlCommitEx(hSqlAux2(),"Зараховано з МВО ID = "||Str(ID))
									Set REF = cDoc.m_nRef
									Call XSalTblSetCellBackColor(REF, COLOR_Orchid)
								Else
									Call SqlRollback(hSqlAux2())
					!
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: n980
			Date/Time: bDat
			: cDoc
				Class: cDoc
			String: TT_MBO
			String: TT_MB1
			Number: STP_MB1
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				Call PrepareWindowEx(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 6)
				Set MBO9.nTabInstance = TRUE
				Set MBO9.strPrintFileName = 'MBO9'
				Set MBO9.strFilterTblName = 'MVO_SABO'
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				If SalStrLength(strPar01) != 3
					Set TT_MBO = 'MBO'
				Else
					Set TT_MBO = strPar01
				If SalStrLength(strPar02) != 3
					Set TT_MB1 = 'MB1'
				Else
					Set TT_MB1 = strPar02
				! Признак СТП для межбанк. операции
				Call SqlPrepareAndExecute(hSql(), 
						    "select to_number(substr(flags,13,1))-1 
						       into :STP_MB1 
						       from tts 
						      where tt = :TT_MB1")
				Call SqlFetchNext(hSql(), nFetchRes)
				!
				Set MBO9.strSqlPopulate =
						"SELECT id, nlsd, nlsk, s/100, ref1, mfo, 
						        substr(f_mvo_sabo_nazn(nlsd,nlsk,'N'),1,160),
						        substr(f_mvo_sabo_nazn(nlsd,nlsk,'T'),1,3),
						        to_number(substr(f_mvo_sabo_nazn(nlsd,nlsk,'V'),1,3))
						   INTO :MBO9.ID, :MBO9.NLSD, :MBO9.NLSK, :MBO9.S, :MBO9.REF1, :MBO9.MFOB, :MBO9.NAZN, :MBO9.TT, :MBO9.VOB
						   FROM mvo_sabo 
						  WHERE prz = 0 AND ref IS NULL 
						  ORDER BY id"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				! ОТПРАВИТЕЛЬ: наименование и код ОКПО
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT substr(nms,1,38), c.okpo 
						     INTO :NMSD, :ID_A
						     FROM accounts a, customer c
						    WHERE a.rnk  =  c.rnk 
						      AND a.nls  =  :NLSD 
						      AND a.kv   =  :n980       
						      AND a.dazs IS NULL")
						AND SqlFetchNext(hSql(), nFetchRes)
				! ПОЛУЧАТЕЛЬ: наименование и код ОКПО + НАЗНАЧЕНИЕ ПЕРВИЧНОГО ПЛАТЕЖА
				If REF1 != NUMBER_Null
					! межбанковские адресные платежи-одиночки
					If MFOB != STRING_Null AND MFOB != GetBankMfo()
						If SqlPrepareAndExecute(hSql(), 
								"SELECT nam_b, id_b, nazn, vob 
								   INTO :NMSK,:ID_B,:NAZN,:VOB
								   FROM mvooper 
								  WHERE ref = :REF1")
								AND SqlFetchNext(hSql(), nFetchRes)
					! внутренние адресные платежи-одиночки
					Else
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT substr(nms,1,38), c.okpo  
								     INTO :NMSK, :ID_B
								     FROM accounts a, customer c
								    WHERE a.rnk  =  c.rnk 
								      AND a.nls  =  :NLSK 
								      AND a.kv   =  :n980 
								      AND a.dazs IS NULL")
								AND SqlFetchNext(hSql(), nFetchRes)
						If SqlPrepareAndExecute(hSql(), 
								"SELECT nazn, vob 
								   INTO :NAZN,:VOB
								   FROM mvooper 
								  WHERE ref = :REF1")
								AND SqlFetchNext(hSql(), nFetchRes)
				Else
					! накопительные межбанк
					If MFOB != STRING_Null AND MFOB != GetBankMfo()
						If SqlPrepareAndExecute(hSql(),
								  "SELECT nam_b, id_b, nazn, vob
								     INTO :NMSK,:ID_B,:NAZN,:VOB
								     FROM mvooper o, mvooperw w
								    WHERE o.ref = w.ref 
								      AND w.tag = 'IDMVO' 
								      AND w.value ='"||Str(ID)||"'")
								AND SqlFetchNext(hSql(), nFetchRes)
					! консолидированные внутрибанк
					Else
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT substr(nms,1,38), c.okpo  
								     INTO :NMSK, :ID_B
								     FROM accounts a, customer c
								    WHERE a.rnk  =  c.rnk 
								      AND a.nls  =  :NLSK 
								      AND a.kv   =  :n980 
								      AND a.dazs IS NULL")
								AND SqlFetchNext(hSql(), nFetchRes)
				! Вид обработки 
				Set VOB = IifN(VOB = NUMBER_Null, 6, VOB)
				! Код операции
				If MFOB != STRING_Null AND MFOB != GetBankMfo()
					Set TT = TT_MB1
					Set STP = STP_MB1
				Else
					Set TT = IifS(TT != '', TT, TT_MBO)
					Set STP = 0
				! додаткові реквізити операції в МВО
				If SqlPrepareAndExecute ( hSql(), "SELECT f_remove_#F(d_rec) INTO :DR  FROM   mvooper  WHERE ref = :MBO9.REF1 " )
					Call SqlFetchNext( hSql(), nFetchRes)
	Dialog Box: dlgAccMBO
		Class:
		Property Template:
		Class DLL Name:
		Title: Справочник лицевых счетов
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  9.3"
				Width Editable? Yes
				Height: 5.083"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: System Window Color
		Description: поиск счета по номеру карточки
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Bottom
				Visible? No
				Size: 0.536"
				Size Editable? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Поиск:
				Resource Id: 3917
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.131"
					Width:  0.675"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgSearchStr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSearchStr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.857"
						Top:    0.107"
						Width:  8.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: System Window Color
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set nRow = -1
						Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
						Return VALIDATE_OkClearFlag
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.114"
						Top:    0.476"
						Width:  9.0"
						Width Editable? Yes
						Height: 3.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: System Window Color
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 30000
					Discardable? No
				Contents
					Column: colCardId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № картки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFio
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ФІО утримувача
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTip
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип інструменту
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер рахунку 
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: sWhere
				Message Actions
					On SAM_DoubleClick
						! Выборка счета для ввода из справочника
						Set sNls = SalStrTrimX(colNls)
						Set sNms = SalStrTrimX(colFio)
						Call SqlPrepareAndExecute(hSql(),
								"SELECT c.okpo INTO :sOkpo FROM customer c, cust_acc b, accounts a
								 WHERE a.acc=b.acc and b.rnk=c.rnk and a.nls=:sNls")
						Call SqlFetchNext(hSql(), nFetchRes)
						Call SalEndDialog(dlgAccMBO, TRUE)
					On SAM_Create
						Call SalSendMsgToChildren(hWndItem, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags(hWndItem, TBL_Flag_SuppressLastColLine | TBL_Flag_SingleSelection, TRUE)
						Call SalWaitCursor(TRUE)
						Set sSql = 
								"SELECT acs_id, fio, tool_name, nls
								 INTO :colCardId, :colFio, :colTip, :colNls  
								 FROM NN_CARD_LOOKUP "
						Set sWhere = ""
						Call SqlPrepareAndExecute(hSql(), T("SELECT nbs FROM ps_tts WHERE tt=:sTT and dk=:nDk"))
						If SqlFetchNext(hSql(), nFetchRes) ! Есть ограничения на б/с
							Set sWhere = IifS(sWhere="", " WHERE ", " AND ") || " EXISTS (
									    SELECT p.nbs
									    FROM ps_tts p
									    WHERE p.tt=:sTT and p.dk=:nDk and
									          ( TRIM(p.nbs) = s.nbs[1,1] or
									            TRIM(p.nbs) = s.nbs[1,2] or
									            TRIM(p.nbs) = s.nbs[1,3] or p.nbs=s.nbs))"
						If sNls
							Set sWhere = IifS(sWhere="", " WHERE ", " AND ") || " nls  LIKE '" || StrMatches2Like(sNls) || "'"
						Call SalTblPopulate(hWndForm, hSql(), sSql || sWhere || " ORDER BY acs_id, tool_name", TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_KillFocus
						Call SalMapEnterToTab(TRUE)
					On SAM_SetFocus
						Call SalMapEnterToTab(FALSE)
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.433"
					Top:    4.048"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Return SalSendMsg(tbl, SAM_DoubleClick, 0, 0)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   7.567"
					Top:    4.048"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, FALSE)
			Pushbutton: pbSearch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSearch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.333"
					Top:    4.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F7
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalTblQueryFocus(tbl, nRow, hWndCol)
						Set nRow = VisTblFindString(tbl, nRow+1, hWndNULL, dfSearchStr)
						If nRow != -1
							Call SalTblSetFocusRow(tbl, nRow)
		Functions
		Window Parameters
			String: sTT
			Number: nDk
			Receive String: sNls
			Receive String: sNms
			Receive String: sOkpo
		Window Variables
			String: sSql
			Number: nRow
			Window Handle: hWndCol
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
	!
	Form Window: frmMVOZIK
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Работа с файлами ЗиК ТУ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.438"
				Top:    1.083"
				Width:  14.333"
				Width Editable? Class Default
				Height: 7.0"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: работа с файлами ЗиК на уровне ТУ
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.893"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Удалить (возвратить)'
							! Call SalSendClassMessage(SAM_Create, 0, 0)
						On SAM_Click
							! выбрать причину возврата
							If FunNSIGet('BP_REASON', '', sStornoReasonId, sStornoReason)
								If sStornoReasonId
									If SqlPrepareAndExecute(hSql(), '
											   DELETE
											   FROM mvolz
											   WHERE namef=:tbl.colFileIn') and SqlCommit(hSql())
										Call MessageNoWait('Информация по файлу ' || tbl.colFileIn ||
												     ' удалена (возвращена). Причина возврата: ' || sStornoReason,
												     'Сообщение', 17, 1)
									Else
										Call MessageNoWait('Ошибка при удалении (возврате) информация по файлу ' ||
												     tbl.colFileIn, 'ОШИБКА!', 17, 0)
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.033"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.533"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50761
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.033"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set strFilter = SalStrTrimX(frmMVOZIK.tbl.cF.GetFilterWhereClause(FILTER_StandAlone))
							Set strFilter = IifS(Len(strFilter) = 0, '', ' and ' ||strFilter)
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50762
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.533"
						Top:    0.548"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50763
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! cTBarButton: pbDel
					                                                                                                             Message Actions
						                                                                                                             On SAM_Create
							                                                                                                             Set strTip = 'Удалить информацию'
						                                                                                                             On SAM_Click
							                                                                                                             If tbl.colOtm = 1
								! выбрать из справочника причин возврата + удалить из таблицы MVOLZ
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.033"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Принять файл'
						On SAM_Click
							! 1. Прочитать файл
									  2. Проверить подпись
									  3. Поместить тело файла в MVOLZ + дата приёма
							If tbl.colOtm = 0
								If tbl.colVidzach != STRING_Null
									! Call Debug(tbl.colFileIn)
									Set nLenFile = VisFileGetSize(sPATHI || tbl.colFileIn)
									Call SalFileOpen(fH, sPATHI || tbl.colFileIn, OF_Read)
									Set s65534 = Spac(nLenFile)
									Call SalFileRead(fH, s65534, nLenFile)
									Call SalFileClose(fH)
									! проверить подпись файла
											  1. передаем буфер s65534
											  2. получаем код возврата
									If VerifySign(s65534, nLenFile) = 0
										! good, погнали работать дальше
										! проверка структуры файла
										If VerifyStru(s65534, nLenFile) = 0
											! проверка принадлежности счетов к данному учреждению
											If AccTU()
												! проверка статуса счетов (открыт/закрыт)
												If AccOpen()
													! проверка принадлежности шифров вкладов к данному учреждению
													If SchTU()
														! проверка сум файла
														If SumTU()
															Set dPriem = DATETIME_Null
															If SqlPrepareAndExecute(hSql(), '
																	   SELECT datpf
																	   INTO :dPriem
																	   FROM mvolz
																	   WHERE namef=:tbl.colFileIn') and SqlFetchNext(hSql(), nFetchRes)
															Set dServerDate = GetServerDate()
															Set nRet = 0
															If dPriem = DATETIME_Null
																If SqlPrepareAndExecute(hSql(),  "
																		   INSERT
																		   INTO mvolz (datpf,namef,mfotu,summf,comnt,otm,vidz)
																		   VALUES (:dServerDate,:tbl.colFileIn,:sKODtobo,:tbl.colSumAll,
																		           'Принят',1,:tbl.colDocType)")
																	If PutStringToBlob(hSql(), s65534, 'mvolz', 'namef', 'bodyf', NUMBER_Null, tbl.colFileIn, STRING_Null, 0)
																		Call SqlCommit(hSql())
																		Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHG || tbl.colFileIn)
																		If File(sPATHG || tbl.colFileIn)
																			Call VisFileDelete(sPATHI || tbl.colFileIn)
																			Call MakeKwit(tbl.colFileIn, 0, 0) ! хорошая квитанция
																			If not wParam
																				Call SalSendMsg(tbl, UM_Populate, 0, 0)
																		! Set bP = TRUE
																	Else
																		Call SqlRollback(hSql())
																		Call MessageNoWait('Ошибка(1) записи информации из файла ' ||
																				     tbl.colFileIn || ' ...', 'ОШИБКА!', 7, 1)
																		! Set bP = FALSE
																		! Set nRet = 99
																Else
																	Call SqlRollback(hSql())
																	Call MessageNoWait('Ошибка(2) записи информации из файла ' ||
																			     tbl.colFileIn || ' ...', 'ОШИБКА!', 7, 1)
																	! Set bP = FALSE
																	! Set nRet = 99
															Else
																Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
																If File(sPATHB || tbl.colFileIn)
																	Call VisFileDelete(sPATHI || tbl.colFileIn)
																	Call MakeKwit(tbl.colFileIn, 2, 0)
																			     !  2 - повторный приём файла
																			     ! 99 - ошибка ORACLE при приёме
																	If not wParam
																		Call SalSendMsg(tbl, UM_Populate, 0, 0)
																! Set bP = TRUE
														Else
															! загнать файл в BAD
															Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
															If File(sPATHB || tbl.colFileIn)
																Call VisFileDelete(sPATHI || tbl.colFileIn)
																Call MakeKwit(tbl.colFileIn, 6, 0) ! ошибка суммы
																If not wParam
																	Call SalSendMsg(tbl, UM_Populate, 0, 0)
													Else
														! загнать файл в BAD
														Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
														If File(sPATHB || tbl.colFileIn)
															Call VisFileDelete(sPATHI || tbl.colFileIn)
															Call MakeKwit(tbl.colFileIn, 5, 0) ! ошибка шифров вкладов ТУ
															If not wParam
																Call SalSendMsg(tbl, UM_Populate, 0, 0)
												Else
													! загнать файл в BAD
													Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
													If File(sPATHB || tbl.colFileIn)
														Call VisFileDelete(sPATHI || tbl.colFileIn)
														Call MakeKwit(tbl.colFileIn, 7, 0) ! ошибка
														If not wParam
															Call SalSendMsg(tbl, UM_Populate, 0, 0)
											Else
												! загнать файл в BAD
												Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
												If File(sPATHB || tbl.colFileIn)
													Call VisFileDelete(sPATHI || tbl.colFileIn)
													Call MakeKwit(tbl.colFileIn, 4, 0) ! ошибка принадлежности счетов ТУ
													If not wParam
														Call SalSendMsg(tbl, UM_Populate, 0, 0)
										Else
											! загнать файл в BAD
											Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
											If File(sPATHB || tbl.colFileIn)
												Call VisFileDelete(sPATHI || tbl.colFileIn)
												Call MakeKwit(tbl.colFileIn, 3, 0) ! неверна структура
												If not wParam
													Call SalSendMsg(tbl, UM_Populate, 0, 0)
									Else
										! загнать файл в BAD
										Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
										If File(sPATHB || tbl.colFileIn)
											Call VisFileDelete(sPATHI || tbl.colFileIn)
											Call MakeKwit(tbl.colFileIn, 1, 0) ! подпись неверна
											If not wParam
												Call SalSendMsg(tbl, UM_Populate, 0, 0)
								Else
									Call MessageNoWait('Не определён вид зачисления.', 'Ошибка !', 17, 1)
				Pushbutton: pbRunAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.533"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Принять ВСЕ "свежие" файлы'
						On SAM_Click
							Set nRow1 = TBL_MinRow
							While SalTblFindNextRow(tbl, nRow1, 0, 0)
								Call SalTblSetContext(tbl, nRow1)
								Call SalTblSetFocusRow(tbl, nRow1)
								If tbl.colOtm = 0
									Call tbl.colVidzach.SetSelectById(Val(sREJAV))
									Set tbl.colDocType = Val(sREJAV)
									Call SalSendMsg(pbRun, SAM_Click, Val(sREJAV), 0)
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbKwitF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    0.536"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Создать квитанцию о фактическом зачислении'
						On SAM_Click
							If MakeKwit(tbl.colFileIn, 0, 1)
								If SqlPrepareAndExecute(hSql(), '
										   UPDATE mvolz
										   SET otm=3
										   WHERE namef=:tbl.colFileIn') and SqlCommit(hSql())
									Call SalSendMsg(tbl, UM_Populate, 0, 0)
				! cMeter: ccProgressBar
					                                                                                                                                              Message Actions
				! Combo Box: cmbOtm
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.217"
						Top:    0.095"
						Width:  3.55"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
.end
					                                                                                                                List Initialization
					                                                                                                                Message Actions
				Radio Button: rbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все
					Window Location and Size
						Left:   3.25"
						Top:    0.167"
						Width:  0.833"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbGet
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Принятые
					Window Location and Size
						Left:   4.133"
						Top:    0.167"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbOpl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Оплаченные
					Window Location and Size
						Left:   5.583"
						Top:    0.167"
						Width:  1.617"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbNew
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Свежие
					Window Location and Size
						Left:   7.25"
						Top:    0.167"
						Width:  1.233"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Royal Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbFact
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Факт.зачисленные
					Window Location and Size
						Left:   8.533"
						Top:    0.167"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Group Box: Файлы
					Resource Id: 50764
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.183"
						Top:    0.0"
						Width:  8.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Radio Button: rbDall
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все даты
					Window Location and Size
						Left:   0.15"
						Top:    0.167"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If rbDall
								Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
							Else
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbDtek
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тек.дата
					Window Location and Size
						Left:   1.65"
						Top:    0.167"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Group Box: Даты
					Resource Id: 50765
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.05"
						Top:    0.0"
						Width:  3.017"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dfTobo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.133"
							Top:    0.56"
							Width:  2.117"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							If SalIsNull(dfTobo)
								Call SalListSetSelect(cmbKODtobo, -1)
								Return VALIDATE_Ok
							Call cmbKODtobo.SetSelectById(dfTobo)
							If cmbKODtobo.strCurrentId
								Set sKODtobo = dfTobo
								Set sNCKS = GetValueStr("
										    SELECT val
										    FROM tobo_params
										    WHERE tag='NCKS' and tobo='" || sKODtobo || "'")
								Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
								Return VALIDATE_Ok
							Else
								Return VALIDATE_Cancel
				Combo Box: cmbKODtobo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.283"
						Top:    0.56"
						Width:  5.6"
						Width Editable? Class Default
						Height: 1.964"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbKODtobo.Init(hWndItem)
								Call cmbKODtobo.Populate(hSql(), 'tobo', 'name', 'tobo', "WHERE tobo<>'0' ORDER BY tobo")
								! Call cmbKODtobo.SetSelectById(dfTobo)
								Call SalListSetSelect(hWndItem, 0)
								Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set dfTobo = cmbKODtobo.strCurrentId
							Set sKODtobo = dfTobo
							Set sNCKS = GetValueStr("
									    SELECT val
									    FROM tobo_params
									    WHERE tag='NCKS' and tobo='" || sKODtobo || "'")
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Background Text: Всего
					Resource Id: 45943
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.983"
						Top:    0.583"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
				Data Field: dfCount
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   13.167"
							Top:    0.56"
							Width:  0.917"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.367"
						Width Editable? Class Default
						Height: 2.024"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colDatIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата поступления
								файла
								(приёма)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.817"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.167"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSumAll
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								документов
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.133"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSАВО
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								кред.задолженности
								 САБО (1)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.9"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colMVO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								деб.задолженности
								МВО (2)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.917"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDELTA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: САБО(1)
								-
								МВО(2)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDatForm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата обработки
								файла
								(оплаты)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.85"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVidzach ! cColumnLabeled - было
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Вид
								зачисления
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If colVidzach.Init(hWndItem)
									Call colVidzach.Populate(hSql(), 'id', 'vid', 'mvovidz', 'order by id')
							On SAM_AnyEdit
								! Call hWndParent.Frm_Customer.IsEdited()
								Set tbl.colDocType = frmMVOZIK.tbl.colVidzach.GetKey(
										    SalListQuerySelection(colVidzach))
					Column: colComments
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOtm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colUin
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colUout
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNls2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNam2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOkpo2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDocType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 1
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Boolean: bG
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Set strSqlPopulate = "
								    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,sa.ostc,a.ostc,sa.ostc-a.ostc
								    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,
								         :colMVO,:colDELTA
								    FROM mvolz m, saboaccounts sa, accounts a
								    WHERE m.mfotu=:sKODtobo and a.nls(+)=:sDebZab and a.kv(+)=980 and
								          sa.nls(+)=:sKredZab and sa.kv(+)=980
								    ORDER BY 1"
						Set sFilt1 = IifS(rbAll, '', IifS(rbGet, ' and mvolz.otm = 1', IifS(rbOpl, ' and mvolz.otm=2',
								    IifS(rbFact, ' and mvolz.otm=3', ' and mvolz.otm=0'))))
						Set sFilt2 = IifS(rbDall, '', ' and TRUNC(mvolz.datpf)=TRUNC(sysdate)')
						! If bLink
							                                             Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,sa.ostc/100,-a.ostc/100,
									           (sa.ostc+a.ostc)/100,mv.id,mv.vid
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,
									         :colMVO,:colDELTA,:colDocType,:colVidzach
									    FROM mvolz m, saboaccounts sa, accounts a, tobo_params t1, tobo_params t2,
									         mvovidz mv
									    WHERE m.mfotu=:sKODtobo and m.MFOTU=t1.tobo and t1.tag='4629_R' and
									          t1.val=a.nls(+) and a.kv(+)=980 and m.MFOTU=t2.tobo and
									          t2.tag='4629_R' and t2.val=sa.nls(+) and sa.kv(+)=980 and m.vidz=mv.id" ||
									          sFilt1 || sFilt2 || "
									    ORDER BY 1"
						! Else
							                                             Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,0,-a.ostc/100,a.ostc/100,
									           mv.id,mv.vid
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,
									         :colMVO,:colDELTA,:colDocType,:colVidzach
									    FROM mvolz m, accounts a, tobo_params t1, mvovidz mv
									    WHERE m.mfotu=:sKODtobo and m.MFOTU=t1.tobo and t1.tag='4629_R' and
									          t1.val=a.nls(+) and a.kv(+)=980 and m.vidz=mv.id" || sFilt1 || sFilt2 || "
									    ORDER BY 1"
						Set strSqlPopulate = "
								    SELECT mvolz.datpf, mvolz.namef, mvolz.summf, mvolz.datof,
								           mvolz.comnt, mvolz.otm,   sa.ostc/100, -a.ostc/100,
								           (sa.ostc + a.ostc)/100,   mv.id,       mv.vid, 1
								      INTO :colDatIn,    :colFileIn,  :colSumAll,  :colDatForm,
								           :colComments, :colOtm,     :colSАВО,    :colMVO,
								           :colDELTA,    :colDocType, :colVidzach, :col1
								      FROM mvolz, 
								           saboaccounts sa, 
								           accounts     a, 
								           tobo_params  t1, 
								           tobo_params  t2, 
								           mvovidz      mv
								     WHERE mvolz.mfotu = :sKODtobo 
								       AND mvolz.mfotu = t1.tobo 
								       AND t1.tag      = '4629_R' 
								       AND t1.val      = a.nls(+) 
								       AND a.kv(+)     = 980 
								       AND mvolz.mfotu = t2.tobo 
								       AND t2.tag      = '4629_R' 
								       AND t2.val      = sa.nls(+) 
								       AND sa.kv(+)    = 980 
								       AND mvolz.vidz  = mv.id" ||sFilt1||sFilt2||strFilter||
								   " ORDER BY 1"
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						! Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
						Set bG = TRUE
						While bG
							When SqlError
								Set strCurrentSql = SqlGetLastStatement()
								Call SqlExtractArgs(wParam, lParam, hSqlErrorHandle, nErrorNum, nErrorPos)
								Set strErrorText = SqlGetErrorTextX(nErrorNum)
								Set strErrorText = VisStrSubstitute(strErrorText, Chr(10), PutCrLf())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Возможно разорвано соединение с основной базой данных.
										
										Системное описание ошибки:
										
										' || strErrorText || '
										
										' || strCurrentSql, 'ОШИБКА!!!', 3, 1)
								! Call MessageNoWait('Возможно разорвано соединение с основной базой данных.
										
										Системное описание ошибки:
										
										' || strErrorText, 'ОШИБКА !!!', 3, 1)
								Call SalWaitCursor(TRUE)
								Return FALSE
							If SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
								! прочитать входной каталог и доселить таблицу именами "свежых" файлов
								! Call Debug(sNCKS)
								Set nFiles = VisDosEnumFiles(sPATHI || '\\LZ' || sNCKS || '??.???', FA_Standard,
										    smFiles)
								If nFiles > 0
									Set nI = 0
									While nI < nFiles
										Set nNewRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
										Call SalTblSetContext(hWndForm, nNewRow)
										Set colFileIn = smFiles[nI]
										Set colOtm = 0
										Set colComments = 'Свежий файл'
										! Call colVidzach.SetSelectById(1)
										! Set colDocType = 1
										Set nI = nI + 1
									Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
								Set dfCount = SalTblColumnSum(tbl, SalTblQueryColumnID(col1), 0, 0) + Max(nFiles, 0)
								Call VisTblAutoSizeColumn(tbl, hWndNULL)
								If SalTblSetFocusRow(hWndForm, 0) and SalTblSetContext(hWndForm, 0)
									Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
								Else
									Set nCurrentRow = TBL_MinRow
									Loop
										If SalTblFindNextRow(tbl2, nCurrentRow, 0, 0)
											Call SalTblDeleteRow(tbl2, nCurrentRow, TBL_Adjust)
										Else
											Break
								Set bG = FALSE
								! Call SalTblSetFocusRow(hWndForm, 0)
								! Call SalTblSetContext(hWndForm, 0)
								! Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
							Else
								! Call Debug('6')
								If At('saboaccounts', strSqlPopulate) > 0
									! Call Debug('7')
									Set strSqlPopulate = "
											    SELECT mvolz.datpf, mvolz.namef, mvolz.summf, mvolz.datof,
											           mvolz.comnt, mvolz.otm,   0,           -a.ostc/100, 
											           a.ostc/100,  mv.id,       mv.vid,      1
											      INTO :colDatIn,   :colFileIn,  :colSumAll,  :colDatForm,
											           :colComments,:colOtm,     :colSАВО,    :colMVO,
											           :colDELTA,   :colDocType, :colVidzach, :col1
											      FROM mvolz, 
											           accounts    a, 
											           tobo_params t1, 
											           mvovidz     mv
											     WHERE mvolz.mfotu = :sKODtobo 
											       AND mvolz.mfotu = t1.tobo 
											       AND t1.tag      = '4629_R' 
											       AND t1.val      = a.nls(+)
											       AND a.kv(+)     = 980 
											       AND mvolz.vidz  = mv.id"||sFilt1||sFilt2||strFilter||
											  "  ORDER BY 1"
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Set strFilter = ''
						Set strSqlUpdate = "
								    UPDATE mvolz
								    SET comnt=:tbl.colComments
								    WHERE namef=:tbl.colFileIn and otm=1"
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
						If sREJIM = '1'
							! Call SalUpdateWindow(hWndForm)
							! Call SalInvalidateWindow(hWndForm)
							! Call Wait(2)
							Call SalSendMsg(pbRunAll, SAM_Click, 0, 0)
					On SAM_TblDoDetails
						If tbl.colOtm > 0
							Call SalDisableWindow(pbRun)
						Else
							Call SalEnableWindow(pbRun)
						If tbl.colOtm = 2
							Call SalEnableWindow(pbKwitF)
						Else
							Call SalDisableWindow(pbKwitF)
						If tbl.colOtm = 1
							Call SalEnableWindow(pbDel)
						Else
							Call SalDisableWindow(pbDel)
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare(hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(tbl, hSql(), TRUE)
						Call SqlCommit(hSql())
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						If colOtm = 1
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
						Else If colOtm = 2
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Orchid)
						Else If colOtm = 3
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Periwinkle)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalTblSetContext(hWndForm, 0)
						Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.1"
						Width:  14.367"
						Width Editable? Class Default
						Height: 3.131"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Class Default
				Contents
					Column: colPAN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: PAN
						Visible? Class Default
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.417"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSUMA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.667"
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSCH_VKL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Шифр вклада
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: Number
						Justify: Right
						Width:  1.767"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						If tbl.colOtm > 0
							! прочитать в файл (DBF)
							Set sLong = GetStringFromBlob(hSqlAux2(), 'mvolz', 'namef', 'bodyf', NUMBER_Null, tbl.colFileIn, STRING_Null)
						Else
							! прочитать оригинальный файл (DBF) в переменную sLong
							Set nLenFile = VisFileGetSize(sPATHI || tbl.colFileIn) ! - 88
							Call SalFileOpen(fH, sPATHI || tbl.colFileIn, OF_Read)
							Set sLong = Spac(nLenFile)
							Call SalFileRead(fH, sLong, nLenFile)
							Call SalFileClose(fH)
						Call SalFileOpen(fH, sPATHT || tbl.colFileIn, OF_Create | OF_Write)
						! определяем количество записей в файле
						Set sTemp = '    '
						Call InsertBuf(sTemp, 0, sLong, 4, 4)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set n3 = SalStrLop(sTemp)
						Set n4 = SalStrLop(sTemp)
						Set nNumberZap = n4*256*256*256 + n3*256*256 + n2*256 + n1
						! Call Debug('nNumberZap='||Str(nNumberZap))
						! определяем длину заголовка
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 8, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nHeader = n2*256 + n1
						! Call Debug('nHeader='||Str(nHeader))
						! определяем длину записи
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 10, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nLenZap = n2*256 + n1
						! Call Debug('nLenZap='||Str(nLenZap))
						!
						Set nLenFile = nHeader + nNumberZap*nLenZap
						! Call Debug('nLenFile='||Str(nLenFile))
						!
						! Call DebugN(nLenFile)
						!
						Set s65534 = Spac(nLenFile)
						Call InsertBuf(s65534, 0, sLong, 0, nLenFile)
						Call SalFileWrite(fH, s65534, nLenFile)
						Call SalFileClose(fH)
						! Call Debug('4')
						Set nCurrentRow = TBL_MinRow
						Loop
							If SalTblFindNextRow(hWndForm, nCurrentRow, 0, 0)
								Call SalTblDeleteRow(hWndForm, nCurrentRow, TBL_Adjust)
							Else
								Break
						If VerifyStru(s65534, nLenFile) = 0
							Call SalFileGetCurrentDirectory(sCurrentDir)
							Call SalFileSetCurrentDirectory(sPATHT)
							Set SqlDatabase = 'dBase_Files'
							Call SqlConnect(hSqlA)
							If SqlPrepareAndExecute(hSqlA, "
									   SELECT PAN,SUMA,SCH_VKL
									   FROM " || tbl.colFileIn || "
									   INTO :sPAN,:nSUMA,:nSCH_VKL")
								Set tbl.colSumAll = 0
								While SqlFetchNext(hSqlA, nFetchRes)
									Set nRow = SalTblInsertRow(tbl2, TBL_MaxRow)
									Call SalTblSetContext(tbl2, nRow)
									Set tbl2.colPAN = SalStrTrimX(StrDosToWinX(sPAN))
									Set tbl2.colSUMA = nSUMA
									Set tbl2.colSCH_VKL = nSCH_VKL
									If Left(tbl2.colPAN, 1) != '@'
										Set tbl.colSumAll = tbl.colSumAll + nSUMA
								Call SalFileSetCurrentDirectory(sCurrentDir)
								Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
								Call VisTblAutoSizeColumn(tbl2, hWndNULL)
							Call SqlDisconnect(hSqlA)
						Call VisFileDelete(sPATHT || tbl.colFileIn)
						Call SalWaitCursor(FALSE)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
		Functions
			Function: UNIFormatGSSMessage
				Description: возвращает описание ошибки ЭЦП UNI функций GSS
				Returns
					String:
				Parameters
					Number: minor_status
					Number: status_value
				Static Variables
				Local variables
					String: strMessage
					String: strBuf
					String: strBuf2
					Number: nMsgSize
					Number: nBufAddress
					Number: nMsgSize2
					Number: nBufAddress2
					Number: message_context
					Number: maj_status
					Number: min_status
				Actions
					Set strMessage = ''
					! --1
					Call SalStrSetBufferLength(strBuf, 4096)
					Set message_context = 0
					Set nMsgSize = 0
					Set nBufAddress = 0
					Set maj_status = gss_display_status(min_status,	status_value, 1, 0, message_context,  nMsgSize, nBufAddress)
					Call memmove(strBuf, NumPtr2Str(nBufAddress), nMsgSize)
					Set strBuf = Left(strBuf, nMsgSize) || Chr(0)
					Call gss_release_buffer(min_status, nMsgSize, nBufAddress)
					Set strMessage = strMessage || strBuf
					! --2
					Call SalStrSetBufferLength(strBuf2, 4096)
					Set message_context = 0
					Set nMsgSize2 = 0
					Set nBufAddress2 = 0
					Set maj_status = gss_display_status(min_status, minor_status, 2, 0, message_context,
							    nMsgSize2, nBufAddress2)
					Call memmove(strBuf2, NumPtr2Str(nBufAddress2), nMsgSize2)
					Set strBuf2 = Left(strBuf2, nMsgSize2) || Chr(0)
					Call gss_release_buffer(min_status, nMsgSize2, nBufAddress2)
					Set strMessage = strMessage || strBuf2
					Return 'UNI: KeyID=' || GetIdOper() || PutCrLf() || 'minor_status=' || SalNumberToStrX(minor_status, 0) || ' (' ||
							       NumberToHexSX(minor_status) || ')' || PutCrLf() || 'status_value=' || SalNumberToStrX(status_value, 0) || ' (' ||
							       NumberToHexSX(status_value) || ')' || PutCrLf() || strMessage
			Function: MakeKwit
				Description: выдача сообщений и формирование квитанций
				Returns
					Boolean:
				Parameters
					String: sFilename
					Number: nCod
					Number: nPlanFact
				Static Variables
				Local variables
				Actions
					Select Case (nCod)
						Case 0
							! Call MessageNoWait(sFilename || ': файл принят к ' || IifS(nPlanFact=0, 'планов', 'фактическ') ||
									     'ому зачислению.', 'Сообщение!', 17, 0)
							! If nPlanFact = 0
								                                                                              Call MessageNoWait(sFilename || ': файл принят к плановому зачислению.', 'Сообщение!', 17, 0)
							If MakeFileKwit(sFilename, nCod, nPlanFact)
								Call MessageNoWait(sFilename || ': файл принят к ' || IifS(nPlanFact=0, 'планов', 'фактическ') ||
										     'ому зачислению.', 'Сообщение!', 17, 0)
							Break
						Case 1
							Call MessageNoWait(sFilename || ': ошибка подписи файла.', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 2
							Call MessageNoWait(sFilename || ': повторный приём файла.', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 3
							Call MessageNoWait(sFilename || ': неверна структура файла.', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 4
							Call MessageNoWait(sFilename || ': ошибка принадлежности клиентских счетов к данному учреждению.', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 5
							Call MessageNoWait(sFilename || ': ошибка шифров вкладов данного учреждения.', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 6
							Call MessageNoWait(sFilename || ': несовпадение расчётной общей суммы зачислений с суммой, указанной в файле.',
									     'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
						Case 7
							Call MessageNoWait(sFilename || ': ошибка статуса счетов (открыт/закрыт).', 'ОШИБКА!', 17, 1)
							Call MakeFileKwit(sFilename, nCod, 0)
							Break
					Return TRUE
			Function: MakeFileKwit
				Description: формирует файл квитанции в каталог sPATHK
				Returns
					Boolean:
				Parameters
					String: sFilename
					Number: nCod
					Number: nPlanFact
				Static Variables
				Local variables
					File Handle: fH
					String: sBuf
					String: sText
					Number: nSumAll
					Number: nSumFrag
					Boolean: bBeginFrag
					Boolean: bBeginPAN
					Number: nRow
					Number: nCounter
					String: sVID
					String: sReason
					String: sTobo
					Number: nContext
					String: sAllBuf
					Number: nAllLen
					String: sSign
					Number: nErrorSign
					Number: nSignHandle
					Number: min_status
					Number: nSignLen
					Number: nCertHandle
					Number: nCertLen
					!
					String: sNls
					Number: nSch
				Actions
					! создать файл
					Set sAllBuf = ''
					If File(sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
						Call VisFileCopy(sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10),
								                 sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
						Set nAllLen = VisFileGetSize(sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
						! Call DebugN(nAllLen)
						Call VisFileOpen(fH, sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10), OF_Read | OF_Write)
						Set sAllBuf = Spac(nAllLen+1)
						Call VisFileRead(fH, sAllBuf, nAllLen+1)
						Call VisFileSeek(fH, 0, SEEK_End)
						! Set nAllLen = VisFileTell(fH)
						! Call VisFileSeek(fH, 0, SEEK_Begin)
						! Call VisFileSeek(fH, 0, SEEK_End)
						Set sBuf = Repl(PutCrLf(), 2)
						Call VisFileWrite(fH, sBuf, Len(sBuf))
						Set sAllBuf = sAllBuf || sBuf
						! Call DebugN(Len(sBuf))
					Else
						Call VisFileOpen(fH, sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10), OF_Create | OF_ReadWrite)
					! записать тело
					Set sBuf = SalFmtFormatDateTime(GetServerDate(), 'dd.MM.yyyy hhhh:mm:ss') || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					Set sBuf = 'Вхідний файл: ' || sPATHI || sFilename || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					Set sBuf = 'Виконавець: ' || GetUserRealName() || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					Set sBuf = PutCrLf() || '***** Start - ' || SalFmtFormatDateTime(GetServerDate(), 'dd.MM.yyyy hhhh:mm:ss') || ' *****'
							    || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					Set sBuf = 'Протокол ' || IifS(nPlanFact=0, 'планов', 'фактичн') || 'ого зарахування (' || tbl.colVidzach ||
							    ') на рахунки списком =====' || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					If nPlanFact = 0
						If nCod != 0                                    ! формировать код и ошибку
							Select Case (nCod)
								Case 1
									Set sText = 'невірний підпис'
									Break
								Case 2
									Set sText = 'повторний прийом'
									Break
								Case 3
									Set sText = 'невірна структура'
									Break
								Case 4
									Set sText = 'помилки належності рахунків'
									Break
								Case 5
									Set sText = 'помилки шифрів вкладів'
									Break
								Case 6
									Set sText = 'помилка суми'
									Break
								Case 7
									Set sText = 'помилка статусу рахунків'
									Break
							Set sBuf = PutCrLf() || 'Помилка: код = ' || Right(Str(10000+nCod), 4) || ' - ' || sText || PutCrLf()
							Call VisFileWrite(fH, sBuf, Len(sBuf))
							Set sAllBuf = sAllBuf || sBuf
							! Call DebugN(Len(sBuf))
					If nCod = 0 or nCod = 5 or nCod = 4 or nCod = 6 or nCod = 7 or nCod = 2 ! формировать тело
						Set nSumAll = 0
						Set nSumFrag = 0
						Set bBeginFrag = TRUE
						Set bBeginPAN = TRUE
						Set nCounter = 1
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl2, nRow, 0, 0)
							Call SalTblSetContext(tbl2, nRow)
							! Call SalTblSetFocusRow(tbl, nRow)
							If Left(tbl2.colPAN, 1) = '@'
								If nCounter > 1 and nSumFrag > 0
									Set sBuf = PutCrLf() || '    Підсумок' || PadL(SalNumberToStrX(nSumFrag, 2), 32) || PutCrLf()
									Call VisFileWrite(fH, sBuf, Len(sBuf))
									Set sAllBuf = sAllBuf || sBuf
									! Call DebugN(Len(sBuf))
									Set nSumFrag = 0
									Set bBeginFrag = TRUE
									Set bBeginPAN = TRUE
								Set sBuf = IifS(bBeginFrag, PutCrLf(), '') || IifS(bBeginFrag, PadR(tbl2.colPAN, 15) || PadL(
										    SalNumberToStrX(tbl2.colSUMA, 2), 29), tbl2.colPAN) || PutCrLf()
								Call VisFileWrite(fH, sBuf, Len(sBuf))
								Set sAllBuf = sAllBuf || sBuf
								! Call DebugN(Len(sBuf))
								Set bBeginFrag = not bBeginFrag
							Else
								Set sNls = tbl2.colPAN
								Set nSch = tbl2.colSCH_VKL
								Set sReason = ''
								If nPlanFact = 0
									! If nCod = 4 and GetValueStr("
											   SELECT tobo
											   FROM accounts
											   WHERE nls='" || tbl2.colPAN || "' and kv=980") != sKODtobo
										                                                                              Set sReason = 'помилка належності рахунку'
									If nCod = 4
										If nPar = 3
											If not SqlPLSQLCommand(hSql(), "nn.p_check_salary(1,sNls,sKODtobo,nSch,sReason,1)")
												Set sReason = 'помилка обробки помилок'
										Else
											If not SqlPLSQLCommand(hSql(), "nn.p_check_salary(1,sNls,sKODtobo,nSch,sReason,0)")
												Set sReason = 'помилка обробки помилок'
									If nCod = 5
										! Set sTobo = GetValueStr("
												    SELECT tobo
												    FROM dpt_vidd
												    WHERE vidd=" || Str(tbl2.colSCH_VKL))
										! If sTobo != STRING_Null and sTobo != sKODtobo
											                                                                              Set sReason = 'Помилка шифру вкладу'
										! If SqlPrepareAndExecute(hSql(), '
												   SELECT tobo
												   INTO :sTobo
												   FROM dpt_vidd
												   WHERE vidd=:tbl2.colSCH_VKL') and SqlFetchNext(hSql(), nFetchRes)
											                                                                              If sTobo != STRING_Null and sTobo != sKODtobo
												                                                                              Set sReason = 'помилка шифру вкладу'
										! Set sTobo = STRING_Null
										! If SqlPrepareAndExecute(hSql(), '
												   SELECT max(p.tobo)
												   INTO :sTobo
												   FROM dpt_vidd v, dpt_vidd_prinsider vp, prinsider p
												   WHERE v.vidd=vp.vidd and vp.ins=p.prinsider and v.vidd=:tbl2.colSCH_VKL') and
												   SqlFetchNext(hSql(), nFetchRes)
											                                                                              If sTobo != STRING_Null and sTobo != sKODtobo
												                                                                              Set sReason = 'помилка шифру вкладу'
										! Else
											                                                                              Set sReason = 'помилка шифру вкладу'
										If not SqlPLSQLCommand(hSql(), "nn.p_check_salary(2,sNls,sKODtobo,nSch,sReason,0)")
											Set sReason = 'помилка обробки помилок'
									! If nCod = 7 and GetValueStr("
											   SELECT to_char(DAZS)
											   FROM accounts
											   WHERE nls='" || tbl2.colPAN || "' and kv=980") = STRING_Null
										                                                                              Set sReason = 'помилка статусу рахунку (закритий)'
									If nCod = 7
										If not SqlPLSQLCommand(hSql(), "nn.p_check_salary(2,sNls,sKODtobo,nSch,sReason,0)")
											Set sReason = 'помилка обробки помилок'
								Set sBuf = IifS(bBeginPAN, PutCrLf(), '') || PadL(Str(nCounter), 3) || ' ' || PadR(tbl2.colPAN, 15) || '- ' ||
										    PadL(Str(tbl2.colSCH_VKL), 5) || ' - ' || PadL(SalNumberToStrX(tbl2.colSUMA, 2), 15) || IifS(
										    Len(sReason)>0, '  ' || sReason, '') || PutCrLf()
								Call VisFileWrite(fH, sBuf, Len(sBuf))
								Set sAllBuf = sAllBuf || sBuf
								! Call DebugN(Len(sBuf))
								Set bBeginPAN = FALSE
								Set nSumAll = nSumAll + tbl2.colSUMA
								Set nSumFrag = nSumFrag + tbl2.colSUMA
								Set nCounter = nCounter + 1
						Set sBuf = PutCrLf() || '    Підсумок' || PadL(SalNumberToStrX(nSumFrag, 2), 32) || PutCrLf()
						Call VisFileWrite(fH, sBuf, Len(sBuf))
						Set sAllBuf = sAllBuf || sBuf
						! Call DebugN(Len(sBuf))
						Set sBuf = PutCrLf() || '    Всього' || PadL(SalNumberToStrX(nSumAll, 2), 34) || PutCrLf()
						Call VisFileWrite(fH, sBuf, Len(sBuf))
						Set sAllBuf = sAllBuf || sBuf
						! Call DebugN(Len(sBuf))
					Set sBuf = PutCrLf() || '***** End   - ' ||
							    SalFmtFormatDateTime(GetServerDate(), 'dd.MM.yyyy hhhh:mm:ss') || ' *****' || PutCrLf()
					Call VisFileWrite(fH, sBuf, Len(sBuf))
					Set sAllBuf = sAllBuf || sBuf
					! Call DebugN(Len(sBuf))
					If nPlanFact = 1 and sPRPDP = '1' and GetSignOn() = 1
						! подписать квитанцию
						! sAllBuf - весь файл
						If cDoc1.sIni()
							Call SalStrSetBufferLength(sSign, 88)
							Call SalStrSetBufferLength(sCertificate, 168)
							Set nErrorSign = NG_CREATE_SIGN_CRED(min_status, cDoc1.m_nCredHandle, Len(sAllBuf), sAllBuf, nSignLen, nSignHandle,
									    nCertLen, nCertHandle)
							If nErrorSign = 0
								Call ConvertHexToBin(NumPtr2HexStr(nSignHandle, nSignLen), sSign, nSignLen)
								! Call ConvertHexToBin(NumPtr2HexStr(nCertHandle, nCertLen), m_lsCertificate, nCertLen)
								Call VisFileWrite(fH, sSign, 88)
								! чистим память
								Call gss_release_buffer(min_status, nSignLen, nSignHandle)
								Call gss_release_buffer(min_status, nCertLen, nCertHandle)
							Else
								Call MessageErrorEx(UNIFormatGSSMessage(min_status, nErrorSign))
					Call VisFileClose(fH)
					! Call DebugN(Len(sAllBuf))
					If File(sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
						Call VisFileDelete(sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
					Call VisFileCopy(sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10),
							                 sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
					Call VisFileDelete(sPATHT || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
					Return File(sPATHK || IifS(nPlanFact=0, 'LP', 'LF') || Right(sFilename, 10))
			! Function: GetMVOlz
				                                                                              Description:
				                                                                              Returns
					                                                                              String:
				                                                                              Parameters
					                                                                              String: sPar
				                                                                              Static Variables
				                                                                              Local variables
					                                                                              String: sValue
				                                                                              Actions
					                                                                              If SqlPrepareAndExecute(hSql(), '
							   SELECT value
							   INTO :sValue
							   FROM mvolzw
							   WHERE tag=:sPar') and SqlFetchNext(hSql(), nFetchRes)
						                                                                              Return sValue
					                                                                              Else
						                                                                              Return ''
			Function: VerifySign
				Description:
				Returns
					Number:
				Parameters
					String: sTelo
					Number: nLen
				Static Variables
				Local variables
					String: sBuffer
					String: sSign
					Number: min_status
					Number: nErrorSign
				Actions
					If sPRPDP = '0' or GetSignOn() = 0
						Return 0
					Set sBuffer = Spac(nLen-88)
					Set sSign = Spac(88)
					Call InsertBuf(sBuffer, 0, sTelo, 0, nLen-88)
					Call InsertBuf(sSign, 0, sTelo, nLen-88, 88)
					! Call Debug(GetIdOper())
					If cDoc1.sIni()
						Call SalStrSetBufferLength(sCertificate, 168)
						Set nErrorSign = NG_VERIFY_SIGN_CRED(min_status, cDoc1.m_nCredHandle, nLen-88, sBuffer, 88, sSign, 0, STRING_Null)
						If nErrorSign != 0
							Call MessageErrorEx(UNIFormatGSSMessage(min_status, nErrorSign))
						Return nErrorSign
					Else
						Return 99
			Function: VerifyStru
				Description:
				Returns
					Number:
				Parameters
					String: sTelo
					Number: nLen
				Static Variables
				Local variables
					String: sBuffer1
					String: sBuffer2
					String: sBuffer3
					String: sBuffer4
					Number: nFisrtZap
				Actions
					Set sBuffer1 = '    '
					Set sBuffer2 = Spac(5)
					Set sBuffer3 = Spac(8)
					Call InsertBuf(sBuffer1, 0, sTelo, 32, 4)
					Call InsertBuf(sBuffer2, 0, sTelo, 64, 5)
					Call InsertBuf(sBuffer3, 0, sTelo, 96, 8)
					If Len(SalStrTrimX(sBuffer1)) = 3 and SalStrTrimX(sBuffer1) = 'PAN' and
							   Len(SalStrTrimX(sBuffer2)) = 4 and SalStrTrimX(sBuffer2) = 'SUMA' and
							   Len(SalStrTrimX(sBuffer3)) = 7 and SalStrTrimX(sBuffer3) = 'SCH_VKL'
						Set sBuffer4 = '  '
						Call InsertBuf(sBuffer4, 0, sTelo, 8, 2)
						Set nFisrtZap = SalStrLop(sBuffer4) + SalStrLop(sBuffer4)*256
						! Call DebugN(nFisrtZap)
						Set sBuffer4 = '  '
						Call InsertBuf(sBuffer4, 0, sTelo, nFisrtZap, 2)
						! Call Debug(sBuffer4)
						If sBuffer4 != ' @'
							Return 1
						Return 0
					Else
						Return 1
			Function: AccTU
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					String: sNls
					Number: nSch
					String: sErr
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblSetContext(tbl2, nRow)
						! Call SalTblSetFocusRow(tbl, nRow)
						If Left(tbl2.colPAN, 1) != '@'
							Set sNls = tbl2.colPAN
							Set nSch = tbl2.colSCH_VKL
							! If GetValueStr("
									   SELECT tobo
									   FROM accounts
									   WHERE nls='" || sNls || "' and kv=980") != sKODtobo
								                                                                              Return FALSE
							If nPar = 3
								If SqlPLSQLCommand(hSql(), "nn.p_check_salary(1,sNls,sKODtobo,nSch,sErr,1)")
									If sErr
										Return FALSE
								Else
									Return FALSE
							Else
								If SqlPLSQLCommand(hSql(), "nn.p_check_salary(1,sNls,sKODtobo,nSch,sErr,0)")
									If sErr
										Return FALSE
								Else
									Return FALSE
					Return TRUE
			Function: AccOpen
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					String: sNls
					Number: nSch
					String: sErr
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblSetContext(tbl2, nRow)
						! Call SalTblSetFocusRow(tbl, nRow)
						If Left(tbl2.colPAN, 1) != '@'
							Set sNls = tbl2.colPAN
							Set nSch = tbl2.colSCH_VKL
							! If GetValueStr("
									   SELECT to_char(DAZS)
									   FROM accounts
									   WHERE nls='" || sNls || "' and kv=980") != STRING_Null
								                                                                              Return FALSE
							If SqlPLSQLCommand(hSql(), "nn.p_check_salary(2,sNls,sKODtobo,nSch,sErr,0)")
								If sErr
									Return FALSE
							Else
								Return FALSE
					Return TRUE
			Function: SchTU
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					String: sNls
					Number: nSch
					! String: sTobo
					String: sErr
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblSetContext(tbl2, nRow)
						! Call SalTblSetFocusRow(tbl, nRow)
						If Left(tbl2.colPAN, 1) != '@'
							Set sNls = tbl2.colPAN
							Set nSch = tbl2.colSCH_VKL
							! Set sTobo = GetValueStr("
									    SELECT tobo
									    FROM dpt_vidd
									    WHERE vidd=" || Str(nSch))
							! If SqlPrepareAndExecute(hSql(), '
									   SELECT tobo
									   INTO :sTobo
									   FROM dpt_vidd
									   WHERE vidd=:nSch') and SqlFetchNext(hSql(), nFetchRes)
								                                                                              If sTobo != STRING_Null and sTobo != sKODtobo
									                                                                              Return FALSE
							!
							! Set sTobo = STRING_Null
							! If SqlPrepareAndExecute(hSql(), '
									   SELECT max(p.tobo)
									   INTO :sTobo
									   FROM dpt_vidd v, dpt_vidd_prinsider vp, prinsider p
									   WHERE v.vidd=vp.vidd and vp.ins=p.prinsider and v.vidd=:nSch') and SqlFetchNext(hSql(), nFetchRes)
								                                                                              If sTobo != STRING_Null and sTobo != sKODtobo
									                                                                              Return FALSE
							! Else
								                                                                              Return FALSE
							If SqlPLSQLCommand(hSql(), "nn.p_check_salary(2,sNls,sKODtobo,nSch,sErr,0)")
								If sErr
									Return FALSE
							Else
								Return FALSE
					Return TRUE
			Function: SumTU
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nSumAll
					Number: nSumRass
					! Boolean: bBeginFrag
					! Boolean: bBeginPAN
					Number: nFragSUMA
					Number: nCounter
				Actions
					Set nRow = TBL_MinRow
					Set nSumRass = 0
					! Set bBeginFrag = TRUE
					! Set bBeginPAN = TRUE
					Set nFragSUMA = 0
					Set nCounter = 1
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblSetContext(tbl2, nRow)
						! Call SalTblSetFocusRow(tbl, nRow)
						If Left(tbl2.colPAN, 1) = '@'
							If nSumRass > 0
								If nFragSUMA != nSumRass
									! Call DebugN(nFragSUMA)
									! Call DebugN(nSumRass)
									Return FALSE
								Set nFragSUMA = tbl2.colSUMA
								Set nSumRass = 0
								! Set bBeginFrag = TRUE
								! Set bBeginPAN = TRUE
							Else
								Set nFragSUMA = Max(tbl2.colSUMA, nFragSUMA)
							! Set bBeginFrag = not bBeginFrag
						Else
							! Set bBeginPAN = FALSE
							Set nSumRass = nSumRass + tbl2.colSUMA
							Set nCounter = nCounter + 1
					If nFragSUMA != nSumRass
						! Call DebugN(nFragSUMA)
						! Call DebugN(nSumRass)
						Return FALSE
					Return TRUE
			! Function: Wait
				                                                                              Description:
				                                                                              Returns
				                                                                              Parameters
					                                                                              Number: nWait
				                                                                              Static Variables
				                                                                              Local variables
					                                                                              Number: nC
				                                                                              Actions
					                                                                              Set nC = nWait*77777
					                                                                              While nC > 0
						                                                                              Call SalNumberRandInit(0)
						                                                                              Set nC = nC - 1
		Window Parameters
			Number: nPar
			String: sPar1
		Window Variables
			String: strSqlPopulate
			String: strSqlUpdate
			Number: nRow
			Number: nRow1
			String: sTemp
			Number: n1
			Number: n2
			Number: n3
			Number: n4
			Number: nLenZap
			Number: nHeader
			Number: nLenFile
			Long String: s65534
			Number: nCurrentRow
			Number: nNumberZap
			Sql Handle: hSqlA
			File Handle: fH
			String: sCurrentDir
			Long String: sLong
			!
			String: strFilter
			!
			! Number: nUserId
			! String: sTT
			! Number: nBaseVal
			! Number: nRefZ
			Date/Time: dServerDate
			! cDoc: cDoc
			!
			String: sPATHI
			String: sPATHG
			String: sPATHB
			String: sPATHK
			String: sPATHT
			! String: sDR_FN
			! String: sDR_DT
			! String: sNAZNP
			! String: sREZER
			String: sKODtobo
			String: sREJIM
			String: sREJAV
			String: sPRPDP
			Number: nI
			Number: nFiles
			String: smFiles[*]
			Number: nNewRow
			!
			String: sPAN
			Number: nSUMA
			Number: nSCH_VKL
			!
			! String: sDebZab
			! String: sKredZab
			Boolean: bP
			Date/Time: dPriem
			!
			String: sNls
			String: sFilt1
			String: sFilt2
			Boolean: bLink
			!
			String: sNCKS
			: cDoc1
				Class: cDoc
			Number: nRet
			String: sCertificate
			!
			String: sStornoReasonId
			String: sStornoReason
			!
			String: sZag
			!
			Sql Handle: hSqlErrorHandle
			Number: nErrorNum
			Number: nErrorPos
			String: strErrorText
			String: strCurrentSql
		Message Actions
			On SAM_Create
				Set frmMVOZIK.nTabInstance1 = 1 ! мозаика (puzzle)
				Set frmMVOZIK.nTabInstance2 = 1 ! мозаика (puzzle)
				Set frmMVOZIK.strFilterTblName = 'mvolz'
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call ShowApdVersion('02')
				Set sREJIM = GetMVOlz('REJIM')
				Set sREJAV = GetMVOlz('REJAV')
				Set sPRPDP = GetMVOlz('PRPDP')
				! Set sTT = GetMVOlz('KODOP')
				Set sPATHI = GetMVOlz('PATHI')
				Set sPATHI = sPATHI || IifS(Right(sPATHI, 1)='\\', '', '\\')
				Set sPATHG = GetMVOlz('PATHG')
				Set sPATHG = sPATHG || IifS(Right(sPATHG, 1)='\\', '', '\\')
				Set sPATHB = GetMVOlz('PATHB')
				Set sPATHB = sPATHB || IifS(Right(sPATHB, 1)='\\', '', '\\')
				Set sPATHK = GetMVOlz('PATHK')
				Set sPATHK = sPATHK || IifS(Right(sPATHK, 1)='\\', '', '\\')
				Set sPATHT = GetMVOlz('PATHT')
				Set sPATHT = sPATHT || IifS(Right(sPATHT, 1)='\\', '', '\\')
				! Set sDR_FN = GetMVOlz('DR_FN')
				! Set sDR_DT = GetMVOlz('DR_DT')
				! Set sNAZNP = GetMVOlz('NAZNP')
				! Set sREZER = GetMVOlz('REZER')
				! Set sDebZab = GetValueStr("
						    SELECT val
						    FROM tobo_params
						    WHERE tobo=:sKODtobo and tag='4620D'")
				! Set sKredZab = GetValueStr("
						    SELECT val
						    FROM tobo_params
						    WHERE tobo=:sKODtobo and tag='4620K'")
				! Set nUserId = GetUserId()
				! Set nBaseVal = GetBaseVal()
				Set rbNew = 1
				Set rbDtek = 1
				! Set dDat=GetBankDate()
				Set cDoc1.m_nTim = IifN(GetWaitSign()<=0, 5, GetWaitSign())
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call DebugN(nPar)
				If nPar = 1
					Call SalHideWindow(cmbKODtobo)
					Call SalHideWindow(dfTobo)
					Set sKODtobo = GetValueStr('
							    SELECT substr(tobopack.GetTOBO(),1,20)
							    FROM dual')
					Set sNCKS = GetValueStr("
							    SELECT substr(tobopack.GetTOBOParam('NCKS'),1,4)
							    FROM dual")
				Else If nPar = 2
					Call SalGetWindowText(hWndForm, sZag, 100)
					Call SalSetWindowText(hWndForm, sZag || ' в ЦА')
					Call SalShowWindow(cmbKODtobo)
					Call SalShowWindow(dfTobo)
					Set sKODtobo = dfTobo
					Set sNCKS = GetValueStr("
							    SELECT val
							    FROM tobo_params
							    WHERE tag='NCKS' and tobo='" || sKODtobo || "'")
				Else If nPar = 3
					Call SalGetWindowText(hWndForm, sZag, 100)
					Call SalSetWindowText(hWndForm, sZag || ' в ЦА (сводные)')
					Call SalHideWindow(cmbKODtobo)
					Call SalHideWindow(dfTobo)
					! Set sKODtobo = GetValueStr('
							    SELECT substr(tobopack.GetTOBO(),1,20)
							    FROM dual')
					Set sKODtobo = sPar1
					Set sNCKS = GetValueStr("
							    SELECT val
							    FROM tobo_params
							    WHERE tag='NCKS' and tobo='" || sKODtobo || "'")
				! Set bLink = SqlPrepareAndExecute(hSql(), "
						    SELECT sa.nls
						    INTO :sNls
						    FROM saboaccounts sa, tobo_params t
						    WHERE sa.kv=980 and sa.nls=t.val and t.tag='4629_R'") and
						    SqlFetchNext(hSql(), nFetchRes)
				Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
	Form Window: frmMVOZIKO
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Работа с файлами ЗиК ЦА
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.338"
				Top:    0.938"
				Width:  14.75"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: работа с файлами ЗиК на уровне ЦА
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.117"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50766
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.95"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set strFilter = SalStrTrimX(frmMVOZIKO.tbl.cF.GetFilterWhereClause(FILTER_StandAlone))
							Set strFilter = IifS(Len(strFilter)=0, '', ' and ' || strFilter)
							Set dfFi = IifS(Len(strFilter)>0, IifS(GetLang()='UKR', 'Застосований фільтр', 'Применён фильтр'), '')
							! ! Call Debug(strFilter)
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50767
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50768
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMVOZIKO.cBTipRun')
						On SAM_Click
							If tbl.colOtm = 1
								Call SalWaitCursor(TRUE)
								If SqlPrepareAndExecute(hSql(), '
										   DELETE
										   FROM tmp_nn_z')
									If SqlPrepareAndExecute(hSql(), "
											   SELECT otm
											   into :nOtm
											   FROM mvolz
											   WHERE namef=:tbl.colFileIn
											   FOR UPDATE OF otm NOWAIT")
										Call SqlFetchNext(hSql(), nFetchRes)
										If nOtm = 1
											Set nRow = TBL_MinRow
											While SalTblFindNextRow(tbl2, nRow, 0, 0)
												! Call DebugN(nRow)
												! Call SalTblSetContext(tbl2, nRow)
												Call SalTblFetchRow(tbl2, nRow)
												If Left(tbl2.colPAN, 1) != '@'
													Set sNls = tbl2.colPAN
													Call SqlPrepareAndExecute(hSql(), '
															     INSERT
															     INTO tmp_nn_z (nls,s,shf)
															     VALUES (:sNls,:tbl2.colSUMA,:tbl2.colSCH_VKL)')
											! Call SqlCommit(hSql())
											! Call Debug('commit')
											If SqlPLSQLCommand(hSql(), "NN.P_ZARPLATA(tbl.colNls,tbl.colFileIn)")
												! Call Debug('after plsql')
												Call SalWaitCursor(FALSE)
												If SqlPrepareAndExecute(hSql(), "
														   UPDATE mvolz
														   SET datof=sysdate,otm=2,comnt='Оплачен'
														   WHERE namef=:tbl.colFileIn")
													Call SqlCommit(hSql())
													Call MessageNoWait(tbl.colFileIn || ': файл оплачен, выполнены проводки в "буфер".', 'Сообщение!',
															     17, 0)
												Else
													Call SqlRollback(hSql())
													Call MessageNoWait(tbl.colFileIn || ': ошибка(0) оплаты файла.', 'Сообщение!', 17, 1)
											Else
												! Call Debug('error plsql')
												Call SqlRollback(hSql())
												If SqlPrepareAndExecute(hSql(), "
														   UPDATE mvolz
														   SET comnt='Ош.оплаты(1)'
														   WHERE namef=:tbl.colFileIn")
													Call SqlCommit(hSql())
													Call SalWaitCursor(FALSE)
													Call MessageNoWait(tbl.colFileIn || ': ошибка(1) оплаты файла.', 'Сообщение!', 17, 1)
													Call SalSendMsg(tbl2, UM_Populate, 0, 0)
										Else
											Call SqlRollback(hSql())
											Call SalWaitCursor(FALSE)
											Call MessageNoWait(tbl.colFileIn ||
													     ': ошибка(3) оплаты файла (оплачивается или оплачен другим пользователем).', 'Сообщение!', 17, 1)
											Call SalSendMsg(tbl2, UM_Populate, 0, 0)
									Else
										Call SqlRollback(hSql())
										Call SalWaitCursor(FALSE)
										Call MessageNoWait(tbl.colFileIn ||
												     ': ошибка(3) оплаты файла (оплачивается или оплачен другим пользователем).', 'Сообщение!', 17, 1)
										Call SalSendMsg(tbl2, UM_Populate, 0, 0)
								Else
									! Call Debug('error plsql')
									Call SqlRollback(hSql())
									If SqlPrepareAndExecute(hSql(), "
											   UPDATE mvolz
											   SET comnt='Ош.оплаты(2)'
											   WHERE namef=:tbl.colFileIn")
										Call SqlCommit(hSql())
										Call SalWaitCursor(FALSE)
										Call MessageNoWait(tbl.colFileIn || ': ошибка(1) оплаты файла.', 'Сообщение!', 17, 1)
										Call SalSendMsg(tbl2, UM_Populate, 0, 0)
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все
					Window Location and Size
						Left:   5.517"
						Top:    0.143"
						Width:  0.883"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbGet
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Принятые
					Window Location and Size
						Left:   6.55"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbOpl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Оплаченные
					Window Location and Size
						Left:   8.1"
						Top:    0.143"
						Width:  1.617"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbFact
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Факт.зачисленные
					Window Location and Size
						Left:   9.867"
						Top:    0.143"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Frame
					Resource Id: 50769
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.367"
						Top:    0.071"
						Width:  6.883"
						Width Editable? Yes
						Height: 0.381"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbDall
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все даты
					Window Location and Size
						Left:   2.183"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If rbDall
								Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
							Else
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbDtek
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тек.дата
					Window Location and Size
						Left:   3.817"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Group Box: Даты
					Resource Id: 50770
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.9"
						Top:    0.012"
						Width:  3.417"
						Width Editable? Yes
						Height: 0.44"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dfFi
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.35"
							Top:    0.179"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.214"
							Height Editable? Yes
						Visible? Yes
						Border? No
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: 3D Face Color
						Input Mask: Unformatted
					Message Actions
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.283"
						Width Editable? Class Default
						Height: 2.024"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colDatIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								поступления
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  0.7"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKodTobo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								ТУ
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Left
						Width:  0.5"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNameTobo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								ТУ
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Left
						Width:  1.467"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSumAll
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								документов
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.133"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSАВО
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								кред.задолженности
								 САБО (1)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.9"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colMVO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								деб.задолженности
								МВО (2)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.917"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDELTA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: САБО(1)
								-
								MBO(2)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDatForm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								обработки
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.85"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVidzach
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вид
								зачисления
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colComments
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOtm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Счёт
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Boolean: bG
					String: strSqlPopulate
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Set strSqlPopulate = "
								    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,sa.ostc,a.ostc,sa.ostc-a.ostc
								    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,
								         :colMVO,:colDELTA
								    FROM mvolz m, saboaccounts sa, accounts a
								    WHERE m.mfotu=:sKODtobo and a.nls(+)=:sDebZab and a.kv(+)=980 and
								          sa.nls(+)=:sKredZab and sa.kv(+)=980
								    ORDER BY 1"
						Set sFilt1 = IifS(rbAll, '', IifS(rbGet, ' and mvolz.otm=1', IifS(rbOpl, ' and mvolz.otm=2', ' and mvolz.otm=3')))
						Set sFilt2 = IifS(rbDall, '', ' and TRUNC(mvolz.datpf)=TRUNC(sysdate)')
						! If bLink
							                                             Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,sa.ostc/100,-a.ostc/100,(sa.ostc+a.ostc)/100,a.nls,
									           m.mfotu,t.name,mv.vid
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls,
									         :colKodTobo,:colNameTobo,:colVidzach
									    FROM mvolz m, saboaccounts sa, accounts a, tobo_params t1, tobo_params t2, tobo t, mvovidz mv
									    WHERE m.mfotu=t1.tobo and t1.tag='4629_R' and t1.val=a.nls(+) and a.kv(+)=980 and m.mfotu=t2.tobo and
									          t2.tag='4629_R' and t2.val=sa.nls(+) and sa.kv(+)=980 and m.mfotu=t.tobo and m.vidz=mv.id" || sFilt1 ||
									          sFilt2 || "
									    ORDER BY 1"
						! Else
							                                             Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,0,-a.ostc/100,a.ostc/100,a.nls,m.mfotu,t.name,mv.vid
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls,
									         :colKodTobo,:colNameTobo,:colVidzach
									    FROM mvolz m, accounts a, tobo_params t1, tobo t, mvovidz mv
									    WHERE m.mfotu=t1.tobo and t1.tag='4629_R' and t1.val=a.nls(+) and a.kv(+)=980 and m.mfotu=t.tobo and
									          m.vidz=mv.id" || sFilt1 || sFilt2 || "
									    ORDER BY 1"
						Set frmMVOZIKO.tbl.strSqlPopulate = "
								    SELECT mvolz.datpf,mvolz.namef,mvolz.summf,mvolz.datof,mvolz.comnt,mvolz.otm,sa.ostc/100,-a.ostc/100,
								           (sa.ostc+a.ostc)/100,a.nls,mvolz.mfotu,t.name,mv.vid
								    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls,
								         :colKodTobo,:colNameTobo,:colVidzach
								    FROM mvolz mvolz, saboaccounts sa, accounts a, tobo_params t1, tobo_params t2, tobo t, mvovidz mv
								    WHERE mvolz.mfotu=t1.tobo and t1.tag='4629_R' and t1.val=a.nls(+) and a.kv(+)=980 and mvolz.mfotu=t2.tobo and
								          t2.tag='4629_R' and t2.val=sa.nls(+) and sa.kv(+)=980 and mvolz.mfotu=t.tobo and mvolz.vidz=mv.id" || sFilt1
								          || sFilt2 || strFilter || "
								    ORDER BY 1"
						! Call Debug(strSqlPopulate)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Set bG = TRUE
						While bG
							When SqlError
								Set strCurrentSql = SqlGetLastStatement()
								Call SqlExtractArgs(wParam, lParam, hSqlErrorHandle, nErrorNum, nErrorPos)
								Set strErrorText = SqlGetErrorTextX(nErrorNum)
								Set strErrorText = VisStrSubstitute(strErrorText, Chr(10), PutCrLf())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Возможно разорвано соединение с основной базой данных.
										
										Системное описание ошибки:
										
										' || strErrorText || '
										
										' || strCurrentSql, 'ОШИБКА!!!', 3, 1)
								! Call MessageNoWait('Возможно разорвано соединение с основной базой данных.
										
										Системное описание ошибки:
										
										' || strErrorText, 'ОШИБКА !!!', 3, 1)
								Call SalWaitCursor(TRUE)
								Return FALSE
							If SalTblPopulate(hWndForm, hSql(), T(frmMVOZIKO.tbl.strSqlPopulate), TBL_FillAll)
								Call VisTblAutoSizeColumn(tbl, hWndNULL)
								If SalTblSetFocusRow(hWndForm, 0) and SalTblSetContext(hWndForm, 0)
									Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
								Else
									Set nCurrentRow = TBL_MinRow
									Loop
										If SalTblFindNextRow(tbl2, nCurrentRow, 0, 0)
											Call SalTblDeleteRow(tbl2, nCurrentRow, TBL_Adjust)
										Else
											Break
								Set bG = FALSE
							Else
								If At('saboaccounts', frmMVOZIKO.tbl.strSqlPopulate) > 0
									Set frmMVOZIKO.tbl.strSqlPopulate = "
											    SELECT mvolz.datpf,mvolz.namef,mvolz.summf,mvolz.datof,mvolz.comnt,mvolz.otm,0,-a.ostc/100,a.ostc/100,a.nls,
											           mvolz.mfotu,t.name,mv.vid
											    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls,
											         :colKodTobo,:colNameTobo,:colVidzach
											    FROM mvolz m, accounts a, tobo_params t1, tobo t, mvovidz mv
											    WHERE mvolz.mfotu=t1.tobo and t1.tag='4629_R' and t1.val=a.nls(+) and a.kv(+)=980 and mvolz.mfotu=t.tobo and
											          mvolz.vidz=mv.id" || sFilt1 || sFilt2 || strFilter || "
											    ORDER BY 1"
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Set strFilter = ''
						Set strSqlUpdate = "
								    UPDATE mvolz
								    SET comnt=:tbl.colComments
								    WHERE namef=:tbl.colFileIn and otm<>0"
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_TblDoDetails
						If tbl.colOtm >= 2
							Call SalDisableWindow(pbRun)
						Else
							Call SalEnableWindow(pbRun)
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare(hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(tbl, hSql(), TRUE)
						Call SqlCommit(hSql())
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						If colOtm = 1
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
						Else If colOtm = 2
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Orchid)
						Else If colOtm = 3
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Periwinkle)
					On SAM_ColumnSelectClick
						! Call SalSendClassMessage(SAM_ColumnSelectClick, 0, 0)
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalTblSetContext(hWndForm, 0)
						Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.017"
						Top:    2.095"
						Width:  14.283"
						Width Editable? Class Default
						Height: 3.036"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Class Default
				Contents
					Column: colPAN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: PAN
						Visible? Class Default
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.417"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSUMA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.667"
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSCH_VKL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Шифр вклада
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: Number
						Justify: Right
						Width:  1.767"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						If tbl.colOtm > 0
							! прочитать в файл (DBF)
							Set sLong = GetStringFromBlob(hSqlAux2(), 'mvolz', 'namef', 'bodyf', NUMBER_Null, tbl.colFileIn, STRING_Null)
						Else
							! прочитать оригинальный файл (DBF) в переменную sLong
							Set nLenFile = VisFileGetSize(sPATHI || tbl.colFileIn) - 88
							Call SalFileOpen(fH, sPATHI || tbl.colFileIn, OF_Read)
							Set sLong = Spac(nLenFile)
							Call SalFileRead(fH, sLong, nLenFile)
							Call SalFileClose(fH)
						Call SalFileOpen(fH, GetPrnDir() || '\\' || tbl.colFileIn, OF_Create | OF_Write)
						! определяем количество записей в файле
						Set sTemp = '    '
						Call InsertBuf(sTemp, 0, sLong, 4, 4)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set n3 = SalStrLop(sTemp)
						Set n4 = SalStrLop(sTemp)
						Set nNumberZap = n4*256*256*256 + n3*256*256 + n2*256 + n1
						! Call DebugN(nNumberZap)
						! определяем длину заголовка
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 8, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nHeader = n2*256 + n1
						! Call DebugN(nHeader)
						! определяем длину записи
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 10, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nLenZap = n2*256 + n1
						! Call DebugN(nLenZap)
						!
						Set nLenFile = nHeader + nNumberZap*nLenZap
						! Call DebugN(nLenFile)
						!
						! Call DebugN(nLenFile)
						!
						Set s65534 = Spac(nLenFile)
						Call InsertBuf(s65534, 0, sLong, 0, nLenFile)
						Call SalFileWrite(fH, s65534, nLenFile)
						Call SalFileClose(fH)
						! Call Debug('4')
						Set nCurrentRow = TBL_MinRow
						Loop
							If SalTblFindNextRow(hWndForm, nCurrentRow, 0, 0)
								Call SalTblDeleteRow(hWndForm, nCurrentRow, TBL_Adjust)
							Else
								Break
						Call SalFileGetCurrentDirectory(sCurrentDir)
						Call SalFileSetCurrentDirectory(GetPrnDir())
						Set SqlDatabase = 'dBase_Files'
						Call SqlConnect(hSqlA)
						Call SqlPrepareAndExecute(hSqlA, "
								     SELECT PAN,SUMA,SCH_VKL
								     FROM " || tbl.colFileIn || "
								     INTO :sPAN,:nSUMA,:nSCH_VKL")
						Set tbl.colSumAll = 0
						While SqlFetchNext(hSqlA, nFetchRes)
							Set nRow = SalTblInsertRow(tbl2, TBL_MaxRow)
							Call SalTblSetContext(tbl2, nRow)
							Set tbl2.colPAN = SalStrTrimX(StrDosToWinX(sPAN))
							Set tbl2.colSUMA = nSUMA
							Set tbl2.colSCH_VKL = nSCH_VKL
							If Left(tbl2.colPAN, 1) != '@'
								Set tbl.colSumAll = tbl.colSumAll + nSUMA
						Call SalFileSetCurrentDirectory(sCurrentDir)
						Call SqlDisconnect(hSqlA)
						Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						Call VisFileDelete(GetPrnDir() || '\\' || tbl.colFileIn)
						! Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						!
						! Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
						! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						! Call SalTblSetContext(hWndForm, nRow)
						Call VisTblAutoSizeColumn(tbl2, hWndNULL)
						Call SalWaitCursor(FALSE)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
		Functions
		Window Parameters
		Window Variables
			! String: strSqlPopulate
			String: strSqlUpdate
			Number: nRow
			String: sTemp
			Number: n1
			Number: n2
			Number: n3
			Number: n4
			Number: nLenZap
			Number: nHeader
			Number: nLenFile
			Long String: s65534
			Number: nCurrentRow
			Number: nNumberZap
			Sql Handle: hSqlA
			File Handle: fH
			String: sCurrentDir
			Long String: sLong
			!
			String: strFilter
			!
			! Number: nUserId
			String: sTT
			! Number: nBaseVal
			! Number: nRefZ
			Date/Time: dServerDate
			! cDoc: cDoc
			!
			String: sPATHI
			! String: sPATHG
			! String: sPATHB
			! String: sDR_FN
			! String: sDR_DT
			! String: sNAZNP
			! String: sREZER
			! String: sKODtobo
			! String: sREJIM
			Number: nI
			Number: nFiles
			String: smFiles[*]
			Number: nNewRow
			!
			String: sPAN
			Number: nSUMA
			Number: nSCH_VKL
			!
			! String: sDebZab
			! String: sKredZab
			! Boolean: bP
			! Date/Time: dPriem
			!
			String: sNls
			String: sFilt1
			String: sFilt2
			! Boolean: bLink
			!
			Sql Handle: hSqlErrorHandle
			Number: nErrorNum
			Number: nErrorPos
			String: strErrorText
			String: strCurrentSql
			!
			Number: nOtm
		Message Actions
			On SAM_Create
				Set frmMVOZIKO.nTabInstance1 = 1 ! мозаика (puzzle)
				Set frmMVOZIKO.nTabInstance2 = 1 ! мозаика (puzzle)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call ShowApdVersion('02')
				Set sPATHI = GetMVOlz('PATHI')
				Set sPATHI = sPATHI || IifS(Right(sPATHI, 1)='\\', '', '\\')
				Set rbAll  = 1
				Set rbDtek = 1
				Set frmMVOZIKO.strFilterTblName = 'mvolz'
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Form Window: tblELPLAT
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Работа с файлами зачислений
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.275"
				Top:    0.729"
				Width:  14.583"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: работа с файлами зачисления зарплаты
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.617"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Удалить информацию'
						On SAM_Click
							If SalMessageBox('Вы действительно хотите удалить информацию файла ' || tbl.colFileIn, 'ВНИМАНИЕ!',
									   MB_YesNo | MB_IconQuestion) = IDYES
								If SqlPrepareAndExecute(hSql(), "
										   DELETE
										   FROM mvolz
										   WHERE namef=:tbl.colFileIn") and SqlCommit(hSql())
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.117"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1667
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1668
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.3"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1669
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbGet
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.167"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\APPLY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Принять файл'
						On SAM_Click
							! 1. Прочитать файл
									  2. Поместить тело файла в MVOLZ + дата приёма
							If tbl.colOtm = 0
								Set nLenFile = VisFileGetSize(sPATHI || tbl.colFileIn)
								Call SalFileOpen(fH, sPATHI || tbl.colFileIn, OF_Read)
								Set s65534 = Spac(nLenFile)
								Call SalFileRead(fH, s65534, nLenFile)
								Call SalFileClose(fH)
								Set dPriem = DATETIME_Null
								If SqlPrepareAndExecute(hSql(), '
										   SELECT datpf
										   INTO :dPriem
										   FROM mvolz
										   WHERE namef=:tbl.colFileIn') and SqlFetchNext(hSql(), nFetchRes)
								Set dServerDate = GetServerDate()
								Set nRet = 0
								If dPriem = DATETIME_Null
									If SqlPrepare(hSql(),  "
											   INSERT
											   INTO mvolz (datpf,namef,summf,comnt,otm)
											   VALUES (:dServerDate,:tbl.colFileIn,:tbl.colSumAll,'Принят',1)")
										If PutStringToClob(hSql(), s65534, 'mvolz', 'namef', 'bodyf', NUMBER_Null, tbl.colFileIn, STRING_Null, 0)
											Call SqlCommit(hSql())
											Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHG || tbl.colFileIn)
											If File(sPATHG || tbl.colFileIn)
												Call VisFileDelete(sPATHI || tbl.colFileIn)
												If not wParam
													Call SalSendMsg(tbl, UM_Populate, 0, 0)
										Else
											Call SqlRollback(hSql())
											Call MessageNoWait('Ошибка(1) записи информации из файла ' || tbl.colFileIn || ' ...', 'ОШИБКА!', 7, 1)
									Else
										Call SqlRollback(hSql())
										Call MessageNoWait('Ошибка(2) записи информации из файла ' || tbl.colFileIn || ' ...', 'ОШИБКА!', 7, 1)
								Else
									Call MessageNoWait('Файл с именем ' || tbl.colFileIn ||
											     ' ранее уже принимался. Переименуйте файл и повторите приём.', 'ВНИМАНИЕ!', 0, 1)
									Call SalSendMsg(tbl, UM_Populate, 0, 0)
									!
									! Call VisFileCopy(sPATHI || tbl.colFileIn, sPATHB || tbl.colFileIn)
									! If File(sPATHB || tbl.colFileIn)
										                                                           Call VisFileDelete(sPATHI || tbl.colFileIn)
										                                                           If not wParam
											                                                           Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.733"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить файл'
						On SAM_Click
							If tbl.colOtm = 1
								Call SalWaitCursor(TRUE)
								If SqlPrepareAndExecute(hSql(), '
										   DELETE
										   FROM tmp_nn_z')
									Set nRow = TBL_MinRow
									While SalTblFindNextRow(tbl2, nRow, 0, 0)
										! Call DebugN(nRow)
										! Call SalTblSetContext(tbl2, nRow)
										Call SalTblFetchRow(tbl2, nRow)
										! Set sNls = tbl2.colPAN
										Call SqlPrepareAndExecute(hSql(), '
												     INSERT
												     INTO tmp_nn_z (nls,shf,s)
												     VALUES (:tbl2.colPAN,:tbl2.colSUMA,:tbl2.colSCH_VKL)')
									Set sErr = STRING_Null
									If SqlPLSQLCommand(hSql(), "P_ZARPLATA(tbl.colFileIn,sErr)")
										! Call Debug('after plsql')
										Call SalWaitCursor(FALSE)
										If sErr = STRING_Null
											If SqlPrepareAndExecute(hSql(), "
													   UPDATE mvolz
													   SET datof=sysdate,otm=2,comnt='Оплачен'
													   WHERE namef=:tbl.colFileIn")
												Call SqlCommit(hSql())
												Call MessageNoWait(tbl.colFileIn || ': файл оплачен, выполнены проводки в "буфер".', 'Сообщение!', 17, 0)
											Else
												Call SqlRollback(hSql())
												Call MessageNoWait(tbl.colFileIn || ': ошибка(0) оплаты файла.', 'Сообщение!', 17, 1)
										Else
											Call SqlRollback(hSql())
											If SqlPrepareAndExecute(hSql(), "
													   UPDATE mvolz
													   SET comnt=:sErr
													   WHERE namef=:tbl.colFileIn")
												Call SqlCommit(hSql())
												Call SalWaitCursor(FALSE)
												Call MessageNoWait(tbl.colFileIn || ': ошибка (' || sErr || ') оплаты файла.', 'Сообщение!', 17, 1)
												Call SalSendMsg(tbl2, UM_Populate, 0, 0)
									Else
										! Call Debug('error plsql')
										Call SqlRollback(hSql())
										If SqlPrepareAndExecute(hSql(), "
												   UPDATE mvolz
												   SET comnt='Ош.оплаты(1)'
												   WHERE namef=:tbl.colFileIn")
											Call SqlCommit(hSql())
											Call SalWaitCursor(FALSE)
											Call MessageNoWait(tbl.colFileIn || ': ошибка(1) оплаты файла.', 'Сообщение!', 17, 1)
											Call SalSendMsg(tbl2, UM_Populate, 0, 0)
								Else
									! Call Debug('error plsql')
									Call SqlRollback(hSql())
									If SqlPrepareAndExecute(hSql(), "
											   UPDATE mvolz
											   SET comnt='Ош.оплаты(2)'
											   WHERE namef=:tbl.colFileIn")
										Call SqlCommit(hSql())
										Call SalWaitCursor(FALSE)
										Call MessageNoWait(tbl.colFileIn || ': ошибка(1) оплаты файла.', 'Сообщение!', 17, 1)
										Call SalSendMsg(tbl2, UM_Populate, 0, 0)
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все
					Window Location and Size
						Left:   7.333"
						Top:    0.143"
						Width:  0.883"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbGet
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Принятые
					Window Location and Size
						Left:   9.4"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbOpl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Оплаченные
					Window Location and Size
						Left:   10.85"
						Top:    0.143"
						Width:  1.617"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbNew
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Свежие
					Window Location and Size
						Left:   8.167"
						Top:    0.143"
						Width:  1.233"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Royal Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Frame
					Resource Id: 1670
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.183"
						Top:    0.083"
						Width:  5.367"
						Width Editable? Yes
						Height: 0.381"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbDall
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все даты
					Window Location and Size
						Left:   3.45"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Radio Button: rbDtek
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тек.дата
					Window Location and Size
						Left:   5.083"
						Top:    0.143"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Group Box: Даты
					Resource Id: 1671
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.167"
						Top:    0.024"
						Width:  3.417"
						Width Editable? Yes
						Height: 0.44"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  11.533"
						Width Editable? Class Default
						Height: 2.381"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colDatIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								поступления
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.833"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.317"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSumAll
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								документов
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.133"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSАВО
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								кред.задолженности
								 САБО (1)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.9"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Call SalTblGetColumnTitle(colSАВО, sText, 100)
								Set sText = 'Остаток на счёте
										' || sNLS || '
										САБО (1)'
								Call SalTblSetColumnTitle(colSАВО, sText)
					Column: colMVO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток на счёте
								деб.задолженности
								ВКЛ (2)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.917"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Call SalTblGetColumnTitle(colMVO, sText, 100)
								Set sText = 'Остаток на счёте
										' || sNLS || '
										ВКЛ (2)'
								Call SalTblSetColumnTitle(colMVO, sText)
					Column: colDELTA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: САБО(1)
								-
								BКЛ(2)
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDatForm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								обработки
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.833"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colComments
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.283"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOtm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Счёт
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: sText
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Set sFilt1 = IifS(rbAll, '', IifS(rbGet, ' and m.otm=1', IifS(rbOpl, ' and m.otm=2', ' and m.otm=3')))
						Set sFilt1 = IifS(rbAll, '', IifS(rbNew, ' and m.otm=0', IifS(rbGet, ' and m.otm=1', ' and m.otm=2')))
						Set sFilt2 = IifS(rbDall, '', ' and TRUNC(m.datpf)=TRUNC(sysdate)')
						If bLink
							Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,sa.ostc/100,-a.ostc/100,(sa.ostc+a.ostc)/100,a.nls
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls
									    FROM mvolz m, saboaccounts sa, accounts a
									    WHERE a.kv(+)=980 and a.nls(+)=:sNLS and sa.kv(+)=980 and sa.nls(+)=:sNLS " || sFilt1 ||
									          sFilt2 || "
									    ORDER BY 1"
						Else
							Set strSqlPopulate = "
									    SELECT m.datpf,m.namef,m.summf,m.datof,m.comnt,m.otm,0,-a.ostc/100,a.ostc/100,a.nls
									    INTO :colDatIn,:colFileIn,:colSumAll,:colDatForm,:colComments,:colOtm,:colSАВО,:colMVO,:colDELTA,:colNls
									    FROM mvolz m, accounts a
									    WHERE a.kv(+)=980 and a.nls(+)=:sNLS" || sFilt1 || sFilt2 || "
									    ORDER BY 1"
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
						! прочитать входной каталог и доселить таблицу именами "свежых" файлов
						! Call Debug(sNCKS)
						If rbNew or rbAll
							Set nFiles = VisDosEnumFiles(sPATHI || '\\????????.???', FA_Standard, smFiles)
							If nFiles > 0
								Set nI = 0
								While nI < nFiles
									Set nNewRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
									Call SalTblSetContext(hWndForm, nNewRow)
									Set colFileIn = smFiles[nI]
									Set colOtm = 0
									Set colComments = 'Свежий файл'
									Set nI = nI + 1
								Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						Call VisTblAutoSizeColumn(tbl, hWndNULL)
						If SalTblSetFocusRow(hWndForm, 0) and SalTblSetContext(hWndForm, 0)
							Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
						Else
							Set nCurrentRow = TBL_MinRow
							Loop
								If SalTblFindNextRow(tbl2, nCurrentRow, 0, 0)
									Call SalTblDeleteRow(tbl2, nCurrentRow, TBL_Adjust)
								Else
									Break
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Set strFilter = ''
						Set strSqlUpdate = "
								    UPDATE mvolz
								    SET comnt=:tbl.colComments
								    WHERE namef=:tbl.colFileIn and otm<>0"
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_TblDoDetails
						If tbl.colFileIn
							If tbl.colOtm = 0
								Call SalDisableWindow(pbDel)
								Call SalEnableWindow(pbGet)
								Call SalDisableWindow(pbRun)
							Else If tbl.colOtm = 1
								Call SalEnableWindow(pbDel)
								Call SalDisableWindow(pbGet)
								Call SalEnableWindow(pbRun)
							Else
								Call SalDisableWindow(pbDel)
								Call SalDisableWindow(pbGet)
								Call SalDisableWindow(pbRun)
							Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare(hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(tbl, hSql(), TRUE)
						Call SqlCommit(hSql())
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						If tbl.colOtm = 1
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
						Else If tbl.colOtm = 2
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Periwinkle)
					On SAM_ColumnSelectClick
						! Call SalSendClassMessage(SAM_ColumnSelectClick, 0, 0)
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalTblSetContext(hWndForm, 0)
						Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.393"
						Width:  11.533"
						Width Editable? Class Default
						Height: 2.381"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Class Default
				Contents
					Column: colPAN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Табельный
								номер
						Visible? Class Default
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.417"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSUMA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счёт
								зачисления 
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Right
						Width:  1.667"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSCH_VKL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								зачисления
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: Number
						Justify: Right
						Width:  1.767"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						If tbl.colOtm > 0
							! прочитать в файл
							! Call SqlPrepareAndExecute(hSqlAux2(), "
									     SELECT bodyf
									     INTO :sLong
									     FROM mvolz
									     WHERE namef=:tbl.colFileIn")
							! Call SqlFetchNext(hSqlAux2(), nFetchRes)
							Call GetStringFromClob(hSqlAux2(), 'mvolz', 'namef', 'bodyf', NUMBER_Null, tbl.colFileIn, STRING_Null)
							Set nLenFile = Len(sLong)
						Else
							! прочитать оригинальный файл в переменную sLong
							Set nLenFile = VisFileGetSize(sPATHI || tbl.colFileIn)
							Call SalFileOpen(fH, sPATHI || tbl.colFileIn, OF_Read)
							Set sLong = Spac(nLenFile)
							Call SalFileRead(fH, sLong, nLenFile)
							Call SalFileClose(fH)
						Call SalFileOpen(fH, GetPrnDir() || '\\' || tbl.colFileIn, OF_Create | OF_Write)
						Set s65534 = Spac(nLenFile)
						Call InsertBuf(s65534, 0, sLong, 0, nLenFile)
						Call SalFileWrite(fH, s65534, nLenFile)
						Call SalFileClose(fH)
						Set nCurrentRow = TBL_MinRow
						Loop
							If SalTblFindNextRow(hWndForm, nCurrentRow, 0, 0)
								Call SalTblDeleteRow(hWndForm, nCurrentRow, TBL_Adjust)
							Else
								Break
						Set tbl.colSumAll = 0
						Call SalFileOpen(fH, GetPrnDir() || '\\' || tbl.colFileIn, OF_Read)
						Set sBuffer = Spac(256)
						While SalFileGetStr(fH, sBuffer, 256)
							Set nRow = SalTblInsertRow(tbl2, TBL_MaxRow)
							Call SalTblSetContext(tbl2, nRow)
							Call SalStrTokenize(sBuffer, '', ',', sToken)
							Set tbl2.colPAN = sToken[0]
							Set tbl2.colSUMA = sToken[1]
							Set tbl2.colSCH_VKL = Val(sToken[2])
							Set tbl.colSumAll = tbl.colSumAll + tbl2.colSCH_VKL
							Set sBuffer = Spac(256)
						Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						Call SalFileClose(fH)
						Call VisFileDelete(GetPrnDir() || '\\' || tbl.colFileIn)
						! Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						!
						! Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
						! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						! Call SalTblSetContext(hWndForm, nRow)
						Call VisTblAutoSizeColumn(tbl2, hWndNULL)
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Set strFilter = ''
						Set strSqlUpdate = "
								    UPDATE mvolz
								    SET comnt=:tbl.colComments
								    WHERE namef=:tbl.colFileIn and otm=1"
						Call SalSendClassMessage(SAM_Create, 0, 0)
					! On SAM_CreateComplete
						                                                           Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					! On SAM_TblDoDetails
						                                                            Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare(hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(tbl, hSql(), TRUE)
						Call SqlCommit(hSql())
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					! On SAM_FetchRowDone
						                                                            If tbl.colOtm = 1
							                                                            Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
						                                                            Else If tbl.colOtm = 2
							                                                            Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Periwinkle)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
		Functions
		Window Parameters
		Window Variables
			String: strSqlPopulate
			String: strSqlUpdate
			Number: nRow
			String: sTemp
			Number: n1
			Number: n2
			Number: n3
			Number: n4
			Number: nLenZap
			Number: nHeader
			Number: nLenFile
			Long String: s65534
			Number: nCurrentRow
			Number: nNumberZap
			Sql Handle: hSqlA
			File Handle: fH
			String: sCurrentDir
			Long String: sLong
			!
			String: strFilter
			!
			! Number: nUserId
			String: sTT
			! Number: nBaseVal
			! Number: nRefZ
			Date/Time: dServerDate
			! cDoc: cDoc
			!
			String: sPATHI
			! String: sPATHG
			! String: sPATHB
			! String: sDR_FN
			! String: sDR_DT
			! String: sNAZNP
			! String: sREZER
			! String: sKODtobo
			! String: sREJIM
			Number: nI
			Number: nFiles
			String: smFiles[*]
			Number: nNewRow
			!
			String: sPAN
			Number: nSUMA
			Number: nSCH_VKL
			!
			! String: sDebZab
			! String: sKredZab
			! Boolean: bP
			! Date/Time: dPriem
			!
			String: sNls
			String: sFilt1
			String: sFilt2
			Boolean: bLink
			!
			String: sPATHG
			String: sPATHB
			String: sPATHK
			String: sPATHT
			String: sBuffer
			String: sToken[*]
			Date/Time: dPriem
			Number: nRet
			String: sErr
			!
			String: sNLS
		Message Actions
			On SAM_Create
				Set tblELPLAT.nTabInstance1 = 1 ! мозаика (puzzle)
				Set tblELPLAT.nTabInstance2 = 1 ! мозаика (puzzle)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call ShowApdVersion('01')
				Set sPATHI = GetMVOlz('PATHI')
				Set sPATHI = sPATHI || IifS(Right(sPATHI, 1)='\\', '', '\\')
				Set sPATHG = GetMVOlz('PATHG')
				Set sPATHG = sPATHG || IifS(Right(sPATHG, 1)='\\', '', '\\')
				Set sPATHB = GetMVOlz('PATHB')
				Set sPATHB = sPATHB || IifS(Right(sPATHB, 1)='\\', '', '\\')
				Set sPATHT = GetMVOlz('PATHT')
				Set sPATHT = sPATHT || IifS(Right(sPATHT, 1)='\\', '', '\\')
				Set sNLS = GetValueStr("
						    SELECT a.nls
						    FROM tts t, accounts a
						    WHERE t.tt='ZRP' and a.nls=t.nlsm and a.kv=980 and a.dazs is null")
				Set rbAll = 1
				Set rbDtek = 1
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Set bLink = SqlPrepareAndExecute(hSql(), "
						    SELECT sa.nls
						    INTO :sNls
						    FROM saboaccounts sa
						    WHERE sa.kv=980 and sa.nls='2620690010000'") and
						    SqlFetchNext(hSql(), nFetchRes)
				Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
	Table Window: tblRequest
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Перегляд архіву запитів / Управління запитами
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50771
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50772
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbVisa
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							If nRequestFlag = 0
								Set strTip = 'Переформувати запит'
							Else
								Set strTip = 'Візувати запити'
						On SAM_Click
							If nRequestFlag = 0
								If NOT SqlPLSQLCommand(hSql(), sSqlProcedure)
									Call SqlRollback(hSql())
									Call SalMessageBox("Помилка при виконанні процедури!", "Помилка", MB_Ok | MB_IconExclamation)
								Else
									Call SqlCommit(hSql())
									Call SalMessageBox("Успішно переформовано запит", "Інформація", MB_Ok | MB_IconInformation)
							Else
								If SalTblAnyRows(hWndForm, ROW_Selected, 0)
									Set nRow = TBL_MinRow
									While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
										Call SalTblSetContext(hWndForm, nRow)
										! If NOT SqlPrepareAndExecute(hSql(),
												"UPDATE NN_REQUEST
												    SET REQUEST_STATUS = null
												  WHERE ID=:tblRequest.colID AND REQUEST_STATUS=2")
											                                Call SqlRollback(hSql())
										If NOT SqlPLSQLCommand(hSql(), "bars_nnacs.approve_request(tblRequest.colReqId)")
											Call SqlRollback(hSql())
										Else
											Call SqlCommit(hSql())
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Line
					Resource Id: 50773
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.65"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: colReqId		! N Ид. запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqDate		! D Дата запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: dd/MM/yyyy hh:mm:ss
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqState		! N Код состояния запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						состояния
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqStateName		! S Состояние запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Состояние
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqType		! N Код типа запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						типа
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqTypeName		! S Тип запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqPriorId		! N Ид. предыдущего запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид. пред.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCustId		! N Ид. клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						клиента
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCardId		! N Ид. карты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCardStatus		! N Код состояния карты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						состояния
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCardStopStatus	! N Код блокировки карты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						блокировки
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCardStopReason	! N Код причины блокировки карты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код причины
						блокировки
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colTermId		! N Ид. терминала
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						терминала
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colTermStatus		! N Код состояния терминала
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						состояния
						терминала
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimLimId		! N Ид. лимита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						лимита
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimLimOper	! N Код операции с лимитом
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						операции
						с лимитом
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimLimState	! N Код состояния лимита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						состояния
						лимита
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimLimValue	! N Изменение лимита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Изменение
						лимита
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimLimAmnt 	! N Сумма лимита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						лимита
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAcclimDocRef		! N Ид. документа
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						документа
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqErrCode		! N Код ошибки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						ошибки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqErrText		! S Текст ошибки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Текст
						ошибки
				Visible? Class Default
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nRequestFlag	! 1 - Управление запросами, 0 - Архив
			String: sPar1		! Не используется
			String: sFilter		! Фильтр
		Window Variables
			String: sSource
			Number: nRow
			String: sSqlProcedure
		Message Actions
			On SAM_Create
				If nRequestFlag = 0
					Set tblRequest.strFilterTblName = "V_NNREQUESTS_HISTORY"
					Set tblRequest.nFlags = GT_ReadOnly
					Call SalSetWindowText(hWndForm, 'Перегляд архіву запитів.')
					Call SalDisableWindow(pbVisa)
					Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					Set sSqlProcedure = "bars_nnacs.remake_request(colReqId)"
				Else
					Set tblRequest.strFilterTblName = "V_NNREQUESTS"
					Set tblRequest.nFlags = GT_NoIns
					Call SalSetWindowText(hWndForm, 'Управління запитами.')
					Set tblRequest.strSqlDelete =
							"UPDATE NN_REQUEST
							    SET REQUEST_STATUS = 1
							  WHERE ID=:tblRequest.colReqId AND REQUEST_STATUS IS NULL"
				Set tblRequest.fFilterAtStart = TRUE
				Set sSource = tblRequest.strFilterTblName
				Set tblRequest.strSqlPopulate =
						"select REQ_ID, REQ_DATE, REQ_STATE, REQ_STATENAME, REQ_TYPE, REQ_TYPENAME, REQ_PRIORID, 
						        CUST_ID, CARD_ID, CARD_STATUS, CARD_STOPSTATUS, CARD_STOPREASON, TERM_ID, TERM_STATUS, 
						        ACCLIM_LIMID, ACCLIM_LIMOPER, ACCLIM_LIMSTATE, ACCLIM_LIMVALUE, ACCLIM_LIMAMNT, ACCLIM_DOCREF, 
						        REQ_ERRCODE, REQ_ERRTEXT
						   into :tblRequest.colReqId, :tblRequest.colReqDate, :tblRequest.colReqState, :tblRequest.colReqStateName,
						        :tblRequest.colReqType, :tblRequest.colReqTypeName, :tblRequest.colReqPriorId,
						        :tblRequest.colCustId, :tblRequest.colCardId, :tblRequest.colCardStatus, 
						        :tblRequest.colCardStopStatus, :tblRequest.colCardStopReason, :tblRequest.colTermId, :tblRequest.colTermStatus,
						        :tblRequest.colAcclimLimId, :tblRequest.colAcclimLimOper, :tblRequest.colAcclimLimState, 
						        :tblRequest.colAcclimLimValue, :tblRequest.colAcclimLimAmnt, :tblRequest.colAcclimDocRef,
						        :tblRequest.colReqErrCode, :tblRequest.colReqErrText
						   from " || sSource || IifS(sFilter='', "", " where " || sFilter) || "
						  order by REQ_TYPE, CARD_STATUS, REQ_ID DESC"
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
				Call SalTblSetContext(hWndForm, 0)
				Call SalTblSetFocusRow(hWndForm, 0)
				Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
			On SAM_TblDoDetails
				If nRequestFlag = 0
					! If colReqState = 99 AND
							(colReqType = 1 OR colReqType = 2 OR colReqType = 4 OR colReqType = 5)
						                            Call SalEnableWindow(pbVisa)
						                            If colReqType = 1
							                            Set sSqlProcedure = "bars_nnacs.remake_acclim_request(colReqId)"
						                            If colReqType = 2
							                            Set sSqlProcedure = "bars_nnacs.make_card_request(colCardId)"
						                            If colReqType = 4
							                            Set sSqlProcedure = "bars_nnacs.make_customer_request(colCustId)"
						                            If colReqType = 5
							                            Set sSqlProcedure = "bars_nnacs.make_term_request(colTermId)"
					If colReqState = 99
						Call SalEnableWindow(pbVisa)
					Else
						Call SalDisableWindow(pbVisa)
	Table Window: tblCardManage
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.65"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50774
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50775
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50776
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colACS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						АКС
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colMEMBER_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						участника
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colPOOL_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						пула
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: РНК
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ф.И.О.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSTATUS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Статус
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colOWNER_STATUS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Статус
						держателя
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colISSUER_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						начала
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colEXPIRE_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						окончания
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colTOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colNAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSTOP_STATUS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: STOP-
						статус
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSTOP_STATUS_PLAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плановый
						STOP-статус
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nEditFlag	! 1 - Edit, 0 - Show
			Number: nPar2
			String: sPar1
			String: sPar2
		Window Variables
			String: sTobo
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, "Управление состоянием карт")
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set sTobo = GetValueStr("SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20) FROM dual")
				Set tblCardManage.fFilterAtStart = TRUE
				Set tblCardManage.nFlags = GT_ReadOnly
				Set tblCardManage.strFilterTblName = "NN_CARD_MANAGE"
				Set tblCardManage.strSqlPopulate =
						"SELECT ID, ACS_ID, MEMBER_NO, POOL_NO, RNK, NMK,
						        STATUS, OWNER_STATUS, ISSUER_DATE, EXPIRE_DATE,
						        TOBO, NAME, STOP_STATUS, STOP_STATUS_PLAN
						 INTO :hWndForm.tblCardManage.colID, :hWndForm.tblCardManage.colACS_ID,
						      :hWndForm.tblCardManage.colMEMBER_NO, :hWndForm.tblCardManage.colPOOL_NO,
						      :hWndForm.tblCardManage.colRNK, :hWndForm.tblCardManage.colNMK,
						      :hWndForm.tblCardManage.colSTATUS, :hWndForm.tblCardManage.colOWNER_STATUS,
						      :hWndForm.tblCardManage.colISSUER_DATE, :hWndForm.tblCardManage.colEXPIRE_DATE,
						      :hWndForm.tblCardManage.colTOBO, :hWndForm.tblCardManage.colNAME,
						      :hWndForm.tblCardManage.colSTOP_STATUS, :hWndForm.tblCardManage.colSTOP_STATUS_PLAN
						 FROM NN_CARD_MANAGE
						 ORDER BY id"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
			On SAM_DoubleClick
				Call SalModalDialog(dlgCardDetails, hWndMDI, 1,
						hWndForm.tblCardManage.colID,
						hWndForm.tblCardManage.colACS_ID,
						hWndForm.tblCardManage.colRNK,
						hWndForm.tblCardManage.colNMK,
						hWndForm.tblCardManage.colSTATUS,
						hWndForm.tblCardManage.colISSUER_DATE,
						hWndForm.tblCardManage.colEXPIRE_DATE,
						hWndForm.tblCardManage.colSTOP_STATUS )
	Dialog Box: dlgCardDetails
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.0"
				Width Editable? Yes
				Height: 4.9"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Ид. карты:
				Resource Id: 50777
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.238"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    0.2"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: в АКС:
				Resource Id: 778
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.333"
					Top:    0.238"
					Width:  0.767"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfACS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.15"
						Top:    0.202"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: РНК:
				Resource Id: 50778
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.488"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    0.45"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Ф.И.О.:
				Resource Id: 50779
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.738"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfFIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    0.7"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Статус карты:
				Resource Id: 50780
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.988"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfSTATUS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    0.95"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата начала:
				Resource Id: 50781
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.238"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfISSUER_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    1.2"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата окончания:
				Resource Id: 50782
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.488"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfEXPIER_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.3"
						Top:    1.45"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Вопрос:
				Resource Id: 50783
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.964"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Multiline Field: mlQuestion
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   2.3"
						Top:    1.7"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.7"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Background Text: Ответ:
				Resource Id: 50784
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    2.714"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Multiline Field: mlAnswer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   2.3"
						Top:    2.45"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.702"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Background Text: Причина внесения или изъятия карты:
				Resource Id: 50785
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    3.286"
					Width:  4.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Combo Box: cmbReason
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.4"
					Top:    3.2"
					Width:  4.1"
					Width Editable? Class Default
					Height: 2.429"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbReason.Init(hWndItem)
							Call cmbReason.Add(1, 'З ініціативи клієнта')
							Call cmbReason.Add(4, 'З ініціативи банка')
						Set nReason = 1
						Call cmbReason.SetSelectById(nReason)
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set nReason = cmbReason.nCurrentId
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.08"
					Top:    0.06"
					Width:  8.75"
					Width Editable? Yes
					Height: 3.7"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.083"
					Top:    3.8"
					Width:  8.75"
					Width Editable? Yes
					Height: 0.7"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
			!
			Pushbutton: pbBlock
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbBrowse
				Property Template:
				Class DLL Name:
				Title: Заблокировать лимит
				Window Location and Size
					Left:   0.2"
					Top:    3.9"
					Width:  2.0"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\redX.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalMessageBox(sFio || PutCrLf() || PutCrLf() || "ЗАБЛОКИРОВАТЬ ЛИМИТ?", 
								   "Внимание", MB_IconQuestion|MB_YesNo) = IDYES
							If NOT SqlPLSQLCommand(hSql(), "BARS_NNACS.make_cardstop_request(nCard, 1, nReason)")
								Call SqlRollback(hSql())
							Call SqlCommit(hSql()) 
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): Заблокирован лимит по карте № " || Str(nCard))
							Call SalMessageBox("Лимит заблокирован!", "Внимание", MB_Ok)
						Else
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(-): Пользователь отказался от блокировки лимита по карте № " || Str(nCard))
			Pushbutton: pbIns
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbInsert
				Property Template:
				Class DLL Name:
				Title: Добавить карту в STOP-лист
				Window Location and Size
					Left:   2.2"
					Top:    3.905"
					Width:  2.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\green+.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalMessageBox(sFio || PutCrLf() || PutCrLf() || "ДОБАВИТЬ КАРТУ В STOP-ЛИСТ?", 
								   "Внимание", MB_IconQuestion|MB_YesNo) = IDYES
							If NOT SqlPLSQLCommand(hSql(),"BARS_NNACS.make_cardstop_request(nCard, 0, nReason)")
								Call SqlRollback(hSql())
							Call SqlCommit(hSql())
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): Карта № " || Str(nCard) || " добавлена в STOP-лист")
							Call SalMessageBox("Карта добавлена в STOP-лист!", "Внимание", MB_Ok)
						Else
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(-): Пользователь отказался от добавления в STOP-лист карты № " || Str(nCard))
			Pushbutton: pbDel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbDelete
				Property Template:
				Class DLL Name:
				Title: Изъять карту из STOP-листа
				Window Location and Size
					Left:   4.8"
					Top:    3.905"
					Width:  2.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalMessageBox(sFio || PutCrLf() || PutCrLf() || "ИЗЪЯТЬ КАРТУ ИЗ STOP-ЛИСТА?", 
								   "Внимание", MB_IconQuestion|MB_YesNo) = IDYES
							If NOT SqlPLSQLCommand(hSql(), "BARS_NNACS.MAKE_CARDSTOP_REQUEST(nCard, nCodUnBlock, nReason)" )
								Call SqlRollback(hSql())
							Call SqlCommit(hSql())
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): Карта № " || Str(nCard) || " изъята из STOP-листа")
							Call SalMessageBox("Карта изъята из STOP-листа!", "Внимание", MB_Ok)
						Else
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(-): Пользователь отказался от изъятия из STOP-листа карты № " || Str(nCard))
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Выйти
				Window Location and Size
					Left:   7.4"
					Top:    3.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, FALSE)
		Functions
		Window Parameters
			Number: nEditFlag	! 1 - Edit, 0 - Show
			! nEditFlag = 2 - в карточке показывается только РНК и ФИО клиента
			! nEditFlag = 1 - в карточке показывается всё
			! nEditFlag = 0 - на самом деле нигде не используется
			Number: nCard
			Number: nAcsCard
			Number: nRnk
			String: sFio
			Number: nStatus
			Date/Time: dDat1
			Date/Time: dDat2
			Number: nStopStatus
		Window Variables
			String: sQuestion
			String: sAnswer
			Number: nCodUnBlock
			Number: nReason
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SalSetWindowText(hWndForm, "Состояние карты " || Str(nCard) )
				If nStopStatus = NUMBER_Null
					Call SalDisableWindow(pbDel)
				Else
					Call SalDisableWindow(pbBlock)
					If nStopStatus != 1
						Call SalDisableWindow(pbIns)
					If nStopStatus = 1
						Set nCodUnBlock = 128
					Else If nStopStatus = 0
						Set nCodUnBlock = 130
				! Отображение данных
				Set dfRNK = nRnk
				Set dfFIO = sFio
				Set dfID  = nCard
				Set dfACS_ID = nAcsCard 
				If nEditFlag != 2
					Set dfSTATUS = nStatus
					Set dfISSUER_DATE = dDat1
					Set dfEXPIER_DATE = dDat2
					If SqlPLSQLCommand(hSql(), "bars_nnacs.get_card_keyphrase(nCard, sQuestion, sAnswer)")
						Set mlQuestion = sQuestion
						Set mlAnswer   = sAnswer
				!
				Call SalSetFocus(pbCancel)
				Call SalWaitCursor(FALSE)
	Dialog Box: dlgCardManageAdd
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.317"
				Width Editable? Yes
				Height: 2.286"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Клиент:
				Resource Id: 62119
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.119"
					Width:  1.117"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfFio
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.317"
						Top:    0.083"
						Width:  7.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Bold
					Text Color: 3D Shadow Color
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Frame
				Resource Id: 7705
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.405"
					Width:  8.967"
					Width Editable? Yes
					Height: 0.94"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfQuestion1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    0.548"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfAnswer1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.2"
						Top:    0.548"
						Width:  6.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfQuestion2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    0.81"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfAnswer2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.2"
						Top:    0.81"
						Width:  6.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pbSearch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbSearch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.2"
					Top:    1.452"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If nTrial = 1 
							If SalStrTrimX(SalStrUpperX(dfAnswer1)) = sAnswer2 
									AND 
									   sAnswer2 != STRING_Null
								Set nDone = 1
								Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): "||
										                   "Успешно идентифицирован клиент № "||Str(nRnk)||
										                   " по ключевой фразе")
							Else
								Set nDone = 0
								Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(-): "||
										                   "Неуспешная попытка идентификации клиента № "||Str(nRnk)||
										                   " по ключевой фразе. "||
										                   "Было введено <"||SalStrTrimX(dfAnswer1)||">")
						Else If nTrial = 2 
							If SalStrTrimX(SalStrUpperX(dfAnswer1)) = sAnswer1 
									AND
									   SalStrTrimX(SalStrUpperX(dfAnswer2)) = sAnswer2 
								Set nDone = 2
								Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): "||
										                   "Успешно идентифицирован клиент № "||Str(nRnk)||
										                   " по серии и номеру паспорта")
							Else
								Set nDone = 0
								Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(-): "
										                   ||
										                   "Неуспешная попытка идентификации клиента № "||Str(nRnk)||
										                   " по серии и номеру паспорта. "||
										                   "Были введены <"||SalStrTrimX(dfAnswer1)
										                                   ||" , "
										                                   ||SalStrTrimX(dfAnswer2)
										                                   ||
										                                ">")
						Else
							Set nDone = 3
							Call SaveInfoToLog("NN_CARD_MANAGE_SEARCH(+): "||
									                   "Пользователь подтвердил адрес и дату рождения клиента № "||Str(nRnk))          
						Call SalEndDialog(hWndForm, 0)
			Pushbutton: pbQuit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.183"
					Top:    1.452"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
			Function: F_PopulateTrial
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! попытка №1 - поиск по ключ.слову
					If nTrial = 1 
						Call SalSetWindowText( pbSearch, 'Поиск' )
						Call SalHideWindow(dfQuestion2)
						Call SalHideWindow(dfAnswer2)
						! Call SqlPrepareAndExecute(hSql(),
								"SELECT min(decode(tag,'NNQST',trim(substr(value,1,254)))),
								        min(decode(tag,'NNANW',trim(substr(value,1,254))))
								   INTO :sAnswer1, :sAnswer2
								   FROM customerw
								  WHERE rnk = :nRnk AND tag in ('NNQST', 'NNANW')")
						! If SqlFetchNext(hSql(), nFetchRes)
							                                Set dfQuestion1 = sAnswer1
							                                Set sAnswer2 = SalStrTrimX(SalStrUpperX(sAnswer2))
						Call SqlPLSQLCommand(hSql(), "bars_nnacs.get_card_keyphrase(nCardId, sAnswer1, sAnswer2)")
						Set dfQuestion1 = sAnswer1
						Set sAnswer2 = SalStrTrimX(SalStrUpperX(sAnswer2))
						Call SalSetFocus( dfAnswer1 )
					! попытка №2 - поиск по № и серии паспорта
					Else If nTrial = 2 
						Call SalSetWindowText( pbSearch, 'Поиск' )
						Call SalShowWindow(dfQuestion2)
						Call SalShowWindow(dfAnswer2)
						!
						Set dfQuestion1 = 'Серия паспорта:'
						Set dfQuestion2 = '№ паспорта:'
						!
						If SqlPrepareAndExecute(hSql(),
								"SELECT upper(trim(ser)), upper(trim(numdoc))
								   INTO :sAnswer1, :sAnswer2
								   FROM person
								  WHERE rnk = :nRnk")
							Call SqlFetchNext(hSql(), nFetchRes)
						Call SalSetFocus( dfAnswer1 )
						If sAnswer1 = STRING_Null AND sAnswer2 = STRING_Null
							Set nDone = 69
							Call SalEndDialog(hWndForm, 0)
					! попытка №3 - поиск по адресу и дате рождения
					Else
						Call SalSetWindowText( pbSearch, 'Подтвердить' )
						Call SalShowWindow(dfQuestion2)
						Call SalShowWindow(dfAnswer2)
						Call SalDisableWindow(dfAnswer1)
						Call SalDisableWindow(dfAnswer2)
						!
						Set dfQuestion1 = 'Адрес:'
						Set dfQuestion2 = 'Дата рождения:'
						If SqlPrepareAndExecute(hSql(),
								"SELECT upper(trim(c.adr)), trim(to_char(p.bday,'DD/MM/YYYY'))
								   INTO :dfAnswer1, :dfAnswer2
								   FROM customer c, person p
								  WHERE c.rnk = p.rnk AND c.rnk = :nRnk")
							Call SqlFetchNext(hSql(), nFetchRes)
							Set sAnswer1 = dfAnswer1
							Set sAnswer2 = dfAnswer2
						Call SalSetFocus( pbSearch )
						If sAnswer1 = STRING_Null AND sAnswer2 = STRING_Null
							Set nDone = 69
							Call SalEndDialog(hWndForm, 0)
		Window Parameters
			Number: nCardId
			Number: nRnk
			String: sFio
			! РНК выбранного клиента
			Number: nTrial
			! попытка №1 - поиск по ключ.слову
			! попытка №2 - поиск по № и серии паспорта
			! попытка №3 - поиск по адресу и дате рождения
			Receive Number: nDone
			! -1 - ошиблись дверью
			! 0  - нет совпадения
			! 1  - ключевой вопрос совпал
			! 2  - № и серия паспорта совпали
			! 3  - адрес и дата рождения совпали
			! 69 - данные клиента отсутствуют как таковые
		Window Variables
			Number: nFetchRes
			String: sAnswer1
			String: sAnswer2
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SalSetWindowText(hWndForm, "Уточнение реквизитов клиента "||sFio)
				Set dfFio  = sFio
				Set nDone = -1
				Call F_PopulateTrial()
				Call SalWaitCursor(FALSE)
	Table Window: tblCustomerTobo
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  15.9"
				Width Editable? Class Default
				Height: 6.774"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50786
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50787
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50788
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Підтвердити
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: РНК
						Клієнта
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colNmk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						Клієнта
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colToboOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Старий
						підрозділ
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colInsOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Старий
						інсайдер
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colInsNameOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Назва
						інсайдера
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If colInsNameOld.Init(hWndItem)
							Call colInsNameOld.Populate(hSql(), "prinsider", "NAME", "prinsider",
									"WHERE nvl(otm,0)<>2 ORDER BY prinsider")
			Column: colInsNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новий
						інсайдер
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Validate
						If colInsNew = NUMBER_Null
							Set colInsNameNew = ''
							Set colToboNew    = ''
							Call SalSendMsg(colToboNew, SAM_Validate, 0, 0)
							Return VALIDATE_Ok
						If colInsNew = colInsOld
								OR NOT colInsNameNew.GetNameById(colInsNew)
							Call MessageInfo("Невірний код інсайдера!")
							Set colInsNew = NUMBER_Null
							Set colInsNameNew = ''
							Return VALIDATE_Cancel
						Else
							Call colInsNameNew.SetSelectById(colInsNew)
							Set colToboNew = strTobo[SalListQuerySelection(colInsNameNew)]
							Call SalSendMsg(colToboNew, SAM_Validate, 0, 0)
						Return VALIDATE_Ok
			Column: colInsNameNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Нызва
						інсайдера
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If colInsNameNew.Init(hWndItem)
							! Call colInsNameNew.Populate(hSql(), "prinsider", "NAME", "prinsider", "")
							Call SalListClear(hWndItem)
							Set nI = 0
							If not SqlPrepareAndExecute(hSql(),
									"SELECT prinsider, name, tobo
									   INTO :nKey, :sName, :sTobo
									   FROM prinsider
									  WHERE nvl(otm,0)<>2 OR prinsider=-1 
									  ORDER BY prinsider")
								Return FALSE
							While SqlFetchNext(hSql(), nFetchRes)
								Set colInsNameNew.strList[nI,0] = SalNumberToStrX(nKey, 0)
								Set colInsNameNew.strList[nI,1] = sName
								Set strTobo[nI]   = sTobo
								Call SalListAdd(hWndItem, sName)
								Set nI = nI + 1
							Set colInsNameNew.nItemNum = nI
							Set colInsNameNew.nCurrentId = NUMBER_Null
							Return TRUE
					On SAM_AnyEdit
						Set colInsNew = colInsNameNew.GetKey(SalListQuerySelection(colInsNameNew))
						Call SalSendMsg(colInsNew, SAM_Validate, 0, 0)
			Column: colToboNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новий
						підрозділ
				Visible? Class Default
				Editable? No
				Maximum Data Length: 12
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Validate
						If colToboNew = ''
							Set colToboName = ''
							Return VALIDATE_Ok
						! If NOT colToboName.GetNameById(colToboNew)
							                                                                                  Call MessageInfo("Невірний код підрозділу!")
							                                                                                  Set colToboNew  = ''
							                                                                                  Set colToboName = ''
							                                                                                  Return VALIDATE_Cancel
						! Else
							                                                                                  Call colToboName.SetSelectById(colToboNew)
						Call colToboName.SetSelectById(colToboNew)
						Return VALIDATE_Ok
			Column: colToboName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Назва підрозділу
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If colToboName.Init(hWndItem)
							Call colToboName.Populate(hSql(), "TOBO", "NAME", "TOBO", "ORDER BY tobo")
					On SAM_AnyEdit
						Set colToboNew = colToboName.GetKey(SalListQuerySelection(colToboName))
						Call SalSendMsg(colToboNew, SAM_Validate, 0, 0)
			Column: colSos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRIsp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Зформував
						запит
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRDat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						запиту
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSIsp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Підтвердив
						запит
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSDat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						підтвердження
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colOtm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Otm
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colToboNew1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colInsNew1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: CardExists
				Description:
					! ф-я перевірки існування основної активної картки в клієнта
				Returns
					Boolean:
				Parameters
					Number: nRNK
				Static Variables
				Local variables
					Number: nCarsExist
				Actions
					If SqlPrepareAndExecute(hSql(), 
							"SELECT max(acs_id)
							   INTO :nCarsExist
							   FROM nn_card
							  WHERE rnk = :nRNK
							    AND cardtype_id = 1
							    AND status != 3") 
							AND SqlFetchNext(hSql(), nFetchRes)
						If nCarsExist != NUMBER_Null
							Return TRUE
						Else
							Return FALSE
		Window Parameters
			Number: nPar1	! 0 - перевод клиентов в другое ТОБО(инсайдер)
					                  1 - архив перевода клиентов в другое ТОБО(инсайдер)
					                  2 - подтверждение перевода клиентов в другое ТОБО(инсайдер)
			String: sPar1	! Не используется
			String: sFilter	! Фильтр
		Window Variables
			String: sOurTobo
			Number: nRow
			Boolean: bUpdate
			String: sErr
			Number: nI
			Number: nKey
			String: sName
			String: sTobo
			String: strTobo[*]
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				Set sOurTobo = GetValueStr("SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20) FROM dual")
				Set hWndForm.tblCustomerTobo.strPrintFileName = "KL_QUERY.TXT"
				Set hWndForm.tblCustomerTobo.fFilterAtStart = TRUE
				Call SalDisableWindow(pbDetails)
				Select Case nPar1
					! 0 - перевод клиентов в другое ТОБО
					Case 0
						Call SalSetWindowText(hWndForm, 'Перевод клієнтів до іншого підрозділу.')
						Set hWndForm.tblCustomerTobo.strFilterTblName = "V_CUSTOMER"
						Set hWndForm.tblCustomerTobo.nFlags = GT_NoIns | GT_NoDel
						Call SalEnableWindow(hWndForm.tblCustomerTobo.colInsNew)
						Call SalEnableWindow(hWndForm.tblCustomerTobo.colInsNameNew)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colId)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colApply)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colRIsp)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colRDat)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colSIsp)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colSDat)
						Set hWndForm.tblCustomerTobo.strSqlPopulate =
								"SELECT V_CUSTOMER.rnk, V_CUSTOMER.nmk, d.id, d.sos,
								        V_CUSTOMER.tobo, V_CUSTOMER.prinsider, p.otm,
								        decode(nvl(d.sos,5),5,'',d.tobo_on),
								        decode(nvl(d.sos,5),5,'',d.ins_on),
								        decode(nvl(d.sos,5),5,'',d.tobo_on),
								        decode(nvl(d.sos,5),5,'',d.ins_on)
								   INTO :hWndForm.tblCustomerTobo.colRnk, :hWndForm.tblCustomerTobo.colNmk,
								        :hWndForm.tblCustomerTobo.colId,  :hWndForm.tblCustomerTobo.colSos,
								        :hWndForm.tblCustomerTobo.colToboOld, :hWndForm.tblCustomerTobo.colInsOld,
								        :hWndForm.tblCustomerTobo.colOtm,
								        :hWndForm.tblCustomerTobo.colToboNew, :hWndForm.tblCustomerTobo.colInsNew,
								        :hWndForm.tblCustomerTobo.colToboNew1, :hWndForm.tblCustomerTobo.colInsNew1
								   FROM V_CUSTOMER, v_dpt_vidd_transfer_laststate d, prinsider p
								  WHERE V_CUSTOMER.rnk=d.rnk(+) AND V_CUSTOMER.custtype=3 AND d.type(+)=0
								    AND V_CUSTOMER.prinsider=p.prinsider " || IifS(sFilter='', "", " and (" || sFilter || ")") || "
								  ORDER BY V_CUSTOMER.rnk desc"
						Break
					! 1 - архив
					Case 1
						Call SalSetWindowText(hWndForm, 'АРХІВ переводу клінтів до іншого підрозділу.')
						Set hWndForm.tblCustomerTobo.strFilterTblName = "DPT_VIDD_TRANSFER"
						Set hWndForm.tblCustomerTobo.nFlags = GT_ReadOnly
						Call SalHideWindow(hWndForm.tblCustomerTobo.colApply)
						Set hWndForm.tblCustomerTobo.strSqlPopulate =
								"SELECT c.rnk, c.nmk, DPT_VIDD_TRANSFER.id, DPT_VIDD_TRANSFER.sos,
								        DPT_VIDD_TRANSFER.tobo_off, DPT_VIDD_TRANSFER.ins_off,
								        DPT_VIDD_TRANSFER.tobo_on,  DPT_VIDD_TRANSFER.ins_on,
								        s1.fio, DPT_VIDD_TRANSFER.request_dat, s2.fio, DPT_VIDD_TRANSFER.satisfy_dat
								   INTO :hWndForm.tblCustomerTobo.colRnk, :hWndForm.tblCustomerTobo.colNmk,
								        :hWndForm.tblCustomerTobo.colId,  :hWndForm.tblCustomerTobo.colSos,
								        :hWndForm.tblCustomerTobo.colToboOld, :hWndForm.tblCustomerTobo.colInsOld,
								        :hWndForm.tblCustomerTobo.colToboNew, :hWndForm.tblCustomerTobo.colInsNew,
								        :hWndForm.tblCustomerTobo.colRIsp, :hWndForm.tblCustomerTobo.colRDat,
								        :hWndForm.tblCustomerTobo.colSIsp, :hWndForm.tblCustomerTobo.colSDat
								   FROM customer c, DPT_VIDD_TRANSFER, staff s1, staff s2
								  WHERE c.rnk=DPT_VIDD_TRANSFER.rnk
								    AND DPT_VIDD_TRANSFER.request_isp=s1.id(+)
								    AND DPT_VIDD_TRANSFER.satisfy_isp=s2.id(+)
								    AND c.custtype=3 AND DPT_VIDD_TRANSFER.type=0 " ||
								IifS(sOurTobo='0' OR sOurTobo='', "",
								"   AND (   c.tobo=:hWndForm.sOurTobo
								         OR (DPT_VIDD_TRANSFER.tobo_off=:hWndForm.sOurTobo OR DPT_VIDD_TRANSFER.tobo_on=:hWndForm.sOurTobo) AND DPT_VIDD_TRANSFER.sos=5)") || 
								IifS(sFilter='', "", " and (" || sFilter || ")") ||
								" ORDER BY DPT_VIDD_TRANSFER.id desc"
						Break
					! 2 - подтверждение
					Case 2
						Call SalSetWindowText(hWndForm, 'ПІДТВЕРДЖЕННЯ переводу клінтів до іншого підрозділу.')
						Set hWndForm.tblCustomerTobo.strFilterTblName = "DPT_VIDD_TRANSFER"
						Set hWndForm.tblCustomerTobo.nFlags = GT_NoIns
						! Call SalShowWindow(hWndForm.tblCustomerTobo.colApply)
						! Call SalEnableWindow(hWndForm.tblCustomerTobo.colApply)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colSIsp)
						Call SalHideWindow(hWndForm.tblCustomerTobo.colSDat)
						Set hWndForm.tblCustomerTobo.strSqlPopulate =
								"SELECT c.rnk, c.nmk, DPT_VIDD_TRANSFER.id, DPT_VIDD_TRANSFER.sos,
								        DPT_VIDD_TRANSFER.tobo_off, DPT_VIDD_TRANSFER.ins_off,
								        DPT_VIDD_TRANSFER.tobo_on,  DPT_VIDD_TRANSFER.ins_on,
								        s1.fio, DPT_VIDD_TRANSFER.request_dat
								   INTO :hWndForm.tblCustomerTobo.colRnk, :hWndForm.tblCustomerTobo.colNmk,
								        :hWndForm.tblCustomerTobo.colId,  :hWndForm.tblCustomerTobo.colSos,
								        :hWndForm.tblCustomerTobo.colToboOld, :hWndForm.tblCustomerTobo.colInsOld,
								        :hWndForm.tblCustomerTobo.colToboNew, :hWndForm.tblCustomerTobo.colInsNew,
								        :hWndForm.tblCustomerTobo.colRIsp, :hWndForm.tblCustomerTobo.colRDat
								   FROM v_customer c, DPT_VIDD_TRANSFER, staff s1
								  WHERE c.rnk=DPT_VIDD_TRANSFER.rnk
								    AND DPT_VIDD_TRANSFER.request_isp=s1.id
								    AND DPT_VIDD_TRANSFER.sos=0 AND c.custtype=3
								    AND DPT_VIDD_TRANSFER.type=0 " || IifS(sFilter='', "", " and (" || sFilter || ")") || "
								  ORDER BY DPT_VIDD_TRANSFER.id desc"
						Set hWndForm.tblCustomerTobo.strSqlDelete =
								"UPDATE dpt_vidd_transfer
								 SET sos=-1, satisfy_isp=user_id, satisfy_dat=sysdate
								 WHERE id=:hWndForm.tblCustomerTobo.colId"
						Break
					Default
						Break
				Call PrepareWindow(hWndForm)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
				Call SalTblSetColumnWidth(hWndForm.tblCustomerTobo.colToboName, 4)
				Call SalTblSetColumnWidth(hWndForm.tblCustomerTobo.colInsNameNew, 4)
			On UM_Update
				! 0 - переведення клієнта в інший підрозділ 
				If nPar1 = 0
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set bUpdate = TRUE
						If hWndForm.tblCustomerTobo.colInsNew = NUMBER_Null
							If IDYES = MessageQuestion("Для клієнта " || Str(hWndForm.tblCustomerTobo.colRnk) || " " || hWndForm.tblCustomerTobo.colNmk ||
									" вже зформовано запит на підрозділ " || hWndForm.tblCustomerTobo.colToboNew1 ||
									"(" || Str(hWndForm.tblCustomerTobo.colInsNew1) || ")." || PutCrLf() ||
									"Видалити запит?")
								If SqlPrepareAndExecute(hSql(),
										"UPDATE dpt_vidd_transfer
										 SET sos=-1, satisfy_isp=user_id, satisfy_dat=sysdate
										 WHERE id=:hWndForm.tblCustomerTobo.colId AND sos<>-1")
									Call SqlCommitEx(hSql(), "Удален запрос " || Str(hWndForm.tblCustomerTobo.colId) ||
											" на перевод клиента " || Str(hWndForm.tblCustomerTobo.colRnk) ||
											" из отделения " || hWndForm.tblCustomerTobo.colToboOld ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsOld) || ")"   ||
											" в отделение "  || hWndForm.tblCustomerTobo.colToboNew1 ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsNew1) || ")"   || " [" || GetUserRealName() || "]")
								Else
									Call SqlRollback(hSql())
							Set bUpdate = FALSE
						Else
							If hWndForm.tblCustomerTobo.colInsNew  != hWndForm.tblCustomerTobo.colInsNew1 AND
									   hWndForm.tblCustomerTobo.colInsNew1 != NUMBER_Null
								If IDYES = MessageQuestion("Для клієнта " || Str(hWndForm.tblCustomerTobo.colRnk) || " " || hWndForm.tblCustomerTobo.colNmk ||
										" вже зформовано запит на підрозділ "  || hWndForm.tblCustomerTobo.colToboNew1 ||
										"(" || Str(hWndForm.tblCustomerTobo.colInsNew1) || ")." || PutCrLf() ||
										"Переформувати запит на підрозділ "    || hWndForm.tblCustomerTobo.colToboNew  ||
										"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")?")
									If SqlPrepareAndExecute(hSql(),
											"UPDATE dpt_vidd_transfer
											 SET sos=-1, satisfy_isp=user_id, satisfy_dat=sysdate
											 WHERE id=:hWndForm.tblCustomerTobo.colId AND sos<>-1")
										Call SqlCommitEx(hSql(), "Удален запрос " || Str(hWndForm.tblCustomerTobo.colId) ||
												" на перевод клиента " || Str(hWndForm.tblCustomerTobo.colRnk) ||
												" из отделения " || hWndForm.tblCustomerTobo.colToboOld ||
												"(" || Str(hWndForm.tblCustomerTobo.colInsOld) || ")"   ||
												" в отделение "  || hWndForm.tblCustomerTobo.colToboNew1 ||
												"(" || Str(hWndForm.tblCustomerTobo.colInsNew1) || ")"   || " [" || GetUserRealName() || "]")
									Else
										Call SqlRollback(hSql())
								Else
									Set bUpdate = FALSE
						! перевірка на існування основної активної картки в клієнта
						! If NOT CardExists(hWndForm.tblCustomerTobo.colRnk)
							       Call SalMessageBox("Заборонено переводити клієнта у якого немає основної карти!",
									                   CurrentLangTable.GetAtomTitle('cTErr'),
											   MB_IconStop)
							       Call SqlRollback(hSql())
						If SqlPrepareAndExecute(hSql(),
								"INSERT INTO dpt_vidd_transfer(rnk, type, tobo_off, ins_off, tobo_on, ins_on,
								   sos, request_isp, request_dat)
								 VALUES(:hWndForm.tblCustomerTobo.colRnk, 0,
								   :hWndForm.tblCustomerTobo.colToboOld, :hWndForm.tblCustomerTobo.colInsOld,
								   :hWndForm.tblCustomerTobo.colToboNew, :hWndForm.tblCustomerTobo.colInsNew,
								   0, user_id, sysdate)")
							Call SqlCommitEx(hSql(), "Создан запрос " ||
									" на перевод клиента " || Str(hWndForm.tblCustomerTobo.colRnk) ||
									" из отделения " || hWndForm.tblCustomerTobo.colToboOld ||
									"(" || Str(hWndForm.tblCustomerTobo.colInsOld) || ")"   ||
									" в отделение "  || hWndForm.tblCustomerTobo.colToboNew ||
									"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")"   || " [" || GetUserRealName() || "]")
						Else
							Call SqlRollback(hSql())
				! 2 - підтвердження переведення
				Else If nPar1 = 2
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Edited | ROW_MarkDeleted, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
							If hWndForm.tblCustomerTobo.colApply
								Set sErr = ''
								If NOT SqlPLSQLCommand(hSql(), "nn.p_dpt_transfer(hWndForm.tblCustomerTobo.colId, hWndForm.tblCustomerTobo.sErr)")
									Call SqlRollback(hSql())
									Call MessageError("Ошибка выполнения процедуры перевода клиента " || Str(hWndForm.tblCustomerTobo.colRnk) || " " || hWndForm.tblCustomerTobo.colNmk ||
											" в отделение " || hWndForm.tblCustomerTobo.colToboNew ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")")
									Break
								If sErr = ''
									Call SqlCommitEx(hSql(), "Подтвержден запрос " || Str(hWndForm.tblCustomerTobo.colId) ||
											" на перевод клиента " || Str(hWndForm.tblCustomerTobo.colRnk) ||
											" из отделения " || hWndForm.tblCustomerTobo.colToboOld ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsOld) || ")" ||
											" в отделение "  || hWndForm.tblCustomerTobo.colToboNew ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")" || " [" || GetUserRealName() || "]")
								Else
									Call SqlRollback(hSql())
									Call MessageError("Ошибка перевода клиента " || Str(hWndForm.tblCustomerTobo.colRnk) || " " || hWndForm.tblCustomerTobo.colNmk ||
											" в отделение " || hWndForm.tblCustomerTobo.colToboNew ||
											"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")" || ":" || PutCrLf() || sErr)
						Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
							If SqlPrepareAndExecute(hSql(),
									"UPDATE dpt_vidd_transfer
									 SET sos=-1, satisfy_isp=user_id, satisfy_dat=sysdate
									 WHERE id=:hWndForm.tblCustomerTobo.colId")
								Call SqlCommitEx(hSql(), "Отклонен запрос " || Str(hWndForm.tblCustomerTobo.colId) ||
										" на перевод клиента " || Str(hWndForm.tblCustomerTobo.colRnk) ||
										" из отделения " || hWndForm.tblCustomerTobo.colToboOld ||
										"(" || Str(hWndForm.tblCustomerTobo.colInsOld) || ")" ||
										" в отделение "  || hWndForm.tblCustomerTobo.colToboNew ||
										"(" || Str(hWndForm.tblCustomerTobo.colInsNew) || ")" || " [" || GetUserRealName() || "]")
							Else
								Call SqlRollback(hSql())
				Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				If hWndForm.tblCustomerTobo.colInsOld != NUMBER_Null
					Call hWndForm.tblCustomerTobo.colInsNameOld.SetSelectById(hWndForm.tblCustomerTobo.colInsOld)
				If hWndForm.tblCustomerTobo.colInsNew != NUMBER_Null
					Call hWndForm.tblCustomerTobo.colInsNameNew.SetSelectById(hWndForm.tblCustomerTobo.colInsNew)
				If hWndForm.tblCustomerTobo.colToboNew != ''
					Call hWndForm.tblCustomerTobo.colToboName.SetSelectById(hWndForm.tblCustomerTobo.colToboNew)
				! Клиент переведен из нашего ТОБО - желтый
				If hWndForm.tblCustomerTobo.colToboOld  = sOurTobo AND sOurTobo != '' AND
						   hWndForm.tblCustomerTobo.colToboNew != ''
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255,255,200) )
				! Клиент переведен в наше ТОБО - зеленый
				Else If hWndForm.tblCustomerTobo.colToboNew = sOurTobo AND sOurTobo != ''
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(220,255,220) )
				! Неподтвержденный запрос - синий
				If hWndForm.tblCustomerTobo.colSos = 0
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(220,255,255) )
				! Запрос отклонен - красный
				Else If hWndForm.tblCustomerTobo.colSos = -1
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255,220,220) )
			On SAM_RowHeaderClick
				! Клиент переведен из нашего ТОБО -желтый
				If hWndForm.tblCustomerTobo.colToboOld = sOurTobo AND sOurTobo != '' AND
						   hWndForm.tblCustomerTobo.colToboNew != ''
					Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(255,255,170) )
					Call XSalTooltipShow(hWndForm, 'Переведено В ІНШИЙ підрозділ')
				! Клиент переведен в наше ТОБО - зеленый
				Else If hWndForm.tblCustomerTobo.colToboNew = sOurTobo AND sOurTobo != ''
					Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(230,255,220) )
					Call XSalTooltipShow(hWndForm, 'Переведено З ІНШОГО підрозділу')
				! Неподтвержденный запрос - синий
				If hWndForm.tblCustomerTobo.colSos = 0
					Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(220,255,255) )
					Call XSalTooltipShow(hWndForm, 'Непідтверджений запит')
				! Запрос отклонен - красный
				Else If hWndForm.tblCustomerTobo.colSos = -1
					Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(255,200,220) )
					Call XSalTooltipShow(hWndForm, 'Запит відхилено')
				Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
	Form Window: frmSetCustomerAccNN
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Відкриття рахунків
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.458"
				Width:  15.3"
				Width Editable? Class Default
				Height: 6.393"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Update, 0, 0)
				Line
					Resource Id: 50789
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Click
							! Call KlAccNN(hWndForm, 1, 0, 0, '', '')
							                                                                                            Call SalCreateWindow(Tbl_Request, hWndMDI, 0, 0, '', '')
							! Call ShowParHistory(hWndMDI, 3, 1, '', '')
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50790
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50791
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Клієнтів всього
					Resource Id: 50792
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.717"
						Top:    0.167"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				Data Field: dfCustCount
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.617"
							Top:    0.107"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Child Table: tblCust
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  7.133"
						Width Editable? Class Default
						Height: 5.0"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colRNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реєстра-
								ційний
								номер
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.283"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTOBO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код 
								теріторіал.
								управління
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.117"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colINS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								інсай-
								дера
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.75"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colINSNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
								інсайдера
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.967"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDATEON
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								реєстрації
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.067"
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					! cColumnLabeled: colNNAcc
.winattr class Column:
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
.end
						                                  List Values 
						                                  Message Actions 
					Column: colCustCount
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nRow
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On UM_Populate
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
						Set dfCustCount = SalTblColumnSum(hWndForm, SalTblQueryColumnID(colCustCount), 0, 0)
						Call SalTblSetContext(hWndForm, 0)
						Call SalSendMsg(tblAcc, SAM_TblDoDetails, 0, 0)
					On SAM_TblDoDetails
						Call SalSendMsg(tblAcc, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If not SqlPLSQLCommand(hSql(), "bars_mvo.process_customer_reqacc(colRNK)")
								Call SqlRollbackEx(hSql(), "")
								Break
							Else
								Call SqlCommitEx(hSql(), "")
			Child Table: tblAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   7.633"
						Top:    0.048"
						Width:  4.967"
						Width Editable? Yes
						Height: 4.988"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип рахунку
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOtm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colApply
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вибрати
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_AnyEdit
								If colOtm and colLock
									Set colApply = 1
									Return TRUE
								If not SqlPLSQLCommand(hSql(), "bars_mvo.modify_customer_reqacc(tblCust.colRNK, colType, " || 
										     IifS(colApply=1, "'Y'", "'N'") || ")")
									Call SqlRollbackEx(hSql(), "")
								Else
									Call SqlCommitEx(hSql(), "")
								! Call SalTblSetRowFlags(tblCust, SalTblQueryContext(tblCust), ROW_Edited, TRUE)
								Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					Column: colNls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKv
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Валюта
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colLock
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: GetNls
						Description:
						Returns
							String:
						Parameters
							Number: nType
						Static Variables
						Local variables
						Actions
							Set sNls = ''
							Set i = 0
							While i < nNlsNum
								If nmAccType[i] = nType
									Set sNls = smNls[i]
									Break
								Set i = i + 1
							Return sNls
				Window Variables
					String: sNls
					Number: nAccType
					String: smNls[*]
					Number: nmAccType[*]
					Number: nNlsNum
					Number: i
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On UM_Populate
						Call SalTblPopulate(hWndForm, hSql(),
								"select acctype_code, acctype_name, 
								        decode(need_open,'Y',1,0), 
								        decode(is_locked,'Y',1,0), acc_num, curr_code
								   into :colType, :colName, :colOtm, :colLock, :colNls, :colKv
								   from v_mvo_reqaccs
								  where cust_id = :tblCust.colRNK
								  order by acctype_code", TBL_FillAll)
						Call SalTblSetContext(hWndForm, 0)
						Call VisTblAutoSizeColumn(tblAcc, colName)
						Call VisTblAutoSizeColumn(tblAcc, colApply)
					On SAM_FetchRowDone
						If colOtm
							Set colApply = 1
						Else
							If colLock
								Set colApply = 1
								Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
						If colNls != ''
							Call XSalTblSetCellBackColor(tblAcc.colName,  SalColorFromRGB(230,255,230) )
							Call XSalTblSetCellBackColor(tblAcc.colApply, SalColorFromRGB(230,255,230) )
							Call XSalTblSetCellBackColor(tblAcc.colNls,   SalColorFromRGB(230,255,230) )
						Else
							Call XSalTblSetCellBackColor(tblAcc.colName,  COLOR_White)
							Call XSalTblSetCellBackColor(tblAcc.colApply, COLOR_White)
							Call XSalTblSetCellBackColor(tblAcc.colNls,   COLOR_White)
			Custom Control: cSplMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			Number: nPar1
			String: sPar1
			String: sFilter
		Window Variables
			Number: nCustCount
			!
			Number: nWW
			Number: nWH
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeight
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, 'Відкриття рахунків')
				Set hWndForm.frmSetCustomerAccNN.nFlags = GT_NoIns | GT_NoDel
				Call SalDisableWindow(pbDetails)
				Set hWndForm.frmSetCustomerAccNN.fFilterAtStart = TRUE
				Set hWndForm.frmSetCustomerAccNN.strFilterTblName = 'v_mvo_active_custreqs'
				Set hWndForm.frmSetCustomerAccNN.strSqlPopulate =
						"select v_mvo_active_custreqs.cust_id, v_mvo_active_custreqs.cust_name, 
						        v_mvo_active_custreqs.cust_open, v_mvo_active_custreqs.cust_branch, 
						        v_mvo_active_custreqs.cust_inscode, v_mvo_active_custreqs.cust_insname, 1 
						   into :hWndForm.tblCust.colRNK,    :hWndForm.tblCust.colNAME,
						        :hWndForm.tblCust.colDATEON, :hWndForm.tblCust.colTOBO,
						        :hWndForm.tblCust.colINS,    :hWndForm.tblCust.colINSNAME, :hWndForm.tblCust.colCustCount
						   from v_mvo_active_custreqs " || IifS(sFilter='', "", " where (" || sFilter || ")") || "
						  order by v_mvo_active_custreqs.cust_id desc"
				Call SalSendClassMessage(SAM_Create, 0, 0)
				! главное окно
				Call cSplMain.setBarSize(5)
				Call cSplMain.setBarPosition( 500 )
				Call cSplMain.setLeftFrame(tblCust)
				Call cSplMain.setRightFrame(tblAcc)
			On UM_Update
				Call SalSendMsg(tblCust, UM_Update, 0, 0)
				Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
	Table Window: tblCardStatus
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12312
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12313
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12314
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: РНК держателя
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО держателя
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colACS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						АКС
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colMEMBER_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						участника
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colPOOL_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						пула
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colISSUER_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата страта
						карты
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colEXPIRE_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						окончания
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSTATUS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Текуший
						статус
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSTATUS_PLAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плановый
						статус
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: sPar1
			String: sPar2
		Window Variables
			Number: nId
			Number: nFocusRow
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, "Управление статусом карт")
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set tblCardStatus.fFilterAtStart = TRUE
				Set tblCardStatus.nFlags = GT_ReadOnly
				Set tblCardStatus.strFilterTblName = "NN_CARD_STATUS"
				Set tblCardStatus.strSqlPopulate =
						"SELECT RNK, NMK, ID, ACS_ID, MEMBER_NO, POOL_NO, 
						        ISSUER_DATE, EXPIRE_DATE, STATUS, STATUS_PLAN 
						   INTO :hWndForm.tblCardStatus.colRNK, :hWndForm.tblCardStatus.colNMK, 
						        :hWndForm.tblCardStatus.colID, :hWndForm.tblCardStatus.colACS_ID, 
						        :hWndForm.tblCardStatus.colMEMBER_NO, :hWndForm.tblCardStatus.colPOOL_NO, 
						        :hWndForm.tblCardStatus.colISSUER_DATE, :hWndForm.tblCardStatus.colEXPIRE_DATE, 
						        :hWndForm.tblCardStatus.colSTATUS, :hWndForm.tblCardStatus.colSTATUS_PLAN 
						   FROM NN_CARD_STATUS 
						  ORDER BY nmk, acs_id"
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Set nId = 0
				Set nFocusRow = 0
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
			On SAM_FetchRowDone
				If nId = colID
					Set nFocusRow = lParam
			On SAM_DoubleClick
				Set nId = colID
				If SalModalDialog(dlgCardStatus, hWndMDI, colID, colACS_ID, colSTATUS, colRNK, colNMK)
					Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					Call SalTblSetFocusRow(hWndForm, nFocusRow)
	Dialog Box: dlgCardStatus
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.45"
				Width Editable? Yes
				Height: 3.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 12315
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.08"
					Top:    0.06"
					Width:  8.2"
					Width Editable? Yes
					Height: 1.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 12316
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.85"
					Width:  8.2"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: Идентификатор карты:
				Resource Id: 12317
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.286"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.9"
						Top:    0.2"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Идентификатор в АКС:
				Resource Id: 12318
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.583"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfIdAcs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.9"
						Top:    0.5"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Статус карты:
				Resource Id: 12321
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.881"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Combo Box: cmbStatus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.9"
					Top:    0.8"
					Width:  3.0"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbStatus.Init(hWndItem)
							Call cmbStatus.Populate(hSql(), 'id', 'name', 'nn_status', 'ORDER BY id' )
							Call cmbStatus.SetSelectById(nStatus)
					On SAM_Click
						Call SalEnableWindow(pbSave)
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set nStatus = cmbStatus.nCurrentId
						Set sStatus = cmbStatus.GetNameById(nStatus)
			Background Text: РНК держателя карты:
				Resource Id: 12320
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.179"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.9"
						Top:    1.1"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: ФИО держателя карты:
				Resource Id: 12319
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.488"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfNmk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.9"
						Top:    1.4"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbSave
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   5.2"
					Top:    2.0"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalMessageBox("Вы действительно хотите изменить состояние карты на '" || sStatus || "'?", 
								   "Внимание", MB_IconQuestion|MB_YesNo) = IDYES
							If SqlPrepareAndExecute(hSql(), 
									"UPDATE nn_card_status SET status=:nStatus WHERE id=:nId")
								Call SqlCommitEx(hSql(), "CardStatus. Изменен статус карты №" || Str(nId) || 
										" на " || Str(nStatus))
								Call SalEndDialog(hWndForm, 1)
							Call SqlCommit(hSql()) 
							Call SaveInfoToLog("Изменено состояние карты № " || Str(nId))
						Else
							Call SaveInfoToLog("Пользователь отказался от изменения состояния карты № " || Str(nId))
			Pushbutton: pbClose
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.7"
					Top:    2.0"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Number: nId
			Number: nIdAcs
			Number: nStatus
			Number: nRnk
			String: sNmk
		Window Variables
			String: sStatus
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, "Установка статуса карты")
				Call PrepareWindowEx(hWndForm)
				Call SalDisableWindow(pbSave)
				Set dfId  = nId
				Set dfIdAcs = nIdAcs
				Set dfRnk = nRnk
				Set dfNmk = sNmk
	Form Window: frmFileManage
		Class:
		Property Template:
		Class DLL Name:
		Title: Управление файловым обменом
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.0"
				Width Editable? Yes
				Height: 3.0"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pbExecute
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTimer
				Property Template:
				Class DLL Name:
				Title: Включить файловый обмен
				Window Location and Size
					Left:   1.433"
					Top:    1.071"
					Width:  3.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmpState = getCurrStateBlock()
						If nTmpState = NUMBER_Null
							Call MessageInfo('Не удалось прочитать состояние файлового обмена.')
							Return FALSE
						If nCurrState = nTmpState
							If nCurrState = 1
								If StateOff()
									Call SqlCommitEx(hSql(), 'Файловый обмен включен')
								Else
									Call SqlRollbackEx(hSql(), 'Ошибка выполнения процедуры включения файлового обмена')
							Else If nCurrState = 0
								If StateOn()
									Call SqlCommitEx(hSql(), 'Файловый обмен отключен')
								Else
									Call SqlRollbackEx(hSql(), 'Ошибка выполнения процедуры отключения файлового обмена')
						Else
							If nCurrState = 1
								Call MessageInfo('Файловый обмен уже НЕ работает')
							Else If nCurrState = 0
								Call MessageInfo('Файловый обмен уже работает')
							Call SqlRollback(hSql())
						Call readState()
			Pushbutton: pbTimer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTimer
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Default
					Top:    Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Call pbTimer.Init(10, 0, TRUE)
					On UM_TimerFired
						Call readState()
		Functions
			Function: getCurrState
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					Number: nState
				Actions
					If NOT SqlPrepareAndExecute(hSql(), 
							"SELECT to_number(value) INTO :nState 
							   FROM nn_params WHERE name='NMON.ACTIVE'") 
							OR NOT SqlFetchNext(hSql(), nFetchRes)
						Return NUMBER_Null
					Return nState
			Function: getCurrStateBlock
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					Number: nState
				Actions
					If NOT SqlPrepareAndExecute(hSql(), 
							"SELECT to_number(value) INTO :nState 
							   FROM nn_params WHERE name='NMON.ACTIVE' 
							FOR UPDATE OF value NOWAIT") 
							OR NOT SqlFetchNext(hSql(), nFetchRes)
						Return NUMBER_Null
					Return nState
			Function: StateOn
				Description: Процедура изменения состояния обмена на включенное
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute(hSql(), 
							"UPDATE NN_PARAMS SET VALUE=1 WHERE NAME='NMON.ACTIVE'")
						Return TRUE
					Return FALSE
			Function: StateOff
				Description: Процедура изменения состояния обмена на выключенное
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute(hSql(), 
							"UPDATE NN_PARAMS SET VALUE=0 WHERE NAME='NMON.ACTIVE'")
						Return TRUE
					Return FALSE
			Function: readState
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nCurrState = getCurrState()
					If nCurrState = NUMBER_Null
						Call MessageInfo('Не удалось прочитать текущее состояние файлового обмена.')
						Call SalDestroyWindow(hWndForm)
					If nCurrState = 0
						Call SalSetWindowText(pbExecute, 'Включить файловый обмен')
						Call SalColorSet(pbExecute, COLOR_IndexWindowText, COLOR_DarkBlue)
					Else If nCurrState = 1
						Call SalSetWindowText(pbExecute, 'Отключить файловый обмен')
						Call SalColorSet(pbExecute, COLOR_IndexWindowText, COLOR_DarkRed)
		Window Parameters
		Window Variables
			Number: nCurrState
			Number: nTmpState
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalCenterWindow(pbExecute)
			On SAM_CreateComplete
				Call readState()
	Form Window: frmInputAdrDoc
		Class: cDocWMBO
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Ввод адресных платежей
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbPayDoc
					Class Child Ref Key: 48
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 49
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrtDoc
					Class Child Ref Key: 50
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47047
					Class Child Ref Key: 51
					Class ChildKey: 0
					Class: cDocWMBO
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text:
					Resource Id: 47048
					Class Child Ref Key: 52
					Class ChildKey: 0
					Class: cDocWMBO
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Justify: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Line
					Resource Id: 47049
					Class Child Ref Key: 53
					Class ChildKey: 0
					Class: cDocWMBO
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 47050
					Class Child Ref Key: 54
					Class ChildKey: 0
					Class: cDocWMBO
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfZn
					Class Child Ref Key: 55
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfOst
					Class Child Ref Key: 56
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbNewDoc
					Class Child Ref Key: 57
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbNewTTs
					Class Child Ref Key: 58
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDocBal
					Class Child Ref Key: 59
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHelp
					Class Child Ref Key: 60
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveKor
					Class Child Ref Key: 61
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbLocalD
					Class Child Ref Key: 62
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47051
					Class Child Ref Key: 63
					Class ChildKey: 0
					Class: cDocWMBO
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbHotVytyag
					Class Child Ref Key: 64
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotFio
					Class Child Ref Key: 65
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotName
					Class Child Ref Key: 66
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotOstat
					Class Child Ref Key: 67
					Class ChildKey: 0
					Class: cDocWMBO
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Data Field: dfValD1
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbVob
				Class Child Ref Key: 2
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text:
				Resource Id: 47043
				Class Child Ref Key: 3
				Class ChildKey: 0
				Class: cDocWMBO
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfNd
				Class Child Ref Key: 4
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDateFrom
				Class Child Ref Key: 5
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDocD
				Class Child Ref Key: 6
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankA
				Class Child Ref Key: 7
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvA
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsA
				Class Child Ref Key: 9
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlat
				Class Child Ref Key: 10
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamA
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoA
				Class Child Ref Key: 12
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlatB
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbA
				Class Child Ref Key: 14
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankB
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPoluB
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbB
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvB
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsB
				Class Child Ref Key: 19
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					! Отключена проверка поиска счета для адресного платежа в рамках своего МФО 
					On SAM_Validate
						If SalQueryFieldEdit(hWndItem)
							Call SalClearField(dfNamB)
							Call SalClearField(dfOkpoB)
						Set dfNlsB = SalStrTrimX(dfNlsB)
						If wParam = SalWindowHandleToNumber(pbHelp)
							Return VALIDATE_OkClearFlag
						If SalIsNull(hWndItem) and not frmInputAdrDoc.bTotVal
							Return VALIDATE_OkClearFlag
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotNumB'),
									                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation)
							Return VALIDATE_Cancel
						If not SalIsNull(dfBankB)
							If dfNlsB != KeyAccount(dfBankB, dfNlsB)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('DocWMesErrNlsCrcB'),
										                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation)
								Return VALIDATE_Cancel
						If frmInputAdrDoc.nKvB and not frmInputAdrDoc.bTotVal
							If dfBankB = dfBankA
								! без проверок
							Else
								Call SqlPrepareAndExecute(hSql(), T(
										"SELECT name,okpo INTO :dfNamB,:dfOkpoB FROM alien WHERE mfo=:dfBankB AND nls=:dfNlsB and kv=:nKvB"))
								If not SqlFetchNext(hSql(), nFetchRes)
									Set dfNamB  = ''
									Set dfOkpoB = ''
						If frmInputAdrDoc.bFixNlsB 
							Set frmInputAdrDoc.sFixNlsB = dfNlsB
						Return VALIDATE_OkClearFlag
			Data Field: dfPolu
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamB
				Class Child Ref Key: 21
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoB
				Class Child Ref Key: 22
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNA
				Class Child Ref Key: 23
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumA
				Class Child Ref Key: 24
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNB
				Class Child Ref Key: 25
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumB
				Class Child Ref Key: 26
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNomN
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNom
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNC
				Class Child Ref Key: 29
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumC
				Class Child Ref Key: 30
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquivN
				Class Child Ref Key: 31
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquiv
				Class Child Ref Key: 32
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			List Box: lb1
				Class Child Ref Key: 33
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
			Multiline Field: dfNazn
				Class Child Ref Key: 34
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					String Type: Class Default
					Editable? Class Default
				Display Settings
					Border? Class Default
					Word Wrap? Class Default
					Vertical Scroll? Class Default
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Message Actions
			Data Field: dfSkN
				Class Child Ref Key: 35
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 36
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD1N
				Class Child Ref Key: 37
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2N
				Class Child Ref Key: 38
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2
				Class Child Ref Key: 39
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfD
				Class Child Ref Key: 40
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfK
				Class Child Ref Key: 41
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Frame
				Resource Id: 47044
				Class Child Ref Key: 42
				Class ChildKey: 0
				Class: cDocWMBO
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Frame
				Resource Id: 47045
				Class Child Ref Key: 43
				Class ChildKey: 0
				Class: cDocWMBO
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Frame
				Resource Id: 47046
				Class Child Ref Key: 44
				Class ChildKey: 0
				Class: cDocWMBO
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Data Field: dfLocDat
				Class Child Ref Key: 45
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbUgrnt
				Class Child Ref Key: 46
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfVytyagN
				Class Child Ref Key: 47
				Class ChildKey: 0
				Class: cDocWMBO
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			String: colFlags
		Message Actions
			On UM_Choose
				Set dDat = GetBankDate()
				If not bDocStart
					Set bDocStart=TRUE
					Set bDocStart=TRUE
					Set bFixAll=FALSE
					Set bFixNlsA=FALSE
					Set bFixKvA=FALSE
					Set bFixKvB=FALSE
					Set bFixNlsB=FALSE
					Set bFixMfoB=FALSE
					Set bFixDocD=FALSE
					Set bFixValD1=FALSE
					Set sFixKvA=STRING_Null
					Set sFixNlsA=STRING_Null
					Set sFixKvB=STRING_Null
					Set sFixNlsB=STRING_Null
					Set sFixMfoB=STRING_Null
					Set dFixDocD=DATETIME_Null
					Set dFixValD1=DATETIME_Null
					Set nFixVob=NUMBER_Null
					Call SqlPrepareAndExecute(hSql(), 
							"SELECT t.tt, t.name, t.fli, t.flv, nvl(t.dk,1), t.kv, t.kvk, 
							        trim(t.nlsa), trim(t.nlsb), t.mfob, t.sk, t.flags, TRIM(t.s), TRIM(t.s2)
							   INTO :sTT, :sTTN, :nFli, :nFlv, :nDk, :nKvA_TT, :nKvB_TT, 
							        :sNlsA_TT, :sNlsB_TT, :sBankB_TT, :nSk_TT, :colFlags, :sS, :sSS
							   FROM tts t 
							  WHERE t.tt='АДР'")
					If NOT SqlFetchNext(hSql(), nFetchRes)
						Call SalMessageBox("Не описана операція 'АДР' для вводу адресних платежів.", 'Увага!', MB_Ok | MB_IconExclamation)
						Call SalDestroyWindow(hWndForm)
						Return TRUE
					Set nFpy=SalStrToNumber(SalStrMidX(colFlags,37,1))
					Set nFvD1=SalStrToNumber(SalStrMidX(colFlags,3,1))
					Set nFvD2=SalStrToNumber(SalStrMidX(colFlags,49,1))
					Set nFcb=SalStrToNumber(SalStrMidX(colFlags,58,1))
					Set nFtr=SalStrToNumber(SalStrMidX(colFlags,59,1))
					Set nFbk=SalStrToNumber(SalStrMidX(colFlags,60,1))
					Set nFpr=SalStrToNumber(SalStrMidX(colFlags,46,1))
					Set nFdp=SalStrToNumber(SalStrMidX(colFlags,35,1))
					Set nFug=SalStrToNumber(SalStrMidX(colFlags,12,1))
					Set nFeq=SalStrToNumber(SalStrMidX(colFlags,14,1))
					Set nFdd=SalStrToNumber(SalStrMidX(colFlags,4,1))
					Set nFsk=SalStrToNumber(SalStrMidX(colFlags,9,1))
					Set nFhr=SalStrToNumber(SalStrMidX(colFlags,11,1))
					If nFsk = 0
						Set nSk_TT=NUMBER_Null
					Else
						If nSk_TT=NUMBER_Null
							Set nSk_TT=0
					Set sNlsA_TT = NlsSubst(sNlsA_TT)
					Set sNlsB_TT = NlsSubst(sNlsB_TT)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DocWTit') || ' - [ ' || sTTN || ' ]' )
				Call SalSendMsg(hWndForm, UM_Clear, 0, 0)
			On SAM_Help
				Call SalLoadApp("WinHlp32.exe","-w Win1 -i Fi_14 " || GetHelpFile() )
			! Отключена проверка поиска счета для адресного платежа в рамках своего МФО 
			On UM_HotAccountList
				Set bAcc = FALSE
				If bAccB = 1
					If (nDk = 1 or nDk = 3) and bAccB = 1
						Set bAcc  = bAccB
						Set bAccB = 0
				Call SalSendClassMessage(UM_HotAccountList, 0, 0)
				If bAcc
					Set bAccB = bAcc
					Set sNls  = dfNlsB
					Set nKv   = nKvB
					Set sNls  = dfNlsB
					Set sNms  = dfNamB
					Set sOkpo = dfOkpoB
					Set sMfo  = dfBankB
					If SalModalDialog(dlgAlien, hWndForm, bAccB, nKv, sLcv, sNls, sOkpo, sNms, sMfo, sNb)
						Set dfNlsB  = sNls
						Set dfNamB  = sNms
						Set dfBankB = sMfo
						Set dfNbB   = sNb
						Set nKvB    = nKv
						Set dfKvB   = sLcv
						Set dfOkpoB = sOkpo
						Call SalSendMsg(dfKvB, SAM_Validate, 0, 0)
						Call SalSetFocus(dfNlsB)
	Form Window: frmInputAdrDocSber
		Class: cDocW
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbPayDoc
					Class Child Ref Key: 27
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 29
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrtDoc
					Class Child Ref Key: 30
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48209
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text:
					Resource Id: 48210
					Class Child Ref Key: 75
					Class ChildKey: 0
					Class: cDocW
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Justify: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Line
					Resource Id: 48211
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 48212
					Class Child Ref Key: 59
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfZn
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfOst
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbNewDoc
					Class Child Ref Key: 53
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbNewTTs
					Class Child Ref Key: 60
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDocBal
					Class Child Ref Key: 72
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHelp
					Class Child Ref Key: 62
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveKor
					Class Child Ref Key: 64
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbLocalD
					Class Child Ref Key: 148
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48213
					Class Child Ref Key: 77
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbHotVytyag
					Class Child Ref Key: 138
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotFio
					Class Child Ref Key: 141
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotName
					Class Child Ref Key: 137
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotOstat
					Class Child Ref Key: 150
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Data Field: dfValD1
				Class Child Ref Key: 25
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbVob
				Class Child Ref Key: 39
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text:
				Resource Id: 48205
				Class Child Ref Key: 36
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfNd
				Class Child Ref Key: 23
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDateFrom
				Class Child Ref Key: 155
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDocD
				Class Child Ref Key: 22
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankA
				Class Child Ref Key: 4
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvA
				Class Child Ref Key: 50
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsA
				Class Child Ref Key: 2
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlat
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamA
				Class Child Ref Key: 7
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoA
				Class Child Ref Key: 139
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlatB
				Class Child Ref Key: 9
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbA
				Class Child Ref Key: 6
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankB
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPoluB
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbB
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvB
				Class Child Ref Key: 51
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsB
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Validate
						If SalQueryFieldEdit(hWndItem)
							Call SalClearField(dfNamB)
							Call SalClearField(dfOkpoB)
						Set dfNlsB=SalStrTrimX(dfNlsB)
						If wParam = SalWindowHandleToNumber(pbHelp)
							Return VALIDATE_OkClearFlag
						If SalIsNull(hWndItem) and not frmInputAdrDocSber.bTotVal
							Return VALIDATE_OkClearFlag
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotNumB'),
									                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation)
							Return VALIDATE_Cancel
						If not SalIsNull(dfBankB)
							If dfNlsB != KeyAccount(dfBankB, dfNlsB)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('DocWMesErrNlsCrcB'),
										                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation)
								Return VALIDATE_Cancel
						If frmInputAdrDocSber.nKvB and not frmInputAdrDocSber.bTotVal
							If dfBankB = dfBankA
								! If nDk=0 or nDk=2
									                                                           Set sTmp='D'
								! Else If nDk=1 or nDk=3
									                                                           Set sTmp='K'
								! Else
									                                                           Set sTmp=''
								! Call SqlPrepareAndExecute(hSql(),T(
										"SELECT s.nms,NVL(TRIM(k.nmkk),TRIM(k.nmk)),k.okpo, k.country 
										  INTO :sNamBStored1,:sNamBStored2,:dfOkpoB, :nTmpCountry 
										  FROM saldo"|| sTmp ||" s,customer k,cust_acc a 
										  WHERE nls = :dfNlsB AND kv = :nKvB AND a.rnk=k.rnk AND s.acc=a.acc AND s.dazs IS NULL" ))
								! If SqlFetchNext( hSql(), nFetchRes )
									                                                           Set sNamBStored1=SalStrTrimX(sNamBStored1)
									                                                           Set sNamBStored2=SalStrTrimX(sNamBStored2)
									                                                           If sKlF   !! Уточнение ОКПО по признаку б/с
										                                                           Call OKPOamnd(dfNlsB,dfOkpoB)
									                                                           If NOT dfOkpoB
										! ОКПО нерезидентов
										                                                           If GetBankCountryCode()!=nTmpCountry
											                                                           Set dfOkpoB=SalNumberToStrX( nTmpCountry, 0 )
										! Недорегистрированные клиенты
										                                                           Else 
											                                                           Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrOkpoNlsB')||' '||dfKvB||"-"||dfNlsB ,
													                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
											                                                           Return VALIDATE_Cancel
									                                                           If not SalStrTrimX(dfNamB)
										                                                           If nFli = 1  ! Если межбанк СЭП то клиента
											                                                           Set dfNamB=sNamBStored2
										                                                           Else ! Иначе - Наименован Счета
											                                                           Set dfNamB=sNamBStored1
								! Else
									                                                           Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotFound')||' '||dfKvB||"-"||dfNlsB,
											                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
									                                                           Set hWnd4Focus=hWndItem
									                                                           Return VALIDATE_Cancel
							Else
								Call SqlPrepareAndExecute(hSql(), T(
										"SELECT name,okpo INTO :dfNamB,:dfOkpoB FROM alien WHERE mfo=:dfBankB AND nls=:dfNlsB and kv=:nKvB"))
								If not SqlFetchNext(hSql(), nFetchRes)
									Set dfNamB  = ''
									Set dfOkpoB = ''
						If frmInputAdrDocSber.bFixNlsB 
							Set frmInputAdrDocSber.sFixNlsB = dfNlsB
						Return VALIDATE_OkClearFlag
			Data Field: dfPolu
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamB
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoB
				Class Child Ref Key: 140
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNA
				Class Child Ref Key: 135
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumA
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNB
				Class Child Ref Key: 122
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumB
				Class Child Ref Key: 21
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNomN
				Class Child Ref Key: 123
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNom
				Class Child Ref Key: 57
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNC
				Class Child Ref Key: 125
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumC
				Class Child Ref Key: 44
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquivN
				Class Child Ref Key: 144
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquiv
				Class Child Ref Key: 145
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			List Box: lb1
				Class Child Ref Key: 85
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
			Multiline Field: dfNazn
				Class Child Ref Key: 24
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					String Type: Class Default
					Editable? Class Default
				Display Settings
					Border? Class Default
					Word Wrap? Class Default
					Vertical Scroll? Class Default
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Message Actions
			Data Field: dfSkN
				Class Child Ref Key: 115
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 48
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD1N
				Class Child Ref Key: 116
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2N
				Class Child Ref Key: 131
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2
				Class Child Ref Key: 66
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfD
				Class Child Ref Key: 132
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfK
				Class Child Ref Key: 133
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Frame
				Resource Id: 48206
				Class Child Ref Key: 10
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Frame
				Resource Id: 48207
				Class Child Ref Key: 45
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Frame
				Resource Id: 48208
				Class Child Ref Key: 88
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Border Color: Class Default
				Background Color: Class Default
			Data Field: dfLocDat
				Class Child Ref Key: 149
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbUgrnt
				Class Child Ref Key: 130
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfVytyagN
				Class Child Ref Key: 142
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			Number: bAcc
		Message Actions
			On UM_Choose
				Set dDat = GetBankDate()
				Call Pl_dat(dDat)
				If not bDocStart
					Set bDocStart=TRUE
					Set bFixAll=FALSE
					Set bFixNlsA=FALSE
					Set bFixKvA=FALSE
					Set bFixKvB=FALSE
					Set bFixNlsB=FALSE
					Set bFixMfoB=FALSE
					Set bFixDocD=FALSE
					Set bFixValD1=FALSE
					Set sFixKvA=STRING_Null
					Set sFixNlsA=STRING_Null
					Set sFixKvB=STRING_Null
					Set sFixNlsB=STRING_Null
					Set sFixMfoB=STRING_Null
					Set dFixDocD=DATETIME_Null
					Set dFixValD1=DATETIME_Null
					Set nFixVob=NUMBER_Null
					If not SalModalDialog(dlgDocStartSber,hWndForm,sTT,sTTN,nFpy,nFvD1,nFvD2,nFtr,nFbk,nFli,nFlv,nDk,nKvA_TT,nKvB_TT,sNlsA_TT,sNlsB_TT,sBankB_TT,nSk_TT,nFcb,nFpr,nFdp,nFug,nFeq,nFdd,nFsk,nFhr,sS,sSS)
						Call SalDestroyWindow(hWndForm)
						Return TRUE
					Set sNlsA_TT = NlsSubst(sNlsA_TT)
					Set sNlsB_TT = NlsSubst(sNlsB_TT)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DocWTit')||' - [ ' ||sTTN|| ' ]' )
				Call SalSendMsg(hWndForm, UM_Clear, 0, 0)
			On UM_HotAccountList
				Set bAcc = FALSE
				If bAccB = 1
					If (nDk = 1 or nDk = 3) and bAccB = 1
						Set bAcc  = bAccB
						Set bAccB = 0
				Call SalSendClassMessage(UM_HotAccountList, 0, 0)
				If bAcc
					Set bAccB = bAcc
					Set sNls  = dfNlsB
					Set nKv   = nKvB
					Set sNls  = dfNlsB
					Set sNms  = dfNamB
					Set sOkpo = dfOkpoB
					Set sMfo  = dfBankB
					If SalModalDialog(dlgAlien, hWndForm, bAccB, nKv, sLcv, sNls, sOkpo, sNms, sMfo, sNb)
						Set dfNlsB  = sNls
						Set dfNamB  = sNms
						Set dfBankB = sMfo
						Set dfNbB   = sNb
						Set nKvB    = nKv
						Set dfKvB   = sLcv
						Set dfOkpoB = sOkpo
						Call SalSendMsg(dfKvB, SAM_Validate, 0, 0)
						Call SalSetFocus(dfNlsB)
	Dialog Box: dlgDocStartSber    ! Выбор операции
		Class:
		Property Template:
		Class DLL Name:
		Title: Банковская операция
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left:   1.638"
				Top:    0.427"
				Width:  7.183"
				Width Editable? Yes
				Height: 5.488"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: System Window Color
		Description: (OK) Выбор банковской транзакции перед вводом документа
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? No
				Size: 0.031"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblTrans
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.08"
						Top:    0.106"
						Width:  6.9"
						Width Editable? Yes
						Height: 4.31"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: System Window Color
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 200
					Discardable? No
				Contents
					Column: colTT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.68"
						Width Editable? Yes
						Format: Uppercase
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFli
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: # Макета
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFlv
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Мульти
								валюта
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFlags
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Флаги операции
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Д/К
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.586"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKvA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Валюта
								А
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKvB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Валюта
								Б
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет А
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет Б
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colMfoB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: МФО Б
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Символ 
								касплана
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTTN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Формула
								Суми
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Формула
								Суми
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nId
					String: strSecure
					Boolean: bSortOrd
					Number: nColHan
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags( hWndItem, TBL_Flag_SingleSelection, TRUE )
					On UM_Populate
						Call SalWaitCursor( TRUE )
						Set nId=GetUserId()
						Set strSecure = ''
						If EnhancedSecurity(  )
							Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
						Call SalTblPopulate(hWndItem, hSql(), T( 
								"SELECT DISTINCT t.tt,t.name,t.fli,t.flv,t.dk,t.kv,t.kvk,t.nlsa,t.nlsb,t.mfob,t.sk,t.flags,TRIM(t.s),TRIM(t.s2)
								   INTO :colTT,:colTTN,:colFli,:colFlv,:colDk,
								        :colKvA,:colKvB,:colNlsA,:colNlsB,:colMfoB,:colSk,:colFlags,:colS,:colSS
								   FROM tts t, staff_tts s 
								  WHERE s.tt=t.tt AND s.id IN (" || GetSubstListId(nId, TRUE) || ") 
								    AND t.fli<3 AND flags[1,1]=1 " || strSecure || "
								    AND t.tt like 'АД%'
								  ORDER BY 2") , TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_DoubleClick
						If NOT colTT
							Call SalEndDialog(dlgDocStartSber, FALSE)
						Set sTT=colTT
						Set sTTN=colTTN
						Set nFpy=SalStrToNumber(SalStrMidX(colFlags,37,1))
						Set nFvD1=SalStrToNumber(SalStrMidX(colFlags,3,1))
						Set nFvD2=SalStrToNumber(SalStrMidX(colFlags,49,1))
						Set nFcb=SalStrToNumber(SalStrMidX(colFlags,58,1))
						Set nFtr=SalStrToNumber(SalStrMidX(colFlags,59,1))
						Set nFbk=SalStrToNumber(SalStrMidX(colFlags,60,1))
						Set nFpr=SalStrToNumber(SalStrMidX(colFlags,46,1))
						Set nFdp=SalStrToNumber(SalStrMidX(colFlags,35,1))
						Set nFug=SalStrToNumber(SalStrMidX(colFlags,12,1))
						Set nFeq=SalStrToNumber(SalStrMidX(colFlags,14,1))
						Set nFdd=SalStrToNumber(SalStrMidX(colFlags,4,1))
						Set nFsk=SalStrToNumber(SalStrMidX(colFlags,9,1))
						Set nFhr=SalStrToNumber(SalStrMidX(colFlags,11,1))
						Set nFli=colFli
						Set nFlv=colFlv
						Set nKvA=colKvA
						Set nKvB=colKvB
						Set sNlsA=SalStrTrimX(colNlsA)
						Set sNlsB=SalStrTrimX(colNlsB)
						Set sMfoB=colMfoB
						Set nSk=colSk
						Set sS=colS
						Set sSS=colSS
						If nFsk = 0
							Set nSk=NUMBER_Null
						Else
							If colSk=NUMBER_Null
								Set nSk=0
						Set nDk=colDk
						If SalIsNull(colDk)
							Set nDk=1
						Call SalEndDialog(dlgDocStartSber, TRUE)
					On SAM_FetchRowDone
						If SalStrMidX(colFlags,37,1)='0'
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen) ! серый
						! Else
							                                                                                       Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_IndexWindow) 
					On SAM_CaptionDoubleClick
						If wParam=nColHan
							Set bSortOrd = not bSortOrd
						Else
							Set bSortOrd=1
							Set nColHan=wParam
						Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.533"
					Top:    4.56"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.329"
					Top:    4.56"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(tblTrans, SAM_DoubleClick, 0, 0)
			Frame
				Resource Id: 48214
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    4.5"
					Width:  6.9"
					Width Editable? Yes
					Height: 0.571"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
		Functions
			! Function: NlsSubst
				                                                                      Description: 
				                                                                      Returns 
					                                                                      String: 
				                                                                      Parameters 
					                                                                      String: Nls
				                                                                      Static Variables 
				                                                                      Local variables 
					                                                                      String: sTmp
				                                                                      Actions 
					                                                                      If SalStrLeftX(Nls,2)='#('
						                                                                      Call SqlPrepareAndExecute( hSql(), "SELECT SUBSTR("||SalStrMidX(Nls,2,SalStrLength(Nls)-3)||",1,14) INTO :sTmp FROM dual" )
						                                                                      If SqlFetchNext( hSql(), nFetchRes )
							                                                                      Return sTmp
					                                                                      Return Nls
		Window Parameters
			Receive String: sTT
			Receive String: sTTN
			Receive Number: nFpy
			Receive Number: nFvD1
			Receive Number: nFvD2
			Receive Number: nFtr
			Receive Number: nFbk
			Receive Number: nFli
			Receive Number: nFlv
			Receive Number: nDk
			Receive Number: nKvA
			Receive Number: nKvB
			Receive String: sNlsA
			Receive String: sNlsB
			Receive String: sMfoB
			Receive Number: nSk
			Receive Number: nFcb
			Receive Number: nFpr
			Receive Number: nFdp
			Receive Number: nFug
			Receive Number: nFeq        ! признак ввода эквивалента
			Receive Number: nFdd        ! признак даты документа по-умолчанию
			Receive Number: nFsk        ! признак кассовой операции
			Receive Number: nFhr        ! признак закрытия поля "курс"
			Receive String: sS          ! формула суммы
			Receive String: sSS         ! формула суммы 2
		Window Variables
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgDocStart.cTWndTitle'))
				Call SalMapEnterToTab( FALSE )
			On SAM_CreateComplete
				Call SalSendMsg( tblTrans, UM_Populate, 0, 0 )
			On SAM_Destroy
				Call SalMapEnterToTab( TRUE )
	Form Window: dlgCardManageAd
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Yes
			Window Location and Size
				Left:   1.925"
				Top:    1.604"
				Width:  14.4"
				Width Editable? Class Default
				Height: 6.071"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalTblPopulate(tblClients, hSql(), sSql, TBL_FillAll)
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28722
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28723
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28724
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Background Text: ФИО клиента:
				Resource Id: 28725
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    0.226"
					Width:  1.817"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfFIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 70
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.2"
						Top:    0.19"
						Width:  9.2"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 10
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Child Table: tblClients
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.05"
						Top:    0.679"
						Width:  14.0"
						Width Editable? Class Default
						Height: 4.143"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? No
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? Class Default
				Contents
					Column: cRNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: РНК
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cNMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ФИО
						Visible? Yes
						Editable? No
						Maximum Data Length: 70
						Data Type: String
						Justify: Left
						Width:  4.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTOBO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код подразд.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTOBONAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Подразделение
						Visible? Yes
						Editable? No
						Maximum Data Length: 70
						Data Type: String
						Justify: Left
						Width:  2.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCardId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCardAcsId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № карты в АКС
						Visible? Yes
						Editable? No
						Maximum Data Length: 24
						Data Type: Number
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCardType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
								карти
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Center
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					! Number: nCARD_ID
					! Number: nSTATUS
					! Date/Time: dISSUER_DATE
					! Date/Time: dEXPIRE_DATE
					Number: nSTOP_STATUS
				Message Actions
					On SAM_Create
						! выбираем ровно одного клиента
						Call SalTblSetTableFlags(hWndItem, TBL_Flag_SuppressLastColLine|TBL_Flag_SingleSelection, TRUE)
					On SAM_DoubleClick
						Set nResult = 0
						Call SalModalDialog(dlgCardManageAdd, hWndMDI, 
								                    hWndForm.tblClients.cCardId, 
								                    hWndForm.tblClients.cRNK, 
								                    hWndForm.tblClients.cNMK,
								                    1, 
								                    nStatus)
						If nStatus = 69 OR 
								  (nStatus = 0  AND 
								    SalMessageBox('Неверно указана ключевая фраза клиента!'||PutCrLf()||'Продолжить поиск?', 
								                  'Внимание', 
								                  MB_IconQuestion|MB_YesNo) = IDYES
								   )
							Call SalModalDialog(dlgCardManageAdd, hWndMDI, 
									                    hWndForm.tblClients.cCardId, 
									                    hWndForm.tblClients.cRNK, 
									                    hWndForm.tblClients.cNMK,
									                    2, 
									                    nStatus)
							If nStatus = 69 OR 
									  (nStatus = 0  AND 
									 SalMessageBox (
									   'Неверно указаны серия и номер паспорта клиента!'||PutCrLf()||'Продолжить поиск?', 
									   'Внимание', 
									   MB_IconQuestion|MB_YesNo) = IDYES
									  )
								Call SalModalDialog(dlgCardManageAdd, hWndMDI, 
										                    hWndForm.tblClients.cCardId, 
										                    hWndForm.tblClients.cRNK, 
										                    hWndForm.tblClients.cNMK,
										                    3, 
										                    nStatus)
								If nStatus = 69 OR nStatus = 0
									Call SalMessageBox('Поиск прекращается!', 'Внимание', MB_IconStop)
								Else If nStatus = 3
									! полное совпадение адреса и даты рождения
									Set nResult = 99
								Else
									! ошиблись дверью
							Else If nStatus = 2
								! полное совпадение № и серии паспорта
								Set nResult = 99
							Else
								! ошиблись дверью
						Else If nStatus = 1
							! полное совпадение ключ.фразы
							Set nResult = 99
						Else
							! ошиблись дверью
						!
						If nResult = 99
							! Не передаем избыточную инфрмацию о клиенте и его карточке в dlgCardDetails
							If SqlPrepareAndExecute(hSql(), 
									   "SELECT stop_status 
									      INTO :nSTOP_STATUS 
									      FROM nn_card_manage
									     WHERE id = :hWndForm.tblClients.cCardId") 
									AND SqlFetchNext(hSql(), nFetchRes)
								Call SalModalDialog(dlgCardDetails, hWndMDI, 
										                    2,
										                    hWndForm.tblClients.cCardId,
										                    hWndForm.tblClients.cCardAcsId,
										                    hWndForm.tblClients.cRNK,
										                    hWndForm.tblClients.cNMK,
										                    NUMBER_Null,
										                    DATETIME_Null,
										                    DATETIME_Null,
										                    hWndForm.tblClients.nSTOP_STATUS)
							! If SqlPrepareAndExecute(hSql(), 
									  "SELECT id, status, issuer_date, expire_date, stop_status
									     INTO :nCARD_ID,:nSTATUS,:dISSUER_DATE,:dEXPIRE_DATE,:nSTOP_STATUS 
									     FROM nn_card_manage
									    WHERE rnk = :hWndForm.tblClients.cRNK") AND
									   SqlFetchNext(hSql(), nFetchRes)
								                                               Call SalModalDialog(dlgCardDetails, hWndMDI, 
										                      1,
										                      hWndForm.tblClients.nCARD_ID,
										                      hWndForm.tblClients.cRNK,
										                      hWndForm.tblClients.cNMK,
										                      hWndForm.tblClients.nSTATUS,
										                      hWndForm.tblClients.dISSUER_DATE,
										                      hWndForm.tblClients.dEXPIRE_DATE,
										                      hWndForm.tblClients.nSTOP_STATUS )
			Pushbutton: pbFind
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbSearch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.75"
					Top:    0.107"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalIsNull(dfFIO)
							Call SalMessageBox('Введите ФИО!', 'Внимание', MB_IconExclamation)
						Else
							Set sSql = 
									   "SELECT c.rnk, c.nmk, t.tobo, t.name, n.id, n.acs_id, n.cardtype_id
									      INTO :cRNK, :cNMK, :cTOBO, :cTOBONAME, :cCardId, :cCardAcsId, :cCardType
									      FROM customer c, tobo t, nn_card n
									     WHERE c.tobo = t.tobo 
									       AND c.rnk  = n.rnk 
									       AND upper(c.nmk) LIKE '%"||SalStrUpperX(StrMatches2Like(dfFIO))||"%'
									       AND not exists (select 1 from nn_card where card_replaced = n.id)  
									     ORDER BY nmk, tobo"
							Call SalTblPopulate(tblClients, hSql(), sSql, TBL_FillAll)
							Call SalWaitCursor(FALSE)
							Call SalTblSetContext(tblClients, 0)
			Frame
				Resource Id: 28726
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.036"
					Width:  13.333"
					Width Editable? Yes
					Height: 0.595"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			String: sSql
			String: sFilter
			Number: nStatus
			Number: nResult
			Number: nFetchRes
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 
						                     "Управление состоянием карт c расширенным поиском клиента")
				Call SalCenterWindow( hWndForm )
				Call SalDisableWindow( pbIns )
				Call SalDisableWindow( pbDel )
				Call SalDisableWindow( pbUpdate )
				Call SalDisableWindow( pbFilter )
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: frmLoadLimits
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  15.417"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_CheckLimits()
				Line
					Resource Id: 16083
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд виписки по рахунку'
						On SAM_Click
							If frmLoadLimits.colACC > 0 
								Call Show_Sal_Day_P(frmLoadLimits.colACC, 
										                    frmLoadLimits.colNLS, 
										                    frmLoadLimits.colKV, 
										                    AddMonths(SalDateCurrent(),-1), 
										                    SalDateCurrent())
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16084
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16085
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colTOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						тер.
						управл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реэстр.
						№ 
						клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прізвище, 
						ім'я та по-батькові 
						клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colINS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						інсай-
						дера
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
						на 
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLimId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід.
						ліміту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLimNum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер
						ліміту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPLANLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						ліміту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colACSLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						ліміту
						в АКС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDELTA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Різниця
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFLAG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вирівняти
						ліміти
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If colLimInvalidated
							Set colFLAG = 0
			Column: colLimInvalidated
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLimState
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Стан
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLimError
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Помилка
				Visible? Yes
				Editable? No
				Maximum Data Length: 150
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_CheckLimits
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
				Actions
					Call SalWaitCursor(TRUE)
					If SalMessageBox('Сформувати запити на вирівнювання лімітів по вказаних рахунках завантаження?', 
							   'Увага!', MB_IconAsterisk|MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If frmLoadLimits.colFLAG = 1 and frmLoadLimits.colLimInvalidated = 0
								If SqlPLSQLCommand(hSql(), "bars_nnacs.set_limit_flag(colLimId, 2)")
									Call SqlCommitEx(hSql(), "NN. Сформовано запит на вирівнювання лімітів залишків МВО і АКС " ||
											     "по по рахунку завантаження " || frmLoadLimits.colNLS)
								Else
									Call SqlRollbackEx(hSql(), "NN. Помилка формування запиту на вирівнювання лімітів залишків МВО і АКС " ||
											     "по по рахунку завантаження " || frmLoadLimits.colNLS)
					Call SalWaitCursor(FALSE)
					Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, "Вирівнювання лімітів залишків по рахунках завантаження МВО і АКС")
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				!
				Set hWndForm.frmLoadLimits.nFlags = GT_NoIns|GT_NoDel
				Set hWndForm.frmLoadLimits.fFilterAtStart = TRUE
				Set hWndForm.frmLoadLimits.nTabInstance = TRUE
				Set hWndForm.frmLoadLimits.strFilterTblName = "v_nnlimits"
				Set hWndForm.frmLoadLimits.strPrintFileName = "LoadLimits"
				!
				Set hWndForm.frmLoadLimits.strSqlPopulate =
						"select tobo, cust_id, cust_name, cust_insider, 
						        acc_id, acc_num, curr_code, acc_rest, 
						        lim_id, lim_num, lim_value, lim_value_acs, lim_delta, 
						        decode(lim_invalidated,'Y',1,0), lim_state, lim_error, 0
						   into :hWndForm.frmLoadLimits.colTOBO,   :hWndForm.frmLoadLimits.colRNK,    
						        :hWndForm.frmLoadLimits.colNMK,    :hWndForm.frmLoadLimits.colINS,   
						        :hWndForm.frmLoadLimits.colACC,    :hWndForm.frmLoadLimits.colNLS,     
						        :hWndForm.frmLoadLimits.colKV,     :hWndForm.frmLoadLimits.colOSTC,   
						        :hWndForm.frmLoadLimits.colLimId,  :hWndForm.frmLoadLimits.colLimNum, :hWndForm.frmLoadLimits.colPLANLIM,
						        :hWndForm.frmLoadLimits.colACSLIM, :hWndForm.frmLoadLimits.colDELTA,   
						        :hWndForm.frmLoadLimits.colLimInvalidated, :hWndForm.frmLoadLimits.colLimState, , :hWndForm.frmLoadLimits.colLimError,
						        :hWndForm.frmLoadLimits.colFLAG
						   from v_nnlimits 
						  order by tobo, cust_id"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If colLimInvalidated
					Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
	Dialog Box: dlg_MBOSetSk
		Class:
		Property Template:
		Class DLL Name:
		Title: Виберіть сивол касплану
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.1"
				Width Editable? Yes
				Height: 3.4"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.1"
					Width:  6.6"
					Width Editable? Yes
					Height: 2.0"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.4"
						Top:    0.3"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfSk != NUMBER_Null
							Call SqlPrepareAndExecute(hSql(), 
									"select sk
									   into :nTmpSk
									   from sk
									  where sk=:dfSk
									    and sk" || IifS(nDk=0 or nDk=2,"<",">=") || "40
									    and (d_close is null or d_close>bankdate) ")
							If not SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox('Невірний символ касплану!', 'Увага!', MB_Ok | MB_IconExclamation)
								Set dfSk = nSk
								Call cmbSk.SetSelectById(dfSk)
								Return VALIDATE_Cancel
						Else
							Set dfSk = nSk
						Call cmbSk.SetSelectById(dfSk)
						Return VALIDATE_Ok
			Combo Box: cmbSk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.3"
					Top:    0.3"
					Width:  5.2"
					Width Editable? Class Default
					Height: 3.357"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbSk.Init(hWndItem)
						Call cmbSk.Populate(hSql(), "sk", "name", "sk", 
								"where sk" || IifS(nDk=0 or nDk=2,"<",">=") || "40 and (d_close is null or d_close>bankdate) order by sk")
						Call cmbSk.SetSelectById(nSk)
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set dfSk = cmbSk.nCurrentId
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    2.2"
					Width:  6.6"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Застосувати
				Window Location and Size
					Left:   0.4"
					Top:    2.35"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If dfSk != NUMBER_Null
							Set nSk = dfSk
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCankel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Відмінити
				Window Location and Size
					Left:   5.3"
					Top:    2.35"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Number: nDk
			Receive Number: nSk
		Window Variables
			Number: nTmpSk
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Set dfSk = nSk
				Call SalSetFocus(pbOk)
