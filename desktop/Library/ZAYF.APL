Application Description:
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000FA0000 002C000000020000 0003000000000000 00AB010000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F777309646C
0080: 675A41595F4452
.enddata
.data DT_MAKERUNDLG
0000: 020000000016713A 5C6261727339385C 62696E5C50425F31 2E61706418713A5C
0020: 6261727339385C62 696E5C6E65776170 702E646C6C18713A 5C6261727339385C
0040: 62696E5C6E657761 70702E6170630000 01010115433A5C43 454E545552415C6E
0060: 65776170702E7275 6E15433A5C43454E 545552415C6E6577 6170702E646C6C15
0080: 433A5C43454E5455 52415C6E65776170 702E617063000001 010116643A5C6261
00A0: 727339385C62696E 5C7A6179662E6170 6418643A5C626172 7339385C62696E5C
00C0: 6E65776170702E64 6C6C18643A5C6261 727339385C62696E 5C6E65776170702E
00E0: 6170630000010101 15433A5C43454E54 5552415C6E657761 70702E61706C1543
0100: 3A5C43454E545552 415C6E6577617070 2E646C6C15433A5C 43454E545552415C
0120: 6E65776170702E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? Yes
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: GENTBLD.APL
		File Include: GENTBLS.APL
		File Include: Winapi.apl
		File Include: Genlist.apl
		! File Include: GenEMnu.apl
		File Include: Winbars2.apl
		File Include: qckdvc.apl
		File Include: XSALIMG.APL
		File Include: DOCFUN6.APL
		File Include: Xsalcpt.apl
		!
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: otcn.apd
		Dynalib: Custacnt.apd
		Dynalib: NSIAPI.APD
		Dynalib: Docview.apd
		Dynalib: MsOffice.apd
		File Include: Xsalspl.apl
		File Include: Gentimer.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: Arial Cyr
				Font Size: 8
				Font Enhancement: Bold
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Arial Cyr
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd-MM-yyyy
			Number: #00000
			Number: 0000
			Number: #0000
			Number: 00000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: sLibVersion = 'від 23.12.2016'
		Resources
		Variables
.data RESOURCE 0 0 1 958896251
0000: 1E00000011000000 0000000000000000 02000001000000B7 000000E0010D0000
0020: 00FF3F
.enddata
			Sql Handle: hSqlTmp1
			Sql Handle: hSqlTmp2
			Sql Handle: hSqlTmp3
			Number: nFetchRes
			Window Handle: hWnd3
			Window Handle: hWnd4
			Window Handle: hWnd5
			Window Handle: hWnd6
			Window Handle: hWndOP
			Window Handle: hWndSS
			Window Handle: hWndS1
			Window Handle: hWndSD
			Window Handle: hWndV1
			Window Handle: hWndV2
			Window Handle: hWndV3
			Window Handle: hWndV4
			Window Handle: hWndV5
			Window Handle: hWndV8
		Internal Functions
			Function: ZAYf       !__exported
				Description:
				Returns
					Window Handle:
				Parameters
					Window Handle: hW
					Number: z
				Static Variables
				Local variables
				Actions
					If z = 33     !! Визирование заявок (общее) 
						If not IsWindow(hWndSS)
							Set hWndSS = SalCreateWindow(ZAYV, hWndMDI)
						Else
							Call SalBringWindowToTop ( ZAYV )
					If z = 3321   !! Визирование заявок (покупка аналог общее) 
						If not IsWindow(hWndV4)
							Set hWndV4 = SalCreateWindow(ZAYV_BUY, hWndMDI)
						Else
							Call SalBringWindowToTop ( hWndV4 )
					If z = 3322   !! Визирование заявок (продажа аналог общее) 
						If not IsWindow(hWndV5)
							Set hWndV5 = SalCreateWindow(ZAYV_SAL, hWndMDI)
						Else
							Call SalBringWindowToTop(hWndV5)
					If z = 331    !! Визирование заявок (покупка)
						If not IsWindow(hWndV1)
							Set hWndV1 = SalCreateWindow(ZAYVm, hWndMDI, 1)
						Else
							Call SalBringWindowToTop ( ZAYVm )
					If z = 332    !! Визирование заявок (продажа)
						If not IsWindow(hWndV2)
							Set hWndV2 = SalCreateWindow(ZAYVm, hWndMDI, 2)
						Else
							Call SalBringWindowToTop ( ZAYVm )
					If z = 333    !! Визирование заявок (покупка на погашение кредита)
						If not IsWindow(hWndV3)
							Set hWndV3 = SalCreateWindow(ZAYVm, hWndMDI, 3)
						Else
							Call SalBringWindowToTop ( ZAYVm )
					If z = 34     !! Обязат.продажа
						If not IsWindow(hWndOP)
							Set hWndOP = SalCreateWindow(ZAY_DEBT, hWndMDI)
						Else
							Call SalBringWindowToTop ( ZAY_DEBT )
					If z = 38     !! Розщеплення надходжень валютної виручки (ZAY_SPLIT_AMNT)
						If not IsWindow( hWndV8 )
							Set hWndV8 = SalCreateWindow( ZAY_SPLIT_AMNT, hWndMDI )
						Else
							Call SalBringWindowToTop ( ZAY_SPLIT_AMNT )
					If z = 35     !! Удовлетворение заявок 
						If not IsWindow(hWnd4)
							Set hWnd4 = SalCreateWindow(ZAY4, hWndMDI)
						Else
							Call SalBringWindowToTop (ZAY4)
					If z = 36     !! Визирование обязат.заявок
						If not IsWindow(hWnd5)
							Set hWnd5 = SalCreateWindow(ZAY5, hWndMDI)
						Else
							Call SalBringWindowToTop ( ZAY5 )
					If z = 37     !! Визирование отметок Дилера
						If not IsWindow(hWnd6)
							Set hWnd6 = SalCreateWindow(ZAYK, hWndMDI)
						Else
							Call SalBringWindowToTop ( ZAYK )
					If z = 500    !! Кросс курсы
						If not IsWindow(hWndSS)
							Set hWndSS = SalCreateWindow(KROSS, hWndMDI)
						Else
							Call SalBringWindowToTop ( KROSS )
					If z = 999    !! Сторно и реанимация заявок
						Call SalModalDialog(dlgZAYKillOrRecover, hWndNULL)
			Function: ZayFEx     !__exported
				Description:
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nPar1
					Number: nPar2
					String: sPar3
					String: sPar4
				Static Variables
				Local variables
				Actions
					! Select Case nPar1
						                                                                                                                                                               Case 0 !! Контракты + ТД + Платежи (ЭКСП)
							                                                                                                                                                               If IsWindow(hWndEIK)
								                                                                                                                                                               Call SalBringWindowToTop( hWndEIK )
							                                                                                                                                                               Else
								                                                                                                                                                               Set hWndEIK = SalCreateWindow(EIK, hWndParent, nMode, nPar, strPar01, strPar02)
							                                                                                                                                                               Break
			Function: BKL_KV
				Description: Проверка на заблокированность валюты
				Returns
					Boolean:
				Parameters
					Number: nKV
				Static Variables
				Local variables
					Number: nBLK
					Number: nFetchRes
				Actions
					If SqlPrepareAndExecute( hSql(),
							  "SELECT nvl(blk,0) 
							     INTO :nBLK
							     FROM diler_kurs
							    WHERE kv = :nKV 
							      AND dat = (SELECT max(dat) 
							                   FROM diler_kurs
							                  WHERE trunc(dat) = trunc(sysdate) 
							                    AND kv = :nKV)")
						Call SqlFetchNext( hSql(), nFetchRes )
						If nBLK = 1
							Call SalMessageBox('Данная валюта заблокирована!', 'Внимание', MB_IconExclamation)
							Return FALSE
						Else
							Return TRUE
					Return TRUE
			Function: GetDilerRate
				Description: Расчет предварительного курса дилера 
				Returns
					Number:
				Parameters
					Number: nDK
					Number: nCUR
					Number: nKV2
				Static Variables
				Local variables
					Number: nFetchRes
					Number: nBuyRate
					Number: nSellRate
				Actions
					Set nBuyRate  = NUMBER_Null
					Set nSellRate = NUMBER_Null
					! покупка/продажа валюты 
					If nDK = 1 or nDK = 2
						If SqlPrepareAndExecute(hSql(),
								  "SELECT kurs_b, kurs_s 
								     INTO :nBuyRate, :nSellRate
								     FROM diler_kurs
								    WHERE kv = :nCUR 
								      AND dat = (SELECT max(dat) 
								                   FROM diler_kurs
								                  WHERE trunc(dat) = trunc(sysdate) 
								                    AND kv = :nCUR)")
								and not SqlFetchNext(hSql(), nFetchRes)
							Set nBuyRate = NUMBER_Null
							Set nSellRate = NUMBER_Null
						! покупка валюты 
						If nDK = 1
							Return nBuyRate
						! продажа валюты 
						Else If nDK = 2
							Return nSellRate
					! конверсия
					Else If nDK = 3 or nDK = 4
						If GetValueStr("select nvl(max(val),0) from birja where par = 'CONVKURS'") = '1'
							If SqlPrepareAndExecute(hSql(), 
									"select kurs_i into :nBuyRate
									   From diler_kurs_conv
									  where (kv1 = :nCUR and kv2 = :nKV2
									      or kv2 = :nCUR and kv1 = :nKV2)
									    and dat = trunc(bankdate)")
								If not SqlFetchNext(hSql(), nFetchRes)
									Set nBuyRate = NUMBER_Null
						Return nBuyRate
					! фигня на постном масле
					Else
						Return NUMBER_Null
			Function: BIRZA    !! Чтение конфигур.параметров для биржевых заявок
				Description:
				Returns
					Boolean: ret
				Parameters
					String: sPar
					Receive Number: nVal
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							  "SELECT to_number(val) INTO :nVal FROM birja WHERE par=:sPar " )
							 and not SqlFetchNext( hSql(), nFetchRes )
						If sPar != 'PRNT_BUY' AND
								   sPar != 'PRNT_SAL' AND
								   sPar != 'PRNT_OBZ' AND
								   sPar != 'RESERV'   AND
								   sPar != 'PF_CUST'  AND
								   sPar != 'EIK_ND'
							Call SalMessageBox('Параметр '|| sPar ||' не установлен! ',
									  'Внимание!', MB_IconAsterisk )
						Else
							Set nVal=-1
					Return TRUE
			Function: BackRequest
				Description:
				Returns
					Boolean:
				Parameters
					Number: nMode
					Number: nFlag
					Number: nID
					Number: nRnk
					String: sNmk
					String: sS
					String: sKv
				Static Variables
				Local variables
					String: sStornoReasonId
					String: sStornoReason
					Number: nStornoReasonId
				Actions
					If SalMessageBox('Вы уверены, что хотите возвратить заявку клиента ' || sNmk ||
							   IifS(nFlag=1, ' на покупку ', ' на продажу ') || sS || '/' || sKv || '?',
							   'Сторно заявок', MB_IconQuestion | MB_YesNo) = IDYES
						Set sStornoReasonId = ''
						Set sStornoReason = ''
						If FunNSIGet('ZAY_BACK', '', sStornoReasonId, sStornoReason)
							If sStornoReasonId AND sStornoReason
								Set nStornoReasonId = Val(sStornoReasonId)
								If nStornoReasonId = 99
									If not SalModalDialog(dlg_Comments, hWndForm, sStornoReason)
										Call SalMessageBox('Не указан комментарий! Повторите операцию', 'Сторно заявок. Ошибка', MB_IconStop)
										Return FALSE
								Else
									Set sStornoReason = ''
								If SqlPLSQLCommand(hSql(), "bars_zay.back_request(nMode, nID, nStornoReasonId, sStornoReason)")
									Call SqlCommit(hSql())
									Call SaveInfoToLog("ZAY. Отказано в визе заявке № " || Str(nID) || " клиента " || Str(nRnk) ||
											     IifS(nFlag=1, ' на покупку ', ' на продажу ') || sS || '/' || sKv || ". Код причины - " || sStornoReasonId)
								Else
									Call SqlRollback(hSql())
									Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию',
											                   'Сторно заявок. Ошибка', 
											                    MB_IconStop)
							Else
								Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию',
										                   'Сторно заявок. Ошибка', 
										                    MB_IconStop)
						Else
							Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию',
									                    'Сторно документов. Ошибка', 
									                     MB_IconStop)
					Return TRUE
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbPrint
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cXSalHSplitter
		Application Actions
			On SAM_AppStartup
			! On SAM_SqlError
				! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
				!
				                                                                                                                                                                                                                                      Call ShowSqlError( wParam, lParam )
				!
				                                                                                                                                                                                                                                      Return FALSE
				!
				! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	Form Window: ZAY4
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000010000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Отметки дилера на сводных заявках покупки-продажи валюты
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.3"
				Top:    2.365"
				Width:  15.95"
				Width Editable? Class Default
				Height: 5.167"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.2"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.633"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5605
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.067"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call TableToText(tbl, 'Покупка валюты',' ', GetPrnDir() || '\\' || ZAY4.strPrintFileName, '')
							Call TableToText(tbl2, 'Продажа валюты',' ', '>'||GetPrnDir() || '\\' || ZAY4.strPrintFileName, '')
				Line
					Resource Id: 5606
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.067"
						Begin Y:  0.393"
						End X:  3.067"
						End Y:  -0.024"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.667"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5607
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  2.533"
						Begin Y:  0.452"
						End X:  2.533"
						End Y:  0.036"
					Visible? Yes
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Покупка
					Resource Id: 5608
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.383"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Arial Cyr
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				Background Text: Продажа
					Resource Id: 5609
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.45"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Arial Cyr
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Pushbutton: MyTimer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							If nTime>0
								Call MyTimer.Init( nTime, 0, FALSE )
						On UM_TimerFired
							! ОБНОВИТЬ 
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbEqv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.5"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Accounts.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '(не)Показывать эквиваленты'
						On SAM_Click
							If SalShowWindow( ZAY4.tbl.S980s )
								Call SalHideWindow( ZAY4.tbl.S980s )
							Else
								Call SalShowWindow( ZAY4.tbl.S980s )
							!
							If SalShowWindow( ZAY4.tbl2.S980s )
								Call SalHideWindow( ZAY4.tbl2.S980s )
							Else
								Call SalShowWindow( ZAY4.tbl2.S980s )
				Pushbutton: pbList
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.925"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать свода заявок"
						On SAM_Click
							Call F_Prn_List( )
		Contents
			Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   7.833"
						Top:    0.0"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  6.933"
						Width Editable? Class Default
						Height: 4.643"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Black
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIOR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S980s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ГРН Эквивалент
								суммы ПОКУПКИ
								(по курсу дилера)
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.767"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_F
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								дилера
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If Check_Kurs(KV1,KURS_F)
									Return VALIDATE_Ok
								Else
									Return VALIDATE_Cancel
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: О
								т
								м
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If SOS=0 
									Set nSOS=0
									Set VDATE=DATETIME_Null
									Set KURS_F=NUMBER_Null
								Else
									If nDIL_VIZA=1
										Set nSOS=0.5
									Else
										Set nSOS=1
									If VDATE=DATETIME_Null 
										If DAT<dDATA
											Set VDATE=dDATA
										Else
											Set VDATE=DAT
									If KURS_F=NUMBER_Null
										Set KURS_F=KURS_Z
									If Check_Kurs(KV1,KURS_F)
										Return VALIDATE_Ok
									Else
										Return VALIDATE_Cancel
					Column: VDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								валюти-
								рования
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If VDATE<dDATA or VDATE<DAT
									Return VALIDATE_Cancel
					Column: PR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Признак оплаты с ГОУ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						! 1
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAY4.tbl, nNextRow, ROW_Edited, 0)      
							Call SalTblSetContext(ZAY4.tbl, nNextRow)
							!
							If ZAY4.tbl.PR         = 0             AND 
									   ZAY4.tbl.PR        != ZAY4.tbl.SOS  AND 
									   ZAY4.tbl.KURS_F    != NUMBER_Null   AND 
									   ZAY4.tbl.VDATE     != DATETIME_Null   
								If SqlPrepareAndExecute(cMain.hSql(), 
										  "UPDATE zayavka 
										      SET sos    = :nSOS, 
										          kurs_f = :ZAY4.tbl.KURS_F, 
										          vdate  = :ZAY4.tbl.VDATE
										    WHERE sos     >= 0
										      AND sos      < 1  
										      AND dk       = 2 
										      AND s2       > 0
										      AND fdat     = :ZAY4.tbl.DAT 
										      AND kv2      = :ZAY4.tbl.KV1 
										      AND kurs_z   = :ZAY4.tbl.KURS_Z
										      AND priority = :ZAY4.tbl.PRIOR") 
									Call SqlCommit( cMain.hSql() )
									Call SaveInfoToLog("ZAY. Удовлетворен блок заявок на покупку "
											                 ||SalStrTrimX(ZAY4.tbl.S2s)
											                 ||" "    
											                 ||ZAY4.tbl.ISO
											                 ||" по курсу " 
											                 ||Str(ZAY4.tbl.KURS_F))
						! 2
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAY4.tbl2, nNextRow, ROW_Edited, 0)      
							Call SalTblSetContext(ZAY4.tbl2, nNextRow)
							!
							If ZAY4.tbl2.PR         = 0             AND 
									   ZAY4.tbl2.PR        != ZAY4.tbl2.SOS AND 
									   ZAY4.tbl2.KURS_F    != NUMBER_Null   AND 
									   ZAY4.tbl2.VDATE     != DATETIME_Null
								If SqlPrepareAndExecute(cMain.hSql(), 
										  "UPDATE zayavka 
										      SET sos    = :nSOS, 
										          kurs_f = :ZAY4.tbl2.KURS_F, 
										          vdate  = :ZAY4.tbl2.VDATE
										    WHERE sos     >= 0 
										      AND sos      < 1 
										      AND dk       = 1 
										      AND s2       > 0 
										      AND fdat     = :ZAY4.tbl2.DAT 
										      AND kv2      = :ZAY4.tbl2.KV1 
										      AND kurs_z   = :ZAY4.tbl2.KURS_Z
										      AND priority = :ZAY4.tbl2.PRIOR")
									Call SqlCommit( cMain.hSql() )
									Call SaveInfoToLog("ZAY. Удовлетворен блок заявок на продажу "
											                 ||SalStrTrimX(ZAY4.tbl2.S2s)
											                 ||" "
											                 ||ZAY4.tbl2.ISO
											                 ||" по курсу "
											                 ||Str(ZAY4.tbl2.KURS_F))
						!
						Call SalTblDefineSplitWindow(ZAY4.tbl, 0, FALSE)
						Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
						Call SalTblDefineSplitWindow(ZAY4.tbl2, 0, FALSE)
						Call SalPostMsg(ZAY4.tbl2, UM_Populate, 0, 0)
						!
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Set S2s = Dig4(S2/100, DIG, 4)
						If SalIsNull(SOS)
							Set SOS = 0
						Set PR = SOS
						If SalIsNull(DAT)
							Set DAT = dDATA
						If NOT SalIsNull(KURS_F)
							Set S980s = S2*KURS_F/100
						! Раскраска заявок по разным валютам 
						If KV1 = '840'
							Call SetTblRowColor(ZAY4.tbl, COLOR_DarkGreen)
						Else If KV1 = '978'
							Call SetTblRowColor(ZAY4.tbl, COLOR_MidnightBlue)
						Else If KV1 = '643'
							Call SetTblRowColor(ZAY4.tbl, COLOR_Chartreuse)
						Else
							Call SetTblRowColor(ZAY4.tbl,  COLOR_Jade)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   7.85"
						Top:    0.0"
						Width:  7.867"
						Width Editable? Class Default
						Height: 3.94"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Black
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIOR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S980s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ГРН Эквивалент
								суммы ПРОДАЖИ
								(по курсу дилера)
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.717"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_F
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								дилера
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If Check_Kurs(KV1,KURS_F)
									Return VALIDATE_Ok
								Else
									Return VALIDATE_Cancel
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: О
								т
								м
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If SOS=0 
									Set nSOS=0
									Set VDATE=DATETIME_Null
									Set KURS_F=NUMBER_Null
								Else
									If nDIL_VIZA=1
										Set nSOS=0.5
									Else
										Set nSOS=1
									If VDATE=DATETIME_Null 
										If DAT<dDATA
											Set VDATE=dDATA
										Else
											Set VDATE=DAT
									If KURS_F=NUMBER_Null
										Set KURS_F=KURS_Z
									If Check_Kurs(KV1,KURS_F)
										Return VALIDATE_Ok
									Else
										Return VALIDATE_Cancel
					Column: VDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								валюти-
								рования
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If VDATE<dDATA or VDATE<DAT
									Return VALIDATE_Cancel
					Column: PR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Признак оплаты с ГОУ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strDSql =
								   "SELECT dk, decode(sos, 0, 0, 1), kv2, lcv, dig, 
								           sum(s2), fdat, kurs_z, vdate, kurs_f, 
								           priority, priorname
								      INTO :ZAY4.tbl2.DK,
								           :ZAY4.tbl2.SOS,
								           :ZAY4.tbl2.KV1,
								           :ZAY4.tbl2.ISO,
								           :ZAY4.tbl2.DIG,  
								           :ZAY4.tbl2.S2,
								           :ZAY4.tbl2.DAT,
								           :ZAY4.tbl2.KURS_Z,
								           :ZAY4.tbl2.VDATE,    
								           :ZAY4.tbl2.KURS_F,
								           :ZAY4.tbl2.PRIOR,
								           :ZAY4.tbl2.PRIORITY
								      FROM v_zay_queue
								     WHERE dk  = 1 
								       AND sos < 2
								       AND s2  > 0
								       AND kurs_z IS NOT NULL
								       AND ((viza = 1 AND priorverify = 0) OR (viza = 2 AND priorverify = 1))  
								     GROUP BY dk, sos, kv2, lcv, dig, fdat, kurs_z, vdate, kurs_f, priority, priorname
								     ORDER BY kv2, priority desc, kurs_z, sos"
						Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
						Call SalWaitCursor(FALSE)
						!
					On SAM_FetchRowDone
						Set S2s = Dig4(S2/100, DIG, 4)
						If SalIsNull(SOS)
							Set SOS = 0
						Set PR = SOS
						If SalIsNull(DAT)
							Set DAT = dDATA
						If NOT SalIsNull(KURS_F)
							Set S980s = S2*KURS_F/100
						! Раскраска заявок по разным валютам
						If KV1 = '840'
							Call SetTblRowColor(ZAY4.tbl2, COLOR_DarkGreen)
						Else If KV1 = '978'
							Call SetTblRowColor(ZAY4.tbl2, COLOR_MidnightBlue)
						Else If KV1 = '643'
							Call SetTblRowColor(ZAY4.tbl2, COLOR_Chartreuse)
						Else
							Call SetTblRowColor(ZAY4.tbl2,  COLOR_Jade)
		Functions
			Function: F_Prn_List
				Description: Печать листа узгодження
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nKODZ
				Actions
					If SqlPrepareAndExecute( hSql(), 
							   "SELECT to_number(nvl(val,0)) INTO :nKODZ
							    FROM birja WHERE par='PRN_LIST' " ) 
							AND not SqlFetchNext( hSql(), nFetchRes )
						Set nKODZ=0
					If nKODZ>0
						If SalMessageBox('Вы действительно хотите сформировать ведомость?','Внимание',MB_YesNo )=IDYES
							Call ExportCatQuery( nKODZ, '', 3, ":Param0='" ||SalFmtFormatDateTime(GetBankDate(),'dd/MM/yyyy')|| "'", FALSE )
					Else
						Call SalMessageBox('Не указан код каталог.запроса для формирования ведомости!','Внимание',MB_IconStop )
			Function: Check_Kurs
				Description:
				Returns
					Boolean:
				Parameters
					String: sKv
					Number: nKurs
				Static Variables
				Local variables
					Number: nKursB
					Number: nKursS
				Actions
					If nKurs=NUMBER_Null
						Return TRUE
					If SqlPrepareAndExecute( hSql(), 
							  "SELECT kurs_b, kurs_s INTO :nKursB, :nKursS 
							   FROM diler_kurs 
							   WHERE dat=(SELECT max(dat) FROM diler_kurs 
							              WHERE trunc(dat)=trunc(sysdate) AND kv=:sKv)" )
							AND NOT SqlFetchNext( hSql(), nFetchRes )
						! Дилер сегодня курс не установил ->  проверять нечего!
						Return TRUE 
					Else
						If nKursB!=NUMBER_Null AND 
								   nKursS!=NUMBER_Null AND
								   (nKursB > nKurs OR nKurs > nKursS) 
							If SalMessageBox( 'Введенный курс выходит за рамки установленных дилером курсов на сегодняшний день! Продолжить?', 'Внимание', MB_IconExclamation|MB_YesNo )=IDYES
								Return TRUE
							Else
								Return FALSE
						Else
							Return TRUE
			Function: F_GREY
				Description:
				Returns
					Number:
				Parameters
					String: sKv
					Number: nKurs
				Static Variables
				Local variables
					Number: nKursB
					Number: nKursS
				Actions
					If nKurs=NUMBER_Null
						Return 0
					If SqlPrepareAndExecute( hSqlAux2(), 
							  "SELECT kurs_b, kurs_s INTO :nKursB, :nKursS 
							   FROM diler_kurs 
							   WHERE dat=(SELECT max(dat) FROM diler_kurs 
							              WHERE trunc(dat)=trunc(sysdate) AND kv=:sKv)" )
							AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
						! Дилер сегодня курс не установил ->  проверять нечего!
						Return 0
					Else
						If nKursB!=NUMBER_Null AND 
								   nKursS!=NUMBER_Null AND
								   (nKursB > nKurs OR nKurs > nKursS) 
							Return 0
						Else
							Return 1
		Window Parameters
		Window Variables
			String: strDSql
			Date/Time: dDATA
			String: sdat
			String: sdatDDMM
			Number: nDIL_VIZA
			Number: nI
			Number: nTime
			Number: nFetchRes
			Number: nSOS
			Number: nNextRow
			: cDoc2
				Class: cDoc
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call PrepareWindow(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Set dDATA=GetBankDate()
				Set sdat=SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
				Set sdatDDMM=SalStrMidX( sdat, 3, 2 )||SalStrMidX( sdat, 0, 2 )
				If SqlPrepareAndExecute( hSql(), 
						   "SELECT to_number(nvl(val,0)) INTO :nDIL_VIZA
						    FROM birja WHERE par='DIL_VIZA' " ) 
						AND not SqlFetchNext( hSql(), nFetchRes )
					Set nDIL_VIZA=0
				Set ZAY4.strPrintFileName='ZAY'||'_'||sdatDDMM||'.TXT'
				Set ZAY4.strFilterTblName = 'V_ZAY_QUEUE'
				Call SalHideWindow( ZAY4.tbl.S980s )
				Call SalHideWindow( ZAY4.tbl2.S980s )
				!
				Set ZAY4.strSqlPopulate =
						   "SELECT dk, decode(sos, 0, 0, 1), kv2, lcv, dig, 
						           sum(s2), fdat, kurs_z, vdate, kurs_f, 
						           priority, priorname
						      INTO :ZAY4.tbl.DK,
						           :ZAY4.tbl.SOS, 
						           :ZAY4.tbl.KV1, 
						           :ZAY4.tbl.ISO,
						           :ZAY4.tbl.DIG,
						           :ZAY4.tbl.S2,  
						           :ZAY4.tbl.DAT,
						           :ZAY4.tbl.KURS_Z,
						           :ZAY4.tbl.VDATE,    
						           :ZAY4.tbl.KURS_F,
						           :ZAY4.tbl.PRIOR,
						           :ZAY4.tbl.PRIORITY
						      FROM v_zay_queue
						     WHERE dk  = 2 
						       AND sos < 2
						       AND s2  > 0
						       AND kurs_z IS NOT NULL
						       AND ((viza = 1 AND priorverify = 0) OR (viza = 2 AND priorverify = 1))  
						     GROUP BY dk, sos, kv2, lcv, dig, fdat, kurs_z, vdate, kurs_f, priority, priorname
						     ORDER BY kv2, priority desc, kurs_z, sos"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Form Window: ZAY5
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000010000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Подтверждение приоритетных заявок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.063"
				Top:    0.865"
				Width:  19.917"
				Width Editable? Class Default
				Height: 5.833"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Возврат на предыдущую визу'
						On SAM_Click
							Call SalSendMsg(hWndCurTable, UM_Delete, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.1"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Call SalSendMsg( ZAY5.tbl, UM_Update, 0, 0 )
							Call SalSendMsg( ZAY5.tbl2, UM_Update, 0, 0 )
							Call SalWaitCursor(FALSE)
				Line
					Resource Id: 46667
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46668
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.067"
						Begin Y:  0.393"
						End X:  3.067"
						End Y:  -0.024"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46669
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.783"
						Begin Y:  0.405"
						End X:  3.783"
						End Y:  -0.012"
					Visible? Yes
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Покупка
					Resource Id: 46670
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.733"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Arial Cyr
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				Background Text: Продажа
					Resource Id: 46671
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   13.35"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Arial Cyr
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Check Box: cb_CONV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За ВАЛЮТУ
					Window Location and Size
						Left:   2.217"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							! Call InitSqlStr()
							Call SalSendMsg (tbl, UM_Populate, 0, 0)
		Contents
			Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   9.583"
						Top:    0.0"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  7.5"
						Width Editable? Class Default
						Height: 4.488"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Black
					Background Color: Sky
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Виза
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV_CONV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ЗА
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: №
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рег.№
								клиента
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Клиент
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Отделение
								клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  0.95"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Виза
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REQ_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
								заявки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cbREQ_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Наименование
								типа заявки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Call cbREQ_TYPE.Init(hWndItem)
								Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
					Column: Code2c
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код купівлі
								за імпортом
								(#2C)
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: P12_2C
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ознака 
								операції
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nRow
				Message Actions
					On UM_Populate
						! ! Показать-спрятать покупку за валюту
						If cb_CONV
							Call SalShowWindow(ZAY5.tbl.KV_CONV)
							Set ZAY5.strSqlPopulate =
									"SELECT dk, id, rnk, nmk, cust_branch, fdat, kv2, lcv, dig, kurs_z, s2, priorname, kv_conv, req_type, code_2c, p12_2c
									   INTO :ZAY5.tbl.DK, :ZAY5.tbl.ID, :ZAY5.tbl.RNK, :ZAY5.tbl.NMK, :ZAY5.tbl.BRANCH,
									        :ZAY5.tbl.DAT, :ZAY5.tbl.KV1, :ZAY5.tbl.ISO, :ZAY5.tbl.DIG,
									        :ZAY5.tbl.KURS_Z, :ZAY5.tbl.S2, :ZAY5.tbl.PRIORITY, :ZAY5.tbl.KV_CONV, :ZAY5.tbl.REQ_TYPE, :ZAY5.tbl.Code2c, :ZAY5.tbl.P12_2C
									   FROM v_zay_queue
									  WHERE dk          = 3
									    AND sos         = 0
									    AND viza        = 1
									    AND priorverify = 1
									    AND s2          > 0
									    and mfo = f_ourmfo
									  ORDER BY fdat, kv2, priority desc, kurs_z"
						Else
							Call SalHideWindow(ZAY5.tbl.KV_CONV)
							Set ZAY5.strSqlPopulate =
									"SELECT dk, id, rnk, nmk, cust_branch, fdat, kv2, lcv, dig, kurs_z, s2, priorname, req_type
									   INTO :ZAY5.tbl.DK, :ZAY5.tbl.ID, :ZAY5.tbl.RNK, :ZAY5.tbl.NMK, :ZAY5.tbl.BRANCH,
									        :ZAY5.tbl.DAT, :ZAY5.tbl.KV1, :ZAY5.tbl.ISO, :ZAY5.tbl.DIG,
									        :ZAY5.tbl.KURS_Z, :ZAY5.tbl.S2, :ZAY5.tbl.PRIORITY, :ZAY5.tbl.REQ_TYPE
									   FROM v_zay_queue
									  WHERE dk          = 1
									    AND sos         = 0
									    AND viza        = 1
									    AND priorverify = 1
									    AND s2          > 0
									    AND kurs_z IS NOT NULL
									    and mfo = f_ourmfo
									  ORDER BY fdat, kv2, priority desc, kurs_z"
						Call ZAY5.ReInitQueryString()
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						If SalIsNull(SOS)
							Set SOS = 0
						If REQ_TYPE = NUMBER_Null
							Set cbREQ_TYPE = STRING_Null
						Else
							Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
						Set S2s = Dig4(S2/100, DIG, 4)
					On UM_Update
						Call SalWaitCursor(TRUE)
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAY5.tbl, nNextRow, ROW_Edited, 0)      
							Call SalTblSetContext(ZAY5.tbl, nNextRow)
							If BKL_KV(Val(ZAY5.tbl.KV1))
								! Call SqlPrepareAndExecute(cMain.hSql(), "UPDATE zayavka SET viza=2 WHERE id=:ZAY5.tbl.ID")
								If not SqlPLSQLCommand(cMain.hSql(), "bars_zay.set_visa(ZAY5.tbl.ID, 2, NUMBER_Null, NUMBER_Null, NUMBER_Null)")
									Call SqlRollback(cMain.hSql())
									Return FALSE
								Call SqlCommit(cMain.hSql())
								Call SaveInfoToLog("ZAY. Подтвержден приоритет ("||ZAY5.tbl.PRIORITY
										                 ||") заявки № "                 ||Str(ZAY5.tbl.ID)
										                 ||" клиента "                   ||Str(ZAY5.tbl.RNK)
										                 ||" на покупку "                ||SalStrTrimX(ZAY5.tbl.S2s)
										                 ||"/"                           ||ZAY5.tbl.ISO)
							Call SalTblDefineSplitWindow(ZAY5.tbl, 0, FALSE)
						Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblSetContext(hWndForm, nRow)
							Call BackRequest(3, 1, ID, RNK, NMK, SalStrTrimX(S2s), ISO)
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					On SAM_SetFocus
						Set hWndCurTable = hWndForm
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   8.783"
						Top:    0.0"
						Width:  10.4"
						Width Editable? Class Default
						Height: 4.488"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Black
					Background Color: Light Green
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Виза
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV_CONV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ЗА
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: №
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рег.№
								клиента
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Клиент
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Отделение
								клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  0.933"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REQ_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
								заявки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cbREQ_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Наименование
								типа заявки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Call cbREQ_TYPE.Init(hWndItem)
								Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
				Functions
				Window Variables
					Number: nRow
				Message Actions
					On UM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						If cb_CONV
							Call SalShowWindow(ZAY5.tbl2.KV_CONV)
						Else
							Call SalHideWindow(ZAY5.tbl2.KV_CONV)
						Set strDSql = 
								"SELECT dk, id, rnk, nmk, cust_branch, fdat, kv2, lcv, dig, kv_conv, kurs_z, s2, priorname, req_type
								   INTO :ZAY5.tbl2.DK, :ZAY5.tbl2.ID, :ZAY5.tbl2.RNK, :ZAY5.tbl2.NMK, :ZAY5.tbl2.BRANCH,
								        :ZAY5.tbl2.DAT, :ZAY5.tbl2.KV1, :ZAY5.tbl2.ISO, :ZAY5.tbl2.DIG, :ZAY5.tbl2.KV_CONV,  
								        :ZAY5.tbl2.KURS_Z, :ZAY5.tbl2.S2, :ZAY5.tbl2.PRIORITY, :ZAY5.tbl2.REQ_TYPE
								   FROM v_zay_queue
								  WHERE dk          = " || IifS(cb_CONV=TRUE, "4", "2") || " 
								    AND sos         = 0 
								    AND viza        = 1 
								    AND priorverify = 1
								    AND s2          > 0 
								    AND kurs_z IS NOT NULL 
								    and mfo = f_ourmfo
								  ORDER BY fdat, kv2, priority desc, kurs_z"   
						Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
						Call SalWaitCursor(FALSE)
						!
					On SAM_FetchRowDone
						If SalIsNull(SOS)
							Set SOS = 0
						If REQ_TYPE = NUMBER_Null
							Set cbREQ_TYPE = STRING_Null
						Else
							Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
						Set S2s = Dig4(S2/100, DIG, 4)
					On UM_Update
						Call SalWaitCursor(TRUE)
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAY5.tbl2, nNextRow, ROW_Edited, 0)      
							Call SalTblSetContext(ZAY5.tbl2, nNextRow)
							If BKL_KV(Val(ZAY5.tbl2.KV1))
								! Call SqlPrepareAndExecute(hSql(), "UPDATE zayavka SET viza=2 WHERE id=:ZAY5.tbl2.ID")
								If not SqlPLSQLCommand(hSql(), "bars_zay.set_visa(ZAY5.tbl2.ID, 2, NUMBER_Null, NUMBER_Null, NUMBER_Null)")
									Call SqlRollback(hSql())
									Return FALSE
								Call SqlCommit(hSql())
								Call SaveInfoToLog("ZAY. Подтвержден приоритет ("||ZAY5.tbl2.PRIORITY
										                 ||") заявки № "                 ||Str(ZAY5.tbl2.ID)
										                 ||" клиента "                   ||Str(ZAY5.tbl2.RNK)
										                 ||" на продажу "                ||SalStrTrimX(ZAY5.tbl2.S2s)
										                 ||"/"                           ||ZAY5.tbl2.ISO)
							Call SalTblDefineSplitWindow(ZAY5.tbl2, 0, FALSE)
							Call SalWaitCursor(FALSE)
						Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblSetContext(hWndForm, nRow)
							Call BackRequest(3, 2, ID, RNK, NMK, SalStrTrimX(S2s), ISO)
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					On SAM_SetFocus
						Set hWndCurTable = hWndForm
		Functions
		Window Parameters
		Window Variables
			String: strDSql
			Date/Time: dDATA
			String: sdat
			Number: nI
			Number: nFetchRes
			Number: nNextRow
			Window Handle: hWndCurTable
			String: sStornoReasonId
			String: sStornoReason
			Number: nStornoReasonId
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Set dDATA = GetBankDate()
				Set sdat = SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
				Set cb_CONV = FALSE
				Call SalHideWindow(ZAY5.tbl.KV_CONV)
				Call SalHideWindow(ZAY5.tbl2.KV_CONV)
				Set hWndCurTable = tbl
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: KROSS
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: ТАБЛИЦА   КРОСС_КУРСОВ ВАЛЮТ 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.146"
				Width:  12.514"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.967"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 2277
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.4"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.833"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							! вызов функции печати 
							Call SalWaitCursor( TRUE )
							Set sSql=GetPrnDir()||"\\"||sBD||".rtf"
							Set sKv='DAT,NAMV,KV,ISO,NV,KURS,NB'
							Call SalReportPrintToFile(hWndForm,
									GetTemplateDir()||"\\KROSS1.QRP", sSql ,
									sKv, sKv, 1, RPT_PrintAll, 1, 1, TRUE, i)
							Call SalWaitCursor( FALSE )
							If SalMessageBox( "Желаете просмотреть файл отчета " || sSql || " в редакторе?",
									"Отчет сформирован успешно!", MB_IconQuestion | MB_YesNo ) = IDYES
								Call SalLoadApp ( GetEditorPath(), sSql )
							! конец
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.5"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 2278
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.433"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 2279
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbGRAF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.217"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Динамика курсов валют (Коеф.приращения)'
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Call SalCreateWindow(KROSSD, hWndForm,colKV,colISO)
				Pushbutton: pbGRAF1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.65"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Динамика курса валюты (Абс.значение)'
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Call SalSendMsg(hWndForm, SAM_DoubleClick,0,0 )
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: colKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colISO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Number: nI
			Number: i
			String: sKv
			String: ISO
			String: sSql
			String: sBD
			!
			Date/Time: DAT 
			String: NAMV
			Number: KV
			String: NV
			String: NB
			Number: KURS
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call PrepareWindow(hWndForm)
				Call XSalTooltipSetUserDefault(  )
				Set KROSS.strPrintFileName='KROSS'
				Call SalTblSetLockedColumns( hWndForm, 7)
				Set DAT=GetBankDate()
				Set sBD=GetBankDateEx()
				Set NB=GetBankName()
				Set sBD=SalStrRightX(sBD,4)||SalStrLeftX(sBD,2)||SalStrMidX(sBD,3,2)
				Call SqlPrepareAndExecute( hSql(),
						"SELECT kv||'',lcv INTO :sKv,:ISO FROM tabval t  WHERE  exists (select 1 from cur_rates where kv = t.kv) ORDER BY skv")
				Set i=2
				Set sSql="SELECT kv||'', lcv"
				While SqlFetchNext( hSql(), nI )
					Set i=i+1
					Call SalTblCreateColumn( hWndForm, i, 1.2, 13,ISO)
					Set sSql=sSql||",
							ROUND(gl.p_icurval(kv,1000000,gl.bd)/
							      gl.p_icurval("||sKv||",1000000,gl.bd),6)"
				Call SalTblPopulate( hWndForm, hSql(), 
						sSql||" FROM tabval t  WHERE  exists (select 1 from cur_rates where kv = t.kv) ORDER BY skv", TBL_FillAll)
				Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols, FALSE )
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Call SalWaitCursor( FALSE )
			On SAM_ReportStart
				Set NAMV=GetValueStr("SELECT name FROM tabval where kv="||colKV)
				Call SqlPrepareAndExecute( hSql(), T("
						SELECT kv,lcv,name,ROUND(gl.p_icurval(kv,1000000,gl.bd)/
						      gl.p_icurval("||colKV||",1000000,gl.bd),6)
						INTO   :KV,:ISO,:NV,:KURS
						FROM tabval t  WHERE  exists (select 1 from cur_rates where kv = t.kv) " ))
			On SAM_DoubleClick
				Call SalWaitCursor( TRUE )
				Call SalCreateWindow(KURS1, hWndForm,colKV,colISO)
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				Return SqlFetchNext( hSql(), nI )
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
			On SAM_Destroy
				! Disactivation call function' role
				If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
					Call XRoleUnset(hSql(), ' ZAYAVKA(hWndMDI,500) ' )
	Form Window: KURS1
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.313"
				Top:    0.0"
				Width:  12.933"
				Width Editable? Yes
				Height: 6.917"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.417"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Data Field: dat11
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.071"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dat22
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.483"
							Top:    0.071"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbGRAF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Динамика курсов'
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				Pushbutton: pbEXIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.143"
						Top:    0.063"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завершить'
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
		Contents
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    -0.012"
						Width:  12.483"
						Width Editable? Yes
						Height: 1.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Оф
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Покупка
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Продажа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Custom Control: ccGraf
.data CLASSPROPSSIZE
0000: 8919
.enddata
.data CLASSPROPS
0000: 4954454D00130044 41542C636F6C312C 636F6C322C636F6C 3300004772617068
0020: 53706563004C1990 0100000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000000 0000000000000000 0000000200000032
0180: 0000000000000003 0000000100000000 0000000000000001 0000000200000003
01A0: 000000417269616C 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000000000 0000000000000000 000000417269616C 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0240: 000000417269616C 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000000000 0000000000000000 000000417269616C 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02E0: 000000C800000096 0000006400000064 0000000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000000 0000000000000000 0000000600000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0560: 0000000000000000 0000000100000001 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000000000000000 0000000000000005 0000000400000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000000000 0000000000000000 0000003200000000 0000001E00000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000000000000000 0000000000000064 0000000100000001
06A0: 0000000100000003 0000000100000000 0000000000000000 0000000000000001
06C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
06E0: 0000000000000000 00000074626C3100 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000000 0000000000000000 0000000400000044
0740: 4154000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000063 6F6C310000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000063
07E0: 6F6C320000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000063 6F6C330000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000000000000000 000000000000004F
0D80: F400000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 00000000000000CF EEEAF3EFEAE00000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 00000000000000CF
0E20: F0EEE4E0E6E00000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000063 6F6C330000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000044
13C0: 4154000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000000000000000 0000000000000001 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0000000000000000 0000000000000007
15A0: 000000FFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF1000000010
15C0: 0000001000000010 0000001000000010 0000001000000010 0000001000000010
15E0: 0000001000000010 0000001000000010 0000000000000000 0000000000000000
1600: 0000000000000000 0000000000000000 0000000100000001 0000000000000000
1620: 0000000000000000 0000000000000000 00000000000000FF FFFFFF00000000FF
1640: FFFFFF0000000000 0000000000000000 0000000000000000 0000000000000000
1660: 0000004752415048 5050522E484C5000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000000 0000000000000000 0000000100000047 7261706820436F6E
18A0: 74726F6C00000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 0000000000000000 000000000000000F
1940: 0000000000000008 0000006400000014 0000001400000000 0000000000000000
1960: 0000000000000000 0000000000000001 00000000534F5552 434500050074626C
1980: 3100000000000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQuickGraph
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    1.488"
						Width:  12.283"
						Width Editable? Class Default
						Height: 4.5"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			String: KV
			String: KV_ISO
		Window Variables
			Number: nI
			Number: i
			Number: nMin
			Number: nMax
			String: sKv
			String: ISO
			String: sSql
			Date/Time: dBD
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 'Динамика курсов '||KV_ISO)
				Call PrepareWindowEx(hWndForm)
				Set dBD=GetBankDate()
				Set ccGraf.Graph.DataSource = "tbl1"
				Set ccGraf.Graph.LabelField = "DAT"
				Set dat22=dBD
				Set dat11=dBD-31
				Set ccGraf.Graph.NumDataFields = 3
				Set ccGraf.Graph.DataField[0] ="col1"
				Set ccGraf.Graph.DataField[1] ="col2"
				Set ccGraf.Graph.DataField[2] ="col3"
				Set ccGraf.Graph.Background[1] = 7
				Set ccGraf.Graph.Background[6] = 7
				Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				!
				! Call SalTblPopulate( tbl1, hSql(), 
						"SELECT to_char(vdate,'DD-MM') ,rate_o/bsum, rate_b/bsum,rate_s/bsum
						 FROM cur_rates 
						 WHERE kv=:KV vdate>=:dat11 and vdate<=:dat22
						 ORDER BY vdate", TBL_FillAll)
				! Call ccGraf.Draw()
				!
				! Call SalWaitCursor ( FALSE )
			On SAM_User
				Call SalTblPopulate( tbl1, hSql(), 
						"SELECT to_char(vdate,'DD-MM') ,rate_o/bsum, rate_b/bsum,rate_s/bsum
						 FROM cur_rates 
						 WHERE kv=:KV and vdate>=:dat11 and vdate<=:dat22
						 ORDER BY vdate", TBL_FillAll)
				Call ccGraf.Draw()
				!
				Call SalWaitCursor ( FALSE )
	Form Window: KROSSD
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.1"
				Top:    0.031"
				Width:  12.75"
				Width Editable? Yes
				Height: 7.286"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.396"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Data Field: dat11
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.571"
							Top:    0.031"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dat22
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.771"
							Top:    0.031"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbGRAF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.971"
						Top:    0.031"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Динамика курсов'
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				Pushbutton: pbEXIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.486"
						Top:    0.031"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завершить'
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
		Contents
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  12.483"
						Width Editable? Yes
						Height: 1.656"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ1
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ2
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ3
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ4
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col5
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ5
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col6
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ5
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col7
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ5
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col8
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ВАЛ5
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Custom Control: ccGraf
.data CLASSPROPSSIZE
0000: 9E19
.enddata
.data CLASSPROPS
0000: 534F555243450005 0074626C31000047 7261706853706563 004C199001000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000002 0000003200000000 0000000300000001
0180: 0000000000000000 0000000100000002 0000000300000041 7269616C00000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000000041 7269616C00000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000000041 7269616C00000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000000041 7269616C00000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 00000000000000C8 0000009600000064
02E0: 0000006400000000 0000000000000000 0000000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000006 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000001
0560: 0000000100000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000000500000008 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000000032 000000000000001E 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000006400000001 0000000100000001 0000000300000001
06A0: 0000000000000000 0000000000000000 0000000100000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 0000004000000074
06E0: 626C310000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000008 000000636F6C3100 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 000000636F6C3200 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 000000636F6C3300 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 000000636F6C3400 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 000000636F6C3500 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 000000636F6C3600 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 000000636F6C3700 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 000000636F6C3800 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000004441540000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000000100000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 00000007000000FF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF10 0000001000000010 0000001000000010
15C0: 0000001000000010 0000001000000010 0000001000000010 0000001000000010
15E0: 0000001000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000000001 0000000100000000 0000000000000000 0000000000000000
1620: 0000000000000000 000000FFFFFFFF00 000000FFFFFFFF00 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000000047 524150485050522E
1660: 484C500000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000001 0000004772617068 20436F6E74726F6C 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 0000000F00000000 0000000800000064
1940: 0000001400000014 0000000000000000 0000000000000000 0000000000000000
1960: 0000000100000000 4954454D00280063 6F6C312C636F6C32 2C636F6C332C636F
1980: 6C342C636F6C352C 636F6C362C636F6C 372C636F6C380000 000000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQuickGraph
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    1.74"
						Width:  12.483"
						Width Editable? Class Default
						Height: 4.893"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			String: KV
			String: KV_ISO
		Window Variables
			Number: nI
			Number: i
			Number: nMin
			Number: nMax
			String: sKv
			String: ISO
			String: sSql
			Date/Time: dBD
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 'Динамика (Коефициент приращения) курсов валют. Базовая валюта '||KV_ISO)
				Call PrepareWindowEx(hWndForm)
				Set dBD=GetBankDate()
				Set dat22=dBD
				Set dat11=dBD-31
				Set ccGraf.Graph.DataSource = "tbl1"
				Set ccGraf.Graph.LabelField = "DAT"
				!
				Set i=0
				Set nMin=1000
				Set nMax=0
				Set sSql="SELECT to_char(fdat,'DD-MM')"
				Call SqlPrepareAndExecute( hSql(),
						"SELECT kv||'',lcv INTO :sKv,:ISO FROM tabval WHERE kv <> "||KV||" ORDER BY skv")
				While SqlFetchNext( hSql(), nI ) and i<8
					Set i=i+1
					Set ccGraf.Graph.LegendText[i-1] = ISO
					Set sSql=sSql||",
							ROUND(
							( gl.p_icurval("||KV|| ",1000000,fdat)/
							  gl.p_icurval("||sKv||",1000000,fdat) ) 
							/
							( gl.p_icurval("||KV|| ",1000000,gl.bd)/
							  gl.p_icurval("||sKv||",1000000,gl.bd) )
							,6) -1 "
					!
					If i=1
						Call SalTblSetColumnTitle(tbl1.col1, ISO )
						Set ccGraf.Graph.DataField[0] ="col1"
						Call SalShowWindow(tbl1.col1)
					Else If i=2
						Call SalTblSetColumnTitle(tbl1.col2, ISO )
						Set ccGraf.Graph.DataField[1] ="col2"
						Call SalShowWindow(tbl1.col2)
					Else If i=3
						Call SalTblSetColumnTitle(tbl1.col3, ISO )
						Set ccGraf.Graph.DataField[2] ="col3"
						Call SalShowWindow(tbl1.col3)
					Else If i=4
						Call SalTblSetColumnTitle(tbl1.col4, ISO )
						Set ccGraf.Graph.DataField[3] ="col4"
						Call SalShowWindow(tbl1.col4)
					Else If i=5
						Call SalTblSetColumnTitle(tbl1.col5, ISO )
						Set ccGraf.Graph.DataField[4] ="col5"
						Call SalShowWindow(tbl1.col5)
					Else If i=6
						Call SalTblSetColumnTitle(tbl1.col6, ISO )
						Set ccGraf.Graph.DataField[5] ="col6"
						Call SalShowWindow(tbl1.col6)
					Else If i=7
						Call SalTblSetColumnTitle(tbl1.col7, ISO )
						Set ccGraf.Graph.DataField[6] ="col7"
						Call SalShowWindow(tbl1.col7)
					Else If i=8
						Call SalTblSetColumnTitle(tbl1.col8, ISO )
						Set ccGraf.Graph.DataField[7] ="col8"
						Call SalShowWindow(tbl1.col8)
					!
				!
				Call SalSendMsg( hWndForm, SAM_User,0,0)
				!
			On SAM_User
				Call SalWaitCursor ( TRUE )
				Call SalTblPopulate( tbl1, hSql(), 
						sSql||" FROM fdat
						 WHERE fDAT>=:dat11 and fdat<=:dat22 
						 ORDER BY fdat", TBL_FillAll)
				!
				Set ccGraf.Graph.NumDataFields = i
				Set ccGraf.Graph.Background[1] = 7
				Set ccGraf.Graph.Background[6] = 7
				!
				Call ccGraf.Draw()
				!
				Call SalWaitCursor ( FALSE )
	Form Window: ZAYV
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Визирование введенных сделок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.214"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Визирование введенных сделок
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть'
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV.tbl,  UM_Delete,   0, 0)
								Call SalSendMsg(ZAYV.tbl2, UM_Delete,   0, 0)
								Call SalPostMsg(ZAYV.tbl,  UM_Populate, 0, 0)
								Call SalPostMsg(ZAYV.tbl2, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(ZAYV.tbl,  UM_Populate, 0, 0)
							Call SalSendMsg(ZAYV.tbl2, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завизировать'
						On SAM_Click
							If MessageQuestion('Будут визированы все отмеченные заявки. Продолжать ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV.tbl,  SAM_User, 0, 0)
								Call SalSendMsg(ZAYV.tbl2, SAM_User, 0, 0)
								Call SalPostMsg(ZAYV.tbl,  UM_Populate, 0, 0)
								Call SalPostMsg(ZAYV.tbl2, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 55693
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  2.817"
						Begin Y:  0.417"
						End X:  2.817"
						End Y:  0.0"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.133"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrintZay
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.433"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать заявки"
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите распечатать отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV.tbl,  UM_Print,    0, 0)
								Call SalSendMsg(ZAYV.tbl2, UM_Print,    0, 0)
								Call SalPostMsg(ZAYV.tbl,  UM_Populate, 0, 0)
								Call SalPostMsg(ZAYV.tbl2, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbPrintZayCorp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.065"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Просмотр и печать заявки CORP2"
						On SAM_Click
							Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV.tbl.ID)),6)||'.DOC'
							If NOT PutBlobToFile(
									          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAYV.tbl.ID,          '',          '')
								Call SalFileOpen(hFile, sFileName, OF_Delete)
								Call SalWaitCursor(FALSE)
								Return FALSE
							If sFileName != STRING_Null
								! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
										                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
										                           'Печать сформированной заявки',
										                           MB_IconQuestion|MB_YesNoCancel )
								Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
										                          'Просмотр и печать заявки CORP2',
										                          MB_IconQuestion|MB_YesNo )
								If nPrint = IDYES
									Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
									! Call DirectView(sFileName)
				Line
					Resource Id: 55694
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.133"
						Begin Y:  0.417"
						End X:  3.133"
						End Y:  0.0"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55695
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.55"
						Begin Y:  Class Default
						End X:  3.55"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.512"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.571"
						Width:  11.6"
						Width Editable? Class Default
						Height: 1.94"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Sky
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? No
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BLK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Флаг
								блок.
								ГРН.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VIZA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: В
								и
								з
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.317"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								№
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								РНК
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								клиента-
								покупателя
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Отделение
								клиента-
								покупателя
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								списания
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								зачисления
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет для
								списания
								ГРН
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сальдо
								счета
								ГРН
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет для
								зачисления
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								заявл.
								 ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								покупки
								 ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Курс
								покупки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.0"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								%
								ком
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SKOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								или
								сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Приоритет
								заявки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cbPRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: 
								Приоритет
								заявки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? No
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Create
								If cbPRIORITY.Init(hWndItem)
									Call cbPRIORITY.Populate(hSql(), "id", "name", " zay_priority "," where active = 1 order by id")
							On SAM_AnyEdit
								Set PRIORITY = cbPRIORITY.GetKey(SalListQuerySelection(cbPRIORITY))
					Column: OKPO0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО
								 Клиента
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: D1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Цель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Конт-
								
								№
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ракт
								
								дата
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								№
								ТД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Дата
								ТД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D5
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Даты
								других
								ТД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D7
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Осно-
								вание
								покуп.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D6
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страна
								переч.
								вал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D8
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страна
								бенефе-
								циара
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: D9
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Код
								банка
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наиме-
								нование
								банка
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								товарн.
								группы
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Цель
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Конт
								ракт
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								контр.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  0.633"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								посл.
								ВМД
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  0.583"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV5
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Даты
								других
								ВМД
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV6
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страна
								переч.
								вал.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV7
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Осно-
								вание
								покуп.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV8
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страна
								бенефе-
								циара
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DV9
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код 
								банка
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								банка
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DVB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								банка
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: DVC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № посл.
								тамож.декларации
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? No
						List Values
						Message Actions
					Column: MFOP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								МФО 
								ПФ
						Visible? Yes
						Editable? No
						Maximum Data Length: 6
						Data Type: String
						Justify: Left
						Width:  0.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLSP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Счет
								ПФ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OKPOP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Код ОКПО 
								ПФ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.033"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: COMM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Коментарий
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								зачисления
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: COVERED
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OPT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Code2c
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: P12_2C
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: 10
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On UM_Create
						                                                                                                         Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Delete
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYV.tbl, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYV.tbl, nNextRow)
							If SalMessageBox('Вы уверены, что хотите возвратить заявку клиента '||ZAYV.tbl.NMK||
									                 ' на покупку '||SalStrTrimX(ZAYV.tbl.S2s)||'/'||Str(ZAYV.tbl.KV1)||'?' ,
									                 'Сторно заявок', 
									                 MB_IconQuestion | MB_YesNo) = IDYES
								Set sStornoReasonId = ''
								Set sStornoReason = ''
								If FunNSIGet('ZAY_BACK', '', sStornoReasonId,  sStornoReason)
									If sStornoReasonId AND sStornoReason
										Set nStornoReasonId = Val(sStornoReasonId)
										If SqlPrepareAndExecute(cMain.hSql(),
												   "UPDATE zayavka 
												       SET viza   = -1, 
												           idback = :nStornoReasonId 
												     WHERE dk     = 1 
												       AND id     = :ZAYV.tbl.ID")
											Call SqlCommit(cMain.hSql())
											Call SaveInfoToLog("ZAY. Отказано в визе заявке № "||Str(ZAYV.tbl.ID)
													                 ||" клиента "                     ||Str(ZAYV.tbl.RNK)
													                 ||" на покупку "                  ||SalStrTrimX(ZAYV.tbl.S2s)
													                 ||"/"                             ||Str(ZAYV.tbl.KV1)
													                 ||". Код причины - "              ||sStornoReasonId)
											! Call SalTblDefineSplitWindow(ZAYV.tbl, 0, FALSE)
										Else
											Call SqlRollback(hSql())
											Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию',
													                   'Сторно заявок. Ошибка', 
													                    MB_IconStop)
									Else
										Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию',
												                   'Сторно заявок. Ошибка', 
												                   MB_IconStop)
								Else
									Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию',
											                    'Сторно документов. Ошибка', 
											                     MB_IconStop)
					On UM_Print
						If nPrntBuy = -1
							Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
						Else
							Set nNextRow = TBL_MinRow
							While SalTblFindNextRow(ZAYV.tbl, nNextRow, ROW_Selected, 0)      
								Call SalTblSetContext(ZAYV.tbl, nNextRow)
								Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV.tbl.ID)),6)||'.TXT'
								Call ExportCatQuery(nPrntBuy,
										                      sFileName,
										                      3,
										                      ":ZAY_ID='"||SalStrTrimX(Str(ZAYV.tbl.ID))||"'",
										                      FALSE)
								If sFileName != STRING_Null
									Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
											                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
											                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
											                           'Печать сформированной заявки',
											                           MB_IconQuestion|MB_YesNoCancel )
									If nPrint = IDYES
										Call DirectView(sFileName)
									If nPrint = IDNO
										Call DosDirectPrint(sFileName)
					On SAM_User
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYV.tbl, nNextRow, ROW_Selected, 0)
							Call SalTblSetContext(ZAYV.tbl, nNextRow)
							If F_CHECK_DATA  ( ZAYV.tbl.DK, 
									                   ZAYV.tbl.ID, 
									                   ZAYV.tbl.KV1, 
									                   ZAYV.tbl.S2, 
									                   ZAYV.tbl.KURS_Z, 
									                   ZAYV.tbl.DAT, 
									                   ZAYV.tbl.OPT)
									AND F_RESERVE    ( ZAYV.tbl.ID, 
									                   ZAYV.tbl.BLK)
									AND SET_PRIORITY ( ZAYV.tbl.ID, 
									                   ZAYV.tbl.DK,
									                   ZAYV.tbl.COVERED, 
									                   ZAYV.tbl.PRIORITY)
								Call SqlPrepareAndExecute(cMain.hSql(),
										    "UPDATE zayavka
										        SET viza     = 1, 
										            priority = :ZAYV.tbl.PRIORITY
										      WHERE dk       = 1 
										        AND id       = :ZAYV.tbl.ID")
								Call SqlCommit(cMain.hSql())
								Call SaveInfoToLog("ZAY. Завизирована заявка № "||Str(ZAYV.tbl.ID)
										                 ||" клиента "                  ||Str(ZAYV.tbl.RNK)
										                 ||" на покупку "               ||SalStrTrimX(ZAYV.tbl.S2s)
										                 ||"/"                          ||Str(ZAYV.tbl.KV1)
										                 ||", приоритет "               ||Str(ZAYV.tbl.PRIORITY))
								! Call SalTblDefineSplitWindow(ZAYV.tbl, 0, FALSE)
						! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						Set BLK = 1
						Set S2s = Dig4(S2/100, DIG, 4)
						!
						If VIZA = -1
							Call SetTblRowColor(ZAYV.tbl, COLOR_DarkRed)
						! Подсказка о нехватке ГРН на счете
						If COVERED = 0
							Call SalTblSetCellTextColor(ZAYV.tbl.S0, COLOR_Red, FALSE)
						!
						Set D1 = IifN(SalStrTrimX(DV1) = STRING_Null,   0, 1)
						Set D2 = IifN(DV2 = STRING_Null,   0, 1)
						Set D3 = IifN(DV3 = DATETIME_Null, 0, 1)
						Set D4 = IifN(DV4 = DATETIME_Null, 0, 1)
						Set D5 = IifN(DV5 = STRING_Null,   0, 1)
						Set D6 = IifN(DV6 = STRING_Null,   0, 1)
						Set D7 = IifN(SalStrTrimX(DV7) = STRING_Null,   0, 1)
						! Call SaveInfoToLog('DV7='||DV7)
						Set D8 = IifN(DV8 = STRING_Null,   0, 1)
						Set D9 = IifN(DV9 = STRING_Null,   0, 1)
						Set DA = IifN(DVA = STRING_Null,   0, 1)
						Set DB = IifN(SalStrTrimX(DVB) = STRING_Null,   0, 1)
						Set DC = IifN(DVC = STRING_Null,   0, 1)
						!
					On SAM_DoubleClick
						If SalModalDialog(dlgZAY_DR, 
								                    ZAYV.tbl, ZAYV.tbl.ID, ZAYV.tbl.DK, ZAYV.tbl.OPT,
								                    ZAYV.tbl.DV1, ZAYV.tbl.DV2, 
								                    ZAYV.tbl.DV3, ZAYV.tbl.DV4, 
								                    ZAYV.tbl.DV5, ZAYV.tbl.DV6,
								                    ZAYV.tbl.DV7, ZAYV.tbl.DV8,
								                    ZAYV.tbl.DV9, ZAYV.tbl.DVA, 
								                    ZAYV.tbl.DVB, ZAYV.tbl.DVC, ZAYV.tbl.Code2c, ZAYV.tbl.P12_2C)
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.964"
						Width:  11.6"
						Width Editable? Class Default
						Height: 4.536"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Light Green
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: 0
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? No
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VIZA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: В
								и
								з
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OBZ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: О
								Б
								З
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.433"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								№
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								РНК
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								клиента-
								продавца
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Отделение
								клиента-
								покупателя
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								списания
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: MFO0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: МФО
								зачисл.
								ГРН
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет для
								зачисления
								ГРН
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OKPO0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО
								для зач.
								ГРН
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет для
								списания
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								зачисления
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S0
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сальдо
								счета
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S0s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сальдо
								счета
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								заявл.
								 ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								продажи
								 ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Курс
								продажи
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.0"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								%
								ком
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SKOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								или
								сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Приоритет
								заявки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cbPRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: 
								Приоритет
								заявки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? No
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Create
								If cbPRIORITY.Init(hWndItem)
									Call cbPRIORITY.Populate(hSql(), "id", "name", " zay_priority "," where active = 1 order by id")
							On SAM_AnyEdit
								Set PRIORITY = cbPRIORITY.GetKey(SalListQuerySelection(cbPRIORITY))
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC для
								зачисления
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: META
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Цель
								продажи
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: COVERED
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: COMM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Коментарий
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OPT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On UM_Create
						                                                                                                         Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Delete
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYV.tbl2, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYV.tbl2, nNextRow)
							If SalMessageBox('Вы уверены, что хотите возвратить заявку клиента '||ZAYV.tbl2.NMK||
									                 ' на продажу '||SalStrTrimX(ZAYV.tbl2.S2s)||'/'||Str(ZAYV.tbl2.KV1)||'?' ,
									                 'Сторно заявок', 
									                  MB_IconQuestion | MB_YesNo) = IDYES
								Set sStornoReasonId = ''
								Set sStornoReason = ''
								If FunNSIGet('ZAY_BACK', '', sStornoReasonId,  sStornoReason)
									If sStornoReasonId AND sStornoReason
										Set nStornoReasonId = Val(sStornoReasonId)
										If SqlPrepareAndExecute(hSql(),
												  "UPDATE zayavka 
												      SET viza   = -1, 
												          idback = :nStornoReasonId 
												    WHERE dk = 2 
												      AND id = :ZAYV.tbl2.ID")
											Call SqlCommit(hSql())
											Call SaveInfoToLog("ZAY. Отказано в визе заявке № "||Str(ZAYV.tbl2.ID)
													                 ||" клиента "                     ||Str(ZAYV.tbl2.RNK)
													                 ||" на продажу "                  ||SalStrTrimX(ZAYV.tbl2.S2s)
													                 ||"/"                             ||Str(ZAYV.tbl2.KV1)
													                 ||". Код причины - "              ||sStornoReasonId)
											! Call SalTblDefineSplitWindow(ZAYV.tbl2, 0, FALSE)
										Else
											Call SqlRollback(hSql())
											Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию',
													                   'Сторно заявок. Ошибка', 
													                    MB_IconStop)
									Else
										Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию',
												                   'Сторно заявок. Ошибка', 
												                    MB_IconStop)
								Else
									Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию',
											                    'Сторно документов. Ошибка', 
											                     MB_IconStop)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strDSql =
								   "SELECT v.kv2,           v.dk,            v.id,             v.fdat, 
								           v.rnk,           v.nmk,  v.cust_branch,     v.s2,             v.kurs_z, 
								           v.acc0,          v.nls_acc0,          v.mfo0,           v.okpo0, 
								           v.acc1,          v.nls,           v.ostc,           v.dig,
								           v.kom,           v.skom,          SubStr( v.full_meta, 1, 100 ),
								           v.viza,          v.priority,      v.priorname, v.comm,
								           bars_zay.get_request_cover(v.id), v.verify_opt, v.obz
								      INTO :ZAYV.tbl2.KV1,  :ZAYV.tbl2.DK,   :ZAYV.tbl2.ID,    :ZAYV.tbl2.DAT,      
								           :ZAYV.tbl2.RNK,  :ZAYV.tbl2.NMK, :ZAYV.tbl2.BRANCH,  :ZAYV.tbl2.S2,    :ZAYV.tbl2.KURS_Z,
								           :ZAYV.tbl2.ACC0, :ZAYV.tbl2.NLS0, :ZAYV.tbl2.MFO0,  :ZAYV.tbl2.OKPO0,
								           :ZAYV.tbl2.ACC1, :ZAYV.tbl2.NLS1, :ZAYV.tbl2.S0,    :ZAYV.tbl2.DIG,
								           :ZAYV.tbl2.KOM,  :ZAYV.tbl2.SKOM, :ZAYV.tbl2.META,  
								           :ZAYV.tbl2.VIZA, :ZAYV.tbl2.PRIORITY, :ZAYV.tbl2.cbPRIORITY, :ZAYV.tbl2.COMM,
								           :ZAYV.tbl2.COVERED, :ZAYV.tbl2.OPT, :ZAYV.tbl2.OBZ
								      FROM v_zay_queue v
								     WHERE v.sos          = 0 
								       AND v.dk           = 2
								       AND v.viza        <= 0 
								     ORDER BY v.kv2, v.rnk"
						!
						Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_User
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYV.tbl2, nNextRow, ROW_Selected, 0)
							Call SalTblSetContext(ZAYV.tbl2, nNextRow)
							If F_CHECK_DATA  ( ZAYV.tbl2.DK, 
									                   ZAYV.tbl2.ID, 
									                   ZAYV.tbl2.KV1, 
									                   ZAYV.tbl2.S2, 
									                   ZAYV.tbl2.KURS_Z, 
									                   ZAYV.tbl2.DAT, 
									                   ZAYV.tbl2.OPT)
									AND SET_PRIORITY ( ZAYV.tbl2.ID, 
									                   ZAYV.tbl2.DK,
									                   ZAYV.tbl2.COVERED, 
									                   ZAYV.tbl2.PRIORITY)
								Call SqlPrepareAndExecute(hSql(),
										     "UPDATE zayavka
										         SET viza     = 1, 
										             priority = :ZAYV.tbl2.PRIORITY
										       WHERE dk       = 2 
										         AND id       = :ZAYV.tbl2.ID")
								Call SqlCommit(hSql())
								Call SaveInfoToLog("ZAY. Завизирована заявка № "||Str(ZAYV.tbl2.ID)
										                 ||" клиента "                  ||Str(ZAYV.tbl2.RNK)
										                 ||" на продажу "               ||SalStrTrimX(ZAYV.tbl2.S2s)
										                 ||"/"                          ||Str(ZAYV.tbl2.KV1)
										                 ||", приоритет "               ||Str(ZAYV.tbl2.PRIORITY))
								! Call SalTblDefineSplitWindow(ZAYV.tbl2, 0, FALSE)
						! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						Set S2s = Dig4(S2/100, DIG, 4)
						Set S0s = Dig4(S0/100, DIG, 4)
						!
						If VIZA = -1
							Call SetTblRowColor(ZAYV.tbl2, COLOR_DarkRed)
						! Подсказка о нехватке ВАЛ на счете
						If COVERED = 0
							Call SalTblSetCellTextColor(ZAYV.tbl2.S0s, COLOR_Red, FALSE)
					On UM_Print
						If nPrntSal = -1
							Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
						Else
							Set nNextRow = TBL_MinRow
							While SalTblFindNextRow(ZAYV.tbl2, nNextRow, ROW_Selected, 0)      
								Call SalTblSetContext(ZAYV.tbl2, nNextRow)
								Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV.tbl2.ID)),6)||'.TXT'
								Call ExportCatQuery(nPrntSal,
										                    sFileName,
										                    3,
										                    ":ZAY_ID='"||SalStrTrimX(Str(ZAYV.tbl2.ID))||"'",
										                    FALSE)
								If sFileName != STRING_Null
									Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
											                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
											                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
											                           'Печать сформированной заявки',
											                           MB_IconQuestion|MB_YesNoCancel )
									If nPrint = IDYES
										Call DirectView(sFileName)
									If nPrint = IDNO
										Call DosDirectPrint(sFileName)
		Functions
			Function: F_RESERVE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nIdZay
					Number: nBlk
				Static Variables
				Local variables
					String: sMsg
					Number: nSumB
				Actions
					If nReserve = 0
						Return TRUE
					Else
						If nBlk = 0
							If SalMessageBox('Вы действительно хотите отказаться от блокировки гривны, '||PutCrLf(  )||
									                 'необходимой для покупки валюты по заявке №'||Str(nIdZay)||'?', 
									                 'Внимание', 
									                 MB_IconExclamation|MB_YesNo ) = IDNO
								Return FALSE
							Else
								Call SaveInfoToLog('ZAY. Пользователь отказался от блокировки гривны, необходимой на покупку валюты по заявке №'||Str(nIdZay))
								Return TRUE
						Else
							If SqlPLSQLCommand(hSql(), "p_zay_reserve(1,nIdZay,nSumB,sMsg)")
								If sMsg != STRING_Null AND nSumB = 0
									Call MessageInfo(sMsg)
									Return FALSE
								Else
									Return TRUE
							Else
								Return FALSE
			Function: F_CHECK_DATA
				Description:
				Returns
					Boolean:
				Parameters
					Number: nBuySell
					Number: nId
					Number: nCurrency
					Number: nAmount
					Number: nRate
					Date/Time: dDate
					Number: nOpt
				Static Variables
				Local variables
					String: sMsg
				Actions
					! валюта не заблокирована дилером
					If not BKL_KV(nCurrency)
						Return FALSE
					! сумма заявки
					If nAmount = 0 OR nAmount = NUMBER_Null 
						Call SalMessageBox('Не указана сумма заявки № '||Str(nId)||'!', 
								                   'Заявка не может быть завизирована', 
								                    MB_IconExclamation)
						Return FALSE
					! дата заявки
					If dDate = DATETIME_Null 
						Call SalMessageBox('Не указана дата заявки № '||Str(nId)||'!',  
								                   'Заявка не может быть завизирована', 
								                   MB_IconExclamation)
						Return FALSE
					! курс заявки
					If nRate  = 0 OR nRate = NUMBER_Null 
						Set nRate = GetDilerRate (nBuySell, nCurrency, nCurrency)
						If nRate != NUMBER_Null AND nRate != 0 
							If SalMessageBox ('Установить предварительный курс дилера  '||Str(nRate)||
									                  ' для заявки №'||Str(nId)||'?', 
									                  'Внимание', 
									                  MB_IconExclamation|MB_YesNo) = IDYES
								If nBuySell = 1 
									Set ZAYV.tbl.KURS_Z = nRate
								Else
									Set ZAYV.tbl2.KURS_Z = nRate
								If SqlPrepareAndExecute(hSql(), 
										     "UPDATE zayavka SET kurs_z =:nRate WHERE id = :nId")
									Call SqlCommitEx(hSql(), 'ГОУ. Пользователь установил курс '||Str(nRate)||' для заявки № '||Str(nId))
								Else
									Call SqlRollbackEx(hSql(), 'ГОУ. Пользователь не смог установить курс для заявки № '||Str(nId))
									Return FALSE
							Else
								Return FALSE
						Else
							Call SalMessageBox('Не указан курс заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                   MB_IconExclamation)
							Return FALSE
					If nBuySell = 1
						! цель заявки
						If nOpt = 1
							If NOT ZAYV.tbl.D1 
								Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							! основание для покупки валюты
							If NOT ZAYV.tbl.D7 
								Call SalMessageBox('Не указано основание для покупки валюты заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV.tbl.P12_2C 
								Call SalMessageBox('Не указан код показателя #2C для покупки валюты заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							! код товарной группы
							! If NOT ZAYV.tbl.DB 
								                                                                                                     Call SalMessageBox('Не указан код товарной группы заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								                                                                                                     Return FALSE
					Else
						! цель заявки
						If SalStrTrimX(ZAYV.tbl2.META) = STRING_Null
							Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                    MB_IconExclamation)
							Return FALSE
					Return TRUE
			Function: SET_PRIORITY
				Description:
				Returns
					Boolean:
				Parameters
					Number: pReqId
					Number: pBuySell
					Number: pCoverFl
					Number: pPriorId
				Static Variables
				Local variables
				Actions
					If pCoverFl = 0 AND pPriorId != nCovered AND nCovered > 0
						If SalMessageBox ('Заявка № '||Str(pReqId)||' не обеспечена средствами. '||PutCrLf()||
								                  'Вы действительно хотите завизировать заявку с приоритетом № '||Str(nCovered)||'?',
								                  'Внимание', 
								                   MB_IconExclamation|MB_YesNo) = IDYES
							If pBuySell = 1 
								Set ZAYV.tbl.PRIORITY = nCovered
							Else
								Set ZAYV.tbl2.PRIORITY = nCovered
						Else
							Return FALSE
					Return TRUE
		Window Parameters
		Window Variables
			String: strDSql
			Number: nNextRow
			Number: nPF
			Number: nCovered
			Number: nReserve
			String: sStornoReasonId
			String: sStornoReason
			Number: nStornoReasonId
			!
			Number: nPrntBuy
			Number: nPrntSal
			String: sFileName
			Number: nPrint
			Number: nRet
			File Handle: hFile
			Number: nPR_CORP2
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call SalMapEnterToTab(TRUE)
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set ZAYV.strFilterTblName = 'V_ZAY_QUEUE'
				!
				Call BIRZA( 'PR_CORP2',   nPR_CORP2  )
				If nPR_CORP2 = 1
					Call SalShowWindow(pbPrintZayCorp)
				Else
					Call SalHideWindow(pbPrintZayCorp)
				! Печать заявок
				If SqlPrepareAndExecute(hSql(),
						  "SELECT nvl(max(decode(par, 'PRNT_BUY', to_number(val), null)), -1),
						          nvl(max(decode(par, 'PRNT_SAL', to_number(val), null)), -1)
						     INTO :nPrntBuy, :nPrntSal
						     FROM birja
						    WHERE par in ('PRNT_BUY', 'PRNT_SAL')")
						 and not SqlFetchNext(hSql(), nFetchRes)
					Set nPrntBuy = -1
					Set nPrntSal = -1
				If nPrntBuy = -1 AND nPrntSal = -1
					Call SalDisableWindow(pbPrintZay)
				! Пенсионный Фонд
				If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val)
						     INTO :nPF
						     FROM birja
						    WHERE par = 'PEN_FOND'")
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nPF = 0
				If nPF = 0
					Call SalHideWindow(ZAYV.tbl.MFOP)
					Call SalHideWindow(ZAYV.tbl.NLSP)
					Call SalHideWindow(ZAYV.tbl.OKPOP)
				! Резервирование гривны на покупку валюты
				If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val)
						     INTO :nReserve
						     FROM birja
						    WHERE par = 'RESERV'")
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nReserve = 0
				If nReserve = 1
					Call SalShowWindow(ZAYV.tbl.BLK)
				Else
					Call SalHideWindow(ZAYV.tbl.BLK)
				! Приоритет для гарантированных заявок
				If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val)
						     INTO :nCovered
						     FROM birja
						    WHERE par = 'COVERED'")
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nCovered = 0
				!
				Set ZAYV.strSqlPopulate =
						   "SELECT v.kv2,          v.dk,           v.id,            v.fdat,
						           v.rnk,          v.nmk,  v.cust_branch,   v.s2,   v.kurs_z,
						           v.acc0,         v.nls_acc0,     v.ostc0/100,     v.okpo0,
						           v.acc1,         v.nls,          v.kom,           v.skom,
						           v.mfop,         v.nlsp,         v.okpop,         v.dig,
						           SubStr( v.full_meta, 1, 100 ),
						           v.contract,     v.dat2_vmd,     v.dat_vmd,
						           v.dat5_vmd,     trim(c.country||' '||c.name),    substr(k7.p63||' '||k7.txt,1,150), bc.name,
						           v.bank_code,    v.bank_name,    SubStr( full_product_group, 1, 100 ), v.num_vmd,
						           v.viza,         v.priority,     v.priorname,  v.comm,
						           bars_zay.get_request_cover(v.id), v.verify_opt, v.identkb, v.code_2c, v.p12_2c
						      INTO :ZAYV.tbl.KV1,  :ZAYV.tbl.DK,   :ZAYV.tbl.ID,    :ZAYV.tbl.DAT,
						           :ZAYV.tbl.RNK,  :ZAYV.tbl.NMK, :ZAYV.tbl.BRANCH,  :ZAYV.tbl.S2,    :ZAYV.tbl.KURS_Z,
						           :ZAYV.tbl.ACC0, :ZAYV.tbl.NLS0, :ZAYV.tbl.S0,    :ZAYV.tbl.OKPO0,
						           :ZAYV.tbl.ACC1, :ZAYV.tbl.NLS1, :ZAYV.tbl.KOM,   :ZAYV.tbl.SKOM,
						           :ZAYV.tbl.MFOP, :ZAYV.tbl.NLSP, :ZAYV.tbl.OKPOP, :ZAYV.tbl.DIG,
						           :ZAYV.tbl.DV1,  :ZAYV.tbl.DV2,  :ZAYV.tbl.DV3,   :ZAYV.tbl.DV4,
						           :ZAYV.tbl.DV5,  :ZAYV.tbl.DV6,  :ZAYV.tbl.DV7,   :ZAYV.tbl.DV8,
						           :ZAYV.tbl.DV9,  :ZAYV.tbl.DVA,  :ZAYV.tbl.DVB,   :ZAYV.tbl.DVC,
						           :ZAYV.tbl.VIZA, :ZAYV.tbl.PRIORITY, :ZAYV.tbl.cbPRIORITY, :ZAYV.tbl.COMM,
						           :ZAYV.tbl.COVERED, :ZAYV.tbl.OPT, :ZAYV.tbl.KB, :ZAYV.tbl.Code2c, :ZAYV.tbl.P12_2C
						      FROM v_zay_queue v,
						           country     c,
						           country     bc, v_kod_70_2 k7
						     WHERE v.sos          = 0
						       AND v.dk           = 1
						       AND v.viza        <= 0
						       AND v.country      = c.country(+)
						       AND v.benefcountry = bc.country(+)
						       AND v.basis = k7.p63(+)
						     ORDER BY v.kv2, v.rnk"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call SalSendMsg(tbl2, UM_Populate, 0, 0)
			On SAM_RowSetContext
				If ZAYV.tbl.KB != STRING_Null
					Call SalEnableWindow(pbPrintZayCorp)
				Else
					Call SalDisableWindow(pbPrintZayCorp)
	Form Window: ZAYK
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name: vti11.dll;0;3145728;;;
		Title: Визирование установленных Дилером курсов
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.967"
				Width Editable? Yes
				Height: 6.095"
				Height Editable? Yes
			Form Size
				Width:  -1.0"
				Height: -1.0"
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Визирование установленных дилером курсов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.427"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.133"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть'
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg( ZAYK.tbl, UM_Delete, 0, 0 )
								Call SalSendMsg( ZAYK.tbl2,UM_Delete, 0, 0 )
								Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завизировать'
						On SAM_Click
							If MessageQuestion('Будут визированы все отмеченные заявки. Продолжить ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg( ZAYK.tbl, SAM_User, 0, 0 )
								Call SalSendMsg( ZAYK.tbl2, SAM_User, 0, 0 )
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 29475
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  1.583"
						Begin Y:  0.417"
						End X:  1.583"
						End Y:  0.0"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.133"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.06"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.123"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call TableToText(tbl, 'Покупка валюты',' ', GetPrnDir() || '\\' || ZAYK.strPrintFileName, '')
							Call TableToText(tbl2, 'Продажа валюты',' ', '>'||GetPrnDir() || '\\' || ZAYK.strPrintFileName, '')
				Line
					Resource Id: 29476
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.133"
						Begin Y:  0.417"
						End X:  3.133"
						End Y:  0.0"
					Visible? No
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.867"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 29477
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  2.717"
						Begin Y:  0.44"
						End X:  2.717"
						End Y:  0.024"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbEqv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\ACCOUNTS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '(не)Показывать эквиваленты'
						On SAM_Click
							If SalShowWindow( ZAYK.tbl.S980s )
								Call SalHideWindow( ZAYK.tbl.S980s )
							Else
								Call SalShowWindow( ZAYK.tbl.S980s )
							!
							If SalShowWindow( ZAYK.tbl2.S980s )
								Call SalHideWindow( ZAYK.tbl2.S980s )
							Else
								Call SalShowWindow( ZAYK.tbl2.S980s )
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name: vti11.dll
				Display Settings
					DLL Name: vti11.dll
					MS Windows Class Name: VT:cSplitter:10
					Style:  0x00000000
					ExStyle:  0x00000000
					Title: cSplitter
					Window Location and Size
						Left:   0.0"
						Top:    2.238"
						Width:  0.075"
						Width Editable? No
						Height: 0.063"
						Height Editable? No
					Visible? Yes
					Border? No
					Etched Border? No
					Hollow? No
					Vertical Scroll? No
					Horizontal Scroll? No
					Tab Stop? None
					Tile To Parent? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  9.983"
						Width Editable? Yes
						Height: 2.238"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.967"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: nPRIOR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.483"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПОКУПКИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S980s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ГРН Эквивалент
								суммы ПОКУПКИ
								(по курсу дилера)
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.0"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  0.95"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_F
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								дилера
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: О
								т
								м
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.35"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								валюти-
								рования
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.133"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Признак оплаты с ГОУ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VIZA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Delete
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYK.tbl, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYK.tbl, nNextRow)
							Call SqlPrepareAndExecute(cMain.hSql(), 
									    "UPDATE zayavka 
									        SET sos          = 0
									      WHERE dk           = 2 
									        AND sos          = 0.5
									        AND to_char(kv2) = :ZAYK.tbl.KV1  
									        AND priority     = :ZAYK.tbl.nPRIOR
									        AND kurs_z       = :ZAYK.tbl.KURS_Z
									        AND fdat         = :ZAYK.tbl.DAT
									        AND kurs_f       = :ZAYK.tbl.KURS_F
									        AND viza         = :ZAYK.tbl.VIZA")
							Call SqlCommit(cMain.hSql())
							Call SaveInfoToLog("ZAY. Отклонена сводная заявка на продажу "
									                 ||SalStrTrimX(ZAYK.tbl.S2s)
									                 ||" "
									                 ||ZAYK.tbl.ISO
									                 ||" по курсу "
									                 ||Str(ZAYK.tbl.KURS_F))
							Call SalTblDefineSplitWindow(ZAYK.tbl, 0, FALSE)
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_User
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYK.tbl, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYK.tbl, nNextRow)
							Call SqlPrepareAndExecute( cMain.hSql(), 
									    "UPDATE zayavka 
									        SET sos          = 1 
									      WHERE dk           = 2 
									        AND sos          = 0.5
									        AND to_char(kv2) = :ZAYK.tbl.KV1
									        AND priority     = :ZAYK.tbl.nPRIOR
									        AND kurs_z       = :ZAYK.tbl.KURS_Z
									        AND fdat         = :ZAYK.tbl.DAT
									        AND kurs_f       = :ZAYK.tbl.KURS_F
									        AND viza         = :ZAYK.tbl.VIZA")
							Call SqlCommit(cMain.hSql())
							Call SaveInfoToLog("ZAY. Удовлетворена сводная заявка на продажу "
									                 ||SalStrTrimX(ZAYK.tbl.S2s)
									                 ||" "
									                 ||ZAYK.tbl.ISO
									                 ||" по курсу "
									                 ||Str(ZAYK.tbl.KURS_F))
							Call SalTblDefineSplitWindow(ZAYK.tbl, 0, FALSE)
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						Set S2s = Dig4(S2/100, DIG, 4)
						If VIZA=-2 AND SOS=0
							Call SetTblRowColor( ZAYK.tbl, COLOR_DarkRed )
						If NOT SalIsNull(KURS_F)
							Set S980s=S2*KURS_F/100
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.017"
						Top:    2.321"
						Width:  10.383"
						Width Editable? Yes
						Height: 2.56"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: DK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пок
								Прод
						Visible? No
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  0.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ISO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								ВАЛ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Left
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRIORITY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прио
								ритет
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: nPRIOR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма ВАЛ
								ПРОДАЖИ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S980s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ГРН Эквивалент
								суммы ПРОДАЖИ
								(по курсу дилера)
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.0"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  0.95"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_F
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								дилера
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: О
								т
								м
						Visible? No
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Left
						Width:  0.35"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								валюти-
								рования
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.133"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Признак оплаты с ГОУ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VIZA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, FALSE)
					On UM_Delete
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYK.tbl2, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYK.tbl2, nNextRow)
							Call SqlPrepareAndExecute( hSql(), 
									    "UPDATE zayavka 
									        SET sos          = 0 
									      WHERE dk           = 1 
									        AND sos          = 0.5
									        AND to_char(kv2) = :ZAYK.tbl2.KV1 
									        AND priority     = :ZAYK.tbl2.nPRIOR
									        AND kurs_z       = :ZAYK.tbl2.KURS_Z
									        AND fdat         = :ZAYK.tbl2.DAT
									        AND kurs_f       = :ZAYK.tbl2.KURS_F
									        AND viza         = :ZAYK.tbl2.VIZA")
							Call SqlCommit(hSql())
							Call SaveInfoToLog("ZAY. Отклонена сводная заявка на покупку "
									                 ||SalStrTrimX(ZAYK.tbl2.S2s)
									                 ||" "
									                 ||ZAYK.tbl2.ISO
									                 ||" по курсу "
									                 ||Str(ZAYK.tbl2.KURS_F))
							Call SalTblDefineSplitWindow(ZAYK.tbl2, 0, FALSE)
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strDSql =
								   "SELECT dk, sos, sum(s2),
								           kv2, lcv, dig, 
								           fdat, kurs_z,
								           vdate, kurs_f,
								           viza, priority, priorname
								     INTO  :ZAYK.tbl2.DK,    :ZAYK.tbl2.SOS,    :ZAYK.tbl2.S2,
								           :ZAYK.tbl2.KV1,   :ZAYK.tbl2.ISO,    :ZAYK.tbl2.DIG,  
								           :ZAYK.tbl2.DAT,   :ZAYK.tbl2.KURS_Z,
								           :ZAYK.tbl2.VDATE, :ZAYK.tbl2.KURS_F,
								           :ZAYK.tbl2.VIZA,  :ZAYK.tbl2.nPRIOR, :ZAYK.tbl2.PRIORITY 
								      FROM v_zay_queue 
								     WHERE dk  = 1  
								       AND sos = 0.5
								       AND s2  > 0 
								       AND kurs_z IS NOT NULL 
								     GROUP BY dk, sos, kv2, lcv, dig, fdat, kurs_z, 
								              vdate, kurs_f, viza, priority, priorname
								     ORDER BY fdat, kv2, priority desc, kurs_z, sos"
						Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_User
						Set nNextRow = TBL_MinRow
						While SalTblFindNextRow(ZAYK.tbl2, nNextRow, ROW_Selected, 0)      
							Call SalTblSetContext(ZAYK.tbl2, nNextRow)
							Call SqlPrepareAndExecute( hSql(), 
									    "UPDATE zayavka 
									        SET sos          = 1 
									      WHERE dk           = 1 
									        AND sos          = 0.5
									        AND to_char(kv2) = :ZAYK.tbl2.KV1
									        AND priority     = :ZAYK.tbl2.nPRIOR
									        AND kurs_z       = :ZAYK.tbl2.KURS_Z
									        AND fdat         = :ZAYK.tbl2.DAT
									        AND kurs_f       = :ZAYK.tbl2.KURS_F
									        AND viza         = :ZAYK.tbl2.VIZA")
							Call SqlCommit(hSql())
							Call SaveInfoToLog("ZAY. Удовлетворена сводная заявка на покупку "
									                 ||SalStrTrimX(ZAYK.tbl2.S2s)
									                 ||" "
									                 ||ZAYK.tbl2.ISO
									                 ||" по курсу "
									                 ||Str(ZAYK.tbl2.KURS_F))
							Call SalTblDefineSplitWindow(ZAYK.tbl2, 0, FALSE)
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						Set S2s = Dig4(S2/100, DIG, 4)
						If VIZA=-3
							Call SetTblRowColor( ZAYK.tbl2, COLOR_DarkRed )
						If NOT SalIsNull(KURS_F)
							Set S980s=S2*KURS_F/100
		Functions
		Window Parameters
		Window Variables
			String: strDSql
			Date/Time: dDATA
			String: sdat
			String: sdatDDMM
			Number: nNextRow
			Number: nI
			Number: nPF
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call PrepareWindow(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Set dDATA=GetBankDate()
				Set sdat=SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
				Set sdatDDMM=SalStrMidX( sdat, 3, 2 )||SalStrMidX( sdat, 0, 2 )
				Set ZAYK.strPrintFileName='LIST'||sdatDDMM||'.TXT'
				Call SalHideWindow( ZAYK.tbl.S980s )
				Call SalHideWindow( ZAYK.tbl2.S980s )
				!
				Set ZAYK.strSqlPopulate =
						   "SELECT dk, sos, sum(s2),
						           kv2, lcv, dig, 
						           fdat, kurs_z, 
						           vdate, kurs_f,  
						           viza, priority, priorname
						      INTO :ZAYK.tbl.DK,    :ZAYK.tbl.SOS,    :ZAYK.tbl.S2,    
						           :ZAYK.tbl.KV1,   :ZAYK.tbl.ISO,    :ZAYK.tbl.DIG, 
						           :ZAYK.tbl.DAT,   :ZAYK.tbl.KURS_Z, 
						           :ZAYK.tbl.VDATE, :ZAYK.tbl.KURS_F,
						           :ZAYK.tbl.VIZA,  :ZAYK.tbl.nPRIOR, :ZAYK.tbl.PRIORITY 
						      FROM v_zay_queue
						     WHERE dk  = 2 
						       AND sos = 0.5 
						       AND s2  > 0 
						       AND kurs_z IS NOT NULL 
						     GROUP BY dk, sos, kv2, lcv, dig, fdat, kurs_z, 
						              vdate, kurs_f, viza, priority, priorname 
						     ORDER BY fdat, kv2, priority desc, kurs_z, sos"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: ZAY_DEBT
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: ОБЯЗАТЕЛЬНАЯ продажа валюты клиентов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.333"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Обязательная продажа валюты
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.05"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CHKMAIL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip='Просмотреть заявки, полученные по системе Клиент-Банк'
						On SAM_Click
							Call SalModalDialog(dlgZAY_KB,ZAY_DEBT,0,0,0,nTmp,sTmp,sTmp)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.643"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Снять с контроля'
						On SAM_Click
							If SalMessageBox('Вы действительно хотите снять с контроля документ на сумму '||SalNumberToStrX(ZAY_DEBT.SUM,2)||' '||ZAY_DEBT.ISO||' ?','Внимание',MB_YesNo|MB_IconQuestion)=IDYES
								If SqlPrepareAndExecute(hSqlAux2(),"UPDATE zay_debt SET sos=1 WHERE ref=:ZAY_DEBT.REF") 
									Call SqlCommit(hSqlAux2())
								Else
									Call SqlRollback(hSqlAux2())
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.522"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53548
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.383"
						Begin Y:  -0.012"
						End X:  6.383"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.95"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.771"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip='Просмотреть документ'
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								Call DocViewContentsEx(hWndMDI,REF)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.82"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53549
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.683"
						Begin Y:  -0.012"
						End X:  5.683"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.817"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53550
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.383"
						Begin Y:  -0.012"
						End X:  2.383"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.925"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\arr2tol.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Зачислить на расч.счет
							Set strTip = 'Не підлягає обов. продажу'
						On SAM_Click
							If ( SALE_TP = 1 )
								If SalMessageBox( 'Виконати зарахування суми ' || SalNumberToStrX(ZAY_DEBT.S2, 2) || ' ' || ZAY_DEBT.ISO || PutCrLf() ||
										                  ' на рахунок клієнта ' || ZAY_DEBT.NMK || '?'
										                , 'Увага!'
										                , MB_YesNo | MB_IconQuestion ) = IDYES
									Call F_ZAYDEBT( 1, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF
											              , ZAY_DEBT.S1  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.S2  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.SUM * SalNumberPower(10,ZAY_DEBT.DIG) )
								Else
									Call SalMessageBox( "Не відповідає ознаці!"
											                  , "Помилка"
											                  , MB_Ok | MB_IconStop )
							! If NOT SalIsNull(ZAY_DEBT.S2) AND ZAY_DEBT.S2 != 0
								                                            If SalMessageBox('Вы действительно хотите зачислить ' || SalNumberToStrX(ZAY_DEBT.S2, 2) || ' ' || ZAY_DEBT.ISO || PutCrLf() ||
										   'на расчетный счет ' || ZAY_DEBT.NMK || ' ?',
										   'Внимание', MB_YesNo | MB_IconQuestion) = IDYES
									                                            Call F_ZAYDEBT(1, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, 0,
											     ZAY_DEBT.S2*SalNumberPower(10,ZAY_DEBT.DIG),
											     ZAY_DEBT.SUM*SalNumberPower(10,ZAY_DEBT.DIG))
				Pushbutton: pb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.5"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\arr1tod.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: 3D Face Color
					Message Actions
						On SAM_Create
							! Оформить заявку + Зачислить на расч.счет
							Set strTip = 'Підлягає обов. продажу-розподіл суми'
						On SAM_Click
							If ( SALE_TP = 2 )
								If SalMessageBox( 'Виконати продаж суми ' || SalNumberToStrX(ZAY_DEBT.S1, 2) || ' ' || ZAY_DEBT.ISO || '?'
										                , 'Увага!'
										                , MB_YesNo | MB_IconQuestion ) = IDYES
									Call F_ZAYDEBT( 2, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF
											              , ZAY_DEBT.S1  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.S2  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.SUM * SalNumberPower(10,ZAY_DEBT.DIG) )
							Else
								Call SalMessageBox( "Не відповідає ознаці!"
										                  , "Помилка"
										                  , MB_Ok | MB_IconStop )
							! If NOT SalIsNull(ZAY_DEBT.S2) and ZAY_DEBT.S2 != 0
								                                            If SalMessageBox('Вы действительно хотите ' || PutCrLf() ||
										   '       сформировать заявку на продажу ' || SalNumberToStrX(ZAY_DEBT.S1,2) || ' ' || ZAY_DEBT.ISO || ' и ' || PutCrLf() ||
										   '       зачислить ' || SalNumberToStrX(ZAY_DEBT.S2,2) || ' ' || ZAY_DEBT.ISO || ' на расчетный счет ' || ZAY_DEBT.NMK || ' ?',
										   'Внимание', MB_YesNo | MB_IconQuestion) = IDYES
									                                            Call F_ZAYDEBT(2, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF,
											     ZAY_DEBT.S1*SalNumberPower(10,ZAY_DEBT.DIG),
											     ZAY_DEBT.S2*SalNumberPower(10,ZAY_DEBT.DIG),
											     ZAY_DEBT.SUM*SalNumberPower(10,ZAY_DEBT.DIG))
				Pushbutton: pbChild
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.2"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: 3D Face Color
					Message Actions
						On SAM_Create
							Set strTip = 'Показать связанные документы'
						On SAM_Click
							If not SalIsNull(REF)
								Call DocViewListInt(hWndMDI," a.ref IN (SELECT refd FROM zay_debt WHERE refd<>ref AND ref="||Str(ZAY_DEBT.REF)|| ")","Связанные документы для Реф."||Str(ZAY_DEBT.REF))
				! ctb_pbSwitch: pbChild
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.2"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: D:\BARS98\RESOURCE\BMP\arr2tol.BMP
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                                                                                  Message Actions 
						                                                                                                                  On SAM_Create
							                                                                                                                  Set strTip = 'Показать связанные документы'
						                                                                                                                  On SAM_Click
							                                                                                                                  If not SalIsNull(REF)
								                                                                                                                  Call DocViewListInt(hWndMDI," a.ref IN (SELECT refd FROM zay_debt WHERE refd<>ref AND ref="||Str(ZAY_DEBT.REF)|| ")","Связанные документы для Реф."||Str(ZAY_DEBT.REF))
				Pushbutton: pbZAY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\arr2tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Оформить заявку на ОБЯЗАТЕЛЬНУЮ продажу
							Set strTip = '100% підлягає обов. продажу'
						On SAM_Click
							If ( SALE_TP = 3 )
								If SalMessageBox( 'Виконати обов. продаж суми ' || SalNumberToStrX(ZAY_DEBT.S1, 2) || ' ' || ZAY_DEBT.ISO || '?'
										                , 'Увага!'
										                , MB_YesNo | MB_IconQuestion ) = IDYES
									Call F_ZAYDEBT( 3, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF
											              , ZAY_DEBT.S1  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.S2  * SalNumberPower(10,ZAY_DEBT.DIG)
											              , ZAY_DEBT.SUM * SalNumberPower(10,ZAY_DEBT.DIG) )
								Else
									Call SalMessageBox( "Не відповідає ознаці!"
											                  , "Помилка"
											                  , MB_Ok | MB_IconStop )
							! If TIP = 2 AND ZAY = 0
								                                            Set nZAYSUM = SUM-ZAY_SUM-F_PAY_F(REF)
								                                            If nZAYSUM > 0
									                                            If SalMessageBox('Вы действительно хотите сформировать ' || PutCrLf() ||
											   'заявку на ОБЯЗАТЕЛЬНУЮ продажу на СВОБОДНУЮ сумму валюты ' || PutCrLf() ||
											   'клиента ' || ZAY_DEBT.NMK || ' ?',
											   'Внимание', MB_YesNo | MB_IconQuestion) = IDYES
										                                            Call SalModalDialog(dlgSUM, ZAY_DEBT, ZAY_DEBT.nZAYSUM, ZAY_DEBT.nZAYSUM0)
										                                            If nZAYSUM0 > 0
											                                            Call F_ZAYDEBT(3, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF,
													     ZAY_DEBT.nZAYSUM0*SalNumberPower(10,ZAY_DEBT.DIG), 0,
													     ZAY_DEBT.SUM*SalNumberPower(10,ZAY_DEBT.DIG))
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование 
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № счета
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						поступл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						док.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Граничн.
						дата 
						(1 дн.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.033"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Без
						50%
						прод.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 2
						Ignore Case? No
				List Values
				Message Actions
					On SAM_AnyEdit
						If TIP = 1 
							! VIP-клиент: вся сумма на 2600
							If ZAY = 0
								Set S1 = NUMBER_Null
								Set S2 = SUM-F_PAY_F(REF)
							Call SalDisableWindow(pb2)
							Call SalDisableWindow(pbZAY)
						Else
							If FLAG_NEW
								Set S1 = (SalNumberRound(SUM*nOBZ_Proc/100 * 100)) / 100
								Set S2 = SUM - S1
								Call SalEnableWindow(pb2)
								Call SalEnableWindow(pbZAY)
							Else
								If ZAY = 0
									Set S1 = (SalNumberRound(SUM*nOBZ_Proc/100 * 100)) / 100
									Call SalEnableWindow(pbZAY)
								Else
									Set S1 = ZAY_SUM
									Call SalDisableWindow(pbZAY)
								Set S2 = IifN(REFD!=NUMBER_Null, 0, SUM - S1 - F_PAY_F(REF))
			Column: ZAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заявка
						
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зая-
						вка
						КБ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: S1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						обязат.
						продажи
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S1s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						обязат.
						продажи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						для зачисл.
						на 2600
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SalIsNull(TIP) OR TIP=2
							If S2>SUM-S1-F_PAY_F(REF)
								Call SalMessageBox( 'Указанная сумма превышает допустимую!', 'Внимание', MB_IconStop )
								Return VALIDATE_OkClearFlag
							Else
								Return VALIDATE_Ok
						Else
							If S2>SUM-F_PAY_F(REF)
								Call SalMessageBox( 'Указанная сумма превышает допустимую!', 'Внимание', MB_IconStop )
								Return VALIDATE_OkClearFlag
							Else
								Return VALIDATE_Ok
			Column: S2s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						для зачисл.
						на 2600
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: День
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: dig
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ZAY_SUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FLAG_NEW	! признак нового необработанного документа
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SALE_TP         ! Ід. ознаки обов. продажу
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід. ознаки
						обов.
						продажу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  1.417"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SALE_TP_NM      ! Назва ознаки обов. продажу
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ознака
						обов.
						продажу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_ZAYDEBT
				Description: Процедура оплаты
				Returns
				Parameters
					Number: nMod
					Number: nAcc
					Number: nKv
					Number: nRef
					Number: nSum1
					Number: nSum2
					Number: nSumOper
				Static Variables
				Local variables
					Number: nS
					Number: nBLK
					Number: nFetchRes
					Number: nTIP
					String: d27_1
					String: d27_2
					String: sNAZN
					Number: nSUMKB
					String: sFNAMEKB
					String: sIDKB
					Number: nOBZ_1919
				Actions
					Set sNAZN = ''
					! Если есть заявки, поступившие по КБ, привяжем их
					If KB=1
						Call SalMessageBox('Необходимо выбрать заявку, поступившую по системе Клиент-Банк!', 'Внимание', MB_IconExclamation)
						Call SalModalDialog(dlgZAY_KB, ZAY_DEBT, 1, ZAY_DEBT.RNK, ZAY_DEBT.KV, nSUMKB, sFNAMEKB, sIDKB)
						! If nSUMKB=NUMBER_Null OR nSUMKB!=nSum1
							                                                                                                                                                                                                   Call SalMessageBox('Суммы не совпадают!', 'Ошибка!', MB_IconStop)
							                                                                                                                                                                                                   Return 0
						! Сумма заявки = Сумме заявки, поступившей по КБ
						If nSUMKB = NUMBER_Null
							Call SalMessageBox('Не выбрана заявка!', 'Ошибка!', MB_IconStop)
							Return 0
						If nSUMKB > nSum1
							Call SalMessageBox('Сумма заявки превышает макс.допустимую!', 'Ошибка!', MB_IconStop)
							Return 0
						Else
							Set nSum1 = nSUMKB
					!
					! Ввод доп.реквизитов для D#27 и корректировка назначения платежа
					! 1 - продажа 
					! 2 - зачисление на 2600
					! 3 - продажа + зачисление на 2600
					! 0 - зачисление на 2600 ГРН
					If SqlPrepareAndExecute(hSql(),"SELECT nazn INTO :sNAZN FROM oper WHERE ref=:nRef") 
						Call SqlFetchNext( hSql(), nFetchRes )
					If nKv = GetBaseVal(  )
						Set nTIP = 0
					Else
						If nSum1 != 0
							If nSum2 != 0
								Set nTIP = 3
							Else
								Set nTIP = 1
						Else
							Set nTIP = 2
					Call BIRZA( 'OBZ_1919',   nOBZ_1919  )
					If nOBZ_1919 != 1
						If not SalModalDialog( dlgD27, ZAY_DEBT, nTIP, d27_1, d27_2, sNAZN)
							Return FALSE
					Call SalWaitCursor(TRUE)
					If SqlPLSQLCommand(hSql(), "BARS.P_ZAYDEBT(nMod,nAcc,nRef,nSum1,nSum2,d27_1,d27_2,sFNAMEKB,sIDKB,sNAZN, nSumOper)")
						Call SqlCommit(hSql())
						Call SalWaitCursor(FALSE)
					Else
						Call SqlRollback(hSql())
						Call SalWaitCursor(FALSE)
						Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'BARS.P_ZAYDEBT', 30, 1 )
					Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					Call SalWaitCursor(FALSE)
			Function: F_PAY_F
				Description: Вычисление выплат(sos>0) по данному РЕФ
				Returns
					Number:
				Parameters
					Number: nRef
				Static Variables
				Local variables
					Number: nSP
					Number: nT
				Actions
					Set nSP = 0
					If nRef != NUMBER_Null
						! Ищем сумму проплат по данному документу
						! If SqlPrepareAndExecute(hSqlAux2(), "
								SELECT sum(o.s)/power(10,t.dig) INTO :nSP
								  FROM zay_debt z, oper o, oper o2, tabval t
								 WHERE z.ref  = :nRef
								   AND z.ref <> z.refd
								   AND z.refd = o.ref  AND o.sos > 0
								   AND z.ref  = o2.ref AND o2.kv = t.kv
								 GROUP BY t.dig") 
								AND not SqlFetchNext(hSqlAux2(), nFetchRes)
							                                                              Set nSP = 0
						If SqlPrepareAndExecute(hSqlAux2(), "
								SELECT o.s/power(10,t.dig) INTO :nSP
								  FROM zay_debt z, oper o, oper o2, tabval t
								 WHERE z.ref  = :nRef
								   AND z.ref <> z.refd
								   AND z.refd = o.ref  AND o.sos > 0
								   AND z.ref  = o2.ref AND o2.kv = t.kv") 
								AND not SqlFetchNext(hSqlAux2(), nFetchRes)
							Set nSP = 0
					Return nSP
			! Function: F_ZAY_F
				                                                              Description: Вычисление заявок по данному РЕФ
				                                                              Returns 
					                                                              Number: 
				                                                              Parameters 
					                                                              Number: nRef
				                                                              Static Variables 
				                                                              Local variables 
					                                                              Number: nSP
				                                                              Actions 
					                                                              Set nSP = 0
					                                                              If nRef != NUMBER_Null
						! Ищем сумму заявок по данному документу
						                                                              If SqlPrepareAndExecute(hSqlAux2(), "
								SELECT z.zay_sum/power(10,t.dig) INTO :nSP
								  FROM zay_debt z, oper o, tabval t 
								 WHERE z.ref = :nRef
								   AND z.ref = z.refd AND z.tip = 2
								   AND z.ref = o.ref  AND o.kv = t.kv" ) 
								AND not SqlFetchNext(hSqlAux2(), nFetchRes)
							                                                              Set nSP = 0
					                                                              Return nSP
			Function: F_COLOR
				Description:
				Returns
				Parameters
					Number: nCOLOR
				Static Variables
				Local variables
				Actions
					Call SalTblSetCellTextColor( ISO, nCOLOR, FALSE )
					Call SalTblSetCellTextColor( RNK, nCOLOR, FALSE )
					Call SalTblSetCellTextColor( NMK, nCOLOR, FALSE )
					Call SalTblSetCellTextColor( NLS, nCOLOR, FALSE )
					Call SalTblSetCellTextColor( VDAT,nCOLOR, FALSE )
					Call SalTblSetCellTextColor( REF, nCOLOR, FALSE )
					Call SalTblSetCellTextColor( SUM, nCOLOR, FALSE )
		Window Parameters
		Window Variables
			Date/Time: dDATA
			Number: nZAYSUM
			Number: nZAYSUM0
			Number: nFetchRes
			Number: nTmp
			String: sTmp
			Number: nMaxDig
			Number: nOBZ_1919
			Number: nOBZ_Proc
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize( hWndForm )
				Call SalSetWindowText( hWndForm, "Обов'язковий продаж валютних надходжень клієнтів (вер." || sLibVersion||")" )
				Call SalMapEnterToTab(TRUE)
				Set ZAY_DEBT.nTabInstance = 1
				Set ZAY_DEBT.strPrintFileName = 'ZAY_DEBT'
				Set ZAY_DEBT.fFilterAtStart = TRUE
				Set dDATA = GetBankDate()
				Call BIRZA('OBZ_1919', nOBZ_1919) !! Подбор 1919 в ОБЗ продаже
				If nOBZ_1919 = 1
					Set ZAY_DEBT.strFilterTblName = 'OPER'
					Set ZAY_DEBT.strSqlPopulate =
							"SELECT c.rnk, c.nmk, a.acc, a.kv, t.lcv, a.nls,
							        o.ref, o.s/power(10,t.dig),  o.fdat, dat_next_u(o.fdat,1),
							        t.dig, null as REFD, 0 as ZAY_SUM, 0 as SALE_TP, null as TP_NM
							   INTO :ZAY_DEBT.RNK, :ZAY_DEBT.NMK,
							        :ZAY_DEBT.ACC, :ZAY_DEBT.KV,   :ZAY_DEBT.ISO,     :ZAY_DEBT.NLS,
							        :ZAY_DEBT.REF, :ZAY_DEBT.SUM,  :ZAY_DEBT.VDAT,    :ZAY_DEBT.DAT_5,
							        :ZAY_DEBT.DIG, :ZAY_DEBT.REFD, :ZAY_DEBT.ZAY_SUM, :ZAY_DEBT.SALE_TP, :ZAY_DEBT.SALE_TP_NM
							   FROM accounts a, customer c, opldok o, tabval t
							  WHERE (a.nbs = '2603' or (a.nls,a.kv) in (select nls, kv from v_zay_ndr_1919))
							    AND a.kv <> 980
							    AND a.rnk = c.rnk
							    AND a.kv  = t.kv
							    AND a.acc = o.acc
							    AND o.fdat >= dat_next_u(bankdate,-1) and o.fdat <= bankdate
							    AND o.dk  = 1
							    AND o.sos = 5
							    AND o.ref NOT IN (SELECT DISTINCT ref FROM zay_debt)
							  UNION ALL
							 SELECT c.rnk, c.nmk, a.acc, a.kv, t.lcv, a.nls,
							        oper.ref, decode(oper.dk,1,oper.s2,oper.s)/power(10,t.dig), oper.vdat, dat_next_u(oper.vdat,1),
							        t.dig, z.refd, nvl(z.zay_sum/power(10,t.dig),0), 0, Null
							   FROM accounts a, customer c, tabval t, oper, zay_debt z
							  WHERE (a.nbs='2603' or (a.nls,a.kv) in (select nls, kv from v_zay_ndr_1919))
							    AND a.kv <> 980
							    AND a.rnk = c.rnk
							    AND a.kv  = t.kv
							    AND a.nls = decode(oper.dk,1,oper.nlsb,oper.nlsa)
							    AND a.kv  = decode(oper.dk,1,nvl(oper.kv2,oper.kv),oper.kv)
							    AND oper.sos = 5
							    AND oper.ref = z.ref
							    AND z.sos = 0
							  ORDER BY  4, 1, 9, 7 desc"
				Else
					Set ZAY_DEBT.strFilterTblName = 'V_ZAY_SPLIT_DTL'
					Set ZAY_DEBT.strSqlPopulate =
							"select 1 as FLAG_NEW, sa.RNK, sa.NMK, sa.ACC, sa.KV, sa.LCV, sa.NLS,
							        sa.REF, sa.DOC_AMNT, sa.FDAT, DAT_NEXT_U(sa.FDAT,1),
							        sa.DIG, NULL as REFD, SPLIT_AMNT as ZAY_SUM, sa.SALE_TP, st.TP_NM,
							        sa.DAY_QTY
							   INTO :ZAY_DEBT.FLAG_NEW, :ZAY_DEBT.RNK,  :ZAY_DEBT.NMK,
							        :ZAY_DEBT.ACC,      :ZAY_DEBT.KV,   :ZAY_DEBT.ISO,     :ZAY_DEBT.NLS,
							        :ZAY_DEBT.REF,      :ZAY_DEBT.SUM,  :ZAY_DEBT.VDAT,    :ZAY_DEBT.DAT_5,
							        :ZAY_DEBT.DIG,      :ZAY_DEBT.REFD, :ZAY_DEBT.ZAY_SUM, :ZAY_DEBT.SALE_TP, :ZAY_DEBT.SALE_TP_NM,
							        :ZAY_DEBT.DNI
							   from V_ZAY_SPLIT_DTL sa
							      , ZAY_SALE_TYPES  st
							  where st.TP_ID(+) = sa.SALE_TP
							  ORDER BY 4, 1, 9, 7 desc "
				Set nMaxDig = DigInit()
				Set nMaxDig = IifN(nMaxDig=-1, 4, nMaxDig)
				!
				! % - на обяз.продажу, % - на 2600
				Call BIRZA('OBZ_PROC', nOBZ_Proc)
				If nOBZ_Proc = NUMBER_Null 
					Set nOBZ_Proc = 50
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Set TIP = 2
				If FLAG_NEW
					Set ZAY = 0
					If (SALE_TP = 1)
						Set S1 = 0
						Set S2 = ZAY_SUM
					If (SALE_TP = 2)
						Set S1 = SalNumberRound(ZAY_SUM * nOBZ_Proc) / 100
						Set S2 = ZAY_SUM - S1
					If (SALE_TP = 3)
						Set S1 = ZAY_SUM
						Set S2 = 0
				Else
					! Была ли заявка?
					If ZAY_SUM = 0
						Set ZAY = 0
						Set S1 = SalNumberRound(SUM * nOBZ_Proc) / 100
					Else
						Set ZAY = 1
						Set S1 = ZAY_SUM
						! Если заявка была - сумму колонки заявки покрасим для наглядности
						Call SalTblSetCellTextColor(S1s, COLOR_DarkGreen, TRUE)
					Set S2 = IifN(REFD!=NUMBER_Null, 0, SUM - S1 - F_PAY_F(REF))
				! Раскраска должников
				If DNI > 2
					Call F_COLOR( COLOR_DarkRed )
				Else If DNI = 2
					! Call SetTblRowColor( ZAY_DEBT, COLOR_Blue )
					Call F_COLOR( COLOR_DarkBlue )
				Else
					! Call SetTblRowColor( ZAY_DEBT, COLOR_Black )
					Call F_COLOR( COLOR_Black )
				! Наличие заявок, пришедших по Клиент-Банку
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT 1 
						   INTO :ZAY_DEBT.KB
						   FROM zay_debt_klb 
						  WHERE rnk=:ZAY_DEBT.RNK
						    AND kv2=:ZAY_DEBT.KV
						    AND datz>=:ZAY_DEBT.VDAT
						" ) AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
					Set KB=0
				!
				Set SUMs = Dig4(SUM*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set S1s  = Dig4(S1 *SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set S2s  = Dig4(S2 *SalNumberPower(10,DIG)/100, DIG, nMaxDig)
			On SAM_FetchDone
				Call SalDisableWindow(pb1)
				Call SalDisableWindow(pb2)
				Call SalDisableWindow(pbZAY)
			On SAM_RowSetContext
				If FLAG_NEW
					! Зачислить на расч.счет
					If ( SALE_TP = 1 )
						Call SalEnableWindow(pb1)
					Else
						Call SalDisableWindow(pb1)
					! Оформить заявку + Зачислить на расч.счет
					If ( SALE_TP = 2 )
						Call SalEnableWindow(pb2)
					Else
						Call SalDisableWindow(pb2)
					! Оформить заявку на ОБЯЗАТЕЛЬНУЮ продажу
					If ( SALE_TP = 3 )
						Call SalEnableWindow(pbZAY)
					Else
						Call SalDisableWindow(pbZAY)
					! ---
				Else
					Call SalDisableWindow(pb1)
					Call SalDisableWindow(pb2)
					Call SalDisableWindow(pbZAY)
					! If REFD = NUMBER_Null 
						               Call SalEnableWindow(pb1)
					! If ZAY = 0
						               Call SalEnableWindow(pbZAY)
			! On UM_Populate
				                                                              Call SalSendClassMessage( UM_Populate, wParam, lParam )
				! If NOT bErrFlg
					                                                                 Call SqlCommit( hSqlAux2() )
				! Else
					                                                                 Call SqlRollback( hSqlAux2() )
	Table Window: ZAYVm
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Визирование введенных сделок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.429"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Визирование заявок
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть'
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYVm, UM_Delete, 0, 0)
								Call SalPostMsg(ZAYVm, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завизировать'
						On SAM_Click
							If MessageQuestion('Будут визированы все отмеченные заявки. Продолжать ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYVm, SAM_User, 0, 0)
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 15524
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.05"
						Begin Y:  Class Default
						End X:  5.05"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15525
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.383"
						Begin Y:  Class Default
						End X:  4.383"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.517"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15526
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbPrintZay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.8"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать заявки"
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите распечатать отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYVm, UM_Print,    0, 0)
								Call SalSendMsg(ZAYVm, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
		Contents
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пок
						Прод
				Visible? No
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Right
				Width:  0.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Блок.
						ГРН
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIZA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В
						и
						з
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Код
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						№
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег
						№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Наименование
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						для списания
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.57"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0	! в коп.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						на торг.
						счете
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						на торг.
						счете
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						для зач
						ГРН
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет 
						для
						зачисления
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Left
				Width:  1.57"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2	! в коп.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						заявл.
						 ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						заявленой
						 ВАЛЮТЫ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KURS_Z
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Курс
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приоритет
						заявки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbPRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: 
						Приоритет
						заявки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If cbPRIORITY.Init(hWndItem)
							Call cbPRIORITY.Populate(hSql(), "id", "name", " zay_priority "," where active = 1 order by id")
					On SAM_AnyEdit
						Set PRIORITY = cbPRIORITY.GetKey(SalListQuerySelection(cbPRIORITY))
			Column: KOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						ком
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SKOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						или
						сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Дата
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FL_PF 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отч.
						в 
						ПФ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DigS0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: digS0
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Цель
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			! Только для покупки
			Column: DV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Конт
						ракт
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						контр.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						посл.
						ВМД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  0.583"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Даты
						других
						ВМД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						переч.
						вал.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осно-
						вание
						покуп.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						бенефе-
						циара
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № посл.
						тамож.декл.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: COVERED
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Code2c
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P12_2C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_RESERVE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nIdZay
					Number: nBlk
				Static Variables
				Local variables
					String: sMsg
					Number: nSumB
				Actions
					If nReserve = 0
						Return TRUE
					Else
						If nBlk = 0
							If SalMessageBox('Вы действительно хотите отказаться от блокировки гривны, '||PutCrLf(  )||
									                 'необходимой для покупки валюты по заявке №'||Str(nIdZay)||'?', 
									                 'Внимание', 
									                 MB_IconExclamation|MB_YesNo ) = IDNO
								Return FALSE
							Else
								Call SaveInfoToLog('ZAY. Пользователь отказался от блокировки гривны, необходимой на покупку валюты по заявке №'||Str(nIdZay))
								Return TRUE
						Else
							If SqlPLSQLCommand( hSql(), "p_zay_reserve(1,nIdZay,nSumB,sMsg)" )
								If sMsg != STRING_Null AND nSumB = 0
									Call MessageInfo( sMsg )
									Return FALSE
								Else
									Return TRUE
							Else
								Return FALSE
			Function: F_CHECK_DATA
				Description:
				Returns
					Boolean:
				Parameters
					Number: nBuySell
					Number: nId
					Number: nCurrency
					Number: nAmount
					Number: nRate
					Date/Time: dDate
				Static Variables
				Local variables
					String: sMsg
					Number: nSumB
				Actions
					! валюта не заблокирована дилером
					If not BKL_KV(nCurrency)
						Return FALSE
					! сумма заявки
					If nAmount = 0 OR nAmount = NUMBER_Null 
						Call SalMessageBox('Не указана сумма заявки № '||Str(nId)||'!', 
								                   'Заявка не может быть завизирована', 
								                   MB_IconExclamation)
						Return FALSE
					! дата заявки
					If dDate = DATETIME_Null 
						Call SalMessageBox('Не указана дата заявки № '||Str(nId)||'!',  
								                   'Заявка не может быть завизирована', 
								                   MB_IconExclamation)
						Return FALSE
					! курс заявки
					If nRate  = 0 OR nRate = NUMBER_Null 
						Set nRate = GetDilerRate (nBuySell, nCurrency, nCurrency)
						If nRate != NUMBER_Null AND nRate != 0 
							If SalMessageBox ('Установить предварительный курс дилера  '||Str(nRate)||
									                  ' для заявки №'||Str(nId)||'?', 
									                  'Внимание', 
									                  MB_IconExclamation|MB_YesNo) = IDYES
								Set ZAYVm.KURS_Z = nRate
								If SqlPrepareAndExecute(hSql(), 
										     "UPDATE zayavka SET kurs_z =:nRate WHERE id = :nId")
									Call SqlCommitEx(hSql(), 'ГОУ. Пользователь установил курс '||Str(nRate)||' для заявки № '||Str(nId))
									Return TRUE
								Else
									Call SqlRollbackEx(hSql(), 'ГОУ. Пользователь не смог установить курс для заявки № '||Str(nId))
									Return FALSE
							Else
								Return FALSE
						Else
							Call SalMessageBox('Не указан курс заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                   MB_IconExclamation)
							Return FALSE
					Return TRUE
			Function: F_TITLE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Заголовок окна 
					If nPAR = 1
						Call SalSetWindowText(hWndForm, 'Визирование заявок на ПОКУПКУ валюты')
					Else If nPAR = 2
						Call SalSetWindowText(hWndForm, 'Визирование заявок на ПРОДАЖУ валюты')
					Else
						Call SalSetWindowText(hWndForm, 'Визирование заявок на ПОКУПКУ валюты для ПОГАШЕНИЯ КРЕДИТА')
					! Заголовок колонок
					If nPAR = 1 OR  nPAR = 3 
						Call SalTblSetColumnTitle(ZAYVm.BLK, 
								'
								 Блок.
								 ГРН')
						Call SalTblSetColumnTitle(ZAYVm.NMK, 
								'Наименование
								  клиента-
								 покупателя')
						Call SalTblSetColumnTitle(ZAYVm.NLS1, 
								'  Счет
								 для зачисл.
								   ВАЛ')
						Call SalTblSetColumnTitle(ZAYVm.NLS0, 
								'  Счет
								 для списания
								   ГРН')
						Call SalTblSetColumnTitle(ZAYVm.S0, 
								'Сальдо
								 счета
								  ГРН')
						Call SalTblSetColumnTitle(ZAYVm.FL_PF, 
								'Отч.
								  в
								 ПФ')
						Call SalTblSetColumnTitle(ZAYVm.DV1, 
								'
								  Цель
								покупки')
						Call SalShowWindow( ZAYVm.FL_PF )
						Call SalHideWindow( MFO0 ) 
					Else
						Call SalTblSetColumnTitle(ZAYVm.BLK, 
								'
								 Блок.
								 ВАЛ')
						Call SalTblSetColumnTitle(ZAYVm.NMK, 
								'Наименование
								   клиента-
								  продавца')
						Call SalTblSetColumnTitle(ZAYVm.NLS1, 
								' Счет
								для зачисл.
								  ГРН')
						Call SalTblSetColumnTitle(ZAYVm.NLS0, 
								'  Счет
								для списания
								   ВАЛ')
						Call SalTblSetColumnTitle(ZAYVm.S0, 
								'Сальдо
								 счета
								  ВАЛ')
						Call SalTblSetColumnTitle(ZAYVm.DV1, 
								'
								 Цель
								продажи')
						Call SalHideWindow( ZAYVm.FL_PF )
						Call SalShowWindow( MFO0 ) 
		Window Parameters
			Number: nPAR
			! 1 - покупка
			! 2 - продажа
			! 3 - покупка для погашения кредита
		Window Variables
			Number: nNextRow
			Number: nReserve
			String: sFilter
			String: sStornoReason
			String: sStornoReasonId
			Number: nStornoReasonId
			!
			Number: nPrntQuery
			String: sFileName
			Number: nPrint
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call PrepareWindow(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Call SetWindowFullSize(hWndForm)
				Set ZAYVm.strPrintFileName = 'ZAYVm'
				Set ZAYVm.strFilterTblName = 'V_ZAY_QUEUE'
				! Резервирование гривны на ПОКУПКУ валюты
				If nPAR = 2
					Set nReserve = 0
				Else
					If SqlPrepareAndExecute(hSql(),
							   "SELECT to_number(val)
							      INTO :nReserve
							      FROM birja
							     WHERE par = 'RESERV'")
							AND NOT SqlFetchNext(hSql(), nFetchRes)
						Set nReserve = 0
				If nReserve = 1
					Call SalShowWindow(ZAYVm.BLK)
				Else
					Call SalHideWindow(ZAYVm.BLK)
				! Печать заявок
				If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val)
						     INTO :nPrntQuery
						     FROM birja
						    WHERE par = "||
						    IifS (nPAR = 1, "'PRNT_BUY'", "'PRNT_SAL'"))
						 and not SqlFetchNext(hSql(), nFetchRes)
					Set nPrntQuery = -1
				If nPrntQuery = -1
					Call SalDisableWindow(pbPrintZay)
				! Заголовок
				Call F_TITLE()
				! Условие отбора
				If nPAR = 1
					Set sFilter = " AND v_zay_queue.dk = 1 AND nvl(v_zay_queue.meta,0) <> 3 "
				Else If nPAR = 2
					Set sFilter = " AND v_zay_queue.dk = 2 "
				Else
					Set sFilter = " AND v_zay_queue.dk = 1 AND nvl(v_zay_queue.meta,0) = 3"
				!
				Set ZAYVm.strSqlPopulate =
						   "SELECT v_zay_queue.dk,
						           v_zay_queue.id,
						           v_zay_queue.rnk,
						           v_zay_queue.nmk,
						           v_zay_queue.kv2,
						           v_zay_queue.lcv,
						           v_zay_queue.dig,
						           v_zay_queue.kurs_z,
						           v_zay_queue.fdat,
						           decode(v_zay_queue.dk, 1, v_zay_queue.nls0,  v_zay_queue.nls),
						           decode(v_zay_queue.dk, 1, v_zay_queue.ostc0, v_zay_queue.ostc),
						           decode(v_zay_queue.dk, 1, 2,                 v_zay_queue.dig),
						           v_zay_queue.mfo0,
						           decode(v_zay_queue.dk, 1, v_zay_queue.nls,   v_zay_queue.nls0),
						           v_zay_queue.s2,
						           v_zay_queue.fl_pf,
						           v_zay_queue.kom,
						           v_zay_queue.skom,
						           v_zay_queue.viza,
						           v_zay_queue.priority,
						           v_zay_queue.priorname,
						           bars_zay.get_request_cover(v_zay_queue.id),
						           zay_aims.name,
						           v_zay_queue.contract,
						           v_zay_queue.dat2_vmd,
						           v_zay_queue.dat_vmd,
						           v_zay_queue.dat5_vmd,
						           trim(c.country||' '||c.name),
						           v_zay_queue.basis,
						           b.name,
						           v_zay_queue.bank_code,
						           v_zay_queue.bank_name,
						           v_zay_queue.product_group,
						           v_zay_queue.num_vmd, v_zay_queue.code_2c,  v_zay_queue.p12_2c
						      INTO :ZAYVm.DK,   :ZAYVm.ID,   :ZAYVm.RNK,  :ZAYVm.NMK,
						           :ZAYVm.KV,   :ZAYVm.ISO,  :ZAYVm.DIG,  :ZAYVm.KURS_Z,
						           :ZAYVm.DAT,  :ZAYVm.NLS0, :ZAYVm.S0,   :ZAYVm.DigS0,
						           :ZAYVm.MFO0, :ZAYVm.NLS1, :ZAYVm.S2,   :ZAYVm.FL_PF,
						           :ZAYVm.KOM,  :ZAYVm.SKOM, :ZAYVm.VIZA, :ZAYVm.PRIORITY,
						           :ZAYVm.cbPRIORITY,        :ZAYVm.COVERED,
						           :ZAYVm.DV1,  :ZAYVm.DV2,  :ZAYVm.DV3,  :ZAYVm.DV4,
						           :ZAYVm.DV5,  :ZAYVm.DV6,  :ZAYVm.DV7,  :ZAYVm.DV8,
						           :ZAYVm.DV9,  :ZAYVm.DVA,  :ZAYVm.DVB,  :ZAYVm.DVC, :ZAYVm.Code2c, :ZAYVm.P12_2C
						      FROM v_zay_queue,
						           zay_aims   ,
						           country   c,
						           country   b
						     WHERE v_zay_queue.meta         = zay_aims.aim(+)
						       AND v_zay_queue.country      = c.country(+)
						       AND v_zay_queue.benefcountry = b.country(+)
						       AND v_zay_queue.sos          = 0
						       AND v_zay_queue.viza        <= 0
						   "||sFilter||
						   " ORDER BY v_zay_queue.kv2, v_zay_queue.rnk"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Delete
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYVm, nNextRow, ROW_Selected, 0)      
					Call SalTblSetContext(ZAYVm, nNextRow)
					If SalMessageBox('Вы уверены, что хотите возвратить заявку клиента '||ZAYVm.NMK
							                 ||IifS(nPAR = 2, ' на продажу ', ' на покупку ')
							                 ||SalStrTrimX(S2s)||'/'||ZAYVm.ISO||'?' ,
							                 'Сторно заявок', 
							                 MB_IconQuestion|MB_YesNo) = IDYES
						Set sStornoReasonId = ''
						Set sStornoReason = ''
						If FunNSIGet('ZAY_BACK', '', sStornoReasonId,  sStornoReason)
							If sStornoReasonId AND sStornoReason
								Set nStornoReasonId = Val(sStornoReasonId)
								If SqlPrepareAndExecute(hSql(),
										   "UPDATE zayavka 
										       SET viza = -1, 
										           idback = :nStornoReasonId 
										     WHERE id = :ZAYVm.ID")
									Call SqlCommit(hSql())
									Call SaveInfoToLog('ZAY. Отказано в визе заявке № '||Str(ZAYVm.ID)
											                 ||' клиента '                     ||Str(ZAYVm.RNK)
											                 ||IifS(nPAR = 2, ' на продажу ', 
											                                  ' на покупку ')  ||SalStrTrimX(ZAYVm.S2s)
											                 ||'/'                             ||ZAYVm.ISO
											                 ||'. Код причины - '              ||sStornoReasonId)
								Else
									Call SqlRollback(hSql())
									Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию',
											                   'Сторно заявок. Ошибка', 
											                   MB_IconStop)
							Else
								Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию',
										                   'Сторно заявок. Ошибка', 
										                   MB_IconStop)
						Else
							Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию',
									                    'Сторно документов. Ошибка', 
									                    MB_IconStop)
			On UM_Print
				If nPrntQuery = -1
					Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
				Else
					Set nNextRow = TBL_MinRow
					While SalTblFindNextRow(ZAYVm, nNextRow, ROW_Selected, 0)      
						Call SalTblSetContext(ZAYVm, nNextRow)
						Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYVm.ID)),6)||'.TXT'
						Call ExportCatQuery(nPrntQuery,
								                    sFileName,
								                    3,
								                    ":ZAY_ID='"||SalStrTrimX(Str(ZAYVm.ID))||"'",
								                    FALSE)
						If sFileName != STRING_Null
							Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
									                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
									                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
									                           'Печать сформированной заявки',
									                           MB_IconQuestion|MB_YesNoCancel )
							If nPrint = IDYES
								Call DirectView(sFileName)
							If nPrint = IDNO
								Call DosDirectPrint(sFileName)
			On SAM_User
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYVm, nNextRow, ROW_Selected, 0)      
					Call SalTblSetContext(ZAYVm, nNextRow)
					If F_CHECK_DATA (ZAYVm.DK, ZAYVm.ID, ZAYVm.KV, ZAYVm.S2, ZAYVm.KURS_Z, ZAYVm.DAT)
							AND F_RESERVE(ZAYVm.ID, ZAYVm.BLK)  
						Call SqlPrepareAndExecute(hSql(), 
								    "UPDATE zayavka 
								        SET viza = 1, 
								            priority = :ZAYVm.PRIORITY 
								      WHERE id = :ZAYVm.ID")
						Call SqlCommit(hSql())
						Call SaveInfoToLog('ZAY. Завизирована заявка № ' ||Str(ZAYVm.ID)
								                 ||' клиента '                   ||Str(ZAYVm.RNK)
								                 ||IifS(nPAR = 2, ' на продажу ', 
								                                  ' на покупку ')||SalStrTrimX(ZAYVm.S2s)
								                 ||'/'                           ||ZAYVm.ISO)
				Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set S2s = Dig4(S2/100, DIG, 4)
				Set S0s = Dig4(S0/100, DigS0, 4)
				If nReserve = 1
					Set BLK = 1
				If VIZA = -1
					Call SetTblRowColor(ZAYVm, COLOR_DarkRed)
				! Подсказка о нехватке средств на торг.счете
				If COVERED = 0
					Call SalTblSetCellTextColor(ZAYVm.S0s, COLOR_Red, FALSE)
			On SAM_DoubleClick
				Call SalModalDialog(dlgZAY_DR, ZAYVm, ZAYVm.ID, ZAYVm.DK, 0,
						                    ZAYVm.DV1, ZAYVm.DV2, 
						                    ZAYVm.DV3, ZAYVm.DV4, 
						                    ZAYVm.DV5, ZAYVm.DV6,
						                    ZAYVm.DV7, ZAYVm.DV8,
						                    ZAYVm.DV9, ZAYVm.DVA,
						                    ZAYVm.DVB, ZAYVm.DVC, ZAYVm.Code2c, ZAYVm.P12_2C)
	Dialog Box: dlgD27
		Class:
		Property Template:
		Class DLL Name:
		Title: Показатели для файла #27
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.317"
				Width Editable? Yes
				Height: 3.179"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: обязательная продажа валюты:
				Resource Id: 60834
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.429"
					Width:  4.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Background Text: перечисление валюты 2603 -> 2600:
				Resource Id: 3173
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.679"
					Width:  4.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfPOK_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.983"
						Top:    0.405"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull( dfPOK_1 )
							Return VALIDATE_Ok
						If SqlPrepareAndExecute( hSqlAux2(), 
								"SELECT D020
								   INTO :d020
								   FROM bars.kl_d020 
								  WHERE prem='КБ'
								    AND R020='2603'
								    AND ( D_CLOSE Is Null or D_CLOSE > BARS.BANKDATE )
								    AND D020 = :dfPOK_1" )
								AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
							Call SalMessageBox( 'Введите правильный показатель!', 'Внимание', MB_IconStop )
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
			Data Field: dfPOK_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.983"
						Top:    0.655"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull( dfPOK_2 )
							Return VALIDATE_Ok
						If SqlPrepareAndExecute( hSqlAux2(), 
								"SELECT  D020
								   INTO :d020
								   FROM bars.kl_d020 
								  WHERE prem='КБ'
								    AND r020='2603'
								    AND ( D_CLOSE Is Null or D_CLOSE > BARS.BANKDATE )
								    AND d020=:dfPOK_2" )
								AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
							Call SalMessageBox( 'Введите правильный показатель!', 'Внимание', MB_IconStop )
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
			Multiline Field: mlNAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 160
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.483"
						Top:    1.571"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.983"
					Top:    2.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If nTIP = 0 AND SalIsNull( mlNAZN )
							Set mlNAZN = sN
						Else If nTIP = 1 AND SalIsNull( dfPOK_1 )
							Set dfPOK_1='01'
						Else If nTIP = 2
							If SalIsNull( mlNAZN )
								Set mlNAZN = sN
							If SalIsNull( dfPOK_2 )
								Set dfPOK_2='99'
						Else
							If SalIsNull( mlNAZN )
								Set mlNAZN = sN
							If SalIsNull( dfPOK_1 )
								Set dfPOK_1='01'
							If SalIsNull( dfPOK_2 )
								Set dfPOK_2='99'
						!
						Set sNAZN = mlNAZN
						Set d27_1=dfPOK_1
						Set d27_2=dfPOK_2
						Call SalEndDialog(dlgD27, TRUE )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.683"
					Top:    2.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
			Group Box: Значение показателя D#27:
				Resource Id: 3174
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.071"
					Width:  5.6"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 12
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Group Box: Назначение платежа 2600 -> 2603:
				Resource Id: 3172
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    1.155"
					Width:  5.6"
					Width Editable? Yes
					Height: 1.107"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 12
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
		Functions
		Window Parameters
			Number: nTIP
			Receive String: d27_1
			Receive String: d27_2
			Receive String: sNAZN
		Window Variables
			Number: nFetchRes
			String: d020
			String: sN
		Message Actions
			On SAM_Create
				Set mlNAZN = sNAZN
				Set sN = sNAZN
				Call SalCenterWindow( dlgD27 )
				If nTIP = 0
					Call SalDisableWindow(dfPOK_1)
					Call SalDisableWindow(dfPOK_2)
					Call SalEnableWindow(mlNAZN)
				Else If nTIP = 1
					Set dfPOK_1='01'
					Call SalEnableWindow(dfPOK_1)
					Call SalEnableWindow(mlNAZN)
					Call SalDisableWindow(dfPOK_2)
				Else If nTIP = 2
					Set dfPOK_2='99'
					Call SalEnableWindow(mlNAZN)
					Call SalEnableWindow(dfPOK_2)
					Call SalDisableWindow(dfPOK_1)
				Else
					Set dfPOK_1='01'
					Set dfPOK_2='99'
					Call SalEnableWindow(mlNAZN)
					Call SalEnableWindow(dfPOK_2)
					Call SalEnableWindow(dfPOK_1)
	Dialog Box: dlgSUM
		Class:
		Property Template:
		Class DLL Name:
		Title: Сумма валюты на продажу
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  4.833"
				Width Editable? Yes
				Height: 1.81"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Сумма заявки:
				Resource Id: 13413
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.262"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.483"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If NOT SalIsNull( dfS )
							Set SUM=dfS
						Else
							Set SUM=0
						Call SalEndDialog(dlgSUM, TRUE )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.883"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalIsNull( dfS )
							Set SUM=0
						Call SalEndDialog( hWndForm, TRUE )
			Data Field: dfS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    0.238"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull( dfS )
							Return VALIDATE_Ok
						If dfS>MAX_SUM
							Call SalMessageBox( 'Введенная сумма превышает допустимую!', 'Внимание', MB_IconStop )
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
					On VTM_LeftDoubleClick
						Set dfS = MAX_SUM
		Functions
		Window Parameters
			Number: MAX_SUM
			Receive Number: SUM
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SalSetFocus( dfS )
	Dialog Box: dlgZAY_DR
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Просмотр доп.реквизитов заявки на покупку / продажу валюты
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.2"
				Width Editable? Class Default
				Height: 5.393"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl, UM_Update, 0, 0)
				Line
					Resource Id: 46098
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46099
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalEndDialog(hWndForm, FALSE)
				Line
					Resource Id: 46100
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Check Box: cbCheck
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Проверять заполнение обязательных реквизитов
					Window Location and Size
						Left:   4.8"
						Top:    0.1"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  10.0"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: POS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № п/п
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TAG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реквизит
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VAL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение реквизита
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Set nRow = SalTblQueryContext(hWndForm)
								If Not SalIsNull( REF_TBL )
									If FunNSIGetFiltered( REF_TBL, '', IifS(REF_TBL='ZAY_AIMS', 'type=' || Str(nDk), ''), sPk, sSem)
										Set VAL = Subs(sPk,1,10)
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
										If POS = 6
											Set VAL = SalStrRepeatX( '0', 3 - SalStrLength(sPk) )|| sPk || ' ' || sSem
										If POS = 9
											Call SalTblSetContext(hWndForm, 9)
											Set VAL = Subs(sSem,1,60)
											Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
									Call SalSetFocus(hWndForm)
									Call SalTblSetFocusRow(hWndForm, nRow)
									Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
							On SAM_AnyEdit
								If POS = 9 and Len(VAL) = 10
									Call SqlPrepareAndExecute(hSql(), "select substr(name,1,60) into :sTmp from v_rc_bnk where b010 = :VAL")
									If SqlFetchNext(hSql(), nFetchRes)
										Call SalTblSetContext(hWndForm, 9)
										Set VAL = sTmp
										Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
									Call SalTblSetContext(hWndForm, 8)
							On SAM_Validate
								If ( DATA_TYPE = 'D' )
									If NOT SalIsValidDateTime( tbl.VAL )
										Call SalMessageBox ( 'Invalid date/time value', 'Validate Error', MB_Ok )
										Return VALIDATE_Cancel
								If ( DATA_TYPE = 'N' )
									If NOT SalIsValidNumber( tbl.VAL )
										Call SalMessageBox( 'Invalid number value', 'Validate Error', MB_Ok )
										Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: REF_TBL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REF_COL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OPT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  4.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DATA_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					! Function: CheckRekv_
						             Description: 
						             Returns 
							             Boolean: 
						             Parameters 
						             Static Variables 
						             Local variables 
							             Number: nCount
						             Actions 
							! Обязателдьность заполнения проверяем для всех полей
							             If cbCheck
								             Set nRow = TBL_MinRow
								             While SalTblFindNextRow(hWndForm, nRow, 0, 0)
									             Call SalTblSetContext(hWndForm, nRow)
									             If OPT and VAL = STRING_Null
										             Call SalMessageBox('Не заполнен реквизит <' || TAG || '>', 'Внимание!', MB_IconExclamation | MB_Ok)
										             Call SalSetFocus(hWndForm)
										             Call SalTblSetFocusRow(hWndForm, nRow)
										             Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
										             Return FALSE
							! Наличие в справочнике - только для редактированных, т.к. населяется <'код ' || name> а в справочнике только код
							             Set nRow = TBL_MinRow
							             While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
								             Call SalTblSetContext(hWndForm, nRow)
								             If REF_TBL and REF_COL and VAL != STRING_Null
									             Call SqlPrepareAndExecute(hSqlAux(),
											"select count(*) into :nCount
											   from " || REF_TBL  || "
											  where " || REF_COL || " = :VAL" ||
											 IifS(REF_TBL='ZAY_AIMS', " and type=" || Str(nDk), ""))
									             If SqlFetchNext(hSqlAux(), nFetchRes) and not nCount
										! Неверное значение реквизита! Выбирите значение из справочника!
										             Call SalMessageBox("Неверное значение реквизита!" || PutCrLf() || "Выберите значение из справочника!",
												     "Внимание!", MB_IconExclamation | MB_Ok)
										             Set VAL = ''
										             Call SalSetFocus(hWndForm)
										             Call SalTblSetFocusRow(hWndForm, nRow)
										             Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
										             Return FALSE
							             Return TRUE
					Function: CheckRekv
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nCount
							String: sCountryCode
							String: sBankCode
						Actions
							! Обязателдьность заполнения проверяем для всех полей
							If cbCheck
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, 0, 0)
									Call SalTblSetContext(hWndForm, nRow)
									If OPT and VAL = STRING_Null
										Call SalMessageBox('Не заполнен реквизит <' || TAG || '>', 'Внимание!', MB_IconExclamation | MB_Ok)
										Call SalSetFocus(hWndForm)
										Call SalTblSetFocusRow(hWndForm, nRow)
										Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
										Return FALSE
							! Наличие в справочнике - только для редактированных, т.к. населяется <'код ' || name> а в справочнике только код
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited) and REF_TBL and REF_COL and VAL != STRING_Null
									Call SqlPrepareAndExecute(hSqlAux(),
											"select count(*) into :nCount
											   from " || REF_TBL  || "
											  where " || REF_COL || " = " || IifS(POS=6, "substr(:VAL,1,3)", ":VAL") ||
											 IifS(REF_TBL='ZAY_AIMS', " and type=" || Str(nDk), ""))
									If SqlFetchNext(hSqlAux(), nFetchRes) and not nCount
										! Неверное значение реквизита! Выбирите значение из справочника!
										Call SalMessageBox("Неверное значение реквизита!" || PutCrLf() || "Выберите значение из справочника!",
												     "Внимание!", MB_IconExclamation | MB_Ok)
										Set VAL = ''
										Call SalSetFocus(hWndForm)
										Call SalTblSetFocusRow(hWndForm, nRow)
										Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
										Return FALSE
								If POS = 6
									Set sCountryCode = VAL
								If POS = 9
									Set sBankCode = VAL
								! If POS = 13
									             If not SalIsNull(VAL) and VAL != '0' and VAL != '1' and VAL != '2' and VAL != '3' and VAL != '4' and VAL != '9'
										             Call SalMessageBox("Недопустимое значение реквизита <" || TAG || ">!",
												     "Внимание!", MB_IconExclamation | MB_Ok)
										             Call SalSetFocus(hWndForm)
										             Call SalTblSetFocusRow(hWndForm, nRow)
										             Call SalTblSetFocusCell(hWndForm, nRow, VAL, 0, 0)
										             Return FALSE
							!
							If sCountryCode != STRING_Null and sBankCode != STRING_Null and Subs(sCountryCode,1,3) != Subs(sBankCode,1,3)
								Call SalMessageBox("Помилка - дані колонки 9 (Код иностранного банка)" || PutCrLf() ||
										     "не відповідають даним колонки 6 (Страна перечисления валюты)",
										     "Внимание!", MB_IconExclamation | MB_Ok)
								Return FALSE
							Return TRUE
					Function: SAVE_CHANGES
						Description:
						Returns
						Parameters
							String: sFieldName
							String: sFieldValue
						Static Variables
						Local variables
							! Number: nRow
						Actions
							If SqlPrepareAndExecute( hSql(), 
									"update ZAYAVKA 
									    set " || sFieldName || " = :sFieldValue
									  where ID = :nId" )
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
								Call SalMessageBox( "Помилка при зміні значення параметру "||sFieldName
										                  , "Внимание!", MB_IconExclamation )
				Window Variables
					Number: nRow
					String: sPk
					String: sSem
					String: strUpd
					Number: nRes
					!
					String: strLangId
				Message Actions
					On SAM_Create
						Set strLangId = GetLang()
						Call SalTblPopulate( dlgZAY_DR.tbl, hSql(),
								"select POS, SubStr(decode(:strLangId,'UKR',TAG_UKR,TAG_RUS),1,200) TAG
								      , REF_TBL, REF_COL, RQD, DATA_TP
								   into :dlgZAY_DR.tbl.POS,     :dlgZAY_DR.tbl.TAG, :dlgZAY_DR.tbl.REF_TBL
								      , :dlgZAY_DR.tbl.REF_COL, :dlgZAY_DR.tbl.OPT, :dlgZAY_DR.tbl.DATA_TYPE
								   from BARS.V_ZAY_DOC_DTLS
								", TBL_FillAll)
					On SAM_FetchRowDone
						If dlgZAY_DR.tbl.POS=1
							Set dlgZAY_DR.tbl.VAL=d1
						Else If dlgZAY_DR.tbl.POS=2
							Set dlgZAY_DR.tbl.VAL=d2
						Else If dlgZAY_DR.tbl.POS=3
							Set dlgZAY_DR.tbl.VAL=SalFmtFormatDateTime( d3, 'dd/MM/yyyy' )
						Else If dlgZAY_DR.tbl.POS=4
							Set dlgZAY_DR.tbl.VAL=SalFmtFormatDateTime( d4, 'dd/MM/yyyy' )
						Else If dlgZAY_DR.tbl.POS=5
							Set dlgZAY_DR.tbl.VAL=d5
						Else If dlgZAY_DR.tbl.POS=6
							Set dlgZAY_DR.tbl.VAL=d6
						Else If dlgZAY_DR.tbl.POS=7
							Set dlgZAY_DR.tbl.VAL=d7
						Else If dlgZAY_DR.tbl.POS=8
							Set dlgZAY_DR.tbl.VAL=d8
						Else If dlgZAY_DR.tbl.POS=9
							Set dlgZAY_DR.tbl.VAL=d9
						Else If dlgZAY_DR.tbl.POS=10
							Set dlgZAY_DR.tbl.VAL=dA
						Else If dlgZAY_DR.tbl.POS=11
							Set dlgZAY_DR.tbl.VAL=dB
						Else If dlgZAY_DR.tbl.POS=12
							Set dlgZAY_DR.tbl.VAL=dC
						Else If dlgZAY_DR.tbl.POS=13
							Set dlgZAY_DR.tbl.VAL=sCode2c
						Else If dlgZAY_DR.tbl.POS=14
							Set dlgZAY_DR.tbl.VAL=sP12_2C
						If OPT = 1
							Call SalTblSetCellTextColor(POS, COLOR_DarkRed, FALSE)
							Call SalTblSetCellTextColor(TAG, COLOR_DarkRed, FALSE)
							Call SalTblSetCellTextColor(VAL, COLOR_DarkRed, FALSE)
						If REF_TBL != ''
							Call XSalTblSetCellBackColor(VAL, SalColorFromRGB(230, 255, 255))
					On UM_Update
						! проверка заполнения обязательных реквизитов
						If not CheckRekv()
							Return FALSE
						Set nRow = TBL_MinRow
						Set strUpd = "verify_opt = :cbCheck"
						While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If POS=1
								Set strUpd = strUpd || ", meta = " || IifS(VAL='',"null", VAL)
							Else If POS=2
								Set strUpd = strUpd || ", contract = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=3
								Set strUpd = strUpd || ", dat2_vmd = " || IifS(VAL='',"null", "to_date('" || VAL || "', 'dd/MM/yyyy')")
							Else If POS=4
								Set strUpd = strUpd || ", dat_vmd = " || IifS(VAL='',"null", "to_date('" || VAL || "', 'dd/MM/yyyy')")
							Else If POS=5
								Set strUpd = strUpd || ", dat5_vmd = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=6
								Set strUpd = strUpd || ", country = " || IifS(VAL='',"null", Subs(VAL,1,3))
							Else If POS=7
								Set strUpd = strUpd || ", basis = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=8
								Set strUpd = strUpd || ", benefcountry = " || IifS(VAL='',"null", VAL)
							Else If POS=9
								Set strUpd = strUpd || ", bank_code = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=10
								Call SAVE_CHANGES( "BANK_NAME", VAL )
							Else If POS=11
								Set strUpd = strUpd || ", product_group = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=12
								Set strUpd = strUpd || ", num_vmd = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=13
								Set strUpd = strUpd || ", code_2c = " || IifS(VAL='',"null", "'"||VAL||"'")
							Else If POS=14
								Set strUpd = strUpd || ", p12_2c = " || IifS(VAL='',"null", "'"||VAL||"'")
						If strUpd
							If not SqlPrepareAndExecute(hSql(), "update zayavka set " || strUpd || " where id = :nId")
								Call SqlRollback(hSql())
								Return FALSE
							Call SqlCommit(hSql())
							! Проверим если цель 03
							Call SqlPLSQLCommand(hSql(), 'p_check_stat_param ("ZAYAVKA", nId, 1, nRes)')
							If nRes = -1
								Call SalMessageBox("Помилка - дані колонок 6-8 не відповідають даним колонки 1 (Цель покупки)",
										     "Внимание!", MB_IconExclamation | MB_Ok)
								Return FALSE
							Call SalEndDialog(dlgZAY_DR, TRUE)
		Functions
		Window Parameters
			Number: nId
			Number: nDk
			Number: nOpt
			String: d1
			String: d2
			Date/Time: d3
			Date/Time: d4
			String: d5
			String: d6
			String: d7
			String: d8
			String: d9
			String: dA
			String: dB
			String: dC
			String: sCode2c
			String: sP12_2C
		Window Variables
			String: sTmp
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalDisableWindow( pbIns )
				Call SalDisableWindow( pbDel )
				! Call SalDisableWindow( pbUpdate )
				Call SalDisableWindow( pbFilter )
				Call SalDisableWindow( pbOk )
				Set cbCheck = nOpt
				Set dlgZAY_DR.strPrintFileName='ZAY_DR'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! не убирать! иначе по DoubleClick будем выходить из диалога
			On UM_DoubleClick
	Dialog Box: dlgZAY_KB
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Просмотр заявок, поступивших по системе Клиент-Банк
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.833"
				Width Editable? Class Default
				Height: 3.845"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть заявку отправителю'
						On SAM_Click
							Set nNextRow = TBL_MinRow
							While SalTblFindNextRow(dlgZAY_KB.tbl, nNextRow, ROW_Selected, 0)      
								Call SalTblSetContext(dlgZAY_KB.tbl, nNextRow)
								If SalMessageBox('Вы действительно хотите вернуть заявку клиента '||dlgZAY_KB.tbl.NMK||
										                 ' на обязательную продажу '||SalStrTrimX(dlgZAY_KB.tbl.S2s)||'/'||Str(dlgZAY_KB.tbl.KV2)||'?',
										                 'Сторно заявок', MB_IconQuestion|MB_YesNo) = IDYES
									Set sStornoReasonId = ''
									Set sStornoReason = ''
									If FunNSIGet('ZAY_BACK', '', sStornoReasonId,  sStornoReason)
										If sStornoReasonId AND sStornoReason
											Set nStornoReasonId=Val(sStornoReasonId)
											If SqlPrepareAndExecute(hSqlAux2(),
													   "INSERT INTO zayavka 
													      (id,rnk,dk,acc1,fdat,kv2,s2,kurs_z,sos,kom,acc0,mfo0,nls0,okpo0,
													       viza,priority,fnamekb,identkb,tipkb,datedokkb)
													    SELECT 0,z.rnk,2,a.acc,z.datz,z.kv2,z.s2,z.kurs_z,0,0,
													           z.acc0,z.mfo0,z.nls0,z.okpo0,0,0,
													           z.fnamekb,z.identkb,z.tipkb,z.datedokkb
													    FROM zay_debt_klb z, accounts a, cust_acc ca
													    WHERE a.dazs IS NULL AND a.acc=ca.acc AND ca.rnk=z.rnk AND 
													          a.nbs='2603' AND a.kv=z.kv2 AND rownum=1  AND
													          z.fnamekb=:dlgZAY_KB.tbl.FNAMEKB AND z.identkb=:dlgZAY_KB.tbl.IDENTKB") 
													AND
													   SqlPrepareAndExecute(hSqlAux2(),
													   "UPDATE zayavka SET viza=-1, idback=:nStornoReasonId 
													    WHERE fnamekb=:dlgZAY_KB.tbl.FNAMEKB AND identkb=:dlgZAY_KB.tbl.IDENTKB")
													AND
													   SqlPrepareAndExecute(hSqlAux2(),
													   "DELETE FROM zay_debt_klb WHERE fnamekb=:dlgZAY_KB.tbl.FNAMEKB AND identkb=:dlgZAY_KB.tbl.IDENTKB")
												Call SqlCommit(hSqlAux2())
												Call SaveInfoToLog( "ГОУ. Отказано в визе. Заявка клиента "||Str(dlgZAY_KB.tbl.RNK)||" на обязательную продажу "||SalStrTrimX(dlgZAY_KB.tbl.S2s)||"/"||Str(dlgZAY_KB.tbl.KV2)  )
												Call SalSendMsg( dlgZAY_KB.tbl, UM_Populate, 0, 0 )
											Else
												Call SqlRollback(hSql())
												Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию','Сторно заявок. Ошибка', MB_IconStop)
												Call SalSendMsg( dlgZAY_KB.tbl, UM_Populate, 0, 0 )
										Else
											Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию','Сторно заявок. Ошибка', MB_IconStop)
									Else
										Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию','Сторно документов. Ошибка', MB_IconStop)
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7282
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7283
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  3.85"
						Begin Y:  Class Default
						End X:  3.85"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выбрать заявку'
						On SAM_Click
							Set SUM=dlgZAY_KB.tbl.S2
							Set NAMEKB=dlgZAY_KB.tbl.FNAMEKB
							Set IDKB=dlgZAY_KB.tbl.IDENTKB
							Call SalEndDialog(dlgZAY_KB, TRUE )
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7284
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  4.967"
						Begin Y:  Class Default
						End X:  4.967"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbPrintZay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    0.052"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать заявки"
						On SAM_Click
							If nKODZ_OBZ = NUMBER_Null
								Call SalMessageBox( 'Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop )
							Else
								Set sFileName = 
										    GetPrnDir()||'\\'||
										    'Z_'||
										    SalStrRightX('0000'||SalStrTrimX(Str(dlgZAY_KB.tbl.RNK)),4)||
										    SalFmtFormatDateTime(dlgZAY_KB.tbl.DATZ,'dd')||'.TXT'
								Call ExportCatQuery(nKODZ_OBZ, sFileName, 3, ":ZAY_ID='"||SalStrTrimX(dlgZAY_KB.tbl.IDENTKB)||"'", FALSE )
								If sFileName!=STRING_Null
									Set nPrint=SalMessageBox( 'Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
											                          'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
											                          'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
											                          'Печать сформированной заявки',
											                          MB_IconQuestion|MB_YesNoCancel )
									If nPrint=IDYES
										Call DirectView( sFileName )
									If nPrint=IDNO
										Call DosDirectPrint( sFileName )
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  9.7"
						Width Editable? Class Default
						Height: 2.94"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? Class Default
				Contents
					Column: ND
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Номер
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рег.№
								клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.033"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DIG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								валюты
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S2s
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								валюты
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KURS_Z
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DATZ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.05"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FNAMEKB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение реквизита
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: IDENTKB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение реквизита
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalTblPopulate(dlgZAY_KB.tbl, hSql(),
								"SELECT z.rnk, c.nmk, z.nd, z.kv2, t.dig, z.s2, z.kurs_z, z.datz, z.fnamekb, z.identkb
								 INTO :dlgZAY_KB.tbl.RNK,    :dlgZAY_KB.tbl.NMK, :dlgZAY_KB.tbl.ND,   
								      :dlgZAY_KB.tbl.KV2,    :dlgZAY_KB.tbl.DIG, :dlgZAY_KB.tbl.S2,    
								      :dlgZAY_KB.tbl.KURS_Z, :dlgZAY_KB.tbl.DATZ,:dlgZAY_KB.tbl.FNAMEKB,
								      :dlgZAY_KB.tbl.IDENTKB
								 FROM zay_debt_klb z, customer c, tabval t
								 WHERE z.rnk=c.rnk AND z.kv2=t.kv "||
								 IifS(nRNK!=0, " AND z.rnk=:nRNK ", " ")||
								 IifS(nKV!=0, " AND z.kv2=:nKV ", " ")||
								 " ORDER BY z.rnk, z.kv2, z.datz", TBL_FillAll )
					On SAM_FetchRowDone
						Set S2s=Dig4(S2/100,DIG,4)
		Functions
		Window Parameters
			Number: nEDIT
			! 0 - просмотр
			! 1 - выбор
			Number: nRNK
			Number: nKV
			Receive Number: SUM
			Receive String: NAMEKB
			Receive String: IDKB
		Window Variables
			Number: nFetchRes
			Number: nNextRow
			String: sStornoReasonId
			String: sStornoReason
			Number: nStornoReasonId
			!
			String: sFileName
			Number: nKODZ_OBZ
			Number: nPrint
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalDisableWindow( pbIns )
				Call SalDisableWindow( pbUpdate )
				Call SalDisableWindow( pbFilter )
				!
				If SqlPrepareAndExecute( hSql(), 
						  "SELECT nvl(to_number(val),-1) INTO :nKODZ_OBZ FROM birja WHERE par = 'PRNT_OBZ'" ) 
						AND NOT SqlFetchNext( hSql(), nFetchRes )
					Set nKODZ_OBZ = -1
					Call SalDisableWindow( pbPrintZay )
				Else
					Call SalEnableWindow( pbPrintZay )
				!
				If nEDIT = 0
					Call SalDisableWindow( pbOk )
				Else
					Call SalEnableWindow( pbOk )
				!
				Set dlgZAY_KB.strPrintFileName='ZAY_KB'
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Dialog Box: dlgZAYKillOrRecover
		Class:
		Property Template:
		Class DLL Name:
		Title: Удаление / Восстановление заявок клиентов на покупку-продажу валюты
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.729"
				Width Editable? Yes
				Height: 3.604"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Поиск заявки по ключевым реквизитам
				Resource Id: 13221
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.107"
					Width:  9.3"
					Width Editable? Yes
					Height: 1.802"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Background Text: № заявки:
				Resource Id: 13222
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.267"
					Top:    0.429"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.45"
						Top:    0.429"
						Width:  1.729"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Рег.№ клиента:
				Resource Id: 13223
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.267"
					Top:    0.702"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.45"
						Top:    0.702"
						Width:  1.729"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull(dfRNK) 
							Set dfNMK = STRING_Null
						Else
							If SqlPrepareAndExecute(hSql(), 
									   "SELECT nmk INTO :dfNMK FROM customer WHERE rnk = :dfRNK") 
									AND NOT SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox("Не найден клиент с заданным РНК!", 
										                   "Ошибка!", 
										                   MB_IconStop)
								Set dfRNK = NUMBER_Null
								Set dfNMK = STRING_Null
								Call SalSetFocus(dfRNK)
						Return VALIDATE_Ok
			Data Field: dfNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.186"
						Top:    0.702"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Валюта заявки:
				Resource Id: 13224
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.267"
					Top:    0.976"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.45"
						Top:    0.976"
						Width:  1.729"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull(dfKV) 
							Set dfKVNAME = STRING_Null
						Else
							If SqlPrepareAndExecute(hSql(), 
									   "SELECT name INTO :dfKVNAME FROM tabval WHERE kv = :dfKV") 
									AND NOT SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox('Неверно указан код валюты!', 
										                   'Ошибка!', 
										                   MB_IconStop)
								Set dfKV = NUMBER_Null
								Set dfKVNAME = STRING_Null
								Call SalSetFocus(dfKV)
						Return VALIDATE_Ok
			Data Field: dfKVNAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.186"
						Top:    0.976"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Сумма заявки:
				Resource Id: 13225
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    1.25"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfSUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.45"
						Top:    1.25"
						Width:  2.129"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата заявки:
				Resource Id: 13226
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    1.524"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.45"
						Top:    1.524"
						Width:  1.729"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Покупка валюты
				Window Location and Size
					Left:   4.817"
					Top:    1.25"
					Width:  2.433"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nDk = 1 
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Продажа валюты
				Window Location and Size
					Left:   4.817"
					Top:    1.524"
					Width:  2.433"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Dark Green
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nDk = 2
			Background Text: все поля обязательны для заполнения
				Resource Id: 13227
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    1.893"
					Width:  8.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Italic
				Text Color: Dark Red
				Background Color: Default
			!
			Pushbutton: pbLook4Zay
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbSearch
				Property Template:
				Class DLL Name:
				Title: Найти заявку
				Window Location and Size
					Left:   0.183"
					Top:    2.345"
					Width:  2.0"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_Look4Zay()
						! возможно восстановление
						If nZaySos < 0 
							Call SalEnableWindow(pbRecoverZay)
						Else
							Call SalDisableWindow(pbRecoverZay)
						! возможно удаление
						If nZaySos >= 0
							Call SalEnableWindow(pbKillZay)
						Else
							Call SalDisableWindow(pbKillZay)
			Pushbutton: pbKillZay
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbDelete
				Property Template:
				Class DLL Name:
				Title: Удалить заявку
				Window Location and Size
					Left:   2.6"
					Top:    2.345"
					Width:  2.0"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_KillZay()
			Pushbutton: pbRecoverZay
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbRefresh
				Property Template:
				Class DLL Name:
				Title: Восстановить заявку
				Window Location and Size
					Left:   5.014"
					Top:    2.345"
					Width:  2.0"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalMessageBox("Вы действительно хотите реанимировать (восстановить) заявку №"||Str(dfID)||"?", 
								                 "Внимание!", 
								                 MB_IconQuestion|MB_YesNo) = IDYES
							Call F_RecoverZay()
						Else
							Call SalSetFocus(pbCancel)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Завершить работу
				Window Location and Size
					Left:   7.457"
					Top:    2.345"
					Width:  2.0"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(dlgZAYKillOrRecover, FALSE)
		Functions
			Function: F_Look4Zay
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nDig
					String: sTmp
				Actions
					Set nRefSos = NUMBER_Null 
					If dfID  = NUMBER_Null   
							OR dfRNK = NUMBER_Null 
							OR dfKV  = NUMBER_Null 
							OR nDk   = NUMBER_Null 
						Call SalMessageBox("Не указаны параметры заявки!", 
								                   "Ошибка!", 
								                   MB_IconStop)
					Else
						Call SqlPrepareAndExecute(hSql(),
								    "SELECT z.viza, z.sos, z.s2/power(10,t.dig), z.fdat, z.ref, t.dig
								       INTO :nVisa,:nZaySos,:dfSUM,:dfDAT,:nRef, :nDig
								       FROM zayavka z, tabval t
								      WHERE z.id = :dfID
								        AND z.rnk = :dfRNK
								        AND z.dk = :nDk
								        AND z.kv2 = :dfKV
								        AND z.kv2 = t.kv")
						If not SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox("Не найдена заявка с заданными параметрами!", 
									                   "Ошибка!", 
									                   MB_IconStop)
							Set dfID = NUMBER_Null
							Set dfRNK = NUMBER_Null
							Set dfKV = NUMBER_Null
							Set dfSUM = NUMBER_Null
							Set dfDAT = DATETIME_Null
							Set dfNMK = STRING_Null
							Set dfKVNAME = STRING_Null
							Call SalSetFocus(pbCancel)
						Else
							! есть ли сформированный документ
							If nRef != NUMBER_Null
								If SqlPrepareAndExecute(hSql(),
										  "SELECT sos INTO :nRefSos FROM oper WHERE ref = :nRef")
									Call SqlFetchNext(hSql(), nFetchRes)
							! Формат поля суммы
							If nDig
								Set sTmp='#0' || IifS(SalStrMidX(SalNumberToStrX(1.1, 1), 1, 1)='.', '.', ',') || SalStrRepeatX('0', nDig)
							Else
								Set sTmp='#0'
							Call SalFmtSetPicture(dfSUM, sTmp)
			Function: F_KillZay
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Boolean: bAllow
				Actions
					Call F_Look4Zay()
					Set bAllow = FALSE
					If nZaySos = 0 
						Call SalMessageBox("Заявка еще не удовлетворена дилером."||PutCrLf()||"Удаление заявок такого типа выполняется из формы ввода заявок!", 
								                   "Информация", 
								                    MB_IconExclamation)
					Else If nZaySos = 0.5
						If SalMessageBox("Заявка уже удовлетворена дилером."||PutCrLf()||"Вы действительно хотите удалить заявку?", 
								                 "Внимание!", 
								                  MB_IconQuestion|MB_YesNo) = IDYES
							Set bAllow = TRUE
					Else If nZaySos = 1
						If SalMessageBox("По данной заявке уже завизированы курсы дилера."||PutCrLf()||"Вы действительно хотите удалить заявку?", 
								                 "Внимание!", 
								                  MB_IconQuestion|MB_YesNo) = IDYES
							Set bAllow = TRUE
					Else If nZaySos = 2
						If nRefSos > 0
							Call SalMessageBox("По данной заявке уже сформирован документ по взаиморасчету с клиентом."||PutCrLf()||"Удаление заявки недопустимо!", 
									                   "Информация!", 
									                    MB_IconExclamation)
						Else
							If SalMessageBox("Данная заявка уже перемещена в архив."||PutCrLf()||"Вы действительно хотите удалить заявку?", 
									                 "Внимание!", 
									                  MB_IconQuestion|MB_YesNo) = IDYES
								Set bAllow = TRUE
					Else
						Call SalMessageBox("Неопределен статус заявки."||PutCrLf()||"Удаление заявки недопустимо!", 
								                   "Информация", 
								                    MB_IconExclamation)
					! удаление допустимо, подтверждение пользователя получено
					If bAllow
						If SqlPrepareAndExecute(hSql(), "UPDATE zayavka SET sos = -1 WHERE id = :dfID")
							Call SalMessageBox("Заявка № "||Str(dfID)||" успешно удалена!", 
									                   "Информация!", 
									                   MB_IconExclamation)
							Call SqlCommitEx(hSql(), 'ZAY999. Удалена заявка №'||Str(dfID))
					Call SalSetFocus(pbCancel)
			Function: F_RecoverZay
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call F_Look4Zay()
					If nZaySos < 0 
						If SqlPrepareAndExecute(hSql(), 
								  "begin
								     insert into zay_queue (id) values ("||Str(dfID)||");
								   exception
								     when dup_val_on_index then null;
								   end;")
							If SqlPrepareAndExecute(hSql(), "UPDATE zayavka SET sos = 0, viza = 0, kurs_f = null, vdate = null WHERE id = :dfID") 
								Call SalMessageBox("Заявка № "||Str(dfID)||" успешно восстановлена!", 
										                   "Информация!", 
										                   MB_IconExclamation)
								Call SqlCommitEx(hSql(), 'ZAY999. Восстановлена заявка №'||Str(dfID))
					Else
						Call SalMessageBox("Восстановлению подлежат только ошибочно удаленные заявки!", 
								                   "Информация", 
								                    MB_IconExclamation)
					Call SalSetFocus(pbCancel)
		Window Parameters
		Window Variables
			Number: nFetchRes
			Number: nVisa
			Number: nZaySos
			Number: nDk
			Number: nRef
			Number: nRefSos
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Удаление / Восстановление заявок клиентов на покупку-продажу валюты')
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(dfID)
				Set nDk = 1
				Call SalDisableWindow(pbKillZay)
				Call SalDisableWindow(pbRecoverZay)
			On SAM_Close
				Call SalEndDialog(dlgZAYKillOrRecover, FALSE)
	! cGenericTable: ZAY_DEBT
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: ОБЯЗАТЕЛЬНАЯ продажа валюты клиентов
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.267"
				Width Editable? Yes
				Height: 5.781"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                                                                                                                     Description: Обязательная продажа валюты
		                                                                                                                     Named Menus 
		                                                                                                                     Menu 
		                                                                                                                     Tool Bar 
			                                                                                                                     Contents 
				                                                                                                                     Pushbutton: pbIns
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip='Просмотреть заявки, полученные по системе Клиент-Банк'
						                                                                                                                     On SAM_Click
							                                                                                                                     Call SalModalDialog(dlgZAY_KB,ZAY_DEBT,0,0,0,nTmp,sTmp,sTmp)
				                                                                                                                     Pushbutton: pbDel
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip = 'Снять с контроля'
						                                                                                                                     On SAM_Click
							                                                                                                                     If SalMessageBox('Вы действительно хотите снять с контроля документ на сумму '||SalNumberToStrX(ZAY_DEBT.SUM,2)||' '||ZAY_DEBT.ISO||' ?','Внимание',MB_YesNo|MB_IconQuestion)=IDYES
								                                                                                                                     If SqlPrepareAndExecute(hSqlAux2(),"UPDATE zay_debt SET sos=1 WHERE ref=:ZAY_DEBT.REF") 
									                                                                                                                     Call SqlCommit(hSqlAux2())
								                                                                                                                     Else 
									                                                                                                                     Call SqlRollback(hSqlAux2())
							                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                                                     Pushbutton: pbRefresh
					                                                                                                                     Message Actions 
				                                                                                                                     Pushbutton: pbUpdate
					                                                                                                                     Message Actions 
				                                                                                                                     Line 
				                                                                                                                     Pushbutton: pbSearch
					                                                                                                                     Message Actions 
				                                                                                                                     Pushbutton: pbFilter
					                                                                                                                     Message Actions 
				                                                                                                                     Pushbutton: pbDetails
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip='Просмотреть документ'
						                                                                                                                     On SAM_Click
							                                                                                                                     If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								                                                                                                                     Call DocViewContentsEx(hWndMDI,REF)
				                                                                                                                     Pushbutton: pbPrint
					                                                                                                                     Message Actions 
				                                                                                                                     Line 
				                                                                                                                     Pushbutton: pbExit
					                                                                                                                     Message Actions 
				                                                                                                                     Line 
				                                                                                                                     Pushbutton: pb1
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip = 'Зачислить на расч.счет'
						                                                                                                                     On SAM_Click
							                                                                                                                     If NOT SalIsNull( ZAY_DEBT.S2 ) AND ZAY_DEBT.S2!=0
								                                                                                                                     If SalMessageBox( 'Вы действительно хотите зачислить '||SalNumberToStrX( ZAY_DEBT.S2, 2 )||' '||ZAY_DEBT.ISO|| PutCrLf(  ) ||
										                  'на расчетный счет '||ZAY_DEBT.NMK||' ?', 'Внимание', MB_YesNo|MB_IconQuestion )=IDYES
									                                                                                                                     Call F_ZAYDEBT(ZAY_DEBT.TIP, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, 0, ZAY_DEBT.S2*SalNumberPower(10,ZAY_DEBT.DIG))
								                                                                                                                     Else 
									                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                                                     Pushbutton: pb2
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip = 'Оформить заявку + Зачислить на расч.счет'
						                                                                                                                     On SAM_Click
							                                                                                                                     If ZAY=1 
								                                                                                                                     If NOT (SalIsNull(ZAY_DEBT.S2) OR ZAY_DEBT.S2=0)
									                                                                                                                     If SalMessageBox( 'Вы действительно хотите '||PutCrLf(  )||
											                  'зачислить '||SalNumberToStrX(ZAY_DEBT.S2,2)||' '||ZAY_DEBT.ISO ||' на расчетный счет '||ZAY_DEBT.NMK||' ?', 'Внимание', MB_YesNo|MB_IconQuestion )=IDYES
										                                                                                                                     Call F_ZAYDEBT(ZAY_DEBT.TIP, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, 0, ZAY_DEBT.S2*SalNumberPower(10,ZAY_DEBT.DIG))
									                                                                                                                     Else 
										                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							                                                                                                                     Else 
								                                                                                                                     If NOT (SalIsNull(ZAY_DEBT.S2) OR ZAY_DEBT.S2=0)
									                                                                                                                     If SalMessageBox( 'Вы действительно хотите '||PutCrLf(  )||
											                  '       сформировать заявку на продажу '||SalNumberToStrX( ZAY_DEBT.S1,2)||' '||ZAY_DEBT.ISO ||' и '||PutCrLf(  )||
											                  '       зачислить '||SalNumberToStrX(ZAY_DEBT.S2,2)||' '||ZAY_DEBT.ISO ||' на расчетный счет '||ZAY_DEBT.NMK||' ?', 'Внимание', MB_YesNo|MB_IconQuestion )=IDYES
										                                                                                                                     Call F_ZAYDEBT(ZAY_DEBT.TIP, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, ZAY_DEBT.S1*SalNumberPower(10,ZAY_DEBT.DIG), ZAY_DEBT.S2*SalNumberPower(10,ZAY_DEBT.DIG))
									                                                                                                                     Else 
										                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								                                                                                                                     Else 
									                                                                                                                     If SalMessageBox( 'Вы действительно хотите '||PutCrLf(  )||
											                  'сформировать заявку на продажу '||SalNumberToStrX( ZAY_DEBT.S1,2)||' '||ZAY_DEBT.ISO || PutCrLf(  )||
											                  'клиента '||ZAY_DEBT.NMK||' ?', 'Внимание', MB_YesNo|MB_IconQuestion )=IDYES
										                                                                                                                     Call F_ZAYDEBT(ZAY_DEBT.TIP, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, ZAY_DEBT.S1*SalNumberPower(10,ZAY_DEBT.DIG), 0)
									                                                                                                                     Else 
										                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                                                     Pushbutton: pbChild
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip = 'Показать связанные документы'
						                                                                                                                     On SAM_Click
							                                                                                                                     If not SalIsNull(REF)
								                                                                                                                     Call DocViewListInt(hWndMDI," a.ref IN (SELECT refd FROM zay_debt WHERE refd<>ref AND ref="||Str(ZAY_DEBT.REF)|| ")","Связанные документы для Реф."||Str(ZAY_DEBT.REF))
				                                                                                                                     Pushbutton: pbZAY
					                                                                                                                     Message Actions 
						                                                                                                                     On SAM_Create
							                                                                                                                     Set strTip = 'Оформить заявку на СВОБОДНУЮ продажу'
						                                                                                                                     On SAM_Click
							                                                                                                                     If TIP=2 AND ZAY=0
								                                                                                                                     Set nZAYSUM=SUM-F_ZAY_F(REF)-F_PAY_F(REF)
								                                                                                                                     If nZAYSUM>0
									                                                                                                                     If SalMessageBox( 'Вы действительно хотите сформировать '||PutCrLf(  )||
											                  'заявку на СВОБОДНУЮ продажу валюты '|| PutCrLf(  )||
											                  'клиента '||ZAY_DEBT.NMK||' ?', 'Внимание', MB_YesNo|MB_IconQuestion )=IDYES
										                                                                                                                     Call SalModalDialog( dlgSUM, ZAY_DEBT, ZAY_DEBT.nZAYSUM, ZAY_DEBT.nZAYSUM0)
										                                                                                                                     If nZAYSUM0>0
											                                                                                                                     Call F_ZAYDEBT(ZAY_DEBT.TIP, ZAY_DEBT.ACC, ZAY_DEBT.KV, ZAY_DEBT.REF, ZAY_DEBT.nZAYSUM0*SalNumberPower(10,ZAY_DEBT.DIG), 0)
								                                                                                                                     Else 
									                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							                                                                                                                     Else 
								                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		                                                                                                                     Contents 
			                                                                                                                     Column: KV
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: ISO
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: RNK
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: NMK
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: ACC
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: NLS
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: VDAT
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: REF
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: SUM
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: SUMs
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: DAT_5
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: TIP
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
					                                                                                                                     On SAM_AnyEdit
						                                                                                                                     If TIP=1 
							! VIP-клиент: вся сумма на 2600
							                                                                                                                     Set S1=NUMBER_Null
							                                                                                                                     Set S2=SUM-F_PAY_F(REF)
							                                                                                                                     Call SalDisableWindow( pb2 )
							                                                                                                                     Call SalDisableWindow( pbZAY )
						                                                                                                                     Else 
							! 50% - на обяз.продажу, 50% - на 2600
							                                                                                                                     Set S1=SUM/2
							                                                                                                                     Set S2=SUM-S1-F_PAY_F(REF)
							                                                                                                                     Call SalEnableWindow( pb2 )
			                                                                                                                     Column: ZAY
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: KB
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: S1
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: S1s
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: S2
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
					                                                                                                                     On SAM_Validate
						                                                                                                                     If SalIsNull(TIP) OR TIP=2
							                                                                                                                     If S2>SUM-S1-F_PAY_F(REF)
								                                                                                                                     Call SalMessageBox( 'Указанная сумма превышает допустимую!', 'Внимание', MB_IconStop )
								                                                                                                                     Return VALIDATE_OkClearFlag
							                                                                                                                     Else 
								                                                                                                                     Return VALIDATE_Ok
						                                                                                                                     Else 
							                                                                                                                     If S2>SUM-F_PAY_F(REF)
								                                                                                                                     Call SalMessageBox( 'Указанная сумма превышает допустимую!', 'Внимание', MB_IconStop )
								                                                                                                                     Return VALIDATE_OkClearFlag
							                                                                                                                     Else 
								                                                                                                                     Return VALIDATE_Ok
			                                                                                                                     Column: S2s
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: DNI
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
			                                                                                                                     Column: DIG
				                                                                                                                     List Values 
				                                                                                                                     Message Actions 
		                                                                                                                     Functions 
			                                                                                                                     Function: F_ZAYDEBT
				                                                                                                                     Description: Процедура оплаты
				                                                                                                                     Returns 
				                                                                                                                     Parameters 
					                                                                                                                     Number: nMod
					                                                                                                                     Number: nAcc
					                                                                                                                     Number: nKv
					                                                                                                                     Number: nRef
					                                                                                                                     Number: nSum1
					                                                                                                                     Number: nSum2
				                                                                                                                     Static Variables 
				                                                                                                                     Local variables 
					                                                                                                                     Number: nS
					                                                                                                                     Number: nBLK
					                                                                                                                     Number: nFetchRes
					                                                                                                                     Number: nTIP
					                                                                                                                     String: d27_1
					                                                                                                                     String: d27_2
					                                                                                                                     String: nNAZN
					                                                                                                                     Number: nSUMKB
					                                                                                                                     String: sFNAMEKB
					                                                                                                                     String: sIDKB
				                                                                                                                     Actions 
					                                                                                                                     Set nNAZN = ''
					! Если есть заявки, поступившие по КБ, привяжем их
					                                                                                                                     If KB=1
						                                                                                                                     Call SalMessageBox('Необходимо выбрать заявку, поступившую по системе Клиент-Банк!', 'Внимание', MB_IconExclamation)
						                                                                                                                     Call SalModalDialog(dlgZAY_KB, ZAY_DEBT, 1, ZAY_DEBT.RNK, ZAY_DEBT.KV, nSUMKB, sFNAMEKB, sIDKB)
						! If nSUMKB=NUMBER_Null OR nSUMKB!=nSum1
							                                                                                                                                                                                                   Call SalMessageBox('Суммы не совпадают!', 'Ошибка!', MB_IconStop)
							                                                                                                                                                                                                   Return 0
						! Сумма заявки = Сумме заявки, поступившей по КБ
						                                                                                                                     If nSUMKB = NUMBER_Null
							                                                                                                                     Call SalMessageBox('Не выбрана заявка!', 'Ошибка!', MB_IconStop)
							                                                                                                                     Return 0
						                                                                                                                     If nSUMKB > nSum1
							                                                                                                                     Call SalMessageBox('Сумма заявки превышает макс.допустимую!', 'Ошибка!', MB_IconStop)
							                                                                                                                     Return 0
						                                                                                                                     Else 
							                                                                                                                     Set nSum1 = nSUMKB
					!
					! Ввод доп.реквизитов для D#27 и корректировка назначения платежа
					! 1 - продажа 
					! 2 - зачисление на 2600
					! 3 - продажа + зачисление на 2600
					! 0 - зачисление на 2600 ГРН
					                                                                                                                     If SqlPrepareAndExecute(hSql(),"SELECT nazn INTO :nNAZN FROM oper WHERE ref=:nRef") 
						                                                                                                                     Call SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                     If nKv = GetBaseVal(  )
						                                                                                                                     Set nTIP = 0
					                                                                                                                     Else 
						                                                                                                                     If nSum1 != 0
							                                                                                                                     If nSum2 != 0
								                                                                                                                     Set nTIP = 3
							                                                                                                                     Else 
								                                                                                                                     Set nTIP = 1
						                                                                                                                     Else 
							                                                                                                                     Set nTIP = 2
					                                                                                                                     If not SalModalDialog( dlgD27, ZAY_DEBT, nTIP, d27_1, d27_2, nNAZN)
						                                                                                                                     Return FALSE
					                                                                                                                     Call SalWaitCursor(TRUE)
					                                                                                                                     If SqlPLSQLCommand(hSql(), "BARS.P_ZAYDEBT(nMod,nAcc,nRef,nSum1,nSum2,d27_1,d27_2,sFNAMEKB,sIDKB,nNAZN)")
						                                                                                                                     Call SqlCommit(hSql())
						                                                                                                                     Call SalWaitCursor(FALSE)
					                                                                                                                     Else 
						                                                                                                                     Call SqlRollback(hSql())
						                                                                                                                     Call SalWaitCursor(FALSE)
						                                                                                                                     Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'BARS.P_ZAYDEBT', 30, 1 )
					                                                                                                                     Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					                                                                                                                     Call SalWaitCursor(FALSE)
			                                                                                                                     Function: F_PAY_F
				                                                                                                                     Description: Вычисление выплат(sos>0) по данному РЕФ
				                                                                                                                     Returns 
					                                                                                                                     Number: 
				                                                                                                                     Parameters 
					                                                                                                                     Number: nRef
				                                                                                                                     Static Variables 
				                                                                                                                     Local variables 
					                                                                                                                     Number: nSP
					                                                                                                                     Number: nT
				                                                                                                                     Actions 
					                                                                                                                     Set bErrFlg=FALSE
					                                                                                                                     When SqlError
						                                                                                                                     Return FALSE
					                                                                                                                     If nRef!=NUMBER_Null
						! Проверка на наличие документа "на контроле"
						                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
								   "SELECT ref INTO :nT 
								    FROM zay_debt WHERE ref=:nRef" )
							                                                                                                                     If SqlFetchNext( hSqlAux2(), nFetchRes ) 
								! Проверка на урегулированность
								                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(),
										   "SELECT sum(decode(z.ref,z.refd,z.zay_sum,o2.s)) sum
										    FROM oper o1, oper o2, zay_debt z
										    WHERE o1.ref=z.ref AND o2.ref=z.refd AND
										          o1.sos=5     AND o2.sos=5      AND
										          z.ref=:nRef
										    GROUP BY z.ref, o1.s
										    HAVING o1.s<=sum(decode(z.ref,z.refd,z.zay_sum,o2.s))" )
										AND SqlFetchNext( hSqlAux2(), nFetchRes )
									! "Закрываем" документ
									                                                                                                                     If SqlPrepareAndExecute( hSqlAux2()," UPDATE zay_debt SET sos=1 WHERE ref=:nRef " )
										                                                                                                                     Set bErrFlg=FALSE
									                                                                                                                     Else 
										                                                                                                                     Set bErrFlg=TRUE
								! Ищем сумму проплат по данному документу
								                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
										   "SELECT sum(o.s)/power(10,t.dig) INTO  :nSP
										    FROM zay_debt z, oper o, oper o2, tabval t
										    WHERE z.ref=:nRef   AND o.ref=z.refd AND 
										          z.ref<>z.refd AND  o.sos>0 AND
										          z.ref=o2.ref  AND o2.kv=t.kv
										    GROUP BY t.dig" ) 
										AND not SqlFetchNext( hSqlAux2(), nFetchRes ) 
									                                                                                                                     Set nSP=0
							                                                                                                                     Else 
								! Документ свежий, заносим "на контроль" 
								                                                                                                                     If NOT SqlPrepareAndExecute( hSqlAux2(), 
										  "INSERT INTO zay_debt(ref,tip) VALUES (:nRef,:TIP)" )
									                                                                                                                     Set bErrFlg=TRUE
								                                                                                                                     Set nSP=0
						                                                                                                                     Return nSP
			                                                                                                                     Function: F_ZAY_F
				                                                                                                                     Description: Вычисление заявок по данному РЕФ
				                                                                                                                     Returns 
					                                                                                                                     Number: 
				                                                                                                                     Parameters 
					                                                                                                                     Number: nRef
				                                                                                                                     Static Variables 
				                                                                                                                     Local variables 
					                                                                                                                     Number: nSP
					                                                                                                                     Number: nT
				                                                                                                                     Actions 
					                                                                                                                     Set bErrFlg=FALSE
					                                                                                                                     When SqlError
						                                                                                                                     Return FALSE
					                                                                                                                     If nRef!=NUMBER_Null
						! Ищем сумму заявок по данному документу
						                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
								   "SELECT z.zay_sum/power(10,t.dig) INTO  :nSP FROM zay_debt z, oper o, tabval t 
								    WHERE z.ref=:nRef  AND z.ref=z.refd AND z.tip=2 AND
								          z.ref=o.ref AND o.kv=t.kv" ) 
								AND not SqlFetchNext( hSqlAux2(), nFetchRes ) 
							                                                                                                                     Set nSP=0
						                                                                                                                     Return nSP
			                                                                                                                     Function: F_COLOR
				                                                                                                                     Description: 
				                                                                                                                     Returns 
				                                                                                                                     Parameters 
					                                                                                                                     Number: nCOLOR
				                                                                                                                     Static Variables 
				                                                                                                                     Local variables 
				                                                                                                                     Actions 
					                                                                                                                     Call SalTblSetCellTextColor( ISO, nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( RNK, nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( NMK, nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( NLS, nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( VDAT,nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( REF, nCOLOR, FALSE )
					                                                                                                                     Call SalTblSetCellTextColor( SUM, nCOLOR, FALSE )
		                                                                                                                     Window Parameters 
		                                                                                                                     Window Variables 
			                                                                                                                     Date/Time: dDATA
			                                                                                                                     Number: nZAYSUM
			                                                                                                                     Number: nZAYSUM0
			                                                                                                                     Number: nFetchRes
			                                                                                                                     Number: nTmp
			                                                                                                                     String: sTmp
			                                                                                                                     Boolean: bErrFlg
			                                                                                                                     Number: nMaxDig
		                                                                                                                     Message Actions 
			                                                                                                                     On SAM_Create
				                                                                                                                     Call PrepareWindowEx(hWndForm)
				                                                                                                                     Call SetWindowFullSize( hWndForm )
				                                                                                                                     Call SalMapEnterToTab(TRUE)
				                                                                                                                     Set ZAY_DEBT.nTabInstance = 1
				                                                                                                                     Set ZAY_DEBT.strPrintFileName='ZAY_DEBT'
				                                                                                                                     Set ZAY_DEBT.strFilterTblName = 'OPER'
				                                                                                                                     Set dDATA=GetBankDate()
				                                                                                                                     Set ZAY_DEBT.strSqlPopulate =
						"SELECT c.rnk, c.nmk, a.acc, a.kv, t.lcv, a.nls,   
						        o.ref, o.s/power(10,t.dig),  o.fdat, dat_next_u(o.fdat,4), t.dig 
						INTO   :ZAY_DEBT.RNK,  :ZAY_DEBT.NMK,      
						       :ZAY_DEBT.ACC,  :ZAY_DEBT.KV, :ZAY_DEBT.ISO, :ZAY_DEBT.NLS,   
						       :ZAY_DEBT.REF, :ZAY_DEBT.SUM, :ZAY_DEBT.VDAT, :ZAY_DEBT.DAT_5, :ZAY_DEBT.DIG 
						FROM   accounts a,  opldok o,    oper,   
						       cust_acc ca, customer c , tabval t      
						WHERE  a.acc=o.acc         AND o.ref=oper.ref AND o.tt=oper.tt AND  
						       ca.acc=a.acc        AND c.rnk=ca.rnk   AND t.kv=a.kv    AND 
						       o.fdat=bankdate     AND o.dk=1         AND o.sos=5      AND 
						       a.nbs='2603'        AND 
						       o.ref NOT IN (SELECT DISTINCT ref FROM zay_debt)  
						UNION ALL  
						SELECT c.rnk, c.nmk, a.acc, a.kv, t.lcv, a.nls,   
						       oper.ref, oper.s/power(10,t.dig), oper.vdat, dat_next_u(oper.vdat,4), t.dig       
						FROM   accounts a, oper, cust_acc ca, customer c, tabval t, zay_debt z     
						WHERE  a.nls=decode(oper.dk,1,oper.nlsb,oper.nlsa)  AND 
						       a.kv=oper.kv    AND a.nbs = '2603'           AND   
						       ca.acc=a.acc    AND c.rnk=ca.rnk             AND 
						       t.kv=a.kv       AND oper.sos=5               AND    
						       oper.ref=z.ref  AND z.sos=0                  AND 
						       z.refd IS NULL      
						ORDER BY  4, 1, 9 "
				                                                                                                                     If ZAY_DEBT.KV!=GetBaseVal(  )
					                                                                                                                     Set ZAY_DEBT.strSqlUpdate =
							  "UPDATE zay_debt SET tip=:ZAY_DEBT.TIP WHERE ref=:ZAY_DEBT.REF"
				                                                                                                                     Set nMaxDig = DigInit()
				                                                                                                                     Set nMaxDig = IifN(nMaxDig=-1, 4, nMaxDig)
				                                                                                                                     Call SalSendClassMessage(SAM_Create, 0, 0)
			                                                                                                                     On SAM_FetchRowDone
				! ГРИВНА??? - тогда никаких заявок!
				                                                                                                                     If KV=GetBaseVal(  )
					                                                                                                                     Set TIP=1
				! По умолчанию: Сумма+Заявка 
				                                                                                                                     Else 
					                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
							      "SELECT nvl(tip,2) INTO :ZAY_DEBT.TIP 
							       FROM zay_debt 
							       WHERE ref=:ZAY_DEBT.REF" ) 
							AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
						                                                                                                                     Set TIP=2
				! Была ли заявка?
				                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
						      "SELECT 1 INTO :ZAY_DEBT.ZAY 
						       FROM zay_debt 
						       WHERE refd=ref AND ref=:ZAY_DEBT.REF" ) 
						AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
					                                                                                                                     Set ZAY=0
				                                                                                                                     If TIP=2 
					                                                                                                                     If ZAY=0 
						                                                                                                                     Set S1=SUM/2
						                                                                                                                     Call SalTblSetCellTextColor( S1, COLOR_Black, FALSE )
					                                                                                                                     Else 
						                                                                                                                     Set S1=F_ZAY_F(REF)
						                                                                                                                     Call SalTblSetCellTextColor( S1, COLOR_Blue, FALSE )
					                                                                                                                     Set S2=SUM-S1-F_PAY_F(REF)
				                                                                                                                     Else 
					                                                                                                                     Set S1=NUMBER_Null
					                                                                                                                     Set S2=SUM-F_PAY_F(REF)
				! Раскраска должников
				! Set DNI=dDATA-VDAT+1
				                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
						   " SELECT count(*) INTO :DNI FROM fdat
						     WHERE fdat>=:VDAT AND fdat<=:dDATA " )
						AND SqlFetchNext( hSqlAux2(), nFetchRes )
				                                                                                                                     If DNI >=5
					                                                                                                                     Call F_COLOR( COLOR_Red )
				                                                                                                                     Else If DNI =4
					! Call SetTblRowColor( ZAY_DEBT, COLOR_Blue )
					                                                                                                                     Call F_COLOR( COLOR_Blue )
				                                                                                                                     Else 
					! Call SetTblRowColor( ZAY_DEBT, COLOR_Black )
					                                                                                                                     Call F_COLOR( COLOR_Black )
				! Наличие заявок, пришедших по Клиент-Банку
				                                                                                                                     If SqlPrepareAndExecute( hSqlAux2(), 
						   "SELECT 1 INTO :ZAY_DEBT.KB FROM zay_debt_klb 
						    WHERE rnk=:ZAY_DEBT.RNK AND kv2=:ZAY_DEBT.KV AND datz>=:ZAY_DEBT.VDAT" ) 
						AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
					                                                                                                                     Set KB=0
				!
				                                                                                                                     Set SUMs = Dig4(SUM*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				                                                                                                                     Set S1s  = Dig4(S1*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				                                                                                                                     Set S2s  = Dig4(S2*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
			                                                                                                                     On SAM_RowSetContext
				                                                                                                                     If TIP=2
					                                                                                                                     If ZAY=0 
						                                                                                                                     Set S1=SUM/2
						                                                                                                                     Call SalTblSetCellTextColor( S1, COLOR_Black, FALSE )
						                                                                                                                     Call SalEnableWindow( pbZAY )
					                                                                                                                     Else 
						                                                                                                                     Set S1=F_ZAY_F(REF)
						                                                                                                                     Call SalDisableWindow( pbZAY )
						                                                                                                                     Call SalTblSetCellTextColor( S1, COLOR_Blue, FALSE )
					                                                                                                                     Set S2=SUM-S1-F_PAY_F(REF)
					                                                                                                                     Call SalEnableWindow( pb2 )
				                                                                                                                     Else 
					                                                                                                                     Set S1=NUMBER_Null
					                                                                                                                     Set S2=SUM-F_PAY_F(REF)
					                                                                                                                     Call SalDisableWindow( pb2 )
					                                                                                                                     Call SalDisableWindow( pbZAY )
			                                                                                                                     On UM_Populate
				                                                                                                                     Call SalSendClassMessage( UM_Populate, wParam, lParam )
				                                                                                                                     If NOT bErrFlg
					                                                                                                                     Call SqlCommit( hSqlAux2() )
				                                                                                                                     Else 
					                                                                                                                     Call SqlRollback( hSqlAux2() )
	Table Window: ZAYV_BUY
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Визирование введенных сделок (покупка)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  23.267"
				Width Editable? Class Default
				Height: 6.024"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Sky
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description: Визирование введенных сделок(ПОКУПКА)
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть с визирования'
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_BUY,  UM_Delete,   0, 0)
								Call SalPostMsg(ZAYV_BUY,  UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.45"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завизировать'
						On SAM_Click
							If MessageQuestion('Будут визированы все отмеченные заявки. Продолжать ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_BUY, SAM_User, 0, 0)
								Call SalPostMsg(ZAYV_BUY, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 1010
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.55"
						Begin Y:  Class Default
						End X:  5.55"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1011
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.9"
						Begin Y:  Class Default
						End X:  2.9"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1012
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.1"
						Begin Y:  -0.012"
						End X:  0.1"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbPrintZay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.9"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать заявки"
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите распечатать отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_BUY,  UM_Print,    0, 0)
								Call SalPostMsg(ZAYV_BUY,  UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbPrintZayCorp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.35"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Просмотр и печать заявки CORP2"
						On SAM_Click
							Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV_BUY.ID)),6)||'.DOC'
							If NOT PutBlobToFile(
									          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAYV_BUY.ID,          '',          '')
								Call SalFileOpen(hFile, sFileName, OF_Delete)
								Call SalWaitCursor(FALSE)
								Return FALSE
							If sFileName != STRING_Null
								! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
										                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
										                           'Печать сформированной заявки',
										                           MB_IconQuestion|MB_YesNoCancel )
								Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
										                          'Просмотр и печать заявки CORP2',
										                          MB_IconQuestion|MB_YesNo )
								If nPrint = IDYES
									Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
									! Call DirectView(sFileName)
				Check Box: cb_CONV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За ВАЛЮТУ
					Window Location and Size
						Left:   3.2"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_Click
							! Call InitSqlStr()
							Call SalSendMsg (hWndForm, UM_Populate, 0, 0)
							If cb_CONV
								Call SalTblSetColumnTitle(KURS_Z, PutCrLf() || 'Курс' || PutCrLf() || 'конверсии')
							Else
								Call SalTblSetColumnTitle(KURS_Z, PutCrLf() || 'Курс' || PutCrLf() || 'покупки')
		Contents
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пок
						Прод
				Visible? No
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Right
				Width:  0.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Флаг
						блок.
						ГРН.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIZA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В
						и
						з
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV_CONV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЗА
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						№
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						РНК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента-
						покупателя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отделение
						клиента-
						покупателя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						списания
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет для
						списания
						ср-в на покупку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сальдо
						счета
						списания
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет для
						зачисления
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						заявл.
						 ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						покупки
						 ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KURS_Z
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Курс
						покупки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Дата
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						%
						ком
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SKOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						или
						сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приоритет
						заявки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbPRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: 
						Приоритет
						заявки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If cbPRIORITY.Init(hWndItem)
							Call cbPRIORITY.Populate(hSql(), "id", "name", " zay_priority "," where active = 1 order by id")
					On SAM_AnyEdit
						Set PRIORITY = cbPRIORITY.GetKey(SalListQuerySelection(cbPRIORITY))
			Column: OKPO0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						 Клиента
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Цель
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Конт-
						
						№
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ракт
						
						дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						№
						ТД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Дата
						ТД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Даты
						других
						ТД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осно-
						вание
						покуп.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						переч.
						вал.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						бенефе-
						циара
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: D9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Код
						банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наиме-
						нование
						банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						товарн.
						группы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DC2C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						покупки
						за имп.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DP2C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						операции
						(#2C)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Цель
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Конт
						ракт
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						контр.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						посл.
						ВМД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  0.583"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Даты
						других
						ВМД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						переч.
						вал.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осно-
						вание
						покуп.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страна
						бенефе-
						циара
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DV9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						банка
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: DVC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № посл.
						тамож.декларации
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? No
				List Values
				Message Actions
			Column: MFOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						МФО 
						ПФ
				Visible? Yes
				Editable? No
				Maximum Data Length: 6
				Data Type: String
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Счет
						ПФ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Код ОКПО 
						ПФ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Коментарий
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COVERED
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OPT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REQ_TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						заявки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbREQ_TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Наименование
						типа заявки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						Call cbREQ_TYPE.Init(hWndItem)
						Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
			Column: Code2c
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код купівлі
						за імпортом
						(#2C)
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P12_2C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ознака 
						операції
						(#2C)
				Visible? No
				Editable? No
				Maximum Data Length: 10
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If P12_2C=STRING_Null
							Set cbP12_2C=STRING_Null
							Return VALIDATE_Ok
						Call cbP12_2C.SetSelectById( P12_2C )
						If cbP12_2C.strCurrentId
							Call SalSendMsg( cbP12_2C, SAM_Click, 0, 0 )
							Return VALIDATE_Ok
						Else
							Call SalMessageBox( 'Неверно указан код показателя #2C', 'Ошибка!', MB_IconStop )
							Return VALIDATE_Cancel
			Column: cbP12_2C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Код
						признака 
						операции
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.933"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						Call cbP12_2C.Init(hWndItem)
						Call cbP12_2C.Populate(hSql(), "code",  "substr(txt,1,100)", " v_p12_2c "," ORDER BY code ")
						Call cbP12_2C.SetSelectById( P12_2C )
						Call SalListSetSelect(hWndItem, 0)
						Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
					On SAM_AnyEdit
						Set P12_2C = cbP12_2C.GetKey( SalListQuerySelection( cbP12_2C))
		Functions
			Function: F_RESERVE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nIdZay
					Number: nBlk
				Static Variables
				Local variables
					String: sMsg
					Number: nSumB
					Number: nDK
				Actions
					If nReserve = 0
						Return TRUE
					Else
						If nBlk = 0
							If SqlPrepareAndExecute(hSql(), 
									  "SELECT dk 
									     INTO :nDK
									     FROM zayavka
									    WHERE id = :nIdZay") 
									AND SqlFetchNext(hSql(), nFetchRes)
								If nDK != 3
									If SalMessageBox('Вы действительно хотите отказаться от блокировки гривны, '||PutCrLf(  )||
											                 'необходимой для покупки валюты по заявке №'||Str(nIdZay)||'?', 
											                 'Внимание', 
											                 MB_IconExclamation|MB_YesNo ) = IDNO
										Return FALSE
									Else
										Call SaveInfoToLog('ZAY. Пользователь отказался от блокировки гривны, необходимой на покупку валюты по заявке №'||Str(nIdZay))
										Return TRUE
								Else
									! Call Debug (Str(nDK))
									Return TRUE
						Else
							If SqlPLSQLCommand(hSql(), "p_zay_reserve(1,nIdZay,nSumB,sMsg)")
								If sMsg != STRING_Null AND nSumB = 0
									Call MessageInfo(sMsg)
									Return FALSE
								Else
									Return TRUE
							Else
								Return FALSE
			Function: F_CHECK_DATA
				Description:
				Returns
					Boolean:
				Parameters
					Number: nBuySell
					Number: nId
					Number: nCurrency
					Number: nAmount
					Number: nRate
					Date/Time: dDate
					Number: nOpt
				Static Variables
				Local variables
					String: sMsg
					Number: nCount
					Number: nRnk
				Actions
					! валюта не заблокирована дилером
					If not BKL_KV(nCurrency)
						Return FALSE
					! сумма заявки
					If nAmount = 0 OR nAmount = NUMBER_Null 
						Call SalMessageBox('Не указана сумма заявки № '||Str(nId)||'!', 
								                   'Заявка не может быть завизирована', 
								                    MB_IconExclamation)
						Return FALSE
					! дата заявки
					If dDate = DATETIME_Null 
						Call SalMessageBox('Не указана дата заявки № '||Str(nId)||'!',  
								                   'Заявка не может быть завизирована', 
								                   MB_IconExclamation)
						Return FALSE
					! курс заявки
					If nRate  = 0 OR nRate = NUMBER_Null 
						Set nRate = GetDilerRate (nBuySell, nCurrency, KV_CONV)
						If nRate != NUMBER_Null AND nRate != 0 
							If SalMessageBox ('Установить предварительный курс дилера  '||Str(nRate)||
									                  ' для заявки №'||Str(nId)||'?', 
									                  'Внимание', 
									                  MB_IconExclamation|MB_YesNo) = IDYES
								If nBuySell = 1 or nBuySell = 3
									Set ZAYV_BUY.KURS_Z = nRate
								! Else
									                                                                                                   Set ZAYV_BUY2.KURS_Z = nRate
								If SqlPrepareAndExecute(hSql(), "UPDATE zayavka SET kurs_z =:nRate WHERE id = :nId")
									Call SqlCommitEx(hSql(), 'ГОУ. Пользователь установил курс '||Str(nRate)||' для заявки № '||Str(nId))
								Else
									Call SqlRollbackEx(hSql(), 'ГОУ. Пользователь не смог установить курс для заявки № '||Str(nId))
									Return FALSE
							Else
								Return FALSE
						Else
							If nBuySell != 3
								Call SalMessageBox('Не указан курс заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                   MB_IconExclamation)
								Return FALSE
					! If nBuySell = 1 or nBuySell = 3
					If nBuySell = 1
						If nOpt = 1
							! цель заявки
							If NOT ZAYV_BUY.D1 
								Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.D2 
								Call SalMessageBox('Не указан № контракта заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.D3 
								Call SalMessageBox('Не указана дата контракта заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.D6 
								Call SalMessageBox('Не указана страна перечисления валюты заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							! основание для покупки валюты
							If NOT ZAYV_BUY.D7 
								Call SalMessageBox('Не указано основание для покупки валюты заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.D8 
								Call SalMessageBox('Не указана страна бенефециара заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.D9 
								Call SalMessageBox('Не указан код иностранного банка заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.DA 
								Call SalMessageBox('Не указано наименование иностранного банка заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.Code2c 
								Call SalMessageBox('Не указан код покупки за импортом #2C заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							If NOT ZAYV_BUY.P12_2C 
								Call SalMessageBox('Не указана ознака операции #2C заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								Return FALSE
							! код товарной группы
							! If NOT ZAYV_BUY.DB 
								                                                                                                     Call SalMessageBox('Не указан код товарной группы заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								                                                                                                     Return FALSE
					! Else
						! цель заявки
						                                                                                                   If SalStrTrimX(ZAYV_BUY2.META) = STRING_Null
							                                                                                                   Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                    MB_IconExclamation)
							                                                                                                   Return FALSE
					! перевірка клієнта–резидента (покупця іноз. валюти) по коду ЄДРПОУ 
					! на застосування санкцій до суб'єктів зовнішньоекономічної діяльності України та іноземних суб'єктів господарської діяльності, 
					! передбачених статтею 37 Закону України "Про зовнішньоекономічну діяльність" (98 файл). 
					If OKPO0 != STRING_Null and Subs(OKPO0, 1, 5) != '00000'
						Call SqlPrepareAndExecute(hSql(), "select rnk into :nRnk from customer where okpo = :OKPO0")
						Call SqlFetchNext(hSql(), nFetchRes)
						!
						Call SqlPrepareAndExecute(hSql(), "select f_client_check_sanction(:nRnk, bankdate) into :nCount from dual")
						Call SqlFetchNext(hSql(), nFetchRes)
						If nCount >1
							If SalMessageBox("До клієнта застосовано санкції. Продовжити операцію?", "Увага", MB_IconExclamation | MB_YesNo) = IDNO
								Call SaveInfoToLog("До клієнта (ЗКПО " || OKPO0 || ") застосовано санкції. Продовжити операцію? - Користувач обрав НІ")
								Return FALSE
							Call SaveInfoToLog("До клієнта (ЗКПО " || OKPO0 || ") застосовано санкції. Продовжити операцію? - Користувач обрав ТАК")
					Return TRUE
			Function: SET_PRIORITY
				Description:
				Returns
					Boolean:
				Parameters
					Number: pReqId
					Number: pBuySell
					Number: pCoverFl
					Number: pPriorId
				Static Variables
				Local variables
				Actions
					If pBuySell != 3
						If pCoverFl = 0 AND pPriorId != nCovered AND nCovered > 0
							If SalMessageBox ('Заявка № '||Str(pReqId)||' не обеспечена средствами. '||PutCrLf()||
									                  'Вы действительно хотите завизировать заявку с приоритетом № '||Str(nCovered)||'?',
									                  'Внимание', 
									                   MB_IconExclamation|MB_YesNo) = IDYES
								If pBuySell = 1 
									Set ZAYV_BUY.PRIORITY = nCovered
								! Else
									                                                                                                   Set ZAYV_BUY2.PRIORITY = nCovered
							Else
								Return FALSE
						Return TRUE
					Else
						Return TRUE
		Window Parameters
		Window Variables
			String: strDSql
			String: strDFilter
			Number: nNextRow
			Number: nPF
			Number: nCovered
			Number: nReserve
			String: sStornoReasonId
			String: sStornoReason
			Number: nStornoReasonId
			!
			Number: nPrntBuy
			Number: nPrntSal
			String: sFileName
			Number: nPrint
			Number: nRet
			File Handle: hFile
			Number: nPR_CORP2
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Set ZAYV_BUY.strFilterTblName = 'V_ZAY_QUEUE'
				!
				Call BIRZA( 'PR_CORP2',   nPR_CORP2  )
				Set cb_CONV = FALSE
				Call SalHideWindow(ZAYV_BUY.KV_CONV)
				If nPR_CORP2 = 1
					Call SalShowWindow(pbPrintZayCorp)
				Else
					Call SalHideWindow(pbPrintZayCorp)
				! Печать заявок
				If SqlPrepareAndExecute(hSql(),
						  "SELECT nvl(max(decode(par, 'PRNT_BUY', to_number(val), null)), -1),
						          nvl(max(decode(par, 'PRNT_SAL', to_number(val), null)), -1)
						     INTO :nPrntBuy, :nPrntSal
						     FROM birja  
						    WHERE par in ('PRNT_BUY', 'PRNT_SAL')")
						 and not SqlFetchNext(hSql(), nFetchRes)
					Set nPrntBuy = -1
					Set nPrntSal = -1
				If nPrntBuy = -1 AND nPrntSal = -1
					Call SalDisableWindow(pbPrintZay)
				! Пенсионный Фонд
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT to_number(val) 
						     INTO :nPF 
						     FROM birja
						    WHERE par = 'PEN_FOND'") 
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nPF = 0
				If nPF = 0
					Call SalHideWindow(ZAYV_BUY.MFOP)
					Call SalHideWindow(ZAYV_BUY.NLSP)
					Call SalHideWindow(ZAYV_BUY.OKPOP)
				! Резервирование гривны на покупку валюты
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT to_number(val) 
						     INTO :nReserve
						     FROM birja
						    WHERE par = 'RESERV'") 
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nReserve = 0
				If nReserve != 1
					Call SalHideWindow(ZAYV_BUY.BLK)
				! If nReserve = 1
					                                                                                              Call SalShowWindow(ZAYV_BUY.BLK)
				! Else
					                                                                                              Call SalHideWindow(ZAYV_BUY.BLK)
				! Приоритет для гарантированных заявок
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT to_number(val) 
						     INTO :nCovered
						     FROM birja
						    WHERE par = 'COVERED'") 
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nCovered = 0
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call cF.Init(strFilterTblName, "v")
			On SAM_RowSetContext
				If ZAYV_BUY.KB != STRING_Null
					Call SalEnableWindow(pbPrintZayCorp)
				Else
					Call SalDisableWindow(pbPrintZayCorp)
			On UM_Populate
				Set strDFilter = cF.GetFilterWhereClause(TRUE)
				! Показать-спрятать покупку за валюту
				If cb_CONV
					Call SalHideWindow(ZAYV_BUY.BLK)
					Call SalShowWindow(ZAYV_BUY.KV_CONV)
					Set ZAYV_BUY.strSqlPopulate =
							   "SELECT v.kv2,          v.dk,           v.id,            v.fdat,
							           v.rnk,          v.nmk,  v.cust_branch,   v.s2,   v.kurs_z,
							           v.acc0,         v.nls_acc0,     v.ostc0/100,     v.okpo0,
							           v.acc1,         v.nls,          v.kom,           v.skom,
							           v.mfop,         v.nlsp,         v.okpop,         v.dig,
							           SubStr( v.full_meta, 1, 100 ),
							           v.contract,     v.dat2_vmd,     v.dat_vmd,       v.dat5_vmd,
							           SubStr(to_char(c.COUNTRY,'FM000')||' '||c.name,1,100),
							           SubStr(k7.p63||' '||k7.txt,1,150),
							           bc.name,
							           v.bank_code,    v.bank_name,    SubStr( full_product_group, 1, 100 ), v.num_vmd,
							           v.viza,         v.priority,     v.priorname,  v.comm,
							           bars_zay.get_request_cover(v.id), v.verify_opt, v.identkb, v.kv_conv, v.req_type, v.code_2c, v.p12_2c
							      INTO :ZAYV_BUY.KV1,  :ZAYV_BUY.DK,   :ZAYV_BUY.ID,    :ZAYV_BUY.DAT,
							           :ZAYV_BUY.RNK,  :ZAYV_BUY.NMK, :ZAYV_BUY.BRANCH, :ZAYV_BUY.S2,    :ZAYV_BUY.KURS_Z,
							           :ZAYV_BUY.ACC0, :ZAYV_BUY.NLS0, :ZAYV_BUY.S0,    :ZAYV_BUY.OKPO0,
							           :ZAYV_BUY.ACC1, :ZAYV_BUY.NLS1, :ZAYV_BUY.KOM,   :ZAYV_BUY.SKOM,
							           :ZAYV_BUY.MFOP, :ZAYV_BUY.NLSP, :ZAYV_BUY.OKPOP, :ZAYV_BUY.DIG,
							           :ZAYV_BUY.DV1,  :ZAYV_BUY.DV2,  :ZAYV_BUY.DV3,   :ZAYV_BUY.DV4,
							           :ZAYV_BUY.DV5,  :ZAYV_BUY.DV6,  :ZAYV_BUY.DV7,   :ZAYV_BUY.DV8,
							           :ZAYV_BUY.DV9,  :ZAYV_BUY.DVA,  :ZAYV_BUY.DVB,   :ZAYV_BUY.DVC,
							           :ZAYV_BUY.VIZA, :ZAYV_BUY.PRIORITY, :ZAYV_BUY.cbPRIORITY, :ZAYV_BUY.COMM,
							           :ZAYV_BUY.COVERED, :ZAYV_BUY.OPT, :ZAYV_BUY.KB, :ZAYV_BUY.KV_CONV, :ZAYV_BUY.REQ_TYPE, :ZAYV_BUY.Code2c, :ZAYV_BUY.P12_2C
							      FROM v_zay_queue v,
							           country     c,
							           country     bc, v_kod_70_2 k7
							     WHERE v.sos          = 0
							       AND v.dk           = 3
							       AND v.viza        <= 0
							       AND v.country      = c.country(+)
							       AND v.benefcountry = bc.country(+)
							       AND v.basis = k7.p63(+)
							       and mfo = f_ourmfo" || IifS(strDFilter='', "", " and " || strDFilter) || "
							     ORDER BY v.kv2, v.id desc"
				Else
					If nReserve = 1
						Call SalShowWindow(ZAYV_BUY.BLK)
					Else
						Call SalHideWindow(ZAYV_BUY.BLK)
					Call SalHideWindow(ZAYV_BUY.KV_CONV)
					Set ZAYV_BUY.strSqlPopulate =
							   "SELECT v.kv2,          v.dk,           v.id,            v.fdat,
							           v.rnk,          v.nmk,  v.cust_branch,   v.s2,   v.kurs_z,
							           v.acc0,         v.nls_acc0,     v.ostc0/100,     v.okpo0,
							           v.acc1,         v.nls,          v.kom,           v.skom,
							           v.mfop,         v.nlsp,         v.okpop,         v.dig,
							           SubStr( v.full_meta, 1, 100 ),
							           v.contract,     v.dat2_vmd,     v.dat_vmd,       v.dat5_vmd,
							           SubStr(to_char(c.COUNTRY,'FM000')||' '||c.name,1,100),
							           SubStr(k7.p63||' '||k7.txt,1,150),
							           bc.name,
							           v.bank_code,    v.bank_name,    SubStr( full_product_group, 1, 100 ), v.num_vmd,
							           v.viza,         v.priority,     v.priorname,  v.comm,
							           bars_zay.get_request_cover(v.id), v.verify_opt, v.identkb, v.kv_conv, v.req_type, v.code_2c, v.p12_2c
							      INTO :ZAYV_BUY.KV1,  :ZAYV_BUY.DK,   :ZAYV_BUY.ID,    :ZAYV_BUY.DAT,
							           :ZAYV_BUY.RNK,  :ZAYV_BUY.NMK, :ZAYV_BUY.BRANCH, :ZAYV_BUY.S2,    :ZAYV_BUY.KURS_Z,
							           :ZAYV_BUY.ACC0, :ZAYV_BUY.NLS0, :ZAYV_BUY.S0,    :ZAYV_BUY.OKPO0,
							           :ZAYV_BUY.ACC1, :ZAYV_BUY.NLS1, :ZAYV_BUY.KOM,   :ZAYV_BUY.SKOM,
							           :ZAYV_BUY.MFOP, :ZAYV_BUY.NLSP, :ZAYV_BUY.OKPOP, :ZAYV_BUY.DIG,
							           :ZAYV_BUY.DV1,  :ZAYV_BUY.DV2,  :ZAYV_BUY.DV3,   :ZAYV_BUY.DV4,
							           :ZAYV_BUY.DV5,  :ZAYV_BUY.DV6,  :ZAYV_BUY.DV7,   :ZAYV_BUY.DV8,
							           :ZAYV_BUY.DV9,  :ZAYV_BUY.DVA,  :ZAYV_BUY.DVB,   :ZAYV_BUY.DVC,
							           :ZAYV_BUY.VIZA, :ZAYV_BUY.PRIORITY, :ZAYV_BUY.cbPRIORITY, :ZAYV_BUY.COMM,
							           :ZAYV_BUY.COVERED, :ZAYV_BUY.OPT, :ZAYV_BUY.KB, :ZAYV_BUY.KV_CONV, :ZAYV_BUY.REQ_TYPE, :ZAYV_BUY.Code2c, :ZAYV_BUY.P12_2C
							      FROM v_zay_queue v,
							           country     c,
							           country     bc, v_kod_70_2 k7
							     WHERE v.sos          = 0
							       AND v.dk           = 1
							       AND v.viza        <= 0
							       AND v.country      = c.country(+)
							       AND v.benefcountry = bc.country(+)
							       AND v.basis = k7.p63(+)
							       and mfo = f_ourmfo" || IifS(strDFilter='', "", " and " || strDFilter) || "
							     ORDER BY v.kv2, v.id desc"
				Call ReInitQueryString()
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				! Тип заявки
				If REQ_TYPE = NUMBER_Null
					Set cbREQ_TYPE = STRING_Null
				Else
					Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
				If DK = 3
					Set BLK = 0
				Else
					Set BLK = 1
				Set S2s = Dig4(S2/100, DIG, 4)
				!
				If VIZA = -1
					Call SetTblRowColor(ZAYV_BUY, COLOR_DarkRed)
				! Подсказка о нехватке ГРН на счете
				If COVERED = 0
					Call SalTblSetCellTextColor(ZAYV_BUY.S0, COLOR_Red, FALSE)
				!
				Set D1 = IifN(SalStrTrimX(DV1) = STRING_Null,   0, 1)
				Set D2 = IifN(DV2 = STRING_Null,   0, 1)
				Set D3 = IifN(DV3 = DATETIME_Null, 0, 1)
				Set D4 = IifN(DV4 = DATETIME_Null, 0, 1)
				Set D5 = IifN(DV5 = STRING_Null,   0, 1)
				Set D6 = IifN(DV6 = STRING_Null,   0, 1)
				Set D7 = IifN(SalStrTrimX(DV7) = STRING_Null,   0, 1)
				! Call SaveInfoToLog('DV7='||DV7)
				Set D8 = IifN(DV8 = STRING_Null,   0, 1)
				Set D9 = IifN(DV9 = STRING_Null,   0, 1)
				Set DA = IifN(DVA = STRING_Null,   0, 1)
				Set DB = IifN(SalStrTrimX(DVB) = STRING_Null,   0, 1)
				Set DC = IifN(DVC = STRING_Null,   0, 1)
				Set DC2C = IifN(Code2c = STRING_Null,   0, 1)
				Set DP2C = IifN(P12_2C = STRING_Null,   0, 1)
				!
			On UM_Delete
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYV_BUY, nNextRow, ROW_Selected, 0)      
					Call SalTblSetContext(ZAYV_BUY, nNextRow)
					Call BackRequest(2, 1, ID, RNK, NMK, SalStrTrimX(S2s), Str(KV1))
			On UM_Print
				If nPrntBuy = -1
					Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
				Else
					Set nNextRow = TBL_MinRow
					While SalTblFindNextRow(ZAYV_BUY, nNextRow, ROW_Selected, 0)      
						Call SalTblSetContext(ZAYV_BUY, nNextRow)
						Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV_BUY.ID)),6)||'.TXT'
						Call ExportCatQuery(nPrntBuy,
								                      sFileName,
								                      3,
								                      ":ZAY_ID='"||SalStrTrimX(Str(ZAYV_BUY.ID))||"'",
								                      FALSE)
						If sFileName != STRING_Null
							Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
									                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
									                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
									                           'Печать сформированной заявки',
									                           MB_IconQuestion|MB_YesNoCancel )
							If nPrint = IDYES
								Call DirectView(sFileName)
							If nPrint = IDNO
								Call DosDirectPrint(sFileName)
			On SAM_User
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYV_BUY, nNextRow, ROW_Selected, 0)
					Call SalTblSetContext(ZAYV_BUY, nNextRow)
					!
					If F_CHECK_DATA  ( ZAYV_BUY.DK, 
							                   ZAYV_BUY.ID, 
							                   ZAYV_BUY.KV1, 
							                   ZAYV_BUY.S2, 
							                   ZAYV_BUY.KURS_Z, 
							                   ZAYV_BUY.DAT, 
							                   ZAYV_BUY.OPT)
							AND F_RESERVE    ( ZAYV_BUY.ID, 
							                   ZAYV_BUY.BLK)
							AND SET_PRIORITY ( ZAYV_BUY.ID, 
							                   ZAYV_BUY.DK,
							                   ZAYV_BUY.COVERED, 
							                   ZAYV_BUY.PRIORITY)
						! Call SqlPrepareAndExecute(cMain.hSql(),
								    "UPDATE zayavka
								        SET viza     = 1,
								            priority = :ZAYV_BUY.PRIORITY
								      WHERE dk       in (1,3)
								        AND id       = :ZAYV_BUY.ID")
						If not SqlPLSQLCommand(cMain.hSql(), "bars_zay.set_visa(ZAYV_BUY.ID, 1, ZAYV_BUY.PRIORITY, NUMBER_Null, NUMBER_Null)")
							Call SqlRollback(cMain.hSql())
							Return FALSE
						Call SqlCommit(cMain.hSql())
						Call SaveInfoToLog("ZAY. Завизирована заявка № "||Str(ZAYV_BUY.ID)
								                 ||" клиента "                  ||Str(ZAYV_BUY.RNK)
								                 ||" на покупку "               ||SalStrTrimX(ZAYV_BUY.S2s)
								                 ||"/"                          ||Str(ZAYV_BUY.KV1)
								                 ||", приоритет "               ||Str(ZAYV_BUY.PRIORITY))
						! Call SalTblDefineSplitWindow(ZAYV_BUY, 0, FALSE)
				! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_DoubleClick
				If SalModalDialog(dlgZAY_DR, 
						                    ZAYV_BUY, ZAYV_BUY.ID, ZAYV_BUY.DK, ZAYV_BUY.OPT,
						                    ZAYV_BUY.DV1, ZAYV_BUY.DV2, 
						                    ZAYV_BUY.DV3, ZAYV_BUY.DV4, 
						                    ZAYV_BUY.DV5, ZAYV_BUY.DV6,
						                    ZAYV_BUY.DV7, ZAYV_BUY.DV8,
						                    ZAYV_BUY.DV9, ZAYV_BUY.DVA, 
						                    ZAYV_BUY.DVB, ZAYV_BUY.DVC, ZAYV_BUY.Code2c, ZAYV_BUY.P12_2C)
					Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
	Table Window: ZAYV_SAL
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Визирование введенных сделок (продажа)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  23.683"
				Width Editable? Class Default
				Height: 5.679"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Light Green
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description: Визирование введенных сделок(ПРОДАЖА)
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вернуть с визирования'
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_SAL,  UM_Delete,   0, 0)
								Call SalPostMsg(ZAYV_SAL,  UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.45"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завизировать'
						On SAM_Click
							If MessageQuestion('Будут визированы все отмеченные заявки. Продолжать ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_SAL,  SAM_User, 0, 0)
								Call SalPostMsg(ZAYV_SAL,  UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 34607
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.55"
						Begin Y:  Class Default
						End X:  5.55"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 34608
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.9"
						Begin Y:  0.0"
						End X:  2.9"
						End Y:  0.6"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 34609
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.1"
						Begin Y:  -0.012"
						End X:  0.1"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbPrintZay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.9"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Печать заявки"
						On SAM_Click
							If MessageQuestion('Вы уверены, что хотите распечатать отмеченные заявки ?') = IDYES
								Call SalWaitCursor(TRUE)
								Call SalSendMsg(ZAYV_SAL,  UM_Print,    0, 0)
								Call SalPostMsg(ZAYV_SAL,  UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbPrintZayCorp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.35"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Просмотр и печать заявки CORP2"
						On SAM_Click
							Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV_SAL.ID)),6)||'.DOC'
							If NOT PutBlobToFile(
									          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAYV_SAL.ID,          '',          '')
								Call SalFileOpen(hFile, sFileName, OF_Delete)
								Call SalWaitCursor(FALSE)
								Return FALSE
							If sFileName != STRING_Null
								! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
										                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
										                           'Печать сформированной заявки',
										                           MB_IconQuestion|MB_YesNoCancel )
								Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
										                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
										                          'Просмотр и печать заявки CORP2',
										                          MB_IconQuestion|MB_YesNo )
								If nPrint = IDYES
									Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
									! Call DirectView(sFileName)
				Check Box: cb_CONV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: За ВАЛЮТУ
					Window Location and Size
						Left:   3.2"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Message Actions
						On SAM_Click
							! Call InitSqlStr()
							Call SalSendMsg (hWndForm, UM_Populate, 0, 0)
							If cb_CONV
								Call SalTblSetColumnTitle(KURS_Z, PutCrLf() || 'Курс' || PutCrLf() || 'конверсии')
							Else
								Call SalTblSetColumnTitle(KURS_Z, PutCrLf() || 'Курс' || PutCrLf() || 'покупки')
		Contents
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пок
						Прод
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Right
				Width:  0.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIZA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В
						и
						з
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV_CONV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЗА
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OBZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: О
						Б
						З
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						№
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						РНК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента-
						продавца
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отделение
						клиента-
						покупателя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						списания
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						зачисл.
						средств
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет для
						зачисления
						средств
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						для зач.
						ГРН
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет для
						списания
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сальдо
						счета
						ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сальдо
						счета
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						заявл.
						 ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2s
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						продажи
						 ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KURS_Z
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Курс
						продажи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Дата
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						%
						ком
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SKOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						или
						сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приоритет
						заявки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbPRIORITY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: 
						Приоритет
						заявки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If cbPRIORITY.Init(hWndItem)
							Call cbPRIORITY.Populate(hSql(), "id", "name", " zay_priority "," where active = 1 order by id")
					On SAM_AnyEdit
						Set PRIORITY = cbPRIORITY.GetKey(SalListQuerySelection(cbPRIORITY))
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC для
						зачисления
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: META
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Цель
						продажи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AIMS_CODE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Цифровой 
						код цели
						продажи
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If AIMS_CODE=NUMBER_Null
							Set cbAIMS_CODE=STRING_Null
							Return VALIDATE_Ok
						Call cbAIMS_CODE.SetSelectById( AIMS_CODE )
						If cbAIMS_CODE.nCurrentId
							Call SalSendMsg( cbAIMS_CODE, SAM_Click, 0, 0 )
							Return VALIDATE_Ok
						Else
							Call SalMessageBox( 'Неверно указан код цели продажи валюты', 'Ошибка!', MB_IconStop )
							Return VALIDATE_Cancel
			Column: cbAIMS_CODE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Описание
						кода цели
						продажи
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.817"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						Call cbAIMS_CODE.Init(hWndItem)
						Call cbAIMS_CODE.Populate(hSql(), "p40",  "substr(txt,1,100)", " v_kod_d3_1 "," ORDER BY p40 ")
						Call cbAIMS_CODE.SetSelectById( AIMS_CODE )
						Call SalListSetSelect(hWndItem, 0)
						Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
					On SAM_AnyEdit
						Set AIMS_CODE = cbAIMS_CODE.GetKey( SalListQuerySelection( cbAIMS_CODE))
			Column: DOCIS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наличие
						подтвердж.
						документов
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If DOCIS!=NUMBER_Null and OBZ=NUMBER_Null
							Call SalMessageBox( 'Наличие подтверждающих документов может быть установлено только для заявок на ОБЗ продажу', 'Ошибка!', MB_IconStop )
							Set DOCIS=NUMBER_Null
			Column: COVERED
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Коментарий
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OPT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REQ_TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						заявки
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbREQ_TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Наименование
						типа заявки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						Call cbREQ_TYPE.Init(hWndItem)
						Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
		Functions
			Function: F_RESERVE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nIdZay
					Number: nBlk
				Static Variables
				Local variables
					String: sMsg
					Number: nSumB
				Actions
					If nReserve = 0
						Return TRUE
					Else
						If nBlk = 0
							If SalMessageBox('Вы действительно хотите отказаться от блокировки гривны, '||PutCrLf(  )||
									                 'необходимой для покупки валюты по заявке №'||Str(nIdZay)||'?', 
									                 'Внимание', 
									                 MB_IconExclamation|MB_YesNo ) = IDNO
								Return FALSE
							Else
								Call SaveInfoToLog('ZAY. Пользователь отказался от блокировки гривны, необходимой на покупку валюты по заявке №'||Str(nIdZay))
								Return TRUE
						Else
							If SqlPLSQLCommand(hSql(), "p_zay_reserve(1,nIdZay,nSumB,sMsg)")
								If sMsg != STRING_Null AND nSumB = 0
									Call MessageInfo(sMsg)
									Return FALSE
								Else
									Return TRUE
							Else
								Return FALSE
			Function: F_CHECK_DATA
				Description:
				Returns
					Boolean:
				Parameters
					Number: nBuySell
					Number: nId
					Number: nCurrency
					Number: nAmount
					Number: nRate
					Date/Time: dDate
					Number: nOpt
				Static Variables
				Local variables
					String: sMsg
				Actions
					! валюта не заблокирована дилером
					If not BKL_KV(nCurrency)
						Return FALSE
					! сумма заявки
					If nAmount = 0 OR nAmount = NUMBER_Null 
						Call SalMessageBox('Не указана сумма заявки № '||Str(nId)||'!', 
								                   'Заявка не может быть завизирована', 
								                    MB_IconExclamation)
						Return FALSE
					! дата заявки
					If dDate = DATETIME_Null 
						Call SalMessageBox('Не указана дата заявки № '||Str(nId)||'!',  
								                   'Заявка не может быть завизирована', 
								                   MB_IconExclamation)
						Return FALSE
					! курс заявки
					If nRate  = 0 OR nRate = NUMBER_Null 
						Set nRate = GetDilerRate (nBuySell, nCurrency, KV_CONV)
						If nRate != NUMBER_Null AND nRate != 0 
							If SalMessageBox ('Установить предварительный курс дилера  '||Str(nRate)||
									                  ' для заявки №'||Str(nId)||'?', 
									                  'Внимание', 
									                  MB_IconExclamation|MB_YesNo) = IDYES
								If nBuySell = 2 
									Set ZAYV_SAL.KURS_Z = nRate
								! Else
									                                                                                                  Set ZAYV_SAL2.KURS_Z = nRate
								If SqlPrepareAndExecute(hSql(), "UPDATE zayavka SET kurs_z =:nRate WHERE id = :nId")
									Call SqlCommitEx(hSql(), 'ГОУ. Пользователь установил курс '||Str(nRate)||' для заявки № '||Str(nId))
								Else
									Call SqlRollbackEx(hSql(), 'ГОУ. Пользователь не смог установить курс для заявки № '||Str(nId))
									Return FALSE
							Else
								Return FALSE
						Else
							Call SalMessageBox('Не указан курс заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                   MB_IconExclamation)
							Return FALSE
					If nBuySell = 2 or nBuySell = 4
						! цель заявки
						If SalStrTrimX(ZAYV_SAL.META) = STRING_Null
							Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
									                   'Заявка не может быть завизирована', 
									                    MB_IconExclamation)
							Return FALSE
					! Else
						! цель заявки
						                                                                                                  If nOpt = 1
							                                                                                                  If NOT ZAYV_SAL.D1 
								                                                                                                  Call SalMessageBox('Не указана цель заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								                                                                                                  Return FALSE
							! основание для покупки валюты
							                                                                                                  If NOT ZAYV_SAL.D7 
								                                                                                                  Call SalMessageBox('Не указано основание для покупки валюты заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								                                                                                                  Return FALSE
							! код товарной группы
							! If NOT ZAYV_SAL.DB 
								                                                                                                     Call SalMessageBox('Не указан код товарной группы заявки № '||Str(nId)||'!', 
										                   'Заявка не может быть завизирована', 
										                    MB_IconExclamation)
								                                                                                                     Return FALSE
					Return TRUE
			Function: SET_PRIORITY
				Description:
				Returns
					Boolean:
				Parameters
					Number: pReqId
					Number: pBuySell
					Number: pCoverFl
					Number: pPriorId
				Static Variables
				Local variables
				Actions
					If pCoverFl = 0 AND pPriorId != nCovered AND nCovered > 0
						If SalMessageBox ('Заявка № '||Str(pReqId)||' не обеспечена средствами. '||PutCrLf()||
								                  'Вы действительно хотите завизировать заявку с приоритетом № '||Str(nCovered)||'?',
								                  'Внимание', 
								                   MB_IconExclamation|MB_YesNo) = IDYES
							If pBuySell = 1 
								Set ZAYV_SAL.PRIORITY = nCovered
							! Else
								                                                                                                  Set ZAYV_SAL2.PRIORITY = nCovered
						Else
							Return FALSE
					Return TRUE
		Window Parameters
		Window Variables
			String: strDSql
			String: strDFilter
			Number: nNextRow
			Number: nPF
			Number: nCovered
			Number: nReserve
			String: sStornoReasonId
			String: sStornoReason
			Number: nStornoReasonId
			!
			Number: nPrntBuy
			Number: nPrntSal
			String: sFileName
			Number: nPrint
			Number: nRet
			File Handle: hFile
			Number: nPR_CORP2
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalMapEnterToTab(TRUE)
				Set ZAYV_SAL.strFilterTblName = 'V_ZAY_QUEUE'
				!
				Call BIRZA( 'PR_CORP2',   nPR_CORP2  )
				Set cb_CONV = FALSE
				Call SalHideWindow(ZAYV_SAL.KV_CONV)
				If nPR_CORP2 = 1
					Call SalShowWindow(pbPrintZayCorp)
				Else
					Call SalHideWindow(pbPrintZayCorp)
				! Печать заявок
				If SqlPrepareAndExecute(hSql(),
						  "SELECT nvl(max(decode(par, 'PRNT_BUY', to_number(val), null)), -1),
						          nvl(max(decode(par, 'PRNT_SAL', to_number(val), null)), -1)
						     INTO :nPrntBuy, :nPrntSal
						     FROM birja  
						    WHERE par in ('PRNT_BUY', 'PRNT_SAL')")
						 and not SqlFetchNext(hSql(), nFetchRes)
					Set nPrntBuy = -1
					Set nPrntSal = -1
				If nPrntBuy = -1 AND nPrntSal = -1
					Call SalDisableWindow(pbPrintZay)
				! Пенсионный Фонд
				! If SqlPrepareAndExecute(hSql(), 
						  "SELECT to_number(val) 
						     INTO :nPF 
						     FROM birja
						    WHERE par = 'PEN_FOND'") 
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					                                                                                                Set nPF = 0
				! If nPF = 0
					                                                                                                Call SalHideWindow(ZAYV_SAL.MFOP)
					                                                                                                Call SalHideWindow(ZAYV_SAL.NLSP)
					                                                                                                Call SalHideWindow(ZAYV_SAL.OKPOP)
				! Приоритет для гарантированных заявок
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT to_number(val) 
						     INTO :nCovered
						     FROM birja
						    WHERE par = 'COVERED'") 
						AND NOT SqlFetchNext(hSql(), nFetchRes)
					Set nCovered = 0
				!
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call cF.Init(strFilterTblName, "v")
			On SAM_RowSetContext
				If ZAYV_SAL.KB != STRING_Null
					Call SalEnableWindow(pbPrintZayCorp)
				Else
					Call SalDisableWindow(pbPrintZayCorp)
			On UM_Delete
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYV_SAL, nNextRow, ROW_Selected, 0)      
					Call SalTblSetContext(ZAYV_SAL, nNextRow)
					Call BackRequest(2, 2, ID, RNK, NMK, SalStrTrimX(S2s), Str(KV1))
			On UM_Print
				If nPrntBuy = -1
					Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
				Else
					Set nNextRow = TBL_MinRow
					While SalTblFindNextRow(ZAYV_SAL, nNextRow, ROW_Selected, 0)      
						Call SalTblSetContext(ZAYV_SAL, nNextRow)
						Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYV_SAL.ID)),6)||'.TXT'
						Call ExportCatQuery(nPrntBuy,
								                      sFileName,
								                      3,
								                      ":ZAY_ID='"||SalStrTrimX(Str(ZAYV_SAL.ID))||"'",
								                      FALSE)
						If sFileName != STRING_Null
							Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
									                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
									                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
									                           'Печать сформированной заявки',
									                           MB_IconQuestion|MB_YesNoCancel )
							If nPrint = IDYES
								Call DirectView(sFileName)
							If nPrint = IDNO
								Call DosDirectPrint(sFileName)
			On SAM_User
				Set nNextRow = TBL_MinRow
				While SalTblFindNextRow(ZAYV_SAL, nNextRow, ROW_Selected, 0)
					Call SalTblSetContext(ZAYV_SAL, nNextRow)
					If SalIsNull(AIMS_CODE)
						Call SalMessageBox('Не заполнен цифровой код цели продажи!', 'Внимание!', MB_IconAsterisk | MB_Ok)
						Return FALSE
					If F_CHECK_DATA  ( ZAYV_SAL.DK, 
							                   ZAYV_SAL.ID, 
							                   ZAYV_SAL.KV1, 
							                   ZAYV_SAL.S2, 
							                   ZAYV_SAL.KURS_Z, 
							                   ZAYV_SAL.DAT, 
							                   ZAYV_SAL.OPT)
							AND SET_PRIORITY ( ZAYV_SAL.ID, 
							                   ZAYV_SAL.DK,
							                   ZAYV_SAL.COVERED, 
							                   ZAYV_SAL.PRIORITY)
						! Call SqlPrepareAndExecute(hSql(),
								    "UPDATE zayavka
								        SET viza     = 1, 
								            priority = :ZAYV_SAL.PRIORITY,
								            aims_code = :ZAYV_SAL.AIMS_CODE
								      WHERE dk       = 2 
								        AND id       = :ZAYV_SAL.ID")
						If not SqlPLSQLCommand(hSql(), "bars_zay.set_visa(ZAYV_SAL.ID, 1, ZAYV_SAL.PRIORITY, ZAYV_SAL.AIMS_CODE, ZAYV_SAL.DOCIS)")
							Call SqlRollback(hSql())
							Return FALSE
						Call SqlCommit(hSql())
						Call SaveInfoToLog("ZAY. Завизирована заявка № "||Str(ZAYV_SAL.ID)
								                 ||" клиента "                  ||Str(ZAYV_SAL.RNK)
								                 ||" на продажу "               ||SalStrTrimX(ZAYV_SAL.S2s)
								                 ||"/"                          ||Str(ZAYV_SAL.KV1)
								                 ||", приоритет "               ||Str(ZAYV_SAL.PRIORITY))
						! Call SalTblDefineSplitWindow(ZAYV_SAL, 0, FALSE)
				! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set strDFilter = cF.GetFilterWhereClause(TRUE)
				If cb_CONV
					! Call SalHideWindow(ZAYV_SAL.BLK)
					Call SalShowWindow(ZAYV_SAL.KV_CONV)
				Else
					! If nReserve = 1
						                                                                    Call SalShowWindow(ZAYV_SAL.BLK)
					! Else
						                                                                    Call SalHideWindow(ZAYV_SAL.BLK)
					Call SalHideWindow(ZAYV_SAL.KV_CONV)
				Set strDSql =
						"SELECT v.kv2,  v.dk,       v.id,          v.fdat, 
						        v.rnk,  v.nmk,      v.cust_branch, v.s2,    v.kurs_z, 
						        v.acc0, v.nls_acc0, v.mfo0,        v.okpo0, 
						        v.acc1, v.nls,      v.ostc,        v.dig,
						        v.kom,  v.skom,     SubStr( v.full_meta, 1, 100 ),
						        v.viza, v.priority, v.priorname, v.comm,
						        bars_zay.get_request_cover(v.id), v.verify_opt, v.obz, v.aims_code, v.kv_conv, v.req_type
						   INTO :ZAYV_SAL.KV1,  :ZAYV_SAL.DK,   :ZAYV_SAL.ID,     :ZAYV_SAL.DAT,      
						        :ZAYV_SAL.RNK,  :ZAYV_SAL.NMK,  :ZAYV_SAL.BRANCH, :ZAYV_SAL.S2,    :ZAYV_SAL.KURS_Z,
						        :ZAYV_SAL.ACC0, :ZAYV_SAL.NLS0, :ZAYV_SAL.MFO0,   :ZAYV_SAL.OKPO0,
						        :ZAYV_SAL.ACC1, :ZAYV_SAL.NLS1, :ZAYV_SAL.S0,     :ZAYV_SAL.DIG,
						        :ZAYV_SAL.KOM,  :ZAYV_SAL.SKOM, :ZAYV_SAL.META,  
						        :ZAYV_SAL.VIZA, :ZAYV_SAL.PRIORITY, :ZAYV_SAL.cbPRIORITY, :ZAYV_SAL.COMM,
						        :ZAYV_SAL.COVERED, :ZAYV_SAL.OPT, :ZAYV_SAL.OBZ, :ZAYV_SAL.AIMS_CODE, :ZAYV_SAL.KV_CONV, :ZAYV_SAL.REQ_TYPE
						   FROM v_zay_queue v
						  WHERE v.sos          = 0 
						    AND v.dk           = " || IifS(cb_CONV=TRUE, "4", "2") || "
						    AND v.viza        <= 0 
						    and mfo = f_ourmfo" || IifS(strDFilter='', "", " and " || strDFilter) || "
						  ORDER BY v.kv2, v.id desc"
				Call ReInitQueryString()
				!
				Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				! Тип заявки
				If REQ_TYPE = NUMBER_Null
					Set cbREQ_TYPE = STRING_Null
				Else
					Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
				Set S2s = Dig4(S2/100, DIG, 4)
				Set S0s = Dig4(S0/100, DIG, 4)
				!
				If VIZA = -1
					Call SetTblRowColor(ZAYV_SAL, COLOR_DarkRed)
				! Подсказка о нехватке ВАЛ на счете
				If COVERED = 0
					Call SalTblSetCellTextColor(ZAYV_SAL.S0s, COLOR_Red, FALSE)
				! Основание для продажи
				If ZAYV_SAL.AIMS_CODE = NUMBER_Null
					Set cbAIMS_CODE = STRING_Null
				Else
					Call cbAIMS_CODE.SetSelectById(ZAYV_SAL.AIMS_CODE)
	Dialog Box: dlg_Comments
		Class:
		Property Template:
		Class DLL Name:
		Title: Коментар
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.8"
				Width Editable? Yes
				Height: 2.5"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Multiline Field: mlComm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 254
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.1"
						Top:    0.05"
						Width:  5.5"
						Width Editable? Yes
						Height: 1.3"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Frame
				Resource Id: 55664
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    1.4"
					Width:  5.5"
					Width Editable? Yes
					Height: 0.7"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Pushbutton: pbSave
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbUpdate
				Property Template:
				Class DLL Name:
				Title: Записати
				Window Location and Size
					Left:   2.9"
					Top:    1.55"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If mlComm
							Set sComment = mlComm
							Call SalEndDialog(hWndForm, TRUE)
						Else
							Call SalMessageBox('Не заповнено коментар!', 'Увага!', MB_IconExclamation)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Відмінити
				Window Location and Size
					Left:   4.2"
					Top:    1.55"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, FALSE)
		Functions
		Window Parameters
			Receive String: sComment
		Window Variables
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
	Table Window: ZAY_SPLIT_AMNT
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.717"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On VTM_RightClick
							Call XSalTooltipSetColors( COLOR_Black, SalColorFromRGB( 255, 255, 200 ) )
							! ! назва таблиці
							Call XSalTooltipShow( pbRefresh, ZAY_SPLIT_AMNT.strPrintFileName )
							Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1221
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\split.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If ( REF > 0 )
								Call SalModalDialog( ZAY_SPLITTING_AMNT, hWndForm, REF, SUM )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1222
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1223
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № счета
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						поступл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						док.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IS_SPLIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ознака
						проведення
						розщеплення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, "Розподіл надходжень валютної виручки. " || sLibVersion )
				Call PrepareWindowEx( hWndForm )
				Call SalMapEnterToTab( TRUE )
				Set ZAY_SPLIT_AMNT.strFilterTblName = 'OPER'
				Set ZAY_SPLIT_AMNT.strPrintFileName = 'V_ZAY_SPLIT_AMOUNT'
				Set ZAY_SPLIT_AMNT.nTabInstance = 1
				Set ZAY_SPLIT_AMNT.strSqlPopulate = "
						 select RNK, NMK, ACC, KV, LCV, NLS, FDAT, REF, AMNT, IS_SPLIT
						   INTO :ZAY_SPLIT_AMNT.RNK, :ZAY_SPLIT_AMNT.NMK, :ZAY_SPLIT_AMNT.ACC,  :ZAY_SPLIT_AMNT.KV
						      , :ZAY_SPLIT_AMNT.ISO, :ZAY_SPLIT_AMNT.NLS, :ZAY_SPLIT_AMNT.VDAT, :ZAY_SPLIT_AMNT.REF
						      , :ZAY_SPLIT_AMNT.SUM, :ZAY_SPLIT_AMNT.IS_SPLIT
						   from BARS.V_ZAY_SPLIT_AMOUNT
						  order by KV, RNK, FDAT desc "
				! Call SalTblSetLockedColumns( hWndForm, 4 )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call SalCenterWindow( hWndForm )
				Call SalStatusSetVisible( hWndForm, FALSE )
				Call SalStatusSetText( hWndForm, sLibVersion )
			On SAM_DoubleClick
				Call SalSendMsg( ZAY_SPLIT_AMNT.pbDetails, SAM_Click, 0, 0)
	Dialog Box: ZAY_SPLITTING_AMNT
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.583"
				Width Editable? Class Default
				Height: 5.19"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nNewRow = SalTblInsertRow ( tbl_AMNTS, TBL_MaxRow )
							Call SalTblSetContext ( tbl_AMNTS, nNewRow )
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1224
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1225
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти внесенні дані'
						On SAM_Click
							If SalMessageBox( 'Зберегти внесенні дані?'
									                , CurrentLangTable.GetAtomTitle( 'cTAt' )
									                , MB_IconQuestion|MB_YesNo )=IDYES
								If ( ZAY_SPLITTING_AMNT.tbl_AMNTS.CHECK_AMNT() )
									Call ZAY_SPLITTING_AMNT.tbl_AMNTS.SAVE_CHANGES()
									Call SalMessageBox( "Дані збережено!"
											                  , CurrentLangTable.GetAtomTitle( 'cTMessage' )
											                  , MB_Ok | MB_IconAsterisk )
											
									Call SalEndDialog( ZAY_SPLITTING_AMNT, TRUE )
								Else
									Call SalMessageBox( "Введені суми розщеплення не відповідають сумі документа "||SalNumberToStrX(nDocAmnt,2)
											                  , CurrentLangTable.GetAtomTitle( 'cTErr' )
											                  , MB_Ok | MB_IconStop )
											
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1226
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl_AMNTS
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: SALE_TP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cmd_SALE_TP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Ознака обов.
								продажу
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.683"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Call cmd_SALE_TP.Init(hWndItem)
								Call cmd_SALE_TP.Populate(hSql(), "TP_ID", "TP_NM", "ZAY_SALE_TYPES", "ORDER BY TP_ID")
								Call cmd_SALE_TP.SetSelectById(SALE_TP)
							On SAM_AnyEdit
								Set SALE_TP = cmd_SALE_TP.GetKey(SalListQuerySelection(cmd_SALE_TP))
					Column: AMNT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сума
								продажу
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  2.833"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							! On SAM_Validate
								                  If ( ZAY_SPLITTING_AMNT.tbl_AMNTS.AMNT <= 0 )
									                  Call SalMessageBox( "Не вказано суму розщеплення!"
											                  , CurrentLangTable.GetAtomTitle( 'cTErr' )
											                  , MB_Ok | MB_IconStop )
											
									                  Return VALIDATE_Cancel
								                  Return VALIDATE_Ok
				Functions
					Function: SAVE_CHANGES
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nRow
						Actions
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								! Вставка/Оновлення
								If SalTblQueryRowFlags( tbl_AMNTS, nRow, ROW_New | ROW_Edited )
									If ( tbl_AMNTS.AMNT > 0 )
										If SqlPLSQLCommand( hSql(), "bars_zay.set_amount( tbl_AMNTS.ID, nREF, tbl_AMNTS.SALE_TP, tbl_AMNTS.AMNT*100 )" )
											Call SqlCommit( hSql() )
										Else
											Call SqlRollback( hSql() )
									Else
										Call SalTblQueryRowFlags( tbl_AMNTS, nRow, ROW_MarkDeleted )
								! Видалення
								If SalTblQueryRowFlags( tbl_AMNTS, nRow, ROW_MarkDeleted )
									If SqlPLSQLCommand( hSql(), "bars_zay.del_amount( tbl_AMNTS.ID )" )
										Call SqlCommit( hSql() )
									Else
										Call SqlRollback( hSql() )
							Call SalSendMsg( tbl_AMNTS, UM_Populate, 0, 0 )
							Call SalWaitCursor(FALSE)
					Function: CHECK_AMNT
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Number: nAmnt
						Actions
							Set nRow = TBL_MinRow
							Set nAmnt = 0
							While SalTblFindNextRow(hWndForm, nRow, 0, ROW_MarkDeleted )
								Call SalTblSetContext(hWndForm, nRow)
								Set nAmnt = nAmnt + tbl_AMNTS.AMNT
							If ( nAmnt = nDocAmnt )
								Return TRUE
							Else
								Return FALSE
				Window Variables
				Message Actions
					On SAM_Create
						Call SalCenterWindow( hWndForm )
						! Call SalSendMsg( tbl_AMNTS, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalTblPopulate( ZAY_SPLITTING_AMNT.tbl_AMNTS, hSql(),
								"select sa.ID, sa.SALE_TP, t.TP_NM, sa.AMNT/100
								   INTO :ZAY_SPLITTING_AMNT.tbl_AMNTS.ID
								      , :ZAY_SPLITTING_AMNT.tbl_AMNTS.SALE_TP
								      , :ZAY_SPLITTING_AMNT.tbl_AMNTS.cmd_SALE_TP
								      , :ZAY_SPLITTING_AMNT.tbl_AMNTS.AMNT
								   from BARS.ZAY_SPLITTING_AMOUNT sa
								      , ZAY_SALE_TYPES t
								  where t.TP_ID = sa.SALE_TP
								    and REF = :nREF", TBL_FillAll )
						If Not SalTblSetContext( tbl_AMNTS, 0 ) 
							! -------------------------
							! Процент ОБЗ продажи
							! ( Дехнич не потрібен поділ суми док. відповідно до %% обов. продажу )
							! Call BIRZA('OBZ_PROC',nOblgPct)
							! Set nOblgPct = SalNumberRound( nDocAmnt * nOblgPct ) / 100
							! -------------------------
							! Не підлягає обов. продажу
							Set nNewRow = SalTblInsertRow( tbl_AMNTS, TBL_MaxRow )
							Call SalTblSetContext( hWndForm, nNewRow )
							! Set tbl_AMNTS.AMNT = ( nDocAmnt - nOblgPct )
							Set tbl_AMNTS.AMNT = 0
							Set tbl_AMNTS.SALE_TP = 1
							Call tbl_AMNTS.cmd_SALE_TP.SetSelectById( tbl_AMNTS.SALE_TP )
							! Підлягає обов. продажу-розподіл суми
							Set nNewRow = SalTblInsertRow( tbl_AMNTS, TBL_MaxRow )
							Call SalTblSetContext( hWndForm, nNewRow )
							! Set tbl_AMNTS.AMNT = 0
							Set tbl_AMNTS.AMNT = nDocAmnt
							Set tbl_AMNTS.SALE_TP = 2
							Call tbl_AMNTS.cmd_SALE_TP.SetSelectById( tbl_AMNTS.SALE_TP )
							! 100% підлягає обов. продажу
							Set nNewRow = SalTblInsertRow( tbl_AMNTS, TBL_MaxRow )
							Call SalTblSetContext( hWndForm, nNewRow )
							! Set tbl_AMNTS.AMNT = nOblgPct
							Set tbl_AMNTS.AMNT = 0
							Set tbl_AMNTS.SALE_TP = 3
							Call tbl_AMNTS.cmd_SALE_TP.SetSelectById( tbl_AMNTS.SALE_TP )
					On SAM_EndCellTab
						! Заглушка (щоб не відпрацьовував UM_Insert класу)
					! On UM_Insert
		Functions
		Window Parameters
			Number: nREF
			Number: nDocAmnt
		Window Variables
			Number: nNewRow
			Number: nOblgPct
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, "Розподіл суми платежу #"||Str(nREF) )
				Call PrepareWindowEx( hWndForm )
				Call SalCenterWindow( hWndForm )
				Call SalMapEnterToTab(TRUE)
				Call SalStatusSetVisible( ZAY_SPLITTING_AMNT, TRUE )
				Call SalStatusSetText( ZAY_SPLITTING_AMNT, sLibVersion )
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
				Call SalDisableWindow( pbIns )
				! Call SalDisableWindow( pbDel )
				! Call SalDisableWindow( pbRefresh )
				Call SalDisableWindow( tbl_AMNTS.cmd_SALE_TP )
			On SAM_Destroy
				Call SalSendMsg( ZAY_SPLIT_AMNT.pbRefresh, SAM_Click, 0, 0 )
			! не убирать! иначе по DoubleClick будем выходить из диалога
			On UM_DoubleClick
