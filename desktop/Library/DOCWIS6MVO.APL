.head 0 +  Application Description: Визуальный класс для работы с платежными документами
09-07-99  MIK (СЕП 2001)
23-03-02  SERG встроена внутр. ЭЦП НБУ 
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B50000 002C000000020000 0003000000000000 00B1010000FCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 00000000000C646F 637769736E6E2E65 78650A6E65776170 702E646C6C0A6E65
0020: 776170702E617063 000001010115433A 5C43454E54555241 5C6E65776170702E
0040: 72756E15433A5C43 454E545552415C6E 65776170702E646C 6C15433A5C43454E
0060: 545552415C6E6577 6170702E61706300 0001010115433A5C 43454E545552415C
0080: 6E65776170702E61 706415433A5C4345 4E545552415C6E65 776170702E646C6C
00A0: 15433A5C43454E54 5552415C6E657761 70702E6170630000 0101010B446F6357
00C0: 6973322E61706C0A 6E65776170702E64 6C6C0A6E65776170 702E617063000001
00E0: 0101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Docfun6MVO.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: GENLBUTN.APL
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: vtarray.apl
.head 2 -  File Include: Vtmsgbox.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Xsalcpt.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Number: #00000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  Number: UM_HotFio = SAM_User + 219
.head 3 +  User
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  Boolean: bDocWisInited
.head 2 +  Internal Functions
.head 3 +  Function: TagBrowse
.head 4 -  Description: Выбор значения TAG из справочника
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strSelect
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTagVal
.head 4 +  Actions
.head 5 +  If SalModalDialog( dlgTagBrowse, hWndForm, strSelect, strTagVal )
.head 6 -  Return strTagVal
.head 5 -  Return STRING_Null
.head 3 +  Function: DocWisInit
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sInstName   ! Имя экземпляра класса
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 -  !
.head 5 +  If not bDocWisInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars011.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFileSpecial( strFileName, strLangId, sInstName, TRUE ))
.head 7 -  ! dlgDocStart
.head 7 -  Call CurrentLangTable.AddAtom('dlgDocStart.cTWndTitle','Банковская операция')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDocStart.tblTrans.colTT','Код~оп')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDocStart.tblTrans.colTTN','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDocStart.pbOk','Выбрать')
.head 7 -  ! dlg_SetLocDat
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetLocDat.cTWndTitle','Локальный банковский день')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetLocDat.pbOk','Установить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetLocDat.cTMsgSetDate','Установить дату')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetLocDat.cTErrDateFormat','Ош. формат даты')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetLocDat.cTMsgBigDate','Устанавливаемая дата больше банковской.')
.head 7 -  ! dlgAsk2Pay
.head 7 -  Call CurrentLangTable.AddAtom('dlgAsk2Pay.cTWndTitle','Оплата')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAsk2Pay.pbOk','Утвердить')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAsk2Pay.bgSum','Сумма документа')
.head 7 -  ! dlgClient
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.cTWndTitle','Справочник лицевых счетов')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.tblClient.colNls','Номер счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.tblClient.colLcv','Вал')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.bgSearchStr','Поиск:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.pbOk','Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.cTManyRow','Слишком много строк. Используйте поиск.')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.cTAccName','Наименование Счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlgClient.cTClientName','Наименование Клиента')
.head 7 -  ! dlgAlien
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.cTWndTitle','Справочник контрагентов')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.tblAlien.colMFO','МФО')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.tblAlien.colNls','Номер счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.tblAlien.colName','Наименование клиента')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.bgSearchStr','Поиск:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAlien.pbOk','Выбрать')
.head 7 -  ! dlgDescr
.head 7 -  Call CurrentLangTable.AddAtom('dlgDescr.cTWndTitle','Справочник назначений платежа')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDescr.tblDescr.colText','Назначение платежа')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDescr.bgSearchStr','Поиск:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDescr.pbOk','Выбрать')
.head 7 -  ! dlgMFO
.head 7 -  Call CurrentLangTable.AddAtom('dlgMFO.cTWndTitle','Справочник МФО')
.head 7 -  Call CurrentLangTable.AddAtom('dlgMFO.tblMFO.colMFO','МФО')
.head 7 -  Call CurrentLangTable.AddAtom('dlgMFO.tblMFO.colName','Наименование банка')
.head 7 -  Call CurrentLangTable.AddAtom('dlgMFO.bgSearchStr','Поиск:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgMFO.pbOk','Выбрать')
.head 7 -  ! dlgTagBrowse
.head 7 -  Call CurrentLangTable.AddAtom('dlgTagBrowse.cTWndTitle','Код-Текст Бровзер')
.head 7 -  Call CurrentLangTable.AddAtom('dlgTagBrowse.tbl.colKod','Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlgTagBrowse.tbl.colTxt','Текст')
.head 7 -  Call CurrentLangTable.AddAtom('dlgTagBrowse.bgSearchStr','Поиск(F7):')
.head 7 -  Call CurrentLangTable.AddAtom('dlgTagBrowse.pbOk','Выбрать')
.head 7 -  ! tblDocBal
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colDAT','Дата~вал')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colTT', 'ОП')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colNLS','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colLCV','Код~вал')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colSumD','ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colSumK','КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colSDQ','ДЕБЕТ~(екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colSKQ','КРЕДИТ~(екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tblDocBal.colNAZN','Подробности~платежа ')
.head 7 -  ! cDocW constants
.head 7 -  Call CurrentLangTable.AddAtom('DlgMSG_Error' , 'Ошибка')
.head 7 -  Call CurrentLangTable.AddAtom('DlgMSG_Pay' , 'Оплата')
.head 7 -  Call CurrentLangTable.AddAtom('DlgMSG_Warning' , 'Внимание')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('DocWTit' , 'Ввод документа')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipPay' , 'Оплатить документ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipExit' , 'Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipPrint' , 'Напечатать документ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipNewDoc' , 'Начать ввод нового документа')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipNewTTS' , 'Переити к другой операции')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipDocBal' , 'Показать банковские проводки')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipDocHelp' , 'Выбрать из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipSaveKor' , 'Сохранить в справочнике')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipDopRec' , 'Дополнительные реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('DocWTipLocalD' , 'Установить локальную операционную дату')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamPolu' , 'Получатель')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamPlat' , 'Плательщик')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamBankA' , 'Банк А')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamBankB' , 'Банк Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamSumma' , 'Сумма')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamNom' , 'Номинал')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamRat' , 'Курс ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamEqv' , 'Экв. ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamRatB' , 'Курс покупки')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamRatS' , 'Курс продажи')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamDeb' , 'ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamKre' , 'КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfSigDeb' , 'Д')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfSigKre' , 'K')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamDatVal' , 'Дата Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesDayClosed' , 'Банковский день закрыт ...')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrDateFormat' , 'Не верный формат даты')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrSumFormat' , 'Не верный формат суммы')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNomFormat' , 'Не верный формат номинала ЦБ.')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrDateValue' , 'Не верное значение даты документа')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrDatVal' , 'Не верное значение даты валютирования')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNoCurrencyFound' , 'Не найден код валюты')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNlsNotNumA' , 'Нецифра в номере счета А')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNlsNotNumB' , 'Нецифра в номере счета Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrMFONotNumB' , 'Нецифра в коде банка Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNlsCrcA' , 'Ошибка в контрольном разряде счета А')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNlsCrcB' , 'Ошибка в контрольном разряде счета Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrMFOCrcB' , 'Ош контрольный разряд кода банка Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNlsNotFound' , 'Счет не найден')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrMFONotFound' , 'Не найден банк')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrOkpoNlsA' , 'Не введено ОКПО клиента счета А')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrOkpoNlsB' , 'Не введено ОКПО клиента счета Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNam' , 'Наименование должно быть больше 3х символов')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrNazn' ,'Назначение платежа должно быть больше 3х символов')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrSumBlank' , 'Сумма не может быть пустой')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrKasPlan' , 'Недопустимый символ касплана')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesOK' , 'Документ успешно принят.~Референция ')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesProvodki' , 'Банковские проводки по документу №')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamLocD','Установлена локальная дата')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamUrgnt','Срочно')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfNamVytVkl','Вытяжка Вкл')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrOkpoNotNumA','Ош формат кода А')
.head 7 -  Call CurrentLangTable.AddAtom('DocWMesErrOkpoNotNumB','Ош формат кода Б')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfSkN','S')
.head 7 -  Call CurrentLangTable.AddAtom('DocWDfDateFrom','От')
.head 7 -  Call CurrentLangTable.AddAtom('DocWNazn','Назначение платежа')
.head 7 -  Set bDocWisInited=TRUE
.head 5 -  Return bDocWisInited
.head 2 -  Named Menus
.head 2 +  Class Definitions
.head 3 +  Form Window Class: cDocW
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Yes
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Normal
.head 5 -  Maximizable? No
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? No
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  9.65"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.31"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 155
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Стандартное окно работы с документом
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.417"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  Pushbutton: pbPayDoc
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 27
.head 7 -  Class: ctb_pbExecute
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.5"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F10
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipPay')||' 
F10'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_Insert, 0, 0 )
.head 6 +  Pushbutton: pbExit
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 29
.head 7 -  Class: ctb_pbCancel
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.8"
.head 8 -  Top:    0.071"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Esc
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipExit')||' 
Esc'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_Close, 0, 0 )
.head 6 +  Pushbutton: pbPrtDoc
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 30
.head 7 -  Class: ctb_pbPrint
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   1.367"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F5
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipPrint')||' 
F5'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_Print, 0, 0 )
.head 6 -  Line
.head 7 -  Resource Id: 38056
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 33
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  2.433"
.head 8 -  Begin Y:  0.021"
.head 8 -  End X:  2.433"
.head 8 -  End Y:  0.438"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 -  Background Text: Остаток:
.head 7 -  Resource Id: 38057
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 75
.head 7 -  Class:
.head 7 -  Window Location and Size
.head 8 -  Left:   4.583"
.head 8 -  Top:    0.485"
.head 8 -  Width:  1.083"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Justify: Right
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 6 -  Line
.head 7 -  Resource Id: 38058
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 34
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  9.214"
.head 8 -  Begin Y:  0.021"
.head 8 -  End X:  9.214"
.head 8 -  End Y:  0.438"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 -  Line
.head 7 -  Resource Id: 38059
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 59
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  8.543"
.head 8 -  Begin Y:  0.021"
.head 8 -  End X:  8.543"
.head 8 -  End Y:  0.438"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Data Field: dfZn
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 35
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Data
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Editable? No
.head 7 -  Display Settings
.head 8 -  Window Location and Size
.head 9 -  Left:   5.229"
.head 9 -  Top:    0.095"
.head 9 -  Width:  0.5"
.head 9 -  Width Editable? Yes
.head 9 -  Height: 0.25"
.head 9 -  Height Editable? Yes
.head 8 -  Visible? Yes
.head 8 -  Border? Yes
.head 8 -  Justify: Left
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Font Name: Default
.head 8 -  Font Size: Default
.head 8 -  Font Enhancement: Bold
.head 8 -  Text Color: Default
.head 8 -  Background Color: System Window Color
.head 8 -  Input Mask: Unformatted
.head 7 +  Message Actions
.head 8 +  On UM_ObjActivate
.head 9 -  Call SetItsColo(bFaktPlan,COLOR_Sky,COLOR_LightGreen)
.head 6 +  Data Field: dfOst
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 31
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Data
.head 8 -  Maximum Data Length: 15
.head 8 -  Data Type: Number
.head 8 -  Editable? No
.head 7 -  Display Settings
.head 8 -  Window Location and Size
.head 9 -  Left:   5.683"
.head 9 -  Top:    0.095"
.head 9 -  Width:  2.6"
.head 9 -  Width Editable? Yes
.head 9 -  Height: 0.25"
.head 9 -  Height Editable? Yes
.head 8 -  Visible? Yes
.head 8 -  Border? Yes
.head 8 -  Justify: Right
.head 8 -  Format: ###000
.head 8 -  Country: Default
.head 8 -  Font Name: Default
.head 8 -  Font Size: Default
.head 8 -  Font Enhancement: Bold
.head 8 -  Text Color: Default
.head 8 -  Background Color: System Window Color
.head 8 -  Input Mask: Unformatted
.head 7 +  Message Actions
.head 8 +  On SAM_Validate
.head 9 -  Set dfOst=NUMBER_Null
.head 9 -  Call SqlPrepareAndExecute(hSql(), T("
SELECT ostb,ostc,pap INTO :dfOst,:nTmp,:nPap
FROM  saldo WHERE nls = :dfNlsA AND kv = :nKvA AND dazs IS NULL" ) )
.head 9 +  If SqlFetchNext( hSql(), nFetchRes )
.head 10 +  If bFaktPlan
.head 11 -  Set dfOst = nTmp
.head 10 -  Call SetItsColo(bFaktPlan,COLOR_Sky,COLOR_LightGreen)
.head 10 -  Call SalSendMsg( dfZn, UM_ObjActivate, 0, 0 )
.head 9 +  If SalIsNull( dfOst )
.head 10 -  Set dfOst=0
.head 10 -  Set nPap=3
.head 9 -  Set sTmp='#0'||sDecimal||SalStrRepeatX( '0', nDigA )
.head 9 -  Call SalFmtSetPicture( dfOst, sTmp )
.head 9 -  Set dfOst = dfOst*SalNumberPower( 10, -nDigA )
.head 9 +  If nPap = 2 and dfOst < 0
.head 10 -  Set nColor = COLOR_Red
.head 9 +  Else If nPap = 1 and dfOst > 0
.head 10 -  Set nColor = COLOR_Chartreuse
.head 9 +  Else
.head 10 -  Set nColor = COLOR_DarkBlue
.head 9 -  Call SalColorSet( dfOst, COLOR_IndexWindowText, nColor )
.head 9 -  Call SalColorSet( dfZn, COLOR_IndexWindowText, nColor )
.head 9 +  If dfOst < 0
.head 10 -  Set dfZn = CurrentLangTable.GetAtomTitle('DocWDfSigDeb')
.head 10 -  Set dfOst = - dfOst
.head 9 +  Else If dfOst > 0
.head 10 -  Set dfZn = CurrentLangTable.GetAtomTitle('DocWDfSigKre')
.head 9 +  Else
.head 10 -  Set dfZn = ''
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  ! On SAM_ContextMenu
.head 9 -                              Set bFaktPlan= not bFaktPlan
.head 9 -                              Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 9 -                              Return FALSE
.head 6 +  Pushbutton: pbNewDoc
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 53
.head 7 -  Class: ctb_pbInsert
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.933"
.head 8 -  Top:    0.071"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F11
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipNewDoc')||' 
F11'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_Clear, 0, 0 )
.head 6 +  Pushbutton: pbNewTTs
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 60
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   0.067"
.head 8 -  Top:    0.071"
.head 8 -  Width:  0.43"
.head 8 -  Width Editable? Class Default
.head 8 -  Height: 0.317"
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
.head 7 -  Picture Transparent Color: Gray
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipNewTTS')
.head 8 +  On SAM_Click
.head 9 -  Set bDocStart=FALSE
.head 9 -  Call SalSendMsg( hWndForm, UM_Choose, 0, 0 )
.head 6 +  Pushbutton: pbDocBal
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 72
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   3.083"
.head 8 -  Top:    0.071"
.head 8 -  Width:  0.43"
.head 8 -  Width Editable? Class Default
.head 8 -  Height: 0.317"
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F9
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 7 -  Picture Transparent Color: Gray
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipDocBal')||' 
F9'
.head 8 +  On SAM_Click
.head 9 -  Set bDocStart=FALSE
.head 9 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  Pushbutton: pbHelp
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 62
.head 7 -  Class: ctb_pbHelp
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   8.683"
.head 8 -  Top:    0.071"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F12
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipDocHelp')||' 
F12'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_HotAccountList, 0, 0 )
.head 6 +  Pushbutton: pbSaveKor
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 64
.head 7 -  Class: ctb_pbUpdate
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   2.65"
.head 8 -  Top:    0.071"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: F2
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipSaveKor')||' 
F2'
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_Update, 0, 0 )
.head 6 +  Pushbutton: pbLocalD
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 148
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   3.943"
.head 8 -  Top:    0.071"
.head 8 -  Width:  0.433"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.321"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Keyboard Accelerator: (none)
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Picture File Name: \BARS98\RESOURCE\BMP\Rep_join.bmp
.head 7 -  Picture Transparent Color: Gray
.head 7 -  Image Style: Single
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Call SalModalDialog( dlg_SetLocDat, hWndForm, dDat)
.head 9 -  Call SalSendMsg( dfDocD, SAM_Create, 0, 0 )
.head 9 -  Call SalSendMsg( dfValD1, SAM_Create, 0, 0 )
.head 9 -  Call SalSendMsg( dfValD2, SAM_Create, 0, 0 )
.head 9 -  Call SalSendMsg( dfLocDat, SAM_Create, 0, 0 )
.head 8 +  On SAM_Create
.head 9 +  If nFbk
.head 10 -  Call SalEnableWindow(hWndItem)
.head 9 +  Else
.head 10 -  Call SalDisableWindow(hWndItem)
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('DocWTipLocalD')
.head 6 -  Line
.head 7 -  Resource Id: 38060
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 77
.head 7 -  Class:
.head 7 -  Coordinates
.head 8 -  Begin X:  4.517"
.head 8 -  Begin Y:  0.024"
.head 8 -  End X:  4.517"
.head 8 -  End Y:  0.44"
.head 7 -  Visible? Yes
.head 7 -  Line Style: Etched
.head 7 -  Line Thickness: 1
.head 7 -  Line Color: 3D Shadow Color
.head 6 +  Pushbutton: pbHotVytyag
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 138
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: 0
.head 7 -  Window Location and Size
.head 8 -  Left:   4.683"
.head 8 -  Top:    0.06"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? No
.head 7 -  Keyboard Accelerator: F6
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( dfVytyagN, UM_ObjActivate, 0, 0 )
.head 6 +  Pushbutton: pbHotFio
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 141
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: 0
.head 7 -  Window Location and Size
.head 8 -  Left:   4.883"
.head 8 -  Top:    0.227"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? No
.head 7 -  Keyboard Accelerator: F7
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Call SalSendMsg( hWndForm, UM_HotFio, 0, 0 )
.head 6 +  Pushbutton: pbHotName
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 137
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: 0
.head 7 -  Window Location and Size
.head 8 -  Left:   4.883"
.head 8 -  Top:    0.227"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? No
.head 7 -  Keyboard Accelerator: F8
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 +  If bNamA
.head 10 -  Set dfNamA=GetBankName()
.head 10 -  Call SalSetFieldEdit (dfNamA, TRUE )
.head 10 -  Call SalSetFocus( dfNamA )
.head 9 +  If bNamB
.head 10 -  Set dfNamB=GetBankName()
.head 10 -  Call SalSetFieldEdit (dfNamB, TRUE )
.head 10 -  Call SalSetFocus( dfNamB )
.head 9 +  If bNazn
.head 10 -  Set dfNazn=dfNazn||' '||GetBankName()
.head 10 -  Call SalSetFieldEdit (dfNazn, TRUE )
.head 10 -  Call SalSetFocus( dfNazn )
.head 6 +  Pushbutton: pbHotOstat
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 150
.head 7 -  Class: cTBarButton
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: 0
.head 7 -  Window Location and Size
.head 8 -  Left:   5.083"
.head 8 -  Top:    0.394"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? No
.head 7 -  Keyboard Accelerator: F3
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Set bFaktPlan= not bFaktPlan
.head 9 -  Call SalSendMsg( dfOst, SAM_Validate, 0, 0 )
.head 4 +  Contents
.head 5 +  Data Field: dfValD1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 25
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Date/Time
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   4.233"
.head 8 -  Top:    3.917"
.head 8 -  Width:  1.371"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Date
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If bFixValD1 and dFixValD1 or bFixAll and dFixValD1
.head 9 -  Set dfValD1=dFixValD1
.head 8 +  Else
.head 9 -  Set dfValD1=dDat
.head 8 +  If nFvD1
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call SalShowWindow( dfValD1N )
.head 9 -  Call UnHideIt( hWndItem )
.head 9 +  If IsHolyDay(nBaseVal,dfValD1)
.head 10 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Red )
.head 9 +  Else
.head 10 -  Call SetItsColo(bFixValD1,COLOR_LightGray,COLOR_SysWindow)
.head 8 +  Else
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 9 -  Call SalHideWindow( dfValD1N )
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsValidDateTime( hWndItem )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDateFormat'), 
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If dfValD1<SalDateConstruct(1990,1,1,0,0,0) or 
   dfValD1>SalDateConstruct(2020,1,1,0,0,0)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDatVal')||' 1',
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If bFixValD1
.head 9 -  Set dFixValD1=dfValD1
.head 8 +  If IsHolyDay(nBaseVal,dfValD1)
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Red )
.head 8 +  If nFlv and nKvA and nKvB and not bTotVal
.head 9 -  Call GetXRate(nRatO,nRatB,nRatS,nKvA,nKvB,dfValD1)
.head 9 +  If nFtr=1 
.head 10 +  If nDk=0 or nDk=2
.head 11 -  Set dfRatNom = nRatS
.head 10 +  Else
.head 11 -  Set dfRatNom = nRatB
.head 10 -  Call SetTagKurs(dfRatNom,'KURS')
.head 9 +  Else
.head 10 -  Set dfRatNom = nRatO
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 +  If IsHolyDay(nBaseVal,dfValD1)
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Red )
.head 8 +  Else
.head 9 -  Call SetItsColo(bFixValD1,COLOR_LightGray,COLOR_SysWindow)
.head 7 +  On SAM_ContextMenu
.head 8 -  Set bFixValD1=not bFixValD1
.head 8 -  Set dFixValD1=dfValD1
.head 8 -  Call SalSendMsg( hWndItem, SAM_Create, 0, 0 )
.head 8 +  If IsHolyDay(nBaseVal,dfValD1)
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Red )
.head 8 +  Else
.head 9 -  Call SetItsColo(bFixValD1,COLOR_LightGray,COLOR_SysWindow)
.head 8 -  Return FALSE
.head 5 +  Combo Box: cmbVob
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 39
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.071"
.head 7 -  Top:    0.052"
.head 7 -  Width:  4.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 1.927"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  String Type: String
.head 6 -  Maximum Data Length: Default
.head 6 -  Sorted? No
.head 6 -  Always Show List? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 6 -  List Initialization
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If sVOB_ORD
.head 9 -  Call SqlPrepareAndExecute( hSql(),
"SELECT t.ord ||' '|| v.name,v.vob INTO :sTmp,:nVob FROM vob v, tts_vob t   
  WHERE t.vob=v.vob AND t.tt=:sTT ORDER  by t.ord " )
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(),
"SELECT v.name, v.vob INTO :sTmp,:nVob FROM vob v, tts_vob t 
  WHERE t.vob=v.vob AND t.tt=:sTT ORDER by v.name  " )
.head 8 -  Set nTmp=0
.head 8 -  Set i=0
.head 8 -  Call SalArraySetUpperBound( mVob,1,-1 )
.head 8 -  Call SalListClear( hWndItem )
.head 8 +  While SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalListAdd( hWndItem, sTmp )
.head 9 -  Set mVob[nTmp] = nVob
.head 9 +  If bFixAll and nVob=nFixVob  ! Запомнить позицию в лист-боксе
.head 10 -  Set i=nTmp
.head 9 -  Set nTmp=nTmp+1
.head 8 +  If nTmp=1
.head 9 -  Call HideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call UnHideIt( hWndItem )
.head 8 -  Call SalListSetSelect( hWndItem, i )
.head 8 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 7 +  On SAM_Click
.head 8 -  Set nTmp=SalListQuerySelection( hWndItem )
.head 8 +  If nTmp>=0
.head 9 -  Set nVob = mVob[nTmp]
.head 8 +  Else
.head 9 -  Set nVob = 0
.head 8 +  If nVob=96
.head 9 -  Set dfValD1= SalDateMonthBegin( dDat )-1
.head 9 +  While IsHolyDay(nBaseVal,dfValD1)
.head 10 -  Set dfValD1=  dfValD1 - 1
.head 8 +  Else If nVob=99
.head 9 -  Set dfValD1= SalDateYearBegin( dDat )-1
.head 9 +  While IsHolyDay(nBaseVal,dfValD1)
.head 10 -  Set dfValD1=  dfValD1 - 1
.head 5 -  Background Text: №
.head 6 -  Resource Id: 38051
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 36
.head 6 -  Class:
.head 6 -  Window Location and Size
.head 7 -  Left:   4.586"
.head 7 -  Top:    0.094"
.head 7 -  Width:  0.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.167"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Justify: Right
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 5 +  Data Field: dfNd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 23
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 10
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   4.986"
.head 8 -  Top:    0.024"
.head 8 -  Width:  1.8"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfDateFrom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 155
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.857"
.head 8 -  Top:    0.095"
.head 8 -  Width:  0.6"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfDateFrom = CurrentLangTable.GetAtomTitle('DocWDfDateFrom')
.head 5 +  Data Field: dfDocD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 22
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Date/Time
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.586"
.head 8 -  Top:    0.024"
.head 8 -  Width:  1.571"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Date
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If bFixDocD and dFixDocD or bFixAll and dFixDocD
.head 9 -  Set dfDocD=dFixDocD
.head 8 +  Else
.head 9 +  If nFdd=1
.head 10 -  Call SqlPrepareAndExecute( hSql(), "SELECT TRUNC(SYSDATE) INTO :dfDocD FROM dual" )
.head 10 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Set dfDocD=dDat
.head 9 +  Else If nFdd=2
.head 10 -  Set dfDocD=SalDateCurrent(  )
.head 9 +  Else
.head 10 -  Set dfDocD=dDat
.head 8 -  Call SetItsColo(bFixDocD,COLOR_LightGray,COLOR_SysWindow)
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsValidDateTime( hWndItem )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDateFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If dfDocD<SalDateConstruct(1990,1,1,0,0,0) or 
   dfDocD>SalDateConstruct(2020,1,1,0,0,0)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDateValue'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If bFixDocD
.head 9 -  Set dFixDocD=dfDocD
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SetItsColo(bFixDocD,COLOR_LightGray,COLOR_SysWindow)
.head 7 +  On SAM_ContextMenu
.head 8 -  Set bFixDocD=not bFixDocD
.head 8 -  Set dFixDocD=dfDocD
.head 8 -  Call SalSendMsg( hWndItem, SAM_Create, 0, 0 )
.head 8 -  Call SetItsColo(bFixDocD,COLOR_LightGray,COLOR_SysWindow)
.head 8 -  Return FALSE
.head 5 +  Data Field: dfBankA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 4
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 11
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.083"
.head 8 -  Top:    0.845"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 -  Set dfNbA =GetBankName()
.head 8 -  Set dfBankA = GetBankMfo()
.head 8 -  Call HideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Return VALIDATE_Ok
.head 5 +  Data Field: dfKvA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 50
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 3
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.383"
.head 8 -  Top:    0.594"
.head 8 -  Width:  0.733"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull ( hWndItem ) and not  bTotVal
.head 9 -  Set nKvA=0
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsValidInteger( hWndItem )
.head 9 -  Set sTmp='kv'
.head 8 +  Else
.head 9 -  Set sTmp='lcv'
.head 9 -  Set dfKvA=SalStrUpperX( dfKvA )
.head 8 -  Call SqlPrepareAndExecute( hSql(), "SELECT kv,lcv,dig,unit INTO :nKvA,:dfKvA,:nDigA,:sDigNa FROM tabval WHERE "||sTmp||"=:dfKvA" )
.head 8 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNoCurrencyFound')||' '||dfKvA,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 8 +  If dfNlsA
.head 9 -  Return SalSendMsg( dfNlsA, SAM_Validate, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_Create
.head 8 +  If nKvA and (nKvA_TT or not nFlv and nKvB and nKvB_TT)
.head 9 -  Call SqlPrepareAndExecute( hSql(), "SELECT lcv,dig,unit INTO :dfKvA,:nDigA,:sDigNa FROM tabval WHERE kv=:nKvA" )
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 9 -  Call HideIt(hWndItem)
.head 9 -  Return TRUE
.head 8 +  Else If bFixKvA or bFixAll
.head 9 -  Set dfKvA=sFixKvA
.head 9 -  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 -  Call UnHideIt( hWndItem )
.head 7 +  On UM_Update
.head 8 +  If nDigA
.head 9 -  Set sTmp='#0'||sDecimal||SalStrRepeatX( '0', nDigA )
.head 8 +  Else
.head 9 -  Set sTmp='#0'
.head 8 +  If nFlv
.head 9 -  Call SalFmtSetPicture( dfSumA, sTmp )
.head 9 -  Set dfSumNA=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')||' '||dfKvA
.head 8 +  Else
.head 9 +  If nFcb
.head 10 -  Call SalFmtSetPicture( dfRatNom, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumA, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumB, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumC, sTmp )
.head 9 -  Set dfSumNC=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')||' '||dfKvA
.head 9 -  Set nKvB=nKvA
.head 9 -  Set nDigB=nDigA
.head 9 -  Set sDigNb=sDigNa
.head 9 +  If dfNlsB and dfKvB != dfKvA
.head 10 -  Set dfKvB=dfKvA
.head 10 -  Call SalSendMsg( dfNlsB, SAM_Validate, 0, 0 )
.head 9 -  Set dfKvB=dfKvA
.head 8 +  If nFlv and nKvB and not bTotVal
.head 9 -  Call GetXRate(nRatO,nRatB,nRatS,nKvA,nKvB,dfValD1)
.head 9 +  If nFtr=1 
.head 10 +  If nDk=0 or nDk=2
.head 11 -  Set dfRatNom = nRatS
.head 10 +  Else
.head 11 -  Set dfRatNom = nRatB
.head 10 -  Call SetTagKurs(dfRatNom,'KURS')
.head 9 +  Else
.head 10 -  Set dfRatNom = nRatO
.head 8 +  If nFeq and not bTotVal
.head 9 -  Call GetXRate(nRatO,nRatB,nRatS,nKvA,nBaseVal,dfValD1)
.head 9 -  Set dfEquiv = nRatO
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfNlsA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 2
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 14
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.083"
.head 8 -  Top:    0.594"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If sNlsA
.head 9 -  Set dfNlsA=sNlsA
.head 9 +  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Cancel
.head 10 -  Set sNlsA=''
.head 10 -  Set dfNlsA=''
.head 9 +  Else
.head 10 -  Call HideIt( hWndItem )
.head 8 +  Else If bFixNlsA or bFixAll
.head 9 -  Set dfNlsA=sFixNlsA
.head 9 -  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 9 -  Call SetItsColo(bFixNlsA,COLOR_LightGray,COLOR_SysWindow)
.head 7 +  On SAM_Validate
.head 8 +  If SalQueryFieldEdit ( hWndItem )
.head 9 -  Call SalClearField( dfNamA )
.head 9 -  Call SalClearField( dfOkpoA )
.head 8 -  Set dfNlsA=SalStrTrimX(dfNlsA)
.head 8 +  If wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull ( hWndItem ) and not  bTotVal
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If not SalIsValidInteger( hWndItem )  
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotNumA'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If dfNlsA != KeyAccount( dfBankA, dfNlsA)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsCrcA'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If nKvA and not  bTotVal
.head 9 +  If nDk=0 or nDk=2
.head 10 -  Set sTmp='K'
.head 9 +  Else If nDk=1 or nDk=3
.head 10 -  Set sTmp='D'
.head 9 +  Else
.head 10 -  Set sTmp=''
.head 9 +  If SqlPrepareAndExecute(hSql(),T(
"SELECT s.nms,NVL(TRIM(k.nmkk),TRIM(k.nmk)),k.nmkv,k.okpo, k.country  
  INTO :sNamAStored1,:sNamAStored2,:str50,:dfOkpoA, :nTmpCountry  
  FROM saldo"|| sTmp ||" s,customer k,cust_acc a 
  WHERE nls = :dfNlsA AND kv = :nKvA AND a.rnk=k.rnk AND s.acc=a.acc AND s.dazs IS NULL" ))
.head 10 +  If SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Set sNamAStored1=SalStrTrimX(sNamAStored1)
.head 11 -  Set sNamAStored2=SalStrTrimX(sNamAStored2)
.head 11 +  If sKlF   !! Уточнение ОКПО по признаку б/с
.head 12 -  Call OKPOamnd(dfNlsA,dfOkpoA)
.head 11 +  If NOT dfOkpoA
.head 12 -  ! ОКПО нерезидентов
.head 12 +  If GetBankCountryCode()!=nTmpCountry
.head 13 -  Set dfOkpoA=SalNumberToStrX( nTmpCountry, 0 )
.head 12 -  ! Недорегистрированные клиенты
.head 12 +  Else
.head 13 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrOkpoNlsA')||' '||dfKvA||"-"||dfNlsA ,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
.head 13 -  Return VALIDATE_Cancel
.head 11 +  If not SalStrTrimX(dfNamA)
.head 12 +  If nFli = 1  ! Если межбанк СЭП то клиента
.head 13 -  Set dfNamA=sNamAStored2
.head 12 +  Else ! Иначе - Наименован Счета
.head 13 -  Set dfNamA=sNamAStored1
.head 12 +  If nFli = 2 
.head 13 -  Set i = VisArrayFindString (aTag, '50')
.head 13 +  If i > 0
.head 14 +  If str50
.head 15 -  Set aVal[i]=str50
.head 14 +  Else
.head 15 -  Set aVal[i]=sNamAStored2
.head 11 -  Call SalSendMsg( dfOst, SAM_Validate, 0, 0 )
.head 10 +  Else
.head 11 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotFound')||' '||dfKvA||"-"||dfNlsA ,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
.head 11 -  Set hWnd4Focus=hWndItem
.head 11 -  Return VALIDATE_Cancel
.head 8 +  If bFixNlsA 
.head 9 -  Set sFixNlsA=dfNlsA
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bAccA=1
.head 8 -  Call SalEnableWindow(  pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SetItsColo(bFixNlsA,COLOR_LightGray,COLOR_SysWindow)
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccA=0
.head 9 -  Call SalDisableWindow(  pbHelp )
.head 7 +  On SAM_ContextMenu
.head 8 +  If bFixNlsA
.head 9 -  Set bFixNlsA=FALSE
.head 9 -  Set sFixNlsA=STRING_Null
.head 8 +  Else
.head 9 -  Set bFixNlsA=TRUE
.head 9 -  Set sFixNlsA=dfNlsA
.head 8 -  Call SalSendMsg( hWndItem, SAM_Create, 0, 0 )
.head 8 -  Call SetItsColo(bFixNlsA,COLOR_LightGray,COLOR_SysWindow)
.head 8 -  Return FALSE
.head 5 +  Data Field: dfPlat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 8
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.233"
.head 8 -  Top:    0.333"
.head 8 -  Width:  1.386"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nDk=0 or nDk=2
.head 9 -  Set dfPlat=CurrentLangTable.GetAtomTitle('DocWDfNamPolu')
.head 8 +  Else
.head 9 -  Set dfPlat=CurrentLangTable.GetAtomTitle('DocWDfNamPlat')
.head 5 +  Data Field: dfNamA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 7
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 38
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.633"
.head 8 -  Top:    0.594"
.head 8 -  Width:  4.6"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set dfNamA=SalStrTrimX( dfNamA )
.head 8 +  If SalStrLength(dfNamA )<3 and bTotVal
.head 9 +  If nDk=0 or nDk=2
.head 10 -  Set sTmp=CurrentLangTable.GetAtomTitle('DocWDfNamPolu')
.head 9 +  Else
.head 10 -  Set sTmp=CurrentLangTable.GetAtomTitle('DocWDfNamPlat')
.head 9 -  Call SalMessageBox(sTmp||'. '||CurrentLangTable.GetAtomTitle('DocWMesErrNam'),
                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If SalStrLength(dfNamA )>=3 and not (bFixNlsA or bFixAll)
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bNamA=TRUE
.head 8 -  Set bAccA=2
.head 8 -  Call SalEnableWindow( pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 -  Set bNamA=FALSE
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccA=0
.head 9 -  Call SalDisableWindow( pbHelp )
.head 7 +  On SAM_ContextMenu
.head 8 +  If dfNamA=SalStrLeftX(sNamAStored1,38)
.head 9 -  Set dfNamA=sNamAStored2
.head 8 +  Else
.head 9 -  Set dfNamA=sNamAStored1
.head 8 -  Return FALSE
.head 7 +  ! On WM_KeyUp
.head 8 +  If wParam=0x7b     ! VK_F12
.head 9 -  Call SalSendMsg( hWndItem, SAM_ContextMenu, 0, 0 )
.head 5 +  Data Field: dfOkpoA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 139
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 10
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.183"
.head 8 -  Top:    0.595"
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set dfOkpoA=SalStrTrimX( dfOkpoA )
.head 8 +  If SalIsNull ( hWndItem ) and not bTotVal
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsValidInteger( hWndItem ) and 
   (SalStrLength(dfOkpoA) > 8 and SalStrLength(dfOkpoA) < 11 or dfOkpoA='99999')
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalStrLength(dfOkpoA) < 8 
.head 9 -  Set dfOkpoA=SalStrRightX( '00000000'||dfOkpoA, 8 )
.head 8 +  If not SalIsNull ( hWndItem ) and dfOkpoA=V_Okpo(dfOkpoA) and dfOkpoA !='00000000'
.head 9 -  Return VALIDATE_Ok
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrOkpoNotNumA'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If not SalIsNull(dfOkpoA) and not (bFixNlsA or bFixAll)
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bAccA=3
.head 8 -  Call SalEnableWindow( pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccA=0
.head 9 -  Call SalDisableWindow( pbHelp )
.head 5 +  Data Field: dfPlatB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 9
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.286"
.head 8 -  Top:    0.869"
.head 8 -  Width:  1.386"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? No
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfPlatB=CurrentLangTable.GetAtomTitle('DocWDfNamBankA')
.head 5 +  Data Field: dfNbA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 6
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.183"
.head 8 -  Top:    0.845"
.head 8 -  Width:  6.05"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfNbA =GetBankName()
.head 8 -  Call HideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Return VALIDATE_Ok
.head 5 +  Data Field: dfBankB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 13
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 11
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.083"
.head 8 -  Top:    2.344"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If SalStrLength(sBankB)>0
.head 9 -  Set dfBankB = sBankB
.head 8 +  Else If bFixMfoB or bFixAll
.head 9 -  Set dfBankB=sFixMfoB
.head 9 -  Call SetItsColo(bFixMfoB,COLOR_LightGray,COLOR_SysWindow)
.head 8 +  If nFli = 0 or nFli = 2  ! Если Внутренние или SWIFT
.head 9 -  Set dfBankB = GetBankMfo()
.head 8 +  If SalStrLength(dfBankB)>0
.head 9 -  Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 8 +  If nFli = 0 or nFli = 2 or SalStrLength(sBankB)>0
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 +  If bFixAll and SalQueryFieldEdit ( hWndItem )
.head 9 -  Call SalClearField( dfNlsB )
.head 9 -  Call SalClearField( dfNamB )
.head 9 -  Call SalClearField( dfOkpoB )
.head 8 -  Set dfBankB=SalStrTrimX(dfBankB)
.head 8 +  If SalIsNull ( hWndItem ) and not  bTotVal
.head 9 -  Return VALIDATE_Ok
.head 8 +  If not SalIsValidInteger( dfBankB )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrMFONotNumB'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If not IsValidMFO( dfBankB )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrMFOCrcB'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(), T("select nb into :dfNbB from banks where mfo = :dfBankB and nvl(blk,0)<>4" ) )
.head 9 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrMFONotFound')||' '||dfBankB,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bMfoB=TRUE
.head 8 -  Call SalEnableWindow(  pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 +  If not  wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bMfoB=FALSE
.head 9 -  Call SalDisableWindow(  pbHelp )
.head 5 +  Data Field: dfPoluB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 18
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.233"
.head 8 -  Top:    2.369"
.head 8 -  Width:  1.386"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? No
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfPoluB=CurrentLangTable.GetAtomTitle('DocWDfNamBankB')
.head 5 +  Data Field: dfNbB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 15
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.183"
.head 8 -  Top:    2.344"
.head 8 -  Width:  6.05"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call HideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Return VALIDATE_Ok
.head 5 +  Data Field: dfKvB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 51
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 3
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.383"
.head 8 -  Top:    2.095"
.head 8 -  Width:  0.733"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull ( hWndItem ) and not bTotVal
.head 9 -  Set nKvB=0
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsValidInteger( hWndItem )
.head 9 -  Set sTmp='kv'
.head 8 +  Else
.head 9 -  Set sTmp='lcv'
.head 9 -  Set dfKvB=SalStrUpperX( dfKvB )
.head 8 -  Call SqlPrepareAndExecute( hSql(), "SELECT kv,lcv,dig,unit INTO :nKvB,:dfKvB,:nDigB,:sDigNb FROM tabval WHERE "||sTmp||"=:dfKvB" )
.head 8 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNoCurrencyFound')||' '||dfKvB, 
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 8 +  If dfNlsB
.head 9 -  Return SalSendMsg( dfNlsB, SAM_Validate, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_Create
.head 8 +  If nKvB and (nKvB_TT or not nFlv and nKvA and nKvA_TT)
.head 9 -  Call SqlPrepareAndExecute( hSql(), "SELECT lcv,dig,unit INTO :dfKvB,:nDigB,:sDigNb FROM tabval WHERE kv=:nKvB" )
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 9 -  Call HideIt(hWndItem)
.head 9 -  Return TRUE
.head 8 +  Else If bFixKvB or bFixAll
.head 9 -  Set dfKvB=sFixKvB
.head 9 -  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 8 -  Call UnHideIt( hWndItem )
.head 7 +  On UM_Update
.head 8 +  If nDigB
.head 9 -  Set sTmp='#0'||sDecimal||SalStrRepeatX( '0', nDigB )
.head 8 +  Else
.head 9 -  Set sTmp='#0'
.head 8 +  If nFlv
.head 9 -  Call SalFmtSetPicture( dfSumB, sTmp )
.head 9 -  Set dfSumNB=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')||' '||dfKvB
.head 8 +  Else
.head 9 +  If nFcb
.head 10 -  Call SalFmtSetPicture( dfRatNom, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumA, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumB, sTmp )
.head 9 -  Call SalFmtSetPicture( dfSumC, sTmp )
.head 9 -  Set dfSumNC=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')||' '||dfKvB
.head 9 -  Set nKvA=nKvB
.head 9 -  Set nDigA=nDigB
.head 9 -  Set sDigNa=sDigNb
.head 9 +  If dfNlsA and dfKvA != dfKvB
.head 10 -  Set dfKvA=dfKvB
.head 10 -  Call SalSendMsg( dfNlsA, SAM_Validate, 0, 0 )
.head 9 -  Set dfKvA=dfKvB
.head 8 +  If nFlv and nKvA and not bTotVal
.head 9 -  Call GetXRate(nRatO,nRatB,nRatS,nKvA,nKvB,dfValD1)
.head 9 +  If nFtr=1 
.head 10 +  If nDk=0 or nDk=2
.head 11 -  Set dfRatNom = nRatS
.head 10 +  Else
.head 11 -  Set dfRatNom = nRatB
.head 10 -  Call SetTagKurs(dfRatNom,'KURS')
.head 9 +  Else
.head 10 -  Set dfRatNom = nRatO
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfNlsB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 11
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 14
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.083"
.head 8 -  Top:    2.09"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If sNlsB
.head 9 -  Set dfNlsB=sNlsB
.head 9 +  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Cancel
.head 10 -  Set sNlsB=''
.head 10 -  Set dfNlsB=''
.head 9 +  Else
.head 10 -  Call HideIt( hWndItem )
.head 8 +  Else If bFixNlsB or bFixAll
.head 9 -  Set dfNlsB=sFixNlsB
.head 9 -  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 9 -  Call SetItsColo(bFixNlsB,COLOR_LightGray,COLOR_SysWindow)
.head 7 +  On SAM_Validate
.head 8 +  If SalQueryFieldEdit ( hWndItem )
.head 9 -  Call SalClearField( dfNamB )
.head 9 -  Call SalClearField( dfOkpoB )
.head 8 -  Set dfNlsB=SalStrTrimX(dfNlsB)
.head 8 +  If wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull ( hWndItem ) and not bTotVal
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If not SalIsValidInteger( hWndItem )  
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotNumB'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If not SalIsNull(dfBankB)
.head 9 +  If dfNlsB != KeyAccount( dfBankB, dfNlsB)
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsCrcB'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation ) 
.head 10 -  Return VALIDATE_Cancel
.head 8 +  If nKvB and not  bTotVal
.head 9 +  If dfBankB = dfBankA
.head 10 +  If nDk=0 or nDk=2
.head 11 -  Set sTmp='D'
.head 10 +  Else If nDk=1 or nDk=3
.head 11 -  Set sTmp='K'
.head 10 +  Else
.head 11 -  Set sTmp=''
.head 10 -  Call SqlPrepareAndExecute(hSql(),T(
"SELECT s.nms,NVL(TRIM(k.nmkk),TRIM(k.nmk)),k.okpo, k.country 
  INTO :sNamBStored1,:sNamBStored2,:dfOkpoB, :nTmpCountry 
  FROM saldo"|| sTmp ||" s,customer k,cust_acc a 
  WHERE nls = :dfNlsB AND kv = :nKvB AND a.rnk=k.rnk AND s.acc=a.acc AND s.dazs IS NULL" ))
.head 10 +  If SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Set sNamBStored1=SalStrTrimX(sNamBStored1)
.head 11 -  Set sNamBStored2=SalStrTrimX(sNamBStored2)
.head 11 +  If sKlF   !! Уточнение ОКПО по признаку б/с
.head 12 -  Call OKPOamnd(dfNlsB,dfOkpoB)
.head 11 +  If NOT dfOkpoB
.head 12 -  ! ОКПО нерезидентов
.head 12 +  If GetBankCountryCode()!=nTmpCountry
.head 13 -  Set dfOkpoB=SalNumberToStrX( nTmpCountry, 0 )
.head 12 -  ! Недорегистрированные клиенты
.head 12 +  Else
.head 13 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrOkpoNlsB')||' '||dfKvB||"-"||dfNlsB ,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
.head 13 -  Return VALIDATE_Cancel
.head 11 +  If not SalStrTrimX(dfNamB)
.head 12 +  If nFli = 1  ! Если межбанк СЭП то клиента
.head 13 -  Set dfNamB=sNamBStored2
.head 12 +  Else ! Иначе - Наименован Счета
.head 13 -  Set dfNamB=sNamBStored1
.head 10 +  Else
.head 11 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNlsNotFound')||' '||dfKvB||"-"||dfNlsB,
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'),  MB_IconExclamation )
.head 11 -  Set hWnd4Focus=hWndItem
.head 11 -  Return VALIDATE_Cancel
.head 9 +  Else
.head 10 -  Call SqlPrepareAndExecute( hSql(),
T("SELECT name,okpo INTO :dfNamB,:dfOkpoB from alien  where mfo = :dfBankB AND nls = :dfNlsB and kv = :nKvB" ) )
.head 10 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Set dfNamB=''
.head 11 -  Set dfOkpoB=''
.head 8 +  If bFixNlsB 
.head 9 -  Set sFixNlsB=dfNlsB
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bAccB=1
.head 8 -  Call SalEnableWindow( pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SetItsColo(bFixNlsB,COLOR_LightGray,COLOR_SysWindow)
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccB=0
.head 9 -  Call SalDisableWindow( pbHelp )
.head 7 +  On SAM_ContextMenu
.head 8 +  If bFixNlsB
.head 9 -  Set bFixNlsB=FALSE
.head 9 -  Set sFixNlsB=STRING_Null
.head 8 +  Else
.head 9 -  Set bFixNlsB=TRUE
.head 9 -  Set sFixNlsB=dfNlsB
.head 8 -  Call SalSendMsg( hWndItem, SAM_Create, 0, 0 )
.head 8 -  Call SetItsColo(bFixNlsB,COLOR_LightGray,COLOR_SysWindow)
.head 8 -  Return FALSE
.head 5 +  Data Field: dfPolu
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 17
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.233"
.head 8 -  Top:    1.833"
.head 8 -  Width:  1.386"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nDk=0 or nDk=2
.head 9 -  Set dfPolu=CurrentLangTable.GetAtomTitle('DocWDfNamPlat')
.head 8 +  Else
.head 9 -  Set dfPolu=CurrentLangTable.GetAtomTitle('DocWDfNamPolu')
.head 5 +  Data Field: dfNamB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 16
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 38
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.633"
.head 8 -  Top:    2.095"
.head 8 -  Width:  4.6"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set dfNamB=SalStrTrimX( dfNamB )
.head 8 +  If SalStrLength(dfNamB )<3 and bTotVal
.head 9 +  If nDk=0 or nDk=2
.head 10 -  Set sTmp=CurrentLangTable.GetAtomTitle('DocWDfNamPlat')
.head 9 +  Else
.head 10 -  Set sTmp=CurrentLangTable.GetAtomTitle('DocWDfNamPolu')
.head 9 -  Call SalMessageBox( sTmp||'. '||CurrentLangTable.GetAtomTitle('DocWMesErrNam'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If SalStrLength(dfNamB )>=3 and not (bFixNlsB or bFixAll)
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bNamB=TRUE
.head 8 -  Set bAccB=2
.head 8 -  Call SalEnableWindow( pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 -  Set bNamB=FALSE
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccB=0
.head 9 -  Call SalDisableWindow( pbHelp )
.head 7 +  On SAM_ContextMenu
.head 8 +  If dfBankB = dfBankA
.head 9 +  If dfNamB=SalStrLeftX(sNamBStored1,38)
.head 10 -  Set dfNamB=sNamBStored2
.head 9 +  Else
.head 10 -  Set dfNamB=sNamBStored1
.head 8 -  Return FALSE
.head 7 +  ! On WM_KeyUp
.head 8 +  If wParam=0x7b     ! VK_F12
.head 9 -  Call SalSendMsg( hWndItem, SAM_ContextMenu, 0, 0 )
.head 5 +  Data Field: dfOkpoB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 140
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 10
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   0.183"
.head 8 -  Top:    2.095"
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set dfOkpoB=SalStrTrimX( dfOkpoB )
.head 8 +  If SalIsNull ( hWndItem ) and not bTotVal
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsValidInteger( hWndItem ) and 
   (SalStrLength(dfOkpoB) > 8 and SalStrLength(dfOkpoB) < 11 or dfOkpoB='99999')
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalStrLength(dfOkpoB) <8
.head 9 -  Set dfOkpoB=SalStrRightX( '00000000'||dfOkpoB, 8 )
.head 8 +  If not SalIsNull ( hWndItem ) and dfOkpoB=V_Okpo(dfOkpoB) and dfOkpoB !='00000000'
.head 9 -  Return VALIDATE_Ok
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrOkpoNotNumB'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 8 +  If not SalIsNull(dfOkpoB) and not (bFixNlsB or bFixAll)
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bAccB=3
.head 8 -  Call SalEnableWindow( pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 +  If not wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bAccB=0
.head 9 -  Call SalDisableWindow( pbHelp )
.head 5 +  Data Field: dfSumNA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 135
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.683"
.head 8 -  Top:    1.262"
.head 8 -  Width:  2.0"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFlv
.head 9 -  Set dfSumNA=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')
.head 9 -  Call SalShowWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Data Field: dfSumA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 20
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 20
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   3.786"
.head 8 -  Top:    1.238"
.head 8 -  Width:  2.3"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call UnHideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Call DecPoint(hWndItem)
.head 8 +  If not SalIsValidDecimal( hWndItem, 15, nDigA )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumFormat')||' '||SalNumberToStrX(nDigA,0),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dfSumA=SalNumberAbs(dfSumA)
.head 8 +  If SalIsNull( hWndItem ) or (dfSumA=0 and not nFeq)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumBlank'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If nFlv and dfRatNom and not bTotVal   ! and not SalQueryFieldEdit ( dfSumB )
.head 9 -  Set dfSumB=dfSumA*dfRatNom
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfSumNB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 122
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.683"
.head 8 -  Top:    1.583"
.head 8 -  Width:  2.0"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Set dfSumNB=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Data Field: dfSumB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 21
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 20
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   3.786"
.head 8 -  Top:    1.56"
.head 8 -  Width:  2.3"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call UnHideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Call DecPoint(hWndItem)
.head 8 +  If not SalIsValidDecimal( hWndItem, 15, nDigB )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumFormat')||' '||SalNumberToStrX(nDigB,0),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dfSumB=SalNumberAbs(dfSumB)
.head 8 +  If SalIsNull( hWndItem ) or (dfSumB=0 and not nFeq)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumBlank'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If nFlv and nFtr and dfSumA and not bTotVal                          ! and not SalQueryFieldEdit ( dfSumA )
.head 9 +  If nFtr=1 and nFhr=0
.head 10 -  Set dfRatNom=dfSumB/dfSumA
.head 10 -  Call SetTagKurs(dfRatNom,'KURS')
.head 9 +  Else If nFtr=3 and nFhr=0
.head 10 -  Set dfSumB=dfSumA*dfRatNom
.head 8 +  If nFhr=1 and dfRatNom and not bTotVal
.head 9 -  Set dfSumA=dfSumB/dfRatNom
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfRatNomN      ! Курс для Мультивал или Номинал для ЦБ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 123
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.229"
.head 8 -  Top:    1.44"
.head 8 -  Width:  1.083"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFcb
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Set dfRatNomN=CurrentLangTable.GetAtomTitle('DocWDfNamNom')
.head 8 +  Else If nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 +  If nFtr=1
.head 10 +  If nDk=0 or nDk=2
.head 11 -  Set dfRatNomN=CurrentLangTable.GetAtomTitle('DocWDfNamRatS')
.head 10 +  Else
.head 11 -  Set dfRatNomN=CurrentLangTable.GetAtomTitle('DocWDfNamRatB')
.head 9 +  Else
.head 10 -  Set dfRatNomN=CurrentLangTable.GetAtomTitle('DocWDfNamRat')
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Data Field: dfRatNom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 57
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.283"
.head 8 -  Top:    1.417"
.head 8 -  Width:  1.886"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFcb
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call SalFmtSetPicture( dfRatNom, '#0'||sDecimal||'00' )
.head 9 -  Call UnHideIt( hWndItem )
.head 8 +  Else If nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 +  If nFtr=1
.head 10 -  Call UnHideIt( hWndItem )
.head 9 +  Else
.head 10 -  Call HideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 8 +  If nFhr    ! Не дать корректоровать курс
.head 9 -  Call HideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 -  Call DecPoint(hWndItem)
.head 8 +  If nFcb
.head 9 +  If not SalIsValidDecimal( hWndItem, 15, nDigA )
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNomFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 10 -  Return VALIDATE_Cancel
.head 9 -  Call SetTagKurs(dfRatNom,'NOM')
.head 9 +  If sS and dfRatNom and not bTotVal
.head 10 +  If sS
.head 11 -  Set nTmp=dfRatNom*SalNumberPower( 10, nDigA )
.head 11 +  If SumPoNom(nTmp,sS,nTmp)
.head 12 -  Set dfSumC=nTmp/SalNumberPower( 10, nDigA )
.head 12 -  Call SalSetFieldEdit ( dfSumC, TRUE )
.head 11 -  Return SalSendMsg( dfSumC, SAM_Validate, 0, 0 )
.head 8 +  Else If nFlv and nFtr=1
.head 9 +  If dfSumA and dfRatNom and not bTotVal
.head 10 -  Set dfSumB=dfSumA*dfRatNom
.head 10 -  Call SetTagKurs(dfRatNom,'KURS')
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfSumNC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 125
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.683"
.head 8 -  Top:    1.44"
.head 8 -  Width:  2.0"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFlv
.head 9 -  Call SalHideWindow( hWndItem )
.head 8 +  Else
.head 9 -  Set dfSumNC=CurrentLangTable.GetAtomTitle('DocWDfNamSumma')
.head 9 -  Call SalShowWindow( hWndItem )
.head 5 +  Data Field: dfSumC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 44
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 20
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   3.786"
.head 8 -  Top:    1.417"
.head 8 -  Width:  2.3"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create   
.head 8 +  If nFlv
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call UnHideIt( hWndItem )
.head 9 +  If nS
.head 10 -  Set dfSumC=nS
.head 10 -  Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 7 +  On SAM_Validate
.head 8 -  ! Set sTmp=SalStrRepeatX( ' ', 20 )
.head 8 -  ! Call SalGetWindowText ( hWndItem, sTmp, 20 )
.head 8 +  ! While SalStrScan(sTmp, sDecimal2) > 0
.head 9 -                              Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 8 -  ! Call SalFmtStrToField ( hWndItem, sTmp, TRUE)
.head 8 -  Call DecPoint(hWndItem)
.head 8 +  If not SalIsValidDecimal( hWndItem, 15, nDigA )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dfSumC=SalNumberAbs(dfSumC)
.head 8 +  If SalIsNull( hWndItem ) or (dfSumC=0 and not nFeq)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumBlank'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dfSumA=dfSumC
.head 8 -  Set dfSumB=dfSumC
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfEquivN      ! Еквівалент
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 144
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.183"
.head 8 -  Top:    1.429"
.head 8 -  Width:  1.083"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFeq and not nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Set dfEquivN=CurrentLangTable.GetAtomTitle('DocWDfNamEqv')
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Data Field: dfEquiv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 145
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.283"
.head 8 -  Top:    1.405"
.head 8 -  Width:  1.886"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: Decimal
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFeq and not nFlv
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call SalFmtSetPicture( hWndItem, '#0'||sDecimal||'00' )
.head 9 -  Call UnHideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 7 +  On SAM_Validate
.head 8 +  If nFeq
.head 9 -  ! Set sTmp=SalStrRepeatX( ' ', 20 )
.head 9 -  ! Call SalGetWindowText ( hWndItem, sTmp, 20 )
.head 9 +  ! While SalStrScan(sTmp, sDecimal2) > 0
.head 10 -                              Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 9 -  ! Call SalFmtStrToField ( hWndItem, sTmp, TRUE)
.head 9 -  Call DecPoint(hWndItem)
.head 9 +  If not SalIsValidDecimal( hWndItem, 15, 2 )
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNomFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  List Box: lb1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 85
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    2.81"
.head 7 -  Width:  1.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 1.0"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Multiple selection? No
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Horizontal Scroll? No
.head 6 -  List Initialization
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If not bFixAll
.head 9 -  Call SalListClear( hWndItem )
.head 9 -  ! Call SalListAdd( hWndItem, 'Назначение платежа' )
.head 9 -  Call SalListAdd( hWndItem, CurrentLangTable.GetAtomTitle('DocWNazn') )
.head 9 -  Call SalArraySetUpperBound( aTag, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aVal, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aBro, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aOpt, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aChk, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aVsp, 1, -1 )
.head 9 -  Call SalArraySetUpperBound( aF59, 1, -1 )
.head 9 -  Set aTag[0]='Details'
.head 9 +  If nFdp
.head 10 -  Set bStoreKURS=FALSE
.head 10 -  Set bStoreNOM=FALSE
.head 10 -  Set strMT=''
.head 10 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_3DFace )
.head 10 -  Call SqlPrepareAndExecute( hSql(), 
"SELECT a.tag,a.name,a.browser,b.opt,b.val,a.chkr,a.vspo_char,b.used4input
   INTO :sTmp1,:sTmp2,:sTmp3,:sTmp,:sTmp4,:sTmp5,:sTmp6,:nTmp
   FROM op_field a, op_rules b
  WHERE a.tag=b.tag AND b.tt=:sTT AND (b.used4input=1 or b.tag in ('KURS','NOM','f'))
  ORDER BY b.ord")
.head 10 -  Set i=0
.head 10 +  While SqlFetchNext(hSql(),nFetchRes)
.head 11 +  If SalStrTrimX(sTmp1)='KURS' and nTmp != 1
.head 12 -  Set bStoreKURS=TRUE
.head 11 +  Else If SalStrTrimX(sTmp1)='NOM' and nTmp != 1
.head 12 -  Set bStoreNOM=TRUE
.head 11 +  Else If SalStrTrimX(sTmp1)='f' and nTmp != 1
.head 12 -  Set strMT=SalStrTrimX(sTmp4)   ! Default SWIFT MT
.head 11 +  Else
.head 12 -  Set i=i+1
.head 12 -  Set aTag[i]=SalStrTrimX(sTmp1)
.head 12 -  Set aBro[i]=SalStrTrimX(sTmp3)
.head 12 -  Set aOpt[i]=SalStrTrimX(sTmp)
.head 12 -  Set aVal[i]=SalStrTrimX(sTmp4)
.head 12 -  Set aChk[i]=SalStrTrimX(sTmp5)
.head 12 -  Set aVsp[i]=SalStrTrimX(sTmp6)
.head 12 -  Call SalListAdd( hWndItem, SalStrTrimX(sTmp2))
.head 10 +  If VisArrayFindString (aTag, '59')>0
.head 11 -  Call SqlPrepareAndExecute( hSql(), "SELECT TRIM(nmk) INTO :sTmp FROM f59_field")
.head 11 -  Set i=0
.head 11 +  While SqlFetchNext(hSql(),nFetchRes)
.head 12 -  Set i=i+1
.head 12 -  Set aF59[i]=sTmp
.head 8 +  If nFdp
.head 9 -  Call UnHideIt( hWndItem )
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_3DFace )
.head 8 +  Else
.head 9 -  Call HideIt( hWndItem )
.head 8 -  Call SalListSetSelect( lb1, 0 )
.head 8 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 7 +  On SAM_Click
.head 8 -  Set dfNazn=aVal[SalListQuerySelection( lb1 )]
.head 5 +  Multiline Field: dfNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 24
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 160
.head 7 -  String Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Border? Yes
.head 7 -  Word Wrap? Yes
.head 7 -  Vertical Scroll? Yes
.head 7 -  Window Location and Size
.head 8 -  Left:   0.083"
.head 8 -  Top:    2.81"
.head 8 -  Width:  9.1"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 1.0"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set dfNazn=SalStrTrimX( dfNazn )
.head 8 +  If bNazn
.head 9 +  If not sTranN(dfNazn, dfNazn, sTT, dfNlsA, dfBankA, nKvA, dfSumA*SalNumberPower( 10, nDigA),
                                   dfNlsB, dfBankB, nKvB, dfSumB*SalNumberPower( 10, nDigB))
.head 10 -  Call MessageErrorEx('Ошибка формирования назначения платежа '|| m_sNazn)
.head 8 +  If bTotVal
.head 9 +  If SalStrLength(dfNazn )<3
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNazn'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 10 -  Return VALIDATE_Cancel
.head 9 +  If not SalArrayIsEmpty( aTag )
.head 10 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 10 +  While i>0
.head 11 +  If SalStrTrimX(aOpt[i])='M' and SalStrTrimX(aVal[i])=''
.head 12 -  Call SalMessageBox( 'Не заполнено <<'||SalListQueryTextX( lb1, i )||'>>',CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 12 -  Call SalListSetSelect( lb1, i )
.head 12 -  Set dfNazn=aVal[i]
.head 12 -  Return VALIDATE_Cancel
.head 11 -  ! Проверка допустимости доп реквизитов
.head 11 +  If SalStrTrimX(aVal[i]) and SalStrTrimX(aChk[i])
.head 12 +  If not cDopReq(SalStrTrimX(aChk[i]),SalStrTrimX(aTag[i]),SalStrTrimX(aVal[i]),
             sTT,dfNlsA,dfBankA,nKvA,dfSumA*SalNumberPower( 10, nDigA),
                 dfNlsB,dfBankB,nKvB,dfSumB*SalNumberPower( 10, nDigB))
.head 13 -  Call SalMessageBox( 'Недопустимое значение <<'||SalListQueryTextX( lb1, i )||'>>',CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 13 -  Call SalListSetSelect( lb1, i )
.head 13 -  Set dfNazn=aVal[i]
.head 13 -  Return VALIDATE_Cancel
.head 11 -  Set i=i-1
.head 8 -  Set aVal[SalListQuerySelection( lb1 )]=dfNazn 
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 +  If aTag[SalListQuerySelection( lb1 )]='59' ! SWIFT F59
.head 9 +  If SalStrMidX(SalStrTrimX(dfNazn),SalStrLength(SalStrTrimX(dfNazn))-1,1)=SalNumberToChar( 10 )
.head 10 -  Call SalArrayGetUpperBound( aF59, 1, i )
.head 10 +  While i>0
.head 11 +  If SalStrLeftX(aF59[i],            SalStrLength(SalStrTrimX(dfNazn))-2) = 
   SalStrLeftX(SalStrTrimX(dfNazn),SalStrLength(SalStrTrimX(dfNazn))-2)
.head 12 -  Set dfNazn=aF59[i]
.head 12 -  Call SalSetFieldEdit (dfNazn, TRUE )
.head 12 -  Break
.head 11 -  Set i=i-1
.head 7 +  On SAM_Create
.head 8 -  Call UnHideIt( hWndItem )
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 +  If SalListQuerySelection( lb1 )=0 or nFdp and aBro[SalListQuerySelection( lb1 )]
.head 9 -  Set bNazn=TRUE
.head 9 -  Call SalEnableWindow(  pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 +  If not  wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bNazn=FALSE
.head 9 -  Call SalDisableWindow(  pbHelp )
.head 7 +  On WM_Char
.head 8 +  If wParam = 9  ! Enter
.head 9 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 9 +  If i>=SalListQuerySelection( lb1 )+1
.head 10 -  Call SalListSetSelect( lb1, SalListQuerySelection( lb1 )+1 )
.head 10 -  Call SalSetFocus(dfNazn)
.head 9 +  Else
.head 10 -  Call SalListSetSelect( lb1, 0 )
.head 9 -  Call SalSendMsg( lb1, SAM_Click, 0, 0 )
.head 7 +  On SAM_ContextMenu
.head 8 +  If SalListQuerySelection( lb1 )=0
.head 9 -  Call SqlPrepareAndExecute(hSql(), "SELECT nazn INTO :sTmp FROM  tts WHERE tt=:sTT")
.head 9 +  If SqlFetchNext( hSql(), nFetchRes )
.head 10 +  If SalStrTrimX(sTmp)
.head 11 +  If sTranN(dfNazn, sTmp, sTT, dfNlsA, dfBankA, nKvA, dfSumA*SalNumberPower( 10, nDigA),
                                 dfNlsB, dfBankB, nKvB, dfSumB*SalNumberPower( 10, nDigB))
.head 12 -  Set aVal[0]=dfNazn 
.head 11 +  Else
.head 12 -  Call MessageErrorEx('Ошибка формирования назначения платежа '|| sTmp)
.head 8 -  Return FALSE
.head 5 +  Data Field: dfSkN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 115
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 1
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.283"
.head 8 -  Top:    2.369"
.head 8 -  Width:  0.35"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: None
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfSkN=CurrentLangTable.GetAtomTitle('DocWDfSkN')
.head 5 +  Data Field: dfSk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 48
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 2
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.633"
.head 8 -  Top:    2.345"
.head 8 -  Width:  0.471"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Right
.head 7 -  Format: #0
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfSk=nSk
.head 8 +  If nFsk = 0    ! некассовые
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow(dfSk)
.head 9 -  Call SalHideWindow(dfSkN)
.head 8 +  Else If nFsk = 1 and nSk > 0  ! кассовые и задан умалчиваемый символ
.head 9 -  Call HideIt( hWndItem )
.head 8 +  Else
.head 9 -  Call SalShowWindow(dfSk)
.head 9 -  Call SalShowWindow(dfSkN)
.head 9 -  Call UnHideIt( hWndItem )
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull ( hWndItem ) and not  bTotVal
.head 9 -  Return VALIDATE_Ok
.head 8 +  If nSk = NUMBER_Null
.head 9 -  Return VALIDATE_Ok
.head 8 +  If (nDk=0 or nDk=2) And dfSk < 40 or (nDk=1 or nDk=3) And dfSk >= 40
.head 9 -  Call SqlPrepareAndExecute( hSql(), T(" SELECT name INTO :sTmp FROM Sk WHERE sk=:dfSk AND (d_close IS NULL OR d_close>:dDat)" ) )
.head 9 +  If SqlFetchNext( hSql(), nFetchRes )
.head 10 +  If SalStrLength(SalStrTrimX( aVal[0] )) < 3
.head 11 -  Set aVal[0]=SalStrTrimX(sTmp) 
.head 10 +  If SalListQuerySelection( lb1 )=0
.head 11 -  Set dfNazn=aVal[0]
.head 10 -  Return VALIDATE_OkClearFlag
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DocWMesErrKasPlan'),
                   CurrentLangTable.GetAtomTitle('DlgMSG_Error'),MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 8 -  Set bSk=TRUE
.head 8 -  Call SalEnableWindow(  pbHelp )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 8 +  If not  wParam = SalWindowHandleToNumber( pbHelp )
.head 9 -  Set bSk=FALSE
.head 9 -  Call SalDisableWindow(  pbHelp )
.head 5 +  Data Field: dfValD1N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 116
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   2.883"
.head 8 -  Top:    3.94"
.head 8 -  Width:  1.383"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfValD1N=CurrentLangTable.GetAtomTitle('DocWDfNamDatVal')
.head 5 +  Data Field: dfValD2N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 131
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   6.283"
.head 8 -  Top:    3.94"
.head 8 -  Width:  1.367"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.19"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Dark Blue
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfValD2N=CurrentLangTable.GetAtomTitle('DocWDfNamDatVal')||' 2'
.head 5 +  Data Field: dfValD2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 66
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Date/Time
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.633"
.head 8 -  Top:    3.917"
.head 8 -  Width:  1.371"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Center
.head 7 -  Format: Date
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: System Window Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFvD2
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call SalShowWindow( dfValD2N )
.head 9 -  Call UnHideIt( hWndItem )
.head 9 -  Set dfValD2=dDat   
.head 8 +  Else
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 9 -  Call SalHideWindow( dfValD2N )
.head 9 -  Set dfValD2=DATETIME_Null  
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsValidDateTime( hWndItem )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDateFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If dfValD2<SalDateConstruct(1990,1,1,0,0,0) or 
   dfValD2>SalDateConstruct(2020,1,1,0,0,0)
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrDatVal')||' 2',
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  Data Field: dfD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 132
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.086"
.head 8 -  Top:    0.405"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.188"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Default
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nDk=0 or nDk=2
.head 9 -  Set dfD=CurrentLangTable.GetAtomTitle('DocWDfNamKre')
.head 9 -  Set nColor = COLOR_Red
.head 8 +  Else
.head 9 -  Set dfD=CurrentLangTable.GetAtomTitle('DocWDfNamDeb')
.head 9 -  Set nColor = COLOR_Blue
.head 8 -  Call SalColorSet( dfD, COLOR_IndexWindowText, nColor )
.head 5 +  Data Field: dfK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 133
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   7.086"
.head 8 -  Top:    1.91"
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.188"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Right
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Default
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nDk=0 or nDk=2
.head 9 -  Set dfK=CurrentLangTable.GetAtomTitle('DocWDfNamDeb')
.head 9 -  Set nColor = COLOR_Red
.head 8 +  Else
.head 9 -  Set dfK=CurrentLangTable.GetAtomTitle('DocWDfNamKre')
.head 9 -  Set nColor = COLOR_Blue
.head 8 -  Call SalColorSet( dfK, COLOR_IndexWindowText, nColor )
.head 5 -  Frame
.head 6 -  Resource Id: 38053
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 10
.head 6 -  Class:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.071"
.head 7 -  Top:    0.375"
.head 7 -  Width:  9.114"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.844"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Corners: Square
.head 6 -  Border Style: Etched
.head 6 -  Border Thickness: 1
.head 6 -  Border Color: 3D Shadow Color
.head 6 -  Background Color: Default
.head 5 -  Frame
.head 6 -  Resource Id: 38054
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 45
.head 6 -  Class:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.033"
.head 7 -  Top:    1.88"
.head 7 -  Width:  9.114"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.844"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Corners: Square
.head 6 -  Border Style: Etched
.head 6 -  Border Thickness: 1
.head 6 -  Border Color: 3D Shadow Color
.head 6 -  Background Color: Default
.head 5 -  Frame
.head 6 -  Resource Id: 38055
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 88
.head 6 -  Class:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.033"
.head 7 -  Top:    3.845"
.head 7 -  Width:  9.114"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.393"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Corners: Square
.head 6 -  Border Style: Etched
.head 6 -  Border Thickness: 1
.head 6 -  Border Color: 3D Shadow Color
.head 6 -  Background Color: Default
.head 5 +  Data Field: dfLocDat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 149
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.633"
.head 8 -  Top:    0.405"
.head 8 -  Width:  4.6"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.188"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? No
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Bold
.head 7 -  Text Color: Red
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If dDat = GetBankDate()
.head 9 -  Call SalHideWindow(dfLocDat)
.head 8 +  Else
.head 9 -  Set dfLocDat=CurrentLangTable.GetAtomTitle('DocWDfNamLocD') ||' '||
SalFmtFormatDateTime( dDat, 'dd/MM/yyyy' )    
.head 9 -  Call SalShowWindow(dfLocDat)
.head 5 +  Check Box: cbUgrnt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 130
.head 6 -  Class: cCheckBoxLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Aaa
.head 6 -  Window Location and Size
.head 7 -  Left:   0.133"
.head 7 -  Top:    3.917"
.head 7 -  Width:  1.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: System Window Color
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If nFug
.head 9 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('DocWDfNamUrgnt') )
.head 9 -  Call SalShowWindow( hWndItem )
.head 9 -  Call SalEnableWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Data Field: dfVytyagN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 142
.head 6 -  Class: cFieldLabel
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: 12
.head 7 -  Data Type: String
.head 7 -  Editable? No
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   1.283"
.head 8 -  Top:    3.94"
.head 8 -  Width:  1.383"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? No
.head 7 -  Border? No
.head 7 -  Justify: Center
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: 8
.head 7 -  Font Enhancement: Bold-Italic
.head 7 -  Text Color: Red
.head 7 -  Background Color: 3D Face Color
.head 7 -  Input Mask: Unformatted
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set dfVytyagN=CurrentLangTable.GetAtomTitle('DocWDfNamVytVkl')
.head 8 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 7 +  On UM_ObjActivate
.head 8 -  Set bFixAll=not bFixAll
.head 8 -  Call SalSendMsg( hWndItem, UM_Update, 0, 0 )
.head 7 +  On UM_Update
.head 8 +  If bFixAll
.head 9 -  Call SalShowWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bFaktPlan
.head 5 -  String: sVOB_ORD
.head 5 -  String: sTT
.head 5 -  String: sTTN
.head 5 -  String: mTT[*]
.head 5 -  Number: nDk
.head 5 -  Number: nKvA
.head 5 -  Number: nKvB
.head 5 -  Number: nKvC
.head 5 -  Number: nSk
.head 5 -  Number: nVob
.head 5 -  Number: mVob[*]
.head 5 -  Number: nId
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bOK
.head 5 -  Number: nTmp
.head 5 -  String: sTmp
.head 5 -  Date/Time: dTmp
.head 5 -  !
.head 5 -  Number: nBaseVal
.head 5 -  ! курсы
.head 5 -  Number: nRatO       ! курс официальный
.head 5 -  Number: nRatB       ! курс покупки
.head 5 -  Number: nRatS       ! курс продажи
.head 5 -  ! Флаги
.head 5 -  Number: nFpy	    ! признак оплаты по факт остатку
.head 5 -  Number: nFsk        ! признак кассовой операции
.head 5 -  Number: nFcb        ! признак операции по ценной бумаге
.head 5 -  Number: nFtr        ! признак торговой операции
.head 5 -  Number: nFbk        ! признак бэк/офисной операции
.head 5 -  Number: nFli        ! признак межбанка
.head 5 -  Number: nFlv        ! признак мультивалютной операции
.head 5 -  Number: nFpr        ! признак автоматической печати документа
.head 5 -  Number: nFdp        ! признак ввода дополнительных реквизитов
.head 5 -  Number: nFug        ! признак ввода приоритета платежа (срочности)
.head 5 -  Number: nFeq        ! признак ввода эквивалента
.head 5 -  Number: nFdd        ! признак установки даты документа по-умолчанию
.head 5 -  Number: nFhr        ! признак запрета корр поля "курс"
.head 5 -  Number: nFvD1       ! дата валютирования 1
.head 5 -  Number: nFvD2       ! дата валютирования 2
.head 5 -  Boolean: bDocStart
.head 5 -  Boolean: bTotVal
.head 5 -  Number: bAccA
.head 5 -  Number: bAccB
.head 5 -  Boolean: bNamA
.head 5 -  Boolean: bNamB
.head 5 -  Boolean: bNazn
.head 5 -  Boolean: bMfoB
.head 5 -  Boolean: bSk
.head 5 -  String: sBankB
.head 5 -  String: sNlsA
.head 5 -  String: sNlsB
.head 5 -  Number: nS
.head 5 -  String: sS         ! формула суммы основной операции
.head 5 -  String: sSS        ! формула суммы 2 основной операции
.head 5 -  !
.head 5 -  String: sDecimal   ! симв десятичной точки
.head 5 -  String: sDecimal2  ! симв десятичной точки alt
.head 5 -  String: str50      ! Наименование клиента INTERNATIONAL
.head 5 -  String: aF59[*]     
.head 5 -  Date/Time: dDat
.head 5 -  Window Handle: hNextDF
.head 5 -  String: sMfo
.head 5 -  String: sNb
.head 5 -  String: sNls
.head 5 -  String: sNms
.head 5 -  String: sNmk
.head 5 -  String: sLcv
.head 5 -  String: sOkpo
.head 5 -  Number: nKv
.head 5 -  Number: nOst
.head 5 -  Number: nPap
.head 5 -  Number: nColor
.head 5 -  Number: nDigA
.head 5 -  Number: nDigB
.head 5 -  !
.head 5 -  String: sDrec
.head 5 -  ! Стартовые значения предустановленных полей
.head 5 -  Number: nSk_TT
.head 5 -  Number: nKvA_TT
.head 5 -  Number: nKvB_TT
.head 5 -  String: sNlsA_TT
.head 5 -  String: sNlsB_TT
.head 5 -  String: sBankB_TT
.head 5 -  !
.head 5 -  String: strSumPr
.head 5 -  String: sDigNa
.head 5 -  String: sDigNb
.head 5 -  ! доп реквизиты
.head 5 -  String: aTag[*]
.head 5 -  String: aVal[*]
.head 5 -  String: aBro[*]     ! Имя Бровзера
.head 5 -  String: aOpt[*]
.head 5 -  String: aChk[*]     ! Строка вызова чекера
.head 5 -  String: aVsp[*]     ! Код вспомогат реквизита в СЕП     
.head 5 -  String: sTmp1
.head 5 -  String: sTmp2
.head 5 -  String: sTmp3
.head 5 -  String: sTmp4
.head 5 -  String: sTmp5
.head 5 -  String: sTmp6
.head 5 -  Number: i
.head 5 -  Number: nWMin
.head 5 -  Number: nWMax
.head 5 -  Number: nHMin
.head 5 -  Number: nHMax
.head 5 -  !
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  Number: nType
.head 5 -  ! для вытяжки
.head 5 -  Boolean: bFixAll
.head 5 -  Boolean: bFixNlsA
.head 5 -  Boolean: bFixNlsB
.head 5 -  Boolean: bFixMfoB
.head 5 -  Boolean: bFixDocD
.head 5 -  Boolean: bFixValD1
.head 5 -  Boolean: bFixKvA
.head 5 -  Boolean: bFixKvB
.head 5 -  String: sFixNlsA
.head 5 -  String: sFixNlsB
.head 5 -  String: sFixMfoB
.head 5 -  Date/Time: dFixDocD
.head 5 -  Date/Time: dFixValD1
.head 5 -  String: sFixKvA
.head 5 -  String: sFixKvB
.head 5 -  Number: nFixVob
.head 5 -  Number: nTmpCountry
.head 5 -  String: sNamAStored1
.head 5 -  String: sNamAStored2
.head 5 -  String: sNamBStored1
.head 5 -  String: sNamBStored2
.head 5 -  Number: hBtnOk
.head 5 -  Number: hBtns[*]
.head 5 -  String: sKlF
.head 5 -  String: sDeb_Up      ! Флаг "дебет сверху"
.head 5 -  String: sGetXRate    ! Имя функции для получения крос-курсов
.head 5 -  Number: bStoreKURS   ! Флаг для принудительного создания тєга KURS
.head 5 -  Number: bStoreNOM    ! Флаг для принудительного создания тєга NOM
.head 5 -  Window Handle: hWnd4Focus  ! Для установки фокуса после завершения CREATE на ошибочное поле
.head 5 -  Window Handle: hWnd4Alien  ! Для выбора из справочника ALIEN
.head 5 -  Number: nCount
.head 5 -  Number: nIdPodot
.head 5 -  String: strMT
.head 4 +  Functions
.head 5 +  Function: HideIt
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalDisableWindow( hWnd )
.head 7 -  Call SalColorSet( hWnd, COLOR_IndexWindow, COLOR_3DFace )
.head 7 -  Call SalColorSet( hWnd, COLOR_IndexWindowText, COLOR_SysWindowText )
.head 5 +  Function: UnHideIt
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalEnableWindow( hWnd )
.head 7 -  Call SalColorSet( hWnd, COLOR_IndexWindow, COLOR_SysWindow )
.head 7 -  Call SalColorSet( hWnd, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 5 +  Function: GetXRate	
.head 6 -  Description: Вставка документа в OPER
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nRatO
.head 7 -  Receive Number: nRatB
.head 7 -  Receive Number: nRatS
.head 7 -  Number: nKv1
.head 7 -  Number: nKv2
.head 7 -  Date/Time: dDat
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nFetchRes
.head 6 +  Actions
.head 7 +  While TRUE
.head 8 -  ! Set dDat=DATETIME_Null
.head 8 +  If SalStrTrimX(SalStrUpperX( GetDBMS() ))='ORACLE'
.head 9 +  If not sGetXRate
.head 10 -  Set sGetXRate='gl.x_rat'
.head 9 +  If not SqlPLSQLCommand( hSql(),sGetXRate||"(nRatO,nRatB,nRatS,nKv1,nKv2,dDat)") 
.head 10 -  Break
.head 8 +  Else
.head 9 +  If not SqlRetrieve( hSql(), "informix.x_rat",":nKv1,:nKv2,:dDat", ":nRatO,:nRatB,:nRatS" )
.head 10 -  Break
.head 9 +  If not SqlExecute ( hSql() )
.head 10 -  Break
.head 9 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 10 -  Break
.head 8 -  Return TRUE
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Return FALSE
.head 5 +  Function: iDop
.head 6 -  Description: Вставить доп реквизиты
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( aTag )
.head 8 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 8 +  While i>0
.head 9 +  If SalStrTrimX(aVal[i])
.head 10 -  Set sTmp1=aTag[i]
.head 10 -  Set sTmp2=aVal[i]
.head 10 +  If not SqlPrepareAndExecute( hSql(),T("INSERT INTO Operw (ref,tag,value ) VALUES  (:m_nRef, :sTmp1, :sTmp2 ) " )  )
.head 11 -  Return FALSE
.head 9 -  Set i=i-1
.head 7 +  If nFli=2 and VisArrayFindString (aTag, '50')<=0      ! SWIFT mess
.head 8 +  If SalStrTrimX(str50)=''
.head 9 -  Set str50 = dfNamA
.head 8 +  If not SqlPrepareAndExecute( hSql(),T("INSERT INTO Operw (ref,tag,value ) VALUES  (:m_nRef, '50', :str50 ) " )  )
.head 9 -  Return FALSE
.head 7 +  If bStoreKURS or bStoreNOM
.head 8 -  Set sTmp=Str(dfRatNom)
.head 8 +  If SalStrLeftX(sTmp,1)='.'
.head 9 -  Set sTmp='0'||sTmp
.head 8 +  If not SqlPrepareAndExecute( hSql(),T("INSERT INTO Operw (ref,tag,value ) VALUES  (:m_nRef, '"||IifS(bStoreKURS,'KURS','NOM')||"', :sTmp ) " )  )
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: iVspReq       ! Создать вспомогат реквизиты СЕП
.head 6 -  Description: Вставить доп реквизиты
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTmp=''
.head 7 +  If strMT   ! Default SWIFT MT
.head 8 -  Set sTmp='#f'||SalStrTrimX(strMT)
.head 7 +  If not SalArrayIsEmpty( aTag )
.head 8 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 8 +  While i>0
.head 9 +  If SalStrTrimX(aVsp[i]) and SalStrTrimX(aVal[i]) and SalStrTrimX(aVsp[i])!='F'
.head 10 -  Set sTmp=sTmp||'#'||SalStrLeftX(SalStrTrimX(aVsp[i]),1)||SalStrTrimX(aVal[i])
.head 9 -  Set i=i-1
.head 7 +  If sTmp
.head 8 -  Set sTmp=sTmp||'#'
.head 7 -  Return sTmp
.head 5 +  Function: cDopReq       ! Проверить доп реквизит
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: CHECKER
.head 7 -  String: sTag
.head 7 -  String: sVal
.head 7 -  String: sTT       !! Тип операции
.head 7 -  String: sNls1     !! Счет-А
.head 7 -  String: sBank1    !! МФО-А
.head 7 -  Number: nKv1      !! Код вал-А 
.head 7 -  Number: nS1       !! Сумма-А
.head 7 -  String: sNls2     !! Счет-Б     
.head 7 -  String: sBank2    !! МФО-Б
.head 7 -  Number: nKv2      !! Код вал-Б 
.head 7 -  Number: nS2       !! Сумма-Б
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRet
.head 7 -  String: sS
.head 7 -  String: S
.head 7 -  String: S2
.head 7 -  String: KvA
.head 7 -  String: KvB
.head 6 +  Actions
.head 7 +  If CHECKER
.head 8 -  Set sS = CHECKER
.head 8 -  Set S  = SalNumberToStrX(nS1, 0)   ! Сумма платежа
.head 8 -  Set S2 = SalNumberToStrX(nS2, 0)   ! Сумма платежа
.head 8 -  Set KvA = SalNumberToStrX(nKv1, 0) ! Код валюты А
.head 8 -  Set KvB = SalNumberToStrX(nKv2, 0) ! Код валюты B
.head 8 -  Set sS =  SalStrUpperX(' ' || sS)
.head 8 +  While SalStrScan(sS,'#(TAG)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(TAG)'),6,"'"||sTag||"'")
.head 8 +  While SalStrScan(sS,'#(VAL)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(VAL)'),6,"'"||sVal||"'")
.head 8 +  While SalStrScan(sS,'#(S)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S)'),4,S)
.head 8 +  While SalStrScan(sS,'#(S2)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S2)'),5,S2)
.head 8 +  While SalStrScan(sS,'#(NLSA)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSA)'),7,sNls1)
.head 8 +  While SalStrScan(sS,'#(NLSB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSB)'),7,sNls2)
.head 8 +  While SalStrScan(sS,'#(MFOA)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOA)'),7,sBank1)
.head 8 +  While SalStrScan(sS,'#(MFOB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOB)'),7,sBank2)
.head 8 +  While SalStrScan(sS,'#(KVA)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVA)'),6,KvA)
.head 8 +  While SalStrScan(sS,'#(KVB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVB)'),6,KvB)
.head 8 +  While SalStrScan(sS,'#(TT)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(TT)'),5,"'"||sTT||"'")
.head 8 +  If not SqlPrepareAndExecute(hSql(), "SELECT " || sS || " INTO :nRet FROM dual")
.head 9 -  Return FALSE
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Return FALSE
.head 8 -  Return nRet
.head 7 -  Return TRUE
.head 5 +  Function: SumPoNom      ! Вычислить сумму от номинала
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nS
.head 7 -  String: FORMULA
.head 7 -  Number: nNOM 
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sS
.head 7 -  String: KvA  ! при вычислении суммы операции
.head 7 -  String: KvB  !
.head 6 +  Actions
.head 7 +  If FORMULA
.head 8 -  Set KvA = SalNumberToStrX(nKvA, 0) ! Код валюты А
.head 8 -  Set KvB = SalNumberToStrX(nKvB, 0) ! Код валюты B
.head 8 -  Set sS = SalStrUpperX(' ' || FORMULA)
.head 8 +  While SalStrScan(sS,'#(NOM)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NOM)'),6,Str( nNOM ))
.head 8 +  While SalStrScan(sS,'#(NLSA)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSA)'),7,dfNlsA)
.head 8 +  While SalStrScan(sS,'#(NLSB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSB)'),7,dfNlsB)
.head 8 +  ! While SalStrScan(sS,'#(MFOA)') > 0
.head 9 -                              Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOA)'),7,dfBankA)
.head 8 +  While SalStrScan(sS,'#(MFOB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOB)'),7,dfBankB)
.head 8 +  While SalStrScan(sS,'#(KVA)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVA)'),6,KvA)
.head 8 +  While SalStrScan(sS,'#(KVB)') > 0
.head 9 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVB)'),6,KvB)
.head 8 +  If not SqlPrepareAndExecute(hSql(), "SELECT " || sS || " INTO :nS FROM dual")
.head 9 -  Return FALSE
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: SetItsColo
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bFlg
.head 7 -  Number: nColoT
.head 7 -  Number: nColoF
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bFlg
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nColoT )
.head 7 +  Else
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nColoF )
.head 5 +  Function: IsHolyDay
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKv
.head 7 -  Date/Time: dDat
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nn
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSql(),"
SELECT kv INTO :nn FROM holiday
 WHERE kv=:nKv and holiday="||DateInQuery(SalFmtFormatDateTime(dDat, 'MM/dd/yyyy')))
.head 7 -  Return SqlFetchNext( hSql(), nFetchRes)
.head 5 +  Function: DecPoint      ! Корректировка символа "десятичной точки"
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 6 +  Actions
.head 7 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 7 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 7 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 8 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 7 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 7 -  Return TRUE
.head 5 +  Function: OKPOamnd      ! Уточнение ОКПО по признаку клиентские или внутрибанковские счета
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sNls
.head 7 -  Receive String: sOKPO
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNbs
.head 7 -  String: sKl
.head 6 +  Actions
.head 7 -  Set sNbs=SalStrLeftX(sNls,4)
.head 7 +  If SqlPrepareAndExecute(hSql(),T("SELECT kl INTO :sKl FROM ps WHERE nbs = :sNbs " ))
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If sKl=sKlF
.head 10 -  Set sOKPO= GetBankOkpoS()	
.head 7 -  Return TRUE
.head 5 +  Function: SetTagKurs    ! Если это уместно, то устанавливаем TAG KURS
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nKurs
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set i = VisArrayFindString (aTag, sTag)
.head 7 +  If i > 0
.head 8 -  Set aVal[i]=Str(nKurs)
.head 8 +  If SalStrLeftX(aVal[i],1)='.'
.head 9 -  Set aVal[i]='0'||aVal[i]
.head 8 +  If SalListQuerySelection( lb1 )=i
.head 9 -  Set dfNazn=aVal[i]
.head 5 +  Function: NlsSubst      ! Робить підстановку номера рахунку через формулу
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: Nls
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 6 +  Actions
.head 7 +  If SalStrLeftX(Nls,2)='#('
.head 8 -  Call SqlPrepareAndExecute( hSql(), "SELECT SUBSTR("||SalStrMidX(Nls,2,SalStrLength(Nls)-3)||",1,14) INTO :sTmp FROM dual" )
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return sTmp
.head 7 -  Return Nls
.head 5 +  Function: XPlace
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd1
.head 7 -  Window Handle: hWnd2
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX1
.head 7 -  Number: nY1
.head 7 -  Number: nX2
.head 7 -  Number: nY2
.head 6 +  Actions
.head 7 -  Call SalGetWindowLoc ( hWnd1, nX1, nY1 )
.head 7 -  Call SalGetWindowLoc ( hWnd2, nX2, nY2 )
.head 7 +  If not(nY1>nY2 and (nDk=0 or nDk=2) or nY1<nY2 and (nDk=1 or nDk=3))
.head 8 -  Call SalSetWindowLoc ( hWnd1, nX2, nY2 )
.head 8 -  Call SalSetWindowLoc ( hWnd2, nX1, nY1 )
.head 5 +  Function: XPlaceSk
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd1
.head 7 -  Window Handle: hWnd2
.head 7 -  Window Handle: hWnd3
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX1
.head 7 -  Number: nY1
.head 7 -  Number: nX2
.head 7 -  Number: nY2
.head 6 +  Actions
.head 7 -  Call SalGetWindowLoc ( hWnd3, nX1, nY2 )
.head 7 -  Call SalGetWindowLoc ( hWnd1, nX1, nY1 )
.head 7 -  Call SalGetWindowLoc ( hWnd2, nX2, nY1 )
.head 7 -  Call SalSetWindowLoc ( hWnd1, nX1, nY2 )
.head 7 -  Call SalSetWindowLoc ( hWnd2, nX2, nY2 )
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call PrepareWindowEx(hWndForm)
.head 6 -  Call SetWindowFont(hWndForm)
.head 6 +  If not IsBankDayOpen()
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesDayClosed'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Warning'), MB_IconAsterisk | MB_Ok )
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 7 -  Return TRUE
.head 6 -  Set dDat    = GetBankDate()
.head 6 -  Set nId     = GetUserId()
.head 6 -  Set nBaseVal= GetBaseVal()
.head 6 -  Set sKlF    = GetGlobalOption('INTA_KOD')  ! Есть признак внутр/клиентских счетов в PS
.head 6 -  Set sVOB_ORD= GetGlobalOption('VOB_ORD')   ! Есть признак сортировки VOB в операции
.head 6 -  Set sDeb_Up = GetGlobalOption('DEB_UP')    ! Есть признак помещения дебета вверх
.head 6 -  Set sGetXRate = GetGlobalOption('XRATFUN')  ! Имя функции получения кросс курса 
.head 6 -  Set hBtnOk = VisMessageLoadButton('&Ok', nTmp)
.head 6 -  Call XSalTooltipSetUserDefault(  )
.head 6 -  Set bDocStart=FALSE
.head 6 -  Set sDecimal=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 6 +  If sDecimal='.'
.head 7 -  Set sDecimal2=','
.head 6 +  Else
.head 7 -  Set sDecimal2='.'
.head 6 -  Call SalGetWindowSize( lb1, nWMin, nHMax )
.head 6 -  Call SalGetWindowSize( dfNazn, nWMax, nHMin )
.head 6 -  Call SalSendMsg( hWndForm,UM_Choose,0,0)
.head 5 +  On SAM_Destroy
.head 6 +  If nFbk
.head 7 -  Set dDat=GetBankDate()
.head 7 -  Call Pl_dat(dDat)
.head 5 +  On UM_Insert
.head 6 -  ! ____________ Выполним вставку в базу данных с оплатой 
.head 6 -  Set bTotVal = TRUE
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( lb1, SAM_Click, 0, 0 )
.head 6 -  Set sDrec=iVspReq()
.head 6 -  Call SetDocQ( 0, sTT, nDk, nVob, dfNd, dfDocD, dDat, dfValD1, dfValD2,
     dfNlsA, dfNamA, dfBankA, dfNbA, nKvA, dfSumA*SalNumberPower( 10, nDigA), dfOkpoA,
     dfNlsB, dfNamB, dfBankB, dfNbB, nKvB, dfSumB*SalNumberPower( 10, nDigB), dfOkpoB, dfNazn, sDrec,GetIdOper(),'',dfSk, cbUgrnt ,dfEquiv*100)
.head 6 +  If nFcb
.head 7 -  Set m_nNom=dfRatNom*SalNumberPower( 10, nDigA)
.head 6 -  Set hNextDF = SalGetFirstChild( hWndForm, TYPE_DataField | TYPE_MultilineText )
.head 6 +  Loop
.head 7 +  If hNextDF = hWndNULL
.head 8 -  ! ------------------ Оплатить документ ---------------
.head 8 +  If nFlv
.head 9 -  Set strSumPr=SumPr( dfSumA*SalNumberPower( 10, nDigA), 'F', dfKvA,sDigNa ) || ' за ' ||SalNumberToChar( 13 )||SalNumberToChar( 10 )||
             SumPr( dfSumB*SalNumberPower( 10, nDigB), 'F', dfKvB,sDigNb ) 
.head 8 +  Else
.head 9 -  Set strSumPr=SumPr( dfSumA*SalNumberPower( 10, nDigA), 'F', dfKvA,sDigNa )
.head 8 +  If not SalModalDialog( dlgAsk2Pay, hWndForm, strSumPr)
.head 9 -  Break
.head 8 +  If ..oDoc(  )  !! and  iDopReq()
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveFInfoToLog('Ввод док Ref'||SalNumberToStrX( m_nRef, 0)||': '||dfNlsA||'('||dfKvA||') '||SalNumberToStrX(A.S,0)||' -> '||dfBankB||
     ' '||dfNlsB||'('||dfKvB||') '||SalNumberToStrX(B.S,0)||'['||dfNamB||'],['||dfNazn||'] '||GetIdOper())
.head 9 -  Call SalSendMsg( dfOst, SAM_Validate, 0, 0 )
.head 9 -  Call VisMessageSetBkgdColor(IifN(nColor=COLOR_Red,COLOR_Red,SalColorGet ( hWndForm, COLOR_IndexWindow)))
.head 9 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 9 -  Call VisMessageBox(CurrentLangTable.GetAtomTitle('DocWMesOK')||' '||SalNumberToStrX( m_nRef, 0),
                   CurrentLangTable.GetAtomTitle('DlgMSG_Pay'), MBF_IconExclamation, hBtns, 1)
.head 9 -  Set hNextDF = SalGetFirstChild( hWndForm, TYPE_DataField | TYPE_MultilineText | TYPE_ListBox)
.head 9 +  While hNextDF != hWndNULL               ! Временно задизаблим поля ввода
.head 10 -  Call SalDisableWindow( hNextDF )
.head 10 -  Set hNextDF = SalGetNextChild( hNextDF, TYPE_DataField | TYPE_MultilineText | TYPE_ListBox | TYPE_ComboBox)
.head 9 -  Call SalDisableWindow(pbPayDoc)
.head 9 -  Call SalEnableWindow( pbNewDoc )
.head 9 -  Call SalEnableWindow( pbSaveKor )
.head 9 -  Call SalEnableWindow( pbDocBal )
.head 9 -  Call SalEnableWindow( pbPrtDoc )
.head 9 +  If nFpr
.head 10 -  Call SalSendMsg(hWndForm,UM_Print,0,0)
.head 9 -  Call SalSetFocus( pbNewDoc )
.head 8 +  Else
.head 9 -  Call SqlRollback( hSql() )
.head 8 -  Break
.head 7 +  If SalIsWindowEnabled( hNextDF )      ! Выполним проверку реквизитов
.head 8 +  If SalSendMsg( hNextDF, SAM_Validate, 0, 0 ) = VALIDATE_Cancel 
.head 9 -  Call SalSetFocus( hNextDF )
.head 9 -  Break
.head 7 -  Set hNextDF = SalGetNextChild( hNextDF, TYPE_DataField | TYPE_MultilineText )
.head 6 -  Set bTotVal = FALSE
.head 5 +  On UM_Close
.head 6 -  Call VisMessageFreeButton (hBtnOk)
.head 6 -  Call SalSetFieldEdit ( dfNlsA, FALSE )
.head 6 -  Call SalSetFieldEdit ( dfNlsB, FALSE )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 +  On UM_Print
.head 6 -  Call pDoc()
.head 5 +  On UM_HotAccountList
.head 6 +  If bAccA or bAccB
.head 7 +  If bAccA
.head 8 -  Set nKv=nKvA
.head 8 -  Set sNls=dfNlsA
.head 8 -  Set sNms=dfNamA
.head 8 -  Set sOkpo=dfOkpoA
.head 7 +  Else
.head 8 -  Set nKv=nKvB
.head 8 -  Set sNls=dfNlsB
.head 8 -  Set sNms=dfNamB
.head 8 -  Set sOkpo=dfOkpoB
.head 7 +  If (dfBankA != dfBankB and bAccB)   ! В случае межбанка 
.head 8 -  Set sMfo=dfBankB
.head 8 +  If SalModalDialog( dlgAlien,hWndForm,bAccB,nKv,sLcv,sNls,sOkpo,sNms,sMfo,sNb)
.head 9 -  Set dfNlsB=sNls
.head 9 -  Set dfNamB=sNms
.head 9 -  Set dfBankB=sMfo
.head 9 -  Set dfNbB=sNb
.head 9 -  Set nKvB=nKv
.head 9 -  Set dfKvB=sLcv
.head 9 -  Set dfOkpoB=sOkpo
.head 9 -  Call SalSendMsg( dfKvB, SAM_Validate, 0, 0 )
.head 7 +  Else
.head 8 +  If SalModalDialog( dlgClient,hWndForm,nFli,sTT,(bAccA>0)!=nDk,bAccA+bAccB,sNls,sNms,sNmk,nKv,sLcv,sOkpo,str50 )
.head 9 +  If bAccA      ! Поищем счет А
.head 10 -  Set sNamAStored1=sNms
.head 10 -  Set sNamAStored2=sNmk
.head 10 -  Set dfNlsA=sNls
.head 10 -  Set dfNamA=sNms
.head 10 -  Set nKvA=nKv
.head 10 -  Set dfKvA=sLcv
.head 10 -  Set dfOkpoA=sOkpo
.head 10 +  If nFli = 2
.head 11 -  Set i = VisArrayFindString (aTag, '50')
.head 11 +  If i > 0
.head 12 +  If str50
.head 13 -  Set aVal[i]=str50
.head 12 +  Else
.head 13 -  Set aVal[i]=sNamAStored2
.head 10 -  Call SalSendMsg( dfKvA, SAM_Validate, 0, 0 )
.head 9 +  Else ! Поищем счет B
.head 10 -  Set sNamBStored1=sNms
.head 10 -  Set sNamBStored2=sNmk
.head 10 -  Set dfNlsB=sNls
.head 10 -  Set dfNamB=sNms
.head 10 -  Set nKvB=nKv
.head 10 -  Set dfKvB=sLcv
.head 10 -  Set dfOkpoB=sOkpo
.head 10 -  Call SalSendMsg( dfKvB, SAM_Validate, 0, 0 )
.head 7 +  If bAccA = 1
.head 8 -  Call SalSetFocus( dfNlsA )
.head 7 +  Else If bAccA=2
.head 8 -  Call SalSetFocus( dfNamA )
.head 7 +  Else If bAccA=3
.head 8 -  Call SalSetFocus( dfOkpoB )
.head 7 +  Else If bAccB=1
.head 8 -  Call SalSetFocus( dfNlsB )
.head 7 +  Else If bAccB=2
.head 8 -  Call SalSetFocus( dfNamB )
.head 7 +  Else If bAccB=3
.head 8 -  Call SalSetFocus( dfOkpoB )
.head 6 +  If bNazn
.head 7 -  Set i=SalListQuerySelection( lb1 )
.head 7 +  If nFdp and i  
.head 8 +  If aBro[i]
.head 9 -  Set nType = SalCompileAndEvaluate( aBro[i],
    nError, nPos, nTmp, sTmp, dTmp, hNextDF, TRUE, SalContextCurrent())
.head 9 +  If nError = 0
.head 10 +  If nType = EVAL_Number
.head 11 -  Set sTmp = SalNumberToStrX(nTmp, 0)
.head 10 +  Else If nType = EVAL_String
.head 11 -  ! Set dfValue = sBrowserRet
.head 10 +  Else If nType = EVAL_Date
.head 11 -  Call SalDateToStr ( dTmp, sTmp )
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Невозможно вызвать '||aBro[i], 'Информация', MB_IconInformation )
.head 10 -  Return FALSE
.head 7 -  Else If SalModalDialog( dlgDescr, hWndForm, sTmp )
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 +  If sTmp
.head 8 +  If nFdp and i and SalStrLeftX(aTag[i],1)='5'
.head 9 -  Set dfNazn=IifS(SalStrTrimX(dfNazn)='','',SalStrTrimX(dfNazn)||PutCrLf())||sTmp
.head 8 +  Else
.head 9 -  Set dfNazn=sTmp
.head 8 -  Call SalSetFieldEdit (dfNazn, TRUE )
.head 7 -  Call SalSetFocus( dfNazn )
.head 6 +  If bMfoB
.head 7 +  If not SalModalDialog( dlgMFO, hWndForm, sMfo,sNb )
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set dfBankB=sMfo
.head 8 -  Set dfNbB=sNb
.head 8 -  Call SalSetFieldEdit ( dfBankB, TRUE )
.head 8 -  Call SalSetFocus(  dfBankB )
.head 6 +  If bSk
.head 7 +  If not SalModalDialog( dlgTagBrowse, hWndForm, 
'SELECT sk,name FROM sk WHERE sk'||IifS(nDk=0 or nDk=2,'<','>=')||"40 AND (d_close IS NULL OR d_close>TO_DATE('"||SalFmtFormatDateTime( dDat, 'yyyyMMdd' )||"','YYYYMMDD')) ORDER BY sk",sTmp )
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set dfSk=SalStrToNumber( sTmp )
.head 8 -  Call SalSetFieldEdit ( dfSk, TRUE )
.head 8 -  Call SalSetFocus(  dfSk )
.head 5 +  On UM_HotFio
.head 6 +  If nFdp
.head 7 +  If dfNlsA
.head 8 -  Call SqlPrepareAndExecute(hSql(),"SELECT count(*) INTO :nCount FROM podotw WHERE tag='NLS' AND val=:dfNlsA")
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Return FALSE
.head 8 +  If nCount=1
.head 9 -  Call SqlPrepareAndExecute(hSql(),"SELECT id INTO :nPodotId FROM podotw WHERE tag='NLS' AND val=:dfNlsA")
.head 9 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 +  If not SalModalDialog( dlgInkast, hWndForm, IifS(nCount,dfNlsA,''),nIdPodot)
.head 10 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute(hSql(),'SELECT tag,val INTO :sTmp1,:sTmp2 FROM podotw WHERE id=:nIdPodot')
.head 8 +  While SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Set nCount = VisArrayFindString( aTag, sTmp1 )
.head 9 +  If nCount > 0
.head 10 -  Set aVal[nCount]=sTmp2
.head 10 +  If SalListQuerySelection( lb1 )=nCount
.head 11 -  Set dfNazn=aVal[nCount]
.head 5 +  On UM_Clear
.head 6 -  Call SalDisableWindow ( pbNewDoc )
.head 6 -  Call SalEnableWindow (pbPayDoc )
.head 6 -  Call SalSendMsg( pbLocalD, SAM_Create, 0, 0 )  ! --- кнопка локал дат
.head 6 -  ! ------------------------------------ Установка стартовых значений реквизитов
.head 6 -  Set nKvA=nKvA_TT
.head 6 -  Set nKvB=nKvB_TT
.head 6 -  Set sNlsA=sNlsA_TT
.head 6 -  Set sNlsB=sNlsB_TT
.head 6 -  Set sBankB=sBankB_TT
.head 6 -  Set nSk=nSk_TT
.head 6 -  ! -------------------------------------------------------------------------------------------------------------
.head 6 +  If bFixAll
.head 7 -  Set sFixNlsA=dfNlsA
.head 7 -  Set sFixNlsB=dfNlsB
.head 7 -  Set sFixMfoB=dfBankB
.head 7 -  Set dFixDocD=dfDocD
.head 7 -  Set dFixValD1=dfValD1
.head 7 -  Set sFixKvA=dfKvA
.head 7 -  Set sFixKvB=dfKvB
.head 7 -  Set nFixVob=nVob
.head 6 -  ! --------------------------------------------------------
.head 6 -  Set sNamAStored1=''
.head 6 -  Set sNamAStored2=''
.head 6 -  Set sNamBStored1=''
.head 6 -  Set sNamBStored2=''
.head 6 -  Set cbUgrnt=FALSE
.head 6 -  Set dfZn = ''
.head 6 -  Set dfOst = 0
.head 6 -  Set hNextDF = SalGetFirstChild( hWndForm, TYPE_DataField | TYPE_MultilineText )
.head 6 +  While hNextDF != hWndNULL 
.head 7 -  Call SalClearField( hNextDF )
.head 7 -  Set hNextDF = SalGetNextChild( hNextDF, TYPE_DataField | TYPE_MultilineText )
.head 6 -  Set hNextDF = SalGetFirstChild( hWndForm, TYPE_DataField | TYPE_MultilineText | TYPE_ComboBox | TYPE_ListBox | TYPE_CheckBox)
.head 6 +  While hNextDF != hWndNULL 
.head 7 -  Call SalSendMsg( hNextDF, SAM_Create, 0, 0 )
.head 7 -  Set hNextDF = SalGetNextChild( hNextDF, TYPE_DataField | TYPE_MultilineText | TYPE_ComboBox | TYPE_ListBox | TYPE_CheckBox)
.head 6 -  Call SalSendMsg( hWndForm, SAM_CreateComplete, 0, 0 )
.head 6 -  Call SalDisableWindow (pbDocBal )
.head 6 -  Call SalDisableWindow (pbPrtDoc)
.head 6 -  Call SalDisableWindow (pbSaveKor)
.head 6 -  !
.head 6 -  Set str50=STRING_Null
.head 6 +  If nFdp
.head 7 -  Call SalShowWindow (lb1)
.head 7 -  Call SalGetWindowLoc(lb1, nWMin, nHMin)
.head 7 -  Call SalSetWindowLoc( dfNazn, nWMin+nWMax*2/5, nHMin)
.head 7 -  Call SalSetWindowSize( lb1,      nWMax*2/5, nHMax )
.head 7 -  Call SalSetWindowSize( dfNazn, nWMax*3/5, nHMax )
.head 6 +  Else
.head 7 -  Call SalHideWindow (lb1)
.head 7 -  Call SalGetWindowLoc( lb1, nWMin, nHMin)
.head 7 -  Call SalSetWindowLoc( dfNazn, nWMin, nHMin)
.head 7 -  Call SalSetWindowSize( dfNazn, nWMax, nHMax)
.head 6 -  ! Если надо,- дебет вверх
.head 6 +  If sDeb_Up
.head 7 -  Call XPlace(dfD,dfK)
.head 7 -  Call XPlace(dfBankA,dfBankB)
.head 7 -  Call XPlace(dfKvA,dfKvB)
.head 7 -  Call XPlace(dfNlsA,dfNlsB)
.head 7 -  Call XPlace(dfPlat,dfPolu)
.head 7 -  Call XPlace(dfPlatB,dfPoluB)
.head 7 -  Call XPlace(dfNamA,dfNamB)
.head 7 -  Call XPlace(dfOkpoA,dfOkpoB)
.head 7 -  Call XPlace(dfNbA,dfNbB)
.head 7 -  Call XPlace(dfSumA,dfSumB)
.head 7 -  Call XPlace(dfSumNA,dfSumNB)
.head 7 -  Call XPlaceSk(dfSkN,dfSk,dfBankB)
.head 7 -  Call SalInvalidateWindow ( hWndForm )
.head 6 -  !
.head 6 +  ! If nFvD1 
.head 7 -  Call SalSetFocus( dfValD1 )
.head 6 +  ! Else
.head 7 +  If SalIsWindowEnabled( cmbVob )
.head 8 -  Call SalSetFocus( cmbVob )
.head 7 +  Else 
.head 8 -  Call SalSetFocus( dfNd )
.head 6 -  !
.head 6 +  If nFpy = 1
.head 7 -  Set bFaktPlan=TRUE
.head 6 +  Else
.head 7 -  Set bFaktPlan=FALSE
.head 5 +  On UM_Choose
.head 6 -  Set dDat=GetBankDate()
.head 6 -  Call Pl_dat(dDat)
.head 6 +  If not bDocStart
.head 7 -  Set bDocStart=TRUE
.head 7 -  Set bFixAll=FALSE
.head 7 -  Set bFixNlsA=FALSE
.head 7 -  Set bFixKvA=FALSE
.head 7 -  Set bFixKvB=FALSE
.head 7 -  Set bFixNlsB=FALSE
.head 7 -  Set bFixMfoB=FALSE
.head 7 -  Set bFixDocD=FALSE
.head 7 -  Set bFixValD1=FALSE
.head 7 -  Set sFixKvA=STRING_Null
.head 7 -  Set sFixNlsA=STRING_Null
.head 7 -  Set sFixKvB=STRING_Null
.head 7 -  Set sFixNlsB=STRING_Null
.head 7 -  Set sFixMfoB=STRING_Null
.head 7 -  Set dFixDocD=DATETIME_Null
.head 7 -  Set dFixValD1=DATETIME_Null
.head 7 -  Set nFixVob=NUMBER_Null
.head 7 +  If not SalModalDialog( dlgDocStart,hWndForm,sTT,sTTN,nFpy,nFvD1,nFvD2,nFtr,nFbk,nFli,nFlv,nDk,nKvA_TT,nKvB_TT,sNlsA_TT,sNlsB_TT,sBankB_TT,nSk_TT,nFcb,nFpr,nFdp,nFug,nFeq,nFdd,nFsk,nFhr,sS,sSS )
.head 8 -  Call SalDestroyWindow( hWndForm )
.head 8 -  Return TRUE
.head 7 -  Set sNlsA_TT=NlsSubst(sNlsA_TT)
.head 7 -  Set sNlsB_TT=NlsSubst(sNlsB_TT)
.head 6 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('DocWTit')||' - [ ' ||sTTN|| ' ]' )
.head 6 -  Call SalSendMsg( hWndForm, UM_Clear, 0, 0 )
.head 5 +  On UM_Update
.head 6 +  If nFli = 1 ! Если межбанк
.head 7 -  Call SqlPrepareAndExecute(hSql(),
    "SELECT ROWID INTO :sTmp FROM alien WHERE mfo=:dfBankB AND nls=:dfNlsB AND kv=:nKvB ")
.head 7 +  If SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(),"UPDATE alien SET name=:dfNamB,okpo=:dfOkpoB WHERE ROWID=:sTmp")
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute(hSql(),
"INSERT INTO alien ( mfo,kv,nls,name,okpo) VALUES (:dfBankB,:nKvB,:dfNlsB,:dfNamB,:dfOkpoB)")
.head 6 -  Call SqlPrepareAndExecute(hSql(),"SELECT np FROM np WHERE id=:nId AND np=:dfNazn")
.head 6 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Call SqlPrepareAndExecute(hSql(),"INSERT INTO np (id,np) VALUES(:nId,:dfNazn)")
.head 6 +  If nFdp
.head 7 -  Set i=VisArrayFindString (aTag, '59')
.head 7 +  If i>0
.head 8 -  Call SqlPrepareAndExecute(hSql(),"INSERT INTO f59_field (nmk) VALUES(:aVal[i])")
.head 6 -  Call SalDisableWindow (pbSaveKor)
.head 6 -  Call SqlCommit(hSql())
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalCreateWindow(tblDocBal, hWndForm, pbDocBal, m_nRef)
.head 5 +  On SAM_CreateComplete
.head 6 -  Set aVal[0]=dfNazn   ! присвоение стартового значения Назн
.head 6 +  If nFvD1 
.head 7 -  Call SalSetFocus( dfValD1 )
.head 6 +  Else
.head 7 +  If SalIsWindowEnabled( cmbVob )
.head 8 -  Call SalSetFocus( cmbVob )
.head 7 +  Else
.head 8 -  Call SalSetFocus( dfNd )
.head 6 +  If hWnd4Focus
.head 7 -  Call SalSetFocus( hWnd4Focus )
.head 7 -  Call SalSetFieldEdit ( hWnd4Focus, TRUE )
.head 7 -  Set hWnd4Focus = hWndNULL
.head 5 +  On WM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 6 +  If dDat and nFbk
.head 7 -  Call Pl_dat(dDat)
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=0x2d      ! VK_Insert
.head 7 -  Call SalSendMsg( pbNewDoc, SAM_Click, 0, 0 )
.head 6 +  ! If wParam=VK_Delete
.head 7 -                              Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cpbLabeledOk
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgDocStart    ! Выбор операции
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Банковская операция
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.638"
.head 4 -  Top:    0.427"
.head 4 -  Width:  7.183"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.488"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: System Window Color
.head 2 -  Description: (OK) Выбор банковской транзакции перед вводом документа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.031"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblTrans
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.106"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 200
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.68"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFli
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: # Макета
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFlv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Мульти
валюта
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFlags
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаги операции
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.586"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfoB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Символ 
касплана
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTTN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формула
Суми
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формула
Суми
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nId
.head 5 -  String: strSecure
.head 5 -  Boolean: bSortOrd
.head 5 -  Number: nColHan
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SingleSelection, TRUE )
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set nId=GetUserId()
.head 6 -  Set strSecure = ''
.head 6 +  If EnhancedSecurity(  )
.head 7 -  Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
.head 6 -  Call SalTblPopulate( hWndItem, hSql(), T( 
"SELECT DISTINCT t.tt,t.name,t.fli,t.flv,t.dk,t.kv,t.kvk,t.nlsa,t.nlsb,t.mfob,t.sk,t.flags,TRIM(t.s),TRIM(t.s2)
   INTO :colTT,:colTTN,:colFli,:colFlv,:colDk,
        :colKvA,:colKvB,:colNlsA,:colNlsB,:colMfoB,:colSk,:colFlags,:colS,:colSS
   FROM tts t, staff_tts s 
  WHERE s.tt=t.tt AND s.id IN ("|| GetSubstListId( nId, TRUE ) ||") AND 
        t.fli<3 AND flags[1,1]=1 " || strSecure ||
" ORDER BY 2") , TBL_FillAll )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sTT=colTT
.head 6 -  Set sTTN=colTTN
.head 6 -  Set nFpy=SalStrToNumber(SalStrMidX(colFlags,37,1))
.head 6 -  Set nFvD1=SalStrToNumber(SalStrMidX(colFlags,3,1))
.head 6 -  Set nFvD2=SalStrToNumber(SalStrMidX(colFlags,49,1))
.head 6 -  Set nFcb=SalStrToNumber(SalStrMidX(colFlags,58,1))
.head 6 -  Set nFtr=SalStrToNumber(SalStrMidX(colFlags,59,1))
.head 6 -  Set nFbk=SalStrToNumber(SalStrMidX(colFlags,60,1))
.head 6 -  Set nFpr=SalStrToNumber(SalStrMidX(colFlags,46,1))
.head 6 -  Set nFdp=SalStrToNumber(SalStrMidX(colFlags,35,1))
.head 6 -  Set nFug=SalStrToNumber(SalStrMidX(colFlags,12,1))
.head 6 -  Set nFeq=SalStrToNumber(SalStrMidX(colFlags,14,1))
.head 6 -  Set nFdd=SalStrToNumber(SalStrMidX(colFlags,4,1))
.head 6 -  Set nFsk=SalStrToNumber(SalStrMidX(colFlags,9,1))
.head 6 -  Set nFhr=SalStrToNumber(SalStrMidX(colFlags,11,1))
.head 6 -  Set nFli=colFli
.head 6 -  Set nFlv=colFlv
.head 6 -  Set nKvA=colKvA
.head 6 -  Set nKvB=colKvB
.head 6 -  Set sNlsA=SalStrTrimX(colNlsA)
.head 6 -  Set sNlsB=SalStrTrimX(colNlsB)
.head 6 -  Set sMfoB=colMfoB
.head 6 -  Set nSk=colSk
.head 6 -  Set sS=colS
.head 6 -  Set sSS=colSS
.head 6 +  If nFsk = 0
.head 7 -  Set nSk=NUMBER_Null
.head 6 +  Else
.head 7 +  If colSk=NUMBER_Null
.head 8 -  Set nSk=0
.head 6 -  Set nDk=colDk
.head 6 +  If SalIsNull(colDk)
.head 7 -  Set nDk=1
.head 6 -  Call SalEndDialog(  dlgDocStart, TRUE )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalStrMidX(colFlags,37,1)='0'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen) ! серый
.head 6 +  ! Else
.head 7 -                              Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_IndexWindow) 
.head 5 +  On SAM_CaptionDoubleClick
.head 6 +  If wParam=nColHan
.head 7 -  Set bSortOrd = not bSortOrd
.head 6 +  Else
.head 7 -  Set bSortOrd=1
.head 7 -  Set nColHan=wParam
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.533"
.head 5 -  Top:    4.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.329"
.head 5 -  Top:    4.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblTrans, SAM_DoubleClick, 0, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 17428
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    4.5"
.head 5 -  Width:  6.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.571"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  ! Function: NlsSubst
.head 4 -             Description: 
.head 4 +             Returns 
.head 5 -             String: 
.head 4 +             Parameters 
.head 5 -             String: Nls
.head 4 -             Static Variables 
.head 4 +             Local variables 
.head 5 -             String: sTmp
.head 4 +             Actions 
.head 5 +             If SalStrLeftX(Nls,2)='#('
.head 6 -             Call SqlPrepareAndExecute( hSql(), "SELECT SUBSTR("||SalStrMidX(Nls,2,SalStrLength(Nls)-3)||",1,14) INTO :sTmp FROM dual" )
.head 6 +             If SqlFetchNext( hSql(), nFetchRes )
.head 7 -             Return sTmp
.head 5 -             Return Nls
.head 2 +  Window Parameters
.head 3 -  Receive String: sTT
.head 3 -  Receive String: sTTN
.head 3 -  Receive Number: nFpy
.head 3 -  Receive Number: nFvD1
.head 3 -  Receive Number: nFvD2
.head 3 -  Receive Number: nFtr
.head 3 -  Receive Number: nFbk
.head 3 -  Receive Number: nFli
.head 3 -  Receive Number: nFlv
.head 3 -  Receive Number: nDk
.head 3 -  Receive Number: nKvA
.head 3 -  Receive Number: nKvB
.head 3 -  Receive String: sNlsA
.head 3 -  Receive String: sNlsB
.head 3 -  Receive String: sMfoB
.head 3 -  Receive Number: nSk
.head 3 -  Receive Number: nFcb
.head 3 -  Receive Number: nFpr
.head 3 -  Receive Number: nFdp
.head 3 -  Receive Number: nFug
.head 3 -  Receive Number: nFeq        ! признак ввода эквивалента
.head 3 -  Receive Number: nFdd        ! признак даты документа по-умолчанию
.head 3 -  Receive Number: nFsk        ! признак кассовой операции
.head 3 -  Receive Number: nFhr        ! признак закрытия поля "курс"
.head 3 -  Receive String: sS          ! формула суммы
.head 3 -  Receive String: sSS         ! формула суммы 2
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgDocStart.cTWndTitle'))
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg( tblTrans, UM_Populate, 0, 0 )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 1 +  Dialog Box: dlgClient      ! Выбор нашего клиента
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник лицевых счетов
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  7.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.964"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: System Window Color
.head 2 -  Description: Справочник клиентов/участников
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? No
.head 4 -  Size: 0.536"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск:
.head 4 -  Resource Id: 28100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.131"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.857"
.head 6 -  Top:    0.107"
.head 6 -  Width:  5.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 -  Set strCond = ' and s.nls LIKE \'' ||
    StrMatches2Like(dfSearchStr) || '\''
.head 6 -  Call SalSendMsg(tbl, SAM_Create, 0, 0)
.head 6 -  Return VALIDATE_OkClearFlag
.head 5 +  On SAM_Validate
.head 6 -  Set nRow=-1
.head 6 -  Call SalSendMsg( pbSearch, SAM_Click, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 5 +  On UM_ParentSize
.head 6 -  Call SalGetWindowSize ( hWndItem , nX, nY )
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.9, nY )
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.114"
.head 6 -  Top:    0.476"
.head 6 -  Width:  6.714"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If GetAccountStructure(nTmp, nTmp, nTmp, nTmp)
 ! Прижимать влево или вправо
.head 9 -  Call SalTblSetColumnFlags(colNls, COL_RightJustify,
     TRUE)
.head 5 +  Column: colLcv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код вал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.429"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNmk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.429"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOkpo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код ОКПО
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  14.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNmkV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NMKV
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  14.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 5 -  Number: nFetchRes
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  ! Выборка счета для ввода из справочника
.head 6 -  Set sNls = SalStrTrimX(colNls)
.head 6 +  If obTudaSuda
.head 7 -  Set sNms = SalStrTrimX(colNmk)
.head 7 -  Set sNmk = SalStrTrimX(colNms)
.head 6 +  Else
.head 7 -  Set sNms = SalStrTrimX(colNms)
.head 7 -  Set sNmk = SalStrTrimX(colNmk)
.head 6 -  Set nKv = colKv
.head 6 -  Set sLcv = SalStrTrimX(colLcv)
.head 6 -  Set sOkpoA = SalStrTrimX(colOkpo)
.head 6 -  Set str50 = SalStrTrimX(colNmkV)
.head 6 -  Call SalEndDialog(dlgClient, TRUE)
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndItem, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine | TBL_Flag_SingleSelection, TRUE )
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("SELECT nbs FROM ps_tts WHERE tt=:sTT and dk=:nDk"))
.head 6 +  If SqlFetchNext(hSql(), nFetchRes) ! Есть ограничения на б/с
.head 7 -  Set sPs = ' and EXISTS (
    SELECT p.nbs
    FROM ps_tts p
    WHERE p.tt=:sTT and p.dk=:nDk and
          ( TRIM(p.nbs) = s.nbs[1,1] or
            TRIM(p.nbs) = s.nbs[1,2] or
            TRIM(p.nbs) = s.nbs[1,3] or p.nbs=s.nbs))'
.head 6 +  Else
.head 7 -  Set sPs = ''
.head 6 +  If nDk=0
.head 7 -  Set sSql = 'd'
.head 6 +  Else If nDk=1 
.head 7 -  Set sSql = 'k'
.head 6 +  Else
.head 7 -  Set sSql = ''
.head 6 -  Set sSql = 
   "SELECT s.nls,s.nms,NVL(TRIM(k.nmkk),TRIM(k.nmk)),s.kv,t.lcv,k.okpo,k.nmkv
    INTO :colNls,:colNms,:colNmk,:colKv,:colLcv,:colOkpo,:colNmkV   
    FROM saldo" || sSql || " s, tabval t, cust_acc a, customer k  
    WHERE s.tip<>'VP' and s.kv=t.kv and s.acc=a.acc and
          a.rnk=k.rnk and s.dazs is null"
.head 6 +  If nKv
.head 7 -  Set sSql = sSql || ' AND s.kv=:nKv '
.head 6 +  If sPs
.head 7 -  Set sSql = sSql || sPs
.head 6 +  If bOK=1 and sNls
.head 7 -  Set sSql = sSql || " AND s.nls  LIKE '"||StrMatches2Like(sNls)||"'"
.head 6 +  If bOK=2 and sNms
.head 7 -  Set sSql = sSql || " AND (UPPER(s.nms) LIKE '%"||SalStrUpperX(StrMatches2Like(sNms))||"%' OR
                          UPPER(k.nmk) LIKE '%"||SalStrUpperX(StrMatches2Like(sNms))||"%')"
.head 6 +  If bOK=3 and sOkpoA
.head 7 -  Set sSql = sSql || " AND k.okpo LIKE '"||StrMatches2Like(sOkpoA)||"'"
.head 6 -  Call SqlPrepareAndExecute(hSql(), T(sSql || ' ORDER BY s.nls'))
.head 6 -  Call SalTblReset(hWndItem)
.head 6 -  Call SalTblSetRange(hWndItem, 0, TBL_MaxRow)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRow
.head 6 +  If lParam > 500
.head 7 -  ! Call SalMessageBox('Слишком много строк. Используйте поиск.','Внимание.', MB_IconExclamation)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgClient.cTManyRow'),
  CurrentLangTable.GetAtomTitle('DlgMSG_Warning'), MB_IconExclamation)
.head 7 -  Call SalSetFocus( dfSearchStr )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return SqlFetchNext(hSql(), nFetchRes)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.13, 0.7*lParam )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.357"
.head 5 -  Top:    4.048"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Return SalSendMsg(tbl, SAM_DoubleClick, 0, 0)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, 0.33, 0.7*lParam+0.6 )
.head 3 +  Option Button: obTudaSuda
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    4.071"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Button Style: Check
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If obTudaSuda
.head 7 -  Call SalShowWindow( tbl.colNmk )
.head 7 -  Call SalHideWindow( tbl.colNms )
.head 6 +  Else
.head 7 -  Call SalHideWindow( tbl.colNmk )
.head 7 -  Call SalShowWindow( tbl.colNms )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(obTudaSuda, 
  CurrentLangTable.GetAtomTitle('dlgClient.cTAccName'), 
  CurrentLangTable.GetAtomTitle('dlgClient.cTClientName'))) 
.head 5 +  On UM_NoFontChange
.head 6 -  Return TRUE
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam/2-0.2, 0.7*lParam+0.6 )
.head 5 +  On SAM_Create
.head 6 -  Set obTudaSuda=IifN(nFli=0,0,1)
.head 6 -  Call SalSendMsg(hWndItem,SAM_Click,0,0)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.386"
.head 5 -  Top:    4.048"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, VALIDATE_Cancel)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam-1.4, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblQueryFocus ( tbl, nRow, hWndCol )										
.head 6 -  Set nRow = VisTblFindString (tbl, nRow+1, hWndNULL, dfSearchStr)
.head 6 +  If nRow != -1
.head 7 -  Call SalTblSetFocusRow( tbl, nRow )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nFli
.head 3 -  String: sTT
.head 3 -  Number: nDk
.head 3 -  Number: bOK
.head 3 -  Receive String: sNls
.head 3 -  Receive String: sNms
.head 3 -  Receive String: sNmk
.head 3 -  Receive Number: nKv
.head 3 -  Receive String: sLcv
.head 3 -  Receive String: sOkpoA
.head 3 -  Receive String: str50
.head 2 +  Window Variables
.head 3 -  String: strCond
.head 3 -  String: sSql
.head 3 -  String: sPs
.head 3 -  String: sTmp
.head 3 -  Number: nRowCount
.head 3 -  Number: nFetchRes
.head 3 -  Number: nWid
.head 3 -  Number: nHei
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nRow
.head 3 -  Window Handle: hWndCol
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalGetWindowSize ( SalParentWindow ( hWndForm ), nWid, nHei )
.head 4 -  Call SalSetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgClient.cTWndTitle'))
.head 4 -  Call SalTblSetColumnTitle(tbl.colNms, CurrentLangTable.GetAtomTitle('dlgClient.cTAccName'))
.head 4 -  Call SalTblSetColumnTitle(tbl.colNmk, CurrentLangTable.GetAtomTitle('dlgClient.cTClientName'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_ParentSize, nWid, nHei )
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Dialog Box: dlgAlien       ! Выбор чужого клиента
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник контрагентов
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.263"
.head 4 -  Top:    0.365"
.head 4 -  Width:  11.414"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.208"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник клиентов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? No
.head 4 -  Size: 0.536"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск:
.head 4 -  Resource Id: 64463
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.131"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.107"
.head 6 -  Width:  6.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nRow=-1
.head 6 -  Call SalSendMsg( pbSearch, SAM_Click, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 5 +  On UM_ParentSize
.head 6 -  Call SalGetWindowSize ( hWndItem , nX, nY )
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.9, nY )
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.114"
.head 6 -  Top:    0.448"
.head 6 -  Width:  10.771"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.458"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colMFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 9
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
банка
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 9 -  Call SalTblSetColumnFlags( colNls, COL_RightJustify, TRUE )
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValISO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: rowid
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOkpo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  7.957"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndItem, UM_QueryLabelText, 0, 0 )
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If bOK=1 and sNls
.head 7 -  Set strCond = strCond || " AND a.nls  LIKE '"||StrMatches2Like(sNls)  ||"'"
.head 6 +  If bOK=2 and sNam
.head 7 -  ! Set sMFO_B = ''
.head 7 -  Set strCond = strCond || " AND UPPER(a.name) LIKE '%"||SalStrUpperX(StrMatches2Like(sNam))  ||"%'"
.head 6 +  If bOK=3 and sOkpo
.head 7 -  Set strCond = strCond || " AND a.okpo LIKE '"||StrMatches2Like(sOkpo) ||"'"
.head 6 +  If nKv
.head 7 -  Set strCond = strCond || " AND a.kv = :nKv"
.head 6 +  If sMFO_B
.head 7 -  Set strCond = strCond || " AND a.mfo  LIKE '"||StrMatches2Like(sMFO_B)||"'"
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine | TBL_Flag_SingleSelection, TRUE )
.head 6 -  Call SalTblPopulate( hWndItem, hSql(),
T("SELECT a.mfo,b.nb,a.nls,a.okpo,a.name, a.kv, t.lcv,a.ROWID
     INTO :colMFO, :colNb,:colNls,:colOkpo,
          :colName,:colKV,:colValISO,:colRowid 
     FROM alien a, tabval t, banks b
    WHERE a.mfo=b.mfo and a.kv=t.kv "||strCond|| " ORDER BY a.mfo, a.nls"), TBL_FillAll )
.head 6 -  Call VisTblAutoSizeColumn( hWndItem, hWndNULL )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nKv = colKV
.head 6 -  Set sLcv = SalStrTrimX(colValISO)
.head 6 -  Set sNls = SalStrTrimX(colNls)
.head 6 -  Set sNam = SalStrTrimX(colName)
.head 6 -  Set sMFO_B = SalStrTrimX(colMFO)
.head 6 -  Set sBankNam = SalStrTrimX(colNb)
.head 6 -  Set sOkpo = SalStrTrimX(colOkpo)
.head 6 -  Call SalEndDialog(dlgAlien, TRUE)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.13, 0.7*lParam )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    4.104"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, 0.33, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    4.104"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SqlPrepare( hSql(), 'DELETE FROM alien WHERE ROWID=:tbl.colRowid' )
.head 6 -  Call SalTblDeleteSelected( tbl, hSql() )
.head 6 -  Call SqlCommit( hSql() )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam/2-0.62, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.067"
.head 5 -  Top:    4.104"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam-1.4, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblQueryFocus ( tbl, nRow, hWndCol )										
.head 6 -  Set nRow = VisTblFindString (tbl, nRow+1, hWndNULL, dfSearchStr)
.head 6 +  If nRow != -1
.head 7 -  Call SalTblSetFocusRow( tbl, nRow )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: bOK
.head 3 -  Receive Number: nKv
.head 3 -  Receive String: sLcv
.head 3 -  Receive String: sNls
.head 3 -  Receive String: sOkpo
.head 3 -  Receive String: sNam
.head 3 -  Receive String: sMFO_B
.head 3 -  Receive String: sBankNam
.head 2 +  Window Variables
.head 3 -  String: strCond
.head 3 -  Number: nWid
.head 3 -  Number: nHei
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nRow
.head 3 -  Window Handle: hWndCol
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalGetWindowSize ( SalParentWindow ( hWndForm ), nWid, nHei )
.head 4 -  Call SalSetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgAlien.cTWndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_ParentSize, nWid, nHei )
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Dialog Box: dlgMFO         ! Выбор банка - корреспондента
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник МФО
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.638"
.head 4 -  Top:    0.24"
.head 4 -  Width:  6.214"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.464"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: System Window Color
.head 2 -  Description: Справочник МФО
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск:
.head 4 -  Resource Id: 63866
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.188"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    0.146"
.head 6 -  Width:  5.086"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfSearchStr )
.head 7 -  Set strCond = ''
.head 6 +  Else
.head 7 -  Set dfSearchStr=SalStrTrimX(dfSearchStr)
.head 7 +  If SalStrIsValidNumber( dfSearchStr )
.head 8 -  Set strCond = " AND mfo LIKE '%"||SalStrUpperX(StrMatches2Like(dfSearchStr))||"%'"
.head 7 +  Else
.head 8 -  Set strCond = " AND UPPER(nb) LIKE '%"||SalStrUpperX(StrMatches2Like(dfSearchStr))||"%'"
.head 6 -  Call SalSendMsg( tbl, SAM_Create, 0, 0 )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalGetWindowSize ( hWndItem , nX, nY )
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.9, nY )
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.129"
.head 6 -  Top:    0.524"
.head 6 -  Width:  5.857"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.893"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colMFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 9
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование банка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If not SalIsNull( colMFO )
.head 7 -  Set sBankName = SalStrTrimX( colName )
.head 7 -  Set sMFO_B = SalStrTrimX( colMFO )
.head 7 -  Call SalEndDialog(dlgMFO, TRUE )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndItem, UM_QueryLabelText, 0, 0 )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine | TBL_Flag_SingleSelection, TRUE )
.head 6 -  Call SalTblPopulate( tbl, hSql(),
 T("SELECT mfo, nb FROM banks WHERE mfo<>:strOurMfo "||strCond||" INTO :tbl.colMFO, :tbl.colName  ORDER BY mfo " ),   TBL_FillAll )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.13, 0.7*lParam )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    4.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, 0.33, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.467"
.head 5 -  Top:    4.56"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam-1.4, 0.7*lParam+0.6 )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sMFO_B
.head 3 -  Receive String: sBankName
.head 2 +  Window Variables
.head 3 -  String: strCond
.head 3 -  String: strOurMfo
.head 3 -  Number: nWid
.head 3 -  Number: nHei
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalGetWindowSize ( SalParentWindow ( hWndForm ), nWid, nHei )
.head 4 -  Call SalSetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgMFO.cTWndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set strCond = ''
.head 4 -  Set strOurMfo=GetBankMfo()
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_ParentSize, nWid, nHei )
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Dialog Box: dlgDescr       ! Выбор назначения платежа
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник назначений платежа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.55"
.head 4 -  Top:    0.177"
.head 4 -  Width:  7.857"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.881"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник назначений платежей
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск:
.head 4 -  Resource Id: 28731
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.155"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.119"
.head 6 -  Width:  6.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If SalIsNull( dfSearchStr )
.head 7 -  Call SalTblPopulate( tblDescr, hSql(), T(" SELECT np, ROWID FROM np 
INTO :tblDescr.colText, :tblDescr.colRowid  WHERE id=:nId ORDER BY 1"), TBL_FillNormal )
.head 6 +  Else
.head 7 -  Call SalTblPopulate( tblDescr, hSql(), T("SELECT np, ROWID FROM np
INTO :tblDescr.colText, :tblDescr.colRowid 
WHERE np LIKE \'"|| StrMatches2Like( dfSearchStr ) ||"\' AND id=:nId ORDER BY 1"), TBL_FillNormal )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Child Table: tblDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.129"
.head 6 -  Top:    0.524"
.head 6 -  Width:  7.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colText
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If not SalIsNull( colText )
.head 7 -  Set strDescr = SalStrTrimX(colText)
.head 7 -  Call SalEndDialog(dlgDescr, TRUE )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndItem, UM_QueryLabelText, 0, 0 )
.head 6 -  Call SalTblPopulate( tblDescr, hSql(), T( "SELECT np, ROWID FROM np 
INTO :tblDescr.colText, :tblDescr.colRowid WHERE id=:nId ORDER BY 1"), TBL_FillAll )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    4.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblDescr, SAM_DoubleClick, 0, 0 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.267"
.head 5 -  Top:    4.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SqlPrepare( hSql(), 'DELETE FROM np WHERE ROWID = :tblDescr.colRowid' )
.head 6 -  Call SalTblDeleteSelected( tblDescr, hSql() )
.head 6 -  Call SqlCommit( hSql() )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    4.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm,FALSE )
.head 3 -  Frame
.head 4 -  Resource Id: 17432
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    4.917"
.head 5 -  Width:  7.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.595"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: strDescr
.head 2 +  Window Variables
.head 3 -  Number: nId
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgDescr.cTWndTitle'))
.head 4 -  ! Call SalMapEnterToTab( FALSE )
.head 4 -  Set nId=GetUserId()
.head 3 +  ! On SAM_Destroy
.head 4 -                              Call SalMapEnterToTab( TRUE )
.head 1 +  Dialog Box: dlgInkast      ! Выбор инкасcатора
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник Инкассаторов/Подотчетных лиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  7.833"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.964"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник Инкасаторов/Подотчетных лиц
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? No
.head 4 -  Size: 0.536"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.114"
.head 6 -  Top:    0.476"
.head 6 -  Width:  7.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colFio
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФИО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 5 -  Number: nFetchRes
.head 5 -  String: sTmp
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nId = colId
.head 6 -  Call SalEndDialog(dlgInkast, TRUE)
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndItem, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If sNls
.head 7 -  Set sTmp="SELECT a.id, a.val INTO :tbl.colId,:tbl.colFio
            FROM podotw a
           WHERE a.tag='FIO'"||strCond||
"AND EXISTS (select id FROM podotw WHERE id=a.id AND tag='NLS' AND val=:sNls) ORDER BY a.val"
.head 6 +  Else
.head 7 -  Set sTmp="SELECT a.id, a.val INTO :tbl.colId,:tbl.colFio
            FROM podotw a
           WHERE a.tag='FIO'"||strCond||
"AND NOT EXISTS (select id FROM podotw WHERE id=a.id AND tag='NLS') ORDER BY a.val"
.head 6 -  Call SalTblPopulate( hWndItem, hSql(),sTmp,TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 -  Background Text: Поиск:
.head 4 -  Resource Id: 48049
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.131"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.857"
.head 6 -  Top:    0.107"
.head 6 -  Width:  6.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set strCond = ' AND val LIKE \'' ||
    StrMatches2Like(dfSearchStr) || '\''
.head 6 -  Call SalSendMsg(tbl, SAM_Create, 0, 0)
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.133"
.head 5 -  Top:    4.024"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, VALIDATE_Cancel)
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.357"
.head 5 -  Top:    4.048"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Return SalSendMsg(tbl, SAM_DoubleClick, 0, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 48050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.988"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sNls
.head 3 -  Receive Number: nId
.head 2 +  Window Variables
.head 3 -  String: strCond
.head 3 -  String: sSql
.head 3 -  String: sPs
.head 3 -  Boolean: PB_status
.head 3 -  String: sTmp
.head 3 -  Number: nRowCount
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgInkast.cTWndTitle'))
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 -  Set strCond = ''
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 1 +  Dialog Box: dlgAsk2Pay
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Оплата
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.225"
.head 4 -  Top:    1.396"
.head 4 -  Width:  7.914"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.063"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Утвердить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.214"
.head 5 -  Top:    1.104"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgAsk2Pay, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.257"
.head 5 -  Top:    1.104"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgAsk2Pay, FALSE )
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    0.393"
.head 6 -  Width:  7.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.619"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма документа
.head 4 -  Resource Id: 65314
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.202"
.head 5 -  Width:  7.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.464"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strSumPr
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgAsk2Pay.cTWndTitle'))
.head 4 -  Set ml1= strSumPr
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 1 +  Dialog Box: dlgTagBrowse   ! TAG бровзер
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Код-Текст Бровзер
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.7"
.head 4 -  Top:    0.49"
.head 4 -  Width:  7.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск(F7):
.head 4 -  Resource Id: 30049
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    0.238"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSearchStr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.238"
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nRow=-1
.head 6 -  Call SalSendMsg( pbSearch, SAM_Click, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.595"
.head 6 -  Width:  6.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.857"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colKod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTxt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine | TBL_Flag_SingleSelection, TRUE )
.head 6 -  Call SalTblPopulate( hWndItem, hSql(), strSelect, TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn( hWndItem, hWndNULL )
.head 5 +  On SAM_DoubleClick
.head 6 +  If not SalIsNull( colKod )
.head 7 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalTblQueryFocus ( hWndForm, nRow, hWndCol )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    4.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetContext( tbl, nRow )
.head 6 -  Set strKod=tbl.colKod
.head 6 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    4.702"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  Frame
.head 4 -  Resource Id: 30048
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.095"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = VisTblFindString (tbl, nRow+1, hWndNULL, df1)
.head 6 +  If nRow != -1
.head 7 -  Call SalTblSetFocusRow( tbl, nRow )
.head 7 -  ! Call SalTblSetContext( tbl, nRow )
.head 7 -  ! Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
.head 6 -  ! Call DebugN(nRow)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strSelect
.head 3 -  Receive String: strKod
.head 3 -  ! Receive String: strTxt
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgTagBrowse.cTWndTitle'))
.head 4 -  ! Call SalMapEnterToTab( FALSE )
.head 3 +  ! On SAM_Destroy
.head 4 -                              Call SalMapEnterToTab( TRUE )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus( df1 )
.head 1 +  Dialog Box: dlg_SetLocDat  ! Установить локальную операционную дату
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Локальный банковский день
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.838"
.head 4 -  Top:    1.885"
.head 4 -  Width:  5.833"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.19"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Midnight Blue
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.143"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ! Data Field: dfPass
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 16
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.417"
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +                              Message Actions 
.head 5 +                              On SAM_Validate
.head 6 +                              If dfPass=STRING_Null
.head 7 -                              Call SalSetFocus( pbExit )
.head 7 -                              Return VALIDATE_OkClearFlag
.head 6 +                              If TRUE ! dfPass=SqlPassword
.head 7 -                              Call SalEnableWindow( pbLoc )
.head 7 -                              Call SalEnableWindow( pbGlb)
.head 7 -                              Call SalEnableWindow( dfLoca)
.head 7 -                              Call SalDisableWindow(hWndItem)
.head 7 -                              Call SalSetFocus( dfLoca )
.head 7 -                              Return VALIDATE_OkClearFlag
.head 6 -                              Return VALIDATE_Cancel
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.233"
.head 5 -  Top:    0.202"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, IDCANCEL )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Установить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.202"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! If SalMessageBox( 'Установить дату '||SalFmtFormatDateTime( dfDat, 'dd/MM/yyyy' )||'?', 'Внимание!', MB_YesNo | MB_IconQuestion)=IDYES 
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTMsgSetDate') || ' '||SalFmtFormatDateTime( dfDat, 'dd/MM/yyyy' )||'?', 
  CurrentLangTable.GetAtomTitle('DlgMSG_Warning'), MB_YesNo | MB_IconQuestion)=IDYES 
.head 7 -  Call Pl_dat(dfDat)
.head 7 -  Set dDat=dfDat
.head 7 -  Call SaveFInfoToLog('Local data '||SalFmtFormatDateTime( dfDat, 'dd/MM/yyyy')||' set')
.head 7 -  Call SalEndDialog( hWndForm, IDOK )
.head 6 -  Call SalSetFocus( pbCancel )
.head 3 +  Data Field: dfDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.633"
.head 6 -  Top:    0.274"
.head 6 -  Width:  2.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.357"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidDateTime( hWndItem )
.head 7 -  ! Call SalMessageBox( 'Ош. формат даты', 'Ошибка.', MB_IconExclamation )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTErrDateFormat'), 
  CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfDat>GetBankDate()
.head 7 -  ! Call SalMessageBox( 'Устанавливаемая дата больше банковской. ', 'Ошибка.', MB_IconExclamation )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTMsgBigDate'), 
  CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 -  Frame
.head 4 -  Resource Id: 37097
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    0.167"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.571"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: System Frame Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Date/Time: dDat
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndItem)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTWndTitle'))
.head 4 -  Call SalSetFocus( pbCancel )
.head 4 -  Set dfDat=GetBankDate()
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: tblDocBal    ! Просмотр проводок по документу.
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Банковские проводки по документу №
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.0"
.head 4 -  Top:    1.281"
.head 4 -  Width:  9.486"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.512"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Default
.head 3 -  Background Color: System Window Color
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? No
.head 2 -  Description: Баланс проводок по документу
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.417"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Contents
.head 3 +  Column: colDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
валютиров
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.129"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -  Call SalTblSetColumnFlags( colNLS, COL_RightJustify, TRUE )
.head 3 +  Column: colLCV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.443"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSumD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДЕБЕТ

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДЕБЕТ

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSumK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДЕБЕТ
(екв.)
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КРЕДИТ
(екв.)
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подробности пл
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SOS
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DK
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма(екв)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWnd
.head 3 -  Number: nRef
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 3 -  Number: nTmp2
.head 3 -  Number: nMaxDig
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('DocWMesProvodki')||SalNumberToStrX(nRef,0) )
.head 4 -  Call SalTblSetColumnTitle( colSD, CurrentLangTable.GetAtomTitle('tblDocBal.colSumD') )
.head 4 -  Call SalTblSetColumnTitle( colSK, CurrentLangTable.GetAtomTitle('tblDocBal.colSumK') )
.head 4 -  ! Call SalGetWindowSize( SalParentWindow( hWndForm ), nTmp, nTmp2 )
.head 4 -  ! Call SalSetWindowSize( hWndForm , nTmp, nTmp2 )
.head 4 -  Call SalDisableWindow( hWnd )
.head 4 -  ! Показывать или не показывать
  эквиваленты по валюте
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),
  "SELECT val FROM params WHERE par='EQV' and val='YES' ")
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 -  Call SalShowWindow( colSDQ )
.head 5 -  Call SalShowWindow( colSKQ )
.head 4 -  !
.head 4 -  Call SalTblPopulate ( hWndForm, hSql (),"
 SELECT o.fdat,o.tt,a.nls,t.lcv,o.s/100,o.sq/100,o.txt,o.sos,o.dk,t.dig  
 INTO :colDAT,:colTT,:colNLS,:colLCV,
      :colS,:colSQ,:colNAZN,:colSOS,:colDK,:colDig 
 FROM opldok o, accounts a, tabval t 
 WHERE ref=:nRef AND o.acc=a.acc AND a.kv=t.kv
 ORDER BY o.fdat,t.lcv,o.stmt,o.tt,o.dk ", TBL_FillAll )
.head 4 +  If DigInit()!=-1
.head 5 -  Set nMaxDig=DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig=4
.head 3 +  On SAM_FetchRowDone
.head 4 +  If colDK = 0
.head 5 -  Set colSumD = colS
.head 5 -  Set colSD = Dig4( colSumD, colDig, nMaxDig ) 
.head 5 -  Set colSDQ = colSQ
.head 4 +  Else
.head 5 -  Set colSumK = colS
.head 5 -  Set colSK = Dig4( colSumK, colDig, nMaxDig ) 
.head 5 -  Set colSKQ = colSQ
.head 4 +  If colSumD = 0
.head 5 -  Set colSumD = NUMBER_Null
.head 5 -  Set colSD = ''
.head 4 +  If colSumK = 0
.head 5 -  Set colSumK = NUMBER_Null
.head 5 -  Set colSK = ''
.head 4 +  ! If colSDQ = 0
.head 5 -                              Set colSDQ = NUMBER_Null
.head 4 +  ! If colSKQ = 0
.head 5 -                              Set colSKQ = NUMBER_Null
.head 4 +  If colSOS < 5
.head 5 +  Select Case colSOS
.head 6 +  Case DOC_PAY_STORNO
.head 7 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 7 -  Break
.head 6 +  Case DOC_PAY_BOOKED
.head 7 -  Call SetTblRowColor( hWndForm, COLOR_DarkGreen )
.head 7 -  Break
.head 6 +  Case DOC_PAY_FEATURE
.head 7 -  Call SetTblRowColor( hWndForm, COLOR_Blue )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SetTblRowColor( hWndForm, COLOR_Purple )
.head 7 -  Break
.head 3 +  On SAM_Destroy
.head 4 -  Call SalEnableWindow( hWnd )
.head 1 +  ! Form Window: frmAlien
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.08"
.head 4 -  Top:    1.333"
.head 4 -  Width:  12.129"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.823"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 -  Background Text: Поиск:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.131"
.head 5 -  Width:  0.675"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: bgSearchStr
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfSearchStr
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.107"
.head 6 -  Width:  6.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfSearchStr )
.head 7 -  Set strCond = ''
.head 6 +  Else If SalIsValidNumber( dfSearchStr )
.head 7 -  Set strCond =  ' AND a.nls LIKE \'%' || dfSearchStr || '%\''
.head 6 +  Else 
.head 7 -  Set strCond =  ' AND a.name LIKE \'%' || dfSearchStr || '%\''
.head 6 -  Call SalSendMsg( tblAlien, SAM_Create, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 5 +  On UM_ParentSize
.head 6 -  Call SalGetWindowSize ( hWndItem , nX, nY )
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.9, nY )
.head 3 +  Child Table: tblAlien
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.114"
.head 6 -  Top:    0.448"
.head 6 -  Width:  10.771"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.458"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colMFO
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 9
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colNb
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
банка
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colNls
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 9 -  Call SalTblSetColumnFlags( colNls, COL_RightJustify, TRUE )
.head 5 +  Column: colKV
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colKV
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colValISO
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colRowid
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: rowid
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colName
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  7.957"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colOkpo
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nTmp
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndItem, UM_QueryLabelText, 0, 0 )
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If bOK=1 and sNls
.head 7 -  Set strCond = strCond || " AND a.nls  LIKE '"||StrMatches2Like(sNls)  ||"'"
.head 6 +  If bOK=2 and sNam
.head 7 -  Set sMFO_B = ''
.head 7 -  Set strCond = strCond || " AND a.name LIKE '%"||StrMatches2Like(sNam)  ||"%'"
.head 6 +  If bOK=3 and sOkpo
.head 7 -  Set strCond = strCond || " AND a.okpo LIKE '"||StrMatches2Like(sOkpo) ||"'"
.head 6 +  If nKv
.head 7 -  Set strCond = strCond || " AND a.kv = :nKv"
.head 6 +  If sMFO_B
.head 7 -  Set strCond = strCond || " AND a.mfo  LIKE '"||StrMatches2Like(sMFO_B)||"'"
.head 6 -  Call Debug(Str(bOK)||'='||strCond)
.head 6 -  Call SalTblPopulate( tblAlien, hSql(),
T("SELECT a.mfo,b.nb,a.nls,a.okpo,a.name, a.kv, t.lcv,a.ROWID
     INTO :colMFO, :colNb,:colNls,:colOkpo,
          :colName,:colKV,:colValISO,:colRowid 
     FROM alien a, tabval t, banks b
    WHERE a.mfo=b.mfo and a.kv=t.kv "||strCond|| " ORDER BY a.mfo, a.nls"), TBL_FillAll )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nKv = colKV
.head 6 -  Set sLcv = SalStrTrimX(colValISO)
.head 6 -  Set sNls = SalStrTrimX(colNls)
.head 6 -  Set sNam = SalStrTrimX(colName)
.head 6 -  Set sMFO_B = SalStrTrimX(colMFO)
.head 6 -  Set sBankNam = SalStrTrimX(colNb)
.head 6 -  Set sOkpo = SalStrTrimX(colOkpo)
.head 6 -  Call SalSendMsg( hWnd, UM_ObjDeactivate, 0, FALSE)
.head 6 -  Call SalDestroyWindow( frmAlien )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowSize ( hWndItem , wParam-0.13, 0.7*lParam )
.head 3 +  Pushbutton: pbOk
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    4.104"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblAlien, SAM_DoubleClick, 0, 0 )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, 0.33, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbDel
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Удалить
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    4.104"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SqlPrepare( hSql(), 'DELETE FROM alien WHERE ROWID=:tblAlien.colRowid' )
.head 6 -  Call SalTblDeleteSelected( tblAlien, hSql() )
.head 6 -  Call SqlCommit( hSql() )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam/2-0.62, 0.7*lParam+0.6 )
.head 3 +  Pushbutton: pbCancel
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.067"
.head 5 -  Top:    4.104"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( frmAlien )
.head 5 +  On UM_ParentSize
.head 6 -  Call SalSetWindowLoc ( hWndItem, wParam-1.4, 0.7*lParam+0.6 )
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  Sql Handle: hWnd
.head 3 -  Number: bOK
.head 3 -  Receive Number: nKv
.head 3 -  Receive String: sLcv
.head 3 -  Receive String: sNls
.head 3 -  Receive String: sOkpo
.head 3 -  Receive String: sNam
.head 3 -  Receive String: sMFO_B
.head 3 -  Receive String: sBankNam
.head 2 +  Window Variables 
.head 3 -  String: strCond
.head 3 -  Number: nWid
.head 3 -  Number: nHei
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, TRUE)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalGetWindowSize ( hWnd, nWid, nHei )
.head 4 -  Call SalSetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgAlien.cTWndTitle'))
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize ( hWndForm , nWid, nHei )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_ParentSize, nWid, nHei )
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( hWnd, UM_ObjDeactivate, 0, FALSE)
