Application Description: Система термінових переказів НБУ (MIK 22-10-2002)
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000EA0000 002C000000020000 0003000000000000 00BB010000FCFFFF
0040: FFD7FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533032342E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: Genlist.apl
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		File Include: Docfun6.apl
		File Include: Winapi.apl
		File Include: Xsalcpt.apl
		File Include: vttblwin.apl
		File Include: Vtmeter.apl
		File Include: Genlabel.apl
		File Include: XSALIMG.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: ##############000
		External Functions
			! *** Функции для работы с ССП
			Library name: CENTSSP.DLL
				Function: SSPSetup
					Description: SSPSetup инициализирует библиотеку для работы с ССП
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
				Function: SSPConnect
					Description: SSPConnect устанавливает соединение с АРМ-ССП
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPSTR
						Number: INT
				Function: SSPInvoke
					Description: SSPInvoke посылает пакет ССП и возвращает буфер пакета ответа
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						Number: INT
						Number: INT
						String: LPSTR
						Number: INT
						String: LPSTR
						Receive Number: LPWORD
				Function: SSPDisconnect
					Description: SSPShutdown деинициализирует библиотеку для работы с ССП
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
				Function: SSPShutdown
					Description: SSPShutdown деинициализирует библиотеку для работы с ССП
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '24'
				String: ApdVer   =  '05'
				! История изменений: -----------------------------------------------------|
				! 01 16-01-03  MIK   Положил начало контролю версий
				! 02 22-10-03  MIK   Вместо кнопки F12 сделал возможность ручного выбора колонок для показа
				! 04 18-06-06  MIK   Код ключа получателя ССП для SEP2 = '3', SEP '4'  
				! 05 22-08-06  MIK   Захайдил кнопку UPDATE, проставил kv=980 для lkl_rrp  
		Resources
		Variables
.data RESOURCE 0 0 1 3015617240
0000: 380000001A000000 0000000000000000 0200000200000069 000000E0010D0000
0020: 00FF3F7600B80000 0100FFFF
.enddata
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin9
			Number: nFetchRes
			Boolean: bApdInited
			String: sOperId
			String: strGlobalNarrative
		Internal Functions
			Function: Sel024	! __exported
				Description: Bars024_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
				Actions
					Call Ini024()
					Select Case nMode
						Case 9   ! Установка лимитов по модели 4 (типа казнач)
							If not IsWindow(hWin9)
								Set hWin9=SalCreateWindow(tbl_SetLims, hWndParent, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( tbl_SetLims )
							Break
					Return TRUE
			Function: Ini024
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars024.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							Call CurrentLangTable.AddAtom('tbl_SetLims.colMFO','МФО')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colNAM','Наименование')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colDOS','Обороты'||PutCrLf()||'Дебет')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colKOS','Обороты'||PutCrLf()||'Кредит')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colOST','Остаток'||PutCrLf()||'3911')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colLIM','Остаток'||PutCrLf()||'4453')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colIZM','Изменить'||PutCrLf()||'лимит')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colLNO','Лимит'||PutCrLf()||'Начальных')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colLOO','Лимит'||PutCrLf()||'Ответных')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colLTK','Лимит')
							Call CurrentLangTable.AddAtom('tbl_SetLims.colMAX','MAX cумма'||PutCrLf()||'проплаты' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.colSSPOst','Дневной остаток'||PutCrLf()||'совладельца' )
							Call CurrentLangTable.AddAtom('tbl_SetLims','Установка лимитов через ССП')
							Call CurrentLangTable.AddAtom('tbl_SetLimsAskMsg','Установить лимиты и выполнить проводки ?')
							Call CurrentLangTable.AddAtom('tbl_SetLims.pbSetLim','Установить новый лимит в ССП')
							! ---------
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelMFO','МФО' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelNAM','Наименование' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelDOS','Обороты Дебет' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelKOS','Обороты Кредит' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelOST','Остаток 3911' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelLIM','Лимит 4453' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelIZM','Дельта (грн)' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.strNarrative','№ указа' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.pbConfirm', 'Установить' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.pbCancel','Отменить' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.WndLimitTitle','Установка лимита по МФО' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelLNO','ЛНО (из ССП)' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.labelLTK','ЛТК (из ССП)' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.msgSetLimMfo','Установлен лимит для МФО' )
							Call CurrentLangTable.AddAtom('tbl_SetLims.msgSetLimNew','новое значение' )
							! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars024.lng','RUS')
						! Call DocWisInit('frmDoc.')
						! Call DocWisInit('frmDocDV.')
						Set bApdInited = TRUE
					Return bApdInited
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			! ******************************
			Function: GetErrorDesc  
				Description: возвращает описание ошибки по коду из S_ER
				Returns
					String:
				Parameters
					String: strCode
				Static Variables
				Local variables
					String: strDesc
				Actions
					Set strDesc = ''
					If SqlPrepareAndExecute( hSqlAux(),"
							SELECT n_er INTO :strDesc FROM s_er 
							WHERE k_er=:strCode")
						Call SqlFetchNext( hSqlAux(), nFetchRes )
					Return strDesc
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 3543233371
0000: A90000006A000000 0000000000000000 0200000100FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C9000100003F 8001F80000003704
0060: 0001F00D000000FF 1F110000DC000200 FF7F157000000001 00FFFF01
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbGetValue
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_NumId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: tbl_SetLims    ! 16
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Установка лимитов прямым участникам
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.05"
				Top:    0.448"
				Width:  17.05"
				Width Editable? Yes
				Height: 6.369"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.427"
				Size Editable? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.086"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.514"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.943"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.371"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 55157
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.557"
						Begin Y:  -0.01"
						End X:  4.557"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 62900
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.867"
						Begin Y:  -0.012"
						End X:  5.867"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 62901
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  9.95"
						Begin Y:  -0.012"
						End X:  9.95"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.043"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.471"
						Top:    0.073"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.9"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'История установки лимитов по выбронному МФО'
						! On SAM_Click
							                            Call Sel014 (hWndMDI, 10, 0,  '', tbl_SetLims.clMfo_)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.329"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: F5
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 55158
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.886"
						Begin Y:  -0.01"
						End X:  3.886"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.014"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 55159
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.9"
						Begin Y:  -0.01"
						End X:  1.9"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				! Check Box: cbIsGenFile
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Cформировать файл лимитов для участников
					Window Location and Size
						Left:   4.786"
						Top:    0.073"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
					                            Message Actions 
				! cTBarButton: pbUnHideSSP
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.071"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? No
					Keyboard Accelerator: F12
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					            Message Actions 
						            On SAM_Create
							            Call SalHideWindow( colSUBJ )
							            Call SalHideWindow( colCOUN )
							            Call SalHideWindow( colSUBJK )
							            Call SalHideWindow( colSUBJT )
							            Call SalHideWindow( colSSPNOD )
							            Call SalHideWindow( colSSPNOK )
							            Call SalHideWindow( colSSPOOD )
							            Call SalHideWindow( colSSPOOK )
							            Call SalHideWindow( colSEPNOD )
							            Call SalHideWindow( colSEPNOK )
							            Call SalHideWindow( colSEPOOD )
							            Call SalHideWindow( colSEPOOK )
							            Call SalHideWindow( colLOO )
							            Call SalHideWindow( colLNO )
							            Call SalHideWindow( colLTK )
							            Call SalHideWindow( colSSPOst )
						            On SAM_Click
							            Set bF12=not bF12
							            If bF12
								            Call SalShowWindow( colSUBJ )
								            Call SalShowWindow( colCOUN )
								            Call SalShowWindow( colSUBJK )
								            Call SalShowWindow( colSUBJT )
								            Call SalShowWindow( colSSPNOD )
								            Call SalShowWindow( colSSPNOK )
								            Call SalShowWindow( colSSPOOD )
								            Call SalShowWindow( colSSPOOK )
								            Call SalShowWindow( colSEPNOD )
								            Call SalShowWindow( colSEPNOK )
								            Call SalShowWindow( colSEPOOD )
								            Call SalShowWindow( colSEPOOK )
								            Call SalShowWindow( colLOO )
								            Call SalShowWindow( colLNO )
								            Call SalShowWindow( colLTK )
								            Call SalShowWindow( colSSPOst )
							            Else 
								            Call SalSendMsg( hWndItem, SAM_Create, 0, 0 )
				Check Box: cbSSP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: СТП
					Window Location and Size
						Left:   4.75"
						Top:    0.095"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				Check Box: cbPAY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Оплата 
					Window Location and Size
						Left:   10.2"
						Top:    0.095"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				Background Text:
					Resource Id: 62899
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.383"
						Top:    0.083"
						Width:  0.833"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dfResurs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 11
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.15"
							Top:    0.095"
							Width:  2.667"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						! On SAM_Create
							                       If GetBankModel()
								! Call Debug('Модель '||Str(GetBankModel()))
								                       Call SqlPrepareAndExecute( hSql(),"
										SELECT SUM(a.ostc) INTO :nTmpL00
										  FROM accounts a WHERE a.tip in('L00','TUR')")
								                       If not SqlFetchNext( hSql(), nFetchRes )
									                       Set nTmpL00=0
							                       Call SqlPrepareAndExecute( hSql(),"
									SELECT -a.ostc-b.ostc-b.lim INTO :nTmp
									 FROM accounts a,accounts b
									 WHERE a.tip='N00' and b.tip='TNB'")
							                       If not SqlFetchNext( hSql(), nFetchRes )
								                       Set nTmp=0
							                       Set dfResurs=(nTmp-nTmpL00)/100
							                       If nTmp<nTmpL00
								                       Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Red )
							                       Else
								                       Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue )
						On SAM_Create
							Call SqlPrepareAndExecute( hSql(),"
									SELECT sum(decode(tip,'TNB',-ostc-lim,-ostc) ) INTO :nTmpL00
									  FROM accounts
									 WHERE kv=980 AND tip in ('N00','TNB'"||IifS(GetBankModel(),",'L00','TUR'",'')||")")
							If not SqlFetchNext( hSql(), nFetchRes )
								Set nTmpL00=0
							Set dfResurs=nTmpL00 / 100
							If nTmpL00 < 0
								Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Red )
								! Call SalColorSet( dfResursN, COLOR_IndexWindowText, COLOR_Red )
							Else
								Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_DarkBlue )
							! Set dfResursN='Ресурс'
				Background Text: Ресурс:
					Resource Id: 62902
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.95"
						Top:    0.083"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				Option Button: obTimer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.817"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Clock.bmp
					Picture Transparent Color: None
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, IifS(obTimer, 'Вы', 'В') ||
									       'ключить автосканирование')
						On SAM_Click
							If obTimer
								Set cbSSP = 0
								Set cbPAY = 0
								Call SalDisableWindow( cbSSP )
								Call SalDisableWindow( cbPAY )
							Else
								Call SalEnableWindow( cbSSP )
								Call SalEnableWindow( cbPAY )
				Pushbutton: pbSetLim
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.783"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\UPDOWN.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_SetLims.pbSetLim'))
						On SAM_Click
							Call SalModalDialog( dlg_SetSingleLimit, hWndForm, hWndForm, colMFO, colNAM,
									colDOS, colKOS, colOST, colLIM, colLNO, colLTK/100 )
		Contents
			Column: colMFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: МФО
				Visible? Yes
				Editable? No
				Maximum Data Length: 6
				Data Type: String
				Justify: Center
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNAM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						 Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						Кредит -
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! cColumnLabeled: colOST
.winattr class Column:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Залишок
						3911
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                           List Values 
				                           Message Actions 
			Column: colOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Залишок
						3911
				Visible? Class Default
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Decimal
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ліміт
						4453
				Visible? Class Default
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Decimal
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colIZM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дельта
				Visible? Class Default
				Editable? Yes
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Decimal
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					! On SAM_Validate     !! Для теста !!
						                      Set nS = colIZM
						                      If nS
							                      If nS > 0
								                      Set nDk=0
							                      Else 
								                      Set nDk=1
							                      Set nS=SalNumberAbs( nS )*100
							                      Call cDoc.SetDoc( 0,'PS1',nDk,6,'', dDat, dDat, dDat, dDat,
									     colNls3911,colNAM,GetBankMfo(),'',980,nS,GetBankOkpoS(),
									     colNls4451,colNAM,GetBankMfo(),'',980,nS,GetBankOkpoS(),
									     'Встановлення ліміту на коррахунок','',GetIdOper(),'',NUMBER_Null,0)
							                      If cDoc.oDoc()
								                      Call SaveFInfoToLog('Встановлення ліміту на коррахунок'||colNls3911 )
								                      Call SqlCommit(hSql())
							                      Else 
								                      Call SqlRollback(hSql())
						                      Return VALIDATE_Ok
					On SAM_AnyEdit
						If colSUBJT!=STRING_Null and colSUBJT!=' ' ! красная ==> редактировать нельзя
							Set colIZM = 0
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalMessageBeep( MB_IconAsterisk )
			! Column: colOstN
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток +
						Незаквит
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                            List Values 
				                            Message Actions 
			Column: colMAX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: MAX сума
						проплати
				Visible? Class Default
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Decimal
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			! Column: colOstNL
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток +
						Незаквит -
						Лимит (6-7)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                            List Values 
				                            Message Actions 
			!
			! Column: colAcc
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
						начальных
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.457"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                         List Values 
				                         Message Actions 
			! Column: colMfoP
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.971"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                         List Values 
				                         Message Actions 
			Column: colNls3911
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3911
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.971"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNls4451
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 4453
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.971"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			! Column: colSSPOst
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дневной остаток
						совладельца
						
				Visible? No
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                   List Values 
				                   Message Actions 
			Column: colSSPOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дневной остаток
						совладельца
						
				Visible? No
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLTK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ЛТК
						в ССП
				Visible? No
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSEPNOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НОД
						в СЭП
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSEPNOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НОK
						в СЭП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSEPOOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ООД
						в СЭП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSEPOOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ООК
						в СЭП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLNO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лимит
						начальных
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLOO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лимит
						ответных
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSSPNOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НОД
						в ССП
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSSPNOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НОK
						в ССП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSSPOOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ООД
						в ССП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSSPOOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ООК
						в ССП
				Visible? Yes
				Editable? No
				Maximum Data Length: 15
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSUBJ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.
						субьекта
				Visible? No
				Editable? No
				Maximum Data Length: 6
				Data Type: String
				Justify: Center
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCOUN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.
						счета
				Visible? No
				Editable? No
				Maximum Data Length: 10
				Data Type: String
				Justify: Center
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSUBJK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кат
						совл
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Center
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSUBJT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						совл
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Center
				Width:  0.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			! Column: colIsReadSSP
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Флаг
						чтения из ССП
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.417"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				               List Values 
				               Message Actions 
				! List Values 
				! Message Actions 
		Functions
			Function: sIni	        ! Инициализировать подпись
				Description: Инициализировать ЭЦП
				Returns
					Boolean:
				Parameters
				Static Variables
					Boolean: bSignInited
					Number: nTim
				Local variables
					String: strDay
					Number: nDay
					Number: nErrorSign
					String: strPinCode
					Number: lTim
				Actions
					Set lTim=nTim
					! Set sOperId = SalStrMidX(GetBankSab(),1,3)|| 'B' || UserIdTo2DigitId( GetUserId() )
					Set nTim=SalDateHour( SalDateCurrent(  ) )*60+SalDateMinute( SalDateCurrent(  ) )
					If bSignInited and nTim-lTim<5
						Return TRUE
					Set nErrorSign=NUMBER_Null
					Set strPinCode=STRING_Null
					Call SalWaitCursor(FALSE)
					While TRUE
						If SalModalDialog( dlgAskPinCode, hWndForm, strPinCode )
							If bSignInited
								Set nErrorSign=CLOSE_ZAH()
								Set bSignInited=FALSE
							Set nErrorSign=INIT_ZAH( strOpenKeyDir, GetSecretKeyDrv(), sOperId, GetKeyDate(), strPinCode )
							!
							If nErrorSign= -70
								Call MessageErrorEx( sOperId||': Последний день действия секретного ключа' )
							Else If nErrorSign> -77 And nErrorSign< -70
								Set nDay= - nErrorSign - 70
								If nDay=1
									Set strDay='день'
								Else If nDay=2 Or nDay=3 Or nDay=4
									Set strDay='дня'
								Else If nDay=5 Or nDay=6
									Set strDay='дней'
								Call MessageErrorEx( sOperId||': Срок действия секретного ключа прекращается через ' || NumberToStr( nDay ) || ' ' || strDay )
							Else If nErrorSign!=0
								Break
							Call SaveInfoToLog( '>> RSA- инициализация - OK' )
							Set bSignInited=TRUE
							Return TRUE
						Else
							Break
					!
					If nErrorSign		     ! обработка ошибок ЭЦП
						Call MessageErrorEx(sOperId||': Ошибка '|| NumberToStr( nErrorSign ) ||' инициализации ЭЦП'||
								PutCrLf()||strOpenKeyDir)
					Return FALSE
			! *** Построение пакетов ССП ***
			Function: SSPPutZag
				Description: '206',1,59   '306',1,12
				Returns
					Boolean:
				Parameters
					String: sKatKod
					Number: nLin
					Number: nLen
					Receive String: sSlug
					Receive String: sZagl
				Static Variables
				Local variables
				Actions
					! 1 Длина СЛУЖЕБНОЙ СТРОКИ (в байтах)         N    3   1-  3
							  2 Длина ТЕЛА пакета ( зашифрованного)       N    6   4-  9
							  3 Длина ТЕЛА пакета (расшифрованного)       N    9  10- 18
							  4 Способ шифрования пакета                  C=   1  19- 19
							  5 Идентификатор ключа отправителя пакета    C    6  20- 25
							  6 Идентификатор ключа получателя  пакета    C    6  26- 31
							  7 Категория  пакета                         C=   1  32- 32
							  8 Код        пакета                         C=   2  33- 34
							  9 Направление пакета                        C=   1  35- 35
							 10 Номер соединения в ССП                    C    4  36- 39
							 11 Номер пакета в текущем соединении         C    4  40- 43
							 12 Резерв                                    C    7  44- 50
							 13 CRLF                                      B    2  51- 52
							
					! 1 ЭЦП на пакет                              B   64   1- 64
							  2 Идентификатор ключа ЭЦП на пакет          C    6  65- 70
							  3 Количество ИС (Информационных Строк)      N    6  71- 76
							  4 Длина      ИС (Информационной Строки)     N    6  77- 82
							  5 Д+В формирования пакета                   tб  14  83- 96
							  6 Резерв                                    C    4  97-100
							  7 CRLF                                      B    2 101-102
					If GetGlobalOptionEx('SEPNUM')=2
						Set sSlug=' 52'||PadL(SalNumberToStrX(102+nLin*nLen,0),6)||
								            PadL(SalNumberToStrX(102+nLin*nLen,0),9)||'0'||SalStrRightX(GetBankSab(),3)||
								   '3000HP100'||sKatKod||'3'||'0000'||'0000'||PadR(' ',7)||PutCrLf()
					Else
						Set sSlug=' 52'||PadL(SalNumberToStrX(102+nLin*nLen,0),6)||
								            PadL(SalNumberToStrX(102+nLin*nLen,0),9)||'0'||SalStrRightX(GetBankSab(),3)||
								   '4000HP100'||sKatKod||'3'||'   0'||'   0'||PadR(' ',7)||PutCrLf()
					Set sZagl=sOperId||PadL(SalNumberToStrX(nLin,0),6)||
							                   PadL(SalNumberToStrX(nLen,0),6)||SalFmtFormatDateTime(GetBankDate(),'yyMMdd')||
							    SalStrLeftX( 
								Right('0'||SalFmtFormatDateTime(SalDateCurrent(),'hhhhmmss'),6)||'00',8)
							        ||PadR(' ', 4)||PutCrLf()
			Function: SSPPutPack206
				Description:
				Returns
					String:
				Parameters
					String: sMfo
					Number: nLno
					Number: nLoo
					Number: nLim
				Static Variables
				Local variables
				Actions
					! 1 Категория счета     "1"/"3"/"7"           C=   1   1-  1
							  2 Идентификатор валюты (цифровой)           c-   3   2-  4
							  3 Идентификатор субьекта (МФО банка)        N    6   5- 10
							  4 Флаг блокировки НО по совладельцу         C=   1  11- 11
							  5 Флаг блокировки ОО по совладельцу         C=   1  12- 12
							  6 Лимит на НО        по совладельцу         i   15  13- 27
							  7 Лимит на OО        по совладельцу         i   15  28- 42
							  8 Лимит на сумму        совладельца         i   15  43- 57
							  9 CRLF                                      B    2  58- 59
							
							2.06.? Запит на зміну параметрів технічного рахунку учасника
							============================================================
							 1 Категорія рахунку ("1"/"3")	              C=   1   1-  1
							 2 Ідентифікатор валюти (цифровий)            N	   3   2-  4
							 3 Код банку учасника	                      N	   6   5- 10
							 4 Флаг блокування ПО за технічним рахунком   C=   1  11- 11
							 5 Флаг блокування ОВ за технічним рахунком   C=   1  12- 12
							 6 Ліміт на ПО за технічним рахунком	      n-  15  13- 27
							 7 Ліміт на ОВ за технічним рахунком	      n-  15  28- 42
							 8 Ліміт          технічного рахунку          n-  15  43- 57 
							 9 CrLf                                       B	   2  58- 59
							
						! PadL(SalNumberToStrX(nLoo,0),15)||
					Return '1'||'980'||sMfo||'*'||'*'||PadL(SalNumberToStrX(nLno,0),15)||
							                                   PadL(' ',15)||
							                                   PadL(SalNumberToStrX(nLim,0),15)||PutCrLf()
			Function: SSPPutPack305
				Description:
				Returns
					String:
				Parameters
					String: sMfo
				Static Variables
				Local variables
				Actions
					! 1 Идентификатор счета                       L   10   1- 10
							  2 CRLF                                      B    2  11- 12
							
							3.05.? Запит на інформацію про технічний коррахунок
							============================================================
							 1 Ідентифікатор технічного коррахунку        L   10   1- 10
							 2 CrLf                           	      B    2  11- 12
							
					Return '1'||'980'||sMfo||PutCrLf()
			Function: SSPPutPack306
				Description:
				Returns
					String:
				Parameters
					String: sMfo
				Static Variables
				Local variables
				Actions
					! 1 Категория счета     "1"/"3"/"7"           C=   1   1-  1
							  2 Идентификатор валюты (цифровой)           c-   3   2-  4
							  3 Идентификатор субьекта (совладельца)      N    6   5- 10
							  4 CRLF                                      B    2  11- 12
					Return '1'||'980'||sMfo||PutCrLf()
			Function: SSPGetPack305
				Description:
				Returns
				Parameters
					String: sBuf
					Receive String: sCOUN
					Receive String: sCOUNK
					Receive String: sCOUNT
					Receive String: sVALS
					Receive String: sSUBJ
					Receive String: sOPER
					Receive String: sOPE1
					Receive String: sARM2
					Receive Number: sOst
					Receive Number: sSSPNOD
					Receive Number: sSSPNOK
					Receive Number: sSSPOOD
					Receive Number: sSSPOOK
					Receive Number: sSEPNOD
					Receive Number: sSEPNOK
					Receive Number: sSEPOOD
					Receive Number: sSEPOOK
					Receive String: sBlkN
					Receive String: sBlkO
					Receive Number: sLimNO
					Receive Number: sLimOO
					Receive Number: sLimS
					Receive String: sPrinc
				Static Variables
				Local variables
				Actions
					! 1 Идентификатор счета                       L   10   1- 10
							  2 Категория     счета                       C    1  11- 11
							  3 Тип           счета                       C    1  12- 12
							  4 Идентификатор валюты (цифровой)           c-   3  13- 15
							  5 Идентификатор совладельца (МФО)           L    6  16- 21
							  6 Идентификатор ОПЕРо                       L    6  22- 27
							  7 Идентификатор ОПЕРо_1                     C    1  28- 28
							  8 Идентификатор АРМ-2                       C    1  29- 29
							  9 Текущее значение счета                    n   15  30- 44
							 10 НОД в ССП     по счету                    N   15  45- 59
							 11 НОК в ССП     по счету                    N   15  60- 74
							 12 ООД в ССП     по счету                    N   15  75- 89
							 13 ООК в ССП     по счету                    N   15  90-104
							 14 НОД в СЭП     по счету                    N   15 105-119
							 15 НОК в СЭП     по счету                    N   15 120-134
							 16 ООД в СЭП     по счету                    N   15 135-149
							 17 ООК в СЭП     по счету                    N   15 150-164
							 18 Флаг блокировки НО по счету               C=   1 165-165
							 19 Флаг блокировки ОО по счету               C=   1 166-166
							 20 Лимит на НО   по счету                    n   15 167-181
							 21 Лимит на ОО   по счету                    n   15 182-196
							 22 Лимит на сумму   счета                    n   15 197-211
							 23 Принципы блокировок и лимитов             C    6 212-217
							 24 CRLF                                      B    2 218-219
							
							3.05.! Інформація про технічний коррахунок
							============================================================
							 1 Ідентифікатор технічного коррахунку        L   10   1- 10
							 2 Категорія коррахунку ("1"/"3")	      C=   1  11- 11
							 3 Резерв	                              C-   1  12- 12
							 4 Цифровий ідентифікатор валюти рахунку      N    3  13- 15
							 5 Код банку власника коррахунку	      L    6  16- 21
							 6 Код банку територіального управління НБУ   L    6  22- 27
							 7 Однобуквений ідентифікатор НБУ             C+   1  28- 28
							 8 Резерв                                     C-   1  29- 29
							 9 Поточне значення технічного коррахунку     n   15  30- 44
							10 ПО дебетові  за коррахунком в СТП          N	  15  45- 59
							11 ПО кредитові за коррахунком в СТП          N	  15  60- 74
							12 ОВ дебетові  за коррахунком в СТП          N	  15  75- 89
							13 ОВ кредитові за коррахунком в СТП          N	  15  90-104
							14 ПО дебетові  за коррахунком в файл. режимі N	  15 105-119
							15 ПО кредитові за коррахунком в файл. режимі N	  15 120-134
							16 ОВ дебетові  за коррахунком в файл. режимі N   15 135-149
							17 ОВ кредитові за коррахунком в файл. режимі N	  15 150-164
							18 Блокування ПО за коррахунком               C=   1 165-165
							19 Блокування ОВ за коррахунком               C=   1 166-166
							20 ЛПО за коррахунком	                      n	  15 167-181
							21 ЛОВ за коррахунком	                      n	  15 182-196
							22 ЛТК	                                      n	  15 197-211
							23 Резерв	                              C-   3 212-214
							24 Спосіб ранкового завантаження ЛПО          C=   1 215-215
							25 Спосіб ранкового завантаження ЛОВ	      C=   1 216-216
							26 Спосіб ранкового завантаження ЛТК	      C=   1 217-217
							27 ЛТК НБУ	                              n	  15 218-232
							28 ЛПО НБУ	                              n	  15 233-247
							29 Спосіб ранкового завантаження ЛТК НБУ      C=   1 248-248
							30 Спосіб ранкового завантаження ЛПО НБУ      C=   1 249-249
							31 Резерв	                              C-  16 250-265
							32 CrLf	                                      B    2 266-267
							                                     
					Set sCOUN=SalStrLeftX(GetOffset(sBuf,0),10)
					Set sCOUNK=SalStrLeftX(GetOffset(sBuf,10),1)
					Set sCOUNT=SalStrLeftX(GetOffset(sBuf,11),1)
					Set sVALS=SalStrLeftX(GetOffset(sBuf,12),3)
					Set sSUBJ=SalStrLeftX(GetOffset(sBuf,15),6)
					Set sOPER=SalStrLeftX(GetOffset(sBuf,21),6)
					Set sOPE1=SalStrLeftX(GetOffset(sBuf,27),1)
					Set sARM2=SalStrLeftX(GetOffset(sBuf,28),1)
					Set sOst=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,29),15))
					Set sSSPNOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,44),15))
					Set sSSPNOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,59),15))
					Set sSSPOOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,74),15))
					Set sSSPOOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,89),15))
					Set sSEPNOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,104),15))
					Set sSEPNOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,119),15))
					Set sSEPOOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,134),15))
					Set sSEPOOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,149),15))
					Set sBlkN=SalStrLeftX(GetOffset(sBuf,164),1)
					Set sBlkO=SalStrLeftX(GetOffset(sBuf,165),1)
					Set sLimNO=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,166),15))
					Set sLimOO=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,181),15))
					Set sLimS=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,196),15))
					Set sPrinc=SalStrLeftX(GetOffset(sBuf,211),6)
			Function: SSPGetPack306
				Description:
				Returns
				Parameters
					String: sBuf
					Receive String: sSUBJ
					Receive String: sCOUN
					Receive String: sSUBJK
					Receive String: sSUBJT
					Receive String: sVALS
					Receive Number: sOst
					Receive Number: sSSPNOD
					Receive Number: sSSPNOK
					Receive Number: sSSPOOD
					Receive Number: sSSPOOK
					Receive Number: sSEPNOD
					Receive Number: sSEPNOK
					Receive Number: sSEPOOD
					Receive Number: sSEPOOK
					Receive String: sBlkN
					Receive String: sBlkO
					Receive Number: sLimNO
					Receive Number: sLimOO
					Receive Number: sLimS
					Receive String: sPrinc
				Static Variables
				Local variables
				Actions
					! 1 Идентификатор субьекта                    N    6   1-  6
							  2 Идентификатор счета                       L   10   7- 16
							  3 Категория совладельца                     C=   1  17- 17
							  4 Тип совладельца                           C=   1  18- 18
							  5 Идентификатор валюты (цифровой)           c-   3  19- 21
							  6 Дневной остаток  совладельца              n   15  22- 36
							  7 НОД по совладельцу в ССП                  N   15  37- 51
							  8 НОK по совладельцу в ССП                  N   15  52- 66
							  9 ООД по совладельцу в ССП                  N   15  67- 81
							 10 ООК по совладельцу в ССП                  N   15  82- 96
							 11 НОД по совладельцу в СЭП                  N   15  97-111
							 12 НОK по совладельцу в СЭП                  N   15 112-126
							 13 ООД по совладельцу в СЭП                  N   15 127-141
							 14 ООК по совладельцу в СЭП                  N   15 142-156
							 15 Флаг блокировки начальных по совладельцу  C=   1 157-157
							 16 Флаг блокировки ответных  по совладельцу  C=   1 158-158
							 17 Лимит НО совладельца                      n   15 159-173
							 18 Лимит ОО совладельца                      n   15 174-188
							 19 Лимит на сумму совладельца                n   15 189-203
							 20 Принципы  блокировок и лимитов            C    6 204-209
							 21 CRLF                                      B    2 210-211
							
							3.06.! Інформація про технічний рахунок учасника
							============================================================
							 1 Код банку учасника	                      L	   6   1-  6
							 2 Ідентифікатор технічного коррахунку        L   10   7- 16
							 3 Резерв                                     C-   2  17- 18
							 4 Цифровий ідентифікатор валюти              N    3  19- 21
							 5 Поточне значення денного залишку учасника  n   15  22- 36
							 6 ПО дебетові  учасника за СТП	              N   15  37- 51
							 7 ПО кредитові учасника за СТП	              N   15  52- 66
							 8 ОВ дебетові  учасника за СТП	              N   15  67- 81
							 9 ОВ кредитові учасника за СТП	              N   15  82- 96
							10 ПО дебетові  учасника у файловому режимі   N   15  97-111
							11 ПО кредитові учасника у файловому режимі   N   15 112-126
							12 ОВ дебетові  учасника у файловому режимі   N   15 127-141
							13 ОВ кредитові учасника у файловому режимі   N   15 142-156
							14 Блокування початкових оборотів  учасника   C=   1 157-157
							15 Блокування оборотів у відповідь учасника   C=   1 158-158
							16 Ліміт початкових оборотів (ЛПО) учасника   n	  15 159-173
							17 Ліміт оборотів у відповідь (ЛОВ)учасника   n	  15 174-188
							18 Ліміт технічного рахунку учасника (ЛТК)    n	  15 189-203
							19 Резерв                                     C-   3 204-206
							20 Спосіб ранкового завантаження ЛПО	      C=   1 207-207
							21 Спосіб ранкового завантаження ЛОВ	      C=   1 208-208
							22 Спосіб ранкового завантаження ЛТК	      C=   1 209-209
							23 Блокування ПО, встановлене юр.особою       C=   1 210-210
							24 Блокування ОВ, встановлене юр.особою	      C=   1 211-211
							25 ЛТР-ЮР учасника                            n   15 212-226
							26 ЛПО-ЮР учасника                            n   15 227-241
							27 Спосіб ранкового завантаження ЛТР-ЮР	      C=   1 242-242
							28 Спосіб ранкового завантаження ЛПО-ЮР       C=   1 243-243
							29 CrLf                                       B	   2 244-245
							
					Set sSUBJ=SalStrLeftX(GetOffset(sBuf,0),6)
					Set sCOUN=SalStrLeftX(GetOffset(sBuf,6),10)
					Set sSUBJK=SalStrLeftX(GetOffset(sBuf,16),1)
					Set sSUBJT=SalStrLeftX(GetOffset(sBuf,17),1)
					Set sVALS=SalStrLeftX(GetOffset(sBuf,18),3)
					Set sOst=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,21),15))
					Set sSSPNOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,36),15))
					Set sSSPNOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,51),15))
					Set sSSPOOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,66),15))
					Set sSSPOOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,81),15))
					Set sSEPNOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,96),15))
					Set sSEPNOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,111),15))
					Set sSEPOOD=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,126),15))
					Set sSEPOOK=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,141),15))
					Set sBlkN=SalStrLeftX(GetOffset(sBuf,156),1)
					Set sBlkO=SalStrLeftX(GetOffset(sBuf,157),1)
					Set sLimNO=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,158),15))
					Set sLimOO=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,173),15))
					Set sLimS=SalStrToNumber(SalStrLeftX(GetOffset(sBuf,188),15))
					Set sPrinc=SalStrLeftX(GetOffset(sBuf,203),6)
			Function: sPack   ! Подписать пакет
				Description: Подписывает пакеты ССП
				Returns
					Boolean:
				Parameters
					String: sBuf
				Static Variables
				Local variables
					String: sSignData
					Number: nErrorSign
					String: strErrorSign
					String: sNd
					String: sNama
					String: sNamb
					String: sNazn
					String: sDrec
					String: sDat1
					String: sDat2
					Number: nVob
					String: szTempBuf
					! Date/Time: dtSomeDate
					Number: nInd
				Actions
					If GetSignOn() = 0 ! ЭЦП отключена - вернуть Пусто
						Return TRUE
					If sIni()
						If GetSignType() = 'NBU'
							Call SalStrSetBufferLength( lsSignP, 65 )
							Set nErrorSign = RSA_ZAH(87,-1,1,sBuf,SalStrLength(sBuf),0,lsSignP,sOperId)
						If nErrorSign = 0
							! Call sTrace(sBuff, lsSignP)
							! Call Debug(sBuf)
							Return TRUE
						Else
							If GetSignType() = 'NBU'
								Set strErrorSign = 'Ошибка наложения ЭЦП НБУ: '||NumberToStr(nErrorSign)
								Call MessageAttention(strErrorSign)
					Return FALSE
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			File Handle: hFile
			Number: nCur
			Number: nS
			Number: nType
			Number: nRowFlag
			Number: nDk
			Number: nTmp
			String: sTmp
			Boolean: bF12
			!
			Number: nId
			Date/Time: dDat
			!
			Number: nRet
			String: sErrTxt
			String: strOpenKeyDir
			String: sHost  ! хост АРМ-ССП
			String: sPort  ! порт АРМ-ССП
			Number: nTimeout  ! время ожидания ответа от АРМ-ССП
			Number: nPort
			!
			Number: nLen
			String: sBuf
			String: sBuf0
			String: sBuf1
			String: sBuf2
			String: sBuf12
			Long String: lsSignP
			: cDoc
				Class: cDoc
			Number: nTmpL00
			Number: TIMER_ID_RESCAN
			String: strNarrative ! номер указа для установки лимитов
			String: strMFO
		Message Actions
			On SAM_Create
				Set TIMER_ID_RESCAN = 1
				Call SalTimerSet(hWndForm, TIMER_ID_RESCAN, 65535)
				Set tbl_SetLims.nFlags=GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
				Set tbl_SetLims.nTabInstance = 1
				If strPar01 = 'RO' or strPar02='305'
					! Call SalDisableWindow( cbIsGenFile )
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( colLIM )
					Call SalDisableWindow( colLTK)
					Call SalDisableWindow( colIZM)
					Call SalDisableWindow( cbPAY)
				Call PrepareWindow( hWndForm )
				If strPar02='305'
					Call SalSetWindowText ( hWndForm, 'Информация о счетах УДК в ССП' )
				Else
					Call SalSetWindowText ( hWndForm, SalStrTrimX(CurrentLangTable.GetAtomTitle('tbl_SetLims')) )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('18')
				Call SalTblSetLockedColumns( hWndForm, 7 )
				! ! Add for multilanguage support
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				! Встановити поточний код ключа
				Set sOperId =  GetIdOper()
				Set sOperId =  SalStrLeftX( sOperId, 3 )||'B'||SalStrRightX( sOperId, 2 )
				! Читання Ini - файлу
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Digital Signature', 'OpenKeyNBU', GetOpenKeyDir(), strOpenKeyDir, GetIniFileName())
				Call SalGetProfileString('SSP', 'Host','ARM_SSP', sHost, GetIniFileName())
				Call SalGetProfileString('SSP', 'Port','1111', sPort, GetIniFileName())
				Set nTimeout = SalGetProfileInt('SSP', 'Timeout',10, GetIniFileName())
				Set nPort=SalStrToNumber( sPort )
				Set dDat=GetBankDate()
				!
				Set tbl_SetLims.strPrintFileName =  'SetLims.txt'
				! Set tbl_SetLims.strSqlPopulate=
						"SELECT a1.nls,a2.nls,l.mfo,a1.nms,a1.ostc/100,a1.dos/100,a1.kos/100,a2.ostc/100
						       DECODE(c.mfop,'820172',-a1.lim,l.lim)/100,l.lno/100,c.mfop
						  INTO :colNls3911,:colNls4451,:colMFO,:colNAM,:colOST,:colDOS,:colKOS,:colLIM,:colLTK,:colLNO,:colMfoP
						  FROM lkl_rrp l, bank_acc b1, accounts a1, bank_acc b2, accounts a2, banks c
						 WHERE l.mfo=b1.mfo AND l.mfo=b2.mfo AND l.mfo=c.mfo AND
						      a1.acc=b1.acc AND a1.tip='L00' AND
						      a2.acc=b2.acc AND a2.tip='L01' AND c.mfo like '8%' "
				Set tbl_SetLims.strSqlPopulate=
						"SELECT a1.nls,a2.nls,l.mfo,a1.nms,a1.ostc/100,
						 DECODE(a1.dapp,:dDat,a1.dos/100,0),
						 DECODE(a1.dapp,:dDat,a1.kos/100,0),a2.ostc/100,
						 l.trouble
						   INTO :colNls3911,:colNls4451,:colMFO,:colNAM,:colOST,:colDOS,:colKOS,:colLIM,
							:colSUBJT
						  FROM lkl_rrp l, bank_acc b1, accounts a1, bank_acc b2, accounts a2, banks c
						 WHERE l.mfo=b1.mfo AND l.mfo=b2.mfo AND l.mfo=c.mfo AND
						      a1.acc=b1.acc AND a1.tip='L00' AND
						      a2.acc=b2.acc AND a2.tip='L01' AND c.mfo like '8%' AND l.kv=980 "
				! Set tbl_SetLims.strSqlUpdate=
						 'UPDATE lkl_rrp
						     SET lim = 100*:tbl_SetLims.colLTK,  lno = 100*:tbl_SetLims.colLNO
						   WHERE mfo = :tbl_SetLims.colMFO'
				Call SalSendClassMessage(SAM_Create, wParam, lParam )
			! On UM_Update
				 Call SalSendMsg(hWndForm,UM_ObjActivate, 0, 206 )
			On UM_Populate
				Call SalDisableWindow(colIZM)
				Call SalDisableWindow(pbSetLim)
				Call SalSendClassMessage(UM_Populate, 0, 0 )
				Call SalSendMsg( dfResurs,SAM_Create, 0, 0 )
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
				If strPar02 = '305'
					Call SalSendMsg(hWndForm,UM_ObjActivate, wParam, 305 )
				Else
					Call SalSendMsg(hWndForm,UM_ObjActivate, wParam, 306 )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set colIZM=0
				If colSUBJT!=STRING_Null and colSUBJT!=' '
					Call SetTblRowColor( hWndForm, COLOR_Red )
			On UM_ObjActivate
				Set sErrTxt=''
				If not cbSSP
					Return TRUE
				Set nType=lParam
				If nType=206
					! If MessageQuestion(CurrentLangTable.GetAtomTitle('tbl_SetLimsAskMsg')) = IDNO
						            Return FALSE
					If SalModalDialog( dlgAskNarrative, hWndForm, 
							  CurrentLangTable.GetAtomTitle('tbl_SetLimsAskMsg'), strNarrative )
							  =MBEx_Cancel
						Return FALSE
					! Установим назначение платежа в пуле переменных
					If Not SqlPLSQLCommand( hSql(), 
							 "pul.SetLimNarrative(strNarrative)" )
						Return FALSE
					Set nLen=59
					Set nRowFlag=ROW_Edited
				Else If nType=305
					Set nLen=12
					Set nRowFlag=0
				Else If nType=306
					Set nLen=12
					Set nRowFlag=0
				Else
					Return FALSE
				Call SalWaitCursor(TRUE)
				Set nRet = SSPSetup()
				If nRet=0
					Set nRet = SSPConnect(sHost,nPort)
					If nRet=0
						Set nCur=TBL_MinRow
						While SalTblFindNextRow ( hWndForm, nCur, nRowFlag, 0 )
							Call SalTblSetContext(  hWndForm, nCur)
							Call SalTblSetRowFlags( hWndForm, nCur, ROW_Edited, FALSE )
							Call SalTblSetFocusRow( hWndForm, nCur )
							! sBuf0 - служебная строка 
							! sBuf1 - заглавная строка 
							! sBuf2 - строка пакета 
							If cbPAY
								If NOT SqlPrepareAndExecute(hSql(), T("SELECT mfo INTO :strMFO FROM lkl_rrp WHERE mfo=:colMFO AND kv=980 FOR UPDATE NOWAIT"))
									Call SqlRollback(hSql())
									Set sErrTxt='Невозможно заблокировать строку для МФО='||colMFO
									Break
							If nCur>=0 or nType=206 and colIZM
								Call SSPPutZag(SalNumberToStrX(nType,0),1,nLen,sBuf0,sBuf1)
								If nType=206                !!   Установть новые LTK-LNO для совладельца
									Set sBuf2=SSPPutPack206(colMFO,colLNO,0,colLTK - colIZM*100)
								Else If nType=305           !!   Прочитать информацию по счету
									Set sBuf2=SSPPutPack305(colMFO)
								Else If nType=306           !!   Прочитать состояние счета совладельца
									Set sBuf2=SSPPutPack306(colMFO)
								!
								Set colIZM=0
								!
								If not sPack(sBuf1||sBuf2)  !!   Подписать пакет
									If cbPAY
										Call SqlRollback(hSql())
									Break
								Call SalStrSetBufferLength( sBuf12,64+38+nLen+1 )
								Call ConcatBufs(sBuf12,lsSignP,64,sBuf1||sBuf2,38+nLen)
								Call SalStrSetBufferLength( sBuf, 52+64+38+nLen+1 )
								Call ConcatBufs(sBuf,sBuf0,52,sBuf12,64+38+nLen)
								Set nFetchRes=1024
								Set sBuf2=SalStrRepeatX( 'X', nFetchRes )
								Set nRet = SSPInvoke(0,nTimeout,sBuf,52+64+38+nLen,sBuf2,nFetchRes)
								If nRet
									If cbPAY
										Call SqlRollback(hSql())
									Set sErrTxt='Ошибка '||Str(nRet)||' передачи пакета '||SalStrLeftX(GetOffset(sBuf,31),3)||' в ССП'
									Break
								Else
									If SalStrLeftX(GetOffset(sBuf2,252),4)='0000'
										If nType=305
											Call SSPGetPack305(GetOffset(sBuf2,258),colCOUN,colSUBJK,colSUBJT,sTmp,colSUBJ,sTmp,sTmp,sTmp,colSSPOst,
													colSSPNOD,colSSPNOK,colSSPOOD,colSSPOOK,
													colSEPNOD,colSEPNOK,colSEPOOD,colSEPOOK,sTmp,sTmp,colLNO,colLOO,colLTK,sTmp)
											Set colMAX=colSSPOst/100
											! делим все на 100 для отображения в гриде - SERG
											Set colSSPNOD = colSSPNOD/100
											Set colSSPNOK = colSSPNOK/100
											Set colSSPOOD = colSSPOOD/100
											Set colSSPOOK = colSSPOOK/100
											Set colSEPNOD = colSEPNOD/100
											Set colSEPNOK = colSEPNOK/100
											Set colSEPOOD = colSEPOOD/100
											Set colSEPOOK = colSEPOOK/100
											Set colLNO = colLNO/100
											Set colLOO = colLOO/100
										Else
											Call SSPGetPack306(GetOffset(sBuf2,258),colSUBJ,colCOUN,colSUBJK,colSUBJT,sTmp,colSSPOst,
													colSSPNOD,colSSPNOK,colSSPOOD,colSSPOOK,
													colSEPNOD,colSEPNOK,colSEPOOD,colSEPOOK,sTmp,sTmp,colLNO,colLOO,colLTK,sTmp)
											Set colMAX=(colSSPOst-colLTK)/100
											! делим все на 100 для отображения в гриде - SERG
											Set colSSPNOD = colSSPNOD/100
											Set colSSPNOK = colSSPNOK/100
											Set colSSPOOD = colSSPOOD/100
											Set colSSPOOK = colSSPOOK/100
											Set colSEPNOD = colSEPNOD/100
											Set colSEPNOK = colSEPNOK/100
											Set colSEPOOD = colSEPOOD/100
											Set colSEPOOK = colSEPOOK/100
											Set colLNO = colLNO/100
											Set colLOO = colLOO/100
										! Call Debug('1.MFO = '||colMFO)
										Call XSalTblSetRowBackColor( hWndForm, nCur,COLOR_LightAqua) ! покрасить серый
										! Call Debug('2.MFO = '||colMFO)
										! Call SalEnableWindow(cbPAY)
										If cbPAY and (nType=206 or nType=306)
											! Добавил поле colSUBJT в вызове sep.pay8mod() 18/12/03
											! Call Debug('3.MFO = '||colMFO)
											Set strMFO = colMFO
											If colSUBJ!=colMFO
												Call SqlRollback(hSql())
												Set sErrTxt='ССП вернула неверное МФО '||colMFO||' <> '||colSUBJ
												Break
											If SqlPLSQLCommand( hSql(), "sep.pay8mod( tbl_SetLims.colMFO,tbl_SetLims.colSSPOst,980,
													     tbl_SetLims.colSSPNOD*100,tbl_SetLims.colSSPNOK*100,tbl_SetLims.colSSPOOD*100,tbl_SetLims.colSSPOOK*100,
													     tbl_SetLims.colSEPNOD*100,tbl_SetLims.colSEPNOK*100,tbl_SetLims.colSEPOOD*100,tbl_SetLims.colSEPOOK*100,
													     tbl_SetLims.colLNO*100,tbl_SetLims.colLOO*100,tbl_SetLims.colLTK,
													     tbl_SetLims.colSUBJT)" )
												Call SqlCommit(hSql())
											Else
												! Call Debug('4.MFO = ' || colMFO)
												Call SqlRollback(hSql())
												! Call Debug('5.MFO = '||tbl_SetLims.colMFO)
												Set sErrTxt='Ошибка регулировки ЛОРО счета для МФО '||strMFO
												Break
											! Call Debug('6.MFO = '||tbl_SetLims.colMFO)
										! Донаселение строк
										Call SqlPrepareAndExecute(hSql(),
												"SELECT DECODE(a1.dapp,:dDat,a1.dos/100,0),
												        DECODE(a1.dapp,:dDat,a1.kos/100,0),a1.ostc/100,a2.ostc/100
												   INTO :colDOS,:colKOS,:colOST,:colLIM
												   FROM accounts a1, accounts a2
												  WHERE a1.nls=:colNls3911 and a1.kv=980 and a2.nls=:colNls4451 and a2.kv=980 ")
										Call SqlFetchNext(hSql(),nFetchRes)
									Else
										If cbPAY
											Call SqlRollback(hSql())
										Set sErrTxt='ССП вернула ошибку '
												||SalStrLeftX(GetOffset(sBuf2,252),4)||' для пакета '
												||SalStrLeftX(GetOffset(sBuf,31),3)||PutCrLf()
												||GetErrorDesc(SalStrLeftX(GetOffset(sBuf2,252),4))
										Break
							If cbPAY
								Call SqlCommit(hSql())
					Else
						Set sErrTxt='Ошибка '||Str(nRet)||' подключения к ССП. Host='||sHost||'('||Str(nPort)||')'
				Else
					Set sErrTxt='Ошибка '||Str(nRet)||' инициализации ССП' 
				Set nRet = SSPDisconnect()
				Call SalWaitCursor(FALSE)
				If sErrTxt
					Call MessageErrorEx( sErrTxt )
				Else
					Call SalEnableWindow(colIZM)
					Call SalEnableWindow(pbSetLim)
				If nRet
					Call MessageErrorEx( 'Ошибка '||Str(nRet)||' отключения от ССП' )
				Set nRet = SSPShutdown()
				If nRet
					Call MessageErrorEx( 'Ошибка '||Str(nRet)||' деинициализации ССП' )
				Else
					! Обнулим назначение платежа в пуле переменных
					If nType=206
						Call SqlPLSQLCommand( hSql(), "pul.SetLimNarrative('')" )
			On SAM_Destroy
				Call SalTimerKill(tbl_SetLims, TIMER_ID_RESCAN)
			On SAM_Timer
				If obTimer
					Call SalSendMsg(hWndForm, UM_Populate, 1, 0)
	Dialog Box: dlgAskNarrative
		Class:
		Property Template:
		Class DLL Name:
		Title: Увага!
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.817"
				Width Editable? Yes
				Height: 1.964"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Встановити ліміти згідно наказу:
				Resource Id: 5112
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.167"
					Top:    0.107"
					Width:  5.35"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfNarrative
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.167"
						Top:    0.393"
						Width:  5.35"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbYes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: &Так
				Window Location and Size
					Left:   1.317"
					Top:    0.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strNarrative = dfNarrative
						Call SalEndDialog(hWndForm, MBEx_Yes)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: &Ні
				Window Location and Size
					Left:   2.983"
					Top:    0.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strNarrative = ''
						Call SalEndDialog(hWndForm, MBEx_Cancel)
			Frame
				Resource Id: 5113
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.167"
					Top:    0.881"
					Width:  5.35"
					Width Editable? Yes
					Height: 0.69"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
		Functions
		Window Parameters
			String: strLabelText
			Receive String: strNarrative
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
	Dialog Box: dlg_SetSingleLimit
		Class:
		Property Template:
		Class DLL Name:
		Title: Установка лимита по МФО хххххх
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.733"
				Width Editable? Yes
				Height: 4.667"
				Height Editable? Yes
			Absolute Screen Location? No
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: МФО:
				Resource Id: 48460
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.345"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelMFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelMFO, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelMFO') )
			Background Text: Наименование:
				Resource Id: 48462
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.595"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelName, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelNAM') )
			Background Text: Обороты Дебет:
				Resource Id: 48463
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.845"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelDOS, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelDOS') )
			Background Text: Обороты Кредит:
				Resource Id: 48464
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    1.095"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelKOS, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelKOS') )
			Background Text: Остаток 3911:
				Resource Id: 48465
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    1.345"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelOST, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelOST') )
			Background Text: Лимит 4453:
				Resource Id: 48466
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    1.595"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelLIM, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelLIM') )
			Line
				Resource Id: 48461
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.483"
					Begin Y:  1.905"
					End X:  8.183"
					End Y:  1.905"
				Visible? Yes
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
			Data Field: dfMFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    0.321"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfNAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    0.571"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    0.821"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    1.071"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: df3911
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    1.321"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: df4453
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    1.571"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дельта:
				Resource Id: 48467
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    2.619"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelIZM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelIZM, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelIZM') )
			Background Text: № указа:
				Resource Id: 48468
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    2.869"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelNarrative
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelNarrative, CurrentLangTable.GetAtomTitle('tbl_SetLims.strNarrative') )
			Data Field: dfIZM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    2.595"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfNarrative
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    2.845"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbConfirm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Установить
				Window Location and Size
					Left:   2.983"
					Top:    3.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! Проверки
						Set sErrTxt = STRING_Null
						If dfIZM=NUMBER_Null or dfIZM=0
							Set sErrTxt='Поле Дельта не заполнено или равно 0.'
							Call MessageErrorEx( sErrTxt )
							Return FALSE
						If dfNarrative=STRING_Null
							Set sErrTxt='Поле "№ указа" не заполнено.'
							Call MessageErrorEx( sErrTxt )
							Return FALSE
						Set strGlobalNarrative = dfNarrative
						! Запись "номера указа" в переменную пакета PUL
						If Not SqlPLSQLCommand( hSql(), 
								 "pul.SetLimNarrative(strGlobalNarrative)" )
							Call SalEndDialog( hWndForm, -1 )
						Set nLen=59
						Call SalWaitCursor(TRUE)
						Set nRet = SSPSetup()
						If nRet=0
							Set nRet = SSPConnect(tbl_SetLims.sHost,tbl_SetLims.nPort)
							If nRet=0
								! Заблокируем строку с данным MFO в таблице lkl_rrp
								If NOT SqlPrepareAndExecute(hSql(), T("SELECT mfo INTO :tmpMFO FROM lkl_rrp WHERE mfo=:dfMFO AND kv=980 FOR UPDATE NOWAIT"))
									Call SqlRollback(hSql())
									Set sErrTxt='Невозможно заблокировать строку для МФО='||dfMFO
								Else
									! sBuf0 - служебная строка 
									! sBuf1 - заглавная строка 
									! sBuf2 - строка пакета 
									Call tbl_SetLims.SSPPutZag(SalNumberToStrX(206,0),1,
											  nLen, sBuf0, sBuf1)
									Set sBuf2=tbl_SetLims.SSPPutPack206(strMFO,dfLNO*100,0,
												dfLTK*100 - dfIZM*100)
									If not tbl_SetLims.sPack(sBuf1||sBuf2)  !!   Подписать пакет
										Call SqlRollbackEx( hSql(), 'Set Limit: '||'Ошибка наложения ЭЦП на пакет ССП' )
									Else
										Call SalStrSetBufferLength( sBuf12,64+38+nLen+1 )
										Call ConcatBufs(sBuf12,tbl_SetLims.lsSignP,64,sBuf1||sBuf2,38+nLen)
										Call SalStrSetBufferLength( sBuf, 52+64+38+nLen+1 )
										Call ConcatBufs(sBuf,sBuf0,52,sBuf12,64+38+nLen)
										Set nFetchRes=1024
										Set sBuf2=SalStrRepeatX( 'X', nFetchRes )
										Set nRet = SSPInvoke(0,tbl_SetLims.nTimeout,
													sBuf,52+64+38+nLen,sBuf2,nFetchRes)
										If nRet
											Set sErrTxt='Ошибка '||Str(nRet)||' передачи пакета '||SalStrLeftX(GetOffset(sBuf,31),3)||' в ССП'
											Call SqlRollbackEx( hSql(), 'Set Limit: '||sErrTxt )
										Else
											If SalStrLeftX(GetOffset(sBuf2,252),4)='0000'
												Call tbl_SetLims.SSPGetPack306(GetOffset(sBuf2,258),sSUBJ,
														sCOUN,sSUBJK,sSUBJT,sTmp,sOst,
														sSSPNOD,sSSPNOK,sSSPOOD,sSSPOOK,
														sSEPNOD,sSEPNOK,sSEPOOD,sSEPOOK,sTmp,sTmp,sLimNO,sLimOO,sLimS,sTmp)
												If sSUBJ!=strMFO
													Set sErrTxt='Несовпадение МФО пакета запроса и ответа: '||
															 strMFO||'<>'||sSUBJ
													Call SqlRollbackEx( hSql(), 'Set Limit: '||sErrTxt )
												Else
													If SqlPLSQLCommand( hSql(), "sep.pay8mod( strMFO,sOst,980,
															     sSSPNOD,sSSPNOK,sSSPOOD,sSSPOOK,
															     sSEPNOD,sSEPNOK,sSEPOOD,sSEPOOK,
															     sLimNO,sLimOO,sLimS,
															     sSUBJT)" )
														Set strMsg = CurrentLangTable.GetAtomTitle('tbl_SetLims.msgSetLimMfo')
																||' '||strMFO
																||', '||CurrentLangTable.GetAtomTitle('tbl_SetLims.msgSetLimNew')||': '
																||SalFmtFormatNumber( sLimS/100, '### ### ### ### ##0.00' )
														Call SqlCommitEx( hSql(),'Set Limit: '||strMsg )
														Call SalMessageBox( strMsg, 'Information', MB_Ok|MB_IconAsterisk )
													Else
														Set sErrTxt='Ошибка регулировки(sep.pay8mod) лимита для МФО '||strMFO
														Call SqlRollbackEx( hSql(), 'Set Limit: '||sErrTxt )
											Else
												Set sErrTxt='ССП вернула ошибку '
														||SalStrLeftX(GetOffset(sBuf2,252),4)||' для пакета '
														||SalStrLeftX(GetOffset(sBuf,31),3)||PutCrLf()
														||GetErrorDesc(SalStrLeftX(GetOffset(sBuf2,252),4))
												Call SqlRollbackEx( hSql(), 'Set Limit: '||sErrTxt )
							Else
								Set sErrTxt='Ошибка '||Str(nRet)||' подключения к ССП. Host='
										||tbl_SetLims.sHost||'('||Str(tbl_SetLims.nPort)||')'
						Else
							Set sErrTxt='Ошибка '||Str(nRet)||' инициализации ССП' 
						Set nRet = SSPDisconnect()
						Call SalWaitCursor(FALSE)
						If sErrTxt
							Call MessageErrorEx( sErrTxt )
						If nRet
							Call MessageErrorEx( 'Ошибка '||Str(nRet)||' отключения от ССП' )
						Set nRet = SSPShutdown()
						If nRet
							Call MessageErrorEx( 'Ошибка '||Str(nRet)||' деинициализации ССП' )
						! Очищаем "номера указа" в переменной пакета PUL
						Call SqlPLSQLCommand( hSql(), "pul.SetLimNarrative('')" )
						Call SalEndDialog( hWndForm, 0 )
					On SAM_Create
						Call SalSetWindowText( pbConfirm, CurrentLangTable.GetAtomTitle('tbl_SetLims.pbConfirm') )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.883"
					Top:    3.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, -1 )
					On SAM_Create
						Call SalSetWindowText( pbCancel, CurrentLangTable.GetAtomTitle('tbl_SetLims.pbCancel') )
			Line
				Resource Id: 53638
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.483"
					Begin Y:  2.536"
					End X:  8.15"
					End Y:  2.536"
				Visible? Yes
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
			Background Text: ЛНО (из ССП):
				Resource Id: 53640
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    1.964"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelLNO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelLNO, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelLNO') )
			Background Text: ЛТК (из ССП):
				Resource Id: 53639
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    2.238"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: labelLTK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSetWindowLabelText( labelLTK, CurrentLangTable.GetAtomTitle('tbl_SetLims.labelLTK') )
			Data Field: dfLNO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    1.964"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfLTK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    2.238"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ##############000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
			Window Handle: hWndParent
			String: strMFO
			String: strName
			Number: nDOS
			Number: nKOS
			Number: nOST
			Number: nLIM
			Number: nLNO
			Number: nLTK
		Window Variables
			Number: nRet
			String: sErrTxt
			String: tmpMFO
			Number: nLen
			String: sBuf
			String: sBuf0
			String: sBuf1
			String: sBuf2
			String: sBuf12
			String: sSUBJ
			String: sCOUN
			String: sSUBJK
			String: sSUBJT
			String: sVALS
			Number: sOst
			Number: sSSPNOD
			Number: sSSPNOK
			Number: sSSPOOD
			Number: sSSPOOK
			Number: sSEPNOD
			Number: sSEPNOK
			Number: sSEPOOD
			Number: sSEPOOK
			String: sBlkN
			String: sBlkO
			Number: sLimNO
			Number: sLimOO
			Number: sLimS
			String: sPrinc
			String: sTmp
			String: strMsg
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 
						CurrentLangTable.GetAtomTitle('tbl_SetLims.WndLimitTitle')||' '||strMFO )
				Call SalCenterWindow( hWndForm )
				Set dfMFO = strMFO
				Set dfNAME = strName
				Set dfDOS = nDOS
				Set dfKOS = nKOS
				Set df3911 = nOST
				Set df4453 = nLIM
				Set dfNarrative = strGlobalNarrative
				Set dfLNO = nLNO
				Set dfLTK = nLTK
