Application Description: Centura  Builder starter application
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000980000 002C000000020000 0003000000000000 0082020000FCFFFF
0040: FFDEFFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773076765
0080: 6F5F4E4F4D
.enddata
.data DT_MAKERUNDLG
0000: 02000000001E513A 5C4241525339385C 4C4942524152595C 67656F5F6D616B76
0020: 2E6578651E513A5C 4241525339385C4C 4942524152595C67 656F5F6D616B762E
0040: 646C6C1E513A5C42 41525339385C4C49 42524152595C6765 6F5F6D616B762E61
0060: 706300000101011E 513A5C4241525339 385C4C4942524152 595C67656F5F6D61
0080: 6B762E72756E1E51 3A5C424152533938 5C4C494252415259 5C67656F5F6D616B
00A0: 762E646C6C1E513A 5C4241525339385C 4C4942524152595C 67656F5F6D616B76
00C0: 2E61706300000101 01185C6261727339 385C62696E5C6765 6F5F6D616B762E61
00E0: 7064185C62617273 39385C62696E5C67 656F5F6D616B762E 646C6C185C626172
0100: 7339385C62696E5C 67656F5F6D616B76 2E61706300000101 011E513A5C424152
0120: 5339385C4C494252 4152595C67656F5F 6D616B762E61706C 1E513A5C42415253
0140: 39385C4C49425241 52595C67656F5F6D 616B762E646C6C1E 513A5C4241525339
0160: 385C4C4942524152 595C67656F5F6D61 6B762E6170630000 010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0818B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: Docview.apd
		File Include: Vtfile.apl
		File Include: Vtdos.apl
		File Include: Gentbl.apl
		File Include: Winapi.apl
		File Include: Xsalcpt.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
		Resources
		Variables
.data RESOURCE 0 0 1 3460042225
0000: 1E00000011000000 0000000000000000 0200000100000043 000000E003040000
0020: 00FF3F
.enddata
			Window Handle: hWnd1
			Window Handle: hWnd2
			Window Handle: hWnd3
			Window Handle: hWnd33
			Window Handle: hWnd4
		Internal Functions
			Function: Geo_makv			! __exported
				Description:
				Returns
					Boolean:
				Parameters
					Number: nPar
				Static Variables
					Window Handle: whGM
				Local variables
					String: sDat
					String: srab
					Number: nkv
					Number: nbsum
					Number: nrate_o
					Boolean: byn
					Boolean: bpovtor
					Number: naa
					Number: nFetchRes
					String: sFA
					String: ss
					String: sFileSimv[*]
					Number: nNumFiles
					Number: nI
					String: sDD
					Boolean: bYa
					String: sDirs[*]
					Number: nCount
					Number: nD
					String: sXdir
					String: sXname
					Boolean: bRabota
					String: sErr
					String: sTekPath
					Sql Handle: hSqlE
					Number: nM1
					Number: nM2
					Number: nM3
					Number: nF3
					Number: nF5
				Actions
					If nPar = 5 ! прием курсов из XLS
						Call SalStatusSetText(hWndForm, '')
						Call SalArraySetUpperBound(sFileSimv, 1, -1)
						Call SalUseRegistry(FALSE, '')
						Call SalGetProfileString('Common Parameters',     'CurRatesDir', '\\BARS98', ss, GetIniFileName())
						Call SalGetProfileString('Common Parameters',     'XlsRatesDir', '\\BARS98', sXdir, GetIniFileName())
						Set sXdir = sXdir || IifS(SalStrRightX(sXdir, 1)='\\', '',    '\\')
						Call SalGetProfileString('Common Parameters',    'XlsNameFile', 'nbgrates.xls', sXname,    GetIniFileName())
						Set sFA = ss || '\\2???????.xls'
						Set nNumFiles = VisDosEnumFiles(sFA, FA_Standard,    sFileSimv)
						If nNumFiles > 0
							Set nI = 0
							While nI < nNumFiles
								Set bRabota = TRUE
								Set bpovtor = FALSE
								Set byn = FALSE
								Set sFA = ss || '\\' || sFileSimv[nI]
								Set sDD = Subs(sFileSimv[nI], 7, 2) || '/' ||
										    Subs(sFileSimv[nI], 5, 2) || '/' ||
										    Left(sFileSimv[nI], 4)
								Set sDat = Subs(sDD, 4, 3) || Left(sDD, 3) ||
										    Right(sDD, 4)
								If not SalStrIsValidDateTime(sDD)
									! сообщение о некорректном имени файла
									Set sErr = 'It is impossible to accept rates for '
											    || sDD || '. The incorrect date (file ' ||
											    sFileSimv[nI] || ').'
									Call SaveErrorToLog(sErr)
									Call SalMessageBox(sErr, 'Error !',
											     MB_IconAsterisk | MB_Ok)
									! скопировать этот некорректный файл в NOT и удалить
									Set bYa = FALSE
									Call SalArraySetUpperBound(sDirs, 1, -1)
									Set nCount = VisDosEnumDirs(ss, sDirs)
									If nCount > 0
										Set nD = 0
										While nD < nCount
											If SalStrUpperX(sDirs[nD]) = 'NOT'
												Set bYa = TRUE
												Break
											Set nD = nD + 1
									If not bYa
										Call SalFileCreateDirectory(ss || '\\NOT')
									If File(ss || '\\NOT\\' || sFileSimv[nI])
										Call VisFileDelete(ss || '\\NOT\\' ||
												     sFileSimv[nI])
									Set nD = VisFileRename(sFA, ss || '\\NOT\\' ||
											    sFileSimv[nI])
									Set bRabota = FALSE
								If bRabota
									! удалить файл sXdir || sXname
									If File(sXdir || sXname)
										Call VisFileDelete(sXdir || sXname)
									If File(sXdir || sXname)
										! проверить нормально ли удалился:
												  если ДА, то продолжить обработку;
												  если НЕТ - выдать сообщение и выйти.
										Set sErr =
												    'It is impossible to accept the rates for ' ||
												    sDat || '. As appear the file ' || sXdir ||
												    sXname ||
												    ' is engaged by other appendix or user.'
										Call SaveErrorToLog(sErr)
										Call SalMessageBox (sErr, 'Error !',
												     MB_IconAsterisk | MB_Ok)
										Return FALSE
									! ОБРАБОТКА:
											  1. копия исходного файла в sXdir || sXname
											  2. обработка sXdir || sXname с помощью ODBC
											  3. НОРМАЛЬНО - копия исходного файла в BACKUP
											         ПЛОХО - копия исходного файла в NOT
									If VisFileCopy(sFA, sXdir || sXname) = 1
										Call SalFileGetCurrentDirectory(sTekPath)
										! Call Debug('XlsRatesDir = ' || Left(sXdir,
												     Len(sXdir)-1))
										Call SalFileSetCurrentDirectory(Left(sXdir,
												     Len(sXdir)-1))
										Set SqlDatabase = 'Excel_Files'
										! Call Debug('SqlDatabase = ' || SqlDatabase)
										! Call Debug('SqlUser = ' || SqlUser)
										! Call Debug('SqlPassword = ' || SqlPassword)
										Call SqlConnect(hSqlE)
										! Call Debug('connect')
										Call SqlPrepareAndExecute(hSqlE, "
												     SELECT Asc(F1),Asc(Mid(F1,2,1)),
												            Asc(Mid(F1,3,1)),F3,F5
												     FROM `Sheet2$`
												     INTO :nM1,:nM2,:nM3,:nF3,:nF5
												     WHERE F1 is not null")
										! Call Debug('SqlPrepareAndExecute')
										While SqlFetchNext(hSqlE, nFetchRes)
											Set nkv = GetKv(Chr(nM1) || Chr(nM2) ||
													    Chr(nM3))
											! Call DebugN(nkv)
											If nkv > 0
												Set naa = 0
												If SqlPrepareAndExecute(hSql(), T("
														     SELECT count(*)
														     FROM cur_rates
														     WHERE kv=:nkv and vdate= :sDat
														     INTO :naa"))
													Call SqlFetchNext(hSql(), nFetchRes)
												If naa > 0 and not bpovtor
													Set bpovtor = TRUE
													If SalMessageBox("TO REPLACE ?",
															   "The file " || sFA ||
															   " is accepted repeatedly !",
															   MB_YesNo | MB_IconHand) = IDNO
														Break
												Set nbsum = nF3
												Set nrate_o = nF5
												Call SalUpdateWindow(hWndForm)
												If naa = 0
													When SqlError
														Return FALSE
													If SqlPrepareAndExecute(hSql(), T("
															     INSERT
															     INTO cur_rates (kv,vdate,bsum,rate_o)
															     VALUES (:nkv, :sDat ,:nbsum,
															             :nrate_o)"))
														Call SaveFInfoToLog('Is added rate: ' ||
																     Str(nkv) || '(' || GetLcv(nkv) ||
																     ') - ' || sDat || '-' || Str(nbsum)
																     || '-' ||
																     SalNumberToStrX(nrate_o, 4))
													Else
														Set sErr = 
																    'Was not managed to add rate : ' ||
																    Str(nkv) || '(' || GetLcv(nkv) ||
																    ') - ' || sDat || ' - ' || Str(nbsum)
																    || ' - ' ||
																    SalNumberToStrX(nrate_o, 4)
														Call SaveErrorToLog(sErr)
														Call SalMessageBox (sErr, 'Error !',
																     MB_IconAsterisk | MB_Ok)
												Else
													When SqlError
														Return FALSE
													If SqlPrepareAndExecute(hSql(), T("
															     UPDATE cur_rates
															     SET bsum=:nbsum,rate_o=:nrate_o
															     WHERE kv=:nkv and vdate= :sDat "))
														Call SaveFInfoToLog('Is changed rate: ' ||
																     Str(nkv) || '(' || GetLcv(nkv) ||
																     ') - ' || sDat || '-' || Str(nbsum)
																     || '-' ||
																     SalNumberToStrX(nrate_o, 4))
													Else
														Set sErr =
																    'Was not managed to change rate: ' ||
																    Str(nkv) || '(' || GetLcv(nkv) ||
																    ') - ' || sDat || ' - ' || Str(nbsum)
																    || ' - ' ||
																    SalNumberToStrX(nrate_o, 4)
														Call SaveErrorToLog(sErr)
														Call SalMessageBox (sErr, 'Error !',
																     MB_IconAsterisk | MB_Ok)
												Set byn = TRUE
												Call SalStatusSetText(hWndForm,
														     sFileSimv[nI] || ': ' || GetLcv(nkv) ||
														     '(' || Right(Str(nkv+1000), 3) ||
														     ') the date ' || sDD || ' ' ||
														     SalNumberToStrX(nrate_o, 4) || ' (for '
														     || Str(nbsum) || ')')
												Call SalUpdateWindow(hWndForm)
										Call SqlDisconnect(hSqlE)
										Call SalFileSetCurrentDirectory(sTekPath)
										If byn
											Call SqlCommit(hSql())
											Call MessageNoWait('The rates for ' || sDD ||
													     ' - are accepted.', 'The message', 3, 0)
											Set bYa = FALSE
											Call SalArraySetUpperBound(sDirs, 1, -1)
											Set nCount = VisDosEnumDirs(ss, sDirs)
											If nCount > 0
												Set nD = 0
												While nD < nCount
													If SalStrUpperX(sDirs[nD]) = 'BACKUP'
														Set bYa = TRUE
														Break
													Set nD = nD + 1
											If not bYa
												Call SalFileCreateDirectory(ss || '\\BACKUP')
											If File(ss || '\\BACKUP\\' || sFileSimv[nI])
												Call VisFileDelete(ss || '\\BACKUP\\' ||
														     sFileSimv[nI])
											Set nD = VisFileRename(sFA, ss || '\\BACKUP\\'
													    || sFileSimv[nI])
									Else
										Set sErr = 'It is impossible to accept rates for '
												    || sDat || '. Error at copying of file ' ||
												    sFA || '.'
										Call SaveErrorToLog(sErr)
										Call SalMessageBox (sErr, 'Error !',
												     MB_IconAsterisk | MB_Ok)
										Return FALSE
								Set nI = nI + 1
							Call SalStatusSetText(hWndForm,
									     'The acception of rates is completed.')
							Call SalMessageBeep(-1)
							Call SalMessageBeep(MB_IconAsterisk)
							! Call Debug('The acception of rates is completed.')
							Return TRUE
						Else
							Call SalStatusSetText(hWndForm,
									     'Are away files of rates !')
							Call SalMessageBeep(-1)
							Call SalMessageBeep(MB_IconAsterisk)
							! Call Debug('Are away files of rates !')
							Return FALSE
					Else If not IsWindow(whGM)
						If nPar = 1	        ! формирование MAKV.dbf
							If not IsWindow( hWnd1 )
								Set hWnd1 = SalCreateWindow(georgia_makv, hWndMDI, nPar)
							Else
								Call SalBringWindowToTop(hWnd1)
						Else If nPar = 11	! формирование MAKVVAL.dbf
							If not IsWindow(hWnd1)
								Set hWnd1 = SalCreateWindow(georgia_makv, hWndMDI, nPar)
							Else
								Call SalBringWindowToTop(hWnd1)
						Else If nPar = 2	! заполнение альтернативных счетов
							If not IsWindow( hWnd2 )
								Set hWnd2 = SalCreateWindow(geo_tab, hWndMDI)
							Else
								Call SalBringWindowToTop( hWnd2 )
						!
						Else If nPar = 3	! прием и сверка с MPOZ_35.dbf
							If not IsWindow( hWnd3 )
								Set hWnd3 = SalCreateWindow(geo_mpoz, hWndMDI, DATETIME_Null )
							Else
								Call SalBringWindowToTop( hWnd3 )
						Else If nPar = 33	! 06-07-2010 
								                  прием и сверка с MPOZ_NOM.dbf 
								                  функция сравнения остатков на счетах в разрезе номиналов 
								                  с остатками на счетах в банковской системе
							If not IsWindow( hWnd33 )
								Set hWnd33 = SalCreateWindow(geo_NOM, hWndMDI, DATETIME_Null )
							Else
								Call SalBringWindowToTop( hWnd33 )
						If nPar = 4	! формирование файла MB2ддмм.dbf
							If not IsWindow( hWnd4 )
								Set hWnd4 = SalCreateWindow(geo_MB2, hWndMDI )
							Else
								Call SalBringWindowToTop( hWnd4 )
						Return TRUE
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbRelation
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: georgia_makv !! формирование MAKV.dbf
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.15"
				Top:    0.156"
				Width:  13.867"
				Width Editable? Class Default
				Height: 6.536"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.086"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39036
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.086"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.086"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'UnLoad DBF'
						On SAM_Click
							If dDab = GetBankDate() AND GetGlobalOptionEx('RRPDAY') = 1
								Call SalMessageBox('The bank day is open. Processing MAKV is prohibited!', 'Error!', MB_IconStop)
							Else
								If dDab = GetBankDate() and 
										SalMessageBox('Be sure that you already imported MPOZ_35.DBF on '||SalFmtFormatDateTime(dDab-1,'dd-MM-yyyy'), 
										'Notice', MB_IconQuestion|MB_YesNo) = IDNO
									Call SalDestroyWindow(hWndForm)
								! блок выгрузки
								Set SqlDatabase = 'dBase_Files'
								If SqlConnect(hSqlA)
									If nPar = 1
										Call SalWaitCursor(TRUE)
										Call VisFileDelete(sD0 || '.Dbf')
										Call SqlPrepareAndExecute(hSqlA, 
												"CREATE TABLE " || sD0 || " (
												   NU   CHAR(3),
												   NM   CHAR(1),
												   PDK  CHAR(1),
												   VOP  CHAR(2),
												   NDOC CHAR(3),
												   NLS  CHAR(9),
												   SUM  NUMBER(17),
												   NLSK CHAR(9),
												   NUK  CHAR(3),
												   USLNPACH CHAR(4) )")
										Set nRow = TBL_MinRow
										Set bFL = FALSE
										While SalTblFindNextRow(hWndForm, nRow, 0, 0)
											Call SalTblFetchRow(hWndForm, nRow)
											Set bFL = SqlPrepareAndExecute(hSqlA, 
													"INSERT INTO " || sD0 || "
													 VALUES (:georgia_makv.colNU, :georgia_makv.colNM,
													   :georgia_makv.colPDK, :georgia_makv.colVOP,
													   :georgia_makv.colNDOC, :georgia_makv.colNLS,
													   :georgia_makv.colS, :georgia_makv.colNLSK,
													   :georgia_makv.colNUK, :georgia_makv.colUSLNPACH)")
										If bFL
											Call SqlCommit(hSqlA)
										Else
											Call SqlRollback(hSqlA)
										Call SqlDisconnect(hSqlA)
										Call VisFileDelete(sD1)
										Call VisFileCopy(VisFileFind(sD0 || '.Dbf'), sD1)
										Call SalWaitCursor(FALSE)
										If VisFileFind(sD1) != ''
											Call MessageNoWait('Создание ' || sD1 || ' успешно завершено !', 'Сообщение', 1, 0)
											Call SalWaitCursor(TRUE)
											If WriteNumericMem('', nSu/100, 2, sMemVar, sPath ||   sD0 || '.Mem')
												Call SalWaitCursor(FALSE)
												Call MessageNoWait('Создание ' || sPath || sD0 || '.Mem успешно завершено !', 'Сообщение', 1, 0)
												Call SalDisableWindow(hWndItem)
										Call SalWaitCursor(TRUE)
										Call VisFileDelete(VisFileFind(sD0 || '.Dbf'))
									Else If nPar = 11
										Call SalWaitCursor(TRUE)
										Call VisFileDelete(sD0 || '.Dbf')
										Call SqlPrepareAndExecute(hSqlA, 
												"CREATE TABLE " || sD0 || " (
												   NM   CHAR(1),
												   PDK  CHAR(1),
												   NDOC CHAR(3),
												   NLS  CHAR(9),
												   SUM  NUMBER(17),
												   NLSK CHAR(9),
												   VAL  char(3),
												   DAT  char(6),
												   REF  number(17) )")
										Set nRow = TBL_MinRow
										Set bFL = FALSE
										While SalTblFindNextRow(hWndForm, nRow, 0, 0)
											Call SalTblFetchRow(hWndForm, nRow)
											Set bFL = SqlPrepareAndExecute(hSqlA, 
													"INSERT INTO " || sD0 || "
													 VALUES (:georgia_makv.colNM, :georgia_makv.colPDK, 
													   :georgia_makv.colNDOC, :georgia_makv.colNLS,
													   :georgia_makv.colSn, :georgia_makv.colNLSK,
													   :georgia_makv.colLCV, :georgia_makv.sDat6, :georgia_makv.colREF)")
										If bFL
											Call SqlCommit(hSqlA)
										Else
											Call SqlRollback(hSqlA)
										Call SqlDisconnect(hSqlA)
										Call VisFileDelete(sD1)
										Call VisFileCopy(VisFileFind(sD0 || '.Dbf'), sD1)
										Call SalWaitCursor(FALSE)
										If VisFileFind(sD1) != ''
											Call MessageNoWait('Создание ' || sD1 || ' успешно завершено !', 'Сообщение', 1, 0)
											Call SalWaitCursor(TRUE)
											! If WriteNumericMem('', nSu/100, 2, sMemVar, sPath ||   sD0 || '.Mem')
												        Call SalWaitCursor(FALSE)
												        Call MessageNoWait('Создание ' || sPath || sD0 || '.Mem успешно завершено !', 'Сообщение', 1, 0)
												        Call SalDisableWindow(hWndItem)
										Call SalWaitCursor(TRUE)
										Call VisFileDelete(VisFileFind(sD0 || '.Dbf'))
									Call SalWaitCursor(FALSE)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.086"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Create
							          Set s19='000019404'
							          Set strTip = 'Лицевой счет '||s19 
						! On SAM_Click
							! вызов функции печати
							          Call SalWaitCursor(TRUE)
							          Set nInd = 0
							          Call SalReportPrintToFile(hWndForm, GetTemplateDir() ||
									     "\\019404.QRP", GetPrnDir() || "\\019404.txt" ,
									     'nREF,sTT,S,NLS,SQ,sDebug,nSa,nSu',
									     'REF,ISO,S,NLS,SQ,NAZN,S1,S2', 
									     1, RPT_PrintAll,1, 1, FALSE, nInd)
							          Call SalWaitCursor( FALSE )
							          Call SalLoadAppAndWait("Look.Bat " || GetPrnDir() ||
									     "\\Pereoc.txt", Window_Normal, nInd)
							! конец
				Line
					Resource Id: 39037
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39038
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbGeo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.586"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Account Gel-ODB'
						On SAM_Click
							If not IsWindow( hWnd2 )
								Set hWnd2 = SalCreateWindow(geo_tab, hWndMDI)
							Else
								Call SalBringWindowToTop( hWnd2 )
				Pushbutton: pbREF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.086"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'View Documents'
						On SAM_Click
							Call DocViewContentsEx( hWndMDI, georgia_makv.colREF )
				Combo Box: dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 2.802"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Call SalListPopulate(dat, hSql(), "SELECT TO_CHAR(fdat, 'DD-MM-YYYY') FROM fdat ORDER BY fdat DESC" )
							! Set dat = GetValueStr(" SELECT TO_CHAR(max(fdat), 'DD-MM-YYYY') FROM fdat")
							! Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
						On SAM_Click
							! Set sDat = SalStrMidX(dat,3,2) || '-' ||  SalStrMidX(dat, 0, 2) || '-' || SalStrMidX(dat, 6, 4)
							Set dDab = SalFmtFormatStrDateTime(dat, 'dd-MM-yyyy')
							Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: colREF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ref
						ABS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colTT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Op
						ABS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CCy
						ABS
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Sum
						Nominal
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: DEBET
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CREDIT
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Sum
						EQV
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Fil_D
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNUK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: FIL_C
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Mak
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPDK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: DK
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colVOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Vid
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: #
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colUSLNPACH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ##
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Lcv
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar
		Window Variables
			String: sRegPath
			String: sPath
			String: sD0
			String: sD1
			Sql Handle: hSqlA
			Date/Time: dDab
			Date/Time: dDam1
			Number: nFetchRes
			Number: nSu
			Number: nS
			Number: nSn
			Number: nSa
			Number: nKv
			Number: nRow
			Number: nTmp
			String: sNd
			String: sNLSD
			String: sNLSK
			Number: nNLSK
			Number: nREF
			String: sTT
			String: sBal
			String: sMemVar
			String: sKod3
			Boolean: bFL
			String: sDebug
			! String: sDat
			String: sDat6
			!
			Number: nInd
			Number: KV
			String: NLS
			Number: S
			Number: SQ
			Number: KOL
			String: sTmp
			String: s19
			Date/Time: dTmp
			Window Handle: hW
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, IifS(nPar=1, 
						     'Выгрузка информации в Makv.Dbf и Makv.Mem',
						     'Выгрузка информации в Makvval.Dbf'))
				Set nFlags = GT_NoDel  | GT_NoUpd | GT_NoIns
				! Константы
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('RegionalSettings', 'RevaluationNLS', '19404', sBal, GetIniFileName())
				Set sBal = SalStrRepeatX ('0', 9-Len(sBal)) || sBal
				!
				Call SalGetProfileString('RegionalSettings', 'MakvPath', GetPrnDir(), sRegPath, GetIniFileName())
				If Right(sRegPath, 1) != '\\'
					Set sRegPath = sRegPath || '\\'
				!
				Call SalGetProfileString('RegionalSettings', 'MakvName', 'Makv', sD0, GetIniFileName())
				Call SalGetProfileString('RegionalSettings', 'MakvMemVariable',  'M_SUM', sMemVar, GetIniFileName())
				!
				Set sKod3 = Right(GetBankMfo(), 3)
				!
				Call SalDisableWindow(pbPrint)
				Call SalDisableWindow(pbREF)
				If nPar = 1
					Call SalHideWindow(colLCV)
				Else If nPar = 11
					Call SalHideWindow(colVOP)
					Call SalHideWindow(colNUK)
					Call SalHideWindow(colKV)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_User
				If dat != STRING_Null and nPar = 1
					Call SalCreateWindow(geo_mpoz, hWndMDI, dDab)
				Set sPath = sRegPath || SalFmtFormatDateTime(dDab, 'yyyyMMdd')
				Call SalFileCreateDirectory(sPath)
				Set sPath = sPath || '\\'
				Call SalWaitCursor(TRUE)
				! Очистка и Реальные проводки в промежуточную таблицу
				If nPar = 1
					Set sD1    = sPath || sD0 || '.Dbf'
					Set sDebug = Right(Str(SalNumberRandom()+100000), 4)
					Set dDam1  = dDab -1
					If SqlPrepareAndExecute(hSql(), "DELETE FROM makvo")
						If SqlPrepareAndExecute(hSql(),
								"INSERT INTO makvo (tt, ref, kv, nm, nd, nls, nlsk, sn, s, vop, nuk)
								 SELECT od.tt, od.ref, k.kv, '1','000', 
								        substr('000'||NVL(gd.nls,''),-9), substr('000'||NVL(gk.nls,''),-9), 
								        NVL(od.s,0), od.sq , '01' , :sKod3
								   FROM (select o.REF,o.TT,o.DK,o.ACC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is not null and substr(a.nbs,1,1)<>'0'
								            and o.fdat = :dDab
								          union all
								         select o.REF,o.TT,o.DK,a.ACCC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is null and a.accc is not null
								            and o.fdat = :dDab) od, 
								        (select o.REF,o.TT,o.DK,o.ACC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is not null and substr(a.nbs,1,1)<>'0'
								            and o.fdat = :dDab
								          union all
								         select o.REF,o.TT,o.DK,a.ACCC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is null and a.accc is not null
								            and o.fdat = :dDab) ok, geo_tab gd, geo_tab gk, accounts k
								  WHERE od.fdat = :dDab AND od.sos = 5 AND od.acc = k.acc
								    AND od.ref = ok.ref AND od.stmt = ok.stmt
								    AND od.acc = gd.acc(+) AND od.dk = 0 AND ok.acc = gk.acc(+) AND ok.dk = 1 ")
							If SqlPrepareAndExecute(hSql(), "SELECT SUM(s) INTO :nSu FROM makvo")
									and SqlFetchNext(hSql(), nFetchRes)
								If SqlPrepareAndExecute(hSql(), "INSERT INTO makvo (nm, s, pach) VALUES ('6', :nSu, :sDebug)")
									If SqlCommit(hSql()) 
										Set strSqlPopulate = 
												"SELECT m.tt, m.ref, m.kv, " || sKod3 || ", m.nm, '1', m.vop, m.nd,
												        m.nls, m.s, m.sn, m.nlsk, m.nuk, m.pach 
												   FROM makvo m  
												   INTO :georgia_makv.colTT,  :georgia_makv.colREF,
												        :georgia_makv.colKV,  :georgia_makv.colNU,
												        :georgia_makv.colNM,  :georgia_makv.colPDK,
												        :georgia_makv.colVOP, :georgia_makv.colNDOC,
												        :georgia_makv.colNLS, :georgia_makv.colS,
												        :georgia_makv.colSn,  :georgia_makv.colNLSK,
												        :georgia_makv.colNUK, :georgia_makv.colUSLNPACH
												  ORDER BY nm DESC, ref, nls, nlsk, kv "
										Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
									Else
										Call SqlRollback(hSql())
								Else
									Call SqlRollback(hSql())
							Else
								Call SqlRollback(hSql())
						Else
							Call SqlRollback(hSql())
					Else
						Call SqlRollback(hSql())
				Else If nPar = 11
					Set sD0 = 'Makvval'
					Set sD1 = sPath || sD0 || '.Dbf'
					Set sDat6 = SalFmtFormatDateTime(dDab, 'yyMMdd')
					If SqlPrepareAndExecute(hSql(), "DELETE FROM makvo")
						If SqlPrepareAndExecute(hSql(),
								"INSERT INTO makvo (tt, ref, kv, nm, nd, nls, nlsk, sn, s)
								 SELECT od.tt, od.ref, ak.kv, '1', '000', 
								        substr('000'||NVL(gd.nls,''),-9), substr('000'||NVL(gk.nls,''),-9), 
								        NVL(od.s,0), od.sq
								   FROM (select o.REF,o.TT,o.DK,o.ACC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is not null and substr(a.nbs,1,1)<>'0'
								            and o.fdat = :dDab
								          union all
								         select o.REF,o.TT,o.DK,a.ACCC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is null and a.accc is not null
								            and o.fdat = :dDab) od,
								        (select o.REF,o.TT,o.DK,o.ACC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is not null and substr(a.nbs,1,1)<>'0'
								            and o.fdat = :dDab
								          union all
								         select o.REF,o.TT,o.DK,a.ACCC,o.FDAT,o.S,o.SQ,o.TXT,o.STMT,o.SOS
								           from opldok o, accounts a
								          where o.acc=a.acc and a.nbs is null and a.accc is not null
								            and o.fdat = :dDab) ok, geo_tab gd, geo_tab gk, accounts ak
								  WHERE od.fdat = :dDab AND od.sos = 5 AND od.acc = ak.acc
								    AND od.ref = ok.ref AND od.stmt = ok.stmt
								    AND od.acc = gd.acc(+) AND od.dk = 0
								    AND ok.acc = gk.acc(+) AND ok.dk = 1
								    and od.s  <> 0
								    and od.tt <> 'PVP'")
							If SqlPrepareAndExecute(hSql(), "SELECT SUM(s), sum(sn) INTO :nSu, :nSn FROM makvo")
									and SqlFetchNext(hSql(), nFetchRes)
								If SqlPrepareAndExecute(hSql(), "INSERT INTO makvo (nm, s) VALUES ('6', :nSu)")
									If SqlCommit(hSql()) 
										Set strSqlPopulate = 
												"SELECT m.tt, m.ref, " || sKod3 || ", m.nm, '1', m.nd,
												        m.nls, m.s, m.sn, m.nlsk, t.lcv
												   INTO :georgia_makv.colTT,  :georgia_makv.colREF, :georgia_makv.colNU,
												        :georgia_makv.colNM,  :georgia_makv.colPDK, :georgia_makv.colNDOC,
												        :georgia_makv.colNLS, :georgia_makv.colS,   :georgia_makv.colSn,
												        :georgia_makv.colNLSK,:georgia_makv.colLCV
												   FROM makvo m, tabval t
												  where m.kv = t.kv(+)
												  ORDER BY nm DESC, ref, nls, nlsk "
										Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
									Else
										Call SqlRollback(hSql())
								Else
									Call SqlRollback(hSql())
							Else
								Call SqlRollback(hSql())
						Else
							Call SqlRollback(hSql())
					Else
						Call SqlRollback(hSql())
				! Call SalDisableWindow(pbPrint)
				Call SalWaitCursor(FALSE)
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If strSqlPopulate
					Call SalWaitCursor(TRUE)
					Call SalEnableWindow(pbDetails)
					Call SalEnableWindow(pbPrint)
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Call SalTblPopulate(hWndForm, hSql(), strSqlPopulate, TBL_FillAll)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			On SAM_TblDoDetails
				If colREF != NUMBER_Null and colTT != 'PVP'
					Call SalEnableWindow(pbREF)
				Else
					Call SalDisableWindow(pbREF)
			On SAM_FetchRowDone
				If georgia_makv.colUSLNPACH != STRING_Null
					Set georgia_makv.colUSLNPACH = '1155'
				If colNLS = STRING_Null or colNLSK = STRING_Null
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 )  )
			On SAM_CaptionDoubleClick
				Return FALSE
			On SAM_ReportStart
				Call SqlPrepareAndExecute(hSql(),
						"SELECT m.ref,t.lcv,m.sn, 
						        decode( m.nls, :s19, m.nlsk, m.nls ),
						        decode(m.nls, :s19, -m.s, m.s ),
						        decode(m.ref,NULL,'Kurs',substr(o.nazn,1,15)) 
						   INTO :nREF,:sTT,:S,:NLS,:SQ,:sDebug
						   FROM makvo m, oper o  ,tabval t
						  WHERE m.kv = t.kv(+) AND m.ref = o.ref(+)
						    AND m.nls <> m.nlsk AND (m.nls=:s19 OR m.nlsk=:s19)
						  ORDER BY 5 ")
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				If SqlFetchNext(hSql(), nTmp)
					If SQ<0
						Set nSa = -SQ
						Set nSu = 0
					Else
						Set nSu = -SQ
						Set nSa = 0
					Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
			On SAM_ReportNotify
				If lParam = RPT_BeforeReportHeader
					Set hW=SalNumberToWindowHandle(wParam)
					Call SqlPrepareAndExecute( hSqlAux2(),
							"SELECT sum( gl.p_icurval(s.kv,s.ost,fdat)) 
							 INTO :nS  FROM sal s, geo_tab g  WHERE g.acc=s.acc AND s.fdat=:dDam1 ")
					If SqlFetchNext(hSqlAux2(), nTmp)
						Call SalReportSetNumberVar( hW,'VS', nS )
					Call SalReportSetDateTimeVar( hW,'DATP',dDam1)
					Call SalReportSetDateTimeVar( hW,'DAT', dDab)
				If lParam = RPT_BeforeReportFooter
					Call SqlPrepareAndExecute( hSqlAux2(),
							"SELECT sum( gl.p_icurval(s.kv,s.ost,fdat)) 
							 INTO :nS  FROM sal s, geo_tab g  WHERE g.acc=s.acc AND s.fdat=:dDab ")
					If SqlFetchNext(hSqlAux2(), nTmp)
						Call SalReportSetNumberVar( hW,'VYS', nS )
	Table Window: geo_tab  !! заполнение связки с ОДБ (geoab)
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Заполнение счетов-эквивалентов в ОДБ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.188"
				Top:    0.094"
				Width:  13.367"
				Width Editable? Class Default
				Height: 6.667"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19490
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19491
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.95"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19492
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: colAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CCy
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Bal
						new
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: X9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Details
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Account 
						ABS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Saldo
						ABS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Bal
						old
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLSgeo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Account
						ODB
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNLSgeoTRUE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: State
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Name
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Number: nFetchRes
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Set geo_tab.nTabInstance=1
				If SqlPrepareAndExecute(hSql(), 
						   "INSERT INTO geo_tab (acc,nls) SELECT acc, substr(nlsalt,1,9) 
						    FROM accounts WHERE acc not in (SELECT acc FROM geo_tab) " )
					Call SqlCommit(hSql())
				Set geo_tab.strPrintFileName='BARS_ODB'
				Set geo_tab.strSqlPopulate = 
						"SELECT a.acc, a.kv, a.nls, a.ostc/100, a.nms, g.nls, a.NBS, substr(a.nlsalt, -6,3), Substr(a.nls,6,9)
						 INTO :geo_tab.colAcc,:geo_tab.colKv,:geo_tab.colNLS,:geo_tab.colOST,
						      :geo_tab.colName,:geo_tab.colNLSgeo, :geo_tab.B4, :geo_tab.B3, :geo_tab.X9
						 FROM accounts a, geo_tab g WHERE a.dazs is null and a.acc=g.acc (+) and 
						      a.nbs is not null and substr(a.nbs,1,1)<>'0'  
						 ORDER BY a.daos desc, a.kv "
				Set geo_tab.strSqlUpdate = 
						"UPDATE accounts SET nlsalt=:geo_tab.colNLSgeo WHERE acc=:geo_tab.colAcc"
				! Set geo_tab.strSqlUpdate = 
						"UPDATE geo_tab SET nls=:geo_tab.colNLSgeo WHERE acc=:geo_tab.colAcc"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If geo_tab.colNLSgeo = STRING_Null
					Set colNLSgeoTRUE='?'
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle  )
				Else
					If SqlPrepareAndExecute( hSql(), 
							   "SELECT '+' INTO :colNLSgeoTRUE FROM mpoz_35 WHERE nls1=:colNLSgeo" ) 
							AND NOT SqlFetchNext( hSql(), nFetchRes )
						Set colNLSgeoTRUE='-'
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua  )
	! cGenericTable: geo_nps !! заполнение альтернативных счетов
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Лицевой счет в НОВОМ плате счетов
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.563"
				Top:    0.083"
				Width:  9.629"
				Width Editable? Yes
				Height: 6.667"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 3000
			Discardable? No
.end
		              Description: 
		              Named Menus 
		              Menu 
		              Tool Bar 
			              Contents 
				              Pushbutton: pbIns
					              Message Actions 
				              Pushbutton: pbDel
					              Message Actions 
				              Pushbutton: pbRefresh
					              Message Actions 
				              Pushbutton: pbUpdate
					              Message Actions 
				              Line 
				              Pushbutton: pbSearch
					              Message Actions 
				              Pushbutton: pbDetails
					              Message Actions 
				              Pushbutton: pbPrint
					              Message Actions 
				              Line 
				              Pushbutton: pbExit
					              Message Actions 
				              Line 
				              Pushbutton: pbFilter
					              Message Actions 
		              Contents 
			              Column: colAcc
				              List Values 
				              Message Actions 
			              Column: colKv
				              List Values 
				              Message Actions 
			              Column: colISO
				              List Values 
				              Message Actions 
			              Column: colNLS
				              List Values 
				              Message Actions 
			              Column: colName
				              List Values 
				              Message Actions 
			              Column: colNLSALT
				              List Values 
				              Message Actions 
		              Functions 
		              Window Parameters 
		              Window Variables 
		              Message Actions 
			              On SAM_Create
				              Call SalDisableWindow(SalParentWindow(hWndForm))
				              Set geo_nps.strSqlPopulate = "
						    SELECT a.acc,a.kv,t.lcv,a.nls,a.nms,a.nlsalt
						    INTO :geo_nps.colAcc,
						         :geo_nps.colKv, :geo_nps.colISO,
						         :geo_nps.colNLS,
						         :geo_nps.colName,:geo_nps.colNLSALT
						    FROM accounts a, tabval t
						    WHERE a.dazs is null and a.kv=t.kv
						    ORDER BY a.nlsalt DESC ,a.nls+0, a.kv"
				              Set geo_nps.strSqlUpdate = "
						    UPDATE accounts
						    SET nlsalt=:geo_nps.colNLSALT
						    WHERE acc=:geo_nps.colAcc"
				              Call SalSendClassMessage(SAM_Create, 0, 0)
			              On SAM_Destroy
				              Call SalEnableWindow(SalParentWindow(hWndForm))
				! Disactivation of  function's role, which activated for calling window
				              If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
					              Call XRoleUnset(hSql(),' Geo_makv(2) ')
				              Call SalSendClassMessage(SAM_Destroy, 0, 0)
	Table Window: geo_mpoz  !! прием и сверка с MPOZ_35.dbf
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: ABS <--> ODB ( MPOZ_35.dbf )
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.49"
				Top:    0.65"
				Width:  10.717"
				Width Editable? Class Default
				Height: 6.536"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.886"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = ' Показать ВСЮ таблицу '
						On SAM_Click
							Call F_TAB('')
							Call ENA(pbDel)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.386"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = ' Показать только РАЗНИЦУ ' 
						On SAM_Click
							Call F_TAB('WHERE s1<>s2')
							Call ENA(pbIns)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39033
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.386"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.186"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.886"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = ' Печать таблицы '
							Set geo_mpoz.strPrintFileName='Mpoz_35.txt'
				Line
					Resource Id: 39034
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.786"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39035
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.786"
						Top:    0.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 2.177"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If dDAT!=DATETIME_Null
								If dDAT=GetBankDate(  )
									Set dDab=dDAT-1
								Else
									Set dDab=dDAT
								Call SalListAdd( hWndItem, SalFmtFormatDateTime(dDab, 'dd-MM-yyyy' ))
								Call SalListSetSelect( hWndItem, 0 )
								Call SalDisableWindow( dat )
							Else
								Call SalListPopulate(dat, hSql(), T("
										     SELECT TO_CHAR(fdat, 'DD-MM-YYYY') FROM fdat ORDER BY fdat DESC"))
						On SAM_Click
							Set dDab = SalFmtFormatStrDateTime( dat, 'dd-MM-yyyy')
							Call SalSendMsg(hWndForm, SAM_User, 0, 0)
							! Call SalDisableWindow(geo_mpoz.dat)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.686"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: GEL- acc
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CUR-acc
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: GEL-
						balance
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CUR-EQV
						balance
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Delta
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: STROKA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nTemp
				Actions
					! выбрать из MPOZ_35
					Return 
							    SqlPrepareAndExecute(hSql(),"INSERT INTO mpoz_35 (nls1,s1) VALUES (:sNLS,:nS)" )
							and SqlPrepareAndExecute(hSql(), 
							   "SELECT g.nls, NVL(sum(s.OSTQ),0)/100 INTO :sNLS, :nS
							    FROM salQ s, geo_tab g 
							    WHERE g.acc=s.acc and to_number(g.nls)=to_number(:sNLS) and s.fdat=:dDab
							    GROUP BY g.nls ")
							and SqlFetchNext(hSql(), nFetchRes) 
							and SqlPrepareAndExecute(hSql(),
							   "UPDATE mpoz_35 SET nls2=:sNLS, s2=:nS WHERE to_number(nls1)=to_number(:sNLS) ")
			Function: F_TAB
				Description:
				Returns
				Parameters
					String: WHE
				Static Variables
				Local variables
					Number: n3
				Actions
					Call DISA()
					Call SalTblSetLockedColumns( hWndForm, 4 )
					Set I1=0
					Set I2=0
					Set I3=0
					If SalTblPopulate( hWndForm, hSql(),
							  "SELECT nls1, s1, nls2, s2, substr(nls1,4,3)
							   INTO :NLS1,:S1,:NLS2,:S2, :n3
							   FROM mpoz_35  "||WHE||" 
							   UNION ALL
							   SELECT to_char(NULL), to_number(NULL), g.nls, nvl(sum(s.OSTQ),0)/100, substr(g.nls,-6,3)
							   FROM salq s, geo_tab g
							   WHERE s.acc=g.acc(+) AND s.ostq<>0 AND s.fdat =:dDab AND
							         s.acc NOT IN (SELECT a.acc FROM mpoz_35 m, accounts a 
							                       WHERE m.nls1=a.nlsalt AND a.nlsalt IS NOT NULL)
							   GROUP BY g.nls  
							   ORDER BY 5 ", TBL_FillAll )
						Call SalWaitCursor( FALSE )
						Call SalTblDefineSplitWindow( hWndForm, 1, FALSE )
						Set nFetchRes= SalTblInsertRow( hWndForm, TBL_MinRow )                       
						Call SalTblSetContext ( hWndForm, nFetchRes )
						Call SalTblSetRowFlags( hWndForm, nFetchRes, ROW_New,FALSE  )
						Set NLS1='Total'
						Set S1=I1
						Set S2=I2
						Set S3=I3
						Return TRUE
					! If SalTblPopulate( hWndForm, hSql(),
							  "SELECT nls1,s1,nls2,s2,substr(nls1,4,3)+0
							   INTO :NLS1,:S1,:NLS2,:S2, :n3
							    FROM mpoz_35 "||WHE||" 
							    UNION ALL
							    SELECT To_CHAR(NULL), To_NUMBER(NULL), 
							         g.nls, NVL(sum(s.OSTQ),0)/100, substr(g.nls,-6,3)+0
							    FROM salQ s, geo_tab g 
							    WHERE s.acc=g.acc (+) and s.ostq<>0 and  s.fdat = :dDab  and 
							         to_number(s.nls) NOT IN (SELECT to_number(nls1) FROM mpoz_35 m)  
							    GROUP BY g.nls  ORDER BY 5", TBL_FillAll )
						         Call SalWaitCursor( FALSE )
						         Call SalTblDefineSplitWindow( hWndForm, 1, FALSE )
						         Set nFetchRes= SalTblInsertRow( hWndForm, TBL_MinRow )                       
						         Call SalTblSetContext ( hWndForm, nFetchRes )
						         Call SalTblSetRowFlags( hWndForm, nFetchRes, ROW_New,FALSE  )
						         Set NLS1='ITOG'
						         Set S1=I1
						         Set S2=I2
						         Set S3=I3
						         Return TRUE
			Function: DISA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Call SalDisableWindow(pbPrint)
					Call SalDisableWindow(pbIns)
					Call SalDisableWindow(pbDel)
					Call SalDisableWindow(pbSearch)
					Return TRUE
			Function: ENA
				Description:
				Returns
				Parameters
					Window Handle: hWpb
				Static Variables
				Local variables
				Actions
					Call SalEnableWindow(hWpb)
					Call SalEnableWindow(pbPrint)
					Call SalEnableWindow(pbSearch)
					Call SalWaitCursor(FALSE)
					Return TRUE
			Function: MAK5_OK
				Description:
				Returns
				Parameters
					Date/Time: dDab
				Static Variables
				Local variables
					String: sPath
					String: sOdir
					String: sD1
					Sql Handle: hSqlB
					String: sVOB
					Number: nVOB
					String: sNLS
					Number: nExist
				Actions
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString('RegionalSettings','MakvPath',GetPrnDir(),sPath,GetIniFileName())
					Set sPath=sPath||'\\'||SalFmtFormatDateTime( dDab,'yyyyMMdd')
					Set sD1 = sPath||'\\MAK5_OK.DBF'
					Call SalFileGetCurrentDirectory(sOdir)
					Call SalFileSetCurrentDirectory(sPath)
					If File(sD1) !! если есть файл
						Call SalMessageBox('Принимаем файл ' || sD1 || '!', 'Attention!', MB_IconAsterisk | MB_Ok )
						Set SqlDatabase = 'dBase_Files'
						If SqlConnect( hSqlB )  !! есть связь с ODBC 
							If SqlPrepareAndExecute(hSqlB,"SELECT nls, vobr INTO :sNLS, :sVOB FROM mak5_ok") 
								While SqlFetchNext( hSqlB, nFetchRes )
									Set nVOB = SalStrToNumber(sVOB)
									If SqlPrepareAndExecute(hSql(),"SELECT 1 INTO :nExist FROM mpoz_35 WHERE nls1=:sNLS") 
											AND NOT SqlFetchNext( hSql(), nFetchRes )
										Set nExist=0
									If nVOB=5 AND nExist=0
										If SqlPrepareAndExecute(hSql(),"INSERT INTO mpoz_35 (nls1) VALUES (:sNLS)")
											Call SqlCommit( hSql() )
									If nVOB=8 AND nExist=1
										If SqlPrepareAndExecute(hSql(),"DELETE FROM mpoz_35 WHERE nls1=:sNLS")
											Call SqlCommit( hSql() )
								Call SqlDisconnect( hSqlB )
								Call SalMessageBox('Обработан!', 'Attention!', MB_IconAsterisk | MB_Ok )
					Else
						Call SalMessageBox('Отсутствует файл !',sD1, MB_IconAsterisk | MB_Ok )
		Window Parameters
			Date/Time: dDAT
		Window Variables
			String: sPath
			String: sOdir
			Sql Handle: hSqlA
			String: sD0
			String: sD1
			Date/Time: dDab
			Number: nFetchRes
			!
			Number: nS
			String: sNLS
			Number: I1
			Number: I2
			Number: I3
		Message Actions
			On SAM_Create
				Call DISA()
				Call XSalTooltipSetUserDefault()
				Call PrepareWindowEx(hWndForm)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If dDAT!=DATETIME_Null
					Call SalSendMsg(dat, SAM_Click, 0, 0)
			On SAM_User
				Call DISA()
				Call SalSetWindowText(hWndForm, 'Comparing with MPOZ_35.dbf on ' || SalFmtFormatDateTime( dDab,'dd-MM-yyyy'))
				! Константы
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('RegionalSettings', 'MakvPath',GetPrnDir(), sPath, GetIniFileName())
				Set sPath = sPath || '\\' || SalFmtFormatDateTime(dDab, 'yyyyMMdd')
				Set sD1   = sPath || '\\MPOZ_35.dbf'
				Call SalFileGetCurrentDirectory(sOdir)
				Call SalFileSetCurrentDirectory(sPath)
				If File(sD1) !! если есть файл
					If SqlPrepareAndExecute(hSql(), "DELETE FROM mpoz_35")  
						Set SqlDatabase = 'dBase_Files'
						If SqlConnect( hSqlA )  !! есть связь с ODBC 
							If SqlPrepareAndExecute(hSqlA, "SELECT nls,sumo INTO :sNLS,:nS FROM mpoz_35") 
								While SqlFetchNext( hSqlA, nFetchRes )
									Call STROKA()
								!
								Call SqlCommit( hSql() )
								Call SqlDisconnect( hSqlA )
								Call SalSendMsg( pbDel, SAM_Click, 0,0 )
								!
								If dDAT = GetBankDate( )
									Call MAK5_OK( dDAT )
									Call F_TAB('WHERE s1<>s2')
					Else
						Call SqlRollback(hSql())
				Else
					Call SalMessageBox('Отсутствует файл !',sD1, MB_IconAsterisk | MB_Ok )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set S3=S1-S2
				Set I1=I1+S1
				Set I2=I2+S2
				Set I3=I3+S3
				If S1 != S2 
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 )  )
			On SAM_Destroy
				Call SalFileSetCurrentDirectory(sOdir)
	Table Window: geo_NOM  ! 06-07-2010 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Crosscheck with GEO ODB throths MPOZ_NOM.dbf
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.288"
				Top:    1.969"
				Width:  13.983"
				Width Editable? Class Default
				Height: 7.583"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.893"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.586"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 52817
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.186"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = ' Print Table '
							Set geo_NOM.strPrintFileName='Mpoz_NOM.txt'
				Line
					Resource Id: 52818
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 52819
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   1.883"
						Top:    0.071"
						Width:  2.3"
						Width Editable? Yes
						Height: 2.012"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If dDAT != DATETIME_Null
								If dDAT=GetBankDate(  )
									Set dDab=dDAT-1
								Else
									Set dDab=dDAT
								Call SalListAdd( hWndItem, SalFmtFormatDateTime(dDab, 'dd-MM-yyyy' ))
								Call SalListSetSelect( hWndItem, 0 )
								Call SalDisableWindow( dat )
							Else
								Call SalListPopulate(dat, hSql(), 
										"SELECT TO_CHAR(fdat, 'DD-MM-YYYY') FROM fdat 
										 where fdat >= to_date('01-01-2010','dd-mm-yyyy') 
										ORDER BY fdat DESC")
						On SAM_Click
							Set dDab = SalFmtFormatStrDateTime( dat, 'dd-MM-yyyy')
							Call SalSetWindowText( geo_NOM, dat || ': Crosscheck with GEO ODB throths MPOZ_NOM.dbf' )
							Call SalSendMsg(hWndForm, SAM_User, 0, 0)
							! Call SalDisableWindow(geo_NOM.dat)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.686"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Data Field: sTxt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.071"
							Width:  5.7"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.483"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: mNLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.283"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: mLCV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.283"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Frame
					Resource Id: 53213
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.405"
						Width:  10.9"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Ok
					Window Location and Size
						Left:   0.583"
						Top:    0.488"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: White
					Message Actions
						On SAM_Click
							Call F_TAB(' WHERE sumo=ost ')
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Delta sum
					Window Location and Size
						Left:   1.883"
						Top:    0.488"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Maize
					Message Actions
						On SAM_Click
							Call F_TAB(' WHERE sumo<> ost ')
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Not in MPOZ_NOM
					Window Location and Size
						Left:   4.283"
						Top:    0.488"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_Click
							Call F_TAB(' WHERE sumo is null ')
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Not in Bars
					Window Location and Size
						Left:   6.683"
						Top:    0.488"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Orchid
					Message Actions
						On SAM_Click
							Call F_TAB(' WHERE ost is null ')
				Radio Button: rb5
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: All Delta
					Window Location and Size
						Left:   9.083"
						Top:    0.488"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_TAB('WHERE nvl(sumo,0) <> nvl(ost,0)')
				Radio Button: rb6
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: All
					Window Location and Size
						Left:   10.483"
						Top:    0.488"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_TAB('')
		Contents
			Column: LCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ISO
						lit
						
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ISO
						num
						
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
						Mpoz_NOM =
						Bars_Alt
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_BARS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: min ACC
						in Bars 
						
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL_BARS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: count ACC
						in Bars 
						
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: BALANCE
						Mpoz_NOM
						
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: BALANCE
						Bars
						
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Delta
						
						
						 8 =  6 - 7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: STROKA
				Description:
				Returns
				Parameters
					String: pNLS
					Number: pS
					String: pLCV
					String: pDAT6
				Static Variables
				Local variables
					String: tNLS
				Actions
					If fDAT6 != pDAT6
						Call SalMessageBox(
								'DAT in file ' || sD1 || ' = ' || pDAT6 || ' ( NOT = ' || fDAT6  || ' ) !',
								 'Error !' ,   MB_IconAsterisk | MB_Ok )
						Return FALSE
					!
					Set tNLS = SalStrTrimX(pNLS)
					Set nKol = nKol + 1
					Set mNLS = pNLS
					Set mLCV = pLCV
					!
					Return 
							 SqlPrepareAndExecute(hSql(),
							 "INSERT INTO mpoz_NOM ( NLS, SUMO, LCV, nls_BARS, kv, acc, ost ) 
							  select o.NLS_ODB, o.S_ODB, o.LCV, b.NLS_BARS, b.kv, b.KOL, b.ost  
							  from (select :tNLS NLS_ODB, :pS S_ODB, :pLCV LCV from dual ) o,
							       (SELECT t.KV, t.LCV, g.nls NLS_ODB, min(s.nls) NLS_BARS, count(*) KOL, sum(s.ost)/100 OST
							        FROM sal s, geo_tab g , tabval t
							        WHERE g.acc=s.acc and s.fdat=:dDab and s.kv=t.kv 
							          and t.LCV = :pLCV and g.nls = :tNLS 
							         GROUP BY t.KV, t.LCV, g.nls  ) b          
							  where o.NLS_ODB = b.NLS_ODB (+) and o.LCV = b.LCV (+) ")
			Function: F_TAB
				Description:
				Returns
				Parameters
					String: WHE
				Static Variables
				Local variables
					Number: n3
				Actions
					Call SalWaitCursor( TRUE )
					Call DISA()
					Call SalTblSetLockedColumns( hWndForm, 5 )
					Call SalTblPopulate( hWndForm, hSql(),
							  "SELECT NLS, SUMO, LCV, NLS_bars,  kv,  acc, OST 
							   INTO :geo_NOM.NLS, :geo_NOM.SUMO, :geo_NOM.LCV, 
							        :geo_NOM.NLS_BARS, :geo_NOM.KV, :geo_NOM.KOL_BARS, :geo_NOM.OST 
							   FROM mpoz_NOM   "||WHE||" 
							   ORDER BY KV, NLS_BARS ", TBL_FillAll )
					Call SalEnableWindow(pbPrint)
					Call SalEnableWindow(pbSearch)
					Call SalWaitCursor( FALSE )
					Return TRUE
			Function: DISA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Call SalDisableWindow(pbPrint)
					Call SalDisableWindow(pbSearch)
					Return TRUE
			Function: F_FILE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sTxt = 'BEGIN import MPOZ_NOM' 
					Set nKol =0 
					If SqlPrepareAndExecute(hSqlA, 
							"SELECT nls,sumo, lcv, dat 
							 INTO :sNLS,:nS, :sLCV, :sDAT6 
							 FROM mpoz_NOM") 
						While SqlFetchNext( hSqlA, nFetchRes )
							If NOT STROKA(sNLS,nS, sLCV, sDAT6 )
								Return FALSE
						!
						Call SqlCommit( hSql() )
						Set sTxt = 'END import MPOZ_NOM' 
						Set sTxt = 'not in MPOZ_NOM' 
						Set mNLS = ''
						Set mLCV = ''
						If NOT SqlPrepareAndExecute(hSql(),
								 "INSERT INTO mpoz_NOM (NLS, KV, lcv, OST,  NLS_BARS, ACC )
								  select g.NLS, s.kv, t.lcv,  sum(s.ost)/100, min(s.nls), count(*) 
								  from sal s, tabval t , geo_tab g 
								  where s.acc=g.acc and s.kv=t.kv  and s.ost <>0 
								    and ( not exists ( select 1 from MPOZ_NOM m  where m.lcv=t.lcv and g.nls=m.nls )  
								       OR g.NLS is null) 
								    and s.fdat=:dDab 
								    and s.nbs is not null 
								  group by  g.NLS, s.kv, t.lcv " )
							Return FALSE
						!
						Return TRUE
					! !!!!
					Return FALSE
		Window Parameters
			Date/Time: dDAT
		Window Variables
			String: sPath
			String: sOdir
			Sql Handle: hSqlA
			String: sD0
			String: sD1
			Date/Time: dDab
			Number: nFetchRes
			!
			Number: nS
			String: sNLS
			String: sLCV
			String: sDAT6
			String: fDAT6
			Boolean: FR
			! Number: I1
			! Number: I2
			! Number: I3
		Message Actions
			On SAM_Create
				Call DISA()
				Call XSalTooltipSetUserDefault()
				Call PrepareWindowEx(hWndForm)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Set rb5 = TRUE
				If dDAT!=DATETIME_Null
					Call SalSendMsg(dat, SAM_Click, 0, 0)
			On SAM_User
				Call DISA()
				Call SalSetWindowText(hWndForm, 'Comparing with MPOZ_NOM.dbf on ' || SalFmtFormatDateTime( dDab,'dd-MM-yyyy'))
				Set fDAT6 = SalFmtFormatDateTime( dDab,'yyMMdd')
				! Константы
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('RegionalSettings', 'MakvPath',GetPrnDir(), sPath, GetIniFileName())
				Set sPath = sPath || '\\' || SalFmtFormatDateTime(dDab, 'yyyyMMdd')
				Set sD1   = sPath || '\\MPOZ_NOM.dbf'
				Call SalFileGetCurrentDirectory(sOdir)
				Call SalFileSetCurrentDirectory(sPath)
				If File(sD1) !! если есть файл
					If SqlPrepareAndExecute(hSql(), "DELETE FROM mpoz_NOM")  
						Set SqlDatabase = 'dBase_Files'
						If SqlConnect( hSqlA )  !! есть связь с ODBC 
							Set FR =  F_FILE()
							Set sTxt = 'END execute Delta' 
							If FR 
								Call SqlCommit( hSql() )
								Call SqlDisconnect( hSqlA )
								Call SalSendMsg( rb5, SAM_Click, 0,0 )
								!
								! If dDAT = GetBankDate( )
									! Call MAK5_OK( dDAT )
									    Call F_TAB('WHERE sumo <> ost')
							Else
								Call SqlRollback( hSql() )
								Call SqlDisconnect( hSqlA )
					Else
						Call SqlRollback(hSql())
				Else
					Call SalMessageBox('Отсутствует файл !',sD1, MB_IconAsterisk | MB_Ok )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set S3 = SUMO - OST 
				! Есть в файле и Нет  в БАРСЕ - розовій
				If OST = NUMBER_Null
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) )
				! Нет  в файле и Есть в БАРСЕ - голубой
				Else If SUMO = NUMBER_Null
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua  )
				! ЕСТЬ в файле и Есть в БАРСЕ - но суммы разные - желтій 
				Else If S3 != 0 
					Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 255,255,180 ) )
			On SAM_Destroy
				Call SalFileSetCurrentDirectory(sOdir)
	Table Window: geo_MB2 !! формирование MB2ddmm.dbf
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Formirovanie MB2ddmm.dbf
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   2.52"
				Top:    0.55"
				Width:  8.514"
				Width Editable? Yes
				Height: 6.536"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? No
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.427"
				Size Editable? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.086"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.586"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.586"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 39834
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.557"
						Begin Y:  -0.01"
						End X:  4.557"
						End Y:  0.448"
					Visible? No
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.786"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Class Default
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = ' Balans <-> File '
						On SAM_Click
							Call F_2()
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.786"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'UnLoad MB2ddmm.dbf'
						On SAM_Click
							! блок выгрузки
							Set SqlDatabase = 'dBase_Files'
							Call SalFileGetCurrentDirectory(sOdir)
							Call SalFileSetCurrentDirectory(sPath)
							If SqlConnect(hSqlA)
								Call SalWaitCursor(TRUE)
								Call VisFileDelete(sD1)
								Call SqlPrepareAndExecute(hSqlA, "
										 CREATE TABLE " || sD0 ||
										"(BSN CHAR(4), SUMO NUMBER(16,2),BSS CHAR(40) )")
								Set nRow = TBL_MinRow
								Set bFL = FALSE
								While SalTblFindNextRow(hWndForm, nRow, 0, 0)
									Call SalTblFetchRow(hWndForm, nRow)
									Set sTmp=SalStrLeftX( BSS,40 )
									Set bFL = SqlPrepareAndExecute(hSqlA, "
											    INSERT INTO "||sD0||" VALUES (:BSN,:SUMO,:sTmp)")
								If bFL
									Call SqlCommit(hSqlA)
								Else
									Call SqlRollback(hSqlA)
								Call SqlDisconnect(hSqlA)
								Call SalWaitCursor(FALSE)
								If bFL
									Call MessageNoWait('Создание ' || sD1 ||
											     ' успешно завершено !', 'Сообщение', 1, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.286"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = ' Печать таблицы '
							Set geo_MB2.strPrintFileName='MB2.txt'
				Line
					Resource Id: 39835
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.886"
						Begin Y:  -0.01"
						End X:  3.886"
						End Y:  0.448"
					Visible? No
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.586"
						Top:    0.073"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 39836
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.9"
						Begin Y:  -0.01"
						End X:  1.9"
						End Y:  0.448"
					Visible? No
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Combo Box: dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.386"
						Top:    0.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 2.594"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Call SalListPopulate(dat, hSql(), T("
									     SELECT TO_CHAR(fdat, 'DD-MM-YYYY')
									     FROM fdat
									     ORDER BY fdat DESC"))
						On SAM_Click
							Set dDab = SalFmtFormatStrDateTime( dat, 'dd-MM-yyyy')
							Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.586"
						Top:    0.073"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Column: BSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: New BS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CUR-EQV
						balance
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.071"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DEB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CUR-EQV
						balance DEBET
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.343"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KRE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: CUR-EQV
						balance  CREDIT
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.514"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BSS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Old BS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If FL1
						Call SalHideWindow( geo_MB2.SUMO )
						Call SalHideWindow( geo_MB2.BSS )
						Call SalShowWindow( geo_MB2.DEB )
						Call SalShowWindow( geo_MB2.KRE )
					Else
						Call SalHideWindow( geo_MB2.DEB )
						Call SalHideWindow( geo_MB2.KRE )
						Call SalShowWindow( geo_MB2.SUMO )
						Call SalShowWindow( geo_MB2.BSS )
					Set FL1= not FL1
					Return TRUE
		Window Parameters
		Window Variables
			String: sOdir
			String: sPath
			Boolean: bFL
			String: sD0
			String: sD1
			String: sTmp
			Sql Handle: hSqlA
			Date/Time: dDab
			Number: nFetchRes
			String: sNB1
			String: sNB2
			Number: nS
			Number: nRow 
			!
			Date/Time: dTmp
			Boolean: FL1
		Message Actions
			On SAM_User
				Call SalWaitCursor(TRUE)
				Set FL1=FALSE
				Call F_2()
				Call SalDisableWindow(pbSearch)
				Call SalDisableWindow(pbPrint)
				Call SalDisableWindow(pbDetails)
				Set nFlags = GT_NoDel  | GT_NoUpd | GT_NoIns
				Set sD0='MB2'||SalFmtFormatDateTime( dDab,'ddMM') !! краткое имя
				Call SalDisableWindow(pbPrint)
				Call SalSetWindowText(hWndForm,'Forming MB2'||SalFmtFormatDateTime( dDab,'ddMM')||'.dbf')
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('RegionalSettings','MakvPath',GetPrnDir(),sPath,GetIniFileName())
				If Right(sPath,1) != '\\'
					Set sPath = sPath || '\\'
				Set sPath=sPath||SalFmtFormatDateTime( dDab, 'yyyyMMdd' )
				Call SalFileCreateDirectory( sPath )
				Set sPath = sPath || '\\'
				Set sD1 =sPath||sD0||'.dbf' !! полное имя
				! в промежуточную таблицу
				If SqlPrepareAndExecute(hSqlAux(), "DELETE FROM mb2" )
						and SqlPrepareAndExecute(hSql(),
						    "SELECT nbs, SUBSTR(nlsalt,-6,3), nvl(sum(OSTQ),0) /100 
						     INTO :sNB1,:sNB2,:nS  FROM salq 
						     WHERE ostq<>0 and dazs IS NULL and fdat = :dDab 
						     GROUP BY nbs, SUBSTR(nlsalt,-6,3) 
						     ORDER BY 1,2 ")
					While SqlFetchNext( hSql(), nFetchRes )
						Call SqlPrepareAndExecute(hSqlAux(),"SELECT * FROM mb2 WHERE bsn=:sNB1")
						If SqlFetchNext( hSqlAux(), nFetchRes )
							Call SqlPrepareAndExecute(hSqlAux(),T("UPDATE mb2 SET sumo=sumo+:nS, bss=bss||:sNB2 WHERE bsn=:sNB1"))
						Else
							Call SqlPrepareAndExecute(hSqlAux(),T("
									   INSERT INTO mb2 (bsn,sumo,bss) VALUES (:sNB1,:nS,:sNB2) "))
					Call SqlCommit( hSqlAux() )
					Call SalTblPopulate( hWndForm, hSql(),
							"SELECT bsn,sumo,bss 
							 INTO :BSN,:SUMO,:BSS 
							 FROM MB2 
							 ORDER BY bsn ", TBL_FillAll )
					Call SalWaitCursor(FALSE)
					Call SalEnableWindow(pbSearch)
					Call SalEnableWindow(pbDetails)
					Call SalEnableWindow(pbPrint)
			On SAM_FetchRowDone
				If SUMO<0
					Set DEB=-SUMO
				Else
					Set KRE=SUMO
			On SAM_Create
				Call SalDisableWindow(pbSearch)
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbPrint)
				Set FL1=FALSE
				Call F_2()
				Call XSalTooltipSetUserDefault(  )
			On SAM_Destroy
				Call SalFileSetCurrentDirectory(sOdir)
