.head 0 +  Application Description: Библиотека функциональных классов 
по открытию/обновлению счетов
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000A50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D0100000007436C 6173736573
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: global.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  File Include: GENLABEL.APL
.head 2 -  File Include: GENFCLS.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: fAccLangInit
.head 2 +  Internal Functions
.head 3 +  Function: GenAcc_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего
для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fAccLangInit
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\genacc.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFileSpecial( strFileName, strLangId, "", TRUE ))
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccRekv','Не заполнен реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccMfo', 'МФО банка')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccNbs', 'Балансовый счет')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccNls', 'Номер счета')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccKv',  'Валюта')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccNms', 'Наименование счета')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccTip', 'Тип счета')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccVid', 'Вид счета')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccIsp', 'Исполнитель')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAccGrp', 'Права доступа')
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\BARS98\\genacc.lng','RUS')
.head 6 -  Set fAccLangInit = TRUE
.head 5 -  Return fAccLangInit
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2286315003
0000: A600000067000000 0000000000000000 0200000100FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F2B003C00 000F410062737472
0040: 616374410063636F 756E746C00C00000 0400000083010D00 0000FFFF840D0000
0060: 030400FE00FF8311 00000001FB00FF0F 1E000000EE0100FF 3F
.enddata
.head 3 +  Functional Class: AbstractAccount
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nFetchRes
.head 5 -  Sql Handle: hSql
.head 5 -  Number: nErrorCount
.head 5 -  Number: nMode
.head 4 +  Instance Variables
.head 5 -  Number: nNewAcc
.head 5 -  Number: nRnk
.head 5 -  Number: nAcc
.head 5 -  String: sNls
.head 5 -  String: sNlsAlt
.head 5 -  Number: nKv
.head 5 -  String: sNbs
.head 5 -  String: sNms
.head 5 -  Number: nPap
.head 5 -  String: sTip
.head 5 -  Number: nVid
.head 5 -  Number: nPos
.head 5 -  String: sTobo
.head 5 -  Date/Time: dDaos
.head 5 -  Date/Time: dDazs
.head 5 -  Date/Time: dDapp
.head 5 -  Date/Time: dMDate
.head 5 -  Number: nBlkd
.head 5 -  Number: nBlkk
.head 5 -  Number: nIsp
.head 5 -  Number: nGrp
.head 5 -  Number: nSeci
.head 5 -  Number: nSeco
.head 5 -  Number: nOstc
.head 5 -  Number: nOstb
.head 5 -  Number: nOstf
.head 5 -  Number: nDos
.head 5 -  Number: nKos
.head 5 -  Number: nOstq
.head 5 -  Number: nDosq
.head 5 -  Number: nKosq
.head 5 -  Number: nLim
.head 5 -  Number: nOstx
.head 5 -  Number: nProcMfo
.head 5 -  Number: nProcMfoOld
.head 5 -  Number: nP4_
.head 5 -  : SPList
.head 6 -  Class: cSParamList
.head 5 -  : ListAcrn
.head 6 -  Class: cAccAcrnList
.head 5 -  : ListRights
.head 6 -  Class: cAccRightsList
.head 5 -  : ListRates
.head 6 -  Class: cAccRatesList
.head 5 -  : ListSob
.head 6 -  Class: cAccSobList
.head 4 +  Functions
.head 5 +  Function: initAccount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call GenAcc_Init()
.head 7 -  Set hSql  = hSql_
.head 7 -  Set nAcc  = nAccId
.head 7 -  Call SPList.Init(nAcc)
.head 7 -  Call ListAcrn.Init(nAcc)
.head 7 -  Call ListRights.Init(nAcc)
.head 7 -  Call ListRates.Init(nAcc)
.head 7 -  Call ListSob.Init(nAcc)
.head 7 -  Return TRUE
.head 5 +  Function: populateAccount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPrepareAndExecute(hSql, 
"SELECT nls, kv, nbs, nlsalt, nms, pap, tip, vid, pos, 
        daos, dazs, dapp, mdate, blkd, blkk, 
        ostc, dos, kos, ostq, dosq, kosq, lim, ostx, 
        isp, grp, seci, seco, tobo 
 INTO :sNls, :nKv, :sNbs, :sNlsAlt, :sNms, :nPap, :sTip, :nVid, :nPos, 
      :dDaos, :dDazs, :dDapp, :dMDate, :nBlkd, :nBlkk, 
      :nOstc, :nDos, :nKos, :nOstq, :nDosq, :nKosq, :nLim, :nOstx, 
      :nIsp, :nGrp, :nSeci, :nSeco, :sTobo 
 FROM Accounts WHERE acc=:nAcc")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set nProcMfoOld = NUMBER_Null
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"SELECT mfo INTO :nProcMfoOld FROM Bank_acc WHERE acc=:nAcc")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set nProcMfo = nProcMfoOld
.head 7 -  ! Rights
.head 7 +  If NOT populateAccRights()
.head 8 -  Return FALSE
.head 7 -  ! SP
.head 7 +  If NOT populateAccSParams()
.head 8 -  Return FALSE
.head 7 -  ! %%
.head 7 -  ! Tarif
.head 7 +  If NOT populateAccRates()
.head 8 -  Return FALSE
.head 7 -  ! SOB
.head 7 +  If NOT populateAccSob()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateAccountAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPrepareAndExecute(hSql, 
"SELECT nls, kv, nbs, nlsalt, nms, pap, tip, vid, pos, 
        daos, dazs, dapp, mdate, blkd, blkk, 
        ostc, dos, kos, ostq, dosq, kosq, lim, ostx, 
        isp, grp, seci, seco, tobo 
 INTO :sNls, :nKv, :sNbs, :sNlsAlt, :sNms, :nPap, :sTip, :nVid, :nPos, 
      :dDaos, :dDazs, :dDapp, :dMDate, :nBlkd, :nBlkk, 
      :nOstc, :nDos, :nKos, :nOstq, :nDosq, :nKosq, :nLim, :nOstx, 
      :nIsp, :nGrp, :nSeci, :nSeco, :sTobo 
 FROM Accounts WHERE acc=:nAcc")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set nProcMfoOld = NUMBER_Null
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"SELECT mfo INTO :nProcMfoOld FROM Bank_acc WHERE acc=:nAcc")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set nProcMfo = nProcMfoOld
.head 7 -  Return TRUE
.head 5 +  Function: saveAccount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nAcc = 0
.head 8 +  If NOT registerAccount()
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If NOT updateAccount()
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: registerAccount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT registerAccountAttribute()
.head 8 -  Return FALSE
.head 7 -  ! Rights
.head 7 +  If NOT registerAccountRights()
.head 8 -  Return FALSE
.head 7 -  ! SP
.head 7 +  If NOT initAccountSParams()
.head 8 -  Return FALSE
.head 7 -  ! %%
.head 7 +  If NOT initAccountAcrn()
.head 8 -  Return FALSE
.head 7 -  ! Tarif
.head 7 +  If NOT initAccountRates()
.head 8 -  Return FALSE
.head 7 -  ! SOB
.head 7 +  If NOT initAccountSob()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: registerAccountAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sOstX
.head 7 -  Number: nLastAcc
.head 6 +  Actions
.head 7 -  Set nMode = IifN(nProcMfo!=NUMBER_Null,4,77)
.head 7 -  Set sOstX = IifS(nOstx=NUMBER_Null,'NULL',Str(nOstx))
.head 7 -  Set nLastAcc = NUMBER_Null
.head 7 +  If not SqlPLSQLCommand(hSql,
"accreg.setAccountAttr(nMode, nProcMfo, 0, nGrp, nP4_, nRnk, sNls, nKv, sNms, sTip, nIsp, nLastAcc,
   sNbs, nPap, nVid, nPos, NUMBER_Null, nSeci, nSeco,
   nBlkd, nBlkk, nLim, sOstX, sNlsAlt, sTobo, NUMBER_Null)")
.head 8 -  Return FALSE
.head 7 -  ! Set nAcc = nLastAcc
.head 7 -  Call setAcc(nLastAcc)
.head 7 -  Set dDaos = GetBankDate()
.head 7 -  Return TRUE
.head 5 +  Function: registerAccountRights
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 +  If getAccRightsParNum() > 0	! счет уже открыт и сейчас идет открытие по валютам
.head 8 -  Call ListRights.Assign(nAcc)
.head 8 -  Set nIterator = 0
.head 8 +  While nIterator <= getAccRightsParNum()
.head 9 +  If ListRights.List[nIterator].nPr = 0
.head 10 -  Set ListRights.List[nIterator].nPr = 1
.head 9 -  Set nIterator = nIterator + 1
.head 7 +  If NOT saveAccRights()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: checkAccountAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sMsg
.head 7 -  Receive Number: nCheck
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not SqlPLSQLCommand(hSql, "accreg.check_Account(nAcc, sMsg, nCheck)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: initAccountSParams
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SPList.Init(nAcc)
.head 7 +  If NOT SPList.Populate(hSql,sNbs)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: initAccountAcrn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListAcrn.Init(nAcc)
.head 7 +  If NOT ListAcrn.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: initAccountRates
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListRates.Init(nAcc)
.head 7 -  Return TRUE
.head 5 +  Function: initAccountSob
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListSob.Init(nAcc)
.head 7 -  Return TRUE
.head 5 +  Function: updateAccount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sOstX
.head 7 -  String: sNlsAlt_
.head 6 +  Actions
.head 7 -  ! General + Financial
.head 7 +  If NOT saveAccountAttribute()
.head 8 -  Return FALSE
.head 7 -  ! Rights
.head 7 +  If NOT saveAccRights()
.head 8 -  Return FALSE
.head 7 -  ! SP
.head 7 +  If NOT saveAccSParams()
.head 8 -  Return FALSE
.head 7 -  ! %%
.head 7 +  If NOT saveAccAcrn()
.head 8 -  Return FALSE
.head 7 -  ! Tarif
.head 7 +  If NOT saveAccRates()
.head 8 -  Return FALSE
.head 7 -  ! SOB
.head 7 +  If NOT saveAccSob()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveAccountAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sOstX
.head 7 -  String: sNlsAlt_
.head 6 +  Actions
.head 7 -  Set nMode    = IifN(nProcMfoOld!=NUMBER_Null OR nProcMfo!=NUMBER_Null,4,77)
.head 7 -  Set sOstX    = IifS(nOstx=NUMBER_Null,'NULL',Str(nOstx))
.head 7 -  Set sNlsAlt_ = IifS(sNlsAlt='','NULL',sNlsAlt)
.head 7 +  If NOT SqlPLSQLCommand(hSql,
"op_reg_ex(nMode, nProcMfo, 0, nGrp, nP4_, nRnk, sNls, nKv, sNms, sTip, nIsp, nAcc,
   sNbs, nPap, nVid, nPos, NUMBER_Null, nSeci, nSeco,
   nBlkd, nBlkk, nLim, sOstX, sNlsAlt_, sTobo, NUMBER_Null)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: reserveAccountAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPLSQLCommand(hSql,
"accreg.p_reserve_acc(nAcc, nRnk, sNls, nKv, sNms, sTip, nGrp, nIsp, 
    nPap, nVid, nPos, nBlkd, nBlkk, nLim, nOstx, sNlsAlt, sTobo)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getErrAccountData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strErrorList
.head 6 +  Actions
.head 7 -  Set strErrorList = ''
.head 7 -  Set nErrorCount = 0
.head 7 -  Set sPar = ''
.head 7 -  !
.head 7 -  ! If nProcMfo = NUMBER_Null
.head 7 +  If sNbs = STRING_Null and GetGlobalOptionEx('NBS_NULL')=0
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','NBS',sPar)
.head 8 -  ! Не заполнен реквизит <Балансовый счет>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccNbs')  || '>' || PutCrLf()
.head 7 +  If sNls = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','NLS',sPar)
.head 8 -  ! Не заполнен реквизит <Номер счета>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccNls')  || '>' || PutCrLf()
.head 7 -  !
.head 7 +  If nKv  = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','KV',sPar)
.head 8 -  ! Не заполнен реквизит <Валюта>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccKv')  || '>' || PutCrLf()
.head 7 +  If sNms = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','NMS',sPar)
.head 8 -  ! Не заполнен реквизит <Наименование счета>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccNms')  || '>' || PutCrLf()
.head 7 +  If sTip = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','TIP',sPar)
.head 8 -  ! Не заполнен реквизит <Тип счета>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccTip')  || '>' || PutCrLf()
.head 7 +  If nVid = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','VID',sPar)
.head 8 -  ! Не заполнен реквизит <Вид счета>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccVid')  || '>' || PutCrLf()
.head 7 +  If nIsp = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','ISP',sPar)
.head 8 -  ! Не заполнен реквизит <Исполнитель>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccIsp')  || '>' || PutCrLf()
.head 7 +  ! If nGrp=0 OR nGrp=NUMBER_Null
.head 8 -   Set nErrorCount = nErrorCount + 1
.head 8 -   Set sPar = IifS(sPar='','GRP',sPar)
.head 8 -  ! <Права доступа> Не назначена группа счета.
.head 8 -   Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrAccRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrAccGrp')  || '>' || PutCrLf()
.head 7 -  !
.head 7 -  Return strErrorList
.head 5 -  ! %%
.head 5 +  Function: setIntProfData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nNbsProf
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPLSQLCommand(hSql, "accreg.setAccountIntFromProf(nAcc, sNbs, nNbsProf)" )
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! Rights
.head 5 +  Function: populateAccRights
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRights.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getAccRightsValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Receive Number: nId
.head 7 -  Receive String: sName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nId   = ListRights.List[nIndex].nId
.head 7 -  Set sName = ListRights.List[nIndex].strName
.head 5 +  Function: saveAccRights
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRights.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: addAccRights
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  String: sName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListRights.Add(nId, sName)
.head 7 -  Return TRUE
.head 5 +  Function: dropAccRights
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRights.Drop(nId)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getAccRightsParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRights.nParNum
.head 5 +  Function: getAccRightsIndexById
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRights.GetIndexById(nId)
.head 5 -  ! SP
.head 5 +  Function: populateAccSParams
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SPList.Populate(hSql, sNbs)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveAccSParams
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SPList.Update(hSql)
.head 5 +  Function: getSParamsParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SPList.nParNum
.head 5 +  Function: getSParamsValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Receive Number: nSpId
.head 7 -  Receive String: sName
.head 7 -  Receive String: sValue
.head 7 -  Receive String: sSemantic
.head 7 -  Receive String: sType
.head 7 -  Receive String: sNsi
.head 7 -  Receive String: sPKName
.head 7 -  Receive String: sNsiSqlWhere
.head 7 -  Receive String: sOpt
.head 7 -  Receive Long String: sSqlVal
.head 7 -  Receive String: sTabColumnCheck
.head 7 -  ! Receive String: sCode
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSpId = SPList.List[nIndex].nSpId
.head 7 -  Set sName = SPList.List[nIndex].strName
.head 7 -  Set sValue = SPList.List[nIndex].strValue
.head 7 -  Set sSemantic = SPList.List[nIndex].strSemantic
.head 7 -  Set sType = SPList.List[nIndex].strType
.head 7 -  Set sNsi = SPList.List[nIndex].strNSI
.head 7 -  Set sPKName = SPList.List[nIndex].strPKName
.head 7 -  Set sNsiSqlWhere = SPList.List[nIndex].strNsiSqlWhere
.head 7 -  Set sOpt = SPList.List[nIndex].strOpt
.head 7 -  Set sSqlVal = SPList.List[nIndex].strSqlVal
.head 7 -  Set sTabColumnCheck = SPList.List[nIndex].strTabColumnCheck
.head 7 -  ! Set sCode = SPList.List[nIndex].strCode
.head 5 +  Function: setSParamsValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nSpId
.head 7 -  String: sName
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SPList.SetV(nSpId, sName, sValue)
.head 7 -  Return TRUE
.head 5 +  Function: getSParamsValueBySpId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nSpId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 +  Actions
.head 7 -  Set sValue = ''
.head 7 -  Set nIndex = SPList.GetIndexBySpId(nSpId)
.head 7 +  If nIndex != -1
.head 8 -  Set sValue = SPList.List[nIndex].strValue
.head 7 -  Return sValue
.head 5 +  Function: setSParamsProfData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nNbsProf
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SPList.SetProfData(hSql, sNbs, nNbsProf)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getSParamCode
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex < 0 or nIndex > SPList.nParNum or SPList.nParNum = 0
.head 8 -  Return ''
.head 7 -  Return SPList.List[nIndex].strCode
.head 5 -  ! Acrn
.head 5 +  Function: populateAccAcrn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListAcrn.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveAccAcrn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListAcrn.Update(hSql)
.head 5 +  Function: getAcrnParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListAcrn.nParNum
.head 5 +  Function: getAcrnParNumRatn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 +  If nId != NUMBER_Null
.head 8 -  Set nIndex = ListAcrn.GetIndexById(nId)
.head 7 +  If nIndex = -1
.head 8 -  Return 0
.head 7 -  Return ListAcrn.List[nIndex].nRatnParNum
.head 5 +  Function: addAcrnRatn
.head 6 -  Description: Добавить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Date/Time: dBDat
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 7 -  Receive Number: nRatnIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListAcrn.AddRatn(nId, dBDat, nIr, nBr, nOp, nRatnIndex)
.head 7 -  Return TRUE
.head 5 +  Function: dropAcrnRatn
.head 6 -  Description: Удалить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListAcrn.DropRatn(nId, nRatnIndex)
.head 7 -  Return TRUE
.head 5 +  Function: getAcrnAccn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Receive Number: nMetr
.head 7 -  Receive Number: nBaseM
.head 7 -  Receive Number: nBaseY
.head 7 -  Receive Number: nFreq
.head 7 -  Receive Date/Time: dStpDat
.head 7 -  Receive Date/Time: dAcrDat
.head 7 -  Receive Date/Time: dAplDat
.head 7 -  Receive String: sTt
.head 7 -  Receive Number: nAcrA
.head 7 -  Receive Number: nAcrB
.head 7 -  Receive String: sTtB
.head 7 -  Receive Number: nKvB
.head 7 -  Receive String: sNlsB
.head 7 -  Receive String: sNamB
.head 7 -  Receive String: sMfo
.head 7 -  Receive String: sOkpo
.head 7 -  Receive String: sNazn
.head 7 -  Receive Number: nIo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListAcrn.GetAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 5 +  Function: setAcrnAccn
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListAcrn.SetAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 5 +  Function: getAcrnRatn
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 7 -  Receive Date/Time: dBDat
.head 7 -  Receive Number: nIr
.head 7 -  Receive Number: nBr
.head 7 -  Receive Number: nOp
.head 7 -  Receive Boolean: bIns
.head 7 -  Receive Boolean: bUpd
.head 7 -  Receive Boolean: bDel
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListAcrn.GetRatn(nId, nRatnIndex, dBDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 5 +  Function: setAcrnRatn
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 7 -  ! Date/Time: dBDat
.head 7 -  Date/Time: dBDatNew
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! Call ListAcrn.SetRatn(nId, dBDat, dBDatNew, nIr, nBr, nOp)
.head 7 -  Call ListAcrn.SetRatn(nId, nRatnIndex, dBDatNew, nIr, nBr, nOp)
.head 5 -  ! Rates
.head 5 +  Function: populateAccRates
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRates.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveAccRates
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRates.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getRatesValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Receive Number: nTar
.head 7 -  Receive Number: nPr
.head 7 -  Receive Number: nSMin
.head 7 -  Receive Number: nKvSMin
.head 7 -  Receive Number: nSMax
.head 7 -  Receive Number: nKvSMax
.head 7 -  Receive Date/Time: dBDate
.head 7 -  Receive Date/Time: dEDate
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTar    = ListRates.getTar(nKod)
.head 7 -  Set nPr     = ListRates.getPr(nKod)
.head 7 -  Set nSMin   = ListRates.getSMin(nKod)
.head 7 -  Set nKvSMin = ListRates.getKvSMin(nKod)
.head 7 -  Set nSMax   = ListRates.getSMax(nKod)
.head 7 -  Set nKvSMax = ListRates.getKvSMax(nKod)
.head 7 -  Set dBDate  = ListRates.getBDate(nKod)
.head 7 -  Set dEDate  = ListRates.getEDate(nKod)
.head 5 +  Function: setRatesValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nTar
.head 7 -  Number: nPr
.head 7 -  Number: nSMin
.head 7 -  Number: nKvSMin
.head 7 -  Number: nSMax
.head 7 -  Number: nKvSMax
.head 7 -  Date/Time: dBDate
.head 7 -  Date/Time: dEDate
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListRates.setTar(nKod,nTar)
.head 7 -  Call ListRates.setPr(nKod,nPr)
.head 7 -  Call ListRates.setSMin(nKod,nSMin)
.head 7 -  Call ListRates.setKvSMin(nKod,nKvSMin)
.head 7 -  Call ListRates.setSMax(nKod,nSMax)
.head 7 -  Call ListRates.setKvSMax(nKod,nKvSMax)
.head 7 -  Call ListRates.setBDate(nKod,dBDate)
.head 7 -  Call ListRates.setEDate(nKod,dEDate)
.head 7 -  Call ListRates.setFlagChg(nKod, TRUE)
.head 7 -  Return TRUE
.head 5 +  Function: delRatesValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListRates.setFlagDel(nKod, TRUE)
.head 7 -  Return TRUE
.head 5 -  ! Sob
.head 5 +  Function: populateAccSob
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListSob.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveAccSob
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListSob.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getSobParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListSob.nParNum
.head 5 +  Function: getSobValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Receive Number: nId
.head 7 -  Receive Number: nIsp
.head 7 -  Receive String: sFio
.head 7 -  Receive Date/Time: dDat
.head 7 -  Receive Long String: sTxt
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nId  = ListSob.getId(nIndex)
.head 7 -  Set nIsp = ListSob.getIsp(nIndex)
.head 7 -  Set sFio = ListSob.getFio(nIndex)
.head 7 -  Set dDat = ListSob.getDat(nIndex)
.head 7 -  Set sTxt = ListSob.getTxt(nIndex)
.head 5 +  Function: setSobValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nIsp
.head 7 -  Date/Time: dDat
.head 7 -  Long String: sTxt
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = ListSob.getIndexById(nId)
.head 7 -  ! update
.head 7 +  If nIndex != -1
.head 8 +  If NOT ListSob.setIsp(nIndex,nIsp) 
OR NOT ListSob.setDat(nIndex,dDat)
OR NOT ListSob.setTxt(nIndex,sTxt)
.head 9 -  Return FALSE
.head 7 -  ! insert
.head 7 +  Else
.head 8 +  If NOT ListSob.Insert(hSql,nIsp,dDat,sTxt)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nRnk
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nAcc
.head 5 +  Function: setAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nAcc = nVal
.head 7 -  Call SPList.Assign(nAcc)
.head 7 -  Return TRUE
.head 5 +  Function: getProcMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nProcMfo
.head 5 +  Function: setProcMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nProcMfo = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getNls
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNls
.head 5 +  Function: setNls
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNls = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNlsAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNlsAlt
.head 5 +  Function: setNlsAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNlsAlt = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getKv
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nKv
.head 5 +  Function: setKv
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nKv = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getNbs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNbs
.head 5 +  Function: setNbs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNbs = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNms
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNms
.head 5 +  Function: setNms
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNms = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getPap
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nPap
.head 5 +  Function: setPap
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nPap = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getTip
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTip
.head 5 +  Function: setTip
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTip = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getVid
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nVid
.head 5 +  Function: setVid
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nVid = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getPos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nPos
.head 5 +  Function: setPos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nPos = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getTobo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTobo
.head 5 +  Function: setTobo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTobo = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getDaos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDaos
.head 5 +  Function: setDaos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDaos = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getDazs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDazs
.head 5 +  Function: setDazs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDazs = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getDapp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDapp
.head 5 +  Function: setDapp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDapp = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getMDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dMDate
.head 5 +  Function: setMDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dMDate = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getBlkd
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nBlkd
.head 5 +  Function: setBlkd
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nBlkd = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getBlkk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nBlkk
.head 5 +  Function: setBlkk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nBlkk = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getIsp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nIsp
.head 5 +  Function: setIsp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nIsp = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getGrp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nGrp
.head 5 +  Function: setGrp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nGrp = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getSeci
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nSeci
.head 5 +  Function: setSeci
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSeci = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getSeco
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nSeco
.head 5 +  Function: setSeco
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSeco = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getOstc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nOstc
.head 5 +  Function: getOstb
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nOstb
.head 5 +  Function: getOstf
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nOstf
.head 5 +  Function: getOstq
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nOstq
.head 5 +  Function: getDos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nDos
.head 5 +  Function: getKos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nKos
.head 5 +  Function: getDosq
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nDosq
.head 5 +  Function: getKosq
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nKosq
.head 5 +  Function: getLim
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nLim
.head 5 +  Function: setLim
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nLim = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getOstx
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nOstx
.head 5 +  Function: setOstx
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nOstx = nVal
.head 7 -  Return TRUE
.head 3 +  Functional Class: cAccRights
.head 4 -  Description: Описание спецпараметра
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nId
.head 5 -  String: strName
.head 5 -  Number: nPr
.head 4 -  Functions
.head 3 +  Functional Class: cAccRightsList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  : List[*]
.head 6 -  Class: cAccRights
.head 5 -  Number: nParNum
.head 5 -  Boolean: isEdit
.head 5 -  Number: nFetchRes
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set isEdit  = FALSE
.head 7 -  Set nAcc    = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Assign
.head 6 -  Description: Назначить идентификатор счета
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nAcc = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nId
.head 7 -  String: sName
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"SELECT g.id, g.name
   INTO :nId, :sName
   FROM groups_acc g, table(sec.getAgrp(:nAcc)) b
  WHERE g.id=b.column_value
  ORDER BY g.id" )
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nId     = nId
.head 8 -  Set List[nParNum].strName = sName
.head 8 -  Set List[nParNum].nPr     = 0
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nId
.head 7 -  Number: nPr
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nId = List[nIterator].nId
.head 8 -  Set nPr = List[nIterator].nPr
.head 8 +  If nPr = 1
.head 9 +  If NOT SqlPLSQLCommand(hSql,
"sec.addAgrp(nAcc, nId)")
.head 10 -  Return FALSE
.head 8 +  Else If nPr = -1
.head 9 +  If NOT SqlPLSQLCommand(hSql,
"sec.delAgrp(nAcc, nId)")
.head 10 -  Return FALSE
.head 9 -  Set List[nIterator].nId = NUMBER_Null
.head 9 -  Set List[nIterator].strName = ''
.head 8 -  Set List[nIterator].nPr = 0
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: Add
.head 6 -  Description: Добавить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  String: sName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nParNum].nId     = nId
.head 7 -  Set List[nParNum].strName = sName
.head 7 -  Set List[nParNum].nPr     = 1
.head 7 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Drop
.head 6 -  Description: Удалить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexById(nId)
.head 7 +  If nIndex != -1
.head 8 -  Set List[nIndex].nPr = -1
.head 7 -  Return TRUE
.head 5 +  Function: GetIndexById
.head 6 -  Description: получить индекс параметра в массиве по id
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nId = nId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 3 +  Functional Class: cAccRates
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nKod
.head 5 -  Number: nTar
.head 5 -  Number: nPr
.head 5 -  Number: nSMin
.head 5 -  Number: nKvSMin
.head 5 -  Number: nSMax
.head 5 -  Number: nKvSMax
.head 5 -  Date/Time: dBDate
.head 5 -  Date/Time: dEDate
.head 5 -  Boolean: bDelete
.head 5 -  Boolean: bChange
.head 4 -  Functions
.head 3 +  Functional Class: cAccRatesList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  : List[*]
.head 6 -  Class: cAccRates
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set nAcc    = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nKod
.head 7 -  Number: nTar
.head 7 -  Number: nPr
.head 7 -  Number: nSMin
.head 7 -  Number: nKvSMin
.head 7 -  Number: nSMax
.head 7 -  Number: nKvSMax
.head 7 -  Date/Time: dBDate
.head 7 -  Date/Time: dEDate
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"SELECT a.kod, a.tar, a.pr, a.smin, a.kv_smin, a.smax, a.kv_smax, a.bdate, a.edate 
   INTO :nKod, :nTar, :nPr, :nSMin, :nKvSMin, :nSMax, :nKvSMax, :dBDate, :dEDate 
   FROM v_acc_tarif a
  WHERE a.acc = :nAcc")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nKod    = nKod
.head 8 -  Set List[nParNum].nTar    = nTar
.head 8 -  Set List[nParNum].nPr     = nPr
.head 8 -  Set List[nParNum].nSMin   = nSMin
.head 8 -  Set List[nParNum].nKvSMin = nKvSMin
.head 8 -  Set List[nParNum].nSMax   = nSMax
.head 8 -  Set List[nParNum].nKvSMax = nKvSMax
.head 8 -  Set List[nParNum].dBDate  = dBDate
.head 8 -  Set List[nParNum].dEDate  = dEDate
.head 8 -  Set List[nParNum].bChange = FALSE
.head 8 -  Set List[nParNum].bDelete = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nExist
.head 7 -  Number: nKod
.head 7 -  Number: nTar
.head 7 -  Number: nPr
.head 7 -  Number: nSMin
.head 7 -  Number: nKvSMin
.head 7 -  Number: nSMax
.head 7 -  Number: nKvSMax
.head 7 -  Date/Time: dBDate
.head 7 -  Date/Time: dEDate
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nExist  = 0
.head 8 -  Set nKod    = List[nIterator].nKod
.head 8 -  Set nTar    = List[nIterator].nTar
.head 8 -  Set nPr     = List[nIterator].nPr
.head 8 -  Set nSMin   = List[nIterator].nSMin
.head 8 -  Set nKvSMin = List[nIterator].nKvSMin
.head 8 -  Set nSMax   = List[nIterator].nSMax
.head 8 -  Set nKvSMax = List[nIterator].nKvSMax
.head 8 -  Set dBDate  = List[nIterator].dBDate
.head 8 -  Set dEDate  = List[nIterator].dEDate
.head 8 -  ! Удаление
.head 8 +  If List[nIterator].bDelete
.head 9 +  If NOT Delete(hSql, nKod)
.head 10 -  Return FALSE
.head 8 -  ! Добавление/изменение
.head 8 +  Else If List[nIterator].bChange
.head 9 -  ! Проверка: есть ли в таблице данные
.head 9 +  If NOT SqlPrepareAndExecute(hSql, "SELECT acc INTO :nExist FROM acc_tarif WHERE acc=:nAcc AND kod=:nKod")
.head 10 -  Return FALSE
.head 9 -  Call SqlFetchNext(hSql, nFetchRes)
.head 9 +  If NOT nExist
.head 10 +  If List[nIterator].nTar  != NUMBER_Null AND
   List[nIterator].nPr   != NUMBER_Null 
.head 11 +  If NOT SqlPrepareAndExecute( hSql,
"INSERT INTO acc_tarif(acc, kod, tar, pr, smin, kv_smin, smax, kv_smax, bdate, edate) 
 VALUES (:nAcc, :nKod, :nTar, :nPr, :nSMin, :nKvSMin, :nSMax, :nKvSMax, :dBDate, :dEDate)" )
.head 12 -  Return FALSE
.head 9 -  ! Запись с Acc и Kod в хранилище есть
.head 9 +  If nExist
.head 10 -  ! Если новое значение пустое - удаляем
.head 10 +  If List[nIterator].nTar   = NUMBER_Null AND
   List[nIterator].nPr    = NUMBER_Null AND
   List[nIterator].nSMin  = NUMBER_Null AND
   List[nIterator].nSMax  = NUMBER_Null AND
   List[nIterator].dBDate = DATETIME_Null AND
   List[nIterator].dEDate = DATETIME_Null
.head 11 +  If NOT Delete(hSql, List[nIterator].nKod)
.head 12 -  Return FALSE
.head 10 -  ! Обновляем значение
.head 10 +  Else
.head 11 +  If NOT SqlPrepareAndExecute(hSql,
"UPDATE acc_tarif
    SET tar     = nvl(:nTar,tar),
        pr      = nvl(:nPr,pr),
        smin    = :nSMin,
        kv_smin = :nKvSMin,
        smax    = :nSMax,
        kv_smax = :nKvSMax,
        bdate   = :dBDate,
        edate   = :dEDate 
  WHERE acc = :nAcc AND kod = :nKod")
.head 12 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPrepareAndExecute(hSql, "DELETE FROM acc_tarif WHERE acc = :nAcc AND kod = :nKod")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexByKod
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nKod
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nKod = nKod
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 -  !
.head 5 +  Function: getTar
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nTar
.head 5 +  Function: setTar
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nTar = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getPr
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nPr
.head 5 +  Function: setPr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nPr = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getSMin
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nSMin
.head 5 +  Function: setSMin
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nSMin = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getKvSMin
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nKvSMin
.head 5 +  Function: setKvSMin
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nKvSMin = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getSMax
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nSMax
.head 5 +  Function: setSMax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nSMax = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getKvSMax
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nKvSMax
.head 5 +  Function: setKvSMax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nKvSMax = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getBDate
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].dBDate
.head 5 +  Function: setBDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].dBDate = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getEDate
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod( nKod )
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].dEDate
.head 5 +  Function: setEDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].dEDate = dVal
.head 7 -  Return TRUE
.head 5 +  Function: setFlagChg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].bChange = bVal
.head 7 -  Return TRUE
.head 5 +  Function: setFlagDel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nKod
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByKod(nKod)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].bDelete = bVal
.head 7 -  Return TRUE
.head 3 +  Functional Class: cAccSob
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nId
.head 5 -  Number: nIsp
.head 5 -  String: sFio
.head 5 -  Date/Time: dDat
.head 5 -  Long String: sTxt
.head 4 -  Functions
.head 3 +  Functional Class: cAccSobList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  : List[*]
.head 6 -  Class: cAccSob
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set nAcc    = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nId
.head 7 -  Number: nIsp
.head 7 -  String: sFio
.head 7 -  Date/Time: dDat
.head 7 -  Long String: sTxt
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If NOT SqlPrepareAndExecute( hSql,
"SELECT a.fdat, a.id, a.isp, s.fio, a.txt 
 INTO :dDat, :nId, :nIsp, :sFio, :sTxt
 FROM acc_sob a, staff$base s
 WHERE a.isp=s.id AND a.acc=:nAcc 
 ORDER BY a.fdat, a.id")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext( hSql, nFetchRes )
.head 8 -  Set List[nParNum].nId  = nId
.head 8 -  Set List[nParNum].nIsp = nIsp
.head 8 -  Set List[nParNum].sFio = sFio
.head 8 -  Set List[nParNum].dDat = dDat
.head 8 -  Set List[nParNum].sTxt = sTxt
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Insert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nIsp
.head 7 -  Date/Time: dDat
.head 7 -  Long String: sTxt
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"INSERT INTO acc_sob(acc,isp,fdat,txt) 
 VALUES(:nAcc,:nIsp,:dDat,:sTxt)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nId
.head 7 -  Number: nIsp
.head 7 -  Date/Time: dDat
.head 7 -  Long String: sTxt
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  ! Если новые значения пустые - удаляем
.head 8 +  If List[nIterator].nIsp = NUMBER_Null AND
   List[nIterator].dDat = DATETIME_Null AND
   List[nIterator].sTxt = STRING_Null 
.head 9 +  If NOT Delete(hSql, List[nIterator].nId)
.head 10 -  Return FALSE
.head 8 -  ! Обновляем значение
.head 8 +  Else
.head 9 -  Set nId  = List[nIterator].nId
.head 9 -  Set nIsp = List[nIterator].nIsp
.head 9 -  Set dDat = List[nIterator].dDat
.head 9 -  Set sTxt = List[nIterator].sTxt
.head 9 +  If NOT SqlPrepareAndExecute( hSql,
"UPDATE acc_sob
 SET isp=:nIsp, fdat=:dDat, txt=:sTxt 
 WHERE acc=:nAcc AND id=:nId" )
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Call Populate(hSql)
.head 7 -  Return TRUE
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"DELETE FROM acc_sob WHERE acc=:nAcc AND id=:nId")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по Id
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nId = nId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 -  !
.head 5 +  Function: getIsp
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return List[nIndex].nIsp
.head 5 +  Function: setIsp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nIndex].nIsp = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getDat
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return List[nIndex].dDat
.head 5 +  Function: setDat
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nIndex].dDat = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getTxt
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return List[nIndex].sTxt
.head 5 +  Function: setTxt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nIndex].sTxt = sVal
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return List[nIndex].nId
.head 5 +  Function: getFio
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return List[nIndex].sFio
.head 3 -  ! Класс для работы со спецпараметрами
.head 3 -  ! Рассчитан на таблицу описания спецпараметров
.head 3 +  Functional Class: cSParam
.head 4 -  Description: Описание спецпараметра
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nSpId
.head 5 -  String: strName
.head 5 -  String: strSemantic
.head 5 -  String: strStorage
.head 5 -  String: strNSI
.head 5 -  String: strValue
.head 5 -  String: strType
.head 5 -  String: strPKName
.head 5 -  Boolean: fDelOnNULL
.head 5 -  String: strNsiSqlWhere
.head 5 -  String: strOpt
.head 5 -  Long String: strSqlVal
.head 5 -  String: strSqlCondition
.head 5 -  String: strTag
.head 5 -  String: strTabColumnCheck
.head 5 -  String: strCode
.head 5 -  Boolean: fHist
.head 5 -  Boolean: fUpdate
.head 4 -  Functions
.head 3 +  Functional Class: cSParamList
.head 4 -  Description: Список спецпараметров
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  : List[*]
.head 6 -  Class: cSParam
.head 5 -  Number: nParNum
.head 5 -  Boolean: isEdit
.head 5 -  Number: nFetchRes
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set isEdit  = FALSE
.head 7 -  Set nAcc    = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Assign
.head 6 -  Description: Назначить идентификатор счета
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nAcc = nAccId
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  String: sNbs
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Long String: strSqlSelect
.head 7 -  Number: nSpId			! Идентификатор Параметра
.head 7 -  String: strPName		! Наименование
.head 7 -  String: strPSem			! Описание
.head 7 -  String: strPVal			! Значение
.head 7 -  String: sPVal			! Значение (строковый тип)
.head 7 -  Long String: lsPVal		! Значение (длинная строка)
.head 7 -  Number: nPVal			! Значение (число)
.head 7 -  Date/Time: dPVal		! Значение (дата)
.head 7 -  String: strPTab			! Имя таблицы хранилища параметра
.head 7 -  String: strPNSI			! Имя таблицы справочника
.head 7 -  String: strPType		! Тип параметра
.head 7 -  String: strPNamePK		! Ключ
.head 7 -  Number: nDelOnNull		! Флаг: удалять строку из справочника если значение спецпар-ра is null
.head 7 -  String: sNsiSqlWhere
.head 7 -  String: strOpt
.head 7 -  Long String: strSqlVal		! Условие фильтра для справочника
.head 7 -  String: strSqlCondition		! Условие для отбора параметра
.head 7 -  String: strTag			! Наименование поля (из accounts_field)
.head 7 -  String: strTabColumnCheck	! Контроль значения по полю
.head 7 -  String: strCode
.head 7 -  Boolean: fHist
.head 7 -  !
.head 7 -  Number: nIterator
.head 7 -  Number: nCount
.head 7 -  Number: nCond
.head 6 +  Actions
.head 7 -  ! для sNBS != ''
.head 7 -  Set nParNum = 0
.head 7 +  If NOT SqlPrepareAndExecute(hSql, "SELECT count(*) INTO :nCount FROM ps_sparam WHERE nbs=:sNbs")
.head 8 -  Return FALSE
.head 7 +  If NOT SqlFetchNext(hSql, nFetchRes)
.head 8 -  Return FALSE
.head 7 +  If nCount != 0
.head 8 -  Set strSqlSelect = 
"SELECT DISTINCT l.spid, l.name, l.semantic, upper(l.tabname), upper(rtrim(l.type)), 
        upper(l.nsiname), upper(l.pkname), l.delonnull, upper(l.nsisqlwhere), 
        s.opt, s.sqlval, l.sqlcondition, l.tag, l.tabcolumn_check, l.code, nvl(l.hist,0)
   INTO :nSpId, :strPName, :strPSem, :strPTab, :strPType, 
        :strPNSI, :strPNamePK, :nDelOnNull, :sNsiSqlWhere, 
        :strOpt, :strSqlVal, :strSqlCondition, :strTag, :strTabColumnCheck, :strCode, :fHist
   FROM sparam_list l, ps_sparam s, ps p 
  WHERE p.nbs=:sNbs AND p.nbs=s.nbs AND s.spid=l.spid AND l.inuse = 1 
  order by s.opt, l.semantic"
.head 8 -  Call SqlSetLongBindDatatype(10, 22)
.head 7 +  Else
.head 8 -  Set strSqlSelect = 
"SELECT spid, name, semantic, upper(tabname), upper(rtrim(type)), 
        upper(nsiname), upper(pkname), delonnull, upper(nsisqlwhere), 
        '', sqlcondition, tag, tabcolumn_check, code, hist
   INTO :nSpId, :strPName, :strPSem, :strPTab, :strPType, 
        :strPNSI, :strPNamePK, :nDelOnNull, :sNsiSqlWhere, 
        :strOpt, :strSqlCondition, :strTag, :strTabColumnCheck, :strCode, :fHist
   FROM sparam_list WHERE inuse = 1 
  order by semantic"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, strSqlSelect)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set nCond = 1
.head 8 +  If strSqlCondition
.head 9 +  If NOT SqlPrepareAndExecute(hSqlAux(),
"SELECT count(*) INTO :nCond 
 FROM accounts a 
 WHERE a.acc=:nAcc AND (" || strSqlCondition || ")")
.head 10 -  Return FALSE
.head 9 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 8 +  If nCond != 0
.head 9 -  ! Защита от дурака
.head 9 +  If strPTab = 'ACCOUNTSW' and strTag = ''
.head 10 -  Call SalMessageBox('Некорректно заполнен справочник спецпараметров счетов!', 'Внимание!', MB_IconExclamation | MB_Ok)
.head 10 -  Return FALSE
.head 9 -  Set List[nParNum].nSpId = nSpId
.head 9 -  Set List[nParNum].strName = strPName
.head 9 -  Set List[nParNum].strSemantic = strPSem
.head 9 -  Set List[nParNum].strType = strPType
.head 9 -  Set List[nParNum].strStorage = strPTab
.head 9 -  Set List[nParNum].strNSI = strPNSI
.head 9 -  Set List[nParNum].strPKName = strPNamePK
.head 9 -  Set List[nParNum].fDelOnNULL = nDelOnNull
.head 9 -  Set List[nParNum].strNsiSqlWhere = sNsiSqlWhere
.head 9 -  Set List[nParNum].strOpt = strOpt
.head 9 -  Set List[nParNum].strSqlVal = IifS(nCount!=0,strSqlVal,'')
.head 9 -  Set List[nParNum].strTag = strTag
.head 9 -  Set List[nParNum].strTabColumnCheck = strTabColumnCheck
.head 9 -  Set List[nParNum].strCode = strCode
.head 9 -  Set List[nParNum].fHist = fHist
.head 9 -  Set List[nParNum].fUpdate = FALSE
.head 9 -  Set nParNum = nParNum + 1
.head 7 -  !
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].fHist
.head 9 -  Set strPVal = 'sPVal'
.head 8 +  Else If List[nIterator].strTag != ''
.head 9 -  Set strPVal = 'sPVal'
.head 8 +  Else If List[nIterator].strType = 'N'
.head 9 -  Set strPVal = 'nPVal'
.head 8 +  Else If List[nIterator].strType = 'D'
.head 9 -  Set strPVal = 'dPVal'
.head 8 +  Else If List[nIterator].strType = 'L'
.head 9 -  Set strPVal = 'lsPVal'
.head 9 -  Call SqlSetLongBindDatatype(1, 22)
.head 8 +  Else
.head 9 -  Set strPVal = 'sPVal'
.head 8 +  If SqlPrepareAndExecute(hSql,
"SELECT " || List[nIterator].strName || " INTO :" || strPVal || " FROM " || List[nIterator].strStorage ||
" WHERE acc=:nAcc" || 
        IifS(List[nIterator].fHist=1, " and parid = " || Str(List[nIterator].nSpId) || " and bankdate between dat1 and dat2",
        IifS(List[nIterator].strTag='', "", " AND tag='" || List[nIterator].strTag || "'")))
.head 9 +  If SqlFetchNext(hSql, nFetchRes)
.head 10 +  If List[nIterator].fHist
.head 11 -  Set List[nIterator].strValue = sPVal
.head 10 +  Else If List[nIterator].strTag != ''
.head 11 -  Set List[nIterator].strValue = sPVal
.head 10 +  Else If List[nIterator].strType = 'N'
.head 11 -  Set List[nIterator].strValue = Str(nPVal)
.head 10 +  Else If List[nIterator].strType = 'D'
.head 11 -  Set List[nIterator].strValue = SalFmtFormatDateTime(dPVal, 'dd/MM/yyyy')
.head 10 +  Else If List[nIterator].strType = 'L'
.head 11 -  Set List[nIterator].strValue = lsPVal
.head 10 +  Else
.head 11 -  Set List[nIterator].strValue = sPVal
.head 9 +  Else
.head 10 -  Set List[nIterator].strValue = ""
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  String: strProcedure
.head 7 -  ! String: strPVal
.head 7 -  ! String: sPVal			! Значение (строковый тип)
.head 7 -  ! Long String: lsPVal		! Значение (длинная строка)
.head 7 -  ! Number: nPVal			! Значение (число)
.head 7 -  ! Date/Time: dPVal		! Значение (дата)
.head 7 -  !
.head 7 -  ! Number: nExist
.head 7 -  ! String: strUsedStorage
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  If List[nIterator].fHist
.head 8 +  Else If List[nIterator].fUpdate
.head 9 +  If List[nIterator].strTag = ''
.head 10 -  Set strProcedure = "accreg.setAccountSParam(nAcc, List[nIterator].strName, List[nIterator].strValue)"
.head 9 +  Else
.head 10 -  Set strProcedure = "accreg.setAccountwParam(nAcc, List[nIterator].strTag, List[nIterator].strValue)"
.head 9 +  If NOT SqlPLSQLCommand(hSql, strProcedure)
.head 10 -  Return FALSE
.head 9 -  Set List[nIterator].fUpdate = FALSE
.head 9 -  !
.head 9 -  ! Set nExist = 0
.head 9 +  ! If NOT SqlPrepareAndExecute(hSql, 
"SELECT acc INTO :nExist FROM " || List[nIterator].strStorage || " 
  WHERE acc=:nAcc" || IifS(List[nIterator].strTag='', "", 
"   AND tag='" || List[nIterator].strTag || "'"))
.head 10 -       Return FALSE
.head 9 -  ! Call SqlFetchNext(hSql, nFetchRes)
.head 9 +  ! If NOT nExist
.head 10 +       If List[nIterator].strValue != ''
.head 11 +       If not SqlPrepareAndExecute(hSql, 
"INSERT INTO " || List[nIterator].strStorage || " (acc" || IifS(List[nIterator].strTag='', "", ",tag") || ") 
 VALUES (:nAcc" || IifS(List[nIterator].strTag='', "", ",'" || List[nIterator].strTag || "'") || ")" )
.head 12 -       Return FALSE
.head 11 -       Set nExist = 1
.head 9 -  ! Запись с Acc в хранилище есть
.head 9 +  ! If nExist
.head 10 -  ! Обновление пустым значением и признак удаления пустых - нужно удалять
.head 10 +       If List[nIterator].strValue = '' AND List[nIterator].fDelOnNULL
.head 11 -  ! Ранее не было обновлено значений
.head 11 +       If SalStrScan(strUsedStorage, List[nIterator].strStorage || ';') = -1
.head 12 +       If NOT SqlPrepareAndExecute(hSql, 
"DELETE FROM " || List[nIterator].strStorage || " 
 WHERE acc=:nAcc" || IifS(List[nIterator].strTag='', "", 
"  AND tag='" || List[nIterator].strTag || "'") )
.head 13 -       Return FALSE
.head 10 -  ! Обновляем значение
.head 10 +       Else 
.head 11 -  ! если List[nIterator].strTag != '', сохраняем в табл. типа accountsw и value = STRING, т.е. нам нужна переменная типа string
.head 11 +       If List[nIterator].strType = 'N' and List[nIterator].strTag = ''
.head 12 -       Set strPVal = 'nPVal'
.head 12 -       Set nPVal = SalStrToNumber(List[nIterator].strValue)
.head 12 +       If List[nIterator].strValue = ''
.head 13 -       Set nPVal = NUMBER_Null
.head 11 +       Else If List[nIterator].strType = 'D' and List[nIterator].strTag = ''
.head 12 -       Set strPVal = 'dPVal'
.head 12 -       Set dPVal = SalStrToDate(List[nIterator].strValue)
.head 11 +       Else If List[nIterator].strType = 'L' and List[nIterator].strTag = ''
.head 12 -       Set strPVal = 'lsPVal'
.head 12 -       Set lsPVal = List[nIterator].strValue
.head 12 -       Call SqlSetLongBindDatatype(1, 22)
.head 11 +       Else 
.head 12 -       Set strPVal = 'sPVal'
.head 12 -       Set sPVal = List[nIterator].strValue
.head 11 +       If NOT SqlPrepareAndExecute(hSql,
"UPDATE " || List[nIterator].strStorage || " SET " || List[nIterator].strName || "=:" || strPVal || "
  WHERE acc=:nAcc" || IifS(List[nIterator].strTag='', "", 
"   AND tag='" || List[nIterator].strTag || "'"))
.head 12 -       Return FALSE
.head 11 +       If SalStrScan(strUsedStorage, List[nIterator].strStorage || ';') = -1 and List[nIterator].strTag = ''
.head 12 -       Set strUsedStorage = strUsedStorage || List[nIterator].strStorage || ';'
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: GetV
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: strName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByName( strName )
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].strValue
.head 5 +  Function: SetV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nSpId
.head 7 -  String: strName
.head 7 -  String: strValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 +  If nSpId
.head 8 -  Set nIndex = GetIndexBySpId(nSpId)
.head 7 +  Else
.head 8 -  Set nIndex = GetIndexByName(strName)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].strValue = strValue
.head 7 -  Set List[nIndex].fUpdate  = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: SetProfData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  String: sNbs
.head 7 -  Number: nNbsProf
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nExist
.head 7 -  Number: nProfId
.head 7 -  String: sProfVal
.head 7 -  Long String: sProfSql
.head 7 -  String: sValue
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute(hSqlAux2(),
"SELECT v.id, v.val, v.sql_text 
 INTO :nProfId, :sProfVal, :sProfSql 
 FROM v_nbs_prof v, sparam_list s
 WHERE v.nbs=:sNbs AND v.np=:nNbsProf AND v.id=s.spid AND v.pr=2")
.head 7 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 8 -  Set nIterator = 0
.head 8 +  While nIterator < nParNum
.head 9 +  If nProfId = List[nIterator].nSpId
.head 10 -  Set sValue = ''
.head 10 +  If sProfVal != ''
.head 11 -  Set sValue = sProfVal
.head 10 +  Else If sProfSql
.head 11 +  If NOT SqlPrepareAndExecute(hSqlAux3(), sProfSql || " INTO :sValue")
OR NOT SqlFetchNext(hSqlAux3(), nFetchRes)
.head 12 -  Set sValue = ''
.head 10 +  If sValue != ''
.head 11 -  Set nExist = 0
.head 11 +  If NOT SqlPrepareAndExecute(hSql, 
"SELECT acc INTO :nExist FROM " || List[nIterator].strStorage || " 
 WHERE acc = :nAcc" || IifS(List[nIterator].strTag='', "", 
"  AND tag='" || List[nIterator].strTag || "'"))
.head 12 -  Return FALSE
.head 11 -  Call SqlFetchNext(hSql, nFetchRes)
.head 11 +  If NOT nExist
.head 12 -  Call SqlPrepareAndExecute(hSql, 
"INSERT INTO " || List[nIterator].strStorage || " (acc" || IifS(List[nIterator].strTag='', "", ",tag") || ") 
 VALUES (:nAcc" || IifS(List[nIterator].strTag='', "", ",'" || List[nIterator].strTag || "'") || ")" )
.head 12 -  Set nExist = 1
.head 11 +  If nExist
.head 12 -  Set List[nIterator].strValue = sProfVal
.head 12 +  If NOT SqlPrepareAndExecute( hSql,
"UPDATE " || List[nIterator].strStorage || 
"   SET " || List[nIterator].strName || "=" || 
   IifS(List[nIterator].strType='D', 
        "TO_DATE('" || List[nIterator].strValue || "','DD-MM-YYYY')",
        IifS(List[nIterator].strType='N', 
             List[nIterator].strValue, 
             "'" || List[nIterator].strValue || "'")) || 
" WHERE acc=:nAcc" || IifS(List[nIterator].strTag='', "", 
"   AND tag='" || List[nIterator].strTag || "'"))
.head 13 -  Return FALSE
.head 9 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: GetIndexByName
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: strName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT strName
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If SalStrUpperX(SalStrTrimX(List[nIterator].strName)) = SalStrUpperX( SalStrTrimX(strName))
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: GetIndexBySpId
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nSpId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nSpId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nSpId = nSpId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 3 +  Functional Class: cAccRatn
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Date/Time: dBDat
.head 5 -  Date/Time: dBDatEta
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 5 -  Boolean: bInserted
.head 5 -  Boolean: bUpdated
.head 5 -  Boolean: bDeleted
.head 4 -  Functions
.head 3 +  Functional Class: cAccAcrn
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nId
.head 5 -  Number: nMetr
.head 5 -  Number: nBaseM
.head 5 -  Number: nBaseY
.head 5 -  Number: nFreq
.head 5 -  Date/Time: dStpDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dAplDat
.head 5 -  String: sTt
.head 5 -  Number: nAcrA
.head 5 -  Number: nAcrB
.head 5 -  String: sTtB
.head 5 -  Number: nKvB
.head 5 -  String: sNlsB
.head 5 -  String: sNamB
.head 5 -  String: sMfo
.head 5 -  String: sOkpo
.head 5 -  String: sNazn
.head 5 -  Number: nIo
.head 5 -  : RatnList[*]
.head 6 -  Class: cAccRatn
.head 5 -  Number: nRatnParNum
.head 5 -  Boolean: bInserted
.head 5 -  Boolean: bUpdated
.head 4 -  Functions
.head 3 +  Functional Class: cAccAcrnList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  : List[*]
.head 6 -  Class: cAccAcrn
.head 5 -  Number: nParNum
.head 5 -  ! Number: nParNumRatn
.head 5 -  Boolean: bIo
.head 5 -  Number: nFetchRes
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAccId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  ! Set nParNumRatn = 0
.head 7 -  Set nAcc = nAccId
.head 7 +  If GetGlobalOption('IO%') = 'Y'
.head 8 -  Set bIo = TRUE
.head 7 +  Else
.head 8 -  Set bIo = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bIo
.head 7 -  Number: nId
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 7 -  Date/Time: dBDat
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 6 +  Actions
.head 7 +  If GetGlobalOption('IO%') = 'Y'
.head 8 -  Set bIo = TRUE
.head 7 +  Else
.head 8 -  Set bIo = FALSE
.head 7 -  Set nParNum = 0
.head 7 +  If not SqlPrepareAndExecute(hSql,
"SELECT id, metr, basem, basey, freq, stp_dat, acr_dat, apl_dat, tt, acrA, acrB,
        ttb, mfob, kvb, nlsb, namb, okpo, nazn, " || IifS(bIo,"io","0") || "
   INTO :nId, :nMetr, :nBaseM, :nBaseY, :nFreq, :dStpDat, :dAcrDat, :dAplDat,
        :sTt, :nAcrA, :nAcrB, :sTtB, :sMfo, :nKvB, :sNlsB, :sNamB, :sOkpo, :sNazn, :nIo
   FROM int_accn
  WHERE acc = :nAcc")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nId     = nId
.head 8 -  Set List[nParNum].nMetr   = nMetr
.head 8 -  Set List[nParNum].nBaseM  = nBaseM
.head 8 -  Set List[nParNum].nBaseY  = nBaseY
.head 8 -  Set List[nParNum].nFreq   = nFreq
.head 8 -  Set List[nParNum].dStpDat = dStpDat
.head 8 -  Set List[nParNum].dAcrDat = dAcrDat
.head 8 -  Set List[nParNum].dAplDat = dAplDat
.head 8 -  Set List[nParNum].sTt     = sTt
.head 8 -  Set List[nParNum].nAcrA   = nAcrA
.head 8 -  Set List[nParNum].nAcrB   = nAcrB
.head 8 -  Set List[nParNum].sTtB    = sTtB
.head 8 -  Set List[nParNum].sMfo    = sMfo
.head 8 -  Set List[nParNum].nKvB    = nKvB
.head 8 -  Set List[nParNum].sNlsB   = sNlsB
.head 8 -  Set List[nParNum].sNamB   = sNamB
.head 8 -  Set List[nParNum].sOkpo   = sOkpo
.head 8 -  Set List[nParNum].sNazn   = sNazn
.head 8 -  Set List[nParNum].nIo     = nIo
.head 8 -  Set List[nParNum].bInserted = FALSE
.head 8 -  Set List[nParNum].bUpdated  = FALSE
.head 8 -  Set List[nParNum].nRatnParNum = 0
.head 8 +  If not SqlPrepareAndExecute(hSqlAux(),
"SELECT i.bdat, i.ir, i.br, i.op
   INTO :dBDat, :nIr, :nBr, :nOp
   FROM int_ratn i
  WHERE i.acc = :nAcc
    AND i.id  = :nId
  ORDER BY i.bdat")
.head 9 -  Return FALSE
.head 8 +  While SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].dBDat = dBDat
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].dBDatEta = dBDat
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].nIr   = nIr
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].nBr   = nBr
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].nOp   = nOp
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].bInserted = FALSE
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].bUpdated = FALSE
.head 9 -  Set List[nParNum].RatnList[List[nParNum].nRatnParNum].bDeleted = FALSE
.head 9 -  Set List[nParNum].nRatnParNum = List[nParNum].nRatnParNum + 1
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  ! Function: Update
.head 6 -       Description: Сохранить значения в базе данных
.head 6 +       Returns 
.head 7 -       Boolean: 
.head 6 +       Parameters 
.head 7 -       Sql Handle: hSql
.head 6 -       Static Variables 
.head 6 +       Local variables 
.head 7 -       Number: nIterator
.head 7 -       Number: nI
.head 7 -       Number: nId
.head 7 -       Number: nMetr
.head 7 -       Number: nBaseM
.head 7 -       Number: nBaseY
.head 7 -       Number: nFreq
.head 7 -       Date/Time: dStpDat
.head 7 -       Date/Time: dAcrDat
.head 7 -       Date/Time: dAplDat
.head 7 -       String: sTt
.head 7 -       Number: nAcrA
.head 7 -       Number: nAcrB
.head 7 -       String: sTtB
.head 7 -       Number: nKvB
.head 7 -       String: sNlsB
.head 7 -       String: sNamB
.head 7 -       String: sMfo
.head 7 -       String: sOkpo
.head 7 -       String: sNazn
.head 7 -       Number: nIo
.head 7 -       Date/Time: dBDat
.head 7 -       Date/Time: dBDatEta
.head 7 -       Number: nIr
.head 7 -       Number: nBr
.head 7 -       Number: nOp
.head 6 +       Actions 
.head 7 -       Set nIterator = 0
.head 7 +       While nIterator < nParNum
.head 8 -       Set nId     = List[nIterator].nId
.head 8 -       Set nMetr   = List[nIterator].nMetr
.head 8 -       Set nBaseM  = List[nIterator].nBaseM
.head 8 -       Set nBaseY  = List[nIterator].nBaseY
.head 8 -       Set nFreq   = List[nIterator].nFreq
.head 8 -       Set dStpDat = List[nIterator].dStpDat
.head 8 -       Set dAcrDat = List[nIterator].dAcrDat
.head 8 -       Set dAplDat = List[nIterator].dAplDat
.head 8 -       Set sTt     = List[nIterator].sTt
.head 8 -       Set nAcrA   = List[nIterator].nAcrA
.head 8 -       Set nAcrB   = List[nIterator].nAcrB
.head 8 -       Set sTtB    = List[nIterator].sTtB
.head 8 -       Set sMfo    = List[nIterator].sMfo
.head 8 -       Set nKvB    = List[nIterator].nKvB
.head 8 -       Set sNlsB   = List[nIterator].sNlsB
.head 8 -       Set sNamB   = List[nIterator].sNamB
.head 8 -       Set sOkpo   = List[nIterator].sOkpo
.head 8 -       Set sNazn   = List[nIterator].sNazn
.head 8 -       Set nIo     = List[nIterator].nIo
.head 8 +       If List[nIterator].bInserted
.head 9 +       If not SqlPrepareAndExecute(hSql,
"INSERT INTO Int_accN (acc, id, metr, basem, basey, freq,
        stp_dat, acr_dat, apl_dat, tt, acra, acrb,
        ttb, mfob, kvb, nlsb, namb, nazn, okpo" || IifS(bIo,",io","") || ")
 VALUES (:nAcc, :nId, :nMetr, :nBaseM, :nBaseY, :nFreq,
         :dStpDat, :dAcrDat, :dAplDat, :sTt, :nAcrA, :nAcrB,
         :sTtB, :sMfo, :nKvB, :sNlsB, :sNamB, :sNazn, :sOkpo" || IifS(bIo,",:nIo","") || ")")
.head 10 -       Return FALSE 
.head 8 +       Else If List[nIterator].bUpdated
.head 9 +       If not SqlPrepareAndExecute(hSql, 
"UPDATE int_accN
    SET metr    = :nMetr,
        basem   = :nBaseM,
        basey   = :nBaseY,
        freq    = :nFreq,
        stp_dat = :dStpDat,
        acr_dat = :dAcrDat,
        apl_dat = :dAplDat,
        tt      = :sTt,
        acra    = :nAcrA,
        acrb    = :nAcrB,
        ttb     = :sTtB,
        mfob    = :sMfo,
        kvb     = :nKvB,
        nlsb    = :sNlsB,
        namb    = :sNamB,
        okpo    = :sOkpo,
        nazn    = :sNazn" || IifS(bIo,",io=:nIo","") || "
  WHERE acc = :nAcc AND id = :nId" )
.head 10 -       Return FALSE 
.head 8 -       Set nI = 0
.head 8 +       While nI < List[nIterator].nRatnParNum
.head 9 -       Set dBDat = List[nIterator].RatnList[nI].dBDat
.head 9 -       Set dBDatEta = List[nIterator].RatnList[nI].dBDatEta
.head 9 -       Set nIr   = List[nIterator].RatnList[nI].nIr
.head 9 -       Set nBr   = List[nIterator].RatnList[nI].nBr
.head 9 -       Set nOp   = List[nIterator].RatnList[nI].nOp
.head 9 +       If List[nIterator].RatnList[nI].bDeleted
.head 10 +       If not SqlPrepareAndExecute(hSqlAux(), 
"DELETE FROM int_ratN
  WHERE acc = :nAcc and id = :nId and bdat = :dBDat")
.head 11 -       Return FALSE 
.head 9 +       Else If List[nIterator].RatnList[nI].bInserted
.head 10 +       If not SqlPrepareAndExecute(hSqlAux(), 
"INSERT INTO Int_ratN (acc, id, bdat, op, ir, br)
 VALUES (:nAcc, :nId, :dBDat, :nOp, :nIr, :nBr)")
.head 11 -       Return FALSE 
.head 9 +       If List[nIterator].RatnList[nI].bUpdated
.head 10 +       If not SqlPrepareAndExecute(hSqlAux(), 
"UPDATE Int_ratN
    SET bdat = :dBDat,
        ir = :nIr,
        br = :nBr,
        op = :nOp
  WHERE acc = :nAcc and id = :nId and bdat = :dBDatEta")
.head 11 -       Return FALSE 
.head 9 -       Set List[nIterator].RatnList[nI].bInserted = FALSE
.head 9 -       Set List[nIterator].RatnList[nI].bUpdated = FALSE
.head 9 -       Set List[nIterator].RatnList[nI].bDeleted = FALSE
.head 9 -       Set nI = nI + 1
.head 8 -       Set nIterator = nIterator + 1
.head 7 -       Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nI
.head 7 -  Number: nId
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 7 -  Date/Time: dBDat
.head 7 -  Date/Time: dBDatEta
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nId     = List[nIterator].nId
.head 8 -  Set nMetr   = List[nIterator].nMetr
.head 8 -  Set nBaseM  = List[nIterator].nBaseM
.head 8 -  Set nBaseY  = List[nIterator].nBaseY
.head 8 -  Set nFreq   = List[nIterator].nFreq
.head 8 -  Set dStpDat = List[nIterator].dStpDat
.head 8 -  Set dAcrDat = List[nIterator].dAcrDat
.head 8 -  Set dAplDat = List[nIterator].dAplDat
.head 8 -  Set sTt     = List[nIterator].sTt
.head 8 -  Set nAcrA   = List[nIterator].nAcrA
.head 8 -  Set nAcrB   = List[nIterator].nAcrB
.head 8 -  Set sTtB    = List[nIterator].sTtB
.head 8 -  Set sMfo    = List[nIterator].sMfo
.head 8 -  Set nKvB    = List[nIterator].nKvB
.head 8 -  Set sNlsB   = List[nIterator].sNlsB
.head 8 -  Set sNamB   = List[nIterator].sNamB
.head 8 -  Set sOkpo   = List[nIterator].sOkpo
.head 8 -  Set sNazn   = List[nIterator].sNazn
.head 8 -  Set nIo     = List[nIterator].nIo
.head 8 +  If List[nIterator].bInserted
.head 9 +  If not SqlPrepareAndExecute(hSql,
"INSERT INTO Int_accN (acc, id, metr, basem, basey, freq,
        stp_dat, acr_dat, apl_dat, tt, acra, acrb,
        ttb, mfob, kvb, nlsb, namb, nazn, okpo" || IifS(bIo,",io","") || ")
 VALUES (:nAcc, :nId, :nMetr, :nBaseM, :nBaseY, :nFreq,
         :dStpDat, :dAcrDat, :dAplDat, :sTt, :nAcrA, :nAcrB,
         :sTtB, :sMfo, :nKvB, :sNlsB, :sNamB, :sNazn, :sOkpo" || IifS(bIo,",:nIo","") || ")")
.head 10 -  Return FALSE 
.head 8 +  Else If List[nIterator].bUpdated
.head 9 +  If not SqlPrepareAndExecute(hSql, 
"UPDATE int_accN
    SET metr    = :nMetr,
        basem   = :nBaseM,
        basey   = :nBaseY,
        freq    = :nFreq,
        stp_dat = :dStpDat,
        acr_dat = :dAcrDat,
        apl_dat = :dAplDat,
        tt      = :sTt,
        acra    = :nAcrA,
        acrb    = :nAcrB,
        ttb     = :sTtB,
        mfob    = :sMfo,
        kvb     = :nKvB,
        nlsb    = :sNlsB,
        namb    = :sNamB,
        okpo    = :sOkpo,
        nazn    = :sNazn" || IifS(bIo,",io=:nIo","") || "
  WHERE acc = :nAcc AND id = :nId" )
.head 10 -  Return FALSE 
.head 8 -  Set nI = 0
.head 8 +  While nI < List[nIterator].nRatnParNum
.head 9 -  Set dBDat = List[nIterator].RatnList[nI].dBDat
.head 9 -  Set dBDatEta = List[nIterator].RatnList[nI].dBDatEta
.head 9 -  Set nIr   = List[nIterator].RatnList[nI].nIr
.head 9 -  Set nBr   = List[nIterator].RatnList[nI].nBr
.head 9 -  Set nOp   = List[nIterator].RatnList[nI].nOp
.head 9 +  If List[nIterator].RatnList[nI].bDeleted
.head 10 +  If not SqlPrepareAndExecute(hSqlAux(), 
"DELETE FROM int_ratN
  WHERE acc = :nAcc and id = :nId and bdat = :dBDat")
.head 11 -  Return FALSE 
.head 9 +  Else If List[nIterator].RatnList[nI].bInserted
.head 10 +  If not SqlPrepareAndExecute(hSqlAux(), 
"INSERT INTO Int_ratN (acc, id, bdat, op, ir, br)
 VALUES (:nAcc, :nId, :dBDat, :nOp, :nIr, :nBr)")
.head 11 -  Return FALSE 
.head 9 +  If List[nIterator].RatnList[nI].bUpdated
.head 10 +  If dBDat = dBDatEta
.head 11 +  If not SqlPrepareAndExecute(hSqlAux(), 
"UPDATE Int_ratN
    SET ir = :nIr,
        br = :nBr,
        op = :nOp
  WHERE acc = :nAcc and id = :nId and bdat = :dBDatEta")
.head 12 -  Return FALSE 
.head 10 +  Else
.head 11 +  If not SqlPrepareAndExecute(hSqlAux(), 
"DELETE FROM int_ratN
  WHERE acc = :nAcc and id = :nId and bdat = :dBDatEta")
.head 12 -  Return FALSE 
.head 11 +  If not SqlPrepareAndExecute(hSqlAux(), 
"INSERT INTO Int_ratN (acc, id, bdat, op, ir, br)
 VALUES (:nAcc, :nId, :dBDat, :nOp, :nIr, :nBr)")
.head 12 -  Return FALSE 
.head 9 -  Set List[nIterator].RatnList[nI].bInserted = FALSE
.head 9 -  Set List[nIterator].RatnList[nI].bUpdated = FALSE
.head 9 -  Set List[nIterator].RatnList[nI].bDeleted = FALSE
.head 9 -  Set nI = nI + 1
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: AddAccn
.head 6 -  Description: Добавить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nParNum].nId     = nId
.head 7 -  Set List[nParNum].nMetr   = nMetr
.head 7 -  Set List[nParNum].nBaseM  = nBaseM
.head 7 -  Set List[nParNum].nBaseY  = nBaseY
.head 7 -  Set List[nParNum].nFreq   = nFreq
.head 7 -  Set List[nParNum].dStpDat = dStpDat
.head 7 -  Set List[nParNum].dAcrDat = dAcrDat
.head 7 -  Set List[nParNum].dAplDat = dAplDat
.head 7 -  Set List[nParNum].sTt     = sTt
.head 7 -  Set List[nParNum].nAcrA   = nAcrA
.head 7 -  Set List[nParNum].nAcrB   = nAcrB
.head 7 -  Set List[nParNum].sTtB    = sTtB
.head 7 -  Set List[nParNum].sMfo    = sMfo
.head 7 -  Set List[nParNum].nKvB    = nKvB
.head 7 -  Set List[nParNum].sNlsB   = sNlsB
.head 7 -  Set List[nParNum].sNamB   = sNamB
.head 7 -  Set List[nParNum].sOkpo   = sOkpo
.head 7 -  Set List[nParNum].sNazn   = sNazn
.head 7 -  Set List[nParNum].nIo     = nIo
.head 7 -  Set List[nParNum].bInserted = TRUE
.head 7 -  Set List[nParNum].bUpdated  = FALSE
.head 7 -  Set List[nParNum].nRatnParNum = 0
.head 7 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: ChangeAccn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set List[nIndex].nMetr   = nMetr
.head 7 -  Set List[nIndex].nBaseM  = nBaseM
.head 7 -  Set List[nIndex].nBaseY  = nBaseY
.head 7 -  Set List[nIndex].nFreq   = nFreq
.head 7 -  Set List[nIndex].dStpDat = dStpDat
.head 7 -  Set List[nIndex].dAcrDat = dAcrDat
.head 7 -  Set List[nIndex].dAplDat = dAplDat
.head 7 -  Set List[nIndex].sTt     = sTt
.head 7 -  Set List[nIndex].nAcrA   = nAcrA
.head 7 -  Set List[nIndex].nAcrB   = nAcrB
.head 7 -  Set List[nIndex].sTtB    = sTtB
.head 7 -  Set List[nIndex].sMfo    = sMfo
.head 7 -  Set List[nIndex].nKvB    = nKvB
.head 7 -  Set List[nIndex].sNlsB   = sNlsB
.head 7 -  Set List[nIndex].sNamB   = sNamB
.head 7 -  Set List[nIndex].sOkpo   = sOkpo
.head 7 -  Set List[nIndex].sNazn   = sNazn
.head 7 -  Set List[nIndex].nIo     = nIo
.head 7 -  Set List[nIndex].bUpdated = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: SetAccn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nMetr
.head 7 -  Number: nBaseM
.head 7 -  Number: nBaseY
.head 7 -  Number: nFreq
.head 7 -  Date/Time: dStpDat
.head 7 -  Date/Time: dAcrDat
.head 7 -  Date/Time: dAplDat
.head 7 -  String: sTt
.head 7 -  Number: nAcrA
.head 7 -  Number: nAcrB
.head 7 -  String: sTtB
.head 7 -  Number: nKvB
.head 7 -  String: sNlsB
.head 7 -  String: sNamB
.head 7 -  String: sMfo
.head 7 -  String: sOkpo
.head 7 -  String: sNazn
.head 7 -  Number: nIo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexById(nId)
.head 7 +  If nIndex = -1
.head 8 -  Call AddAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 7 +  Else
.head 8 -  Call ChangeAccn(nIndex, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 7 -  Return TRUE
.head 5 +  Function: GetAccn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Receive Number: nMetr
.head 7 -  Receive Number: nBaseM
.head 7 -  Receive Number: nBaseY
.head 7 -  Receive Number: nFreq
.head 7 -  Receive Date/Time: dStpDat
.head 7 -  Receive Date/Time: dAcrDat
.head 7 -  Receive Date/Time: dAplDat
.head 7 -  Receive String: sTt
.head 7 -  Receive Number: nAcrA
.head 7 -  Receive Number: nAcrB
.head 7 -  Receive String: sTtB
.head 7 -  Receive Number: nKvB
.head 7 -  Receive String: sNlsB
.head 7 -  Receive String: sNamB
.head 7 -  Receive String: sMfo
.head 7 -  Receive String: sOkpo
.head 7 -  Receive String: sNazn
.head 7 -  Receive Number: nIo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexById(nId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set nMetr   = List[nIndex].nMetr
.head 7 -  Set nBaseM  = List[nIndex].nBaseM
.head 7 -  Set nBaseY  = List[nIndex].nBaseY
.head 7 -  Set nFreq   = List[nIndex].nFreq
.head 7 -  Set dStpDat = List[nIndex].dStpDat
.head 7 -  Set dAcrDat = List[nIndex].dAcrDat
.head 7 -  Set dAplDat = List[nIndex].dAplDat
.head 7 -  Set sTt     = List[nIndex].sTt
.head 7 -  Set nAcrA   = List[nIndex].nAcrA
.head 7 -  Set nAcrB   = List[nIndex].nAcrB
.head 7 -  Set sTtB    = List[nIndex].sTtB
.head 7 -  Set sMfo    = List[nIndex].sMfo
.head 7 -  Set nKvB    = List[nIndex].nKvB
.head 7 -  Set sNlsB   = List[nIndex].sNlsB
.head 7 -  Set sNamB   = List[nIndex].sNamB
.head 7 -  Set sOkpo   = List[nIndex].sOkpo
.head 7 -  Set sNazn   = List[nIndex].sNazn
.head 7 -  Set nIo     = List[nIndex].nIo
.head 7 -  Return TRUE
.head 5 +  Function: GetIndexById
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If nId = NUMBER_Null
.head 8 -  Return -1
.head 7 -  Set fFound = FALSE
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nId = nId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 -  !
.head 5 +  Function: AddRatn
.head 6 -  Description: Добавить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Date/Time: dBDat
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 7 -  Receive Number: nRatnIndex
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexById(nId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].dBDat = dBDat
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].dBDatEta = DATETIME_Null
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].nIr   = nIr
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].nBr   = nBr
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].nOp   = nOp
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].bInserted = TRUE
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].bUpdated = FALSE
.head 7 -  Set List[nIndex].RatnList[List[nIndex].nRatnParNum].bDeleted = FALSE
.head 7 -  Set List[nIndex].nRatnParNum = List[nIndex].nRatnParNum + 1
.head 7 -  Set nRatnIndex = List[nIndex].nRatnParNum
.head 7 -  Return TRUE
.head 5 +  Function: SetRatn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 7 -  Date/Time: dBDat
.head 7 -  Number: nIr
.head 7 -  Number: nBr
.head 7 -  Number: nOp
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nAccnIndex
.head 7 -  ! Number: nRatnIndex
.head 6 +  Actions
.head 7 -  Set nAccnIndex = GetIndexById(nId)
.head 7 +  If nAccnIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nAccnIndex].RatnList[nRatnIndex].dBDat = dBDat
.head 7 -  Set List[nAccnIndex].RatnList[nRatnIndex].nIr = nIr
.head 7 -  Set List[nAccnIndex].RatnList[nRatnIndex].nBr = nBr
.head 7 -  Set List[nAccnIndex].RatnList[nRatnIndex].nOp = nOp
.head 7 -  Set List[nAccnIndex].RatnList[nRatnIndex].bUpdated = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: DropRatn
.head 6 -  Description: Удалить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nAccnIndex
.head 6 +  Actions
.head 7 -  Set nAccnIndex = GetIndexById(nId)
.head 7 +  If nAccnIndex != -1
.head 8 -  Set List[nAccnIndex].RatnList[nRatnIndex].bInserted = FALSE
.head 8 -  Set List[nAccnIndex].RatnList[nRatnIndex].bUpdated = FALSE
.head 8 -  Set List[nAccnIndex].RatnList[nRatnIndex].bDeleted = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: GetRatn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 7 -  Number: nRatnIndex
.head 7 -  Receive Date/Time: dBDat
.head 7 -  Receive Number: nIr
.head 7 -  Receive Number: nBr
.head 7 -  Receive Number: nOp
.head 7 -  Receive Boolean: bIns
.head 7 -  Receive Boolean: bUpd
.head 7 -  Receive Boolean: bDel
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nAccnIndex
.head 6 +  Actions
.head 7 -  Set nAccnIndex = GetIndexById(nId)
.head 7 +  If nAccnIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set dBDat = List[nAccnIndex].RatnList[nRatnIndex].dBDat
.head 7 -  Set nIr   = List[nAccnIndex].RatnList[nRatnIndex].nIr
.head 7 -  Set nBr   = List[nAccnIndex].RatnList[nRatnIndex].nBr
.head 7 -  Set nOp   = List[nAccnIndex].RatnList[nRatnIndex].nOp
.head 7 -  Set bIns  = List[nAccnIndex].RatnList[nRatnIndex].bInserted
.head 7 -  Set bUpd  = List[nAccnIndex].RatnList[nRatnIndex].bUpdated
.head 7 -  Set bDel  = List[nAccnIndex].RatnList[nRatnIndex].bDeleted
.head 7 -  Return TRUE
.head 5 +  Function: GetIndexByBDat
.head 6 -  Description: получить индекс параметра в массиве по Id, BDat
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nAccnIndex
.head 7 -  Date/Time: dBDat
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If not dBDat
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < List[nAccnIndex].nRatnParNum
.head 8 +  If List[nAccnIndex].RatnList[nIterator].dBDat = dBDat
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
