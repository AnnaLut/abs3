Application Description: Функциональность клиент-банка(XML)
		***********************************
		* (C) Унити-БАРС, 2008          *
		*********************************** 
		Сюдаже форма по ведению корпоративных клиентов
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000F90000 002C000000030000 00030000004B0000 00C6000000F8FFFF
0040: FFE2FFFFFFFCFFFF FFFEFFFFFF720200 00C3010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730E7570
0080: 6C6F61644D657461 44617461
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001C51 3A5C424152533938 5C4C494252415259 5C4162736170692E
0020: 646C6C1C513A5C42 41525339385C4C49 42524152595C4162 736170692E617063
0040: 00000101011C513A 5C4241525339385C 4C4942524152595C 4162736170692E72
0060: 756E1C513A5C4241 525339385C4C4942 524152595C416273 6170692E646C6C1C
0080: 513A5C4241525339 385C4C4942524152 595C416273617069 2E61706300000101
00A0: 0119443A5C626172 7339385C42494E5C 626172733032392E 61706418443A5C62
00C0: 61727339385C4249 4E5C416273617069 2E646C6C18443A5C 6261727339385C42
00E0: 494E5C4162736170 692E617063000001 0101001C513A5C42 41525339385C4C49
0100: 42524152595C4162 736170692E646C6C 1C513A5C42415253 39385C4C49425241
0120: 52595C4162736170 692E617063000001 0101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0218B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: ABSAPI.APD
		File Include: Constant.apl
		Dynalib: Global.apd
		File Include: GENBUTN.APL
		Dynalib: Message.apd
		File Include: Winapi.apl
		File Include: Ttp32.apl
		File Include: GENLIST.APL
		File Include: GENTBL.APL
		File Include: GENTIMER.APL
		File Include: GENTBLD.APL
		Dynalib: DOCVIEW.APD
		File Include: Winbars2.apl
		File Include: Vtarray.apl
		File Include: Vtcal.apl
		File Include: Vtfile.apl
		File Include: vtdos.apl
		File Include: VTCOMDLG.APL
		File Include: VTMETER.APL
		File Include: XSALCPT.APL
		File Include: XSALIMG.APL
		File Include: XSALSPL.APL
		!
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd-MM-yyyy hh:mm:ss
			Date/Time: dd/MM/yyyy hh:mm
			Date/Time: dd/MM/yyyy
			Date/Time: dd/MM/yyyy hhhh:mm
			Date/Time: dd/MM/yyyy hhhh:mm:ss
			Date/Time: dd/MM/yy hhhh:mm:ss
		External Functions
			Library name: DSGBVC4.DLL
				! DSGBVC4.DLL - экспортируемые функции
				Function: nsignInitGBSign
					Description: int GLOBAL nsignInitGBSign(char *dbDir,
							                           char *secKeyDisk,
							                           char *pin,
							                           char *mfo,
							                           int mode)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						Number: INT
				Function: nsignExitGBSign
					Description: int GLOBAL nsignExitGBSign(void)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
				Function: nsignInitOPSign
					Description: int GLOBAL nsignInitOPSign(char *dbDir,
							                           char *secKeyDisk,
							                           char *pin,
							                           char *mfo)
							int DSGBEXT nsignInitOPSign(char* dbDir,
							                            char* secKeyDisk,
							                            char* pin,
							                            char* mfo,
							                            const char* cszUID)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						! String: LPCSTR
				Function: nsignExitOPSign
					Description: int GLOBAL nsignExitOPSign(void)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
				Function: nsignMapError2Text
					Description: void GLOBAL nsignMapError2Text(char *buffer,
							                               int errorCode)
					Export Ordinal: 0
					Returns
					Parameters
						Receive String: LPSTR
						Number: INT
				Function: nsignPutOPSignOnMemory
					Description: int GLOBAL nsignPutOPSignOnMemory(void* data,
							    unsigned short size, void* signPtr)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPVOID
						Number: SHORT
						Receive String: LPVOID
			Library name: RSAC.DLL
				! //  RSAC.DLL - экспортируемые функции //////////////////////////////////////////////////////////////////////
				!
				Function: INIT_ZAH
					Description: int InitSign(char *szPathOpenKey,
							             char *szPathSecKey,
							             char *szIdOper, char *szUxDateTme,
							             char *szPasword)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
				Function: CLOSE_ZAH
					Description: int CloseRsa(void)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
				Function: RSA_ZAH
					Description: int RSA_ZAH(char cMode, int iHandler,
							            dword dwCountPart, dword dwOffset,
							            dword dwLength,
							            dword dwOffsetSecond, char *szSign,
							            char *szIdOpen)
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						Number: CHAR
						Number: INT
						Number: DWORD
						String: LPCSTR
						Number: DWORD
						Number: DWORD
						String: LPSTR
						String: LPCSTR
				!
			Library name: NUM2WORD.DLL
				Function: SummInWords
					Description: Преобразование суммы числовой в сумму прописью
					Export Ordinal: 1
					Returns
						String: LPSTR
					Parameters
						String: LPSTR
						String: LPSTR
						String: LPSTR
						String: LPSTR
			Library name: HARAKIRI.DLL
				Function: DeleteBadSymbols
					Description: Удаляет из файла отчета ненужные символы
							и добавляет в него Esc-последовательности
							Параметры:
								Имя файла,
								Строка Esc-последовательностей
								Флаг удаления символа с кодом 12
								Флаг удаления пустых строк (3 и более пустых строки заменяются одной)
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						String: LPSTR
						String: LPSTR
						Boolean: BOOL
						Boolean: BOOL
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '29'
				String: ApdVer   =  '1.13'
				String: ApdDat   =  '31/10/2014'
				!
				!
				Number: DIRECTION_IN = 0  ! Входящее направление файлов
				Number: DIRECTION_OUT = 1 ! Исходящее направление файлов
				Number: DIRECTION_ALL = 2 ! Все направления
				!
				Number: SYNC_POST = 1 ! Синхронизауия выгруженная в банке вручную
				Number: SYNC_AUTO = 0 ! Автоматич. обновлнеия. (oracle streams)
				Number: SYNC_ALL = -1 ! Все виды выгрузок
				Number: SYNC_NONE = -2 ! Ничего
				! параметри корп клієнтів
				Number: PRM_USEVP = 1 ! використання в виписці
				Number: PRM_TRKK  = 2 ! КОд ТРКК
				Number: PRM_KODU  = 3 ! Код установи
		Resources
		Variables
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin5
			Window Handle: hWin21
		Internal Functions
			Function: Sel029	! __exported
				Description: Bars029_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					String: sTmp 
				Actions
					! надо вставить инициализацию apd
					Select Case nMode
						Case 0  ! Файлы обмена
							If not IsWindow(hWin0)
								Set hWin0 =  SalCreateWindow(tblKlbFiles, hWndParent)
							Else
								Call SalBringWindowToTop ( tblKlbFiles )
							Break
						Case 1  ! Блокировка направлений. Параметры обменв информацией 
							If not IsWindow(hWin0)
								Set hWin0 =  SalCreateWindow(frm_kl_blk, hWndParent)
							Else
								Call SalBringWindowToTop ( frm_kl_blk )
							Break
						Case 2  ! Ручные технологич. работы 
							Call SalModalDialog(dlg_kl_PostAll, hWndParent)
							Break
						!
						Case 3  ! Администр. работы для настройки синхронизации чеерз Oracle Streams
							! Справочники
							If nPar = 1
								Call SalModalDialog(rsReferences, hWndParent, 0, sTmp)
								Break
							!
							! Подписчики
							If nPar = 2
								If not IsWindow(hWin0)
									Set hWin0 =  SalCreateWindow(rsSubsribers, hWndParent)
								Else
									Call SalBringWindowToTop(rsSubsribers)
								Break
							!
							! Мониторинг работы
							If nPar = 3
								If not IsWindow(hWin0)
									Set hWin0 =  SalCreateWindow(rsProcess, hWndParent)
								Else
									Call SalBringWindowToTop(rsProcess)
								Break
							!
							! Счета
							If nPar = 4
								If not IsWindow(hWin0)
									Set hWin0 =  SalCreateWindow(rsProcess, hWndParent)
								Else
									Call SalBringWindowToTop(rsProcess)
								Break
						!
						Case 8  ! Отправка информационных сообщений
							If nPar = 1
								Call SalModalDialog(dlg_PostInfo, hWndParent)
								Break
						Case 9  ! Синхронизация справочников (xml_reflist)
							! Синхронизация полная
							If nPar = 1
								Call SalModalDialog(dlg_RefSyncFull, hWndParent)
								Break
							! Синхронизация с заданными параметрам
							If nPar = 2
								Call SalModalDialog(dlg_RefSyncReqv, hWndParent)
								Break
							! Синхронизация віписки
							If nPar = 3
								Call SalModalDialog(dlg_RefSyncVp, hWndParent)
								Break
						Case 10 ! Реггистрация нового отделения для работы в оффлайне
							! Синхронизация полная
							If nPar = 1
								Call SalModalDialog(dlg_AddNewBranch, hWndParent)
								Break
						Case 20 ! Выгрузка данных
							! Ручная выгрузка данных
							If nPar = 1
								Call SalModalDialog(uplManualy, hWndParent)
								Break
							! Статистика выполнения дневного ждоба
							If nPar = 2
								If not IsWindow(hWin3)
									Set hWin3 =  SalCreateWindow(uplJob, hWndParent)
								Break
							! Журнал выгрузки файлов
							If nPar = 3
								! Call SalModalDialog(uploadJob, hWndParent)
								If not IsWindow(hWin4)
									Set hWin4 =  SalCreateWindow(uplFileStatistic, hWndParent)
								Break
							! Параметры выгрузки
							If nPar = 4
								Call SalModalDialog(uplParams, hWndParent)
								Break
							! Выгрузка файлов выборочно
							If nPar = 5
								If not IsWindow(hWin5)
									Set hWin5 =  SalCreateWindow(uplFileSingle, hWndParent)
								Break
						Case 21 ! Вивантаження метаданих у файл для оновлення
							! Створення скріпта з описом файла вивантаження (метадані)
							If not IsWindow( hWin21 )
								Set hWin21 = SalCreateWindow( uploadMetaData, hWndParent )
							Else
								Call SalBringWindowToTop( hWin21 )
							Break
						!
						Case 100! Корпоративные клиенты
							! Редактирование
							If nPar = 1
								If not IsWindow(hWin0)
									Set hWin0 =  SalCreateWindow(tblKorp, hWndParent)
								Else
									Call SalBringWindowToTop ( tblKorp )
								Break
						Default
							Break
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: setCurrentSchema
				Description: Установить текущую схему
				Returns
				Parameters
					String: sSchema
				Static Variables
				Local variables
				Actions
					If not SqlPrepareAndExecute(hSql(), 'bars_context.set_cschema(sSchema)')
						Call SalMessageBox('Внимание!','Ошибка при установке схемы '||sSchema, MB_IconAsterisk)
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1187014060
0000: E404000017020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F8F003C00 000F63004465736B
0040: 746F704C00697374 426F782201C00000 0B00000083010D00 0000FFFFE40D0000
0060: 01FE00FF831A0000 0001FB00FF0F2700 0000EE0100FF3F34 00B800000100FFFF
0080: E04100000001FE00 FF834E00000001FB 00FF0F5B000000EE 0100FF3F6800B800
00A0: 000100FFFFE07500 000001FE00FF8382 00000001FB00FF0F 0180340011000100
00C0: 000B63E04469724C 69036C0000000400 3C0000010DFB00FF 6F0D00EE0100FFBF
00E0: 1AB9000100FFFFE6 270001FE00FF4301 80270000E0020000 000F81547265654C
0100: 690F52000000F003 000000EC010D00FF BF0DB9000100FFFF E61A0001FE00FF43
0120: 01805B0000060300 0C634669F86C654C 41BA00000007009E 00010DFD00FF370D
0140: 0001F700FFDF1ADC 000100FF7F277300 0100FFFFCD340001 FD00FF37410001F7
0160: 00FFDF4EDC000100 FF7F01C080220000 000400000A634765 6E46690174657274
0180: 000000F604008802 0400000100FE00C1 8001000000BF04B1 00010D00FFFFE011
01A0: 00000002FE00FF83 1500000001FB00FF 8F01802281000500 00000BC647444669
01C0: 9F0004BD0002A300 0100007F80F20100 006F0400EC010D00 FFBF11B9000200FF
01E0: FFE6150001FE00FF 4301804100000006 0000000D635261E0 64696F4C69838600
0200: 0000053D00010DFB 00FF4F0D0000EE01 00FFBF1AB9000100 FFFFE6270001FE00
0220: FF9B340001FB00FF 0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbSynchro
			Radio Button: cRadioButtonLabeled
			Option Button:
			Check Box: cCheckBoxLabeled
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_StrId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cXSalVSplitter
		Application Actions
	Table Window: tblKlbFiles
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Файли обміну
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.633"
				Width Editable? Class Default
				Height: 7.369"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description: Просмотр файлов обмена
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.631"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.617"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.05"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитать данные'
						On SAM_Click
							Call SalSendMsg(tblKlbFiles, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10237
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.75"
						Begin Y:  1.452"
						End X:  4.783"
						End Y:  1.238"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.15"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDocs
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.017"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть документы файла'
						On SAM_Click
							! sCond
							Call DocViewListInt(hWndMDI,  " ref in (select ref from operw where tag='KLBXF' and value='"||tblKlbFiles.colFileName ||"' )", "Документы" )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.45"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10238
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.983"
						Begin Y:  1.155"
						End X:  3.983"
						End Y:  1.321"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.117"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10239
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.083"
						Begin Y:  1.238"
						End X:  2.1"
						End Y:  1.155"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: cmbFileDate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.483"
						Top:    0.321"
						Width:  1.7"
						Width Editable? Class Default
						Height: 0.881"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call cmbFileDate.Init(hWndItem)
							Call cmbFileDate.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
									    "(select fdat from fdat)",
									     "ORDER BY fdat DESC")
							Call SalListSetSelect(cmbFileDate, 0)
						On SAM_Click
							Call SalSendClassMessage( SAM_Click, 0, 0 )
							Set sTmp = cmbFileDate.GetNameById(cmbFileDate.GetKey(SalListQuerySelection(hWndItem)))
							Set dDateSelected = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
									 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
									 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
							Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
						On SAM_User
							Set nDay = SalDateDay(dDateSelected)
							Set nMonth = SalDateMonth(dDateSelected)
							Set nYear = SalDateYear(dDateSelected)
							If cmbBanks = '*'
								Set strSab = ''
							Else
								If not SalIsNull(cmbBanks)
									Set strSab = cmbBanks.GetKey(SalListQuerySelection(cmbBanks))
							Set dfFileName = '*' || SalStrRightX(strSab,5) || GetCharForDigit(nMonth) || GetCharForDigit(nDay) ||'????'
							Call SalSendMsg(pbSearchFiles, SAM_Click, 0, 0)
				Data Field: dfFileName
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.321"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmbBanks
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.283"
						Top:    0.595"
						Width:  3.833"
						Width Editable? Class Default
						Height: 1.655"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call cmbBanks.Init(hWndItem)
							Call cmbBanks.Populate(hSql(), "sab", "name", "v_klbx_branch", " where isactive = 1 order by sab")
							Call cmbBanks.Add('*', '*')
						On SAM_Click
							Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
				Frame
					Resource Id: 10240
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   -0.017"
						Top:    1.071"
						Width:  14.5"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Border Color: 3D Shadow Color
					Background Color: Default
				Pushbutton: pbSearchFiles
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: !
					Window Location and Size
						Left:   7.717"
						Top:    0.31"
						Width:  0.383"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tblKlbFiles, UM_Populate, 0, 0)
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Задействовать имя для поиска')
				Group Box: Пошук
					Resource Id: 10242
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   -0.017"
						Top:    0.071"
						Width:  8.3"
						Width Editable? Yes
						Height: 1.0"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Group Box: Типи файлів
					Resource Id: 10748
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.283"
						Top:    0.071"
						Width:  6.2"
						Width Editable? Yes
						Height: 1.0"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cmbFileBankDate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   2.483"
						Top:    0.595"
						Width:  1.7"
						Width Editable? Class Default
						Height: 1.036"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call cmbFileBankDate.Init(hWndItem)
							Call cmbFileBankDate.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
									    "(select fdat from fdat)",
									     "ORDER BY fdat DESC")
							Call SalListSetSelect(cmbFileBankDate, 0)
						On SAM_Click
							Call SalSendClassMessage( SAM_Click, 0, 0 )
							Set sTmp = cmbFileBankDate.GetNameById(cmbFileBankDate.GetKey(SalListQuerySelection(hWndItem)))
							Set dBankDateSelected = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
									 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
									 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
							Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
						On SAM_User
							! Set nDay = SalDateDay(dDateSelected)
							! Set nMonth = SalDateMonth(dDateSelected)
							! Set nYear = SalDateYear(dDateSelected)
							! If cmbBanks = '*'
								                                                                                                                                  Set strSab = ''
							! Else
								                                                                                                                                  If not SalIsNull(cmbBanks)
									                                                                                                                                  Set strSab = cmbBanks.GetKey(SalListQuerySelection(cmbBanks))
							! Set dfFileName = '*' || SalStrRightX(strSab,5) || GetCharForDigit(nMonth) || GetCharForDigit(nDay) ||'????'
							Call SalSendMsg(pbSearchFiles, SAM_Click, 0, 0)
				Background Text: Дата файлу ТВБВ
					Resource Id: 26718
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.345"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Дата обробки в банку з
					Resource Id: 26719
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.15"
						Top:    0.619"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Line
					Resource Id: 26720
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.19"
						End X:  4.183"
						End Y:  0.988"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Radio Button: rbFilesIn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вхідні файли
					Window Location and Size
						Left:   8.45"
						Top:    0.286"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichToolsVisibility(DIRECTION_IN)
							Call swichInFileTypeVisibility(cbFilesInPay, cbFilesInReqv)
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Radio Button: rbFilesOut
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вихідні файли
					Window Location and Size
						Left:   10.517"
						Top:    0.286"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichToolsVisibility(DIRECTION_OUT)
							Set nDirection = DIRECTION_OUT
							Set sCurrMessType = 'REFS'
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Radio Button: rbFilesAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Всі файли
					Window Location and Size
						Left:   12.583"
						Top:    0.286"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichToolsVisibility(DIRECTION_ALL)
							Set nDirection = DIRECTION_ALL
							Set sCurrMessType = '%'
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Check Box: cbFilesInPay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Платіжні файли
					Window Location and Size
						Left:   8.483"
						Top:    0.571"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichInFileTypeVisibility(cbFilesInPay, cbFilesInReqv)
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Check Box: cbFilesInReqv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Файли запитів
					Window Location and Size
						Left:   8.483"
						Top:    0.762"
						Width:  1.733"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichInFileTypeVisibility(cbFilesInPay, cbFilesInReqv)
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Check Box: cbFilesOutPost
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вигружені довідники  
					Window Location and Size
						Left:   10.55"
						Top:    0.595"
						Width:  2.133"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichOutFileTypeVisibility(cbFilesOutPost,cbFilesOutAuto)
							! If nSyncType != SYNC_NONE
								                                                                                      Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
							! Else
								                                                                                      Call SalTblReset ( hWndForm )
				Check Box: cbFilesOutAuto
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вигружені автоматом
					Window Location and Size
						Left:   10.55"
						Top:    0.786"
						Width:  2.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call swichOutFileTypeVisibility(cbFilesOutPost,cbFilesOutAuto)
							! Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
		Contents
			Column: colNP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №пп
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.783"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colFileName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: І'мя файла
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDatF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Банк.дата
						формування файлу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.983"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDatP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Банк.дата
						обробки файлу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDocTotal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Док-тів
						у файлі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDocPayed
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оплач.
						док-тів
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colMessCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип  
						повідмлення
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.7"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colMessType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип 
						повідмл.
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.067"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRefName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ім'я довідника
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.667"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSyncName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: тип 
						синхронізації
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.767"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colSyncType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: swichToolsVisibility
				Description: ! При выборе фильтра установить видимые и невидимые елементы
				Returns
				Parameters
					Number: nFilterType ! 0 - входящее направление, 1 - исходящее, 2 - все
				Static Variables
				Local variables
				Actions
					If nFilterType = DIRECTION_IN
						Call SalEnableWindow(cbFilesInPay)
						Call SalEnableWindow(cbFilesInReqv)
						!
						Call SalDisableWindow(cbFilesOutPost)
						Call SalDisableWindow(cbFilesOutAuto)
						Set nDirection = DIRECTION_IN
						Call SalEnableWindow(cmbFileBankDate)
						!
						Call SalHideWindow(colRefName)
						Call SalHideWindow(colSyncName)
						Call SalHideWindow(colRefName)
						Call SalShowWindow(colDocPayed)
						Call SalShowWindow(colMessCode)
						Call SalShowWindow(colDatP)
						Call SalShowWindow(colMessCode)
						!
					If nFilterType = DIRECTION_OUT
						Call SalEnableWindow(cbFilesOutPost)
						Call SalEnableWindow(cbFilesOutAuto)
						!
						Call SalDisableWindow(cbFilesInPay)
						Call SalDisableWindow(cbFilesInReqv)
						Set nDirection = DIRECTION_OUT
						!
						Call SalDisableWindow(cmbFileBankDate)
						!
						Call SalShowWindow(colRefName)
						Call SalShowWindow(colSyncName)
						Call SalShowWindow(colRefName)
						Call SalHideWindow(colDocPayed)
						Call SalHideWindow(colMessCode)
						!
						Call SalHideWindow(colDatP)
						Call SalHideWindow(colMessCode)
						!
					If nFilterType = DIRECTION_ALL
						Call SalDisableWindow(cbFilesOutPost)
						Call SalDisableWindow(cbFilesOutAuto)
						Call SalDisableWindow(cbFilesInPay)
						Call SalDisableWindow(cbFilesInReqv)
						Call SalShowWindow(colRefName)
						Call SalShowWindow(colSyncName)
						Call SalShowWindow(colRefName)
						Call SalShowWindow(colDocPayed)
						Call SalShowWindow(colMessCode)
						Set nDirection = DIRECTION_ALL
						Call SalEnableWindow(cmbFileBankDate)
						Call SalShowWindow(colDatP)
						Call SalShowWindow(colMessCode)
			Function: swichInFileTypeVisibility
				Description: ! 
				Returns
				Parameters
					Number: nFileInPay  ! флаг включенности платежных документов
					Number: nFileInReqv ! флаг включенности файлов запросов
				Static Variables
				Local variables
				Actions
					If nFileInPay = 1 AND nFileInReqv = 1 ! выбрано два типа
						Set sCurrMessType = '%' 
					Else
						If nFileInPay = 0 AND nFileInReqv = 0 ! ничего не выбрано
							Set sCurrMessType = '-'
						Else
							If nFileInPay = 1
								Set sCurrMessType = 'document'
							If nFileInReqv = 1
								Set sCurrMessType = 'service'
			Function: swichOutFileTypeVisibility
				Description: ! 
				Returns
				Parameters
					Number: nFilesOutPost ! флаг включенности выгрузки ручной
					Number: nFilesOutAuto ! флаг включенности выгрузки aвтоматом
				Static Variables
				Local variables
				Actions
					If nFilesOutPost = 1 AND nFilesOutAuto = 1 ! выбрано два типа
						Set nSyncType = SYNC_ALL
					Else
						If nFilesOutPost = 0 AND nFilesOutAuto = 0 ! ничего не выбрано
							Set nSyncType = SYNC_NONE
						Else
							If nFilesOutPost = 1
								Set nSyncType = SYNC_POST
							If nFilesOutAuto = 1
								Set nSyncType = SYNC_AUTO
					!
					!
					If nSyncType != SYNC_NONE
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					Else
						Call SalTblReset ( hWndForm )
		Window Parameters
		Window Variables
			String: strSab
			String: sTmp
			Number: nTmp
			Date/Time: dDateSelected
			Date/Time: dBankDateSelected
			Number: nDay
			Number: nMonth
			Number: nYear
			String: strSql
			String: sCond
			!
			String: sCurrMessType
			Number: nDirection !  направление  0 - входящие, 1-исходящие
			Number: nSyncType
			String: sRefName 
			!
		Message Actions
			On UM_Populate
				Call SalSetWindowText(tblKlbFiles, 'Файли обміну')
				Set hWndCol = hWndNULL
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbUpdate)
				Call SalDisableWindow(pbPrint)
				Call SalTblSetLockedColumns(tblKlbFiles, 2)
				Set strSql = "
						    select rownum,pnam, datf, datp, ndoctotal, ndocpayed, 
						           messcode,  refname, messtype, synctypename, synctype
						      into :tblKlbFiles.colNP,
						           :tblKlbFiles.colFileName,  :tblKlbFiles.colDatF, :tblKlbFiles.colDatP,
						           :tblKlbFiles.colDocTotal, :tblKlbFiles.colDocPayed, :tblKlbFiles.colMessCode,
						           :tblKlbFiles.colRefName, :tblKlbFiles.colMessType,  :tblKlbFiles.colSyncName, :tblKlbFiles.colSyncType
						      from ( select pnam, datf, datp, ndoctotal, ndocpayed, 
						                    messcode,  refname, messtype, synctypename, synctype
						               from v_xmlfiles
						              where pnam like '" || StrMatches2Like(dfFileName) ||"' "|| 
						                   " and datf>=:dDateSelected and datf-1<:dDateSelected "||
						                   IifS( nDirection  = DIRECTION_IN OR nDirection = DIRECTION_ALL, " and datp>=:dBankDateSelected     ", " ") ||
						                   IifS( nDirection  = DIRECTION_IN ,                              " and messtype like :sCurrMessType ", " ") ||
						                   IifS( nDirection != DIRECTION_ALL,                              " and direction = :nDirection      ", " ") ||
						                   IifS( nDirection  = DIRECTION_OUT AND nSyncType  = SYNC_AUTO,   " and synctype   = :nSyncType      ", " ") || 
						                   IifS( nDirection  = DIRECTION_OUT AND nSyncType  = SYNC_POST,   " and synctype  >= :nSyncType      ", " ") || 
						           " order by datp, direction, synctype, messtype, messcode, pnam )"
				! Call Debug(strSql|| '   nSyncType = '||SalNumberToStrX(nSyncType,0))
				Call WaitCursorOn()
				Set nRow = 0
				Call SalTblPopulate(tblKlbFiles, hSqlAux(), T(strSql), TBL_FillAll)
				Call SalTblDefineSplitWindow (tblKlbFiles, 1, TRUE)
				Set nTmp = SalTblInsertRow(tblKlbFiles, TBL_MinRow)
				Call SalTblSetContext(tblKlbFiles, nTmp)
				Call SalTblSetRowFlags(tblKlbFiles, nTmp, ROW_New, FALSE)
				Call WaitCursorOff()
			On SAM_Create
				Set dDateSelected = GetBankDate()
				Set dBankDateSelected = GetBankDate()
				Call PrepareWindow(hWndForm)
				Call XSalTooltipSetUserDefault()
				Set nDay   = SalDateDay(GetBankDate())
				Set nMonth = SalDateMonth(GetBankDate())
				Set nYear  = SalDateYear(GetBankDate())
				!
				Set dfFileName = '*' || GetCharForDigit(nMonth) || GetCharForDigit(nDay) || '????'
				Set strFilterTblName = 'V_XMLFILES'
				!
				! начальные установки фильтра
				Set rbFilesIn = TRUE
				Set rbFilesOut = FALSE
				Set rbFilesAll = FALSE
				Set nDirection = DIRECTION_IN
				Call swichToolsVisibility(nDirection)
				Set sCurrMessType = '%'
				Set nSyncType = SYNC_ALL
				Set cbFilesInPay = 1
				Set cbFilesInReqv = 1
				Set cbFilesOutPost = 1
				Set cbFilesOutAuto = 1
				!
				Call SalTblSetTableFlags(tblKlbFiles, TBL_Flag_SingleSelection, TRUE)
				Call SalTblSetTableFlags(tblKlbFiles, TBL_Flag_SelectableCols, TRUE)
				Call SalSetFocus(pbExit)
			On SAM_CreateComplete
				Call SalSendMsg( cmbFileDate, SAM_Click, 0, 0 )
				Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Call WaitCursorOff()
			On SAM_DoubleClick
				If SalStrLeftX(colFileName,1) = 'A'
					Call SalSendMsg(pbDocs, SAM_Click, 0, 0)
	Table Window: frm_kl_blk
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Параметри обміну інформацією
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.717"
				Width Editable? Class Default
				Height: 8.929"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Форма блокировки/разблокировки(настройка параметров передачи данных) 
				клиентов в клиент-казначействе
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10243
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10244
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10245
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Для всіх блокування
					Resource Id: 10246
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.179"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cbBlkForAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.683"
						Top:    0.155"
						Width:  3.0"
						Width Editable? Class Default
						Height: 1.19"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Click
							Set iBlkForAll=cbBlkForAll.GetKey(SalListQuerySelection( cbBlkForAll) )
							Set iRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, iRow, 0, 0)
								Call SalTblSetContext( hWndForm, iRow )
								Call frm_kl_blk.cbBlkCode.SetSelectById(iBlkForAll)
								Call SalSendMsg(frm_kl_blk.cbBlkCode, SAM_AnyEdit, 0, 0)
								Call SalTblSetRowFlags (hWndForm, iRow, ROW_Edited, TRUE )
								Call SalSendMsg(frm_kl_blk, UM_Update, 0, 0)
						On SAM_Create
							If cbBlkForAll.Init(hWndItem)
								Call cbBlkForAll.Add(0,"Нету")
								Call cbBlkForAll.Add(0,"Входящих")
								Call cbBlkForAll.Add(0,"Исходящих")
								Call cbBlkForAll.Add(0,"Вход+Исход")
		Contents
			Column: colRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идентіф.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наіменування клієнту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbBlkCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Блокування
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If cbBlkCode.Init( hWndItem )
							Call cbBlkCode.Add( 0, 'Нету' )
							Call cbBlkCode.Add( 1, 'Входящих' )
							Call cbBlkCode.Add( 2, 'Исходящих' )
							Call cbBlkCode.Add( 3, 'Вход+Исход' )
					On SAM_AnyEdit
						Set colBlkCode=cbBlkCode.GetKey( SalListQuerySelection( cbBlkCode) )
			Column: colBlkCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_AnyEdit
						                                                                                                                                                                                                                                                                      Call frm_kl_blk.cbBlkCode.SetSelectById(iBlkForAll)
			Column: colchbMakeVP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Виписка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPostType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип обмена
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cbPostType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Тип обміну
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.167"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If cbPostType.Init( hWndItem )
							Call cbPostType.Add('O', 'Offline' )
							Call cbPostType.Add('M', 'Mail' )
					On SAM_AnyEdit
						Set colPostType=cbPostType.GetKey( SalListQuerySelection( frm_kl_blk.cbPostType) )
						If (colPostType='M' and colEMail=STRING_Null)
							Call SalMessageBox('Укажите сначала электронный адресс для клиента',
									   'Внимание',  MB_IconExclamation)
							Set colPostType = 'O'
							Call cbPostType.SetSelectById( colPostType )
			Column: colchbAltEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Альт.адр.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Click
						If (colchbAltEmail=0 and colAltEMail=STRING_Null)
							Call SalMessageBox('Укажите сначала альтернативный электронный адресс',
									   'Внимание',  MB_IconExclamation)
							Set colchbAltEmail = 0
			Column: colEMail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Адреса эл. пошти
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAltEMail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Альт. адреса эл. пошти
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Number: iBlkForAll
			Number: iRow
		Message Actions
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_Create
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Set frm_kl_blk.strSqlPopulate =
						   "SELECT cp.rnk, sab, nmk, blk, make_vp,email,post_type, alt_post,  alt_email
						    INTO :frm_kl_blk.colRnk, :frm_kl_blk.colSab, :frm_kl_blk.colName,
						         :frm_kl_blk.colBlkCode, :colchbMakeVP, :colEMail, :colPostType, :colchbAltEmail, :colAltEMail
						    FROM kl_customer_params cp, customer c
						    WHERE cp.rnk=c.rnk"
				Set frm_kl_blk.strSqlUpdate =
						   "UPDATE kl_customer_params
						           SET  blk =      :frm_kl_blk.colBlkCode,
						                email=     :frm_kl_blk.colEMail,
						                make_VP =  :frm_kl_blk.colchbMakeVP,
						                post_type = :frm_kl_blk.colPostType,
						                alt_post  = :frm_kl_blk.colchbAltEmail,
						                alt_email = :frm_kl_blk.colAltEMail
						    WHERE rnk=:frm_kl_blk.colRnk"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Call cbBlkCode.SetSelectById( colBlkCode )
				Call cbPostType.SetSelectById( colPostType )
	Dialog Box: dlg_kl_PostAll
		Class:
		Property Template:
		Class DLL Name:
		Title: Технологічні роботи
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.183"
				Width Editable? Yes
				Height: 7.048"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Ручные технол. работы
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblCustomer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.488"
						Width:  6.0"
						Width Editable? Yes
						Height: 5.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ел.ідент.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCustName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва клієнту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql = "SELECT c.sab,  nmk
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM kl_customer_params cp, customer c
								    WHERE cp.rnk=c.rnk ORDER BY c.sab"
						Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   4.767"
					Top:    6.143"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						!
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							If tblCustomer.checked
								!
								! по каждому выбранному сервису
								!
								Set i = TBL_MinRow
								While SalTblFindNextRow(tblServices, i, 0, 0)
									Call SalTblSetContext( tblServices, i )
									If tblServices.checked
										Call setPramsValues()
										! Call Debug('par1='||dfParval1||'par2='||dfParval2)
										If SqlPLSQLCommand(hSql(), 
												      "bars_xmlklb_que.post_module_request(
												           tblServices.serviceCode,
												           tblCustomer.colSab,
												           dfParval1, 
												           dfParval2,
												           dfParval3,
												           dfParval4)")
											Call SqlCommit(hSql())
						!
						Call WaitCursorOff()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Вихід
				Window Location and Size
					Left:   6.283"
					Top:    6.143"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Child Table: tblServices
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    0.488"
						Width:  5.4"
						Width Editable? Yes
						Height: 3.0"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_FieldEdit
								! nContext = SalTblQueryContext (hWndTbl)
								Call SalTblSetRowFlags(tblServices,  SalTblQueryContext (tblServices), 0,0)
					Column: serviceName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва сервісу
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: serviceCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parname1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parname2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parname3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parname4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set sSql = 
								   "select 0, m.descript, snam 
								    into :tblServices.checked,
								         :tblServices.serviceName,
								         :tblServices.serviceCode         
								    from xml_messtypes m, xml_servlist s
								    where message = snam and auto_gen = 1"
						Call SalTblPopulate( tblServices, hSql(), sSql, TBL_FillAll )
						!
						!
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblServices, nRow, 0, 0)
							Call SalTblSetContext( tblServices, nRow )
							Call SqlPLSQLCommand(hSql(), 
									      "bars_xmlklb_que.get_def_service_params(
									           tblServices.serviceCode,
									           tblServices.parname1,
									           tblServices.parval1, 
									           tblServices.parname2,
									           tblServices.parval2,
									           tblServices.parname3,
									           tblServices.parval3,
									           tblServices.parname4,
									           tblServices.parval4)")
						!
						Set nRow = 0
						Call SalTblSetContext(tblServices, nRow )
						Call SalTblSetFocusRow(tblServices, nRow )
						!
						Call setPramsValues()
					On SAM_TblDoDetails
						Call setPramsValues()
			Check Box: cbCheckAllServices
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   7.0"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblServices, nRow, 0, 0)
							Call SalTblSetContext( tblServices, nRow )
							Set tblServices.checked = cbCheckAllServices
			Data Field: dfParname1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    3.595"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfParval1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    3.821"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_FieldEdit
						Set tblServices.parval1 = dfParval1
			Data Field: dfParname2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.119"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfParval2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.345"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_FieldEdit
						Set tblServices.parval2 = dfParval2
			Data Field: dfParname3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.667"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfParval3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.869"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_FieldEdit
						Set tblServices.parval3 = dfParval3
			Data Field: dfParname4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    5.179"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfParval4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    5.393"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_FieldEdit
						Set tblServices.parval4 = dfParval4
			Check Box: cbCheckAllClients
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   0.75"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							Set tblCustomer.checked = cbCheckAllClients
			Group Box: Клієнти
				Resource Id: 17691
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.071"
					Width:  6.267"
					Width Editable? Yes
					Height: 5.917"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Сервіси
				Resource Id: 17692
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.283"
					Top:    0.06"
					Width:  5.8"
					Width Editable? Yes
					Height: 5.929"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 17693
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    5.988"
					Width:  12.067"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
		Functions
			Function: setPramsValues
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set dfParname1 = 'параметр: '||tblServices.parname1
					Set dfParval1 = tblServices.parval1
					Set dfParname2 = 'параметр: '||tblServices.parname2
					Set dfParval2 = tblServices.parval2
					Set dfParname3 = 'параметр: '||tblServices.parname3
					Set dfParval3 = tblServices.parval3
					Set dfParname4 = 'параметр: '||tblServices.parname4
					Set dfParval4 = tblServices.parval4
		Window Parameters
		Window Variables
			String: sCheckedMsgText
			Number: nCheckedMsgId
			String: sSql
			String: strMonth[12]              !! Наименов. месяце для календаря
			String: strWeekDays[7]         !! Дни недели для календаря
			Number: nFetchRes
			Number: i
			Number: nRow
			Boolean: bRet
			Date/Time: dSelect
			Date/Time: dFrom
			Date/Time: dTo
			String: strDateTo
			String: strBankDate
			String: strDateFrom
		Message Actions
			On SAM_Create
	! cGenericTable: tbl_MsgList
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Повідомлення клієнту
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.7"
				Width Editable? Yes
				Height: 4.25"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                                                                                                                                                                    Description: 
		                                                                                                                                                                    Named Menus 
		                                                                                                                                                                    Menu 
		                                                                                                                                                                    Tool Bar 
			                                                                                                                                                                    Contents 
				                                                                                                                                                                    Pushbutton: pbIns
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbDel
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbRefresh
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbUpdate
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Line 
				                                                                                                                                                                    Pushbutton: pbSearch
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbFilter
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbDetails
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Pushbutton: pbPrint
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Line 
				                                                                                                                                                                    Pushbutton: pbExit
					                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Line 
		                                                                                                                                                                    Contents 
			                                                                                                                                                                    Column: colID
				                                                                                                                                                                    List Values 
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Column: colMess
				                                                                                                                                                                    List Values 
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Column: colMessLength
				                                                                                                                                                                    List Values 
				                                                                                                                                                                    Message Actions 
		                                                                                                                                                                    Functions 
		                                                                                                                                                                    Window Parameters 
		                                                                                                                                                                    Window Variables 
			                                                                                                                                                                    Number: i
			                                                                                                                                                                    Long String: lsInfoMess_Part
			                                                                                                                                                                    Number: nFetchRes
		                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    On UM_Populate
				                                                                                                                                                                    Call SalSendClassMessage(UM_Populate, 0, 0)
			                                                                                                                                                                    On SAM_Create
				                                                                                                                                                                    Call SalDisableWindow(pbFilter)
				                                                                                                                                                                    Call SalDisableWindow(pbPrint)
				                                                                                                                                                                    Call SalDisableWindow(pbDetails)
				                                                                                                                                                                    Set tbl_MsgList.strSqlPopulate =
						   "SELECT id_mess, dbms_lob.substr(info_text,100, 1), dbms_lob.getlength(info_text)
						    INTO :tbl_MsgList.colID, :tbl_MsgList.colMess, :tbl_MsgList.colMessLength
						    FROM kl_info_messages"
				                                                                                                                                                                    Set tbl_MsgList.strSqlUpdate =
						   "UPDATE kl_info_messages
						    SET  info_text =  :tbl_MsgList.colMess
						    WHERE id_mess =:tbl_MsgList.colID"
				                                                                                                                                                                    Call SalSendClassMessage(SAM_Create, 0, 0)
			                                                                                                                                                                    On SAM_DoubleClick
				                                                                                                                                                                    Set dlg_kl_PostAll.nCheckedMsgId = colID
				! Поскольку поле типа CLOB и могут быть например файлы
						! вычитаем по-очередно
				!
				                                                                                                                                                                    Set i = 1
				                                                                                                                                                                    While i < colMessLength
					                                                                                                                                                                    Call SqlPrepareAndExecute(hSql(), "
							SELECT dbms_lob.substr((SELECT info_text FROM kl_info_messages WHERE id_mess = :colID),2000,:i)
							INTO :lsInfoMess_Part
							FROM dual")
					                                                                                                                                                                    Call SqlFetchNext(hSql(), nFetchRes)
					                                                                                                                                                                    Set dlg_kl_PostAll.mlMsgText=dlg_kl_PostAll.mlMsgText||lsInfoMess_Part
					                                                                                                                                                                    Set i = i + 2000
				! Set dlg_kl_PostAll.mlMsgText = colMess
				                                                                                                                                                                    Set dlg_kl_PostAll.sCheckedMsgText =  dlg_kl_PostAll.mlMsgText
				                                                                                                                                                                    Call SalDestroyWindow(hWndItem)
	Form Window: rsSubsribersAcc
		Class:
		Property Template:
		Class DLL Name:
		Title: Подписчики и подписанные на них счета
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.017"
				Width Editable? Yes
				Height: 6.036"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Подписчики
				Resource Id: 11761
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.495"
					Width:  4.3"
					Width Editable? Yes
					Height: 5.107"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbDelAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.605"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Arial Cyr
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblAcc, nRow, ROW_Selected, 0)
							Call SalTblSetContext(tblAcc, nRow)
							Call SqlPLSQLCommand(hSql(), "barsaq.bars_accsync.unsubscribe_acc(tblSubscr.name, tblAcc.acc)")
						Call refreshAcc()
						!
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Удалить выбранные счета' )
			Group Box: Счета
				Resource Id: 11762
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.45"
					Top:    0.495"
					Width:  7.333"
					Width Editable? Yes
					Height: 5.107"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblSubscr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    0.738"
						Width:  4.2"
						Width Editable? Yes
						Height: 4.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.267"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_TblDoDetails
						Call refreshAcc()
			Pushbutton: pbAddAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.15"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalModalDialog(rsAllAcc, hWndForm)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Добавить счета для подписчика' )
			Child Table: tblAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   4.55"
						Top:    0.738"
						Width:  7.033"
						Width Editable? Yes
						Height: 4.75"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 50000
					Discardable? Yes
				Contents
					Column: acc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя 
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  4.25"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: nls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Лицевой счет
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.483"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: kv
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.75"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: branch
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Бранч
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.933"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Frame
				Resource Id: 11763
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  11.7"
					Width Editable? Yes
					Height: 0.417"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.033"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call refreshSubscr()
						Call SalTblSetContext ( tblSubscr, TBL_MinRow )
						Call SalTblSetFocusRow ( tblSubscr, TBL_MinRow )
						Call refreshAcc()
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Перечитать' )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.683"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Выход' )
			Line
				Resource Id: 33894
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  1.56"
					Begin Y:  0.115"
					End X:  1.56"
					End Y:  0.45"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: 3D Shadow Color
		Functions
			Function: refreshSubscr
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sSql = 
							   "select name
							    into :tblSubscr.name
							    from barsaq.aq_subscribers"
					Call SalTblPopulate( tblSubscr, hSql(), sSql, TBL_FillAll )
					!
			Function: refreshAcc
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sSql = 
							   "select a.acc, a.nls, a.kv, a.branch
							    into :tblAcc.acc,
							         :tblAcc.nls,
							         :tblAcc.kv,
							         :tblAcc.branch
							    from barsaq.aq_subscribers_acc q,
							         bars.accounts a
							    where q.name = :tblSubscr.name and q.acc=a.acc"
					Call SalTblPopulate( tblAcc, hSql(), sSql, TBL_FillAll )
			Function: GetFirstEditableColumn
				Description: Получить первую редактируюмую колонку
				Returns
					Window Handle:
				Parameters
					Window Handle: hWndTbl
				Static Variables
				Local variables
					Number: nCol
					Window Handle: hWndCol
				Actions
					Set nCol=1
					Loop
						Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol,
								    COL_GetPos)
						If hWndCol = hWndNULL
							Break
						If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
								   SalIsWindowVisible(hWndCol)
							Break
						Set nCol = nCol + 1
					Return hWndCol
		Window Parameters
		Window Variables
			String: sChooseRef
			String: sSql
			Number: nRow
		Message Actions
			On SAM_Create
				Call refreshSubscr()
				Call SalTblSetContext (tblSubscr, TBL_MinRow )
				Call SalTblSetFocusRow (tblSubscr, TBL_MinRow )
				Call refreshAcc()
				Call SalCenterWindow ( hWndForm )
	Form Window: uplJob
		Class:
		Property Template:
		Class DLL Name:
		Title: Моніторинг процесу щоденного вивантаження
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? No
			Minimizable? Yes
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.15"
				Width Editable? Yes
				Height: 7.571"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: ! Статистика работы заданий, корректировка параметров заданий
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.321"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Існуючі завдання користувача BARSUPL
				Resource Id: 46302
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.655"
					Width:  15.5"
					Width Editable? Yes
					Height: 1.5"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Group Box: Статистика виконання завдань
				Resource Id: 46303
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.155"
					Width:  15.5"
					Width Editable? Yes
					Height: 4.75"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Option Button: obStartDailyUploadJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.217"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_green.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If NOT obStartDailyUploadJob
							! при отжатии кнопки старт (зеленая) - остановить
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.disable_interface_job('" || uplJob.tblAllJobs.jobname||"')"
									                  )
								Call refreshAll()
							Else
								Call SalMessageBox('Помилка зупинки завдання на щоденне вивантаження', 'Увага!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Option Button: obStopDailyUploadJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.217"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_red.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If obStopDailyUploadJob
							! при нажатии на кнопку стоп - стартовать
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.enable_interface_job('"||uplJob.tblAllJobs.jobname||"')")
								Call refreshAll()
							Else
								Call SalMessageBox('Помилка зупинки завдання на вивантаження даних', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.62"
					Top:    0.167"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call refreshAll()
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.057"
					Top:    0.17"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			Child Table: tblAllJobs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.905"
						Width:  15.2"
						Width Editable? Yes
						Height: 1.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: jobname
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: state
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Статус
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: enabled
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Стан
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.95"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: lastdate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остання дата запуску
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  2.017"
						Width Editable? Class Default
						Format: dd/MM/yyyy hhhh:mm:ss
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: nextdate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Слідуюча дата запуску
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: dd/MM/yyyy hhhh:mm:ss
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: comments
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  2.333"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: jobaction
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код виконання
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  2.967"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							! On SAM_DoubleClick
								                              Set lsTmp = GetStringFromClob(hSql(), 
										            'barsupl.v_scheduler_jobs', 
										            'job_name', 'mess_job_action', tblAllJobs.jobname, '', '')
								                              Call SalModalDialog(dlg_MemoEditor, uploadJob,'Текст помилки', lsTmp)
				Functions
				Window Variables
				Message Actions
					On SAM_TblDoDetails
						Call refreshCurrentJobStatus()
			Child Table: tblJobJournal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    2.405"
						Width:  15.2"
						Width Editable? Yes
						Height: 4.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: logid
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №пп
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: logdate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата запису
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.933"
						Width Editable? Class Default
						Format: dd/MM/yyyy hhhh:mm:ss
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: jobname
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.15"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: status
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Статус
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: rundate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата запуску
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.967"
						Width Editable? Class Default
						Format: dd/MM/yyyy hhhh:mm:ss
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: durmin
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тривалість
								(хв)
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.067"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: longinfo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Long String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: info
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Інформація
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  5.1"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_DoubleClick
								Set lsTmp = GetStringFromClob(hSql(), 
										            'barsupl.v_upl_JOB_RUN_DETAILS', 
										            'LOG_ID', 'mess_info', tblJobJournal.logid, '', '')
								Call SalModalDialog(dlg_MemoEditor, uplJob,'Текст помилки', lsTmp)
				Functions
				Window Variables
				Message Actions
			Data Field: dfJobStatus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    0.345"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.19"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbParams
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.167"
					Top:    0.19"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\propsn_b.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! Call SalModalDialog(uploadParams, hWndParent) uploadParams
						Call SalModalDialog(uplParams, uplJob)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Параметри функціоналу' )
			Frame
				Resource Id: 34566
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.683"
					Top:    0.11"
					Width:  13.9"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Frame
				Resource Id: 14375
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.11"
					Width:  1.533"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Background Text: Статус     :
				Resource Id: 14373
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.8"
					Top:    0.369"
					Width:  0.983"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSelectedJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    0.16"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.19"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbEditJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.8"
					Top:    0.167"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\EDIT.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalCreateWindow(uplJobParValues, hWndMDI, tblAllJobs.jobname)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Параметри вибраного завдання' )
			Pushbutton: pbAddNewJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.183"
					Top:    0.167"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalModalDialog(uplAllEnabledJobs, hWndMDI, sChoosenNewJob, bIsChooseNewJob)
						If bIsChooseNewJob
							! -- добавить новый джоб
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.recreate_interface_job(sChoosenNewJob)")
								Call refreshAll()
							Else
								Call SalMessageBox('Помилка створення нового завдання', 'Увага!', MB_IconAsterisk|MB_Ok)
							Call SalWaitCursor(FALSE)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Додати нове завдання' )
			Background Text: Завдання :
				Resource Id: 14374
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.783"
					Top:    0.16"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			! Function: jobProcessButton
				                         Description: 
				                         Returns 
				                         Parameters 
					                         String: status
				                         Static Variables 
				                         Local variables 
				                         Actions 
					                         If status = 'ENABLED'
						                         Call SalHideWindow(obStopDailyUploadJob)
						                         Call SalShowWindow(obStartDailyUploadJob)
						                         Set obStartDailyUploadJob = TRUE
					                         Else 
						                         Call SalHideWindow(obStartDailyUploadJob)
						                         Call SalShowWindow(obStopDailyUploadJob)
						                         Set obStopDailyUploadJob = FALSE
			Function: refreshCurrentJobStatus
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If tblAllJobs.enabled = 'TRUE'
						Call SalHideWindow(obStopDailyUploadJob)
						Call SalShowWindow(obStartDailyUploadJob)
						Set obStartDailyUploadJob = TRUE
						!
					Else
						Call SalHideWindow(obStartDailyUploadJob)
						Call SalShowWindow(obStopDailyUploadJob)
						Set obStopDailyUploadJob = FALSE
					!
					Set dfSelectedJob=tblAllJobs.jobname
					Set dfJobStatus=tblAllJobs.state
			Function: refreshData
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql
					String: sJobStatus
				Actions
					!
					!
					! ------------------------------------- 
					! -- tblAllJobs
					! ------------------------------------- 
					Set sSql = "select job_name, state, 
							                   enabled, last_start_date, next_run_date,
							                   comments, job_action
							 into :tblAllJobs.jobname, 
							      :tblAllJobs.state, 
							      :tblAllJobs.enabled, 
							      :tblAllJobs.lastdate, 
							      :tblAllJobs.nextdate,
							      :tblAllJobs.comments,
							      :tblAllJobs.jobaction
							 from barsupl.v_upl_scheduler_jobs "
					Call SalTblPopulate( tblAllJobs, hSql(), sSql, TBL_FillAll )
					!
					!
					! ------------------------------------- 
					! -- dfJobStatus
					! ------------------------------------- 
					!
					! ------------------------------------- 
					! -- tblJobJournal
					! ------------------------------------- 
					!
					!
					Set sSql = 
							"select log_id, log_date, job_name, status, ACTUAL_START_DATE,
							        RUN_DURATION, info
							 into :tblJobJournal.logid, 
							      :tblJobJournal.logdate, 
							      :tblJobJournal.jobname, 
							      :tblJobJournal.status ,
							      :tblJobJournal.rundate ,
							      :tblJobJournal.durmin,
							      :tblJobJournal.info
							 from barsupl.v_upl_JOB_RUN_DETAILS 
							order by log_id desc "
					Call SalTblPopulate( tblJobJournal, hSql(), sSql, TBL_FillAll )
			Function: refreshAll
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call refreshData()
					Call SalTblSetContext (tblAllJobs, TBL_MinRow )
					Call refreshCurrentJobStatus()
		Window Parameters
		Window Variables
			String: sSql
			Number: nRow
			Long String: lsTmp
			Boolean: bIsChooseNewJob
			String: sChoosenNewJob
		Message Actions
			On SAM_Create
				Call SalCenterWindow ( hWndForm )
				Call refreshAll()
	! cGenericTableDlg: uplParams
.winattr class Dialog Box:
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Параметри 
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.267"
				Width Editable? Yes
				Height: 5.476"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                          Description: 
		                          Tool Bar 
			                          Contents 
				                          Pushbutton: pbIns
					                          Message Actions 
				                          Pushbutton: pbDel
					                          Message Actions 
				                          Pushbutton: pbRefresh
					                          Message Actions 
				                          Pushbutton: pbUpdate
					                          Message Actions 
				                          Line 
				                          Pushbutton: pbSearch
					                          Message Actions 
				                          Pushbutton: pbFilter
					                          Message Actions 
				                          Pushbutton: pbPrint
					                          Message Actions 
				                          Line 
				                          Pushbutton: pbOk
					                          Message Actions 
				                          Pushbutton: pbExit
					                          Message Actions 
				                          Line 
				                          Pushbutton: pbRecreateJob
					                          Message Actions 
						                          On SAM_TooltipSetText
							                          Return XSalTooltipSetText( lParam, 'Перестворити завдання' )
						                          On SAM_Click
							                          If Not SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.recreate_daily_job(1)")
								                          Call SalMessageBox('Перестворення завдання пройшло з помилками','Увага!' ,MB_IconStop)
							                          Call SalMessageBox('Перестворення завдання пройшло успішно','' ,MB_Ok)
		                          Contents 
			                          Child Table: tbl
				                          Contents 
					                          Column: groupName
						                          List Values 
						                          Message Actions 
					                          Column: paramName
						                          List Values 
						                          Message Actions 
					                          Column: paramVal
						                          List Values 
						                          Message Actions 
					                          Column: paramDesc
						                          List Values 
						                          Message Actions 
				                          Functions 
				                          Window Variables 
				                          Message Actions 
					! On SAM_Create
						                                    Call SalSetWindowText(hWndForm, 'параметри системи')
						                                    Call SalCenterWindow( hWndForm )
						                                    Set strSqlPopulate =
								'select param, value, descript
								   into :uploadParams.tbl.paramName,
								        :uploadParams.tbl.paramVal,
								        :uploadParams.tbl.paramDesc
								   from barsupl.upl_params
								  order by param'
						! Call SetStatusBarsText()
						! Call SetComponentsVisibility()
						                                    Call SalSendClassMessage(UM_Create, 0, 0)
		                          Functions 
		                          Window Parameters 
		                          Window Variables 
		                          Message Actions 
			                          On SAM_Create
				                          Call SalDisableWindow(pbIns)
				                          Call SalDisableWindow(pbDel)
				                          Call SalDisableWindow(pbOk)
				                          Call SalCenterWindow( hWndForm )
				! Set fFilterAtStart  = TRUE
				! Set strFilterTblName = 'V_UPL_STATS'
				! Set strPrintFileName = 'V_UPL_STATS'
				                          Set strSqlPopulate ="
						select g.group_name, p.param, substr(p.value,1,253), substr(p.descript,1,253)
						  into  :uploadParams.tbl.groupName,
						        :uploadParams.tbl.paramName,
						        :uploadParams.tbl.paramVal,
						        :uploadParams.tbl.paramDesc
						   from barsupl.upl_params p, barsupl.upl_param_groups g
						  where p.group_id = g.group_id and nvl(g.issystem,0) = 0
						  order by g.group_id"
				                          Set strSqlUpdate ="
						update barsupl.upl_params 
						   set value = :uploadParams.tbl.paramVal
						 where param = :uploadParams.tbl.paramName"
				                          Call SalSendClassMessage(UM_Create, 0, 0)
	! Dialog Box: dlg_kl_PostAll_old
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Технологічні роботи
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.517"
				Width Editable? Yes
				Height: 8.083"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                                                                                                    Description: Ручные технол. работы
		                                                                                                                                                                    Tool Bar 
			                                                                                                                                                                    Contents 
		                                                                                                                                                                    Contents 
			                                                                                                                                                                    Child Table: tblCustomer
				                                                                                                                                                                    Contents 
					                                                                                                                                                                    Column: colSab
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: colCustName
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Functions 
				                                                                                                                                                                    Window Variables 
					                                                                                                                                                                    String: sSql
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Create
						                                                                                                                                                                    Set sSql = "SELECT c.sab,  nmk
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM kl_customer_params cp, customer c
								    WHERE cp.rnk=c.rnk ORDER BY c.sab"
						                                                                                                                                                                    Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			                                                                                                                                                                    Pushbutton: pbOk
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    Call WaitCursorOn()
						                                                                                                                                                                    If (chbVP)
							                                                                                                                                                                    Call SalSendMsg (calVPFrom, SAM_User, 0, 0)
							                                                                                                                                                                    Call SalSendMsg (calVPTo, SAM_User, 0, 0 )
							                                                                                                                                                                    If GetGlobalOption('ORGTYPE')='KAZNA'
								                                                                                                                                                                    Set bRet = postRequest('DMVP', dFrom, dTo,'')
								                                                                                                                                                                    Set bRet = postRequest('DMVF', dFrom, dTo,'')
							                                                                                                                                                                    Else 
								                                                                                                                                                                    Set bRet = postRequest('REQB', dFrom, dTo,'')
						                                                                                                                                                                    If (chbVal)
							                                                                                                                                                                    Call SalSendMsg (calVal, SAM_User, 0, 0 )
							                                                                                                                                                                    Set bRet = postRequest('CURV', dTo, dTo,'')
						                                                                                                                                                                    If (chbBanks)
							                                                                                                                                                                    Set bRet = postRequest('BNKS', GetBankDate(), GetBankDate(),'')
						                                                                                                                                                                    If (chbAccounts)
							                                                                                                                                                                    Set bRet = postRequest('ACCN', GetBankDate(), GetBankDate(),'')
						                                                                                                                                                                    If (chbInfoMess)
							! Если текст был набран вручную или отредактирован  - записать измененное сообщение в таблицу
							                                                                                                                                                                    If nCheckedMsgId = 0
								                                                                                                                                                                    Set nCheckedMsgId = saveNewMessage(mlMsgText)
							                                                                                                                                                                    If nCheckedMsgId > -1
								                                                                                                                                                                    Set bRet = postRequest('INFO', GetBankDate(), GetBankDate(), SalNumberToStrX(nCheckedMsgId,0)  )
						!
						                                                                                                                                                                    If bRet
							                                                                                                                                                                    Call SalMessageBox('Запрос сформирован и поставлен на отправку', 'Выполнение', 0  )
						!
						                                                                                                                                                                    Call WaitCursorOff()
			                                                                                                                                                                    Check Box: chbVP
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    If chbVP
							                                                                                                                                                                    Call SalEnableWindow(calVPFrom)
							                                                                                                                                                                    Call SalEnableWindow(calVPTo)
						                                                                                                                                                                    Else 
							                                                                                                                                                                    Call SalDisableWindow(calVPFrom)
							                                                                                                                                                                    Call SalDisableWindow(calVPTo)
			                                                                                                                                                                    Custom Control: calVPFrom
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0000000000000000 01000000010A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Create
						                                                                                                                                                                    Call calVPFrom.SetMonthText( strMonth )
						                                                                                                                                                                    Call calVPFrom.SetWeekDayText( strWeekDays )
						! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday,    SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday,   SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_OneTime, GetBankDate(),DAY_Unset,     SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
						                                                                                                                                                                    Call SqlPrepareAndExecute(  hSql(), T("SELECT fdat  INTO :dSelect  FROM fdat")  )
						                                                                                                                                                                    Set i = 0
						                                                                                                                                                                    While SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                                    Call calVPFrom.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
							                                                                                                                                                                    Set i = i + 1
						                                                                                                                                                                    If i = 0
							                                                                                                                                                                    Call SalMessageBox('Нет доступных дат для выбора','Внимание',0)
									
						                                                                                                                                                                    Call SalSetWindowText(  calVPFrom,  strBankDate)
					                                                                                                                                                                    On SAM_User
						                                                                                                                                                                    Call SalGetWindowText( hWndItem, strDateFrom, 12 )
						                                                                                                                                                                    Set dFrom =  SalDateConstruct ( SalDateYear( SalStrToDate(strDateFrom )),
								                                SalDateMonth( SalStrToDate(strDateFrom )),
								                                SalDateDay( SalStrToDate(strDateFrom )), 0, 0, 0 )
			                                                                                                                                                                    Custom Control: calVPTo
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0000000000000000 01000000010A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				                                                                                                                                                                    Message Actions 
					! On SAM_Create
						                                                                                                                                                                                    Call calVPTo.SetMonthText( strMonth )
						                                                                                                                                                                                    Call calVPTo.SetWeekDayText( strWeekDays )
						! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday, SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
						                                                                                                                                                                                    Call SqlPrepareAndExecute(  hSql(), T("SELECT fdat  INTO :dSelect  FROM fdat")  )
						                                                                                                                                                                                    Set i = 0
						                                                                                                                                                                                    While SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                                                    Call calVPTo.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
							                                                                                                                                                                                    Set i = i + 1
						                                                                                                                                                                                    If i = 0
							                                                                                                                                                                                    Call SalMessageBox('Нет доступных дат для выбора','Внимание',0)
									
						                                                                                                                                                                                    Call SalSetWindowText(  calVPTo,  strBankDate)
					                                                                                                                                                                    On SAM_User
						                                                                                                                                                                    Call SalGetWindowText( hWndItem, strDateTo, 12 )
						                                                                                                                                                                    Set dTo =  SalDateConstruct ( SalDateYear( SalStrToDate(strDateTo )),
								                                SalDateMonth( SalStrToDate(strDateTo )),
								                                SalDateDay( SalStrToDate(strDateTo )), 0, 0, 0 )
			                                                                                                                                                                    Custom Control: calVal
.data CLASSPROPSSIZE
0000: 4200
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0000000000000000 01000000010A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				                                                                                                                                                                    Message Actions 
					! On SAM_Create
						                                                                                                                                                                                    Call calVal.SetMonthText( strMonth )
						                                                                                                                                                                                    Call calVal.SetWeekDayText( strWeekDays )
						! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday, SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
						                                                                                                                                                                                    Call SqlPrepareAndExecute(  hSql(), T("SELECT fdat  INTO :dSelect  FROM fdat")  )
						                                                                                                                                                                                    Set i = 0
						                                                                                                                                                                                    While SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                                                    Call calVal.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
							                                                                                                                                                                                    Set i = i + 1
						                                                                                                                                                                                    If i = 0
							                                                                                                                                                                                    Call SalMessageBox('Нет доступных дат для выбора','Внимание',0)
									
						                                                                                                                                                                                    Call SalSetWindowText(  calVPTo,  strBankDate)
					                                                                                                                                                                    On SAM_User
						                                                                                                                                                                    Call SalGetWindowText( hWndItem, strDateTo, 12 )
						                                                                                                                                                                    Set dTo =  SalDateConstruct ( SalDateYear( SalStrToDate(strDateTo )),
								                                SalDateMonth( SalStrToDate(strDateTo )),
								                                SalDateDay( SalStrToDate(strDateTo )), 0, 0, 0 )
			                                                                                                                                                                    Background Text: з
			                                                                                                                                                                    Background Text: по
			                                                                                                                                                                    Check Box: chbBanks
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Check Box: chbAccounts
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Check Box: chbVal
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    If chbVal
							                                                                                                                                                                    Call SalEnableWindow(calVal)
						                                                                                                                                                                    Else 
							                                                                                                                                                                    Call SalDisableWindow(calVal)
			                                                                                                                                                                    Pushbutton: pbCancel
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						! Call SalEndDialog(hWndForm, 0)
			                                                                                                                                                                    Check Box: chbInfoMess
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    If chbInfoMess
							                                                                                                                                                                    Call SalEnableWindow(pbMsgFromFile)
							                                                                                                                                                                    Call SalEnableWindow(mlMsgText)
							                                                                                                                                                                    Call SalEnableWindow(pbMsgFromSavedList)
						                                                                                                                                                                    Else 
							                                                                                                                                                                    Call SalDisableWindow(pbMsgFromFile)
							                                                                                                                                                                    Call SalDisableWindow(mlMsgText)
							                                                                                                                                                                    Call SalDisableWindow(pbMsgFromSavedList)
							                                                                                                                                                                    Set mlMsgText=''
			                                                                                                                                                                    Pushbutton: pbMsgFromSavedList
				                                                                                                                                                                    Message Actions 
					! On SAM_Create
						                                                                                                                                                                                                                                                       Set strTip = 'Редактирование'
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    Call SalCreateWindow(tbl_MsgList, hWndItem)
					                                                                                                                                                                    On SAM_TooltipSetText
						                                                                                                                                                                    Return XSalTooltipSetText( lParam, 'Сообщение из сохраненного списка' )
			                                                                                                                                                                    Pushbutton: pbMsgFromFile
				                                                                                                                                                                    Message Actions 
					! On SAM_Create
						                                                                                                                                                                                                                                                       Set strTip = 'Из файла'
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    Set nCheckedMsgId=0
						                                                                                                                                                                    Call getMessTextFromFile()
					                                                                                                                                                                    On SAM_TooltipSetText
						                                                                                                                                                                    Return XSalTooltipSetText( lParam, 'Сообщение из файла' )
			                                                                                                                                                                    Multiline Field: mlMsgText
				                                                                                                                                                                    Message Actions 
					!
						                                                                                                                                                                                                                                                      Call SalCreateWindow(tbl_MsgList, hWndItem)
					                                                                                                                                                                    On SAM_FieldEdit
						! Если поле редактированли - то сообщение уже не такое, как выбрали из таблицы
						! В этом случае - сохраним его потом в таблицу
						                                                                                                                                                                    Set nCheckedMsgId = 0
								
			                                                                                                                                                                    Child Table: tblServices
				                                                                                                                                                                    Contents 
					                                                                                                                                                                    Column: checked
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
							                                                                                                                                                                    On SAM_FieldEdit
								! nContext = SalTblQueryContext (hWndTbl)
								                                                                                                                                                                    Call SalTblSetRowFlags(tblServices,  SalTblQueryContext (tblServices), 0,0)
					                                                                                                                                                                    Column: serviceName
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: serviceCode
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parname1
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parval1
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parname2
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parval2
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parname3
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parval3
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parname4
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    Column: parval4
						                                                                                                                                                                    List Values 
						                                                                                                                                                                    Message Actions 
				                                                                                                                                                                    Functions 
				                                                                                                                                                                    Window Variables 
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Create
						                                                                                                                                                                    Set sSql = 
								   "select 0, m.descript, snam 
								    into :tblServices.checked,
								         :tblServices.serviceName,
								         :tblServices.serviceCode         
								    from xml_messtypes m, xml_servlist s
								    where message = snam and auto_gen = 1"
						                                                                                                                                                                    Call SalTblPopulate( tblServices, hSql(), sSql, TBL_FillAll )
						!
						!
						                                                                                                                                                                    Set nRow = TBL_MinRow
						                                                                                                                                                                    While SalTblFindNextRow(tblServices, nRow, 0, 0)
							                                                                                                                                                                    Call SalTblSetContext( tblServices, nRow )
							                                                                                                                                                                    Call SqlPLSQLCommand(hSql(), 
									      "bars_xmlklb_que.get_def_service_params(
									           tblServices.serviceCode,
									           tblServices.parname1,
									           tblServices.parval1, 
									           tblServices.parname2,
									           tblServices.parval2,
									           tblServices.parname3,
									           tblServices.parval3,
									           tblServices.parname4,
									           tblServices.parval4)")
						!
						                                                                                                                                                                    Set nRow = 0
						                                                                                                                                                                    Call SalTblSetContext(tblServices, nRow )
						                                                                                                                                                                    Call SalTblSetFocusRow(tblServices, nRow )
						!
						                                                                                                                                                                    Call Debug(tblServices.serviceCode||' - '||tblServices.parname1||' - '||tblServices.parval1)
						                                                                                                                                                                    Call setPramsValues()
					                                                                                                                                                                    On SAM_TblDoDetails
						                                                                                                                                                                    Call setPramsValues()
			                                                                                                                                                                    Check Box: cbCheckAllServices
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                    Set nRow = TBL_MinRow
						                                                                                                                                                                    While SalTblFindNextRow(tblServices, nRow, 0, 0)
							                                                                                                                                                                    Call SalTblSetContext( tblServices, nRow )
							                                                                                                                                                                    Set tblServices.checked = cbCheckAllServices
			                                                                                                                                                                    Frame 
			                                                                                                                                                                    Data Field: dfParname1
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Data Field: dfParval1
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_FieldEdit
						                                                                                                                                                                    Set tblServices.parval1 = dfParval1
			                                                                                                                                                                    Data Field: dfParname2
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Data Field: dfParval2
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_FieldEdit
						                                                                                                                                                                    Set tblServices.parval2 = dfParval2
			                                                                                                                                                                    Data Field: dfParname3
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Data Field: dfParval3
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_FieldEdit
						                                                                                                                                                                    Set tblServices.parval3 = dfParval3
			                                                                                                                                                                    Data Field: dfParname4
				                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    Data Field: dfParval4
				                                                                                                                                                                    Message Actions 
					                                                                                                                                                                    On SAM_FieldEdit
						                                                                                                                                                                    Set tblServices.parval4 = dfParval4
		                                                                                                                                                                    Functions 
			                                                                                                                                                                    Function: postRequest
				                                                                                                                                                                    Description: 
				                                                                                                                                                                    Returns 
					                                                                                                                                                                    Boolean: 
				                                                                                                                                                                    Parameters 
					                                                                                                                                                                    String: sRequestName
					! Date: dat1
					                                                                                                                                                                    Date/Time: dat1
					                                                                                                                                                                    Date/Time: dat2
					                                                                                                                                                                    String: sInfo
				                                                                                                                                                                    Static Variables 
				                                                                                                                                                                    Local variables 
					                                                                                                                                                                    Number: iRow
				                                                                                                                                                                    Actions 
					                                                                                                                                                                    Set iRow = TBL_MinRow
					                                                                                                                                                                    While SalTblFindNextRow(tblCustomer, iRow, ROW_Selected, 0)
						                                                                                                                                                                    Call SalTblSetContext( tblCustomer, iRow )
						                                                                                                                                                                    If not SqlPLSQLCommand(hSql(), "bars_xmlklb_que.post_module_request(sRequestName, tblCustomer.colSab, dat1, dat2, sInfo)")
							                                                                                                                                                                    Return FALSE
						                                                                                                                                                                    Call SqlCommitEx(hSql(),'')
					                                                                                                                                                                    Return TRUE
			                                                                                                                                                                    Function: getMessTextFromFile
				                                                                                                                                                                    Description: 
				                                                                                                                                                                    Returns 
					! String: sMsgText
				                                                                                                                                                                    Parameters 
				                                                                                                                                                                    Static Variables 
				                                                                                                                                                                    Local variables 
					                                                                                                                                                                    String: sFileNameFilters[*]
					                                                                                                                                                                    String: sSelectedFileName
					                                                                                                                                                                    String: sSelectedFilePath
					                                                                                                                                                                    String: sFileLine
					                                                                                                                                                                    Number: nSelectedFiltr
					                                                                                                                                                                    File Handle: hFile
				                                                                                                                                                                    Actions 
					                                                                                                                                                                    Set sFileNameFilters[0]='All files'
					                                                                                                                                                                    Set sFileNameFilters[1]='*.*'
					                                                                                                                                                                    Call SalDlgOpenFile (hWndNULL, 'Файл сообщения', sFileNameFilters, 2, nSelectedFiltr, sSelectedFileName, sSelectedFilePath )
					                                                                                                                                                                    If VisFileOpen (hFile, sSelectedFilePath, OF_Read) = VTERR_Ok
						                                                                                                                                                                    While VisFileReadString (hFile, sFileLine) = VTERR_Ok
							                                                                                                                                                                    Set mlMsgText = mlMsgText || sFileLine || SalNumberToChar( 13 ) || SalNumberToChar( 10 )
			                                                                                                                                                                    Function: saveNewMessage
				                                                                                                                                                                    Description: 
				                                                                                                                                                                    Returns 
					                                                                                                                                                                    Number: 
				                                                                                                                                                                    Parameters 
					                                                                                                                                                                    Long String: sMessText
				                                                                                                                                                                    Static Variables 
				                                                                                                                                                                    Local variables 
					                                                                                                                                                                    Number: nMessId
				                                                                                                                                                                    Actions 
					                                                                                                                                                                    If SqlPrepareAndExecute(hSql(), "SELECT nvl(max(id_mess),0)+1 INTO :nMessId FROM kl_info_messages") AND SqlFetchNext(hSql(), i)
						                                                                                                                                                                    If SqlPrepareAndExecute(hSql(), "INSERT INTO kl_info_messages VALUES(:nMessId, :sMessText)")
							                                                                                                                                                                    Call SqlCommit(hSql())
							                                                                                                                                                                    Return nMessId
						                                                                                                                                                                    Else 
							                                                                                                                                                                    Call SalMessageBox('Невозможно вставить новое сообщение','Внимание!', MB_OK)
							                                                                                                                                                                    Return -1
					                                                                                                                                                                    Else 
						                                                                                                                                                                    Call SalMessageBox('Невозможно получить последующий номер для сообщения','Внимание!', MB_OK)
						                                                                                                                                                                    Return -1
			                                                                                                                                                                    Function: setPramsValues
				                                                                                                                                                                    Description: 
				                                                                                                                                                                    Returns 
				                                                                                                                                                                    Parameters 
				                                                                                                                                                                    Static Variables 
				                                                                                                                                                                    Local variables 
				                                                                                                                                                                    Actions 
					                                                                                                                                                                    Set dfParname1 = 'параметр: '||tblServices.parname1
					                                                                                                                                                                    Set dfParval1 = tblServices.parval1
					                                                                                                                                                                    Set dfParname2 = 'параметр: '||tblServices.parname2
					                                                                                                                                                                    Set dfParval2 = tblServices.parval2
					                                                                                                                                                                    Set dfParname3 = 'параметр: '||tblServices.parname3
					                                                                                                                                                                    Set dfParval3 = tblServices.parval3
					                                                                                                                                                                    Set dfParname4 = 'параметр: '||tblServices.parname4
					                                                                                                                                                                    Set dfParval4 = tblServices.parval4
		                                                                                                                                                                    Window Parameters 
		                                                                                                                                                                    Window Variables 
			                                                                                                                                                                    String: sCheckedMsgText
			                                                                                                                                                                    Number: nCheckedMsgId
			                                                                                                                                                                    String: sSql
			                                                                                                                                                                    String: strMonth[12]              !! Наименов. месяце для календаря
			                                                                                                                                                                    String: strWeekDays[7]         !! Дни недели для календаря
			                                                                                                                                                                    Number: nFetchRes
			                                                                                                                                                                    Number: i
			                                                                                                                                                                    Number: nRow
			                                                                                                                                                                    Boolean: bRet
			                                                                                                                                                                    Date/Time: dSelect
			                                                                                                                                                                    Date/Time: dFrom
			                                                                                                                                                                    Date/Time: dTo
			                                                                                                                                                                    String: strDateTo
			                                                                                                                                                                    String: strBankDate
			                                                                                                                                                                    String: strDateFrom
		                                                                                                                                                                    Message Actions 
			                                                                                                                                                                    On SAM_Create
				                                                                                                                                                                    Call GetMonthArray( strMonth )
				                                                                                                                                                                    Call GetWeekDayArray( strWeekDays )
				                                                                                                                                                                    Call SalDisableWindow(calVPFrom)
				                                                                                                                                                                    Call SalDisableWindow(calVPTo)
				                                                                                                                                                                    Call SalDisableWindow(calVal)
				!
				                                                                                                                                                                    Call SalDisableWindow(pbMsgFromFile)
				                                                                                                                                                                    Call SalDisableWindow(mlMsgText)
				                                                                                                                                                                    Call SalDisableWindow(pbMsgFromSavedList)
				!
				                                                                                                                                                                    Set nCheckedMsgId = 0
				                                                                                                                                                                    Set bRet = FALSE
	Dialog Box: dlg_MemoViewer
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.975"
				Top:    1.354"
				Width:  11.133"
				Width Editable? Yes
				Height: 5.512"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Multiline Field: mlEditor
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   -0.017"
						Top:    -0.012"
						Width:  11.1"
						Width Editable? Yes
						Height: 5.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 12
					Font Enhancement: Default
					Text Color: Default
					Background Color: Gray
				Message Actions
					On SAM_SetFocus
						Set SQLText = mlEditor
					On SAM_AnyEdit
						Set mlEditor =SQLText
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ok
				Window Location and Size
					Left:   6.633"
					Top:    9.0"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(dlg_MemoViewer, SAM_Close, 0, 0)
		Functions
		Window Parameters
			String: Title
			Long String: SQLText
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, Title)
				Call PrepareWindowEx(hWndForm)
				Set mlEditor = SQLText
				! Call SalDisableWindow(mlEditor)
			On SAM_CreateComplete
				Call SalSetFocus(pb1)
	Dialog Box: rsReferences
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Таблицы для синхронизации ORACLE STREAM
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.95"
				Width Editable? Class Default
				Height: 5.024"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tblRefs, nRow, ROW_New, 0)
								Call SalTblSetContext(tblRefs, nRow)
								If not SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.add_table(tblRefs.tablename)")
									Call SalMessageBox('Ошибка добавления справочника', 'Внимание!', MB_IconAsterisk|MB_Ok)
										Return FALSE
							!
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tblRefs, nRow, ROW_MarkDeleted, 0)
								Call SalTblSetContext(tblRefs, nRow)
								If not SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.remove_table(tblRefs.tablename)")
									Call SalMessageBox('Ошибка удаления справочника', 'Внимание!', MB_IconAsterisk|MB_Ok)
										Return FALSE
							!
							Call SalWaitCursor(FALSE)
							Call refreshData()
				Line
					Resource Id: 18816
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 18817
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sChooseRef   = tblRefs.tablename
							Call SalWaitCursor(TRUE)
							Call SalEndDialog(rsReferences, 0)
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sChooseRef   = ''
							Call SalSendClassMessage(SAM_Click, 0, 0)
				Line
					Resource Id: 18818
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tblRefs
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: tablename
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование таблицы для синхронизации
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  7.817"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_DoubleClick
								If nMode = 1
									Set sChooseRef = tblRefs.tablename
									Call SalEndDialog(rsReferences, 0)
				Functions
				Window Variables
				Message Actions
					On SAM_DoubleClick
						Call SalSendMsg(pbOk, SAM_Click, 0, 0)
		Functions
			Function: refreshData
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! - выбор значения  
					If nMode = 1
						Set sSql = 
								   "select tabname
								    into :tblRefs.tablename
								    from barsaq.refsync_list 
								    where tabname not in 
								        ( select table_name from barsaq.v_subscribed_tables 
								          where user_name = :rsSubsribers.tblSubscr.name
								         )"
					Else
						Set sSql = 
								   "select tabname
								    into :tblRefs.tablename
								    from barsaq.refsync_list"
					Call SalTblPopulate( tblRefs, hSql(), sSql, TBL_FillAll )
		Window Parameters
			! !=0 - редактирование справочника =1 - выбор значения  
			Number: nMode 
			Receive String: sChooseRef ! выбранный справочник
		Window Variables
			String: sSql
			Number: nRow
		Message Actions
			On SAM_Create
				Call refreshData()
				Call SalCenterWindow ( hWndForm)
				If nMode = 1
					Call SalDisableWindow(pbIns)
					Call SalDisableWindow(pbDel)
					Call SalDisableWindow(pbRefresh)
					Call SalDisableWindow(pbUpdate)
				!
			On SAM_Close
	Form Window: rsSubsribers
		Class:
		Property Template:
		Class DLL Name:
		Title: Подписчики для очереди ORACLE STREAMS
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.3"
				Width Editable? Yes
				Height: 5.917"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Подписчики
				Resource Id: 11756
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.495"
					Width:  6.3"
					Width Editable? Yes
					Height: 4.905"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Уже подписанные справочники
				Resource Id: 11757
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.45"
					Top:    0.495"
					Width:  5.4"
					Width Editable? Yes
					Height: 4.905"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 11758
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.675"
					Width:  6.1"
					Width Editable? Yes
					Height: 0.43"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Pushbutton: pbAddSubsriber
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.73"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						!
						If not SalTblAnyRows(tblSubscr, ROW_New, 0)
							Call SalTblDefineSplitWindow(tblSubscr, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow(tblSubscr, TBL_MinRow)
						Call SalTblSetContext(tblSubscr, nRow)
						Call SalTblSetFocusCell(tblSubscr, nRow,
								     GetFirstEditableColumn(tblSubscr), 0, 1)
						!
						! Call refreshSubscr()
						! Call refreshRefs()
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Добавить подписчика' )
			Pushbutton: pbDelSubsriber
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.74"
					Top:    0.73"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						!
						!
						If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.remove_subscriber(tblSubscr.name)")
							! Call refreshData()
						Else
							Call SalMessageBox('Ошибка удаления подписчика', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
						!
						Call refreshSubscr()
						Call refreshRefs()
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Удалить подписчика' )
			Child Table: tblSubscr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.155"
						Width:  6.1"
						Width Editable? Yes
						Height: 4.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.017"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: descr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Описание
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.017"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_TblDoDetails
						Call refreshRefs()
			Frame
				Resource Id: 11759
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.55"
					Top:    0.675"
					Width:  5.1"
					Width Editable? Yes
					Height: 0.43"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Pushbutton: pbAddRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.65"
					Top:    0.73"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalModalDialog(rsReferences, hWndForm, 1, sChooseRef)
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.add_ref_to_subscriber(tblSubscr.name, sChooseRef)")
							Call SalWaitCursor(TRUE)
							Call refreshRefs()
						Else
							Call SalMessageBox('Ошибка добавления таблицы', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Добавить справочник' )
			Pushbutton: pbDelRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.1"
					Top:    0.73"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.remove_ref_from_subscriber(tblSubscr.name, tblRefs.name)")
							Call refreshRefs()
						Else
							Call SalMessageBox('Ошибка удаления таблицы', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Удалить справочник' )
			Child Table: tblRefs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.55"
						Top:    1.155"
						Width:  5.1"
						Width Editable? Yes
						Height: 4.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя 
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.25"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Frame
				Resource Id: 11760
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  11.8"
					Width Editable? Yes
					Height: 0.417"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Line
				Resource Id: 33895
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  1.17"
					Begin Y:  0.11"
					End X:  1.17"
					End Y:  0.45"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: 3D Shadow Color
			Pushbutton: pbSaveSubscriber
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.183"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						!
						!
						If SalTblAnyRows(tblSubscr, ROW_New, 0)
							Call SalTblFindNextRow ( tblSubscr, nRow, ROW_New, 0)    
							Call SalTblSetContext(tblSubscr, nRow)
							If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync.add_subscriber(tblSubscr.name, '', tblSubscr.descr)")
								Call refreshSubscr()
								Call refreshRefs()
							Else
								Call SalMessageBox('Ошибка добавления подписчика', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
						Call SalWaitCursor(FALSE)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сохранить изменния по подписчикам' )
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.64"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call refreshSubscr()
						Call SalTblSetContext ( tblSubscr, TBL_MinRow )
						Call SalTblSetFocusRow ( tblSubscr, TBL_MinRow )
						Call refreshRefs()
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Обновить информацию' )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.283"
					Top:    0.12"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Выход' )
		Functions
			Function: refreshSubscr
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sSql = 
							   "select name, description
							    into :tblSubscr.name, :tblSubscr.descr
							    from barsaq.aq_subscribers"
					Call SalTblPopulate( tblSubscr, hSql(), sSql, TBL_FillAll )
					!
			Function: refreshRefs
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sSql = 
							   "select table_name
							    into :tblRefs.name
							    from barsaq.v_subscribed_tables
							    where user_name = :tblSubscr.name"
					Call SalTblPopulate( tblRefs, hSql(), sSql, TBL_FillAll )
			Function: GetFirstEditableColumn
				Description: Получить первую редактируюмую колонку
				Returns
					Window Handle:
				Parameters
					Window Handle: hWndTbl
				Static Variables
				Local variables
					Number: nCol
					Window Handle: hWndCol
				Actions
					Set nCol=1
					Loop
						Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol,
								    COL_GetPos)
						If hWndCol = hWndNULL
							Break
						If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
								   SalIsWindowVisible(hWndCol)
							Break
						Set nCol = nCol + 1
					Return hWndCol
		Window Parameters
		Window Variables
			String: sChooseRef
			String: sSql
			Number: nRow
		Message Actions
			On SAM_Create
				Call refreshSubscr()
				Call SalTblSetContext ( tblSubscr, TBL_MinRow )
				Call SalTblSetFocusRow ( tblSubscr, TBL_MinRow )
				Call refreshRefs()
				Call SalCenterWindow ( hWndForm )
	Dialog Box: rsAllAcc
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Счета для выбора в синхронизацию
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 11764
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 11765
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							Call SalWaitCursor(TRUE)
							While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
								Call SalTblSetContext(tbl, nRow)
								Call SqlPLSQLCommand(hSql(), "barsaq.bars_accsync.subscribe_acc(rsSubsribersAcc.tblSubscr.name, tbl.acc)")
							Call SalEndDialog(hWndForm,0)
							Call rsSubsribersAcc.refreshAcc()
							Call SalWaitCursor(FALSE)
							!
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 11766
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: acc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: nls
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Лицевой сч.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.967"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: kv
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: branch
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Бранч
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Set strSqlPopulate =
						"select acc,nls, kv, branch
						 into :rsAllAcc.tbl.acc, 
						      :rsAllAcc.tbl.nls, 
						      :rsAllAcc.tbl.kv, 
						      :rsAllAcc.tbl.branch      
						 from bars.accounts
						 where acc not in (
						       select acc from barsaq.aq_subscribers_acc q
						       where q.name = :rsSubsribersAcc.tblSubscr.name) 
						 order by branch, nls, kv"
				Set strSqlInsert = ""
				Set strSqlUpdate = ""
				Set strSqlDelete = ""
				Set strFilterTblName = "ACCOUNTS"
				Set strPrintFileName = ""
				Set nFlags = GT_ReadOnly
				Call tbl.cF.Init(strFilterTblName, strFilterTblName)
				Set fFilterAtStart = 1
				Call SalCenterWindow ( hWndForm )
				Call SalSendClassMessage(UM_Create, 0, 0)
				Call SalWaitCursor(FALSE)
	! Dialog Box: dlg_RefSync
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Синхронізація довідників
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.633"
				Width Editable? Yes
				Height: 5.619"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                                                   Description: Ручные технол. работы
		                                                                                                                   Tool Bar 
			                                                                                                                   Contents 
		                                                                                                                   Contents 
			                                                                                                                   Child Table: tblCustomer
				                                                                                                                   Contents 
					                                                                                                                   Column: checked
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
					                                                                                                                   Column: colSab
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
					                                                                                                                   Column: colCustName
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
				                                                                                                                   Functions 
				                                                                                                                   Window Variables 
					                                                                                                                   String: sSql
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Create
						                                                                                                                   Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						                                                                                                                   Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			                                                                                                                   Pushbutton: pbOk
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Call WaitCursorOn()
						!
						                                                                                                                   Set nRow = TBL_MinRow
						                                                                                                                   While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                                                                                   Call SalTblSetContext( tblCustomer, nRow )
							                                                                                                                   If tblCustomer.checked
								!
								! по каждому выбранному сервису
								!
								                                                                                                                   Set i = TBL_MinRow
								                                                                                                                   While SalTblFindNextRow(tblRefs, i, 0, 0)
									                                                                                                                   Call SalTblSetContext( tblRefs, i )
									                                                                                                                   If tblRefs.checked
										                                                                                                                   If rbSyncFull
											                                                                                                                   If SqlPLSQLCommand(hSql(), 
													      "bars_xmlklb_ref.post_fullref_for_sab(
													           tblCustomer.colSab,
													           tblRefs.refName)")
												                                                                                                                   Call SqlCommit(hSql())
										                                                                                                                   If rbSyncPost
											                                                                                                                   If SqlPLSQLCommand(hSql(), 
													      "bars_xmlklb_ref.post_postref_for_sab(
													           tblCustomer.colSab,           
													           tblRefs.refName,
													           dtBankDate)")
												                                                                                                                   Call SqlCommit(hSql())
										                                                                                                                   If rbSyncReqv
											! Call SalModalDialog(dlg_SyncReqvPar, hWndForm, tblRefs.refName)
						!
						                                                                                                                   Call WaitCursorOff()
			                                                                                                                   Pushbutton: pbCancel
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Call SalEndDialog(hWndForm, 0)
			                                                                                                                   Child Table: tblRefs
				                                                                                                                   Contents 
					                                                                                                                   Column: checked
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
							                                                                                                                   On SAM_FieldEdit
								! nContext = SalTblQueryContext (hWndTbl)
								                                                                                                                   Call SalTblSetRowFlags(tblRefs,  SalTblQueryContext (tblRefs), 0,0)
					                                                                                                                   Column: refDescr
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
					                                                                                                                   Column: refName
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
					                                                                                                                   Column: refParam
						                                                                                                                   List Values 
						                                                                                                                   Message Actions 
				                                                                                                                   Functions 
				                                                                                                                   Window Variables 
				                                                                                                                   Message Actions 
					                                                                                                                   On UM_Populate
						                                                                                                                   Set sSqlSelect = 
								   "select 0, descript, r.kltable_name, ''
								    from xml_reflist r, "||sRefTable||" rr "||
								   "where r.kltable_name = rr.kltable_name and rr.isactive = 1
								    order by select_order"  
						                                                                                                                   Call SalTblPopulate( tblRefs, hSql(), sSqlSelect, TBL_FillAll )
			                                                                                                                   Check Box: cbCheckAllServices
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Set nRow = TBL_MinRow
						                                                                                                                   While SalTblFindNextRow(tblRefs, nRow, 0, 0)
							                                                                                                                   Call SalTblSetContext( tblRefs, nRow )
							                                                                                                                   Set tblRefs.checked = cbCheckAllServices
			                                                                                                                   Check Box: cbCheckAllClients
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Set nRow = TBL_MinRow
						                                                                                                                   While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                                                                                   Call SalTblSetContext( tblCustomer, nRow )
							                                                                                                                   Set tblCustomer.checked = cbCheckAllClients
			                                                                                                                   Group Box: Клієнти
			                                                                                                                   Group Box: Довідники
			                                                                                                                   Frame 
			                                                                                                                   Radio Button: rbSyncPost
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Set rbSyncPost = TRUE
						                                                                                                                   Set rbSyncFull = FALSE
						                                                                                                                   Set sRefTable = 'xml_reflist_post'
						                                                                                                                   Call SalHideWindow(tblRefs.refParam)
						!
						                                                                                                                   Call SalSendMsg(tblRefs, UM_Populate, 0 ,0)
						!
			                                                                                                                   Radio Button: rbSyncFull
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Set rbSyncPost = FALSE 
						                                                                                                                   Set rbSyncFull = TRUE
						!
						                                                                                                                   Call SalHideWindow(tblRefs.refParam)
						                                                                                                                   Set sRefTable = 'xml_reflist_full'
						                                                                                                                   Call SalSendMsg(tblRefs, UM_Populate, 0 ,0)
			                                                                                                                   Radio Button: rbSyncReqv
				                                                                                                                   Message Actions 
					                                                                                                                   On SAM_Click
						                                                                                                                   Set rbSyncPost = FALSE 
						                                                                                                                   Set rbSyncFull = FALSE
						!
						                                                                                                                   Set sRefTable = 'xml_reflist_reqv'
						                                                                                                                   Call SalShowWindow(tblRefs.refParam)
						                                                                                                                   Call SalSendMsg(tblRefs, UM_Populate, 0 ,0)
			                                                                                                                   Frame 
		                                                                                                                   Functions 
		                                                                                                                   Window Parameters 
		                                                                                                                   Window Variables 
			                                                                                                                   String: sSqlSelect
			                                                                                                                   Number: nFetchRes
			                                                                                                                   Number: i
			                                                                                                                   Number: nRow
			                                                                                                                   String: sRefTable
			                                                                                                                   Date/Time: dtBankDate
			!
			                                                                                                                   Number: nParCount
			                                                                                                                   String: nParValue1
			                                                                                                                   String: nParValue2
			                                                                                                                   String: nParValue3
			                                                                                                                   String: nParValue4
		                                                                                                                   Message Actions 
			                                                                                                                   On SAM_Create
				                                                                                                                   Call SalCenterWindow(dlg_RefSync)
				                                                                                                                   Call SalSendMsg(rbSyncPost, SAM_Click, 0 ,0)
				                                                                                                                   Set dtBankDate = GetBankDate()
	Dialog Box: dlg_SyncReqvPar
		Class:
		Property Template:
		Class DLL Name:
		Title: Параметри для вигрузки довідника
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.667"
				Width Editable? Yes
				Height: 2.548"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.017"
						Top:    -0.012"
						Width:  5.6"
						Width Editable? Yes
						Height: 1.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: parDesc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Параметр
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parVal
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Значення
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.917"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							! If 
							On SAM_SetFocus
								If tbl1.parVal = 'NOTUSE'
									Set sTmp = MyValue
							On SAM_AnyEdit
								If tbl1.parVal = 'NOTUSE'
									Set MyValue = sTmp
				Functions
				Window Variables
				Message Actions
			Frame
				Resource Id: 10065
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    1.655"
					Width:  5.6"
					Width Editable? Yes
					Height: 0.59"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Прийняти
				Window Location and Size
					Left:   1.383"
					Top:    1.738"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.455"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nRowNew = TBL_MinRow
						Set i =0
						While SalTblFindNextRow(dlg_SyncReqvPar.tbl1,nRowNew,  0, 0)
							Call SalTblSetContext( dlg_SyncReqvPar.tbl1, nRowNew )
							Set sParValue[i] = tbl1.parVal
							Set i = i+ 1
						Call SalEndDialog ( hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Відмінити
				Window Location and Size
					Left:   2.883"
					Top:    1.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog ( hWndForm, 0)
		Functions
		Window Parameters
			String: sKlTableDesc
			Number: sParCount
			String: sParName[4]
			Receive String: sParValue[4]
		Window Variables
			Number: i
			Number: nRowNew
			String: sTmp
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Параметри для довідника: '||sKlTableDesc)
				Call SalCenterWindow ( hWndForm )
				Call WaitCursorOff()
				Set i = 1
				Loop
					If i > sParCount
						Break
					Set nRowNew = SalTblInsertRow( dlg_SyncReqvPar.tbl1, TBL_MaxRow )
					Call SalTblSetRowFlags( dlg_SyncReqvPar.tbl1, nRowNew, ROW_New, FALSE )
					Call SalTblSetContext( dlg_SyncReqvPar.tbl1, nRowNew )
					Set tbl1.parDesc = sParName[i-1]
					Set tbl1.parVal = sParValue[i-1]
					Set i = i+1
	Dialog Box: dlg_RefSyncReqv
		Class:
		Property Template:
		Class DLL Name:
		Title: Синхронізація довідників за параметрами
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.667"
				Width Editable? Yes
				Height: 5.202"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Ручные технол. работы
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblCustomer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.488"
						Width:  5.3"
						Width Editable? Yes
						Height: 3.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_KillFocus
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_Click
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ел.ідент.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCustName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва клієнту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   4.383"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						!
						Set nChooseCustCnt = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							If tblCustomer.checked
								Set nChooseCustCnt = nChooseCustCnt + 1
								!
								! по каждому выбранному сервису
								!
								Set i = TBL_MinRow
								While SalTblFindNextRow(tblRefs, i, 0, 0)
									Call SalTblSetContext( tblRefs, i )
									If tblRefs.checked
										If SqlPLSQLCommand(hSql(), 
												      "bars_xmlklb_ref.post_paramref_for_sab(
												           tblCustomer.colSab,           
												           tblRefs.refName,
												           tblRefs.parval1,
												           tblRefs.parval2,
												           tblRefs.parval3,
												           tblRefs.parval4
												        )")
											Call SqlCommit(hSql())
						!
						If nChooseCustCnt = 0
							Call SalMessageBox('Не вибрано жодного відділення','Увага',MB_Ok|MB_IconExclamation)
						Call WaitCursorOff()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Вихід
				Window Location and Size
					Left:   5.683"
					Top:    4.226"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Child Table: tblRefs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    0.488"
						Width:  5.7"
						Width Editable? Yes
						Height: 3.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.617"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_AnyEdit
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
							On SAM_KillFocus
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
							On SAM_Click
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
					Column: refDescr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Довідники
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.75"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: refName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parcount
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parnam1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parnam2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parnam3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parnam4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parval4
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: parDesc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Параметри
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.583"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: param1
					String: param2
					String: param3
					String: param4
				Message Actions
					On UM_Populate
						Set sSqlSelect = 
								   "select  0, descript, r.kltable_name, parcount, 
								            parnam1, parval1, parnam2, parval2,parnam3, parval3,parnam4, parval4,''
								    from   xml_reflist r, xml_reflist_reqv rr, v_xmlrefpar p 
								    where  r.kltable_name = rr.kltable_name and rr.isactive = 1
								           and p.kltable_name = r.kltable_name
								    order by select_order"
						Call SalTblPopulate( tblRefs, hSql(), sSqlSelect, TBL_FillAll )
					On SAM_DoubleClick
						!
						Call SalTblSetRowFlags(tblCustomer, SalTblQueryContext(tblCustomer), ROW_Edited, FALSE)
						! если уже были установлены параметры
						!
						If tblRefs.parcount >= 1 
							Set sParName[0] = tblRefs.parnam1
							Set sParValue[0] = tblRefs.parval1
						If tblRefs.parcount >= 2 
							Set sParName[1] = tblRefs.parnam2
							Set sParValue[1] = tblRefs.parval2
						If tblRefs.parcount >= 3 
							Set sParName[2] = tblRefs.parnam3
							Set sParValue[2] = tblRefs.parval3
						If tblRefs.parcount >= 4 
							Set sParName[3] = tblRefs.parnam4
							Set sParValue[3] = tblRefs.parval4
						!
						!
						!
						If SalModalDialog(dlg_SyncReqvPar, hWndForm,  
								     tblRefs.refDescr,
								     tblRefs.parcount, 
								     sParName,
								     sParValue)
							If tblRefs.parcount >= 1 
								Set tblRefs.parnam1 = sParName[0] 
								Set tblRefs.parval1 = sParValue[0]
							If tblRefs.parcount >= 2 
								Set tblRefs.parnam2 = sParName[1]
								Set tblRefs.parval2 = sParValue[1]
							If tblRefs.parcount >= 3 
								Set tblRefs.parnam3 = sParName[2]
								Set tblRefs.parval3 = sParValue[2] 
							If tblRefs.parcount >= 4 
								Set tblRefs.parnam4 = sParName[3]
								Set tblRefs.parval4 = sParValue[3]
							Set tblRefs.parDesc = tblRefs.parval1||IifS(SalStrLength(tblRefs.parval2)>0,';','')||
									              tblRefs.parval2||IifS(SalStrLength(tblRefs.parval3)>0,';','')||
									              tblRefs.parval3||IifS(SalStrLength(tblRefs.parval4)>0,';','')||
									              tblRefs.parval4
					On SAM_Create
						Call SalSendMsg(dlg_RefSyncReqv.tblRefs,UM_Populate,0,0 )
					On SAM_FetchRowDone
						Set tblRefs.parDesc = tblRefs.parval1||IifS(SalStrLength(tblRefs.parval2)>0,';','')||
								              tblRefs.parval2||IifS(SalStrLength(tblRefs.parval3)>0,';','')||
								              tblRefs.parval3||IifS(SalStrLength(tblRefs.parval4)>0,';','')||
								              tblRefs.parval4
			Check Box: cbCheckAllServices
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   6.3"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblRefs, nRow, 0, 0)
							Call SalTblSetContext( tblRefs, nRow )
							Set tblRefs.checked = cbCheckAllServices
			Check Box: cbCheckAllClients
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   0.75"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							Set tblCustomer.checked = cbCheckAllClients
			Group Box: Клієнти
				Resource Id: 10066
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.071"
					Width:  5.567"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Довідники
				Resource Id: 10067
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.683"
					Top:    0.071"
					Width:  5.9"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 10068
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    4.071"
					Width:  11.6"
					Width Editable? Yes
					Height: 0.833"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
		Functions
		Window Parameters
		Window Variables
			String: sSqlSelect
			Number: nFetchRes
			Number: i
			Number: nRow
			!
			Number: nParMaxCount ! макс кол-во параметров
			Number: nParCount
			String: sParName[4]
			String: sParValue[4]
			Number: nChooseCustCnt
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Set nParMaxCount = 4
	Dialog Box: dlg_RefSyncFull
		Class:
		Property Template:
		Class DLL Name:
		Title: Повна синхронізація довідників
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.633"
				Width Editable? Yes
				Height: 5.119"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Повна синхронізація довідників
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblCustomer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.488"
						Width:  5.3"
						Width Editable? Yes
						Height: 3.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_KillFocus
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_Click
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ел.ідент.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCustName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва клієнту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   4.383"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						!
						Set nChooseCustCnt = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							If tblCustomer.checked
								Set nChooseCustCnt = nChooseCustCnt+1
								!
								! по каждому выбранному сервису
								!
								Set i = TBL_MinRow
								While SalTblFindNextRow(tblRefs, i, 0, 0)
									Call SalTblSetContext( tblRefs, i )
									If tblRefs.checked
										If SqlPLSQLCommand(hSql(), 
												      "bars_xmlklb_ref.post_fullref_for_sab(tblCustomer.colSab,tblRefs.refName)")
											Call SqlCommit(hSql())
						If nChooseCustCnt = 0
							Call SalMessageBox('Не вибрано жодного відділення','Увага',MB_Ok|MB_IconExclamation)
						!
						Call WaitCursorOff()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Вихід
				Window Location and Size
					Left:   5.983"
					Top:    4.226"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Child Table: tblRefs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    0.488"
						Width:  5.5"
						Width Editable? Yes
						Height: 3.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.617"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_AnyEdit
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
							On SAM_KillFocus
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
							On SAM_Click
								Call SalTblSetRowFlags(tblRefs, SalTblQueryContext(tblRefs), ROW_Edited, FALSE)
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblRefs, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblRefs, nRow )
									Call SalTblSetRowFlags(tblRefs, nRow, ROW_Edited, FALSE)
					Column: refDescr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Довідники
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: refName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Set sSqlSelect = 
								   "select 0, descript, r.kltable_name
								    from xml_reflist r, xml_reflist_full rr "||
								   "where r.kltable_name = rr.kltable_name and rr.isactive = 1
								    order by select_order"  
						Call SalTblPopulate( tblRefs, hSql(), sSqlSelect, TBL_FillAll )
					On SAM_Create
						Call SalSendMsg(dlg_RefSyncFull.tblRefs,UM_Populate,0,0 )
			Check Box: cbCheckAllServices
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   6.3"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblRefs, nRow, 0, 0)
							Call SalTblSetContext( tblRefs, nRow )
							Set tblRefs.checked = cbCheckAllServices
			Check Box: cbCheckAllClients
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   0.75"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							Set tblCustomer.checked = cbCheckAllClients
			Group Box: Клієнти
				Resource Id: 10070
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.071"
					Width:  5.567"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Довідники
				Resource Id: 10071
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.683"
					Top:    0.071"
					Width:  5.8"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 10072
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    4.071"
					Width:  11.5"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
		Functions
		Window Parameters
		Window Variables
			String: sSqlSelect
			Number: nFetchRes
			Number: i
			Number: nRow
			String: sRefTable
			Number: nChooseCustCnt
			!
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
	! Dialog Box: dlg_Upload
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Вигрузка  файлів 
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  15.883"
				Width Editable? Yes
				Height: 6.226"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                             Description: Повна синхронізація довідників
		                                             Tool Bar 
			                                             Contents 
		                                             Contents 
			                                             Child Table: tblFiles
				                                             Contents 
					                                             Column: colId
						                                             List Values 
						                                             Message Actions 
					                                             Column: colFileId
						                                             List Values 
						                                             Message Actions 
					                                             Column: colGroupId
						                                             List Values 
						                                             Message Actions 
					                                             Column: colFileCode
						                                             List Values 
						                                             Message Actions 
					                                             Column: colFileDesc
						                                             List Values 
						                                             Message Actions 
					                                             Column: colUplStatus
						                                             List Values 
						                                             Message Actions 
					                                             Column: colStartTime
						                                             List Values 
						                                             Message Actions 
					                                             Column: colStopTime
						                                             List Values 
						                                             Message Actions 
					                                             Column: colRowsUpl
						                                             List Values 
						                                             Message Actions 
					                                             Column: colErr
						                                             List Values 
						                                             Message Actions 
					                                             Column: colUplMin
						                                             List Values 
						                                             Message Actions 
					                                             Column: colFtpMess
						                                             List Values 
						                                             Message Actions 
					                                             Column: colArcMess
						                                             List Values 
						                                             Message Actions 
				                                             Functions 
				                                             Window Variables 
					                                             String: sSql
				                                             Message Actions 
					                                             On SAM_Create
						                                             Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						                                             Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			                                             Pushbutton: pbOk
				                                             Message Actions 
					                                             On SAM_Click
						                                             Call WaitCursorOn()
						!
						                                             Call SalShowWindow(dfProgressStatus1)
						                                             Call SalShowWindow(dfProgressStatus2)
						!
						                                             Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
						                                             Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                             Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
						                                             Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                             Set nChooseCustCnt = 0  ! кол-во выбранных клиентов
						                                             Set nDatesCnt = 0  ! кол-во выбранных дат
						!
						! найдем список дат по которым нужно сделать отчет
						!
						                                             If SqlPrepareAndExecute(hSql(),
								          'select fdat into :dtChooseDate
								           from   fdat
								           where fdat between :dtDateFrom and :dtDateTo')
							                                             While SqlFetchNext(hSql(), nRow)
								                                             Set dtDates[nDatesCnt] = dtChooseDate
								! Call Debug('Есть дата '||SalFmtFormatDateTime(dtDates[nDatesCnt],'dd-MM-yyyy'))
								                                             Set nDatesCnt = nDatesCnt + 1
						!
						! Если не найдено ни однойбанковской даты за выбранный период
						! Call Debug('nDatesCnt='|| SalNumberToStrX(nDatesCnt,0))
						!
						                                             If nDatesCnt = 0
							                                             Call SalMessageBox('За вибраний період не знайдено ні однієї робочої банківської дати','Увага',MB_Ok|MB_IconExclamation)
							                                             Set dfProgressStatus1 = ''
							                                             Set dfProgressStatus2 = ''
						                                             Else 
							! Call Debug('Найдем данные')
							                                             Set nRow = TBL_MinRow
							                                             While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
								                                             Call SalTblSetContext( tblCustomer, nRow )
								! Call Debug(tblCustomer.colSab|| '  выбран')
								                                             If tblCustomer.checked
									                                             Set nChooseCustCnt = nChooseCustCnt + 1
									                                             Set dfProgressStatus1 = 'Формування на '||tblCustomer.colSab
									                                             Set i = 0
									                                             While i < nDatesCnt
										! Call Debug('Формирование за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
										                                             Set dfProgressStatus2 = 'за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy')||'...'
										                                             Call SalSendMsg(dfProgressStatus2,  SAM_Validate, 0,0 )
										                                             If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.postvp_for_sab(tblCustomer.colSab,dtDates[i],dfNlsMask)")
											                                             Call SqlCommit(hSql())
										                                             Set i = i + 1
									!
							!
							                                             If nChooseCustCnt = 0
								                                             Call SalMessageBox('Не вибрано жодного відділення','Увага',MB_Ok|MB_IconExclamation)
								                                             Set dfProgressStatus1 = ''
								                                             Set dfProgressStatus2 = ''
							                                             Else 
								                                             Set dfProgressStatus1 = ''
								                                             Set dfProgressStatus2 = 'Виписки сформовані'
							!
						                                             Call WaitCursorOff()
					! On SAM_Click
						                                                 Call WaitCursorOn()
						!
						                                                 Call SalShowWindow(dfProgressStatus1)
						                                                 Call SalShowWindow(dfProgressStatus2)
						!
						                                                 Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
						                                                 Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                 Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
						                                                 Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                 While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                 Call SalTblSetContext( tblCustomer, nRow )
							! Call Debug(tblCustomer.colSab|| '  выбран')
							                                                 If tblCustomer.checked
								                                                 If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.post_info_message(dtDateFrom, dtDateTo, tblCustomer.colSab)")
									! Call Debug('Выполнено для '||tblCustomer.colSab||' за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
									                                                 Call SqlCommit(hSql())
								                                                 Else 
									                                                 Call SalMessageBox('Помилка виконання функції','Увага',MB_Ok|MB_IconExclamation)
									!
						                                                 Call WaitCursorOff()
			                                             Pushbutton: pbCancel
				                                             Message Actions 
					                                             On SAM_Click
						                                             Call SalEndDialog(hWndForm, 0)
			                                             Group Box: Параметри
			                                             Background Text: за
			                                             Combo Box: cmbDateFrom
				                                             List Initialization 
				                                             Message Actions 
					                                             On SAM_Create
						                                             Call cmbDateFrom.Init(hWndItem)
						                                             Call cmbDateFrom.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
								    "(select fdat from fdat)",
								     "ORDER BY fdat DESC")
						                                             Call SalListSetSelect(cmbDateFrom, 0)
					                                             On SAM_AnyEdit
						                                             Set dfProgressStatus1 = ''
						                                             Set dfProgressStatus2 = ''
			                                             Radio Button: rb1
				                                             Message Actions 
			                                             Radio Button: rb2
				                                             Message Actions 
			                                             Check Box: cb2
				                                             Message Actions 
			                                             Check Box: cb3
				                                             Message Actions 
			                                             Pushbutton: pb3
				                                             Message Actions 
		                                             Functions 
		                                             Window Parameters 
		                                             Window Variables 
			                                             String: sSqlSelect
			                                             Number: nRow
			! Number: nCount
			!
			                                             Date/Time: dtDateFrom
			                                             Date/Time: dtDateTo
			                                             String: sTmp
			                                             Date/Time: dtChooseDate
			                                             Number: nChooseCustCnt
			                                             Number: i
			                                             Number: nDatesCnt
			                                             Date/Time: dtDates[*]
		                                             Message Actions 
			                                             On SAM_Create
				                                             Call SalCenterWindow(hWndForm)
				                                             Call SalHideWindow(dfProgressStatus1)
				                                             Call SalHideWindow(dfProgressStatus2)
				                                             Set dfNlsMask = '*'
				                                             Set nChooseCustCnt = 0
	! Dialog Box: dlg_RefSyncInfo
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Вигрузка виписки
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.9"
				Width Editable? Yes
				Height: 4.952"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                             Description: Повна синхронізація довідників
		                                                                             Tool Bar 
			                                                                             Contents 
		                                                                             Contents 
			                                                                             Child Table: tblCustomer
				                                                                             Contents 
					                                                                             Column: checked
						                                                                             List Values 
						                                                                             Message Actions 
							                                                                             On SAM_AnyEdit
								                                                                             Set nRow = TBL_MinRow
								                                                                             While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									                                                                             Call SalTblSetContext( tblCustomer, nRow )
									                                                                             Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							                                                                             On SAM_KillFocus
								                                                                             Set nRow = TBL_MinRow
								                                                                             While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									                                                                             Call SalTblSetContext( tblCustomer, nRow )
									                                                                             Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							                                                                             On SAM_Click
								                                                                             Set nRow = TBL_MinRow
								                                                                             While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									                                                                             Call SalTblSetContext( tblCustomer, nRow )
									                                                                             Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
					                                                                             Column: colSab
						                                                                             List Values 
						                                                                             Message Actions 
					                                                                             Column: colCustName
						                                                                             List Values 
						                                                                             Message Actions 
				                                                                             Functions 
				                                                                             Window Variables 
					                                                                             String: sSql
				                                                                             Message Actions 
					                                                                             On SAM_Create
						                                                                             Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						                                                                             Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			                                                                             Pushbutton: pbOk
				                                                                             Message Actions 
					                                                                             On SAM_Click
						                                                                             Call WaitCursorOn()
						!
						                                                                             Call SalShowWindow(dfProgressStatus1)
						                                                                             Call SalShowWindow(dfProgressStatus2)
						!
						                                                                             Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
						                                                                             Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                                             Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
						                                                                             Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                                             Set nRow = TBL_MinRow
						                                                                             Set nChooseCustCnt = 0
						                                                                             Set nDatesCnt = 0
						!
						! найдем список дат по которым нужно сделать отчет
						!
						                                                                             Set i = 0
						                                                                             If SqlPrepareAndExecute(hSql(), 
								          'select fdat into :dtChooseDate 
								           from   fdat 
								           where fdat between :dtDateFrom and :dtDateTo')
							                                                                             While SqlFetchNext(hSql(), nRow) 
								                                                                             Set dtDates[i] = dtChooseDate
								                                                                             Set i = i + 1
						                                                                             Set nCount = i
						!
						                                                                             While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                                             Call SalTblSetContext( tblCustomer, nRow )
							                                                                             If tblCustomer.checked
								                                                                             Set nChooseCustCnt = nChooseCustCnt + 1
								!
								! Call Debug(SalFmtFormatDateTime(dtDateFrom,'dd-MM-yyyy')||' - '||SalFmtFormatDateTime(dtDateTo,'dd-MM-yyyy'))
								                                                                             Set i = 0
								                                                                             If SqlPrepareAndExecute(hSql(), 
										          'select fdat into :dtChooseDate 
										           from   fdat 
										           where fdat between :dtDateFrom and :dtDateTo')
									                                                                             While SqlFetchNext(hSql(), nRow) 
										                                                                             Set dtDates[i] = dtChooseDate
										                                                                             Set i = i + 1
								                                                                             Set nCount = i
								!
								!
								                                                                             Set dfProgressStatus1 = 'Формування на '||tblCustomer.colSab
								                                                                             Set i = 0
								                                                                             Loop 
									                                                                             If i >= nCount 
										                                                                             Break 
									                                                                             Set dfProgressStatus2 = 'за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy')||'...'
									                                                                             Call SalSendMsg(dfProgressStatus2,  SAM_Validate, 0,0 )
									                                                                             If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.postvp_for_sab(tblCustomer.colSab,dtDates[i],dfNlsMask)")
										                                                                             Call SqlCommit(hSql())
									                                                                             Set i = i + 1
								!
								!
						                                                                             If nChooseCustCnt = 0
							                                                                             Call SalMessageBox('Не вибрано жодного відділення','Увага',MB_Ok|MB_IconExclamation)
							                                                                             Set dfProgressStatus1 = ''
							                                                                             Set dfProgressStatus2 = ''
						                                                                             Else 
							                                                                             Set dfProgressStatus1 = ''
							                                                                             Set dfProgressStatus2 = 'Виписки сформовані'
						!
						                                                                             Call WaitCursorOff()
			                                                                             Pushbutton: pbCancel
				                                                                             Message Actions 
					                                                                             On SAM_Click
						                                                                             Call SalEndDialog(hWndForm, 0)
			                                                                             Check Box: cbCheckAllClients
				                                                                             Message Actions 
					                                                                             On SAM_Click
						                                                                             Set nRow = TBL_MinRow
						                                                                             While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                                             Call SalTblSetContext( tblCustomer, nRow )
							                                                                             Set tblCustomer.checked = cbCheckAllClients
			                                                                             Group Box: Клієнти
			                                                                             Group Box: Повідомлення
			                                                                             Frame 
			                                                                             Group Box: Повідомлення
			                                                                             List Box: lb1
				                                                                             List Initialization 
				                                                                             Message Actions 
			                                                                             Frame 
			                                                                             Pushbutton: pb3
				                                                                             Message Actions 
			                                                                             Pushbutton: pb4
				                                                                             Message Actions 
		                                                                             Functions 
		                                                                             Window Parameters 
		                                                                             Window Variables 
			                                                                             String: sSqlSelect
			                                                                             Number: nRow
			                                                                             Number: nCount
			!
			                                                                             Date/Time: dtDateFrom
			                                                                             Date/Time: dtDateTo
			                                                                             String: sTmp
			                                                                             Date/Time: dtChooseDate
			                                                                             Number: nChooseCustCnt
			                                                                             Number: i
			                                                                             Number: nDatesCnt
			                                                                             Date/Time: dtDates[*]
		                                                                             Message Actions 
			                                                                             On SAM_Create
				                                                                             Call SalCenterWindow(hWndForm)
				                                                                             Call SalHideWindow(dfProgressStatus1)
				                                                                             Call SalHideWindow(dfProgressStatus2)
				                                                                             Set dfNlsMask = '*'
				                                                                             Set nChooseCustCnt = 0
	Dialog Box: dlg_AddNewBranch
		Class:
		Property Template:
		Class DLL Name:
		Title: Реєстрація нового відділення для роботи в оффлайні
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.667"
				Width Editable? Yes
				Height: 3.881"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 13977
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    2.905"
					Width:  7.6"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Frame
				Resource Id: 13978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    -0.012"
					Width:  7.6"
					Width Editable? Yes
					Height: 2.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Radio Button: rbFromFile
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Файл із списком відділень
				Window Location and Size
					Left:   0.35"
					Top:    2.012"
					Width:  4.633"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDisableWindow(dfSab)
						Call SalDisableWindow(dfTechKey)
						Call SalDisableWindow(cmbChooseBranch)
						Call SalEnableWindow(dfFilePath)
			Radio Button: rbManualy
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєстрація одного відділення вручну
				Window Location and Size
					Left:   0.283"
					Top:    0.238"
					Width:  4.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEnableWindow(dfSab)
						Call SalEnableWindow(dfTechKey)
						Call SalEnableWindow(cmbChooseBranch)
						Call SalDisableWindow(dfFilePath)
						Set dfStatusBar = ''
			Background Text: Відділення
				Resource Id: 13980
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    0.595"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Ключ технолога  (6-ть симв.)
				Resource Id: 13981
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.717"
					Top:    1.476"
					Width:  3.167"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbChooseBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.683"
					Top:    0.905"
					Width:  6.7"
					Width Editable? Class Default
					Height: 2.119"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbChooseBranch.Init(hWndItem)
						Call cmbChooseBranch.Populate(hSql(), 
								"branch", "branch ||' '||name",
								    "(select branch, name 
								        from branch 
								       where length(branch)<>length('/000000/') 
								         and branch<>'/'
								         and branch not in (select branch from v_klbx_branch))",
								     "order by branch")
						Call SalListSetSelect(cmbChooseBranch, 0)
			Data Field: dfSab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.983"
						Top:    1.155"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfTechKey
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.983"
						Top:    1.429"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfFilePath
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    2.321"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbChooseFile
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.783"
					Top:    2.3"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\OPEN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
							Set dfFilePath = sFilePathName
						Set dfStatusBar = ''
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.883"
					Top:    2.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   2.583"
					Top:    2.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						If rbManualy
							Set sChooseBranch = cmbChooseBranch.GetKey(SalListQuerySelection(cmbChooseBranch))
							If SqlPLSQLCommand(hSql(), 
									      "bars.bars_xmlklb_utl.add_offline_client2(
									           sChooseBranch,           
									           dfSab,
									           dfTechKey
									        )")
								Call SqlCommit(hSql())
								Call SalMessageBox('Відділення зареєстроване','Реєстрація',MB_Ok)
						If rbFromFile
							Call SalFileOpen ( hFile, dfFilePath, OF_ReadWrite )
							Set i = 0
							Set nSucessFileResult = 0
							Set dfStatusBar = 'Реєстрація: '
							While SalFileGetStr(hFile, sBuffer, 128)
								Call SalStrTokenize(sBuffer, '', ';', sBranchParams)
								Set dfStatusBar = 'Реєстрація: '||' '||sBranchParams[0]
								If SqlPLSQLCommand(hSql(), 
										      "bars.bars_xmlklb_utl.add_offline_client3(
										           sBranchParams[0],           
										           sBranchParams[1],
										           sBranchParams[2],
										           nRegistrationResult,
										           sRegistrationInfo
										        )")
									Call SqlCommit(hSql())
									Set sBranches[i] = sBranchParams[0]
									If nRegistrationResult = 0
										Set sRegistrationResults[i] = 'Успішно зареєстровано'
										Set nSucessFileResult = nSucessFileResult + 1
									Else
										Set sRegistrationResults[i] = 'Помилка: '||SalNumberToStrX(nRegistrationResult,0)||'. '||sRegistrationInfo
								Else
									Call SqlRollback(hSql())
								Set i = i+1
							!
							Set nBranchesCount = i
							If nBranchesCount = 0 
								Call SalMessageBox('Жодного відділення не було зареєстровано','Реєстрація',MB_Ok)
							Else
								If nBranchesCount = nSucessFileResult
									Call SalMessageBox('Всі відділення були успішно зареєстровані','Реєстрація',MB_Ok)
								Else
									Set i = 0
									While i < nBranchesCount
										Set sWholeFileInfo = sWholeFileInfo||sBranches[i]||': '||sRegistrationResults[i]||PutCrLf()
										Set i = i+1
									Call SalMessageBox('Деякі відділення не були зареєстровані!'||PutCrLf()||PutCrLf()||sWholeFileInfo,'Реєстрація',MB_Ok|MB_IconExclamation)
							Set dfStatusBar = 'Успішно зареєстровано: '||SalNumberToStrX(nSucessFileResult,0)||', з помилками: '||SalNumberToStrX(i - nSucessFileResult, 0)
							Call SalFileClose(hFile)
						Call SalWaitCursor(FALSE)
			Background Text: Електронна адреса САБ (6-ть симв.)
				Resource Id: 40860
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    1.25"
					Width:  3.167"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfStatusBar
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    2.595"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: sChooseBranch
			Long String: sRegistrationInfo
			Long String: sWholeFileInfo
			Number: nRegistrationResult
			String: sBuffer
			File Handle: hFile
			String: sBranchParams[3]
			String: sRegistrationResults[*]
			String: sBranches[*]
			Number: nSucessFileResult
			Number: nBranchesCount
			Number: i
			Number: sBranchesCount
			String: sFilters[0:2]
			Number: nFilters
			Number: nIndex
			String: sFileName
			String: sFilePathName
		Message Actions
			On SAM_CreateComplete
				Call SalSendMsg(rbManualy, SAM_Click, 0, 0)
				Set sFilters[0] = 'All files'
				Set sFilters[1] = '*.*'
				Set nFilters = 2
				Set nIndex = 1
				Call SalCenterWindow(hWndForm)
			On SAM_Create
				Set rbFromFile = FALSE
				Set rbManualy = TRUE
	Table Window: tblKorp
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Рахунки корпоративних клієнтів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.867"
				Width Editable? Class Default
				Height: 6.476"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.798"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.52"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set dfRowsCnt = 0
							Call SalSendClassMessage(SAM_Click, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If SqlPLSQLCommand(hSql(), 
										      "bars.update_corp_accounts(tblKorp.acc, tblKorp.inst_kod, tblKorp.trkk_kod, tblKorp.use_invp, tblKorp.alt_corp )")
									Call SqlCommit(hSql())
								Else
									Call SalMessageBox('Не виконано поновленя', CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
							Set cbCheckAll = FALSE
							Call SalSendClassMessage( SAM_Click, wParam, lParam)
				Line
					Resource Id: 1389
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.0"
						Begin Y:  0.0"
						End X:  0.0"
						End Y:  0.488"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1390
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.883"
						Begin Y:  Class Default
						End X:  3.883"
						End Y:  0.405"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1392
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.883"
						Begin Y:  0.405"
						End X:  1.883"
						End Y:  -0.012"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Встановити для виділених
					Resource Id: 1393
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Значення:
					Resource Id: 1394
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.283"
						Top:    0.155"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cmbParamValList
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.683"
						Top:    0.405"
						Width:  2.2"
						Width Editable? Class Default
						Height: 1.655"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
				Pushbutton: pbChange
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.017"
						Top:    0.345"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: D:\BARS98\RESOURCE\BMP\OK.BMP
					Picture Transparent Color: Magenta
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
								Call SalMessageBox('Не вибрано жодного рахунку', CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
							Else
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext(hWndForm, nRow)
									Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
									Select Case nChooseParam
										Case PRM_USEVP
											Set tblKorp.use_invp = cmbParamValList.GetKey( SalListQuerySelection( cmbParamValList))
											Break
										Case PRM_TRKK
											Set tblKorp.trkk_kod = SalStrToNumber(dfParamValField)
											Break
										Case PRM_KODU
											Set tblKorp.inst_kod = SalStrToNumber(cmbParamValList.GetKey( SalListQuerySelection( cmbParamValList)))
											Break
							Call SalSendMsg( pbUpdate, SAM_Click, 0, 0 )
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Змінити значення')
				Data Field: dfParamValField
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    0.405"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.27"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmbParamName
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.183"
						Top:    0.405"
						Width:  2.3"
						Width Editable? Class Default
						Height: 0.881"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call SalSendMsg( hWndItem, SAM_User, 0, 0 )
						On SAM_User
							Call cmbParamName.Init( hWndItem )
							Call SalListClear( hWndItem )
							Call cmbParamName.Add( PRM_USEVP,'вкл. у виписку' )
							Call cmbParamName.Add( PRM_TRKK, 'Код ТРКК' )
							Call cmbParamName.Add( PRM_KODU, 'Код установи' )
							! Call cmbRepType.SetSelectById( nType )
							!
						On SAM_Click
							Set nChooseParam = cmbParamName.GetKey( SalListQuerySelection( cmbParamName))
							Select Case nChooseParam
								Case PRM_USEVP
									Call cmbParamValList.Init( cmbParamValList )
									Call SalHideWindow( dfParamValField )
									Call SalShowWindow( cmbParamValList )
									Call SalListClear( cmbParamValList )
									Call cmbParamValList.Add( 'Y', 'так' )
									Call cmbParamValList.Add( 'N', 'ні' )
									Call cmbParamValList.SetSelectById( 'Y' )
									Break
								Case PRM_TRKK
									Call SalHideWindow( cmbParamValList )
									Call SalShowWindow( dfParamValField )
									Set dfParamValField = ''
									Break
								Case PRM_KODU
									Call SalHideWindow( dfParamValField )
									Call SalShowWindow( cmbParamValList )
									Call cmbParamValList.Init(cmbParamValList)
									Call cmbParamValList.Populate(hSql(), "to_char(KOD_UPF)", "to_char(KOD_UPF)||'-'||NAME_UPF","ORG_PFU","ORDER BY KOD_UPF" )
									Break
							Call SalSendClassMessage( SAM_Click, 0, 0 )
				Check Box: cbCheckAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вибрати всі
					Window Location and Size
						Left:   0.383"
						Top:    0.488"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, cbCheckAll)
				Frame
					Resource Id: 24830
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.983"
						Top:    0.071"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.667"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Border Color: 3D Shadow Color
					Background Color: Default
				Data Field: dfRowsCnt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.488"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Кількість:
					Resource Id: 34665
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.083"
						Top:    0.52"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
		Contents
			Column: corp_kod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						корп.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  0.533"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: corp_name
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва корпор.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.533"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: nmk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Клієнт
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.633"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: nls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.833"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: kv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.583"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: branch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Відділення
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.017"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: nms
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва рахунку
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: use_invp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Виписка
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  0.917"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: Y
						Uncheck Value: N
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: trkk_kod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						ТРКК
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.9"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: inst_kod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						устан.
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.817"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: acc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: alt_corp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Альт.
						корпор.
				Visible? Yes
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  1.067"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: daos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						відкриття
				Visible? Yes
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: dd/MM/yyyy
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: alt_corplist
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Альт.
						корпор.
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.567"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If alt_corplist.Init( hWndItem )
							Call alt_corplist.Populate(hSql(), 'KOD_CLI','NAME_CLI', 'KOD_CLI','KOD_CLI' )
					On SAM_AnyEdit
						Set nChooseAltCorp = alt_corplist.GetKey( SalListQuerySelection( tblKorp.alt_corplist) )
						Set tblKorp.alt_corp = nChooseAltCorp
					On SAM_Validate
						If tblKorp.alt_corplist = STRING_Null
							Set tblKorp.alt_corp = NUMBER_Null
		Functions
		Window Parameters
		Window Variables
			: cAux
				Class: cABSConnect
			Number: nChooseParam
			Number: nRow
			Number: nRowCnt
			Date/Time: dtBankDate
			Number: nChooseAltCorp
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalHideWindow(dfParamValField)
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Set dtBankDate = GetBankDate()
				!
				!
				Set fFilterAtStart  = TRUE
				Set strFilterTblName = 'V_CORP_ACCOUNTS'
				Set strPrintFileName = 'V_CORP_ACCOUNTS'
				Set tblKorp.nTabInstance = 1
				!
				Set strSqlPopulate =
						'select corp_kod, corp_name, acc, nls, nms, use_invp, 
						        trkk_kod, inst_kod, kv, nmk, branch, alt_corp_cod, daos, 
						        case when k.kod_cli is not null then k.name_cli else null end 
						   into :tblKorp.corp_kod,
						        :tblKorp.corp_name,
						        :tblKorp.acc,
						        :tblKorp.nls,
						        :tblKorp.nms,
						        :tblKorp.use_invp,
						        :tblKorp.trkk_kod,
						        :tblKorp.inst_kod,
						        :tblKorp.kv,
						        :tblKorp.nmk,
						        :tblKorp.branch,
						        :tblKorp.alt_corp,
						        :tblKorp.daos,
						        :tblKorp.alt_corplist
						   from v_corp_accounts, kod_cli k
						  where alt_corp_cod = k.kod_cli(+)
						  order by corp_kod, rnk, substr(nls,1,4), substr(nls,6)'
				Call SalSendClassMessage(UM_Create, 0, 0)
			On SAM_FetchRowDone
				Set dfRowsCnt = dfRowsCnt + 1
				! Дата открытия счета два дня назад
				If dtBankDate <= tblKorp.daos 
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 200, 200, 255 ) )
			On SAM_RowHeaderClick
				If dtBankDate <= tblKorp.daos 
					Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
					Call XSalTooltipShow(hWndForm, 'Рахунок було нещодавно відкрито')
					Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
	Dialog Box: dlg_PostInfo
		Class:
		Property Template:
		Class DLL Name:
		Title: Розсилка ынформаційних повідомлень
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.183"
				Width Editable? Yes
				Height: 4.964"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Ручные технол. работы
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblCustomer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.488"
						Width:  6.0"
						Width Editable? Yes
						Height: 3.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.667"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ел.ідент.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCustName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва клієнту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql = "SELECT c.sab,  nmk
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM kl_customer_params cp, customer c
								    WHERE cp.rnk=c.rnk ORDER BY c.sab"
						Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   4.867"
					Top:    4.06"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						!
						If cbSepInfo=TRUE
							Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
							Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
									 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
									 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
							!
							Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
							Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
									 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
									 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
							!
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
								Call SalTblSetContext( tblCustomer, nRow )
								! Call Debug(tblCustomer.colSab|| '  выбран')
								If tblCustomer.checked
									If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.post_info_message(dtDateFrom, dtDateTo, tblCustomer.colSab)")
										! Call Debug('Выполнено для '||tblCustomer.colSab||' за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
										Call SqlCommit(hSql())
									Else
										Call SalMessageBox('Помилка виконання функції','Увага',MB_Ok|MB_IconExclamation)
										!
						If cbInfo = TRUE 
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
								Call SalTblSetContext( tblCustomer, nRow )
								If tblCustomer.checked
									If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.process_info_for_sab(tblCustomer.colSab, mlMessage)")
										! Call Debug('Выполнено для '||tblCustomer.colSab||' за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
										Call SqlCommit(hSql())
									Else
										Call SalMessageBox('Помилка виконання функції','Увага',MB_Ok|MB_IconExclamation)
										!
						! bars_xmlklb_ref.process_info_for_sab(:new.sab, l_txt);
						Call WaitCursorOff()
						Call SalMessageBox('Повідомлення сформовані','Увага',MB_Ok)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Вихід
				Window Location and Size
					Left:   6.383"
					Top:    4.06"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Check Box: cbCheckAllClients
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   0.75"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							Set tblCustomer.checked = cbCheckAllClients
			Group Box: Клієнти
				Resource Id: 53013
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.071"
					Width:  6.267"
					Width Editable? Yes
					Height: 3.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Сервіси
				Resource Id: 53014
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.283"
					Top:    0.06"
					Width:  5.8"
					Width Editable? Yes
					Height: 3.845"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 53015
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.117"
					Top:    3.905"
					Width:  12.067"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Check Box: cbSepInfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інформаційні повідомлення з СЕП
				Window Location and Size
					Left:   6.683"
					Top:    0.571"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If cbSepInfo = TRUE
							Call SalEnableWindow(cmbDateFrom)
							Call SalEnableWindow(cmbDateTo)
							Call SalEnableWindow(dfTf1)
							Call SalEnableWindow(dfTf2)
						Else
							Call SalDisableWindow(cmbDateFrom)
							Call SalDisableWindow(cmbDateTo)
							Call SalDisableWindow(dfTf1)
							Call SalDisableWindow(dfTf2)
			Check Box: cbInfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текстове повідомлення
				Window Location and Size
					Left:   6.683"
					Top:    1.488"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If cbInfo = TRUE
							Call SalEnableWindow(mlMessage)
						Else
							Call SalDisableWindow(mlMessage)
			Combo Box: cmbDateFrom
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   6.95"
					Top:    0.929"
					Width:  2.1"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbDateFrom.Init(hWndItem)
						Call cmbDateFrom.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
								    "(select unique fdat from xml_vpinfodoc)",
								     "ORDER BY fdat DESC")
						Call SalListSetSelect(cmbDateFrom, 0)
			Combo Box: cmbDateTo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   9.55"
					Top:    0.929"
					Width:  2.1"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbDateTo.Init(hWndItem)
						Call cmbDateTo.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
								    "(select unique fdat from xml_vpinfodoc)",
								     "ORDER BY fdat DESC")
						Call SalListSetSelect(cmbDateTo, 0)
			Data Field: dfTf1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    0.952"
						Width:  0.467"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfTf2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.05"
						Top:    0.976"
						Width:  0.467"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Multiline Field: mlMessage
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   6.683"
						Top:    1.821"
						Width:  5.2"
						Width Editable? Yes
						Height: 1.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: sSql
			Number: nFetchRes
			Number: i
			Number: nRow
			Boolean: bRet
			Date/Time: dSelect
			Date/Time: dtDateFrom
			Date/Time: dtDateTo
			String: strDateTo
			String: strBankDate
			String: strDateFrom
			String: sTmp
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SalDisableWindow(mlMessage)
				Call SalDisableWindow(cmbDateFrom)
				Call SalDisableWindow(cmbDateTo)
				Call SalDisableWindow(dfTf1)
				Call SalDisableWindow(dfTf2)
				Set dfTf1 = 'З'
				Set dfTf2 = 'По'
	Dialog Box: dlg_RefSyncVp
		Class:
		Property Template:
		Class DLL Name:
		Title: Вигрузка виписки
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.483"
				Width Editable? Yes
				Height: 5.131"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Повна синхронізація довідників
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblCustomer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.488"
						Width:  6.4"
						Width Editable? Yes
						Height: 3.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: checked
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.65"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_KillFocus
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
							On SAM_Click
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(tblCustomer, nRow, ROW_Edited, 0)
									Call SalTblSetContext( tblCustomer, nRow )
									Call SalTblSetRowFlags(tblCustomer, nRow, ROW_Edited, FALSE)
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ел.ідент.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCustName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва клієнту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql = "SELECT sab,  name
								    INTO :tblCustomer.colSab, :tblCustomer.colCustName
								    FROM v_klbx_branch 
								    WHERE isactive = 1"
						Call SalTblPopulate( tblCustomer, hSql(), sSql, TBL_FillAll )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виконати
				Window Location and Size
					Left:   3.083"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						!
						Call SalShowWindow(dfProgressStatus1)
						Call SalShowWindow(dfProgressStatus2)
						!
						Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
						Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
						Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						Set nChooseCustCnt = 0  ! кол-во выбранных клиентов
						Set nDatesCnt = 0  ! кол-во выбранных дат
						!
						! найдем список дат по которым нужно сделать отчет
						!
						If SqlPrepareAndExecute(hSql(),
								          'select fdat into :dtChooseDate
								           from   fdat
								           where fdat between :dtDateFrom and :dtDateTo')
							While SqlFetchNext(hSql(), nRow)
								Set dtDates[nDatesCnt] = dtChooseDate
								! Call Debug('Есть дата '||SalFmtFormatDateTime(dtDates[nDatesCnt],'dd-MM-yyyy'))
								Set nDatesCnt = nDatesCnt + 1
						!
						! Если не найдено ни однойбанковской даты за выбранный период
						! Call Debug('nDatesCnt='|| SalNumberToStrX(nDatesCnt,0))
						!
						If nDatesCnt = 0
							Call SalMessageBox('За вибраний період не знайдено ні однієї робочої банківської дати','Увага',MB_Ok|MB_IconExclamation)
							Set dfProgressStatus1 = ''
							Set dfProgressStatus2 = ''
						Else
							! Call Debug('Найдем данные')
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
								Call SalTblSetContext( tblCustomer, nRow )
								! Call Debug(tblCustomer.colSab|| '  выбран')
								If tblCustomer.checked
									Set nChooseCustCnt = nChooseCustCnt + 1
									Set dfProgressStatus1 = 'Формування на '||tblCustomer.colSab
									Set i = 0
									While i < nDatesCnt
										! Call Debug('Формирование за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
										Set dfProgressStatus2 = 'за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy')||'...'
										Call SalSendMsg(dfProgressStatus2,  SAM_Validate, 0,0 )
										If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.postvp_for_sab(tblCustomer.colSab,dtDates[i],dfNlsMask)")
											Call SqlCommit(hSql())
										Set i = i + 1
									!
							!
							If nChooseCustCnt = 0
								Call SalMessageBox('Не вибрано жодного відділення','Увага',MB_Ok|MB_IconExclamation)
								Set dfProgressStatus1 = ''
								Set dfProgressStatus2 = ''
							Else
								Set dfProgressStatus1 = ''
								Set dfProgressStatus2 = 'Виписки сформовані'
							!
						Call WaitCursorOff()
					! On SAM_Click
						                                                 Call WaitCursorOn()
						!
						                                                 Call SalShowWindow(dfProgressStatus1)
						                                                 Call SalShowWindow(dfProgressStatus2)
						!
						                                                 Set sTmp = cmbDateFrom.GetNameById(cmbDateFrom.GetKey(SalListQuerySelection(cmbDateFrom)))
						                                                 Set dtDateFrom = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                 Set sTmp = cmbDateTo.GetNameById(cmbDateTo.GetKey(SalListQuerySelection(cmbDateTo)))
						                                                 Set dtDateTo = SalDateConstruct(SalStrToNumber( SalStrRightX( sTmp, 4 )),
								 SalStrToNumber( SalStrMidX( sTmp, 3, 2 )),
								 SalStrToNumber(SalStrLeftX( sTmp, 2 )), 0, 0, 0)
						!
						!
						                                                 While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							                                                 Call SalTblSetContext( tblCustomer, nRow )
							! Call Debug(tblCustomer.colSab|| '  выбран')
							                                                 If tblCustomer.checked
								                                                 If SqlPLSQLCommand(hSql(), "bars_xmlklb_ref.post_info_message(dtDateFrom, dtDateTo, tblCustomer.colSab)")
									! Call Debug('Выполнено для '||tblCustomer.colSab||' за '||SalFmtFormatDateTime(dtDates[i],'dd-MM-yyyy'))
									                                                 Call SqlCommit(hSql())
								                                                 Else 
									                                                 Call SalMessageBox('Помилка виконання функції','Увага',MB_Ok|MB_IconExclamation)
									!
						                                                 Call WaitCursorOff()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Вихід
				Window Location and Size
					Left:   4.683"
					Top:    4.226"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Check Box: cbCheckAllClients
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для всіх
				Window Location and Size
					Left:   0.75"
					Top:    0.238"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tblCustomer, nRow, 0, 0)
							Call SalTblSetContext( tblCustomer, nRow )
							Set tblCustomer.checked = cbCheckAllClients
			Group Box: Клієнти
				Resource Id: 18917
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.071"
					Width:  6.667"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Параметри
				Resource Id: 18918
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.717"
					Top:    0.071"
					Width:  2.667"
					Width Editable? Yes
					Height: 4.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 18919
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    4.071"
					Width:  9.4"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Background Text: з
				Resource Id: 18920
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.883"
					Top:    0.679"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbDateFrom
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.083"
					Top:    0.655"
					Width:  2.1"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbDateFrom.Init(hWndItem)
						Call cmbDateFrom.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
								    "(select fdat from fdat)",
								     "ORDER BY fdat DESC")
						Call SalListSetSelect(cmbDateFrom, 0)
					On SAM_AnyEdit
						Set dfProgressStatus1 = ''
						Set dfProgressStatus2 = ''
			Background Text: по
				Resource Id: 18921
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.8"
					Top:    1.036"
					Width:  0.233"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbDateTo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.083"
					Top:    0.988"
					Width:  2.1"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbDateTo.Init(hWndItem)
						Call cmbDateTo.Populate(hSql(), "rownum", "TO_CHAR(fdat,'DD-MM-YYYY')",
								    "(select fdat from fdat)",
								     "ORDER BY fdat DESC")
						Call SalListSetSelect(cmbDateTo, 0)
					On SAM_AnyEdit
						Set dfProgressStatus1 = ''
						Set dfProgressStatus2 = ''
			Background Text: період виписки
				Resource Id: 18922
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.05"
					Top:    0.452"
					Width:  2.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: маска рахунку
				Resource Id: 18923
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.117"
					Top:    1.476"
					Width:  1.567"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfNlsMask
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.083"
						Top:    1.655"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						Set dfProgressStatus1 = ''
						Set dfProgressStatus2 = ''
			Data Field: dfProgressStatus1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    3.512"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfProgressStatus2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    3.738"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.214"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: sSqlSelect
			Number: nRow
			! Number: nCount
			!
			Date/Time: dtDateFrom
			Date/Time: dtDateTo
			String: sTmp
			Date/Time: dtChooseDate
			Number: nChooseCustCnt
			Number: i
			Number: nDatesCnt
			Date/Time: dtDates[*]
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SalHideWindow(dfProgressStatus1)
				Call SalHideWindow(dfProgressStatus2)
				Set dfNlsMask = '*'
				Set nChooseCustCnt = 0
	Dialog Box: uplManualy
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.1"
				Width Editable? Yes
				Height: 2.6"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: ! Выгрузка групп вручную
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pbRun
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.183"
					Top:    0.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sErrCode=''
						!
						If ( cbOnlyOneFile )
							! << Вивантаження одного файлу >>
							If ( dfSelectedFile = STRING_Null )
								Call SalMessageBox('Виберіть файл для вивантаження','Увага!' ,MB_IconAsterisk)
							Else
								Call UploadFile()
						Else
							If sChooseJobName = STRING_Null
								Call SalMessageBox('Виберіть групу вивантаження','Увага!' ,MB_IconAsterisk)
							Else
								Set sErrCode = STRING_Null
								! Проверка на возможность выгрузки
								If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.check_job_status(dfChooseBankDate, sChooseJobName,sErrCode,sErrMsg)")
									If sErrCode != '0000' and sErrCode != STRING_Null
										If sErrCode = '0028' 
											Call SalMessageBox('Вивантаження даних знахоиться в стадії роботи','Увага!' ,MB_IconAsterisk)
											Set nChooseRes = SalMessageBox('Якщо статус поточного вивантаження втановлено помилково можна видалиті дану фнформацію. Видалити? ','' ,MB_IconAsterisk|MB_OkCancel)
											If nChooseRes = IDOK
												Call deleteJobInfo(dfChooseBankDate, sChooseJobName)
										Else
											Call SalMessageBox('Вивантаження даних за дану дату вже було проведено','Увага!' ,MB_IconAsterisk)
											Set nChooseRes = SalMessageBox('Якщо потрібно повторити вивантаження, потрібно видалити попередній статус. Видалити? ','' ,MB_IconAsterisk|MB_OkCancel)
											If nChooseRes = IDOK
												Call deleteJobInfo(dfChooseBankDate, sChooseJobName)
									Else
										!
										If SqlPLSQLCommand(hSql(), 
												   "barsupl.bars_upload_usr.create_interface_job(sChooseJobName,1,0,dfChooseBankDate)")
											Call SqlCommit(hSql())
											Call SalMessageBox('Завдання на вивантаження даних створено успішно','' ,MB_IconAsterisk)
										Else
											Call SqlRollback(hSql())
										!
			Pushbutton: pbFileLog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.183"
					Top:    0.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\REP_JOIN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! Call Sal
						Call SalCreateWindow(uplFileStatistic, uplManualy)
			Data Field: dfChooseBankDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.3"
						Top:    0.98"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.27"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: dd/MM/yyyy
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: за банківську дату:
				Resource Id: 34568
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.35"
					Top:    0.79"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.733"
					Top:    0.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(uplManualy)
			Pushbutton: pbTimer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTimer
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.683"
					Top:    0.155"
					Width:  0.4"
					Width Editable? Class Default
					Height: 0.298"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_TimerFired
						Call RefreshJobInfo()
			Frame
				Resource Id: 34576
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.071"
					Width:  7.8"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Frame
				Resource Id: 14376
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.63"
					Width:  7.8"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			!
			Combo Box: cmbActiveJobs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.3"
					Top:    1.0"
					Width:  4.8"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbActiveJobs.Init( hWndItem )
							Call cmbActiveJobs.Populate(hSql(), 'substr(JOB_NAME,1,50)','substr(DESCRIPT,1,100)', 'V_UPL_ACTIVEJOBS','ORDER BY JOB_NAME' )
							Call cmbActiveJobs.SetSelectById(sDefaultJobName)
							Set sChooseJobName = sDefaultJobName
					On SAM_Click
						Set sChooseJobName = cmbActiveJobs.GetKey( SalListQuerySelection(cmbActiveJobs) )
						Set cbOnlyOneFile = 0
						Call SalSendMsg( cbOnlyOneFile, SAM_Click, 0, 0 )
			Background Text: Група вивантаження
				Resource Id: 14377
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    0.78"
					Width:  3.433"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 20189
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    1.48"
					Width:  7.8"
					Width Editable? Yes
					Height: 0.7"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Check Box: cbOnlyOneFile
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Лише один файл
				Window Location and Size
					Left:   0.3"
					Top:    1.55"
					Width:  4.8"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If (cbOnlyOneFile)
							Call SalEnableWindow( cmbFileList )
							Call SalSendMsg( cmbFileList, SAM_User, 0, 0 )
						Else
							Set dfSelectedFile = STRING_Null
							Set cmbFileList  = STRING_Null
							Call SalDisableWindow( cmbFileList )
			Combo Box: cmbFileList
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.3"
					Top:    1.8"
					Width:  7.4"
					Width Editable? Class Default
					Height: 2.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Set dfSelectedFile = cmbFileList.GetKey( SalListQuerySelection( cmbFileList ) )
					On SAM_User
						! << Ініціалізація списку файлів обраної групи >>
						Call cmbFileList.Init( hWndItem )
						Call cmbFileList.Populate( hSql(), "FILE_CODE", "FILE_NAME", "V_UPL_FILE_GROUPS", " WHERE JOB_NAME = :sChooseJobName ORDER BY FILE_NAME" )
			Data Field: dfSelectedFile
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.3"
						Top:    1.54"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbVERSION
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.183"
					Top:    0.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalMessageBox ( 'Вивантаження даних' || Chr(10) ||
								                                             'Версія: '|| ApdVer || ' від ' || ApdDat,
								                                             'Aboute', MB_Ok )
		Functions
			Function: RefreshJobInfo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRes
				Actions
					If SqlPrepareAndExecute(hSql(), '
							 select bank_date, status_code, start_time, stop_time, current_uploading_file 
							  into :dfLastJobBankDate,:dfLastJobStatus,
							       :dfLastJobStart, :dflastJobStop,:dfLastJobCurrData
							      from barsupl.v_upl_last_job ')
						Call SqlFetchNext(hSql(), nRes)
			Function: deleteJobInfo
				Description:
				Returns
				Parameters
					Date/Time: sBankDate
					String: sJobName
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.delete_jobinfo(sBankDate, sJobName)")
						Call SqlCommit(hSql())
						Call SalMessageBox('Інформацію про статус було виладено. Можливий повторний запуск вивантаження','' ,MB_IconAsterisk)
					Else
						Call SqlRollback(hSql())
			Function: get_OneNumberValue
				Description: ф-я повертає результат виконання переданого запиту в строку nResult
				Returns
					Number:
				Parameters
					String: sSqlText
				Static Variables
				Local variables
					Number: nFetchRes
					Number: nResult
				Actions
					If SqlPrepareAndExecute( hSql(), sSqlText ) And Not SqlFetchNext( hSql(), nFetchRes )
						Set nResult = NUMBER_Null
					Return nResult
			Function: UploadFile
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nSqlid
					String: sBankDate
				Actions
					If ( dfChooseBankDate = DATETIME_Null )
						Call SalMessageBox( 'Вкажіть банківську дату для вивантаження','Увага!' ,MB_IconAsterisk)
					Else
						Call SalWaitCursor( TRUE )
						Set nSqlid = get_OneNumberValue( "select SQL_ID INTO :nResult from V_UPL_FILE_GROUPS where JOB_NAME = :sChooseJobName  And FILE_CODE = :dfSelectedFile " )
						Set sBankDate  = SalFmtFormatDateTime( dfChooseBankDate, 'dd/MM/yyyy' )
						If SqlPLSQLCommand( hSql(), "barsupl.bars_upload_usr.upload_file( dfSelectedFile, nSqlid, sBankDate, STRING_Null )" )
							Call SqlCommit(hSql())
							Call SalMessageBox( 'Вивантаження файлу завершено успішно!', 'Info', MB_IconAsterisk )
						Else
							Call SqlRollback(hSql())
						Call SalWaitCursor( FALSE )
		Window Parameters
		Window Variables
			Date/Time: dBankDate
			String: sErrMsg
			String: sErrCode
			String: sSql
			Number: nChooseRes
			Number: nRow
			String: sChooseJobName
			String: sDefaultJobName
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 'Ручне вивантаження даних' )
				Call SalCenterWindow( hWndForm )
				Set sDefaultJobName = 'DAILY_UPLOAD'
				! Call SetStatusBarsText()
				! Call SetComponentsVisibility()
				!
				Set dBankDate = GetBankDate()
				Set dfChooseBankDate = dBankDate
				!
				Call SqlPrepareAndExecute(hSql(), 
						   "select substr(barsupl.bars_upload_usr.get_param('COPY_TO_DIR'),1,100),
						           substr(barsupl.bars_upload_usr.get_param('FTP_SERVER'),1,100),
						           substr(barsupl.bars_upload_usr.get_param('UPLOAD_OS_DIR'),1,100),
						           substr(barsupl.bars_upload_usr.get_param('ARC_OS_DIR'),1,100)
						      into :dfCopyDir, :dfFTP,  :dfUpldDir    ,:dfArcDir 
						      from dual")
				Call SqlFetchNext(hSql(), nRow)
				!
			On SAM_CreateComplete
				! Call pbTimer.Init(2, 0, TRUE)
				! Call RefreshJobInfo()
				Call SalDisableWindow( cmbFileList )
				Call SalHideWindow( dfSelectedFile )
	Form Window: rsProcess
		Class:
		Property Template:
		Class DLL Name:
		Title: Мониторинг процесса синхронизации
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.35"
				Width Editable? Yes
				Height: 7.357"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.321"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: CAPTURE PROCESS 
				Resource Id: 46274
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.655"
					Width:  7.5"
					Width Editable? Yes
					Height: 2.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Group Box: APPLY PROCESS 
				Resource Id: 46275
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.05"
					Top:    3.071"
					Width:  7.533"
					Width Editable? Yes
					Height: 1.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: APPLY
				Resource Id: 46276
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.483"
					Top:    0.262"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: CAPTURE
				Resource Id: 46277
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.583"
					Top:    0.262"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Option Button: obStartApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.217"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_green.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If NOT obStartApply
							! при отжатии кнопки старт (зеленая) - остановить
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync_utl.manage_apply('STOP')")
								Call applyProcessButton('DISABLED')
								Call refreshData()
							Else
								Call SalMessageBox('Ошибка старта процесса apply', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Option Button: obStartCapture
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.617"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_green.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If NOT obStartCapture
							! при отжатии кнопки старт (зеленая) - остановить
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync_utl.manage_capture('STOP')")
								Call applyProcessButton('DISABLED')
								Call refreshData()
							Else
								Call SalMessageBox('Ошибка старта процесса apply', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Option Button: obStopApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.217"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_red.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If obStopApply
							! при нажатии на кнопку стоп - стартовать
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync_utl.manage_apply('START')")
								Call applyProcessButton('ENABLED')
								Call refreshData()
							Else
								Call SalMessageBox('Ошибка останова процесса apply', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Option Button: obStopCapture
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.617"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_red.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If obStopCapture
							! при нажатии на кнопку стоп - стартовать
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync_utl.manage_capture('START')")
								Call applyProcessButton('ENABLED')
								Call refreshData()
							Else
								Call SalMessageBox('Ошибка останова процесса apply', 'Внимание!', MB_IconAsterisk|MB_Ok)
									Return FALSE
							Call SalWaitCursor(FALSE)
			Data Field: dfCaptureCnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.783"
						Top:    2.262"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbRefresh_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.383"
					Top:    0.071"
					Width:  0.6"
					Width Editable? Class Default
					Height: 0.417"
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call refreshData()
						Call SalWaitCursor(FALSE)
			Pushbutton: pbExit_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.183"
					Top:    0.071"
					Width:  0.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			Data Field: dfRepliesQCnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.783"
						Top:    5.405"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Group Box: Кол-во записей в очередях
				Resource Id: 46278
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    1.738"
					Width:  7.3"
					Width Editable? Yes
					Height: 1.083"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfJob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.483"
						Top:    5.179"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Номер
				Resource Id: 46279
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    5.286"
					Width:  0.733"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfJobNextDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.483"
						Top:    5.69"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: dd-MM-yyyy hh:mm:ss
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: След.время
				Resource Id: 46280
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    5.762"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfJobStatus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.483"
						Top:    5.95"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Ошибок
				Resource Id: 46281
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    5.548"
					Width:  0.833"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfJobFailures
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.483"
						Top:    5.43"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBufferQCNum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    2.536"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBufferQNum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.283"
						Top:    2.536"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBufferQSpill
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.283"
						Top:    2.286"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBufferQCSpill
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    2.286"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: буффер:
				Resource Id: 46282
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    2.583"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: диск:
				Resource Id: 46283
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    2.333"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 46284
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.095"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Frame
				Resource Id: 46285
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.483"
					Top:    0.095"
					Width:  5.1"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Option Button: obJobOnLine
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.583"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_green.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						! Call Debug('PUSH ONLINE'||SalNumberToStrX(obJobOnLine,0))
						! если кнопка включена, значит при ее отжатии хотим выключить
						! If obJobOnLine
						! при отжатии кнопки старт (зеленая) - остановить
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "bars.bars_xmlklb_utl.take_job_offline(1)")
							Call jobProcessButton('DISABLED')
							Call SqlCommit(hSql())
							Call refreshData()
							If NOT obJobOnLine
								Set obJobOffLine = TRUE
						Else
							Call SalMessageBox('Ошибка старта планировщика', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
						!
						!
			Option Button: obJobOffLine
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.583"
					Top:    0.167"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\dot_red.bmp
				Picture Transparent Color: White
				Button Style: Check
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						! при нажатии на кнопку стоп - стартовать
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "bars.bars_xmlklb_utl.take_job_online(1)")
							Call jobProcessButton('ENABLED')
							Call SqlCommit(hSql())
							Call refreshData()
							If obJobOffLine
								Set obJobOffLine = FALSE
						Else
							Call SalMessageBox('Ошибка останова планировщика', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
			Background Text: JOB 
				Resource Id: 46286
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.05"
					Top:    0.286"
					Width:  0.433"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.2"
					Top:    0.167"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call refreshData()
						Call SalWaitCursor(FALSE)
			Pushbutton: pbPurge_AQ_REFSYNC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.9"
					Top:    4.03"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\CANCEL.BMP
				Picture Transparent Color: Magenta
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "barsaq.bars_refsync_utl.purge_refsync_queue(1)")
							Call applyProcessButton('DISABLED')
							Call refreshData()
						Else
							Call SalMessageBox('Ошибка очистки таблиц для очереди refsync', 'Внимание!', MB_IconAsterisk|MB_Ok)
								Return FALSE
						Call SalWaitCursor(FALSE)
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.783"
					Top:    0.17"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			Data Field: dfRepliesQCntExp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.867"
						Top:    5.405"
						Width:  0.62"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: всего
				Resource Id: 46287
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.483"
					Top:    2.107"
					Width:  0.567"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: текущ.
				Resource Id: 46288
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.45"
					Top:    2.107"
					Width:  0.567"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: ждут
				Resource Id: 46289
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.0"
					Top:    5.214"
					Width:  0.567"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: текущие
				Resource Id: 46290
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    5.214"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbPurge_KLBX_REPLIES
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.6"
					Top:    5.31"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\CANCEL.BMP
				Picture Transparent Color: Magenta
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						If SqlPLSQLCommand(hSql(), "bars.bars_xmlklb_utl.purge_jboss_queue(1)")
							Call applyProcessButton('DISABLED')
							Call refreshData()
						Call refreshData()
						Call SalWaitCursor(FALSE)
			Background Text: v$buffere_queue:
				Resource Id: 46291
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.45"
					Top:    1.917"
					Width:  1.533"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Состояние CAPTURE процесса:
				Resource Id: 46292
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    0.94"
					Width:  3.067"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfCaptureStatus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    1.119"
						Width:  6.833"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Время последнего обновления состояния:
				Resource Id: 46293
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    1.44"
					Width:  3.633"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfCaptureLastTime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.15"
						Top:    1.4"
						Width:  2.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Состояние APPLY процесса:
				Resource Id: 46294
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.298"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfApplyStatus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    3.476"
						Width:  6.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: К-во записей в очереди aq_refsync_tbl:
				Resource Id: 46295
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.417"
					Top:    4.107"
					Width:  3.367"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Время последнего обновления состояния:
				Resource Id: 46296
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.881"
					Width:  3.633"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfApplyLastTime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.317"
						Top:    3.75"
						Width:  2.767"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: dd/MM/yyyy hh:mm
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfApplyCnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.3"
						Top:    4.024"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Group Box: JBOSS
				Resource Id: 46297
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    4.738"
					Width:  7.5"
					Width Editable? Yes
					Height: 1.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Pushbutton: pbSaveReport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.65"
					Top:    0.17"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\SAVE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call refreshData()
						Call SalWaitCursor(FALSE)
			Pushbutton: pbHelp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.08"
					Top:    0.17"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: D:\BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call refreshData()
						Call SalWaitCursor(FALSE)
			Group Box: JOB, населяющий aq_klbx_replies
				Resource Id: 46298
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    4.929"
					Width:  3.3"
					Width Editable? Yes
					Height: 1.643"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Background Text: В очереди aq_streams_queue
				Resource Id: 46299
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.617"
					Top:    1.94"
					Width:  2.433"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Очередь ждущая обработки JBOSS
				Resource Id: 46300
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.583"
					Top:    4.905"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Background Text: Статус
				Resource Id: 46301
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.417"
					Top:    6.036"
					Width:  0.867"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: applyProcessButton
				Description:
				Returns
				Parameters
					String: status
				Static Variables
				Local variables
				Actions
					If status = 'ENABLED'
						Call SalHideWindow(obStopApply)
						Call SalShowWindow(obStartApply)
						Set obStartApply = TRUE
					Else
						Call SalHideWindow(obStartApply)
						Call SalShowWindow(obStopApply)
						Set obStopApply = FALSE
			Function: captureProcessButton
				Description:
				Returns
				Parameters
					String: status
				Static Variables
				Local variables
				Actions
					If status = 'ENABLED'
						Call SalHideWindow(obStopCapture)
						Call SalShowWindow(obStartCapture)
						Set obStartCapture = TRUE
						!
					Else
						Call SalHideWindow(obStartCapture)
						Call SalShowWindow(obStopCapture)
						Set obStopCapture = FALSE
			Function: jobProcessButton
				Description:
				Returns
				Parameters
					String: status
				Static Variables
				Local variables
				Actions
					If status = 'ENABLED'
						Call SalHideWindow(obJobOffLine)
						Call SalShowWindow(obJobOnLine)
						! Set obJobOnLine = TRUE
						! Set obJobOffLine = FALSE
						!
					Else
						Call SalHideWindow(obJobOnLine)
						Call SalShowWindow(obJobOffLine)
						! Set obJobOffLine = TRUE
						! Set obJobOnLine = FALSE
			Function: refreshData
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: captureStatus
				Actions
					!
					!
					! ------------------------------------- 
					! -- APPLY PROCESS
					! ------------------------------------- 
					Call SqlPrepareAndExecute(hSql(), 
							     "select status, status_change_time          
							        into :dfApplyStatus, :dfApplyLastTime         
							        from dba_apply where apply_name = 'BARS_APPLY' ")
					Call SqlFetchNext(hSql(), nRow)
					Call applyProcessButton(dfApplyStatus)
					!
					! errors
					! Set sSql = 
							   "select  apply_name, error_creation_time, error_message
							    into :tblApplyErrors.error_time,         
							         :tblApplyErrors.error_message       
							    from dba_apply_error 
							   where apply_name = 'BARS_APPLY'"
					! Call SalTblPopulate(tblApplyErrors, hSql(), sSql, TBL_FillAll )
					!
					! count in queue
					Call SqlPrepareAndExecute(hSql(), "
							select count(*) into :dfApplyCnt
							from barsaq.aq_refsync_tbl")
					Call SqlFetchNext(hSql(), nRow)
					!
					! ------------------------------------- 
					! -- CAPTURE PROCESS
					! ------------------------------------- 
					!
					!
					Call SqlPrepareAndExecute(hSql(), 
							     "select d.status, substr(d.status|| '/'||nvl(s.state,''),1,50), status_change_time
							        into :captureStatus,
							             :dfCaptureStatus,
							             :dfCaptureLastTime
							        from dba_capture d, v$streams_capture s
							       where d.capture_user='BARSAQ'
							         and d.capture_name = s.capture_name(+)
							         and d.capture_name = 'BARS_CAPTURE' ")
					Call SqlFetchNext(hSql(), nRow)
					Call captureProcessButton(captureStatus)
					!
					! dfBufferQNum   dfBufferQSpill
					Call SqlPrepareAndExecute(hSql(), "
							select num_msgs, spill_msgs, cnum_msgs, cspill_msgs
							into :dfBufferQNum, :dfBufferQSpill,:dfBufferQCNum, :dfBufferQCSpill
							from sys.v_$buffered_queues")
					Call SqlFetchNext(hSql(), nRow)
					!
					! count in queue
					Call SqlPrepareAndExecute(hSql(), "
							select count(*) into :dfCaptureCnt
							from barsaq.streams_queue_table")
					Call SqlFetchNext(hSql(), nRow)
					!
					!
					! ------------------------------------- 
					! -- JBOSS
					! ------------------------------------- 
					!
					Call SqlPrepareAndExecute(hSql(), "
							select count(*) into :dfRepliesQCnt
							from bars.aqt_klbx_replies where state = 1")
					Call SqlFetchNext(hSql(), nRow)
					!
					Call SqlPrepareAndExecute(hSql(), "
							select count(*) into :dfRepliesQCntExp
							from bars.aqt_klbx_replies where state <> 1")
					Call SqlFetchNext(hSql(), nRow)
					!
					! ------------------------------------- 
					! -- JOB FOR JBOSS
					! ------------------------------------- 
					!
					Call SqlPLSQLCommand(hSql(), "bars.bars_xmlklb_utl.job_info(dfJob, dfJobStatus, dfJobNextDate, dfJobFailures)")
					If dfJobStatus = 'worked'
						Call jobProcessButton('ENABLED')
					Else
						Call jobProcessButton('DISABLED')
					!
					! ------------------------------------- 
					! --  JBOSS
					! ------------------------------------- 
					!
					! Set sSql = 
							   "select refname, count(*)
							      from xml_syncfiles
							     where datf > trunc(sysdate) and datf <=sysdate
							     group by refname"
					! Call SalTblPopulate( tblUploadedFiles, hSql(), sSql, TBL_FillAll )
					!
					! Call SqlPrepareAndExecute(hSql(), 
							     "select status, status_change_time          
							        into :dfApplyStatus, :dfApplyLastTime         
							        from dba_apply where apply_name = 'BARS_APPLY' ")
					! select refname, count(*)
							from xml_syncfiles
							where datf > trunc(sysdate) and datf <=sysdate
							group by refname
		Window Parameters
		Window Variables
			String: sSql
			Number: nRow
		Message Actions
			On SAM_Create
				If not SqlPrepareAndExecute(hSql(), 'set role DBA')
					Call SalMessageBox('Внимание!','Ошибка при установке роли DBA', MB_IconAsterisk)
				Set obJobOffLine = FALSE
				Set obJobOnLine = TRUE
				Call refreshData()
				Call SalCenterWindow ( hWndForm )
	Table Window: uplFileStatistic
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Статистика вивантаження файлів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.6"
				Width Editable? Class Default
				Height: 6.119"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45224
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45225
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45226
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: id
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						запису
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.75"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: parentid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						ведучого 
						запису
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.817"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: filecode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код 
						файлу
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: filename
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ім'я файлу
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.333"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: status
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Статус
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: bankdate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Банк.дата
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Class Default
				Width:  1.333"
				Width Editable? Class Default
				Format: dd/MM/yyyy
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: rectype
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип запису
						в журналі
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: groupid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип 
						вивант.
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Class Default
				Width:  0.983"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: fileid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						файла
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: starttime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Час 
						старту
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.55"
				Width Editable? Yes
				Format: dd/MM/yy hhhh:mm:ss
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: upltime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Хвилин
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.833"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: rows
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: К-ть 
						строк
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.817"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: errors
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Помилки
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.567"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalCenterWindow( hWndForm )
				! Set fFilterAtStart  = TRUE
				! Set strFilterTblName = 'V_UPL_STATS'
				! Set strPrintFileName = 'V_UPL_STATS'
				Set strSqlPopulate ="
						select id, parent_id, file_name, upl_bankdate, rec_type, 
						       case when group_id in (1,3) then 'перв.' else 'інкр.' end,
						file_id, file_code,start_time,  
						       upl_time_min,status_code,rows_uploaded
						  into  :uplFileStatistic.id,
						        :uplFileStatistic.parentid,
						        :uplFileStatistic.filename,
						        :uplFileStatistic.bankdate,
						        :uplFileStatistic.rectype,
						        :uplFileStatistic.groupid,
						        :uplFileStatistic.fileid,
						        :uplFileStatistic.filecode,
						        :uplFileStatistic.starttime,
						        :uplFileStatistic.upltime,
						        :uplFileStatistic.status,
						        :uplFileStatistic.rows 
						   from barsupl.v_upl_stats order by id desc"
				Call SalSendClassMessage(UM_Create, 0, 0)
	Dialog Box: uplParams
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Параметри системи
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.267"
				Width Editable? Class Default
				Height: 5.476"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: ! Рбота со справоником параметров можуля
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.81"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48950
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  2.5"
						Begin Y:  Class Default
						End X:  2.5"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.75"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.617"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48951
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  4.15"
						Begin Y:  Class Default
						End X:  4.15"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.717"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48952
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  5.267"
						Begin Y:  Class Default
						End X:  5.267"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbRecreateJob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.39"
						Top:    0.043"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: D:\BARS98\RESOURCE\BMP\CREATE.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Перестворити завдання' )
						On SAM_Click
							If Not SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.recreate_daily_job(1)")
								Call SalMessageBox('Перестворення завдання пройшло з помилками','Увага!' ,MB_IconStop)
							Call SalMessageBox('Перестворення завдання пройшло успішно','' ,MB_Ok)
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  12.0"
						Width Editable? Class Default
						Height: 4.44"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: groupName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Група
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.567"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: paramName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код параметру
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.767"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: paramVal
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Значення параметру
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.083"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: paramDesc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис параметру
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                    Call SalSetWindowText(hWndForm, 'параметри системи')
						                                    Call SalCenterWindow( hWndForm )
						                                    Set strSqlPopulate =
								'select param, value, descript
								   into :uploadParams.tbl.paramName,
								        :uploadParams.tbl.paramVal,
								        :uploadParams.tbl.paramDesc
								   from barsupl.upl_params
								  order by param'
						! Call SetStatusBarsText()
						! Call SetComponentsVisibility()
						                                    Call SalSendClassMessage(UM_Create, 0, 0)
		Functions
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbOk)
				Call SalCenterWindow( hWndForm )
				! Set fFilterAtStart  = TRUE
				! Set strFilterTblName = 'V_UPL_STATS'
				! Set strPrintFileName = 'V_UPL_STATS'
				Set strSqlPopulate ="
						select g.group_name, p.param, substr(p.value,1,253), substr(p.descript,1,253)
						  into  :uplParams.tbl.groupName,
						        :uplParams.tbl.paramName,
						        :uplParams.tbl.paramVal,
						        :uplParams.tbl.paramDesc
						   from barsupl.upl_params p, barsupl.upl_param_groups g
						  where p.group_id = g.group_id and nvl(g.issystem,0) = 0
						  order by g.group_id"
				Set strSqlUpdate ="
						update barsupl.upl_params 
						   set value = :uplParams.tbl.paramVal
						 where param = :uplParams.tbl.paramName"
				Call SalSendClassMessage(UM_Create, 0, 0)
	Dialog Box: dlg_MemoEditor
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.975"
				Top:    1.354"
				Width:  11.133"
				Width Editable? Yes
				Height: 5.512"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Multiline Field: mlEditor
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   -0.017"
						Top:    -0.012"
						Width:  11.1"
						Width Editable? Yes
						Height: 5.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 12
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					! On SAM_AnyEdit
						                                 Set fEdited = TRUE
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ok
				Window Location and Size
					Left:   6.633"
					Top:    9.0"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(dlg_MemoEditor, SAM_Close, 0, 0)
		Functions
		Window Parameters
			String: Title
			Receive Long String: sErrorText
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, Title)
				Call PrepareWindowEx(hWndForm)
				Set mlEditor = sErrorText
				! Set fEdited  = FALSE
			On SAM_CreateComplete
				Call SalSetFocus(pb1)
	! cGenericTable: tblJobs_
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Доступні завдання для включення  в автоматичне вивантаження
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:  
				Top:   
				Width:  10.183"
				Width Editable? Yes
				Height: 4.536"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                             Description: 
		                             Named Menus 
		                             Menu 
		                             Tool Bar 
			                             Contents 
				                             Pushbutton: pbIns
					                             Message Actions 
				                             Pushbutton: pbDel
					                             Message Actions 
				                             Pushbutton: pbRefresh
					                             Message Actions 
				                             Pushbutton: pbUpdate
					                             Message Actions 
				                             Line 
				                             Pushbutton: pbSearch
					                             Message Actions 
				                             Pushbutton: pbFilter
					                             Message Actions 
				                             Pushbutton: pbDetails
					                             Message Actions 
				                             Pushbutton: pbPrint
					                             Message Actions 
				                             Line 
				                             Pushbutton: pbExit
					                             Message Actions 
				                             Line 
		                             Contents 
			                             Column: job_name
				                             List Values 
				                             Message Actions 
			                             Column: job_desc
				                             List Values 
				                             Message Actions 
			                             Column: is_active
				                             List Values 
				                             Message Actions 
		                             Functions 
		                             Window Parameters 
			                             Receive String: sChoosenJobName
			                             Receive Boolean: bIsChoosen
		                             Window Variables 
		                             Message Actions 
			                             On SAM_Create
				                             Set strSqlPopulate=
						"select job_name, job_desc, is_active 
						   into :tblJobs.job_name, :tblJobs.job_desc, :tblJobs.is_active
						   from barsupl.upl_autojobs
						  order by job_name"
				                             Set strSqlInsert = ""
				                             Set strSqlUpdate = ""
				                             Set strSqlDelete = ""
				                             Set strPrintFileName = ""
				                             Call SalSendClassMessage(SAM_Create, 0, 0)
			                             On SAM_DoubleClick
				                             Set sChoosenJobName = tblJobs.job_name
				                             Set sIsChoosen = TRUE
				                             Call SalEndDialog(dlg_AllUsers, 0)
	Dialog Box: uplAllEnabledJobs
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Доступні завдання для включення  в автоматичне вивантаження
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57924
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57925
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sChoosenJobName = uplAllEnabledJobs.tbl.job_name
							Set bIsChoosen = TRUE
							Call SalEndDialog(uplAllEnabledJobs, 0)
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57926
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: job_name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва завдання
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.85"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: job_desc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис завдання
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.433"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: is_active
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Активність
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
		Functions
		Window Parameters
			Receive String: sChoosenJobName
			Receive Boolean: bIsChoosen
		Window Variables
		Message Actions
			On SAM_Create
				Set strSqlPopulate=
						"select job_name, descript, is_active  
						   into :uplAllEnabledJobs.tbl.job_name, 
						        :uplAllEnabledJobs.tbl.job_desc, 
						        :uplAllEnabledJobs.tbl.is_active
						   from barsupl.v_upl_all_jobs 
						  where is_exists = 0
						  order by job_name"
				Set strSqlInsert = ""
				Set strSqlUpdate = ""
				Set strSqlDelete = ""
				Set strPrintFileName = ""
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				Call SalSendMsg(pbOk, SAM_Click, 0, 0)
	Table Window: uplJobParValues
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: ! Справочник занчейни параметров для выбранного задания
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63346
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.05"
						Begin Y:  Class Default
						End X:  5.05"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.85"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63347
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.383"
						Begin Y:  Class Default
						End X:  4.383"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.517"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63348
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.4"
						Begin Y:  Class Default
						End X:  2.4"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbRecreateJob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.82"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: D:\BARS98\RESOURCE\BMP\CREATE.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Перестворити завдання' )
						On SAM_Click
							If Not SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.recreate_interface_job(sJobName)")
								Call SalMessageBox('Перестворення завдання пройшло з помилками','Увага!' ,MB_IconStop)
							Call SalMessageBox('Перестворення завдання пройшло успішно','' ,MB_Ok)
		Contents
			Column: param
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Параметр
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.8"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					! On SAM_DoubleClick
						                         Call ChooseParam()
			Column: value
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Значення
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.9"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					! On SAM_DoubleClick
						                         Call ChooseParam()
			Column: descript
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Опис
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  5.433"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: SaveChanges
				Description:
				Returns
					Number:
				Parameters
					Receive String: sErrMsg
				Static Variables
				Local variables
					Number: nRow
				Actions
					If bDeletingMode
						Set nRow = TBL_MinRow
						Call SalTblSetContext ( uplJobParValues, nRow )
						While SalTblFindNextRow (uplJobParValues, nRow, ROW_MarkDeleted, 0 )
							Call SalTblSetContext (uplJobParValues, nRow )
							If not SqlPrepareAndExecute(hSql(),
									   " delete from barsupl.upl_autojob_param_values 
									      where upper(job_name) = upper(:sJobName) 
									        and upper(param) = upper(:uplJobParValues.param) ")
								Set sErrMsg="Ошибка удаления из таблицы upl_autojob_param_values"
								Return -1
					!
					! Inserting
					Else If bInsertingMode
						Set nRow = TBL_MinRow
						Call SalTblSetContext (uplJobParValues, nRow )
						While SalTblFindNextRow (uplJobParValues, nRow, ROW_New, 0 )
							Call SalTblSetContext ( uplJobParValues, nRow )
							If not SqlPrepareAndExecute(hSql(),
									   "insert into barsupl.upl_autojob_param_values(job_name,param, value) 
									    values( upper(:sJobName), :uplJobParValues.param, :uplJobParValues.value)")
								Set sErrMsg='Oшибка вставки в таблицу upl_autojob_param_values'
								Return -1
					! Updating
					Else If bUpdatingMode
						Set nRow = TBL_MinRow
						Call SalTblSetContext (uplJobParValues, nRow )
						While SalTblFindNextRow (uplJobParValues, nRow, ROW_Edited, 0 )
							Call SalTblSetContext ( uplJobParValues, nRow )
							If not SqlPrepareAndExecute(hSql(),
									   "update barsupl.upl_autojob_param_values
									       set value = :uplJobParValues.value
									     where upper(job_name) = upper(:sJobName)
									       and upper(param) = upper(:uplJobParValues.param)")
								Set sErrMsg='Oшибка вставки в таблицу upl_autojob_param_values'
								Return -1
					!
					Call SalWaitCursor(TRUE)
					Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
					Call SalWaitCursor(FALSE)
					Set bDeletingMode=FALSE
					Set bInsertingMode=FALSE
					Return 0
			Function: ChooseParam
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalModalDialog(uplJobParams, uplJobParValues, bChooseResult, sJobParamName, sJobParamDefValue, sJobParamDescript,sJobName)
					If bChooseResult
						Set uplJobParValues.param = sJobParamName
						Set uplJobParValues.value=  sJobParamDefValue
						Set uplJobParValues.descript=sJobParamDescript
		Window Parameters
			String: sJobName
		Window Variables
			Boolean: bChooseResult
			String: sJobParamName
			String: sJobParamDefValue
			String: sJobParamDescript
			Boolean: bInsertingMode
			Boolean: bDeletingMode
			Boolean: bUpdatingMode
			String: sErrMsg
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Параматри для завдання '||sJobName)
				Set strSqlPopulate =
						"select v.param, substr(v.value,1,200) value, p.descript
						   into :uplJobParValues.param, :uplJobParValues.value, :uplJobParValues.descript
						   from barsupl.upl_autojob_param_values v,
						        barsupl.upl_autojob_params       p 
						  where lower(job_name) = lower('"||sJobName||"')"||  
						    " and v.param = p.param"
				Set strSqlInsert = ""
				Set strSqlUpdate = ""
				Set strSqlDelete = ""
				Set strPrintFileName = ""
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Insert
				Set bInsertingMode=1
				Call SalModalDialog(uplJobParams, uplJobParValues, bChooseResult, sJobParamName, sJobParamDefValue, sJobParamDescript,sJobName)
				Call SalSendClassMessage(  UM_Insert, wParam, lParam )
				If bChooseResult
					Set uplJobParValues.param = sJobParamName
					Set uplJobParValues.value=  sJobParamDefValue
					Set uplJobParValues.descript=sJobParamDescript
			On UM_Update
				Set bUpdatingMode = TRUE
				If SaveChanges(sErrMsg)<0
					Call SalMessageBox(sErrMsg,'Внимание!',0)
					Call SqlRollback(hSql())
				Else
					Call SqlCommit(hSql())
			On UM_Delete
				Set bDeletingMode=TRUE
				Call SalSendClassMessage( UM_Delete, wParam, lParam )
	Dialog Box: uplJobParams
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.3"
				Width Editable? Class Default
				Height: 5.75"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: ! Справочник параметров заданий
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63349
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 63350
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bResult = TRUE
							Set sParamName   = uplJobParams.tbl.param
							Set sParamDefValue = uplJobParams.tbl.defval
							Set sParamDescript = uplJobParams.tbl.descript
							Call SalEndDialog(uplJobParams, 0)
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bResult = FALSE
				Line
					Resource Id: 63351
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  12.2"
						Width Editable? Class Default
						Height: 4.774"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: param
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Параметр
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.533"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: defval
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Значення по-замовчув.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.683"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: descript
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call SalSendMsg(pbOk, SAM_Click, 0, 0)
		Functions
		Window Parameters
			Receive Boolean: bResult
			Receive String: sParamName
			Receive String: sParamDefValue
			Receive String: sParamDescript
			String: sChoosenJobName
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, 'Доступні параматри для завдання '||sChoosenJobName)
				Call PrepareWindowEx(hWndForm)
				Set strSqlPopulate =
						"select param, descript, substr(default_val ,1,200) defval
						 into :uplJobParams.tbl.param, :uplJobParams.tbl.descript, :uplJobParams.tbl.defval
						 from barsupl.v_upl_autojob_param_values 
						where lower(job_name) = lower('"||sChoosenJobName||"')  
						  and isdefault = 1" 
				Set strSqlInsert = ""
				Set strSqlUpdate = ""
				Set strSqlDelete = ""
				Set strFilterTblName = ""
				Set strPrintFileName = ""
				Set nFlags = GT_ReadOnly
				Set bResult = FALSE
				Call SalSendClassMessage(UM_Create, 0, 0)
	Table Window: uplFileSingle
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Вивантаження файлів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.6"
				Width Editable? Class Default
				Height: 6.119"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbUpload
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: D:\BARS98\RESOURCE\BMP\RETRIEVE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							! If not SalFmtFormatStrDateTime(strDateTime, strMask)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If uplFileSingle.checked = 1 
									Set uplFileSingle.status = 'Йде вивантаження ...'
									If SqlPLSQLCommand(hSql(), "barsupl.bars_upload_usr.upload_file(uplFileSingle.filecode, uplFileSingle.sqlid, dfUploadDate,' ' )")
										Call SqlCommit(hSql())
										Set uplFileSingle.status = 'Вивантажено'
									Else
										Set uplFileSingle.status = 'Помилка'
							Call SalMessageBox('Вивантаження виконане','', MB_Ok)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39349
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: D:\BARS98\RESOURCE\BMP\SEARCH.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39350
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39351
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Тип вивантаження:
					Resource Id: 39352
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.35"
						Top:    0.143"
						Width:  1.733"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cmbGroups
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   10.183"
						Top:    0.095"
						Width:  3.9"
						Width Editable? Class Default
						Height: 0.571"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Click
							Set nGroupId = cmbGroups.GetKey(SalListQuerySelection( cmbGroups) )
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
						On SAM_Create
							If cmbGroups.Init( hWndItem )
								Call cmbGroups.Populate(hSql(), 'group_id','substr(DESCRIPT,1,100)', 'V_UPL_GROUPS','ORDER BY GROUP_ID' )
								Call cmbGroups.SetSelectById(nGroupId)
				Background Text: Дата вивантаження:
					Resource Id: 39353
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.717"
						Top:    0.143"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dfUploadDate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.617"
							Top:    0.085"
							Width:  1.467"
							Width Editable? Yes
							Height: 0.298"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: file_id
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						файлу
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.933"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: sqlid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						запиту
				Visible? Yes
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: filename
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Префікс
						файлу
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Class Default
				Width:  1.733"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: filedesc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Опис файлу
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  4.35"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: checked
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вибір
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  1.25"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: groupid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: filecode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: status
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Статус
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.65"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_AnyEdit
						Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
		Functions
		Window Parameters
		Window Variables
			Number: nGroupId
			Number: nRow
			Date/Time: dtUploadDate
		Message Actions
			On SAM_Create
				! Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalCenterWindow( hWndForm )
				Set nGroupId = 1
				Set strSqlPopulate ="
						select t.file_id, substr(t.filename_prfx,1,254) filename, 
						       substr(t.descript,1,254) descr,
						       r.group_id, 
						       r.sql_id, t.file_code
						 into  :uplFileSingle.file_id,
						       :uplFileSingle.filename,
						       :uplFileSingle.filedesc,
						       :uplFileSingle.groupid,
						       :uplFileSingle.sqlid,
						       :uplFileSingle.filecode
						  from barsupl.upl_files t, 
						       barsupl.upl_filegroups_rln r
						 where isactive = 1
						   and t.file_id = r.file_id
						   and r.group_id = :nGroupId
						 order by  filename_prfx"
				Call SalSendClassMessage(UM_Create, 0, 0)
	Form Window: uploadMetaData
		Class:
		Property Template:
		Class DLL Name:
		Title: Опис метаданих вивантаження файлів у WH 0.2
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.7"
				Width Editable? Yes
				Height: 7.714"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.583"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Data Field: dfCondition
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.2"
							Top:    0.14"
							Width:  3.0"
							Width Editable? Yes
							Height: 0.3"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_AnyEdit
							Call Get_FileList( dfCondition )
				Background Text: Фільтр:
					Resource Id: 41021
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.2"
						Top:    0.18"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.2"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_Export
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.14"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\saved.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_TooltipSetText
							! экспорт в SQL-сценарий
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Product.pbExport' ) )
						On SAM_Click
							If ( tblFiles.col_ID > 0 )
								Call p_GenScript( )
							Else
								Call SalMessageBox( "Не вибрано файл для вивантаження!", CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
				Pushbutton: pbCancel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.0"
						Top:    0.14"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Завершить
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbCancel' )
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: MainHSplitter
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.183"
						Width Editable? Class Default
						Height: 6.571"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: TopVSplitter
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  13.8"
						Width Editable? Class Default
						Height: 3.083"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? No
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: BottomVSplitter
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    3.321"
						Width:  13.8"
						Width Editable? Class Default
						Height: 4.917"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tblFiles
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    0.083"
						Width:  6.583"
						Width Editable? Yes
						Height: 2.988"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 200
					Discardable? No
				Contents
					Column: col_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ід.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_CODE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва Файлу
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис файлу
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_ACTIVE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Активний
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  0.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_CRITICAL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Крит.
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_PARTITIONED
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Парт.
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.9"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection, TRUE)
					On SAM_RowSetContext
						Call Get_FileColumns( tblFiles.col_ID )
						Call Get_FileQueries( tblFiles.col_ID )
						!
						Set mlQueryText = STRING_Null
						Call SalColorSet ( mlQueryText, COLOR_IndexWindow, COLOR_White )
						Call SalTblSetContext( tblQueries, -1 )
					! On SAM_CreateComplete
						            Call SalTblSetContext( hWndForm, 0 )
			Child Table: tblColumns
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   7.0"
						Top:    0.071"
						Width:  6.983"
						Width Editable? Yes
						Height: 3.083"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: col_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ід.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва поля
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.483"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_DESC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опис поля
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Long String
						Justify: Class Default
						Width:  4.267"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип поля
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.3"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_CreateComplete
						Call SalTblSetContext( hWndForm, 0 )
			Child Table: tblQueries
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    3.333"
						Width:  6.683"
						Width Editable? Yes
						Height: 3.155"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: col_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ід.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва запиту
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.017"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col_VERSION
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Версія
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Center
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_CreateComplete
						Call SalTblSetContext( hWndForm, 0 )
					On SAM_RowSetContext
						Call Get_QueryText( tblQueries.col_ID )
			Multiline Field: mlQueryText
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 32000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   7.183"
						Top:    3.405"
						Width:  6.5"
						Width Editable? Yes
						Height: 2.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
		Functions
			Function: Get_FileList
				Description: Перелік файлів вивантаження
				Returns
				Parameters
					String: sCondition
				Static Variables
				Local variables
				Actions
					Call SalTblPopulate( uploadMetaData.tblFiles, hSql(),
							"SELECT f.file_id, f.file_code, f.descript,  f.isactive, nvl(f.critical_flg,0), f.partitioned
							        INTO :tblFiles.col_ID,  :tblFiles.col_CODE,  :tblFiles.col_NAME,  :tblFiles.col_ACTIVE,  :tblFiles.col_CRITICAL,  :tblFiles.col_PARTITIONED
							      FROM barsupl.UPL_FILES f " || IifS(sCondition != STRING_Null, "WHERE file_code LIKE '" || SalStrUpperX( sCondition ) || "%'", "" ) ||
							" ORDER BY 1", TBL_FillAll )
					Call SalSendMsg( uploadMetaData.tblFiles, SAM_RowSetContext, 0, 0 )
			Function: Get_FileColumns
				Description: Список полів файлу вивантаження
				Returns
				Parameters
					Number: nFileID
				Static Variables
				Local variables
				Actions
					Call SqlSetLongBindDatatype( 3, 22 )
					Call SalTblPopulate( tblColumns, hSql(),
							"SELECT c.COL_ID, c.COL_NAME, c.COL_DESC, c.COL_TYPE
							        INTO :tblColumns.col_ID,  :tblColumns.col_NAME,  :tblColumns.col_DESC,  :tblColumns.col_TYPE
							      FROM barsupl.UPL_COLUMNS c
							  WHERE c.FILE_ID = :nFileID ", TBL_FillAll )
			Function: Get_FileQueries
				Description:
				Returns
				Parameters
					Number: nFileID
				Static Variables
				Local variables
				Actions
					Call SalTblPopulate( tblQueries, hSql(),
							"SELECT UNIQUE s.SQL_ID, s.DESCRIPT, s.VERS 
							        INTO :tblQueries.col_ID,  :tblQueries.col_NAME,  :tblQueries.col_VERSION
							      FROM barsupl.UPL_SQL s
							         JOIN barsupl.UPL_FILEGROUPS_RLN r on (r.sql_id = s.sql_id)
							  WHERE r.file_id = :nFileID ", TBL_FillAll )
			Function: Get_QueryText
				Description:
				Returns
				Parameters
					Number: nSqlID
				Static Variables
				Local variables
					Long String: sText
				Actions
					! Set mlQueryText = GetStringFromClob( hSql(), 'barsupl.UPL_SQL', 'SQL_ID', 'SQL_TEXT', nSqlID, '', '')
					Set mlQueryText = STRING_Null
					Call SqlSetLongBindDatatype( 1, 22 )
					If SqlPrepareAndExecute( hSql(), "SELECT column_value INTO  :sText  
							FROM table (barsupl.upl_utils.clob2str((SELECT s.SQL_TEXT FROM barsupl.UPL_SQL s WHERE s.sql_id = :nSqlID), 2000 ))" )
						Call SalColorSet ( mlQueryText, COLOR_IndexWindow, COLOR_LightGray )
						While SqlFetchNext( hSql(), nFetchRes )
							Set mlQueryText = mlQueryText || sText
					Else
						Call SalColorSet ( mlQueryText, COLOR_IndexWindow, COLOR_None )
			Function: p_GenScript
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					File Handle: hFile
					String: sFileName
					Long String: sText
				Actions
					If SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessExportQuestion' ),
							                                       CurrentLangTable.GetAtomTitle( 'cTAt' ),
							                                       MB_IconQuestion|MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						! Створення файлу
						Set sFileName = GetPrnDir(  ) || '\\upl_' || Str( tblFiles.col_ID ) || '.sql'
						If not SalFileOpen(hFile, sFileName, OF_Create | OF_ReadWrite)
							Call SalWaitCursor(FALSE)
							Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessOpenFileFailed' )||sFileName||"!",
									                                            CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
							Return FALSE
						Else
							If SqlPrepareAndExecute( hSql(), "SELECT  column_value  INTO  :sText  FROM  table ( upl_utils.gen_script4upload( :tblFiles.col_ID ) )" )
								While SqlFetchNext( hSql(), nFetchRes )
									Call SalFileWrite(hFile, sText, Len(sText))
								Call SalFileClose(hFile)
								Call SalWaitCursor(FALSE)
								! Сценарий сохранен в sFileName
								Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessExportDone' )||" "||sFileName,
										                                            CurrentLangTable.GetAtomTitle('cTAt'),
										                                            MB_IconInformation )
								Return TRUE
							Else
								! Помилка експорту даних у сценарій
								Call SalWaitCursor(FALSE)
								Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessCreateFileFailed' ),
										                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),
										                                            MB_IconStop )
								Return FALSE
		Window Parameters
		Window Variables
			Number: nFetchRes
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('tbl_HistChgViddBRID.WindowTitle'))
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				! << Splitter >>
				Call MainHSplitter.setTopFrame( TopVSplitter )
				Call MainHSplitter.setBottomFrame( BottomVSplitter )
				! TopSplitter
				! Call TopVSplitter.setStyle( XSalSplitter_Frame1AbsSize | XSalSplitter_Frame2AbsSize, TRUE)
				Call TopVSplitter.setLeftFrame( tblFiles )
				Call TopVSplitter.setRightFrame( tblColumns )
				! BottomVSplitter
				Call BottomVSplitter.setLeftFrame( tblQueries )
				Call BottomVSplitter.setRightFrame( mlQueryText )
			On SAM_CreateComplete
				! Fill File List
				Call Get_FileList( STRING_Null )
				Call SalWaitCursor( FALSE )
