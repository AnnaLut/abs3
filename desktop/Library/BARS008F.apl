.head 0 +  Application Description: ! BARS008f.APD - Dynalib 
! BARS008f.APL - ДИЛИНГ -  FOREX
! ООО Унити-Барс  ( C )  1996-2001
! Разработчик: Марценюк М.П. СУХОВА

.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000F20000 002C000000030000 0003000000000000 005D020000F8FFFF
0040: FFE2FFFFFF080000 000A000000E50200 00BC010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D01000000075769 6E646F7773
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001E71 3A5C626172733938 5C6C696272617279 5C524547434C4E45
0020: 582E646C6C1E713A 5C6261727339385C 6C6962726172795C 524547434C4E4558
0040: 2E61706300000101 011E713A5C626172 7339385C6C696272 6172795C52454743
0060: 4C4E45582E72756E 1E713A5C62617273 39385C6C69627261 72795C524547434C
0080: 4E45582E646C6C1E 713A5C6261727339 385C6C6962726172 795C524547434C4E
00A0: 45582E6170630000 010101185C424152 5339385C42494E5C 6261727330303866
00C0: 2E617064175C4241 525339385C42494E 5C70726F63617069 2E646C6C175C4241
00E0: 525339385C42494E 5C70726F63617069 2E61706300010101 01001E713A5C6261
0100: 727339385C6C6962 726172795C524547 434C4E45582E646C 6C1E713A5C626172
0120: 7339385C6C696272 6172795C52454743 4C4E45582E617063 0000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Bars010.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: CC_DOC.APD
.head 2 -  Dynalib: BARS013.apd
.head 2 -  Dynalib: BARS017.apd
.head 2 -  !
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Docfun6.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: xsalcpt.apl
.head 2 -  File Include: XSALSPL.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yy
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Number: ###00000
.head 3 -  Number: ###00000
.head 3 -  Number: 00000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Number: #000
.head 3 -  Date/Time: dd.mm.yyyy
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: FXTYPE_TOD     = 'TOD'
.head 4 -  String: FXTYPE_SPLIT   = 'SPLIT'
.head 4 -  String: FXTYPE_SPOT    = 'SPOT'
.head 4 -  String: FXTYPE_FORWARD = 'FORWARD'
.head 4 -  ! 10.08.2015
.head 4 -  String: AppVersion = '25. '
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: fInitLib		! Флаг инициализации библиотеки
.head 3 -  Number: nFetchRes
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hFX1
.head 3 -  Window Handle: hFX2
.head 3 -  Window Handle: hBMOD
.head 2 +  Internal Functions
.head 3 +  Function: Bars008f_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего
для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fInitLib
.head 6 -  Set bStaticsAsWindows = TRUE
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars008f.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  Call CurrentLangTable.AddAtom('cTTicket','Тикет')
.head 7 -  ! ====================================================
.head 7 -  ! FOREX
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTWndTitle','Ввод FOREX-сделок')
.head 7 -  ! field
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cbSwap',   'Сделка Swap')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb_No',    'Только Внебаланс')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb_NoKsA', 'Без поступления на КС')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb2',      'Разбить на 2 суммы')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb_NoKsB', 'Без списания с КС')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb_KS',    'Прямой КС')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cb_SWIFT', 'Автоматическое поступление из платежной системы')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgKVA',    'Валюта  А  - ПОКУПКА')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgTrassaA','Трасса платежа входящего')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgKVB',    'Валюта  Б  - ПРОДАЖА')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgL','Л')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgA','А')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgLimAkt', 'Лим - Акт')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgPartner','Партнер по сделке')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgTrassaB','Трасса платежа исходящего')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgMess',   'Ошибочный код надо исправить или стереть')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgIntermA','Посредник')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.bgIntermB','Посредник')
.head 7 -  ! FOREX Constants
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipSwap',  'Сделка Swap')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipArch',  'Архив FOREX-сделок')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipAcc',   'Просмотр рабочих счетов FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipNetto', 'Неттинг FOREX-сделок')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipOK',    'Сохранить сделку')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipBuch',  'Просмотр Бух.модели сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipTiket', 'Печать тикета')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipPrint2','Дополнительная печать')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipPrintDeal', 'Печать договора')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipAlien', 'Сохранить инф. о партнере')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipClear', 'Сбросить реквизиты сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipFromSWT',   'Сформировать сделку по SWIFT сообщению')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipCreateSWT', 'Сформировать SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipExit',  'Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipPoisk', 'Поиск партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipSearchBICB', 'Поиск банка-участника')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipCreateSWT2', 'Сформировать SWIFT сообщение(без отправки)')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cBTipViewSWT2', 'Просмотреть сформированное SWIFT сообщение')
.head 7 -  ! field strTip
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipNTIK',  '№ тикета')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipDAT',   'Дата сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipResultat','Фин.результат')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKVA',   'Код покупаемой валюты')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipDATA',  'Дата поступления')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSUMA',  'Сумма поступления')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSummCl','Клиентская составляющая суммы')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipBICKA', 'BIC нашего банка-корреспонд')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSSLA',  'Счет VOSTRO у нашего банка-корреспонд')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipNBKA',  'Наименование счета для входа вал-A')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSSA',   'Счет для входа вал-A')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKOD_NA','Код назнач.для 1_ПБ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKVB',   'Код продаваемой валюты')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipDATB',  'Дата отправки')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSUMB',  'Общ.Сумма отправки')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipBICB',  'BIC партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipMFOB',  'МФО партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKOD_BB','Код 1-ПБ партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipRNKB',  'РНК партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipOKPOB', 'ОКПО партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipNLSB',  'Счет у партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKOD_GB','Гос.партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipBICKB', 'BIC банка-корреспонд партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipSSB',   'Счет VOSTRO партнера у его банка-корреспонд')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipKOD_NB','Код назнач.для 1_ПБ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipAgrNum', 'Номер ген.соглашения')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipAgrDate','Дата ген.соглашения')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cFTipAltPartyB','Альтернативный формат исходящей трассы')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrKVA',  'ВАЛ-А')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrDATA', 'ДАТ-А')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSUMA', 'Сум-А')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrLoro', 'Лоро ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSSA',  'Корсчет-А ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErr1PB',  '1_ПБ ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrKVB',  'ВАЛ-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrDATB', 'Дат-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSUMB', 'Сум-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSUMB1','Сум-Б-1')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSUMB2','Сум-Б-2')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrKOD_BB','Код банка для 1-ПБ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrOKPOB', 'Код ОКПО-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrNLSB',  'Контр.разряд')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrKOD_GB','Код госуд для 1-ПБ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrD',     'Не заполнен реквизит SWIFT "Опция D"!')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrDSave', 'Сохранить сделку?')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrRezid','Неизвестна резидентность партнера, сохранение невозможно!')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrAccSpotForward','Неизвестны счета для оплаты! Не заполнен справочник счетов Spot/Forward.')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErrSwap', 'Запрещена сделка Swap')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTMess1','Заполнены НЕ ВСЕ ОБЯЗАТЕЛЬНЫЕ реквизиты, сохранение невозможно')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTMess2','Сделка СОХРАНЕНА - с REF=')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTMess3','Сделка НЕ сохранена!')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTMessPoisk1','Исчерпан лимит по контрагенту!')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTMessPoisk2','Разбить на две суммы?')
.head 7 -  ! nazn text
.head 7 -  ! Call CurrentLangTable.AddAtom('FOREX.cTNazn11','Угода з')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNaznSpot','СПОТ')
.head 7 -  ! Call CurrentLangTable.AddAtom('FOREX.cTNazn12',' від ')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNazn21','Купівля вал у')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNazn22','Продаж вал')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNazn23','Конверсія вал з')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNazn24','FOREX угода від')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNaznDsw','ДЕПО СВОП з')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTNaznSwap','Валютний своп з')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTErr',  'Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTAt',   'В Н И М А Н И Е !')
.head 7 -  Call CurrentLangTable.AddAtom('FOREX.cTArch','Архив')
.head 7 -  ! ====================================================
.head 7 -  ! FX1
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cTWndTitle','АРХИВ FOREX-Сделок')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('FX1.FX_D','Ид~FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.DAT', 'Дата~FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.NTIK','№~тикета')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.REFD', 'Реф~осн-1')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.REF', 'Реф~осн')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.KVA', 'Вал А~покупка')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.DATA','Дата~А')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMA','Сумма  А')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMC','Сумма, купленная для клиента')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.REFA','Реф~А')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.KVB', 'Вал Б~продажа')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.DATB','Дата~Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMB','Сумма Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMPF','Сумма сбора в ПФ')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.REFB','Реф-1~Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.REFB2','Реф-2~Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.KODB', 'BIC / МФО~партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.NBB',  'Наименование~партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMPA','Форвард~Сума переоцiнки~вал А')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMPB','Форвард~Сума переоцiнки~вал Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.SUMP', 'Форвард~Доходи(+)витрати(-)~вiд переоцiнки')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipSwap', 'Сделка Swap')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipTerm', 'Изменение срока')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipPrintDeal', 'Печать договора')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipDel','Подготовить сделку CANCEL')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipDetails','Документы по сделке')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipA',  'Просмотр Документа на вал-А')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipF',  'Просмотр Документа на FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipBuch','Просмотр Бух.модели сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipB',   'Просмотр Документа-1 на вал-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipB2',  'Просмотр Документа-2 на вал-Б')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipPrint2','Печать тикета')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipCreateSWT', 'Сформировать SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipILinkSWT',  'Привязать входящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipIUnLinkSWT','Отвязать входящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipIViewSWT',  'Просмотреть входящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipOLinkSWT',  'Привязать исходящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipOUnLinkSWT','Отвязать исходящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipOViewSWT',  'Просмотреть исходящее SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipCreateSWT2', 'Сформировать SWIFT сообщение(без отправки)')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cBTipEdit', 'Изменение параметров сделки')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cTMsgCreateSWT','Сформировано SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cTMsgLinkSWT',  'Привязано SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cTMsgUnLinkSWT','Отвязано SWIFT сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('FX1.cTMsgNotSWT','Нет прикрепленного SWIFT сообщения')
.head 7 -  ! ====================================================
.head 7 -  ! FX2
.head 7 -  Call CurrentLangTable.AddAtom('FX2.cTWndTitle','Расчет неттинга незавизированных FOREX сделок')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('FX2.KODB','BIC / МФО~партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.KV',  'Вал~платежа')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.SUMA','Ож.Сумма~поступлений')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.SUMB','Ож.Сумма~отправок')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.KOL', 'Кол-во~сжатых')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.DATP','Дата~валютирования')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.FX_D','Ид~FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.NTIK','№~тикета')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.REFA','Реф~поступл')
.head 7 -  Call CurrentLangTable.AddAtom('FX2.REFB','Реф~отправки')
.head 7 -  ! FX2 Constants
.head 7 -  Call CurrentLangTable.AddAtom('FX2.cBTipSumm','Свернуть/Развернуть суммы')
.head 7 -  ! ====================================================
.head 7 -  ! FXUPD
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cTWndTitle','Изменение параметров сделки FOREX')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.bgIntermA', 'Посредник')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.bgIntermB', 'Посредник')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.bgTrassaA', 'Трасса платежа входящего')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.bgTrassaB', 'Трасса платежа исходящего')
.head 7 -  ! ToolTips
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipDEALTAG', 'Идентификатор сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipDAT',  'Дата сделки')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipKVA',  'Код покупаемой валюты')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipDATA', 'Дата поступления')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipSUMA', 'Сумма поступления')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipBICKA','BIC нашего банка-корреспонд')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipSSLA', 'Счет для входа вал-A')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipNBKA', 'Наименование счета для входа вал-A')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipKVB',  'Код продаваемой валюты')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipDATB', 'Дата отправки')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipSUMB', 'Общ.Сумма отправки')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipBICB', 'BIC партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipBICKB','BIC банка-корреспонд партнера')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipSSLB', 'Счет VOSTRO партнера у его банка-корреспонд')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cFTipAltPartyB', 'Альтернативный ввод трассы')
.head 7 -  !
.head 7 -  ! buttons
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cBTipSearchBICB', 'Поиск банка-участника')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cBTipExit', 'Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cBTipSave', 'Сохранить изменения')
.head 7 -  ! messages
.head 7 -  Call CurrentLangTable.AddAtom('FXUPD.cTMsgErrLoro', 'Не зарегистрирован счет ')
.head 7 -  ! ====================================================
.head 7 -  ! BMOD
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.cTWndTitle','Бухгалтерская модель  сделки')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.REF', 'Реф')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.FDAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.TT',  'Оп')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.NLS', 'Лиц.счет')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.KV',  'Вал')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.SD',  'Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.SK',  'Кредит')
.head 7 -  ! Call CurrentLangTable.AddAtom('BMOD.SOS','Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('BMOD.TXT', 'Наименование сч')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MSG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MSG.cTWndTitle','Реквизиты введены')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MSG.tbgSave','Сохранить сделку с назначением')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MSG.pbOk',   'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MSG.pbClose','Отменить')
.head 6 -  !
.head 6 -  Set fInitLib = TRUE
.head 5 -  Return fInitLib
.head 3 +  Function: Sel008f	! __exported
.head 4 -  Description: Bars008f_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call Ini008()
.head 5 -  Call Bars008f_Init()
.head 5 +  Select Case nMode
.head 6 +  Case 10
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(FOREX, hWndParent, strPar01)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( FOREX )
.head 7 -  Break
.head 6 +  Case 11
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(FX1, hWndParent, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( FX1 )
.head 7 -  Break
.head 6 -  ! FX2
.head 6 +  Case 12
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2 = SalCreateWindow( FX2, hWndParent,nMode,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( FX2 )
.head 7 -  Break
.head 6 -  ! бух модель сделки - общее для МБ, FOREX, ЦБ 
.head 6 +  Case 13
.head 7 +  If not IsWindow(hBMOD)
.head 8 -  ! Call DebugN(nPar)
.head 8 -  Set hBMOD = SalCreateWindow(BMOD, hWndParent, Val(strPar01), nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hBMOD)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 3 +  ! Function: F_PRINT
.head 4 -                      Description: 
.head 4 -                      Returns 
.head 4 +                      Parameters 
.head 5 -                      String: sTmp
.head 5 -                      Number: nRef
.head 5 -                      Number: nRefD
.head 5 -                      Number: nRef1
.head 5 -                      Number: nRef2
.head 5 -                      Number: nRef22
.head 5 -                      Number: nRefA_SPTOD
.head 5 -                      Number: nRefB_SPTOD
.head 5 -                      Number: nRefB2_SPTOD
.head 4 -                      Static Variables 
.head 4 +                      Local variables 
.head 5 -                      String: strReport
.head 5 -                      String: strTempl
.head 4 +                      Actions 
.head 5 -  ! ---------------     Печатаем тикет            -----------------
.head 5 -  ! Call Debug('2='||sTmp)
.head 5 -                      Set strReport=GetPrnDir()||'\\FX'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || SalNumberToStrX(SalDateDay(SalDateCurrent()), 0), 2)
.head 5 -                      Set strTempl=GetTemplateDir()||'\\tc_fx.qrd'
.head 5 -                      Call DosReport (strTempl,  strReport,
'ONd~ONt~ODate~OTime~OVdatB~OVdatS~OCurrB~OCurrS~OSummB~OSummS~KURSB~ORate~'||
'OContra~NBKA~NBKB~NBA~NLSA~NLSB~KODA~KODB~OKPA~OKPB', sTmp, 0)
.head 5 -                      Call DocsSaldoPrint(nRef, strReport)
.head 5 +                      If nRefD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefD, strReport)
.head 5 +                      If nRef1  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef1, strReport)
.head 5 +                      If nRef2  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef2, strReport)
.head 5 +                      If nRef22 != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef22, strReport)
.head 5 +                      If nRefA_SPTOD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefA_SPTOD, strReport)
.head 5 +                      If nRefB_SPTOD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefB_SPTOD, strReport)
.head 5 +                      If nRefB2_SPTOD != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefB2_SPTOD, strReport)
.head 5 -                      Call DosDirectPrint(strReport)
.head 3 +  Function: F_PRINT
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nDealTag
.head 5 -  String: sTmp
.head 5 -  ! Number: nRefD
.head 5 -  ! Number: nRef1
.head 5 -  ! Number: nRef2
.head 5 -  ! Number: nRef22
.head 5 -  ! Number: nRefA_SPTOD
.head 5 -  ! Number: nRefB_SPTOD
.head 5 -  ! Number: nRefB2_SPTOD
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strReport
.head 5 -  String: strTempl
.head 5 -  Number: nRef
.head 4 +  Actions
.head 5 -  ! ---------------     Печатаем тикет            -----------------
.head 5 -  ! Call Debug('2='||sTmp)
.head 5 -  Set strReport=GetPrnDir()||'\\FX'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || SalNumberToStrX(SalDateDay(SalDateCurrent()), 0), 2)
.head 5 -  Set strTempl=GetTemplateDir()||'\\tc_fx.qrd'
.head 5 -  Call DosReport (strTempl,  strReport,
'ONd~ONt~ODate~OTime~OVdatB~OVdatS~OCurrB~OCurrS~OSummB~OSummS~KURSB~ORate~'||
'OContra~NBKA~NBKB~NBA~NLSA~NLSB~KODA~KODB~OKPA~OKPB', sTmp, 0)
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select ref into :nRef from fx_deal_ref where deal_tag = :nDealTag order by ref")
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call DocsSaldoPrint(nRef, strReport)
.head 5 +  ! If nRefD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefD, strReport)
.head 5 +  ! If nRef1  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef1, strReport)
.head 5 +  ! If nRef2  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef2, strReport)
.head 5 +  ! If nRef22 != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRef22, strReport)
.head 5 +  ! If nRefA_SPTOD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefA_SPTOD, strReport)
.head 5 +  ! If nRefB_SPTOD  != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefB_SPTOD, strReport)
.head 5 +  ! If nRefB2_SPTOD != NUMBER_Null
.head 6 -                      Call DocsSaldoPrint(nRefB2_SPTOD, strReport)
.head 5 -  Call DosDirectPrint(strReport)
.head 3 +  Function: F_dlg_TELEX   ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: ND 
.head 5 -  Number: nIns !!! = 1 FOREX  = 2 MBK 
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalModalDialog( dlg_TELEX, hWndForm, ND,  nIns )
.head 3 +  Function: PrintDeal
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTemplateId
.head 5 -  Long String: sDoc
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  : cCnc2
.head 6 -  Class: cABSConnect
.head 4 +  Actions
.head 5 +  If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
" ID LIKE 'FOREX%' ", sTemplateId )
.head 6 -  Return 0
.head 5 +  If sTemplateId
.head 6 -  Call XConnectGetParams( cCnc )
.head 6 +  If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
.head 7 -  Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nId, 0)
.head 7 +  If sDoc
.head 8 -  Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
.head 7 -  Call cCnc.Disconnect()
.head 7 -  Call cCnc2.Disconnect()
.head 3 +  Function: GetForexType
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: DAT
.head 5 -  Date/Time: DATA
.head 5 -  Date/Time: DATB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sForexType
.head 5 -  Number: n980
.head 5 -  Date/Time: dTmpDat
.head 4 +  Actions
.head 5 -  Set n980 = GetBaseVal()
.head 5 -  Set dTmpDat = CorrectDate(n980, DAT+1, DAT+2)
.head 5 -  Set dTmpDat = CorrectDate(n980, dTmpDat+1, dTmpDat+2)
.head 5 +  If DAT = DATETIME_Null or DATA = DATETIME_Null or DATB = DATETIME_Null
.head 6 -  Return STRING_Null 
.head 5 -  ! == 1 - TOD - день в день
.head 5 +  If DAT = DATA and DAT = DATB
.head 6 -  Set sForexType = FXTYPE_TOD
.head 5 -  ! == 1a - SPLIT
.head 5 +  Else If DAT = DATA and DATB > DAT
 or DAT = DATB and DATA > DAT
.head 6 -  Set sForexType = FXTYPE_SPLIT
.head 5 -  ! == 2 - SPOT
.head 5 +  Else If DAT < DATA and DATA <= dTmpDat
and DAT < DATB and DATB <= dTmpDat
.head 6 -  Set sForexType = FXTYPE_SPOT
.head 5 -  ! == 3 - FORWARD
.head 5 +  Else
.head 6 -  Set sForexType = FXTYPE_FORWARD
.head 5 -  Return sForexType
.head 3 +  Function: GetForexTypeParam
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: nRetRnk
.head 5 -  Receive String: sRetForexType
.head 5 -  Receive Number: nRetKvA
.head 5 -  Receive Number: nRetKvB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRnk
.head 5 -  String: sForexType
.head 5 -  Number: nKvA
.head 5 -  Number: nKvB
.head 4 +  Actions
.head 5 +  If SalModalDialog(dlgFreeAcc, hWndForm, nRnk, sForexType, nKvA, nKvB)
.head 6 -  Set nRetRnk = nRnk
.head 6 -  Set sRetForexType = sForexType
.head 6 -  Set nRetKvA = nKvA
.head 6 -  Set nRetKvB = nKvB
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  ! Function: Ini008
.head 4 -                                                                                                                                                                                Description: инициализация библиотеки
.head 4 +                                                                                                                                                                                Returns 
.head 5 -                                                                                                                                                                                Boolean: 
.head 4 -                                                                                                                                                                                Parameters 
.head 4 -                                                                                                                                                                                Static Variables 
.head 4 +                                                                                                                                                                                Local variables 
.head 5 -                                                                                                                                                                                String: strPathToLangResources
.head 5 -                                                                                                                                                                                String: strLangId
.head 5 -                                                                                                                                                                                String: strFileName
.head 4 +                                                                                                                                                                                Actions 
.head 5 +                                                                                                                                                                                If not bApdInited
.head 6 -                                                                                                                                                                                Set strPathToLangResources = GetLangPath()
.head 6 -                                                                                                                                                                                Set strLangId = GetLang()
.head 6 -                                                                                                                                                                                Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars008.lng"
.head 6 +                                                                                                                                                                                If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -                                                                                                                                                                                Call CurrentLangTable.Init()
.head 6 -                                                                                                                                                                                Call DocWisInit( 'CB_VVOD1' )
.head 6 -                                                                                                                                                                                Set bApdInited = TRUE
.head 5 -                                                                                                                                                                                Return bApdInited
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 3 +  Functional Class: cDepoSwap
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nSwapTag
.head 5 -  String: sNTic
.head 5 -  Number: nKvA
.head 5 -  Number: nSumA
.head 5 -  Number: nKvB
.head 5 -  Number: nSumB
.head 5 -  String: sNbB
.head 5 -  String: sMfoB
.head 5 -  String: sBicB
.head 5 -  String: sInic
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbFilter
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Form Window: FOREX
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод FOREX-сделок
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.813"
.head 4 -  Top:    1.948"
.head 4 -  Width:  11.417"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.381"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: System Text Color
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.45"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_Arch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Архив FOREX-сделок
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipArch')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hFX1)
.head 8 -  Set hFX1 = SalCreateWindow(FX1, hWndMDI, 'dat>=gl.bd or dat_a>=gl.bd or dat_b>=gl.bd')
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hFX1)
.head 4 +  Pushbutton: pb_Acc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр рабочих счетов FOREX
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipAcc')
.head 6 +  On SAM_Click
.head 7 -  Call ShowAccF(hWndMDI, sACC)
.head 4 +  Pushbutton: pb_Netto
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.1"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Summ.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Неттинг FOREX-сделок
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipNetto')
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(FX2, hWndMDI, 12, 0, '', '')
.head 7 +  If not IsWindow(hFX2)
.head 8 -  Set hFX2 = SalCreateWindow(FX2, hWndMDI, 12, 0, '', '')
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hFX2)
.head 4 +  Combo Box: cmb_INIC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.12"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.738"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Инициатор сделки' )
.head 6 +  On SAM_Click
.head 7 -  Set sInic = cmb_INIC.GetKey(  SalListQuerySelection(hWndItem))
.head 4 +  Pushbutton: pb_OK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.15"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить сделку
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipOK')
.head 6 +  On SAM_Click
.head 7 +  If not checkInputParams(sErrText, hErrWnd)
.head 8 -  ! Заполнены НЕ ВСЕ ОБЯЗАТЕЛЬНЫЕ реквизиты, сохранение невозможно
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTMess1') || PutCrLf() || '<' || sErrText || '>',
     CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconStop)
.head 8 +  If hErrWnd != hWndNULL
.head 9 -  Call SalSetFocus(hErrWnd)
.head 7 +  Else
.head 8 -  ! Проверка Swap
.head 8 +  If bSwap and nSwapTag != NUMBER_Null
.head 9 -  Call SqlPrepareAndExecute(hSql(), "select count(*) into :nSwapCount from fx_deal where swap_tag = :nSwapTag")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  !
.head 9 +  If nSwapCount > 1
.head 10 +  If SalMessageBox('Змінити термін угоди СВОП?', CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconQuestion | MB_YesNo) = IDNO
.head 11 -  Return FALSE
.head 10 -  ! Запрещена сделка Swap
.head 10 -  ! Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSwap'),
     CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconStop)
.head 10 -  ! Return FALSE
.head 8 -  ! Swift
.head 8 +  If strUseSwift = '1' AND SalIsNull(dfB57A) AND (SalIsNull(BICKB) OR SalIsNull(SSB))
.head 9 -  ! Не заполнен реквизит SWIFT "Опция D"! Сохранить сделку?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrD') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('FOREX.cTErrDSave'), 
   CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconExclamation | MB_YesNo) = IDNO
.head 10 -  Call SalSetFocus(dfB57A)
.head 10 -  Return TRUE
.head 8 -  ! Для 643 поле 58D
.head 8 +  If b643
.head 9 +  If not SalModalDialog(dlg_MSG, hWndForm, s58D, 'Підтвердіть поле 58D')
.head 10 -  Return TRUE
.head 8 -  ! Назначение платежа
.head 8 -  Set sNazn = ''
.head 8 -  ! SWAP
.head 8 -  ! СПОТ
.head 8 +  If sFOREXType = FXTYPE_SPOT
.head 9 -  Set sNazn = sNazn || CurrentLangTable.GetAtomTitle('FOREX.cTNaznSpot') || ' '
.head 8 -  ! Купівля вал у / Продаж вал / Конверсія вал з / з
.head 8 -  Set sNazn = sNazn ||
    IifS(bSwap=TRUE and sDealType='DSW',  CurrentLangTable.GetAtomTitle('FOREX.cTNaznDsw'),
    IifS(bSwap=TRUE and sDealType='SWAP', CurrentLangTable.GetAtomTitle('FOREX.cTNaznSwap'),
    IifS(KVB=n980, CurrentLangTable.GetAtomTitle('FOREX.cTNazn21'),
    IifS(KVA=n980, CurrentLangTable.GetAtomTitle('FOREX.cTNazn22'), 
                   CurrentLangTable.GetAtomTitle('FOREX.cTNazn23'))))) || ' '
.head 8 -  ! NBB KVA/KVB тикет NTIK FOREX угода від DAT TXT
.head 8 -  Set sNazn = sNazn || NBB || ' ' || Str(KVA) || '/' || Str(KVB) || ' ' || 
    CurrentLangTable.GetAtomTitle('cTTicket') || ' ' || NTIK || ' ' ||
    CurrentLangTable.GetAtomTitle('FOREX.cTNazn24') || ' ' || SalFmtFormatDateTime(DAT,'dd/MM/yyyy') || TXT
.head 8 +  If SalModalDialog(dlg_MSG, hWndForm, sNazn, CurrentLangTable.GetAtomTitle('dlg_MSG.tbgSave'))
.head 9 +  If F_SAVE()
.head 10 -  ! Сделка СОХРАНЕНА - с REF=nRefD nRef nRef1 nRef
.head 10 -  ! Call MessageNoWait(CurrentLangTable.GetAtomTitle('FOREX.cTMess2') || ' ' || sRef_All, '', 2, 0)
.head 10 -  Call MessageNoWait('Угоду ЗБЕРЕЖЕНО', '', 2, 0)
.head 10 -  ! не печатать документы после ввода 1-й ноги СВОП
.head 10 -  If (sDealType = 'SWAP' or sDealType = 'DSW') and nSwapTag = nDealTag and GetGlobalOptionEx('FX_SWAP_NOPRINT')=1
.head 10 +  Else
.head 11 -  Call SalSendMsg(pb_Tiket, SAM_Click, 0, 0)
.head 10 +  If bSwap
.head 11 -  ! Ввели первую сделку, надо ввести вторую
.head 11 +  If nSwapTag = nDealTag
.head 12 -  Set cSwap.nSwapTag = nSwapTag
.head 12 -  Set cSwap.sNTic = NTIK
.head 12 -  Set cSwap.nKvA  = KVB
.head 12 -  Set cSwap.nSumA = SUMB * SalNumberPower(10,nDigB)
.head 12 -  Set cSwap.nKvB  = KVA
.head 12 -  Set cSwap.nSumB = SUMA * SalNumberPower(10,nDigA)
.head 12 -  Set cSwap.sNbB  = NBB
.head 12 -  Set cSwap.sMfoB = MFOB
.head 12 -  Set cSwap.sBicB = BICB
.head 12 -  Set cSwap.sInic = sInic
.head 12 -  Set nForexDealMode = 2
.head 12 -  Call SalMessageBox('Введіть другу угоду СВОП !', 'Інформація', MB_IconAsterisk | MB_Ok)
.head 12 -  Call F_SWAP(cSwap)
.head 12 -  Call SalSetFocus(DATA)
.head 11 -  ! Ввели вторую сделку, забываем обо всем
.head 11 +  Else
.head 12 +  If sDealType = 'DSW'
.head 13 -  ! размечаем календарь
.head 13 +  If nForexDealMode = 2
.head 14 -  Call FunNSIEditFFiltered("V_FX_SWAP[NSIFUNCTION]" ||
     "[PROC=>forex.proc_swap(0, " || Str(nDealTag) || ",:BASEY_A,:RATE_A,:BASEY_B,:RATE_B)]" ||
     "[PAR=>:BASEY_A(SEM=% база по вал.-" || Str(KVA) || ",TYPE=N,REF=BASEY),:RATE_A(SEM=% ставка по вал.-" || Str(KVA) || ",TYPE=N)," ||
           ":BASEY_B(SEM=% база по вал.-" || Str(KVB) || ",TYPE=N,REF=BASEY),:RATE_B(SEM=% ставка по вал.-" || Str(KVB) || ",TYPE=N)]" ||
     "[EXEC=>BEFORE]", 6, "deal_tag=" || Str(nDealTag))
.head 13 +  Else If nForexDealMode = 4
.head 14 -  Call FunNSIEditFFiltered("V_FX_SWAP[NSIFUNCTION]" ||
     "[PROC=>forex.proc_swap(4, " || Str(nDealTag) || ",NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null)]" ||
     "[EXEC=>BEFORE]", 6, "deal_tag=" || Str(nDealTag))
.head 12 -  Call f_ClearSwap()
.head 9 +  Else
.head 10 -  Call SalMessageBeep(MB_IconStop)
.head 10 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('FOREX.cTMess3'), '', 2, 1)
.head 4 +  Pushbutton: pb_Buch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр Бух.модели сделки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipBuch')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hBMOD)
.head 8 -  ! Set hBMOD = SalCreateWindow(BMOD, hWndMDI, nRef, nRef1, nRef2, nRef22, nRefD, nRefA_SPTOD, nRefB_SPTOD, nRefB2_SPTOD)
.head 8 -  Set hBMOD = SalCreateWindow(BMOD, hWndMDI, 1, nDealTag)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hBMOD)
.head 4 +  Pushbutton: pb_Tiket
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.05"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать тикета
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipTiket')
.head 6 +  On SAM_Click
.head 7 -  Set sTmp = Str(nRef) || '~' || NTIK ||'~'
.head 7 -  Set sTmp = sTmp || SalFmtFormatDateTime(DAT,'dd/MM/yyyy') ||'~'
.head 7 -  If SqlPrepareAndExecute(hSqlAux2(), 
"SELECT pdat INTO :TIME FROM oper WHERE ref=:nRef") 
and  SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 7 -  Set sTmp = sTmp || SalFmtFormatDateTime(TIME,'hhh:mm:ss')  || '~'
.head 7 -  Set sTmp = sTmp || SalFmtFormatDateTime(DATA,'dd/MM/yyyy') || '~'
.head 7 -  Set sTmp = sTmp || SalFmtFormatDateTime(DATB,'dd/MM/yyyy') || '~'
.head 7 -  Set sTmp = sTmp || Str(KVA) || '~' || Str (KVB) || '~'
.head 7 -  Set sTmp = sTmp || SalNumberToStrX(SUMA,2)  || '~' || SalNumberToStrX(SUMB,2)  || '~'
.head 7 -  Set sTmp = sTmp || SalNumberToStrX(KURSA,8) || '~' || SalNumberToStrX(KURSB,8) || '~'
.head 7 -  Set sTmp = sTmp || Subs(NBB,1,32)  || '~' || Subs(NBKA,1,32) || '~' 
.head 7 -  Set sTmp = sTmp || Subs(NBKB,1,32) || '~' || Subs(NBA,1,32) || '~'
.head 7 -  Set sTmp = sTmp || NLSA || '~' || IifS(KVB=n980, NLSB, '') || '~' 
.head 7 -  Set sTmp = sTmp || IifS(KVA=n980, MFOA, BICA) || '~'
.head 7 -  Set sTmp = sTmp || IifS(KVB=n980, MFOB, BICB) || '~' || OKPOA || '~' || OKPOB
.head 7 -  Call F_PRINT(nDealTag, sTmp)
.head 7 +  If NOT nParamNoPrintMO
.head 8 +  If nRef2 != NUMBER_Null
.head 9 -  Call DocsPrint(nRef2, 'OPER',0)
.head 8 +  If cb2 and SUMB2 > 0 and nRef22 != NUMBER_Null
.head 9 -  Call DocsPrint(nRef22, 'OPER',0)
.head 4 +  Pushbutton: pb_Print2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Edit.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Дополнительная печать
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipPrint2')
.head 6 +  On SAM_Click
.head 7 +  If nRef != NUMBER_Null
.head 8 -  Call DocsPrint(nRef, 'OPER',0)
.head 7 +  If nRef1 != NUMBER_Null
.head 8 -  Call DocsPrint(nRef1, 'OPER',0)
.head 7 +  If nRef2 != NUMBER_Null
.head 8 -  Call DocsPrint(nRef2, 'OPER',0)
.head 7 +  If nRef22 != NUMBER_Null
.head 8 -  Call DocsPrint(nRef22, 'OPER',0)
.head 4 +  Pushbutton: pbPrintDeal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.95"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipPrintDeal')
.head 6 +  On SAM_Click
.head 7 -  Call PrintDeal(nDealTag)
.head 4 +  Pushbutton: pb_Alien
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.4"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить инф. о партнере
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipAlien')
.head 6 +  On SAM_Click
.head 7 +  If MFOB != STRING_Null
.head 8 -  If SqlPrepareAndExecute(hSql(), "DELETE FROM forex_alien WHERE mfo=:MFOB and kv=:KVB")
.head 7 +  Else
.head 8 -  If SqlPrepareAndExecute(hSql(), "DELETE FROM forex_alien WHERE bic=:BICB and kv=:KVB")
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"INSERT INTO forex_alien 
(MFO,   BIC,  NAME,NLS,  KOD_G,  KOD_B,  OKPO,  KV,  BICK, NLSK, id, agrmnt_num, agrmnt_date, alt_partyb, interm_b, field_58d, codcagent) VALUES
(:MFOB,:BICB,:NBB,:NLSB,:KOD_GB,:KOD_BB,:OKPOB,:KVB,:BICKB,:SSB, 0, :dfAgrNum, :dfAgrDate, :dfB57A, :dfB56A, :s58D, " || IifS(KOD_GB='804','1','2') || ")")
.head 8 -  Call SqlCommit(hSql())
.head 4 +  Pushbutton: pb_Clear
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.85"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сбросить реквизиты сделки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipClear')
.head 6 +  On SAM_Click
.head 7 -  Call F_CLEAR()
.head 7 -  Call f_ClearSwap()
.head 4 -  !
.head 4 +  Pushbutton: pbFromSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.4"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сформировать сделку по SWIFT сообщению
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipFromSWT')
.head 6 +  On SAM_Click
.head 7 -  Call f_swImportMsg()
.head 4 +  Pushbutton: pbCreateSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.85"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\TOMAIL.BMP
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сформировать SWIFT сообщение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipCreateSWT')
.head 6 +  On SAM_Click
.head 7 -  Call f_swCreateMsg()
.head 4 -  !
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.25"
.head 6 -  Top:    0.07"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbCreateTELEX
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.75"
.head 6 -  Top:    0.07"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\resource\bmp\CHKMAIL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Save/Print/View/Update TELEX'
.head 6 +  On SAM_Click
.head 7 -  Call F_TELEX()
.head 4 +  Pushbutton: pbViewSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.3"
.head 6 -  Top:    0.07"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\resource\bmp\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотреть сформированное SWIFT сообщение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipViewSWT')
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT swo_ref INTO :nSwRef FROM fx_deal WHERE deal_tag = :nDealTag" ) 
and SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SWIFTMsgView(hWndForm, nSwRef)
.head 2 +  Contents
.head 3 +  Data Field: NTIK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! № тикета
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipNTIK'))
.head 3 +  Data Field: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.75"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата сделки
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipDAT'))
.head 3 +  Data Field: Resultat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.2"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Фин.результат
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipResultat'))
.head 3 -  !
.head 3 -  Background Text: Валюта  А  - ПОКУПКА
.head 4 -  Resource Id: 4497
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.155"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 22861
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.405"
.head 5 -  Width:  4.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.44"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код покупаемой валюты
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKVA'))
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(KVA)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT lcv, name, dig, Nvl(fx_base, kv)  
   INTO :ISOA, :NAMVA, :nDigA, :Ves_A  
   FROM tabval WHERE kv=:KVA ") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! ВАЛ-А
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrKVA'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set sFormat = '# ##0' || XSalGetDecimalSeparator() || SalStrRepeatX( '0', IifN(nDigA != NUMBER_Null,nDigA,2) )
.head 7 -  Call SalFmtSetPicture(SUMA, sFormat)
.head 7 -  Call SalFmtSetPicture(dfSummCl, sFormat)
.head 7 -  !
.head 7 +  If KVB != NUMBER_Null
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"SELECT gl.p_icurval(:KVA,100,bankdate)/gl.p_icurval(:KVB,100,bankdate)
   INTO :KURSOB FROM dual")
and SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Set KURSOA = 1/KURSOB
.head 9 -  Call F_Kurs()
.head 7 -  ! В зависимости от вабора валюты инициализируем список доступных корсчетов
.head 7 +  If KVA != GetBaseVal()
.head 8 -  Call NBKA.Init(NBKA)
.head 8 -  Call NBKA.Populate(hSql(), "NLS", "SUBSTR(NMS,1,38)", "ACCOUNTS",
"WHERE KV=" || Str(KVA) ||
"  AND DAZS IS NULL AND ACC IN (SELECT ACC FROM BIC_ACC) ORDER BY NLS")
.head 8 -  Call SalListSetSelect(NBKA,0)
.head 8 -  Call SalSendMsg(NBKA, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Call SalListClear(NBKA)
.head 8 -  Set SSA = NUMBER_Null
.head 7 -  !
.head 7 +  If KVA = GetBaseVal() and KVA =980
.head 8 -  Set cb_SWIFT = TRUE
.head 8 -  Call SalDisableWindow(cb_SWIFT)
.head 7 +  Else
.head 8 -  ! Внедрен ли SWIFT ?
.head 8 -  Call SalEnableWindow(cb_SWIFT)
.head 8 -  Set cb_SWIFT = FL_SWIFT
.head 7 -  Call F_Kurs()
.head 7 -  ! Обновляем состояние элементов
.head 7 -  Call f_ControlState()
.head 7 -  Call f_swSetDefaults()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: ISOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAMVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.452"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.714"
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата поступления
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipDATA'))
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(DATA)
.head 7 +  If DATA < DAT
.head 8 -  ! ДАТ-А
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrDATA'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If bSwap and SalIsNull(DATB) 
.head 8 -  Set DATB = DATA
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SUMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.976"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сумма поступления
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSUMA'))
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(SUMA)
.head 7 +  If SUMA <= 0
.head 8 -  ! Сум-А
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMA'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If not SalIsNull(dfSummCl) and SUMA < dfSummCl
.head 8 -  Set dfSummCl = NUMBER_Null
.head 7 -  Call F_RESULTAT()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfSummCl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.25"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Клиентская составляющая суммы
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSummCl'))
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfSummCl)
.head 7 +  If dfSummCl < 0
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cFTipSummCl'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If SUMA and dfSummCl > SUMA
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cFTipSummCl'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If SalIsNull(SUMA)
.head 8 -  Set dfSummCl = NUMBER_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  ! cCheckBoxLabeled: cbSwap	! Сделка Swap
.winattr class Check Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сделка Swap
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.5"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.end
.head 4 -                Message Actions 
.head 3 +  Check Box: cb_Only9	! Только Внебаланс
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Только Внебаланс
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.5"
.head 5 -  Width:  2.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: KURSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.23"
.head 6 -  Top:    0.976"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KURSOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    0.976"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 22862
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    0.405"
.head 5 -  Width:  5.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.44"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: bVPSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПС
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.655"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Data Field: BICA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.345"
.head 6 -  Width:  1.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NBA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.607"
.head 6 -  Width:  4.443"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: OKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.869"
.head 6 -  Width:  1.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.133"
.head 6 -  Top:    2.345"
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.15"
.head 6 -  Top:    2.869"
.head 6 -  Width:  2.486"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KOD_GA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    3.119"
.head 6 -  Width:  0.586"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NGA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    3.119"
.head 6 -  Width:  3.857"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KOD_BA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    2.345"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Check Box: cb_NoKsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Без поступления на КС
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.905"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb_NoKsA
.head 7 -  Call SalHideWindow(BICKA)
.head 7 -  Call SalHideWindow(SSLA)
.head 7 -  Call SalHideWindow(NBKA)
.head 7 -  Call SalHideWindow(SSA)
.head 7 -  Call SalHideWindow(KOD_NA)
.head 7 -  Call SalHideWindow(s_KOD_NA)
.head 7 -  Call SalHideWindow(pb1PBA)
.head 7 -  Call SalHideWindow(cb_SWIFT)
.head 7 -  Call SalHideWindow(dfA56A)
.head 6 +  Else
.head 7 -  Call SalShowWindow(BICKA)
.head 7 -  Call SalShowWindow(SSLA)
.head 7 -  Call SalShowWindow(NBKA)
.head 7 -  Call SalShowWindow(SSA)
.head 7 -  Call SalShowWindow(KOD_NA)
.head 7 -  Call SalShowWindow(s_KOD_NA)
.head 7 -  Call SalShowWindow(pb1PBA)
.head 7 -  Call SalShowWindow(cb_SWIFT)
.head 7 -  Call SalShowWindow(dfA56A)
.head 6 -  Call f_swSetDefaults()
.head 3 +  Check Box: cb_SWIFT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled Box
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автоматическое поступление из ПС
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.488"
.head 5 -  Width:  4.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 22863
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.19"
.head 5 -  Width:  4.586"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.229"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Трасса платежа входящего
.head 4 -  Resource Id: 4498
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    3.893"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTrassaA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: BICKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.095"
.head 6 -  Width:  1.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! BIC нашего банка-корреспонд
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipBICKA'))
.head 5 +  On SAM_Validate
.head 6 -  Set BICKA = SalStrUpperX(BICKA)
.head 6 +  If BICKA != STRING_Null and SSLA != STRING_Null 
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT to_Number(a.nls), a.nms INTO :SSA, :NBKA  
   FROM accounts a, BIC_ACC b 
  WHERE UPPER(b.THEIR_ACC) =:SSLA and b.bic=:BICKA and a.acc=b.acc " ) 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Лоро
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrLoro') || BICKA || ' + ' || SSLA, 
  CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SSLA !! лоро
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.117"
.head 6 -  Top:    4.095"
.head 6 -  Width:  2.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет VOSTRO у нашего банка-корреспонд
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSSLA'))
.head 5 +  On SAM_Validate
.head 6 -  Set SSLA = SalStrUpperX(SSLA)
.head 6 +  If BICKA != STRING_Null and SSLA != STRING_Null 
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT to_number(a.nls), a.nms INTO :SSA , :NBKA  
   FROM accounts a, BIC_ACC b 
  WHERE UPPER(b.THEIR_ACC) =:SSLA and b.bic=:BICKA and a.acc=b.acc " ) 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Лоро
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FXUPD.cTMsgErrLoro') || SSLA || ' BIC: ' || BICKA, 
  CurrentLangTable.GetAtomTitle('FXUPD.cTErr'), 0)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Combo Box: NBKA
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.357"
.head 5 -  Width:  4.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.274"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование счета для входа вал-A
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipNBKA'))
.head 5 +  On SAM_Click
.head 6 -  Set SSA = NBKA.GetKey(SalListQuerySelection(NBKA))
.head 6 -  Call SalSendMsg(SSA, SAM_Validate, 0, 0)
.head 3 +  Data Field: SSA  !! ностро
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.117"
.head 6 -  Top:    4.619"
.head 6 -  Width:  2.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет для входа вал-A
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSSA'))
.head 5 +  On SAM_Validate
.head 6 +  If SSA != NUMBER_Null 
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT a.nms, b.bic, b.THEIR_ACC INTO :NBKA, :BICKA , :SSLA
   FROM  bic_acc b, accounts a
  WHERE a.nls=:SSA and a.kv=:KVA and a.dazs is null and a.acc=b.acc " ) 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Корсчет-А
.head 8 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('FOREX.cTErrSSA') || Str(SSA), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: KOD_NA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 7
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.917"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код назнач.для 1_ПБ
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_NA'))
.head 5 +  On SAM_Validate
.head 6 -  Set KOD_NA = SalStrUpperX(KOD_NA)
.head 6 +  If KOD_NA != STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NA from bopcode where trim(transcode) = :KOD_NA") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! 1_ПБ
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErr1PB') || KOD_NA, 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set KOD_NB = KOD_NA
.head 7 -  Set s_KOD_NB = s_KOD_NA
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: s_KOD_NA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.267"
.head 6 -  Top:    4.917"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb1PBA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    4.9"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Код назнач.для 1_ПБ
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_NA')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGet("bopcode", "transdesc", KOD_NA, s_KOD_NA)
.head 3 -  !
.head 3 -  Background Text: Валюта  Б  - ПРОДАЖА
.head 4 -  Resource Id: 4501
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.2"
.head 5 -  Top:    0.155"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 22866
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    2.202"
.head 5 -  Width:  4.586"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(KVB)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT lcv, name, dig, Nvl(fx_base,kv)  
   INTO :ISOB, :NAMVB, :nDigB, :Ves_B
   FROM tabval WHERE kv=:KVB ") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! ВАЛ-Б
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FOREX.cTErrKVB'), 
  CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set sFormat = '# ##0' || XSalGetDecimalSeparator() || SalStrRepeatX( '0', IifN(nDigB != NUMBER_Null,nDigB,2) )
.head 7 -  Call SalFmtSetPicture( SUMB,  sFormat )
.head 7 -  Call SalFmtSetPicture( SUMB1, sFormat )
.head 7 -  Call SalFmtSetPicture( SUMB2, sFormat )
.head 7 -  ! Считаем курс
.head 7 +  If KVA != NUMBER_Null
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"SELECT gl.p_icurval(:KVB,100,bankdate)/gl.p_icurval(:KVA,100,bankdate)
   INTO :KURSOA FROM dual")
and SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Set KURSOB = 1/KURSOA
.head 9 -  Call F_Kurs()
.head 7 -  Set cbSTP = FALSE
.head 7 +  If n980 = 980 and KVB = n980 and nSTP = 1
.head 8 -  Call SalShowWindow(cbSTP)
.head 7 +  Else
.head 8 -  Call SalHideWindow(cbSTP)
.head 7 -  Call f_ControlState()
.head 7 -  Call f_swSetDefaults()
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код продаваемой валюты
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKVB'))
.head 3 +  Data Field: ISOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAMVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.75"
.head 6 -  Top:    0.452"
.head 6 -  Width:  2.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DATB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.714"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If DATB < DAT
.head 7 -  ! Дат-Б
.head 7 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('FOREX.cTErrDATB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата отправки
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipDATB'))
.head 3 +  Check Box: cb2		! Разбить на 2 суммы
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разбить на 2 суммы
.head 4 -  Window Location and Size
.head 5 -  Left:   6.75"
.head 5 -  Top:    0.714"
.head 5 -  Width:  2.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cb2
.head 7 -  Call SalDisableWindow(SUMB1)
.head 7 -  Call SalDisableWindow(SUMB2)
.head 7 -  Call SalEnableWindow(SUMB)
.head 7 -  Set SUMB1 = 0
.head 7 -  Set SUMB2 = 0
.head 6 +  Else
.head 7 -  Call SalEnableWindow(SUMB1)
.head 7 -  Call SalEnableWindow(SUMB2)
.head 7 -  Call SalDisableWindow(SUMB)
.head 7 -  Set SUMB = 0
.head 3 +  Check Box: cbSTP		! СТП
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СТП
.head 4 -  Window Location and Size
.head 5 -  Left:   9.767"
.head 5 -  Top:    0.726"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Л
.head 4 -  Resource Id: 4502
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.767"
.head 5 -  Top:    1.31"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: colLim
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    1.226"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Burgundy
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: А
.head 4 -  Resource Id: 4504
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.767"
.head 5 -  Top:    1.607"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: colOstBQ
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    1.524"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Burgundy
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Лим - Акт
.head 4 -  Resource Id: 4503
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.767"
.head 5 -  Top:    1.31"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  !
.head 3 +  Data Field: bgLimAkt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: colPLBQ
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.767"
.head 6 -  Top:    1.524"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Burgundy
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: SUMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.988"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Общ.Сумма отправки
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSUMB'))
.head 5 +  On SAM_Validate
.head 6 +  If SUMB <= 0
.head 7 -  ! Сум-Б
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMB'), 
  CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call F_RESULTAT()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SUMB1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    1.238"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SUMB1 <= 0
.head 7 -  ! Сум-Б-1
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMB1'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call F_RESULTAT()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SUMB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    1.524"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SUMB2 <= 0
.head 7 -  ! Сум-Б-2
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMB2'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call F_RESULTAT()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: KURSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.23"
.head 6 -  Top:    0.988"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KURSOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    0.988"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Check Box: cb_NoKsB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Без списания с КС
.head 4 -  Window Location and Size
.head 5 -  Left:   5.2"
.head 5 -  Top:    1.905"
.head 5 -  Width:  3.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb_NoKsB
.head 7 -  Call SalHideWindow(BICKB)
.head 7 -  Call SalHideWindow(SSB)
.head 7 -  Call SalHideWindow(NBKB)
.head 7 -  Call SalHideWindow(KOD_NB)
.head 7 -  Call SalHideWindow(s_KOD_NB)
.head 7 -  Call SalHideWindow(pb1PBB)
.head 7 -  Call SalHideWindow(dfB57A)
.head 7 -  Call SalHideWindow(dfB56A)
.head 7 -  Call SalHideWindow(pb_SearchBICB)
.head 7 -  Call SalHideWindow(pbSearchBIC2)
.head 6 +  Else
.head 7 -  Call SalShowWindow(BICKB)
.head 7 -  Call SalShowWindow(SSB)
.head 7 -  Call SalShowWindow(NBKB)
.head 7 -  Call SalShowWindow(KOD_NB)
.head 7 -  Call SalShowWindow(s_KOD_NB)
.head 7 -  Call SalShowWindow(pb1PBB)
.head 7 -  Call SalShowWindow(dfB57A)
.head 7 -  Call SalShowWindow(dfB56A)
.head 7 -  Call SalShowWindow(pb_SearchBICB)
.head 7 -  Call SalShowWindow(pbSearchBIC2)
.head 6 -  Call f_swSetDefaults()
.head 3 +  Check Box: cb_KS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прямой КС
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    1.905"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb_KS
.head 7 -  Set BICKB = BICA
.head 7 -  Set NBKB  = NBA
.head 7 -  Call F_POISK("", "")
.head 6 +  Else
.head 7 -  Set BICKB = STRING_Null
.head 7 -  Set NBKB  = STRING_Null
.head 3 +  Pushbutton: pb_Poisk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    2.202"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск партнера
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipPoisk')
.head 5 +  On SAM_Click
.head 6 +  If KVB != NUMBER_Null
.head 7 -  Set sTmp = STRING_Null
.head 7 -  Call FunNSIGetFiltered('FOREX_ALIEN', 'NAME', "kv=" || Str(KVB) || 
     IifS(BICB=STRING_Null, "", " and bic='" || BICB || "'") ||
     IifS(MFOB=STRING_Null, "", " and mfo='" || MFOB || "'"), sTmp, NBB)
.head 7 +  If sTmp != STRING_Null
.head 8 -  Call F_POISK("id=:sTmp", "")
.head 8 -  Call SetTrassa()
.head 3 -  Frame
.head 4 -  Resource Id: 22871
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.083"
.head 5 -  Top:    4.071"
.head 5 -  Width:  4.583"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: bVPSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПС
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    3.655"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Data Field: BICB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    2.345"
.head 6 -  Width:  1.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! BIC партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipBICB'))
.head 5 +  On SAM_Validate
.head 6 +  If BICB != STRING_Null and KVB != NUMBER_Null and SalStrTrimX(BICB) != '-1'
.head 7 -  Set BICB = SalStrTrimX(SalStrUpperX(BICB))
.head 7 +  If not F_POISK("ltrim(rtrim(UPPER(f.bic)))=:BICB", "ltrim(rtrim(UPPER(b.bic)))=:BICB")
.head 8 -  ! sw_banks 
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT substr(name,1,35) INTO :NBB FROM sw_banks WHERE ltrim(rtrim(UPPER(bic)))=:BICB " ) 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Call SalMessageBox(BICB, CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SetTrassa()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: MFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.2"
.head 6 -  Top:    2.345"
.head 6 -  Width:  1.871"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! МФО партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipMFOB'))
.head 5 +  On SAM_Validate
.head 6 +  If MFOB != STRING_Null and KVB != NUMBER_Null
.head 7 +  If not F_POISK("f.mfo=:MFOB", "b.mfo=:MFOB")
.head 8 -  ! banks 
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT substr(nb,1,35) INTO :NBB FROM banks WHERE mfo=:MFOB") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Call SalMessageBox(MFOB, CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SetTrassa()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: KOD_BB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    2.345"
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If KOD_BB != STRING_Null and KVB != NUMBER_Null
.head 7 +  If not F_POISK("f.KOD_B=:KOD_BB", "b.KOD_B=:KOD_BB")
.head 8 -  ! Код банка для 1-ПБ
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrKOD_BB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SetTrassa()
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код 1-ПБ партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_BB'))
.head 3 +  Data Field: RNKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    2.905"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! РНК партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipRNKB'))
.head 5 +  On SAM_Validate
.head 6 +  If RNKB != NUMBER_Null and KVB != NUMBER_Null
.head 7 +  If not F_POISK("", "c.rnk=:RNKB")
.head 8 -  ! РНК
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrRNKB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.4"
.head 6 -  Top:    2.905"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! ОКПО партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipOKPOB'))
.head 5 +  On SAM_Validate
.head 6 +  If OKPOB != STRING_Null and KVB != NUMBER_Null
.head 7 +  If not F_POISK("f.OKPO=:OKPOB", "c.okpo=:OKPOB")
.head 8 -  ! Код ОКПО-Б
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrOKPOB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SetTrassa()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.9"
.head 6 -  Top:    2.905"
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет у партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipNLSB'))
.head 5 +  On SAM_Validate
.head 6 +  If KVB = n980 and NLSB != STRING_Null
.head 7 +  If Vkrz2(MFOB, NLSB) != NLSB
.head 8 -  ! Контр.разряд
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrNLSB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: KOD_GB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    3.238"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Гос.партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_GB'))
.head 5 +  On SAM_Validate
.head 6 +  If KOD_GB != STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT COUNTRY INTO :NGB FROM bopcount WHERE KODC=:KOD_GB") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Код госуд для 1-ПБ
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrKOD_GB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NGB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    3.238"
.head 6 -  Width:  3.857"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NBB 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    2.607"
.head 6 -  Width:  4.471"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: dfAgrNum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    3.488"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Номер ген.соглашения 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipAgrNum'))
.head 3 +  Data Field: dfAgrDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.183"
.head 6 -  Top:    3.488"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата ген.соглашения
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipAgrDate'))
.head 3 -  !
.head 3 -  Background Text: Трасса платежа исходящего
.head 4 -  Resource Id: 4500
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    3.893"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTrassaB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 22873
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    4.095"
.head 5 -  Width:  4.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_SearchBICB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    4.071"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск партнера
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipSearchBICB')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGetFiltered('SW_BANKS','NAME','', BICKB, NBKB)
.head 3 +  Data Field: BICKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    4.071"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! BIC банка-корреспонд партнера
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipBICKB'))
.head 5 +  On SAM_Validate
.head 6 -  Set BICKB = SalStrUpperX(BICKB)
.head 6 +  If BICKB != STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT name INTO :NBKB FROM sw_banks WHERE bic=:BICKB ") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox(BICKB, CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.083"
.head 6 -  Top:    4.071"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет VOSTRO партнера у его банка-корреспонд
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipSSB'))
.head 5 +  On SAM_Validate
.head 6 +  If SSB != STRING_Null
.head 7 -  Set SSB = SalStrUpperX(SSB)
.head 7 -  Call F_POISK("", "")
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NBKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    4.321"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KOD_NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 7
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.1"
.head 6 -  Top:    5.417"
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код назнач.для 1_ПБ
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_NB'))
.head 5 +  On SAM_Validate
.head 6 -  Set KOD_NB = SalStrUpperX(KOD_NB)
.head 6 +  If KOD_NB != STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NB from bopcode where trim(transcode) = :KOD_NB") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! 1_ПБ
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErr1PB') || KOD_NB, 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: s_KOD_NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.317"
.head 6 -  Top:    5.417"
.head 6 -  Width:  3.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb1PBB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.4"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Код назнач.для 1_ПБ
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_NB')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGet("bopcode", "transdesc", KOD_NB, s_KOD_NB)
.head 3 -  !
.head 3 +  Multiline Field: dfB57A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 200
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    4.571"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Альтернативный ввод трассы
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('FOREX.cFTipAltPartyB'))
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 3 +  Multiline Field: dfB56A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    5.905"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 3 +  Multiline Field: dfA56A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    5.905"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 3 +  Pushbutton: pbSearchBIC2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.905"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск банка - участника
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FOREX.cBTipSearchBICB')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGetFiltered('SW_BANKS','NAME', '', sTmp, sTmp2)
.head 6 +  If sTmp != STRING_Null
.head 7 +  If dfB56A != STRING_Null
.head 8 -  Set dfB56A = dfB56A || SalNumberToChar(13) || SalNumberToChar((10)) || sTmp
.head 7 +  Else
.head 8 -  Set dfB56A = sTmp
.head 3 -  Background Text: Посредник
.head 4 -  Resource Id: 22607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.083"
.head 5 -  Top:    5.679"
.head 5 -  Width:  4.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIntermA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Посредник
.head 4 -  Resource Id: 22608
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    5.702"
.head 5 -  Width:  4.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIntermB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Ошибочный код надо исправить или стереть
.head 4 -  Resource Id: 4499
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.017"
.head 5 -  Top:    6.893"
.head 5 -  Width:  7.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMess
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Radio Button: rbA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: A-base
.head 4 -  Window Location and Size
.head 5 -  Left:   1.8"
.head 5 -  Top:    0.738"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: B-base
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    0.738"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: checkInputParams
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: sErr
.head 5 -  Receive Window Handle: hWnd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sErr = ''
.head 5 -  Set hWnd = hWndNULL
.head 5 +  If NTIK = STRING_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipNTIK')
.head 6 -  Set hWnd = NTIK
.head 5 +  Else If DATA = DATETIME_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipDATA')
.head 6 -  Set hWnd = DATA
.head 5 +  Else If DATB = DATETIME_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipDATB')
.head 6 -  Set hWnd = DATB
.head 5 +  Else If KVA = NUMBER_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipKVA')
.head 6 -  Set hWnd = KVA
.head 5 +  Else If KVB = NUMBER_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipKVB')
.head 6 -  Set hWnd = KVB
.head 5 +  Else If SUMA <= 0
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipSUMA')
.head 6 -  Set hWnd = SUMA
.head 5 +  Else If SUMB <= 0
.head 6 -  Set sErr =  CurrentLangTable.GetAtomTitle('FOREX.cFTipSUMB')
.head 6 -  Set hWnd = SUMB
.head 5 +  Else If KVA = KVB
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipKVA') || ' = ' ||
           CurrentLangTable.GetAtomTitle('FOREX.cFTipKVB')
.head 6 -  Set hWnd = KVB
.head 5 +  Else If (KVB = n980 and NLSB = STRING_Null)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipNLSB')
.head 6 -  Set hWnd = NLSB
.head 5 +  Else If (KVB = n980 and MFOB = STRING_Null)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipMFOB')
.head 6 -  Set hWnd = MFOB
.head 5 +  Else If (cb2 and SUMB1 <= 0)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMB1')
.head 6 -  Set hWnd = SUMB1
.head 5 +  Else If (cb2 and SUMB2 <= 0)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cTErrSUMB2')
.head 6 -  Set hWnd = SUMB2
.head 5 -  ! Для грн. можно не заполнять BIC, код 1ПБ, страну партнера
.head 5 +  ! Else If KVB != GetBaseVal() AND SalIsNull(BICB)
.head 6 -                                                                     Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTMess1') || PutCrLf() || '<' || 
     CurrentLangTable.GetAtomTitle('FOREX.cFTipBICB') || '>',
     CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconStop)
.head 6 -                                                                     Call SalSetFocus(BICB)
.head 5 +  Else If KVB != GetBaseVal() AND SalIsNull(KOD_GB)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_GB')
.head 6 -  Set hWnd = KOD_GB
.head 5 -  ! если forex_alien.mfo=null - это нерезидент, и код 1ПБ м. не заполнять
.head 5 +  Else If KVB != GetBaseVal() AND SalIsNull(KOD_BB) AND NOT SalIsNull(MFOB)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipKOD_BB')
.head 6 -  Set hWnd = KOD_BB
.head 5 -  ! Для вал. можно не заполнять МФО, ОКПО партнера
.head 5 +  Else If KVB = GetBaseVal() AND SalIsNull(MFOB)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipMFOB')
.head 6 -  Set hWnd = MFOB
.head 5 +  Else If KVB = GetBaseVal() AND SalIsNull(OKPOB)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipOKPOB')
.head 6 -  Set hWnd = OKPOB
.head 5 +  Else If bFxRezid and nRezid != 1 and nRezid != 2
.head 6 -  ! Неизвестна резидентность партнера, сохранение невозможно!
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cTErrRezid')
.head 5 +  Else If SalIsNull(RNKB)
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('FOREX.cFTipRNKB')
.head 6 -  Set hWnd = RNKB
.head 5 -  !
.head 5 -  ! Определяем тип FOREX-сделки: 1-день в день, 2-СПОТ, 3-ФОРВАРД
.head 5 -  Set sFOREXType = GetForexType(DAT, DATA, DATB)
.head 5 -  ! Определяем признак рублей
.head 5 -  Set b643 = (KVB = 643 and KOD_GB = '643')=1
.head 5 -  !
.head 5 -  Return IifN(sErr='', TRUE, FALSE)
.head 3 +  Function: GetAcc9
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  String: sFxType
.head 5 -  Number: nKvA
.head 5 -  Number: nKvB
.head 5 -  Receive Number: nAcc9A
.head 5 -  Receive String: sNls9A
.head 5 -  Receive Number: nAcc9B
.head 5 -  Receive String: sNls9B
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAccA
.head 5 -  Number: nAccB
.head 4 +  Actions
.head 5 +  If not SqlPLSQLCommand(hSql(), "forex.get_fxacc(nRnk, sFxType, nKvA, nKvB, nAccA, nAccB)")
.head 6 -  Return FALSE
.head 5 -  Set nAcc9A = nAccA
.head 5 -  Set nAcc9B = nAccB
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select nls into :sNls9A from accounts where acc = :nAccA")
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select nls into :sNls9B from accounts where acc = :nAccB")
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_SAVE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDealType
.head 5 -  Boolean: FL
.head 5 -  String: sBaseCurr
.head 5 -  Number: nSa
.head 5 -  Number: nSc
.head 5 -  Number: nSb
.head 5 -  Number: nSb1
.head 5 -  Number: nSb2
.head 5 -  String: sKb
.head 5 -  String: sNlsa
.head 5 -  Number: nBPayFlag
.head 5 -  Number: nSwap
.head 4 +  Actions
.head 5 +  If aMfo = Mfo_300465
.head 6 +  If sInic = STRING_Null
.head 7 -  Call SalMessageBox('НЕ выбран реквизит "Инициатор сделки" ! ',  'Внимание !' ,   MB_IconAsterisk | MB_Ok )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  ! Получаем базовую валюту договора
.head 5 +  If rbA 
.head 6 -  Set sBaseCurr = 'A'
.head 5 +  Else
.head 6 -  Set sBaseCurr = 'B'
.head 5 -  !
.head 5 -  ! nBPayFlag
.head 5 -  ! проплата через СЭП(ВПС)
.head 5 +  If cb_NoKsB
.head 6 -  Set nBPayFlag = 0
.head 5 +  Else If KVB = GetBaseVal() and bVPSB and not cb_KS
.head 6 -  Set nBPayFlag = 1
.head 5 -  ! проплата внутр МО
.head 5 +  Else If cb_KS and 
    (   KVB = GetBaseVal() and bVPSB 
     or SalStrTrimX(BICA) = SalStrTrimX(BICKB) )
.head 6 -  Set nBPayFlag = 3
.head 5 -  ! проплата через СВИФТ
.head 5 +  Else
.head 6 -  Set nBPayFlag = 2
.head 5 -  !
.head 5 -  Set nSa  = SUMA * SalNumberPower(10,nDigA)
.head 5 -  Set nSc  = IifN(dfSummCl=NUMBER_Null, NUMBER_Null, dfSummCl * SalNumberPower(10,nDigA))
.head 5 -  Set nSb  = SUMB * SalNumberPower(10,nDigB)
.head 5 -  Set nSb1 = SUMB1 * SalNumberPower(10,nDigB)
.head 5 -  Set nSb2 = SUMB2 * SalNumberPower(10,nDigB)
.head 5 -  Set sKb  = SalStrTrimX(IifS(KVB=n980, MFOB, BICB))
.head 5 -  Set sNlsa = STRING_Null
.head 5 +  If not cb_NoKsA
.head 6 +  If not cb_SWIFT and SSA != NUMBER_Null
or cb_KS and KVA = n980 and Subs(Str(SSA),1,2)='29'
.head 7 -  Set sNlsa = Str(SSA)
.head 6 +  Else
.head 7 -  Set sNlsa = STRING_Null
.head 5 -  !
.head 5 -  ! Есть несколько текстовых полей, где можно выйти за пределы макс. длины - укоротим на всякий случай
.head 5 -  Set BICKA  = SalStrLeftX(BICKA, 11) 
.head 5 -  Set SSLA   = SalStrLeftX(SSLA, 34)
.head 5 -  Set BICKB  = SalStrLeftX(BICKB, 11)
.head 5 -  Set SSB    = SalStrLeftX(SSB, 34)
.head 5 -  Set dfAgrNum = SalStrLeftX(dfAgrNum, 10)
.head 5 -  Set dfB56A = SalStrLeftX(dfB56A, 200)
.head 5 -  Set dfB57A = SalStrLeftX(dfB57A, 200)
.head 5 -  Set BICB   = SalStrLeftX(BICB, 11)
.head 5 -  !
.head 5 -  Set nDealType = IifN(sDealType='DSW', 2, IifN(sDealType='SWAP', 1, 0))
.head 5 -  Set FL = SqlPLSQLCommand(hSql(), "forex.create_deal(
   nDealType, nForexDealMode, nDealTag, nSwapTag, NTIK, DAT,
   KVA, DATA, nSa, nSc,
   KVB, DATB, nSb, nSb1, nSb2,
   RNKB, NBB, sKb, nSWRef, BICKA, SSLA, sNlsa, BICKB, SSB, NLSB,
   nBPayFlag, dfAgrNum, dfAgrDate, dfB56A, dfB57A, BICB,
   sBaseCurr, sTlxNum, KOD_NA, KOD_NB, s58D, " || IifS(cb_Only9=TRUE, "1", "0") || ", sNazn)")
.head 5 +  If FL and nForexDealMode != 4
.head 6 -  Set FL = F_DOPR_INIC (nDealTag, sInic)
.head 5 +  If FL
.head 6 -  Call SqlCommitEx(hSql(), "FOREX. Input deal " || NTIK)
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"select swap_tag, ref, refa, refb, refb2 into :nSwapTag, :nRef, :nRef1, :nRef2, :nRef22
   from fx_deal
  where deal_tag = :nDealTag")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalEnableWindow(pb_Tiket) 
.head 6 -  Call SalEnableWindow(pb_Print2)
.head 6 -  Call SalEnableWindow(pb_Buch)
.head 6 -  Call SalEnableWindow(pb_Alien)
.head 6 -  Call SalEnableWindow(pbPrintDeal)
.head 6 -  Call SalDisableWindow(pb_OK) 
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 5 +  If FL
.head 6 +  If strUseSwift = '1'
.head 7 -  Call SalEnableWindow(pbCreateSWT)
.head 7 -  Call SalDisableWindow(pbFromSWT)
.head 6 +  If strUseTelex = '1'
.head 7 -  Call SalEnableWindow(pbCreateTELEX)
.head 6 -  Call F_TELEX1()
.head 5 -  !
.head 5 -  Return FL
.head 3 +  Function: F_DOPR_INIC
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nND
.head 5 -  String: pInic
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If aMfo = Mfo_300465 and nForexDealMode != 4
.head 6 -  Return SqlPrepareAndExecute(hSql(),
"INSERT INTO operw (ref,tag,value) 
 select ref, 'CP_IN', :pInic
 from fx_deal_ref where deal_tag = :nND") 
.head 5 -  Return TRUE
.head 3 +  Function: F_POISK
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sFilterF
.head 5 -  String: sFilterC
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bFound
.head 4 +  Actions
.head 5 -  ! Сначало очистим лимиты
.head 5 -  Set colPLBQ  = NUMBER_Null
.head 5 -  Set colOstBQ = NUMBER_Null
.head 5 -  Set colLim   = NUMBER_Null
.head 5 -  If SqlPrepareAndExecute(hSql(),
"SELECT pul.MVPS_FIL(:MFOB,:KVA),pul.MVPS_FIL(:MFOB,:KVB) INTO :bVPSA,:bVPSB FROM dual" )
and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT nvl(a.lim,0)/100, rnk_ostb(a.rnk)/100, nvl(a.lim,0)/100 - rnk_ostb(a.rnk)/100 
   INTO :colLim, :colOstBQ, :colPLBQ 
   FROM customer a WHERE a.okpo=:OKPOB")
and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If colPLBQ < 0 and colLim > 0
.head 7 -  ! Исчерпан лимит по контрагенту! Разбить на две суммы?
.head 7 +  If IDYES = SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTMessPoisk1') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('FOREX.cTMessPoisk2'), 
  CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconQuestion | MB_YesNo)
.head 8 -  Set cb2 = TRUE
.head 8 -  Call SalSendMsg(cb2, SAM_Click, 0, 0)
.head 5 +  If cb_KS and SSB != STRING_Null 
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT nms INTO :NBB  FROM accounts WHERE kv=:KVB and nls=:SSB") 
and SqlFetchNext(hSql(), nFetchRes) 
and KVA != NUMBER_Null
and SqlPrepareAndExecute(hSql(),"SELECT nms INTO :NBKA FROM accounts WHERE kv=:KVA and nls=:SSB") 
and SqlFetchNext(hSql(), nFetchRes) 
.head 7 -  Set SSA = Val(SSB)
.head 5 -  !
.head 5 -  ! Поиск клиента
.head 5 +  If sFilterF or sFilterC
.head 6 -  Set bFound = FALSE
.head 6 -  ! FOREX_ALIEN
.head 6 +  If sFilterF and not bFound
.head 7 +  If SqlPrepareAndExecute(hSql(),
"SELECT f.mfo, f.BIC, f.NLS, f.KOD_G, f.KOD_B, f.OKPO, f.BICK, 
        f.NLSK, s.name, b.COUNTRY, f.txt, f.agrmnt_num, f.agrmnt_date, f.telexnum,
        f.alt_partyb, f.interm_b, f.field_58d, f.codcagent
   INTO :MFOB, :BICB, :NLSB, :KOD_GB, :KOD_BB, :OKPOB, :BICKB, 
        :SSB, :NBKB, :NGB, :TXT, :dfAgrNum, :dfAgrDate, :sTlxNum,
        :sTmpB57A, :dfB56A, :s58D, :nRezid 
   FROM forex_alien f, sw_banks s, bopcount b 
  WHERE f.kv=:KVB AND UPPER(f.bick)=UPPER(s.bic (+)) AND b.KODC (+)=f.kod_G AND " || sFilterF)
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set bFound = TRUE
.head 8 -  ! Ищем РНК
.head 8 +  If MFOB != STRING_Null or BICB != STRING_Null or KOD_BB != STRING_Null
.head 9 -  Call SqlPrepareAndExecute(hSql(),
"SELECT c.rnk INTO :RNKB
   FROM customer c, custbank b
  WHERE c.rnk = b.rnk
    and c.date_off is null
    and " || IifS(MFOB!=STRING_Null, "b.mfo=:MFOB", IifS(BICB!=STRING_Null, "b.bic=:BICB", "b.kod_b=:KOD_BB")))
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! CUSTOMER
.head 6 +  If sFilterC and not bFound
.head 7 +  If SqlPrepareAndExecute(hSql(),
"SELECT c.rnk, b.mfo, b.bic, c.COUNTRY, b.KOD_B, c.OKPO, substr(c.nmk,1,35), g.COUNTRY, 
        '', '', '', '', c.codcagent
   INTO :RNKB, :MFOB, :BICB, :KOD_GB, :KOD_BB, :OKPOB, :NBB, :NGB, 
        :NLSB, :BICKB, :SSB, :NBKB, :nRezid
   FROM customer c, custbank b, bopcount g 
  WHERE c.rnk = b.rnk
    and c.country = to_number(g.KODC)
    and c.date_off is null
    and " || sFilterC)
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set bFound = TRUE
.head 6 +  If bFound
.head 7 +  If nRezid = 1
.head 8 -  Set NLSA = B_1819
.head 8 -  Set KOD_NA = FX_1PBA_R
.head 8 -  Set KOD_NB = FX_1PBB_R
.head 7 +  Else
.head 8 -  Set NLSA = B_1819N
.head 8 -  Set KOD_NA = FX_1PBA_NR
.head 8 -  Set KOD_NB = FX_1PBB_NR
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NA from bopcode where trim(transcode) = :KOD_NA")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NB from bopcode where trim(transcode) = :KOD_NB")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 6 +  Else
.head 7 -  Call SalMessageBox('Клієнта не знайдено або Клієнт закритий!', 'Внимание !',  MB_IconAsterisk | MB_Ok)
.head 7 -  Set BICB   = STRING_Null
.head 7 -  Set MFOB   = STRING_Null
.head 7 -  Set NBB    = STRING_Null
.head 7 -  Set NLSB   = STRING_Null
.head 7 -  Set KOD_GB = STRING_Null
.head 7 -  Set KOD_BB = STRING_Null
.head 7 -  Set NGB    = STRING_Null
.head 7 -  Set RNKB   = NUMBER_Null
.head 7 -  Set OKPOB  = STRING_Null
.head 7 -  Set SSB    = STRING_Null
.head 7 -  Set NBKB   = STRING_Null
.head 7 -  Set nRezid = NUMBER_Null
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: F_RESULTAT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSa
.head 5 -  Number: nSb
.head 4 +  Actions
.head 5 +  If cb2
.head 6 -  Set SUMB = SUMB1 + SUMB2
.head 5 +  If SUMB != NUMBER_Null and SUMB != 0 and 
   SUMA != NUMBER_Null and SUMA != 0 and 
   KVA  != NUMBER_Null and 
   KVB  != NUMBER_Null 
.head 6 -  Set KURSA = SUMA /SUMB
.head 6 -  Set KURSB = SUMB /SUMA
.head 6 -  Set nSa = SUMA*SalNumberPower(10,nDigA)
.head 6 -  Set nSb = SUMB*SalNumberPower(10,nDigB)
.head 6 -  If SqlPrepareAndExecute( hSql(), "SELECT
 ( gl.p_icurval(:KVA,:nSa,:DAT)-gl.p_icurval(:KVB,:nSb,:DAT) ) /100
   INTO :Resultat FROM dual" ) 
and SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Call SalColorSet(Resultat, 8, IifN(Resultat>0,COLOR_DarkBlue,COLOR_DarkRed))
.head 5 -  Return TRUE
.head 3 +  Function: F_CLEAR
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If aMfo = Mfo_300465 
.head 6 -  Call cmb_INIC.Init(cmb_INIC)
.head 6 -  Call cmb_INIC.Populate(hSql(), "CODE", "TXT", "CP_OB_INITIATOR", "ORDER BY code ")
.head 6 -  Call cmb_INIC.SetSelectById('0')
.head 6 -  Set sInic = STRING_Null
.head 6 -  Call SalEnableWindow(cmb_INIC)
.head 5 +  Else
.head 6 -  Call SalHideWindow(cmb_INIC)
.head 5 -  Set cb_NoKsA = FALSE
.head 5 -  Set bArc = FALSE
.head 5 -  Call SalSendMsg(cb_NoKsA, SAM_Click, 0, 0)
.head 5 -  Set cb_NoKsB = FALSE
.head 5 -  Call SalSendMsg(cb_NoKsB, SAM_Click, 0, 0)
.head 5 -  !
.head 5 -  ! Call SalDisableWindow(pbSwap)
.head 5 -  Call SalDisableWindow(pb_Tiket)
.head 5 -  Call SalDisableWindow(pb_Print2)
.head 5 -  Call SalDisableWindow(pb_Poisk)
.head 5 -  Call SalDisableWindow(pb_SearchBICB)
.head 5 -  Call SalDisableWindow(pbSearchBIC2)
.head 5 -  Call SalDisableWindow(pb_Buch)
.head 5 -  Call SalDisableWindow(pb_Alien)
.head 5 -  Call SalDisableWindow(pbPrintDeal)
.head 5 -  Call SalDisableWindow(pbCreateSWT)
.head 5 -  Call SalDisableWindow(pbCreateTELEX)
.head 5 -  Call SalDisableWindow(pbViewSWT)
.head 5 -  Call SalEnableWindow(pb_OK)
.head 5 -  !
.head 5 -  Set cbSTP = FALSE
.head 5 -  Call SalHideWindow(cbSTP)
.head 5 -  !
.head 5 -  Set nDealTag = NUMBER_Null
.head 5 -  Set nSwapTag = NUMBER_Null
.head 5 -  Call SalEnableWindow(NTIK)
.head 5 -  Call SalEnableWindow(KVA)
.head 5 -  Call SalEnableWindow(SUMA)
.head 5 -  Call SalEnableWindow(KVB)
.head 5 -  Call SalEnableWindow(SUMB)
.head 5 -  Set DAT  = GetBankDate()
.head 5 -  Set DATA = DAT
.head 5 -  Set DATB = DAT
.head 5 -  Set Resultat = NUMBER_Null
.head 5 -  Set cb_SWIFT = FL_SWIFT
.head 5 -  Set cb2 = FALSE
.head 5 -  Set cb_Only9 = FALSE
.head 5 -  Set cb_KS = FALSE
.head 5 -  Call SalDisableWindow(SUMB1)
.head 5 -  Call SalDisableWindow(SUMB2)
.head 5 -  Call SalEnableWindow(SUMB)
.head 5 -  Set SUMB1 = 0
.head 5 -  Set SUMB2 = 0
.head 5 -  Set NLSA = B_1819
.head 5 -  Set NBA  = GetBankName()
.head 5 -  Set MFOA = GetBankMfo()
.head 5 -  ! Очистка стороны А
.head 5 -  Set OKPOA = GetGlobalOption('OKPO')
.head 5 -  Set KVA   = NUMBER_Null
.head 5 -  Set NTIK  = STRING_Null
.head 5 -  Set ISOA  = STRING_Null
.head 5 -  Set NAMVA = STRING_Null
.head 5 -  Set SUMA  = NUMBER_Null
.head 5 -  Set dfSummCl = NUMBER_Null
.head 5 -  Set KURSA = NUMBER_Null
.head 5 -  Set BICKA = STRING_Null
.head 5 -  Set NBKA  = STRING_Null
.head 5 -  Set SSA   = NUMBER_Null
.head 5 -  Set SSLA  = STRING_Null
.head 5 -  Set dfA56A = STRING_Null
.head 5 -  ! Очистка стороны B
.head 5 -  Set KVB   = NUMBER_Null
.head 5 -  Set ISOB  = STRING_Null
.head 5 -  Set NAMVB = STRING_Null
.head 5 -  Set SUMB  = NUMBER_Null
.head 5 -  Set KURSB = NUMBER_Null
.head 5 -  Set BICB  = STRING_Null
.head 5 -  Set MFOB  = STRING_Null
.head 5 -  Set NBB   = STRING_Null
.head 5 -  Set NLSB  = STRING_Null
.head 5 -  Set KOD_GB = STRING_Null
.head 5 -  Set KOD_BB = STRING_Null
.head 5 -  Set NGB   = STRING_Null
.head 5 -  Set RNKB  = NUMBER_Null
.head 5 -  Set OKPOB = STRING_Null
.head 5 -  Set dfAgrNum = STRING_Null
.head 5 -  Set dfAgrDate = DATETIME_Null
.head 5 -  !
.head 5 -  Set BICKB = STRING_Null
.head 5 -  Set NBKB  = STRING_Null
.head 5 -  Set SSB   = STRING_Null
.head 5 -  Set dfB57A = STRING_Null
.head 5 -  Set dfB56A = STRING_Null
.head 5 -  Set sB57ADef = dfB57A
.head 5 -  ! Еще Люда просила очищать лимиты
.head 5 -  Set colPLBQ = NUMBER_Null
.head 5 -  Set colOstBQ = NUMBER_Null
.head 5 -  Set colLim = NUMBER_Null
.head 5 -  !
.head 5 -  Call SalDisableWindow(SSA)
.head 5 -  Call SalDisableWindow(KOD_NA)
.head 5 -  Call SalDisableWindow(pb1PBA)
.head 5 -  Call SalDisableWindow(BICB)
.head 5 -  Call SalDisableWindow(MFOB)
.head 5 -  Call SalDisableWindow(KOD_BB)
.head 5 -  Call SalDisableWindow(RNKB)
.head 5 -  Call SalDisableWindow(OKPOB)
.head 5 -  Call SalDisableWindow(KOD_GB) 
.head 5 -  Call SalDisableWindow(NLSB) 
.head 5 -  Call SalDisableWindow(BICKB)
.head 5 -  Call SalDisableWindow(SSB)
.head 5 -  Call SalDisableWindow(BICKA)
.head 5 -  Call SalDisableWindow(SSLA)
.head 5 -  Call SalDisableWindow(NBKA)
.head 5 -  Call SalDisableWindow(KOD_NB)
.head 5 -  Call SalDisableWindow(pb1PBB)
.head 5 -  Call SalDisableWindow(dfA56A)
.head 5 -  !
.head 5 -  Call SalDisableWindow(dfAgrNum)
.head 5 -  Call SalDisableWindow(dfAgrDate)
.head 5 -  Call SalDisableWindow(dfB56A)
.head 5 -  Call SalDisableWindow(dfB57A)
.head 5 -  ! Еще нужно очистить переменную привязки SWIFT сообщения
.head 5 -  Set nSWRef = NUMBER_Null
.head 3 +  Function: f_ClearSwap
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set cSwap.nSwapTag = NUMBER_Null
.head 5 -  Set cSwap.sNTic = STRING_Null
.head 5 -  Set cSwap.nKvA  = NUMBER_Null
.head 5 -  Set cSwap.nKvB  = NUMBER_Null
.head 5 -  Set cSwap.sNbB  = STRING_Null
.head 5 -  Set cSwap.sMfoB = STRING_Null
.head 5 -  Set cSwap.sBicB = STRING_Null
.head 5 -  Set cSwap.sInic = STRING_Null
.head 5 -  Return TRUE
.head 3 +  Function: F_Prepare
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If bSwap
.head 6 -  Call SalHideWindow(dfSummCl)
.head 5 -  ! -- Открываем/Закрываем кнопки в зависимости от установленных опция (SWIFT/TELEX)
.head 5 +  If strUseTelex != '1'
.head 6 -  Call SalDisableWindow(pbCreateTELEX)
.head 5 +  If strUseSwift != '1'
.head 6 -  Call SalDisableWindow(pbCreateSWT)
.head 6 -  Call SalDisableWindow(pbFromSWT)
.head 6 -  Call SalDisableWindow(pbViewSWT)
.head 5 +  Else
.head 6 -  Call SalEnableWindow(pbFromSWT)
.head 5 -  ! -- счета из настроек операций
.head 5 -  If SqlPrepareAndExecute(hSql(), "SELECT nlsm, nlsk INTO :sA_FX5, :sB_FX5 FROM tts WHERE tt='FX5'") 
and SqlFetchNext(hSql(), nFetchRes) 
.head 5 -  If SqlPrepareAndExecute(hSql(), "SELECT nlsm, nlsk INTO :sA_FXF, :sB_FXF FROM tts WHERE tt='FXF'") 
and SqlFetchNext(hSql(), nFetchRes) 
.head 5 -  ! -- stp
.head 5 -  If SqlPrepareAndExecute(hSql(), "SELECT substr(flags,13,1) INTO :nSTP FROM tts WHERE tt='FX1'") 
and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  !
.head 5 +  If FX_1PBA_R != STRING_Null
.head 6 -  Set KOD_NA = FX_1PBA_R
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NA from bopcode where trim(transcode) = :KOD_NA")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 5 +  If FX_1PBB_R != STRING_Null
.head 6 -  Set KOD_NB = FX_1PBB_R
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select transdesc into :s_KOD_NB from bopcode where trim(transcode) = :KOD_NB")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 5 -  !
.head 5 -  Set sACC = " a.nls in (" || 
    T_1819 || "," ||
    IifS(T_1819S='', "", T_1819S || ",") ||
    B_1819 || "," ||
    B_1919 || 
    IifS(sA_FX5='', "", "," || sA_FX5) || 
    IifS(sB_FX5='', "", "," || sB_FX5) || 
    IifS(sA_FXF='', "", "," || sA_FXF) || 
    IifS(sB_FXF='', "", "," || sB_FXF) || ")"
.head 3 +  Function: F_TELEX1
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Признак использования TELEX
.head 5 -  String: strUseTelex
.head 5 -  !
.head 5 -  String: strTempl
.head 5 -  String: strReport 
.head 5 -  String: sQRD
.head 5 -  String: sTmp
.head 5 -  File Handle: hFile
.head 5 -  Long String: sTiket
.head 5 -  !
.head 5 -  String: tlxfTlxNum
.head 5 -  String: tlxfFrom
.head 5 -  String: tlxfTo
.head 5 -  String: tlxfCrDate
.head 5 -  String: tlxfAgrNum
.head 5 -  String: tlxfAgrDate
.head 5 -  String: tlxfTicketNum
.head 5 -  String: tlxfF20
.head 5 -  String: tlxfF21
.head 5 -  String: tlxfF22A
.head 5 -  String: tlxfF22C
.head 5 -  String: tlxfF82A
.head 5 -  String: tlxfF87A
.head 5 -  String: tlxfF30
.head 5 -  String: tlxfF30V
.head 5 -  String: tlxfF36
.head 5 -  String: tlxfF32R
.head 5 -  String: tlxfFA57
.head 5 -  String: tlxfFA56
.head 5 -  String: tlxfF33P
.head 5 -  String: tlxfFB57
.head 5 -  String: tlxfFB56
.head 5 -  String: tlxfUserName
.head 5 -  String: sRelMsgRef
.head 5 -  String: sDealRate
.head 5 -  Number: i
.head 5 -  Number: nOffset
.head 5 -  Long String: sSrcTicket
.head 5 -  Long String: sTgtTicket
.head 4 +  Actions
.head 5 +  If not bArc
.head 6 +  While TRUE
.head 7 -  ! Получаем параметр UseTelex
.head 7 -  Set strUseTelex = GetGlobalOption('TELEX')
.head 7 -  ! Если не установлен или установлен в 0, то выходим
.head 7 +  If strUseTelex != '1'
.head 8 -  Break
.head 7 -  ! Получаем имя шаблона
.head 7 -  Set strTempl = GetTemplateDir()||'\\tlx_300.qrd'
.head 7 -  ! Получаем имя сформированного файла
.head 7 -  Set strReport =
GetPrnDir()||'\\TL'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || SalNumberToStrX(SalDateDay(SalDateCurrent()), 0), 2)
.head 7 -  ! переменные в шаблоне tlx_300.qrd
.head 7 -  Set sQRD = 
'TLXNUM_~FROM_~TO_~DATE_~AGRNUM_~AGRDATE_~TICKET_~F20_~F21_~F22C_~F22A_~F82A_~F87A_~F30_~F30V_~F36_~F32R_~FA57_~FA56_~F33P_~FB57_~FB56_~TELL_~PODP_'
.head 7 -  !
.head 7 -  ! Формируем параметры
.head 7 -  ! Номер телекса 
.head 7 -  Set tlxfTlxNum = sTlxNum
.head 7 -  ! Имена отправиля и получателя в переводе на латинский (tlxfFrom, tlxfTo)
.head 7 -  ! У отправителя БИК есть
.head 7 +  If strUseSwift = '1'
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select bic || ' ' || substr(name, 1, 40)
         into :tlxfFrom
        from sw_banks where bic = :BICA") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 +  Else
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr('MFO' || :MFOA || ' ' || swift_utl.StrToSwift(nb, 'TRANS'), 1, 30)
         into :tlxfTo
        from banks where mfo = :MFOA ") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  ! У получателя должен быть либо БИК, либо МФО
.head 7 +  If BICB != STRING_Null
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(bic || ' ' || name, 1, 30)
         into :tlxfTo
        from sw_banks where bic = :BICB") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 +  Else
.head 8 -  ! Задано МФО, перекодируем наименование
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr('MFO' || :MFOB || ' ' || swift_utl.StrToSwift( :NBB, 'TRANS'), 1, 30)
         into :tlxfTo
        from dual ") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  ! Дата и время формирования в формате [MON DD YYYY HH24:MI]
.head 7 -  Set tlxfCrDate = SalFmtFormatDateTime(SalDateCurrent(), 'MMM dd yyyy')
.head 7 -  ! Номер ген. соглашения
.head 7 -  Set tlxfAgrNum = dfAgrNum
.head 7 -  ! Дата ген. соглашения в формате [DD.MM.YY]
.head 7 -  Set tlxfAgrDate = SalFmtFormatDateTime(dfAgrDate, 'dd.MM.yy')
.head 7 -  ! Номер тикета
.head 7 -  Set tlxfTicketNum = NTIK
.head 7 -  ! Референс транзакции !
.head 7 -  Set tlxfF20 = Str(nRef)
.head 7 -  ! Референс связанного сообщения
.head 7 +  If (nSWRef != NUMBER_Null)
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT substr(value, 1, 16) INTO :sRelMsgRef FROM sw_operw WHERE swref=:nSWRef and tag='20' and opt is null" )
 and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  Set tlxfF21 = sRelMsgRef
.head 7 -  ! Общий референс
.head 7 +  If BICA != STRING_Null and BICB != STRING_Null
.head 8 -  Set sDealRate =  SalNumberToStrX(IifN(rbA, SUMB/SUMA, SUMA/SUMB), 4)
.head 8 +  While SalStrLength(sDealRate) < 5
.head 9 -  Set sDealRate = '0' || sDealRate
.head 8 -  Set i = 1
.head 8 -  Set sTmp = STRING_Null
.head 8 +  While i < SalStrLength(sDealRate)
.head 9 +  If SalStrMidX(sDealRate, i, 1) != '.'
.head 10 -  Set sTmp = sTmp || SalStrMidX(sDealRate, i, 1)
.head 9 -  Set i = i + 1
.head 8 +  If SalStrLeftX(BICA, 4) <= SalStrLeftX(BICB, 4)
.head 9 -  Set tlxfF22C = SalStrLeftX(BICA, 4) || SalStrMidX(BICA, 7, 2) || SalStrRightX(sTmp, 4) || SalStrLeftX(BICB, 4) || SalStrMidX(BICB, 7, 2)
.head 8 +  Else
.head 9 -  Set tlxfF22C = SalStrLeftX(BICB, 4) || SalStrMidX(BICB, 7, 2) || SalStrRightX(sTmp, 4) || SalStrLeftX(BICA, 4) || SalStrMidX(BICA, 7, 2)
.head 7 +  Else
.head 8 -  Set tlxfF22C = STRING_Null
.head 7 -  ! Тип сообщения
.head 7 -  Set tlxfF22A = IifS(sRelMsgRef=STRING_Null, 'NEWT', 'EXOP')
.head 7 -  ! Сторона А, Б
.head 7 -  Set tlxfF82A = tlxfFrom
.head 7 -  Set tlxfF87A = tlxfTo
.head 7 -  ! Дата заключения сделки
.head 7 -  Set tlxfF30 = SalFmtFormatDateTime(DAT, 'yyyyMMdd')
.head 7 -  ! Дата валютирования сделки
.head 7 +  If DATA > DATB
.head 8 -  Set tlxfF30V = SalFmtFormatDateTime(DATB, 'yyyyMMdd')
.head 7 +  Else
.head 8 -  Set tlxfF30V = SalFmtFormatDateTime(DATA, 'yyyyMMdd')
.head 7 -  ! Курс сделки
.head 7 -  Set tlxfF36 = SalNumberToStrX( IifN( rbA, SUMB/SUMA, SUMA/SUMB ), 4 ) 
.head 7 -  ! Дата валютирования, валюта и сумма по стороне А
.head 7 -  Set tlxfF32R = SalFmtFormatDateTime(DATA,'yyyyMMdd') || ' ' || ISOA || SalNumberToStrX(SUMA,2)
.head 7 -  ! Реквизиты для входящего платежа (сторона А)
.head 7 +  If cb_NoKsA
.head 8 -  ! По стороне А установлена опция "Без корсчета"
.head 8 +  If cb_NoKsB
.head 9 -  Set tlxfFA57 = "NONE"
.head 8 +  Else
.head 9 -  Set tlxfFA57 = "NET"
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT substr(name, 1, 40) INTO :sTmp FROM sw_banks  WHERE bic=:BICKA" ) 
.head 9 -  Call SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 8 -  Set tlxfFA57 = IifS(SSLA = STRING_Null, STRING_Null, SSLA || SalNumberToChar(13) || SalNumberToChar(10)) ||
BICKA || SalNumberToChar(13) || SalNumberToChar(10) ||
sTmp || 
IifS(OKPOA = STRING_Null, STRING_Null, SalNumberToChar(13) || SalNumberToChar(10) || OKPOA)
.head 8 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(swift_utl.prepstr2(:tlxfFA57), 1, 200)
         into :tlxfFA57
        from dual") and SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 7 -  ! Реквизиты посредника для входящего платежа (сторона А)
.head 7 -  Set tlxfFA56 = STRING_Null
.head 7 -  ! Дата валютирования, валюта и сумма по стороне Б
.head 7 -  Set tlxfF33P = SalFmtFormatDateTime(DATB, 'yyyyMMdd') || ' ' || ISOB || SalNumberToStrX(SUMB, 2)
.head 7 -  ! Реквизиты посредника для исходящего платежа (сторона Б)
.head 7 -  ! tlxfFB56
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(swift_utl.prepstr2(:dfB56A), 1, 200)
         into :tlxfFB56
        from dual") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  ! Реквизиты для исходящего платежа (сторона Б)
.head 7 +  If cb_NoKsB
.head 8 +  If cb_NoKsA
.head 9 -  Set tlxfFB57 = "NONE"
.head 8 +  Else
.head 9 -  Set tlxfFB57 = "NET"
.head 7 +  Else
.head 8 -  ! Если введена альтернативная трасса, то просто переносим ее
.head 8 +  If dfB57A != STRING_Null
.head 9 -  ! tlxfFB57 = dfB57A
.head 9 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(swift_utl.prepstr2(:dfB57A), 1, 200)
         into :tlxfFB57
        from dual") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 8 +  Else
.head 9 -  ! Собираем по кусочкам
.head 9 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT substr(name, 1, 40) INTO :sTmp FROM sw_banks  WHERE bic=:BICKB" ) 
.head 10 -  Call SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 9 -  Set tlxfFB57 = IifS(SSB = STRING_Null, STRING_Null, SSB || SalNumberToChar(13) || SalNumberToChar(10)) ||
BICKB || SalNumberToChar(13) || SalNumberToChar(10) ||
sTmp || 
IifS(OKPOB = STRING_Null, STRING_Null, SalNumberToChar(13) || SalNumberToChar(10) || OKPOB)
.head 9 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(swift_utl.prepstr2(:tlxfFB57), 1, 200)
         into :tlxfFB57
        from dual") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  !
.head 7 -  Set tlxfUserName = GetUserRealName()
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(), 
    "select substr(swift_utl.prepstr2(:tlxfUserName), 1, 200)
         into :tlxfUserName
        from dual") and SqlFetchNext(  hSqlAux2(),  nFetchRes) 
.head 7 -  Set sTmp = tlxfTlxNum ||
'~' || tlxfFrom ||
'~' || tlxfTo || 
'~' || tlxfCrDate ||
'~' || tlxfAgrNum ||
'~' || tlxfAgrDate ||
'~' || tlxfTicketNum ||
'~' || tlxfF20 ||
'~' || tlxfF21 ||
'~' || tlxfF22C ||
'~' || tlxfF22A ||
'~' || tlxfF82A ||
'~' || tlxfF87A ||
'~' || tlxfF30 ||
'~' || tlxfF30V ||
'~' || tlxfF36 ||
'~' || tlxfF32R ||
'~' || tlxfFA57 ||
'~' || tlxfFA56 ||
'~' || tlxfF33P ||
'~' || tlxfFB57 ||
'~' || tlxfFB56 ||
'~' ||
'~' || tlxfUserName
.head 7 -  !
.head 7 -  !
.head 7 -  Call DosReport ( strTempl, strReport,  sQRD, sTmp, 0)
.head 7 -  ! !!!!!!!!!
.head 7 -  Set bArc = TRUE
.head 7 +  If SalFileOpen( hFile, strReport, 0 )
.head 8 -  Call SalFileRead( hFile, sTiket, VisFileGetSize( strReport ) )
.head 8 -  ! ! Убираем пустые строки из файла
.head 8 -  Set nOffset = SalStrScan(sTiket, SalNumberToChar(13) || SalNumberToChar(10))
.head 8 -  Set sSrcTicket = sTiket
.head 8 +  While nOffset != -1
.head 9 -  Set sTmp = SalStrLeftX(sSrcTicket, nOffset+2)
.head 9 -  Set sSrcTicket = SalStrMidX(sSrcTicket, nOffset+2, SalStrLength(sSrcTicket)-nOffset+2)
.head 9 +  If SalStrTrimX(sTmp) != SalNumberToChar(13) || SalNumberToChar(10)
.head 10 -  Set sTgtTicket = sTgtTicket || sTmp
.head 9 -  Set nOffset = SalStrScan(sSrcTicket, SalNumberToChar(13) || SalNumberToChar(10))
.head 8 -  Set sTiket = sTgtTicket
.head 8 -  ! При изменении срока сделки меняем телекс
.head 8 +  If nForexDealMode = 4
.head 9 +  If SqlPrepare(hSql(), "update BARS.TELEX_FILE set TELEX = :sTiket where ins = 1 and nd = :nDealTag")
and SqlSetLongBindDatatype(1, BLOB_BYTE)
and SqlExecute(hSql())
.head 10 -  Call SalFileClose(hFile)
.head 10 -  Call SqlCommitEx(hSql(), "TELEX создан " || Str(nDealTag))
.head 8 +  Else
.head 9 +  If SqlPrepare(hSql(), "INSERT into BARS.TELEX_FILE (TELEX, ins, nd) values (:sTiket, 1, :nDealTag)")
and SqlSetLongBindDatatype(1, BLOB_BYTE)
and SqlExecute(hSql())
.head 10 -  Call SalFileClose(hFile)
.head 10 -  Call SqlCommitEx(hSql(), "TELEX создан " || Str(nDealTag) )
.head 7 -  Break
.head 3 +  Function: F_TELEX
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return F_dlg_TELEX ( nDealTag, 1 ) 
.head 3 +  Function: F_Kurs
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If Ves_A <  Ves_B
.head 6 -  Set rbA = TRUE
.head 5 +  Else
.head 6 -  Set rbB = TRUE
.head 3 +  Function: f_swSetDefaults
.head 4 -  Description: Устанавливает умолчательные свифтовые параметры в форме ввода
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If (KVA = GetBaseVal() and BICKA = STRING_Null)
.head 6 +  If not cb_NoKsA
.head 7 -  Set BICKA = BICA
.head 5 +  If (KVA = GetBaseVal() and SSLA  = STRING_Null)
.head 6 +  If not cb_NoKsA
.head 7 -  Set SSLA = NLSA
.head 5 +  ! If (KVA = GetBaseVal() and not cb_NoKsA
.head 6 -                   Set BICKA = BICA
.head 5 +  ! If (KVA = GetBaseVal() and not cb_NoKsA
.head 6 -                   Set SSLA = NLSA
.head 5 +  If (KVB = GetBaseVal() and BICKB = STRING_Null and dfB57A = sB57ADef)
.head 6 +  If not cb_NoKsB
.head 7 -  Set dfB57A = '/' || NLSB || SalNumberToChar(13) || SalNumberToChar(10)
.head 7 +  If BICB = STRING_Null
.head 8 -  Set dfB57A = dfB57A || 'MFO' || MFOB
.head 7 +  Else
.head 8 -  Set dfB57A = dfB57A || BICB
.head 7 -  Set sB57ADef = dfB57A
.head 5 +  Else
.head 6 -  ! Если трасса по стороне Б не изменялась, то ее нужно удалить
.head 6 +  If (dfB57A = sB57ADef)
.head 7 -  Set dfB57A = STRING_Null
.head 7 -  Set sB57ADef = dfB57A
.head 5 -  !
.head 5 +  If cb_NoKsA
.head 6 -  Set BICKA = STRING_Null
.head 6 -  Set SSLA = STRING_Null
.head 6 -  Set dfA56A = STRING_Null
.head 5 +  If cb_NoKsB
.head 6 -  Set BICKB = STRING_Null
.head 6 -  Set SSB = STRING_Null
.head 6 -  Set dfB56A = STRING_Null
.head 6 -  Set dfB57A = STRING_Null
.head 3 +  Function: f_swImportMsg
.head 4 -  Description: Заполняет поля формы ввода значениями из SWIFT сообщения
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dTmp
.head 4 +  Actions
.head 5 -  Set nSWRefTmp = SWIFTMsgSel(hWndForm, 'V_SW300_HEADER', "IO_IND='O'")
.head 5 +  If nSWRefTmp != 0
.head 6 -  Call F_CLEAR()
.head 6 -  Set nSWRef = nSWRefTmp
.head 6 +  If SqlPLSQLCommand( hSql(), "SWIFT.Get_MT300_Fields(nSWRef,
sTmp,BICB,dTmp,DATA,KVA,SUMA,KVB,SUMB, sTmpSSLA, sTmpBICKA,sTmpSSLB, sTmpBICKB, sTmpFld57, sTmpFldA56, sTmpFldB56, dfAgrNum, dfAgrDate)")
.head 7 -  Set DATB = DATA
.head 7 -  ! Функция возвращает суммы в копейках, центах...
.head 7 -  Set SUMA = SUMA/100
.head 7 -  Set SUMB = SUMB/100
.head 7 -  Call SalSendMsg(SUMA, SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(KVA,  SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(SUMB, SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(KVB,  SAM_Validate, 0, 0)
.head 7 -  ! Заполняем трассу по стороне А
.head 7 -  Set SSLA = sTmpSSLA
.head 7 -  Set BICKA = sTmpBICKA
.head 7 -  Set dfA56A  = sTmpFldA56
.head 7 -  Call SalSendMsg(BICB, SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(SSLA, SAM_Validate, 0, 0)
.head 7 -  ! Заполняем трассу по стороне Б (перекрываем данные из справочника для партнера)
.head 7 -  Set BICKB = sTmpBICKB
.head 7 -  Set SSB = sTmpSSLB
.head 7 -  Set dfB57A = sTmpFld57
.head 7 -  Set dfB56A  = sTmpFldB56
.head 7 -  Call SalSendMsg(BICKB, SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(SSB,  SAM_Validate, 0, 0)
.head 7 -  ! Если валюта - национальная и из свифтовки мы так и не смогли вытянуть BICKA, SSLA, то проставим руками
.head 7 -  Call f_swSetDefaults()
.head 3 +  Function: f_swCreateMsg
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sProc
.head 4 +  Actions
.head 5 -  Set sProc = "SWIFT.Gen3xxMsg(300,nDealTag)"
.head 5 +  ! If sDealType = 'DSW'
.head 6 -                Set sProc = "SWIFT.gen_mt320dsw_message(nDealTag)"
.head 5 +  If SqlPLSQLCommand(hSql(), sProc)
.head 6 -  Call SqlCommit(hSql())
.head 6 -  ! Сформировано SWIFT-сообщение
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FX1.cTMsgCreateSWT'), CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 6 -  Call SalEnableWindow(pbViewSWT)
.head 3 +  Function: f_ControlState
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If KVA != NUMBER_Null
.head 6 -  Call SalEnableWindow(dfA56A)
.head 6 -  Call SalEnableWindow(BICKA)
.head 6 -  Call SalEnableWindow(SSLA)
.head 6 -  Call SalEnableWindow(NBKA)
.head 6 -  Call SalEnableWindow(SSA)
.head 6 -  Call SalEnableWindow(KOD_NA)
.head 6 -  Call SalEnableWindow(pb1PBA)
.head 5 +  If KVB != NUMBER_Null
.head 6 -  Call SalEnableWindow(pb_Poisk)
.head 6 -  Call SalEnableWindow(BICB)
.head 6 -  Call SalEnableWindow(MFOB)
.head 6 -  Call SalEnableWindow(KOD_BB)
.head 6 -  Call SalEnableWindow(RNKB)
.head 6 -  Call SalEnableWindow(OKPOB)
.head 6 -  Call SalEnableWindow(KOD_GB)
.head 6 -  Call SalEnableWindow(NLSB)
.head 6 -  Call SalEnableWindow(BICKB)
.head 6 -  Call SalEnableWindow(SSB)
.head 6 -  Call SalEnableWindow(KOD_NB)
.head 6 -  Call SalEnableWindow(pb1PBB)
.head 6 -  Call SalEnableWindow(pb_SearchBICB)
.head 6 -  Call SalEnableWindow(pbSearchBIC2)
.head 6 -  Call SalEnableWindow(dfB56A)
.head 6 -  Call SalEnableWindow(dfB57A)
.head 6 -  Call SalEnableWindow(dfAgrNum)
.head 6 -  Call SalEnableWindow(dfAgrDate)
.head 3 +  Function: F_SWAP
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : c_dsw
.head 6 -  Class: cDepoSwap
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call F_CLEAR()
.head 5 -  Set SUMA = NUMBER_Null
.head 5 -  Set SUMB = NUMBER_Null
.head 5 -  Set nSwapTag = c_dsw.nSwapTag
.head 5 -  Set NTIK = c_dsw.sNTic
.head 5 -  Set KVA  = c_dsw.nKvA
.head 5 -  Set KVB  = c_dsw.nKvB
.head 5 -  Set NTIK = c_dsw.sNTic
.head 5 -  Set DATA = DATETIME_Null
.head 5 -  Set DATB = DATETIME_Null
.head 5 -  Set NBB  = c_dsw.sNbB
.head 5 -  Set sInic = c_dsw.sInic
.head 5 -  Call cmb_INIC.SetSelectById(sInic)
.head 5 -  Call SalDisableWindow(cmb_INIC)
.head 5 -  Set bSwap = TRUE
.head 5 -  Call SalDisableWindow(NTIK)
.head 5 -  Call SalDisableWindow(KVA)
.head 5 -  Call SalDisableWindow(KVB)
.head 5 -  Call SalSendMsg(KVA, SAM_Validate, 0, 0)
.head 5 -  Call SalSendMsg(KVB, SAM_Validate, 0, 0)
.head 5 +  If sDealType = 'DSW'
.head 6 -  Call SalSetWindowText(hWndForm, AppVersion || CurrentLangTable.GetAtomTitle('FOREX.cTWndTitle') || ' ДЕПО СВОП')
.head 6 -  Call SalDisableWindow(SUMA)
.head 6 -  Call SalDisableWindow(SUMB)
.head 6 -  Set SUMA = c_dsw.nSumA / SalNumberPower(10,nDigA)
.head 6 -  Set SUMB = c_dsw.nSumB / SalNumberPower(10,nDigB)
.head 5 +  Else
.head 6 -  Call SalSetWindowText(hWndForm, AppVersion || CurrentLangTable.GetAtomTitle('FOREX.cTWndTitle') || ' СВОП')
.head 5 +  If c_dsw.nKvA = n980
.head 6 -  Set MFOB = c_dsw.sMfoB
.head 6 -  Call SalSendMsg(MFOB, SAM_Validate, 0, 0)
.head 5 +  Else
.head 6 -  Set BICB = c_dsw.sBicB
.head 6 -  Call SalSendMsg(BICB, SAM_Validate, 0, 0)
.head 5 -  Set cb2 = FALSE
.head 5 -  Call SalDisableWindow(cb2)
.head 5 -  Call SalDisableWindow(BICB)
.head 5 -  Call SalDisableWindow(MFOB)
.head 5 -  Call SalDisableWindow(KOD_BB)
.head 5 -  Call SalDisableWindow(RNKB)
.head 5 -  Call SalDisableWindow(OKPOB)
.head 5 -  ! Call SalDisableWindow(NLSB)
.head 5 -  Call SalDisableWindow(KOD_GB)
.head 5 -  Call SalDisableWindow(dfAgrNum)
.head 5 -  Call SalDisableWindow(dfAgrDate)
.head 5 -  ! Call SalDisableWindow(pb_Poisk)
.head 5 -  Return TRUE
.head 3 +  Function: SetTrassa
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfB57A = sTmpB57A
.head 5 +  If dfB57A = STRING_Null
.head 6 -  Set sB57ADef = dfB57A
.head 5 -  Call f_swSetDefaults()
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  String: sDealType
.head 2 +  Window Variables
.head 3 -  String: aMfo
.head 3 -  Number: n980
.head 3 -  String: T_1819  !! счет -Торговый
.head 3 -  String: T_1819S !! счет -Торговый для СВОП
.head 3 -  String: B_1819  !! Буфер DEB
.head 3 -  String: B_1819N !! Буфер DEB для НЕрезидентов
.head 3 -  String: B_1919  !! Буфер KRD
.head 3 -  String: B_1919N !! Буфер KRD для НЕрезидентов
.head 3 -  Boolean: bFxRezid
.head 3 -  String: FX_1PBA_R
.head 3 -  String: FX_1PBB_R
.head 3 -  String: FX_1PBA_NR
.head 3 -  String: FX_1PBB_NR
.head 3 -  String: strUseTelex
.head 3 -  String: strUseSwift
.head 3 -  Boolean: FL_SWIFT
.head 3 -  Number: nParamNoPrintMO
.head 3 -  ! признак сделки СВОП
.head 3 -  Boolean: bSwap
.head 3 -  ! Тип сделок ФОРЕКС
.head 3 -  ! 0 - обычный форекс
.head 3 -  ! 1 - начальный своп
.head 3 -  ! 2 - конечный своп
.head 3 -  ! 3 - %% по суменьшение срока свопвоп
.head 3 -  ! 4 - уменьшение срока своп
.head 3 -  Number: nForexDealMode
.head 3 -  !
.head 3 -  String: Mfo_300465
.head 3 -  String: sInic
.head 3 -  !
.head 3 -  Number: nSTP
.head 3 -  String: sA_FX5
.head 3 -  String: sB_FX5
.head 3 -  String: sA_FXF
.head 3 -  String: sB_FXF
.head 3 -  String: sACC
.head 3 -  !
.head 3 -  Boolean: bArc
.head 3 -  Number: Ves_A
.head 3 -  Number: Ves_B
.head 3 -  !
.head 3 -  Number: nDealTag
.head 3 -  Number: nRef
.head 3 -  Number: nRef1
.head 3 -  Number: nRef2
.head 3 -  Number: nRef22
.head 3 -  Date/Time: TIME
.head 3 -  String: TXT
.head 3 -  String: sNazn
.head 3 -  Number: nDigA
.head 3 -  Number: nDigB
.head 3 -  String: sFormat
.head 3 -  String: sSWRef
.head 3 -  Number: nSWRef
.head 3 -  String: sErrText
.head 3 -  Window Handle: hErrWnd
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  String: sTmp2
.head 3 -  String: sTmpB57A
.head 3 -  String: sTmpSSLA
.head 3 -  String: sTmpBICKA
.head 3 -  String: sTmpSSLB
.head 3 -  String: sTmpBICKB
.head 3 -  String: sTmpFld57
.head 3 -  String: sTmpFldA56
.head 3 -  String: sTmpFldB56
.head 3 -  String: sTmpBic
.head 3 -  String: sTmpBankName
.head 3 -  String: s58D
.head 3 -  !
.head 3 -  Number: nSwRef
.head 3 -  Number: nSWRefTmp   ! Временная переменная для вызова справочника
.head 3 -  String: sBaseCurr
.head 3 -  String: sB57ADef
.head 3 -  String: sTlxNum
.head 3 -  ! String: sPartnerId
.head 3 -  !
.head 3 -  Boolean: b643
.head 3 -  Number: nRezid
.head 3 -  !
.head 3 -  String: sFOREXType
.head 3 -  Number: nSwapTag
.head 3 -  Number: nSwapCount
.head 3 -  : cSwap
.head 4 -  Class: cDepoSwap
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set bSwap = FALSE
.head 4 -  Set nForexDealMode = 0
.head 4 +  If sDealType = 'SWAP' or sDealType = 'DSW'
.head 5 -  Set bSwap = TRUE
.head 5 -  Set nForexDealMode = 1
.head 4 -  Call SalSetWindowText(hWndForm, AppVersion || CurrentLangTable.GetAtomTitle('FOREX.cTWndTitle') || IifS(sDealType='SWAP', ' СВОП', IifS(sDealType='DSW', ' ДЕПО СВОП', '')))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set Mfo_300465 ='300465'
.head 4 -  Set aMfo = GetBankMfo()
.head 4 -  Set n980 = GetBaseVal()
.head 4 +  If n980 != 980
.head 5 -  Call SalHideWindow(cbSTP)
.head 4 -  ! -- Params
.head 4 -  Set T_1819  = GetGlobalOption('FX_1819')
.head 4 -  Set T_1819S = GetGlobalOption('FX_1819S')
.head 4 -  Set B_1819  = GetGlobalOption('FX_3540')
.head 4 -  Set B_1819N = GetGlobalOption('FX_3540N')
.head 4 -  Set B_1919  = GetGlobalOption('FX_3640')
.head 4 -  Set B_1919N = GetGlobalOption('FX_3640N')
.head 4 -  Set bFxRezid    = GetGlobalOptionEx('FXREZID') = 1
.head 4 -  Set FX_1PBA_R   = GetGlobalOption('FX_1PBA_R')
.head 4 -  Set FX_1PBB_R   = GetGlobalOption('FX_1PBB_R')
.head 4 -  Set FX_1PBA_NR  = GetGlobalOption('FX_1PBA_NR')
.head 4 -  Set FX_1PBB_NR  = GetGlobalOption('FX_1PBB_NR')
.head 4 -  Set strUseTelex = GetGlobalOption('TELEX')
.head 4 -  Set strUseSwift = GetGlobalOption('SWIFT')
.head 4 -  Set FL_SWIFT    = GetGlobalOption('SWIFT_MB') = '1'
.head 4 -  Set nParamNoPrintMO = GetGlobalOptionEx('FX_MO')
.head 4 -  Set BICA   = GetGlobalOption('BICCODE')
.head 4 -  Set KOD_BA = GetGlobalOption('1_PB')
.head 4 -  Set KOD_GA = GetGlobalOption('KOD_G')
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select country into :NGA from bopcount where kodc = :KOD_GA")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 4 -  !
.head 4 -  Call SalDisableWindow(bVPSA)
.head 4 -  Call SalDisableWindow(bVPSB)
.head 4 -  !
.head 4 -  Call F_Prepare()
.head 4 -  Call F_CLEAR()
.head 4 -  Call f_ClearSwap()
.head 1 +  Table Window: BMOD
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Бухгалтерская модель  сделки
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.863"
.head 4 -  Top:    0.719"
.head 4 -  Width:  13.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53262
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53263
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53264
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Оп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лиц.счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредит
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование сч
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Dig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nND
.head 2 +  Window Variables
.head 3 -  Number: nCol
.head 3 -  Window Handle: hCH
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('BMOD.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 5)
.head 4 -  Set BMOD.strFilterTblName = 'ACCOUNTS'
.head 4 -  Set BMOD.strPrintFileName = 'BMOD'
.head 4 -  Set BMOD.strSqlPopulate =
"SELECT o.ref, o.fdat, o.tt,
        decode(o.dk,0,o.s,0)/power(10,t.dig), decode(o.dk,1,o.s,0)/power(10,t.dig),
        o.sos, ACCOUNTS.nms, ACCOUNTS.nls, ACCOUNTS.kv, t.dig 
   INTO :BMOD.REF, :BMOD.FDAT, :BMOD.TT,  :BMOD.SDn, :BMOD.SKn,
        :BMOD.SOS, :BMOD.TXT,  :BMOD.NLS, :BMOD.KV,  :BMOD.Dig
   FROM opldok o, ACCOUNTS, tabval t 
  WHERE ACCOUNTS.acc = o.acc
    AND ACCOUNTS.kv = t.kv
    AND o.ref in " || IifS(nMode=0, "(select ref from mbd_k_r where nd = :nND)", "(select ref from fx_deal_ref where deal_tag = :nND)") || "
  ORDER BY o.fdat, o.ref, o.stmt, o.dk"
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), BMOD.strSqlPopulate  , TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SOS = 1
.head 5 -  Set nCol = COLOR_DarkGreen
.head 4 +  Else If SOS = 5
.head 5 -  Set nCol = COLOR_Black
.head 4 +  Else If SOS = 3
.head 5 -  Set nCol = COLOR_DarkBlue
.head 4 +  Else
.head 5 -  Set nCol = COLOR_DarkGray
.head 4 -  Call SalTblSetCellTextColor(REF,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(FDAT,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(TT,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(SD,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(SK,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(SOS,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(TXT,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(NLS,nCol,FALSE)
.head 4 -  Call SalTblSetCellTextColor(KV,nCol,FALSE)
.head 4 +  If SDn = 0
.head 5 -  Set SDn = NUMBER_Null
.head 4 +  If SKn = 0
.head 5 -  Set SKn = NUMBER_Null
.head 4 -  Set SD = Dig4(SDn * SalNumberPower(10,Dig)/100, Dig, 4 )
.head 4 -  Set SK = Dig4(SKn * SalNumberPower(10,Dig)/100, Dig, 4 )
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Set hCH = SalNumberToWindowHandle( wParam )
.head 4 +  If SalNumberToWindowHandle( wParam ) = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SD ), COL_GetID )
.head 5 -  Set hCH = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SDn ), COL_GetID )
.head 4 +  If SalNumberToWindowHandle( wParam ) = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SK ), COL_GetID )
.head 5 -  Set hCH = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SKn ), COL_GetID )
.head 4 -  Call SalSendClassMessage(SAM_ColumnSelectClick,SalWindowHandleToNumber( hCH ),0)
.head 4 -  !
.head 4 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 1 +  Table Window: FX1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: АРХИВ FOREX-Сделок
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    1.208"
.head 4 -  Width:  17.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSwap
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Угода SWAP
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipSwap')
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Call SalDisableWindow(pbSwap)
.head 6 +  On SAM_Click
.head 7 +  If FX_D
.head 8 +  If SwapTag != NUMBER_Null
.head 9 -  Call SqlPrepareAndExecute(hSql(), "select count(*) into :nSwapCount from fx_deal where swap_tag = :SwapTag")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nSwapCount > 1
.head 10 -  ! Запрещена сделка Swap
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrSwap'),
     CurrentLangTable.GetAtomTitle('FOREX.cTAt'), MB_IconStop)
.head 10 -  Return FALSE
.head 8 +  If not IsWindow(hWin0)
.head 9 -  Set hWin0 = SalCreateWindow(FOREX, hWndForm, 'SWAP')
.head 8 -  Set FOREX.DAT = GetBankDate()
.head 8 -  Set FOREX.cSwap.nSwapTag = FX1.FX_D
.head 8 -  Set FOREX.cSwap.sNTic = FX1.NTIK
.head 8 -  Set FOREX.cSwap.nKvA  = FX1.KVB
.head 8 -  Set FOREX.cSwap.nSumA = FX1.SUMBn * SalNumberPower(10,DigB)
.head 8 -  Set FOREX.cSwap.nKvB  = FX1.KVA
.head 8 -  Set FOREX.cSwap.nSumB = FX1.SUMAn * SalNumberPower(10,DigA)
.head 8 -  Set FOREX.cSwap.sNbB  = FX1.NBB
.head 8 -  Set FOREX.cSwap.sMfoB = FX1.KODB
.head 8 -  Set FOREX.cSwap.sBicB = FX1.KODB
.head 8 -  Set FOREX.cSwap.sInic = STRING_Null
.head 8 -  Set FOREX.sDealType   = 'DSW'
.head 8 -  Set FOREX.nForexDealMode = 2
.head 8 +  If SalMessageBox('Розмітити помісячно платіжний календар ?', 'Інформація', MB_IconAsterisk | MB_YesNo) = IDNO
.head 9 -  Set FOREX.sDealType = 'SWAP'
.head 8 -  Call FOREX.F_SWAP(FOREX.cSwap)
.head 8 -  Call SalEnableWindow(FOREX.cmb_INIC)
.head 8 -  Call SalBringWindowToTop(FOREX)
.head 4 +  Pushbutton: pbTerm
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CALS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Изменение срока
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipTerm')
.head 6 +  ! On SAM_Click
.head 7 +       If FX_D = SwapTag
.head 8 +       If not IsWindow(hWin0)
.head 9 -       Set hWin0 = SalCreateWindow(FOREX, hWndForm, 'SWAP')
.head 8 -       Set FOREX.DAT = GetBankDate()
.head 8 -       Set FOREX.cSwap.nSwapTag = FX1.FX_D
.head 8 -       Set FOREX.cSwap.sNTic = FX1.NTIK
.head 8 -       Set FOREX.cSwap.nKvA  = FX1.KVB
.head 8 -       Set FOREX.cSwap.nSumA = FX1.SUMBn * SalNumberPower(10,DigB)
.head 8 -       Set FOREX.cSwap.nKvB  = FX1.KVA
.head 8 -       Set FOREX.cSwap.nSumB = FX1.SUMAn * SalNumberPower(10,DigA)
.head 8 -       Set FOREX.cSwap.sNbB  = FX1.NBB
.head 8 -       Set FOREX.cSwap.sMfoB = FX1.KODB
.head 8 -       Set FOREX.cSwap.sBicB = FX1.KODB
.head 8 -       Set FOREX.cSwap.sInic = STRING_Null
.head 8 -       Set FOREX.sDealType   = 'DSW'
.head 8 -       Call FOREX.F_SWAP(FOREX.cSwap)
.head 8 -       Call SalEnableWindow(FOREX.cmb_INIC)
.head 8 -       Call SalBringWindowToTop(FOREX)
.head 7 +       Else 
.head 8 -       Call SalMessageBox('Для зміни терміну потрібно відмітити початкову угоду ДЕПО СВОП', 'Інформація', MB_IconAsterisk)
.head 6 +  On SAM_Click
.head 7 -  ! Надо выделить конечную сделку ДЕПО СВОП
.head 7 +  If SwapTag = NUMBER_Null or FX_D = SwapTag
.head 8 -  Call SalMessageBox('Для зміни терміну потрібно відмітити кінцеву угоду СВОП', 'Інформація', MB_IconAsterisk)
.head 8 -  Return FALSE
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select swap_tag into :nSwapTag
   from fx_deal f
  where deal_tag = :FX_D
    and exists (select 1 from fx_deal where deal_tag = f.swap_tag and suma = f.sumb and kva = f.kvb)")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('Для зміни терміну потрібно відмітити кінцеву угоду СВОП', 'Інформація', MB_IconAsterisk)
.head 8 -  Return FALSE
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select count(*) into :i from fx_deal where swap_tag = :nSwapTag and deal_tag not in (:FX_D, :nSwapTag)")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(FOREX, hWndForm, IifS(i=0, 'SWAP', 'DSW'))
.head 7 -  Set FOREX.DAT = GetBankDate()
.head 7 -  Set FOREX.cSwap.nSwapTag = FX1.SwapTag
.head 7 -  Set FOREX.cSwap.sNTic = FX1.NTIK
.head 7 -  Set FOREX.cSwap.nKvA  = FX1.KVA
.head 7 -  Set FOREX.cSwap.nSumA = FX1.SUMAn * SalNumberPower(10,DigA)
.head 7 -  Set FOREX.cSwap.nKvB  = FX1.KVB
.head 7 -  Set FOREX.cSwap.nSumB = FX1.SUMBn * SalNumberPower(10,DigB)
.head 7 -  Set FOREX.cSwap.sNbB  = FX1.NBB
.head 7 -  Set FOREX.cSwap.sMfoB = FX1.KODB
.head 7 -  Set FOREX.cSwap.sBicB = FX1.KODB
.head 7 -  Set FOREX.cSwap.sInic = STRING_Null
.head 7 -  Set FOREX.sDealType   = IifS(i=0, 'SWAP', 'DSW')
.head 7 -  Set FOREX.nForexDealMode = 4
.head 7 -  Call FOREX.F_SWAP(FOREX.cSwap)
.head 7 -  Call SalEnableWindow(FOREX.cmb_INIC)
.head 7 -  Call SalBringWindowToTop(FOREX)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22875
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.683"
.head 6 -  Begin Y:  0.048"
.head 6 -  End X:  7.683"
.head 6 -  End Y:  0.512"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22876
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.45"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  3.45"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 -  Line
.head 5 -  Resource Id: 22877
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Print2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.567"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Edit.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipPrint2')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set NBKA = ''
.head 8 -  Set NBKB = ''
.head 8 +  If REFA != NUMBER_Null 
.head 9 -  If SqlPrepareAndExecute(hSqlAux2(), "SELECT substr(NAM_A,1,32) INTO :NBKA FROM OPER where ref=:REFA")
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 8 +  If REFB != NUMBER_Null
.head 9 -  If SqlPrepareAndExecute(hSqlAux2(), 
"SELECT substr(s.NAME,1,32)
   INTO :NBKB FROM sw_banks s, operw w
  WHERE w.ref=:REFB and w.tag='54' and w.value=s.bic")
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 9 -  If SqlPrepareAndExecute(hSqlAux2(), "SELECT o.nlsb , o.ID_B INTO :NLSB, :OKPOB FROM oper o WHERE o.ref=:REFB")
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 8 +  If REF  != NUMBER_Null
.head 9 -  If SqlPrepareAndExecute(hSqlAux2(), 
"SELECT nls INTO :NLSA FROM opl WHERE ref=:REF and kv=:KVA and tt='FX2' and dk=0")
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 9 -  If SqlPrepareAndExecute(hSqlAux2(), "SELECT pdat INTO :TIME FROM oper WHERE ref=:REF") 
and  SqlFetchNext(hSqlAux2(),  nFetchRes) 
.head 8 -  Set sTmp = Str(REF) || '~' || NTIK || '~'
.head 8 -  Set sTmp = sTmp || SalFmtFormatDateTime(DAT,'dd/MM/yyyy')  || '~'
.head 8 -  Set sTmp = sTmp || SalFmtFormatDateTime(TIME,'hhh:mm:ss')  || '~'
.head 8 -  Set sTmp = sTmp || SalFmtFormatDateTime(DATA,'dd/MM/yyyy') || '~'
.head 8 -  Set sTmp = sTmp || SalFmtFormatDateTime(DATB,'dd/MM/yyyy') || '~'
.head 8 -  Set sTmp = sTmp || Str(KVA) || '~' || Str(KVB) || '~'
.head 8 -  Set sTmp = sTmp || SalNumberToStrX(SUMAn,DigA) || '~' || SalNumberToStrX(SUMBn,DigA) || '~'
.head 8 -  Set sTmp = sTmp || SalNumberToStrX(SUMAn/SUMBn,8) || '~' || SalNumberToStrX(SUMBn/SUMAn,8) || '~'
.head 8 -  !
.head 8 -  Set sTmp = sTmp || Subs(NBB,1,32) || '~' || NBKA || '~'
.head 8 -  Set sTmp = sTmp || Subs(NBKB,1,32) || '~' || Subs(GetBankName(),1,32) || '~'
.head 8 -  Set sTmp = sTmp || NLSA || '~' || IifS(KVB=n980,NLSB,'') || '~' || IifS(KVA=n980,GetBankMfo(),BICA) || '~'
.head 8 -  Set sTmp = sTmp || KODB || '~' || Str(GetBankOkpo()) || '~' || OKPOB
.head 8 -  ! Call Debug('1='||sTmp)
.head 8 -  ! Call F_PRINT(sTmp, REF, REFD, REFA, REFB, REFB2, REFA_SPTOD, REFB_SPTOD, REFB2_SPTOD)
.head 8 -  Call F_PRINT(FX_D, sTmp)
.head 8 -  Call DocsPrint(REFB, 'OPER',0)
.head 8 +  If REFB2 != NUMBER_Null
.head 9 -  Call DocsPrint(REFB2, 'OPER',0)
.head 4 +  Pushbutton: pb_Buch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipBuch')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hBMOD)
.head 8 -  ! Set hBMOD = SalCreateWindow(BMOD, hWndMDI, REF, REFA, REFB, REFB2, REFD, REFA_SPTOD, REFB_SPTOD, REFB2_SPTOD)
.head 8 -  Set hBMOD = SalCreateWindow(BMOD, hWndMDI, 1, FX_D)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( BMOD )
.head 4 +  Pushbutton: pbPrintDeal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Печать договора'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipPrintDeal')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call PrintDeal(hWndForm.FX1.FX_D)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Документы по сделке
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipDetails')
.head 4 +  Pushbutton: pb_A
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.333"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр Документа на вал-А
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipA')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REFA)
.head 4 +  Pushbutton: pb_F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.767"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Relation.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр Документа на FOREX
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipF')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REF)
.head 4 +  Pushbutton: pb_B
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр Документа-1 на вал-Б
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipB')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REFB)
.head 4 +  Pushbutton: pb_B2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.633"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр Документа-2 на вал-Б
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipB2')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REFB2)
.head 4 +  Pushbutton: pbEdit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\resource\bmp\BACK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Для выбранной строки вызываем форму редактирования
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) 
.head 8 -  Call SalCreateWindow(FXUPD, hWndForm, 0, FX_D, '', '')
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  ! Изменение параметров договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipEdit')
.head 4 -  !
.head 4 +  Pushbutton: pbCreateSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.817"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\TOMAIL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Сформировать SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipCreateSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 +  If SqlPLSQLCommand( hSql(), "SWIFT.Gen3xxMsg(300,FX_D)" )
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! Call SalMessageBox( 'Сформировано SWIFT сообщение', 'Внимание!', MB_Ok )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgCreateSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbCreateTELEX
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\resource\bmp\CHKMAIL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Print/View/Update TELEX'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 -  Call F_dlg_TELEX (FX_D, 1)  
.head 4 +  Pushbutton: pbILinkSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tou.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Привязать входящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipILinkSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 -  Set nSWRef= SWIFTMsgSel(hWndForm, "V_SW300_HEADER", "receiver='"||KODB||"' AND io_ind='O'")
.head 8 +  If nSWRef != 0
.head 9 +  If SqlPLSQLCommand( hSql(), "SWIFT.Link3XXMsg(300,nSWRef,FX_D,'O')")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  ! Call SalMessageBox( 'Привязано SWIFT сообщение', 'Внимание!', MB_Ok )
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgLinkSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbIUnLinkSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.233"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR2TOD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Отвязать входящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipIUnLinkSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 +  If SqlPLSQLCommand( hSql(), "SWIFT.UnLink3XXMsg(300,NUMBER_Null,FX_D,'O')" )
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! Call SalMessageBox( 'Отвязано SWIFT сообщение', 'Внимание!', MB_Ok )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgUnLinkSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbIViewSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Просмотреть входящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipIViewSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 +  If SWIREF != NUMBER_Null
.head 9 -  Call SWIFTMsgView( hWndForm, SWIREF )
.head 8 +  Else
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgNotSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 4 +  Pushbutton: pbOLinkSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.25"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOU.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Привязать исходящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipOLinkSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 -  Set nSWRef= SWIFTMsgSel(hWndForm, "V_SW300_HEADER", "receiver='"||KODB||"' AND io_ind='I'")
.head 8 +  If nSWRef != 0
.head 9 +  If SqlPLSQLCommand( hSql(), "SWIFT.Link3XXMsg(300,nSWRef,FX_D,'I')")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  ! Call SalMessageBox( 'Привязано SWIFT сообщение', 'Внимание!', MB_Ok )
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgLinkSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbOUnLinkSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.7"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Отвязать исходящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipOUnLinkSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 +  If SqlPLSQLCommand( hSql(), "SWIFT.UnLink3XXMsg(300,NUMBER_Null,FX_D,'I')" )
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! Call SalMessageBox( 'Отвязано SWIFT сообщение', 'Внимание!', MB_Ok )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgUnLinkSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbOViewSWT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Просмотреть исходящее SWIFT сообщение'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX1.cBTipOViewSWT')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0) 
.head 8 +  If SWOREF != NUMBER_Null
.head 9 -  Call SWIFTMsgView( hWndForm, SWOREF )
.head 8 +  Else
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('FX1.cTMsgNotSWT'), 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
.head 4 -  Line
.head 5 -  Resource Id: 38736
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  11.683"
.head 6 -  Begin Y:  0.536"
.head 6 -  End X:  11.683"
.head 6 -  End Y:  0.024"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  ! cTBarButton: pbZalog
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.8"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +         Message Actions 
.head 6 +         On SAM_Create
.head 7 -  ! Новые Договора ОБЕСПЕЧЕНИЯ на выбранный договор РАЗМЕЩЕНИЯ
.head 7 -         Set strTip = 'Новые Договора ОБЕСПЕЧЕНИЯ на выбранный договор РАЗМЕЩЕНИЯ'
.head 6 +         On SAM_Click
.head 7 +         If NETTO.ACC > 0
.head 8 -         Call Sel017(hWndMDI, 30, 2, NETTO.ND, NUMBER_Null, Str(RNK), NETTO.ACC)
.head 4 +  Pushbutton: pbZalog_All
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.85"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Существующие Договора ОБЕСПЕЧЕНИЯ на выбранный договор РАЗМЕЩЕНИЯ
.head 7 -  Set strTip = 'Существующие Договора ОБЕСПЕЧЕНИЯ на выбранный договор РАЗМЕЩЕНИЯ'
.head 6 +  On SAM_Click
.head 7 +  If FX_D = SwapTag
.head 8 -  Call SqlPrepareAndExecute(hSql(), "select acc into :nAcc from accounts where nls = :FX_3540 and kv = :KVB")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call Sel017(hWndMDI, 30, 11, NUMBER_Null, STRING_Null, Str(RNK), nAcc)
.head 4 +  ! cTBarButton: pbZ
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.end
.head 5 +         Message Actions 
.head 6 +         On SAM_Create
.head 7 -  ! Связь Договоров ОБЕСПЕЧЕНИЯ и выбранного договора РАЗМЕЩЕНИЯ
.head 7 -         Set strTip = 'Связь Договоров ОБЕСПЕЧЕНИЯ и выбранного договора РАЗМЕЩЕНИЯ'
.head 6 +         On SAM_Click
.head 7 -         Call Bars017r1(NUMBER_Null, NUMBER_Null, NUMBER_Null,
" and KU_109.ACCK in (select acc from nd_acc where nd=" || Str(NETTO.ND) || " )")
.head 4 -  Line
.head 5 -  Resource Id: 34028
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  12.45"
.head 6 -  Begin Y:  0.56"
.head 6 -  End X:  12.45"
.head 6 -  End Y:  0.048"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: SwapTag
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.
SWAP
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FX_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид 
FOREX
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
FOREX
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NTIK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
тикета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф 
осн-1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф 
осн
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал А 
покупка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма  А 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RATEA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %%
ставка
А
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма  вал.,
купл. 
для клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMCn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф 
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал Б
продажа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMBn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RATEB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %%
ставка
Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMPF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
сбора
в ПФ
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф-1 
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф-2
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
угоди
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KODB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BIC / МФО
партнера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NBB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование 
партнера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOSB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DigA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DigB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SWIREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SWOREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFA_SPTOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф 
А-спот
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB_SPTOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф-1
В--спот
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB2_SPTOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф-2 
В--спот
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMPA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Форвард
Сума переоцiнки
вал А
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: SUMPAn
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -                                                     List Values 
.head 4 -                                                     Message Actions 
.head 3 +  Column: SUMPB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Форвард
Сума переоцiнки
вал Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: SUMPBn
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -                                                     List Values 
.head 4 -                                                     Message Actions 
.head 3 +  Column: SUMP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Форвард
Доходи(+)витрати(-)
вiд переоцiнки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: SUMPn
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -                                                     List Values 
.head 4 -                                                     Message Actions 
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РНК
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: F_DELE
.head 4 -                                                                                                                                                                                Description: 
.head 4 +                                                                                                                                                                                Returns 
.head 5 -                                                                                                                                                                                Boolean: 
.head 4 +                                                                                                                                                                                Parameters 
.head 5 -                                                                                                                                                                                Number: nRef
.head 4 -                                                                                                                                                                                Static Variables 
.head 4 +                                                                                                                                                                                Local variables 
.head 5 -                                                                                                                                                                                Number: nStatus
.head 5 -                                                                                                                                                                                Number: nUserId
.head 5 -                                                                                                                                                                                String: strHexMark2Ret
.head 4 +                                                                                                                                                                                Actions 
.head 5 +                                                                                                                                                                                If Pay_Bck(nRef, 5, '')
.head 6 -                                                                                                                                                                                Set nStatus=3
.head 6 -                                                                                                                                                                                Set nUserId=GetUserId()
.head 6 -                                                                                                                                                                                Set strHexMark2Ret =
    SalStrTrimX(tblDocList.colChk) ||
    SalStrRightX('00' ||
    NumberToHexSX(nCheckId), 2) ||
    SalStrRightX('0000' ||
    NumberToHexSX(GetUserId()), 4)
.head 6 +                                                                                                                                                                                If SqlPrepareAndExecute(hSql(), '
     UPDATE oper
     SET chk=:strHexMark2Ret,
         nazn=:sStornoReason
     WHERE ref=:nRef')
.head 7 +                                                                                                                                                                                If SqlPrepareAndExecute(hSql(), '
 INSERT INTO oper_visa VALUES(:tblDocList.colRef,sysdate,:nUserId,:nCheckId,:nStatus)')
.head 8 -                                                                                                                                                                                Call SqlCommit( hSql())
.head 7 +                                                                                                                                                                                Else 
.head 8 -                                                                                                                                                                                Call Debug('Ош. INSERT INTO oper_visas')
.head 8 -                                                                                                                                                                                Call SqlRollback(hSql())
.head 6 +                                                                                                                                                                                Else 
.head 7 -                                                                                                                                                                                Call Debug('Ош. UPDATE oper')
.head 5 +                                                                                                                                                                                Else 
.head 6 -                                                                                                                                                                                Return FALSE
.head 2 +  Window Parameters
.head 3 -  String: sFilter
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  String: FX_3540
.head 3 -  Boolean: FL
.head 3 -  Number: nSos
.head 3 -  String: sTmp
.head 3 -  Number: nAcc
.head 3 -  String: NBKA
.head 3 -  String: NBKB
.head 3 -  String: NLSB
.head 3 -  String: NLSA
.head 3 -  String: OKPOB
.head 3 -  String: BICA
.head 3 -  Date/Time: TIME
.head 3 -  String: sStornoReasonId
.head 3 -  String: sStornoReason
.head 3 -  Window Handle: hCH
.head 3 -  String: sSWRef 
.head 3 -  Number: nSWRef
.head 3 -  ! Признаки работы SWIFT TELEX
.head 3 -  String: strUseTelex
.head 3 -  String: strUseSwift
.head 3 -  Number: nSwapCount
.head 3 -  Number: i
.head 3 -  Number: nSwapTag
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, AppVersion || CurrentLangTable.GetAtomTitle('FX1.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  !
.head 4 -  Set FX1.n980    = GetBaseVal()
.head 4 -  Set FX1.BICA    = GetGlobalOption('BICCODE')
.head 4 -  Set FX1.FX_3540 = GetGlobalOption('FX_3540')
.head 4 -  ! Открываем/Закрываем кнопки в зависимости от установленных опция (SWIFT/TELEX)
.head 4 -  Set strUseTelex = GetGlobalOption('TELEX')
.head 4 -  Set strUseSwift = GetGlobalOption('SWIFT')
.head 4 +  If strUseTelex != '1'
.head 5 -  Call SalDisableWindow(pbCreateTELEX)
.head 4 +  If strUseSwift != '1'
.head 5 -  Call SalDisableWindow(pbCreateSWT)
.head 5 -  Call SalDisableWindow(pbILinkSWT)
.head 5 -  Call SalDisableWindow(pbIUnLinkSWT)
.head 5 -  Call SalDisableWindow(pbIViewSWT)
.head 5 -  Call SalDisableWindow(pbOLinkSWT)
.head 5 -  Call SalDisableWindow(pbOUnLinkSWT)
.head 5 -  Call SalDisableWindow(pbOViewSWT)
.head 4 -  !
.head 4 -  Call SalHideWindow(REFD)
.head 4 +  If not GetGlobalOption('FX_SPTOD')
.head 5 -  Call SalHideWindow(REFA_SPTOD)
.head 5 -  Call SalHideWindow(REFB_SPTOD)
.head 5 -  Call SalHideWindow(REFB2_SPTOD)
.head 4 -  Call SalTblSetLockedColumns(hWndForm,5)
.head 4 -  !
.head 4 -  Set FX1.fFilterAtStart   = TRUE
.head 4 -  Set FX1.strFilterTblName = 'FX_DEAL'
.head 4 -  Set FX1.strPrintFileName = 'FX_DEAL'
.head 4 -  Set FX1.strSqlPopulate =
"SELECT DEAL_TAG, NTIK, KVA, SUMA/power(10,ta.dig), KVB, SUMB/power(10,tb.dig), 
        ref, refa, refb, refb2, ref1, refa_sptod, refb_sptod, refb2_sptod, 
        kodb, ta.dig, tb.dig, swi_ref, swo_ref, sumpa/100, sumpb/100, sump/100, swap_tag,
        fx_deal.rnk, c.okpo, b.mfo, FX_DEAL.DAT, FX_DEAL.DAT_A, FX_DEAL.DAT_B,
        round(decode(curr_base,'A',sumb/suma,'B',suma/sumb,greatest(suma,sumb)/least(suma,sumb)),4),
        sumc/power(10,ta.dig), 
        case when FX_DEAL.swap_tag is not null and FX_DEAL.acc9a is not null then get_int_rate(FX_DEAL.acc9a,FX_DEAL.dat) else null end,
        case when FX_DEAL.swap_tag is not null and FX_DEAL.acc9b is not null then get_int_rate(FX_DEAL.acc9b,FX_DEAL.dat) else null end
   INTO :FX1.FX_D, :FX1.NTIK, :FX1.KVA, :FX1.SUMAn, :FX1.KVB, :FX1.SUMBn, 
        :FX1.REF, :FX1.REFA, :FX1.REFB, :FX1.REFB2, :FX1.REFD,
        :FX1.REFA_SPTOD, :FX1.REFB_SPTOD, :FX1.REFB2_SPTOD, 
        :FX1.KODB, :FX1.DigA, :FX1.DigB, :FX1.SWIREF, :FX1.SWOREF, :FX1.SUMPA, :FX1.SUMPB, :FX1.SUMP, :FX1.SwapTag,
        :FX1.RNK, :FX1.OKPO, :FX1.MFO, :FX1.DAT, :FX1.DATA, :FX1.DATB, :FX1.KURS, :FX1.SUMCn, :FX1.RATEA, :FX1.RATEB
   FROM FX_DEAL, tabval ta, tabval tb, customer c, custbank b
  WHERE FX_DEAL.kva = ta.kv AND FX_DEAL.kvb = tb.kv
    and fx_deal.rnk = c.rnk(+) 
    and fx_deal.rnk = b.rnk(+) " || IifS(sFilter='', "", " and (" || sFilter || ")") || "
  ORDER by deal_tag desc, DAT, kodb, KVA, KVB"
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 +  If strSqlPopulate != ''
.head 5 +  If fFilterAtStart
.head 6 +  If SetQueryFilter( cF )
.head 7 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT fFilterAtStart
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 6 -  Call BindList.ActivateBinds()
.head 6 -  Call SalTblPopulate(hWndForm, cMain.hSql(), (strDSql), nTabPopulateMethod)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  Else
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set SOS   = 0
.head 4 -  Set SOSA  = 0
.head 4 -  Set SOSB  = 0
.head 4 -  Set SOSB2 = 0
.head 4 +  If FX1.REF
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT o.sos INTO :FX1.nSos FROM oper o WHERE o.ref=:FX1.REF" )
and SqlFetchNext(hSqlAux2(),  nFetchRes) 
.head 6 -  Set SOS = nSos
.head 6 +  If FX1.nSos = 1
.head 7 -  Set FX1.nSos = COLOR_DarkGreen
.head 6 +  Else If FX1.nSos = 5
.head 7 -  Set FX1.nSos = COLOR_Black
.head 6 +  Else If FX1.nSos = 3
.head 7 -  Set FX1.nSos = COLOR_Blue
.head 6 +  Else
.head 7 -  Set FX1.nSos=COLOR_Red
.head 6 -  Call SalTblSetCellTextColor( FX1.REF, FX1.nSos, FALSE)
.head 4 -  !
.head 4 +  If REFD != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT sos INTO :FX1.nSos FROM oper WHERE ref=:FX1.REFD " ) 
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 6 +  If FX1.nSos = 1
.head 7 -  Set FX1.nSos = COLOR_DarkGreen
.head 6 +  Else If FX1.nSos = 5
.head 7 -  Set FX1.nSos = COLOR_Black
.head 6 +  Else If FX1.nSos = 3
.head 7 -  Set FX1.nSos = COLOR_Blue
.head 6 +  Else
.head 7 -  Set FX1.nSos = COLOR_Red
.head 6 -  Call SalTblSetCellTextColor(FX1.REFD, FX1.nSos, FALSE)
.head 4 -  !
.head 4 +  If REFA != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT sos INTO :FX1.nSos FROM oper WHERE ref=:FX1.REFA " ) 
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 6 -  Set SOSA = nSos
.head 6 +  If FX1.nSos = 1
.head 7 -  Set FX1.nSos = COLOR_DarkGreen
.head 6 +  Else If FX1.nSos = 5
.head 7 -  Set FX1.nSos = COLOR_Black
.head 6 +  Else If FX1.nSos = 3
.head 7 -  Set FX1.nSos = COLOR_Blue
.head 6 +  Else
.head 7 -  Set FX1.nSos = COLOR_Red
.head 6 -  Call SalTblSetCellTextColor(FX1.REFA, FX1.nSos, FALSE)
.head 4 -  !
.head 4 +  If REFB != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT sos INTO :FX1.nSos FROM oper WHERE ref=:FX1.REFB" ) 
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 6 -  Set SOSB = nSos
.head 6 +  If FX1.nSos = 1
.head 7 -  Set FX1.nSos = COLOR_DarkGreen
.head 6 +  Else If FX1.nSos = 5
.head 7 -  Set FX1.nSos = COLOR_Black
.head 6 +  Else If FX1.nSos = 3
.head 7 -  Set FX1.nSos = COLOR_Blue
.head 6 +  Else
.head 7 -  Set FX1.nSos = COLOR_Red
.head 6 -  Call SalTblSetCellTextColor(FX1.REFB, FX1.nSos, FALSE)
.head 4 -  !
.head 4 +  If REFB2 != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT sos INTO :FX1.nSos FROM oper WHERE ref=:FX1.REFB2" ) 
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 6 -  Set SOSB2 = nSos
.head 6 +  If FX1.nSos = 1
.head 7 -  Set FX1.nSos = COLOR_DarkGreen
.head 6 +  Else If FX1.nSos = 5
.head 7 -  Set FX1.nSos = COLOR_Black
.head 6 +  Else If FX1.nSos = 3
.head 7 -  Set FX1.nSos = COLOR_Blue
.head 6 +  Else
.head 7 -  Set FX1.nSos = COLOR_Red
.head 6 -  Call SalTblSetCellTextColor(FX1.REFB2, FX1.nSos, FALSE)
.head 4 -  !
.head 4 +  If FX1.KVB = FX1.n980
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "SELECT substr(nb,1,32) INTO :FX1.NBB FROM banks WHERE mfo=:FX1.KODB") 
.head 6 -  Call SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "select s/power(10,:DigB) into :SUMPF from opldok where ref = :REF and tt = 'PS1' and dk = 1")
.head 6 -  Call SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 4 +  Else
.head 5 -  If SqlPrepareAndExecute(hSqlAux2(), "SELECT substr(name,1,32) INTO :FX1.NBB FROM sw_banks WHERE bic=:FX1.KODB " )
.head 5 +  If not SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(), 
"SELECT substr(b.nb,1,32) INTO :FX1.NBB 
   FROM banks b, forex_alien f
  WHERE b.mfo=f.mfo and f.bic=:FX1.KODB " ) 
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 4 -  Set SUMA = Dig4(SUMAn * SalNumberPower(10,DigA)/100, DigA, 4)
.head 4 -  Set SUMB = Dig4(SUMBn * SalNumberPower(10,DigB)/100, DigB, 4)
.head 4 -  Set SUMC = IifS(SUMCn=NUMBER_Null, '', Dig4(SUMCn  * SalNumberPower(10,DigA)/100, DigA, 4))
.head 4 -  ! Set SUMPA = Dig4(SUMPAn * 100, 2, 2)
.head 4 -  ! Set SUMPB = Dig4(SUMPBn * 100, 2, 4)
.head 4 -  ! Set SUMP  = Dig4(SUMPn  * 100, 2, 4)
.head 4 +  If FX1.SwapTag
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255,255,190))
.head 3 +  On SAM_DoubleClick
.head 4 -  ! Документы по сделке FX_D
.head 4 -  Call DocViewListInt(hWndMDI, "a.ref in (select ref from fx_deal_ref where deal_tag=" || Str(FX_D) || ")", 
     CurrentLangTable.GetAtomTitle('FX1.cBTipDetails') || " " || Str(FX_D))
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Set hCH = SalNumberToWindowHandle( wParam )
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMA), COL_GetID)
.head 5 -  Set hCH = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMAn), COL_GetID)
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMB), COL_GetID)
.head 5 -  Set hCH = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMBn), COL_GetID)
.head 4 +  ! If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMPA), COL_GetID)
.head 5 -                                                     Set hCH = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMPAn), COL_GetID)
.head 4 +  ! If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMPB), COL_GetID)
.head 5 -                                                     Set hCH = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMPBn), COL_GetID)
.head 4 +  ! If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMP), COL_GetID)
.head 5 -                                                     Set hCH = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(SUMPn), COL_GetID)
.head 4 -  Call SalSendClassMessage(SAM_ColumnSelectClick,SalWindowHandleToNumber(hCH),0)
.head 4 -  !
.head 4 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 1 +  Table Window: FX2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет неттинга незавизированных FOREX сделок
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.65"
.head 4 -  Top:    1.375"
.head 4 -  Width:  13.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3956
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.867"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.317"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3957
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3958
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Summ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FX2.cBTipSumm')
.head 6 +  On SAM_Click
.head 7 -  Set FL= not FL
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 2 +  Contents
.head 3 +  Column: KODB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BIC / МФО
партнера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал 
платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ож.Сумма 
поступлений
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMAn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ож.Сумма
отправок
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMBn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
сжатых
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: DATP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
валютирования
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FX_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид 
FOREX
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NTIK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
тикета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
поступл
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф 
отправки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Dig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: s980
.head 3 -  Boolean: FL
.head 3 -  Date/Time: bDat
.head 3 -  Window Handle: hCH
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  !
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('FX2.cTWndTitle')  )
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns(hWndForm,4)
.head 4 -  Set FX2.strFilterTblName = 'FX_DEAL'
.head 4 -  Set FX2.strPrintFileName = 'FX_NETTO'
.head 4 -  Set FX2.s980=Str(GetBaseVal())
.head 4 -  Set FL=TRUE
.head 4 -  Set bDat=GetBankDate()
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If FL
.head 5 -  Set FX2.strSqlPopulate=
"SELECT f.kodb, f.kva, f.suma/power(10,t.dig), f.REFA, To_Number(null), To_Number(null), 
        f.dat_a, f.DEAL_TAG, f.NTIK, t.dig 
 INTO :FX2.KODB, :FX2.KV, :FX2.SUMAn, :FX2.REFA, :FX2.SUMBn, :FX2.REFB, 
      :FX2.DATP, :FX2.FX_D, :FX2.NTIK, :FX2.Dig 
 FROM FX_DEAL f, oper o, ref_que r, tabval t 
 WHERE o.ref  = r.ref AND 
       o.vdat<= :bDat AND 
       o.sos in (1,3) AND   
       f.refA = o.ref AND 
       f.kva<>"||FX2.s980 ||" AND 
       f.kva=t.kv 
 UNION ALL 
 SELECT f.kodb, f.kvb, To_Number(null), To_Number(null), f.sumb/power(10,t.dig), f.REFB, 
        f.dat_b, f.DEAL_TAG, f.NTIK, t.dig 
 FROM FX_DEAL f, oper o, ref_que r, tabval t 
 WHERE o.ref  = r.ref AND 
       o.vdat<= :bDat AND 
       o.sos in (1,3) AND   
       f.refB = o.ref AND 
       f.kvb<>"||FX2.s980 ||" AND 
       f.kvb=t.kv 
ORDER BY 1, 2, 3,4 "
.head 5 -  Call SalHideWindow( FX2.KOL )
.head 5 -  Call SalShowWindow( FX2.DATP )
.head 5 -  Call SalShowWindow( FX2.FX_D )
.head 5 -  Call SalShowWindow( FX2.NTIK )
.head 5 -  Call SalShowWindow( FX2.REFA )
.head 5 -  Call SalShowWindow( FX2.REFB )
.head 4 +  Else
.head 5 -  Set FX2.strSqlPopulate=
"SELECT KODB, KV, Sum(S)/power(10,dig), count(*), dig
 INTO :FX2.KODB,:FX2.KV,:FX2.SUMAn, :FX2.KOL, :FX2.Dig 
 FROM 
 (SELECT f.kodb KODB, f.kva KV, f.suma S, t.dig 
  FROM FX_DEAL f, oper o, ref_que r, tabval t 
  WHERE o.ref  = r.ref AND 
        o.vdat<= :bDat AND 
        o.sos in (1,3) AND  
        f.refA = o.ref AND 
        f.kva<>"||FX2.s980 ||" AND 
        f.kva=t.kv 
  UNION ALL 
  SELECT f.kodb, f.kvb, -f.sumb, t.dig 
  FROM FX_DEAL f, oper o, ref_que r, tabval t 
  WHERE  o.ref  = r.ref AND 
         o.vdat<= :bDat AND 
         o.sos in (1,3) AND  
         f.refB = o.ref AND 
         f.kvb<>"||FX2.s980 ||" AND 
         f.kvb=t.kv 
 )
  GROUP BY KODB,KV, dig ORDER BY KODB,KV "
.head 5 -  Call SalShowWindow( FX2.KOL )
.head 5 -  Call SalHideWindow( FX2.DATP )
.head 5 -  Call SalHideWindow( FX2.FX_D )
.head 5 -  Call SalHideWindow( FX2.NTIK )
.head 5 -  Call SalHideWindow( FX2.REFA )
.head 5 -  Call SalHideWindow( FX2.REFB )
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), FX2.strSqlPopulate , TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If not FL
.head 5 +  If SUMAn<0
.head 6 -  Set SUMBn=-SUMAn
.head 6 -  Set SUMAn=NUMBER_Null
.head 4 -  Set SUMA = Dig4( SUMAn * SalNumberPower(10,Dig)/100, Dig, 4 )
.head 4 -  Set SUMB = Dig4( SUMBn * SalNumberPower(10,Dig)/100, Dig, 4 )
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Set hCH = SalNumberToWindowHandle( wParam )
.head 4 +  If SalNumberToWindowHandle( wParam ) = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SUMA ), COL_GetID )
.head 5 -  Set hCH = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SUMAn ), COL_GetID )
.head 4 +  If SalNumberToWindowHandle( wParam ) = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SUMB ), COL_GetID )
.head 5 -  Set hCH = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( SUMBn ), COL_GetID )
.head 4 -  Call SalSendClassMessage(SAM_ColumnSelectClick,SalWindowHandleToNumber( hCH ),0)
.head 4 -  !
.head 4 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 1 +  Dialog Box: dlg_TELEX
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр - редактирование TELEX
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.717"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.476"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: ml_TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.155"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk	! Сохранить
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Save
.head 4 -  Window Location and Size
.head 5 -  Left:   1.583"
.head 5 -  Top:    4.571"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If sTiket1 ! = ml_TXT
.head 7 -  Set sTiket1  = ml_TXT
.head 7 +  If SqlPrepare( hSql(), 
"UPDATE BARS.TELEX_FILE
 set telex = :sTiket1 
 where nd=:nDealTag and ins=:nIns ")
and SqlSetLongBindDatatype(1, BLOB_BYTE)
and SqlExecute(hSql())
.head 8 -  Call SalFileClose( hFile )
.head 8 -  Call SqlCommitEx(hSql(), "TELEX модифицирован "|| Str(nDealTag) )
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Print
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    4.571"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\PRINT.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strReport = GetPrnDir()||'\\TL'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || Str(SalDateDay(SalDateCurrent())), 2)
.head 6 +  If SalFileOpen( hFile, strReport, 1 )
.head 7 -  Call SalFileWrite( hFile, sTiket1, SalStrLength(sTiket1) )
.head 7 -  Call SalFileClose( hFile )
.head 7 -  Call DosDirectPrint(strReport)
.head 6 +  Else
.head 7 -  Call MessageNoWait("Неможливо відкрити файл для відтворення TELEX ! "||strReport ,'',2,1)
.head 7 -  Return FALSE
.head 3 +  Pushbutton: pbClose	! Отменить
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Exit
.head 4 -  Window Location and Size
.head 5 -  Left:   4.183"
.head 5 -  Top:    4.571"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 +  ! cPushButtonLabeled: pbCreate	! Создать из архива
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Create
.head 4 -  Window Location and Size
.head 5 -  Left:   2.883"
.head 5 -  Top:    4.571"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: C:\bars98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +                                                                                               Message Actions 
.head 5 +                                                                                               On SAM_Click
.head 6 -                                                                                               Call F_TELEX()
.head 6 -                                                                                               Call F_READ()
.head 2 +  Functions
.head 3 +  ! Function: F_TELEX
.head 4 -                                                                                               Description: 
.head 4 -                                                                                               Returns 
.head 4 -                                                                                               Parameters 
.head 4 -                                                                                               Static Variables 
.head 4 +                                                                                               Local variables 
.head 5 -                                                                                               String: strTempl
.head 5 -                                                                                               String: strReport 
.head 5 -                                                                                               String: sQRD
.head 5 -                                                                                               String: sTmp
.head 5 -                                                                                               String: sTmp1
.head 5 -                                                                                               File Handle: hFile
.head 5 -                                                                                               Long String: sTiket
.head 5 -  !
.head 5 -                                                                                               String: sRelMsgRef
.head 5 -                                                                                               Number: n980
.head 5 -                                                                                               Number: nRat
.head 5 -                                                                                               Number: nSA
.head 5 -                                                                                               Number: nSB
.head 5 -                                                                                               Number: nSWRef
.head 5 -                                                                                               String: TLXNUM_ ! № телекса
.head 5 -                                                                                               String: TO_     ! Партнер (БИК, МФО, Наименов)
.head 5 -                                                                                               String: ATTIN_  ! № ген.угоды + Датв ген.угоды + № тикета
.head 5 -                                                                                               String: P20_ ! Наш внутр реф (АБС)
.head 5 -                                                                                               String: P21_ ! SWIFT-реф партнера, который мы встречно получили (если он есть)
.head 5 -                                                                                               String: P30_  ! Даты сделки
.head 5 -                                                                                               String: P32R_ ! Дата- вал-сумма А
.head 5 -                                                                                               String: P57A1_
.head 5 -                                                                                               String: P57A2_
.head 5 -                                                                                               String: P57B1_
.head 5 -                                                                                               String: P57B2_
.head 5 -                                                                                               String: P57B3_
.head 5 -                                                                                               String: P57B4_
.head 5 -                                                                                               String: P33P_ ! Дата- вал-сумма Б
.head 5 -  !
.head 5 -                                                                                               String: P17_
.head 5 -                                                                                               String: P32_  ! вал-сумма МБК
.head 5 -                                                                                               String: sMFO
.head 5 -                                                                                               String: P14_ ! % basa P57A_1_1
.head 5 -                                                                                               String: P57A_1_1 ! Счет для поступлений
.head 5 -                                                                                               String: P57A_1_2 ! BIC (MFO) для поступлений
.head 5 -                                                                                               String: P57A_2_1 ! Счет для отправки
.head 5 -                                                                                               String: P57A_2_2 ! BIC (MFO) для отправки
.head 5 -                                                                                               String: P57A_2_3 ! Наименование для отправки
.head 5 -                                                                                               String: P57A_2_4 ! ОКПО для отправки
.head 4 +                                                                                               Actions 
.head 5 -                                                                                               Set n980 = GetBaseVal()
.head 5 -                                                                                               Set sMFO = GetBankMfo()
.head 5 -  ! имя шаблона 
.head 5 -                                                                                               Set strTempl = GetTemplateDir()|| IifS( nIns=1, '\\tlx_300.qrd', '\\tlx_320.qrd')
.head 5 -  ! имя исх файла
.head 5 -                                                                                               Set strReport =
GetPrnDir()||'\\TL'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || SalNumberToStrX(SalDateDay(SalDateCurrent()), 0), 2)
.head 5 -  ! переменные в шаблоне 
.head 5 -                                                                                               Set sQRD = 
'TLXNUM_~FROM_~TO_~DATE_~ATTIN_~MT_~P20_~P21_~P22_~'|| IifS
( nIns=1,
'P30_~P36_~P32R_~P57A1_~P57A2_~P57A3_~P57A4_~P33P_~P57B1_~P57B2_~P57B3_~P57B4_',
'P82_~P87_~P17_~P30_~P32_~P34_~P37_~P14_~P57A_1_1~P57A_1_2~P57A_1_3~P57A_1_4~P57A_2_1~P57A_2_2~P57A_2_3~P57A_2_4'
)
||'~TELL_~PODP_'
.head 5 -  ! Вычитка данных
.head 5 +                                                                                               If nIns=1
.head 6 -                                                                                               If SqlPrepareAndExecute( hSqlAux2(),
"SELECT d.telexnum,  d.swi_ref,  substr(d.KODB ||' '||nvl(a.NAME,' '),1,60), 
        d.agrmnt_num|| ' '||to_char(d.agrmnt_date,'dd/mm/yyyy')|| '   REF: ' || d.NTIK ,
        to_char(d.ref),
        to_char(d.DAT,'dd/mm/yyyy'),
        decode (d.curr_base,'A', d.SUMB/d.SUMA, d.SUMA/d.SUMB),
        To_Char(d.DAT_A,'dd/MM/yyyy') || ' ' || ta.lcv , d.SUMA/100 ,
        d.SWI_ACC, d.SWI_BIC,
        To_Char(d.DAT_B,'dd/MM/yyyy') || ' ' || tb.lcv , d.SUMB/100,
        d.SWO_ACC, d.SWO_BIC, a.NAME, a.OKPO
 INTO :TLXNUM_, :nSWRef, :TO_, :ATTIN_, :P20_, :P30_, :nRat,:P32R_,:nSA,:P57A1_, :P57A2_,
      :P33P_,:nSB, :P57B1_, :P57B2_,:P57B3_, :P57B4_
 FROM fx_deal d, forex_alien a, tabval ta, tabval tb 
 WHERE d.kvb=tb.kv and d.kva=ta.kv and 
       d.DEAL_TAG = :nDealTag and 
       d.KODB = decode( d.kvb, :n980, a.MFO(+), a.BIC (+)) and d.kvb=a.kv (+) ") 
and SqlFetchNext( hSqlAux2(), nFetchRes)
.head 5 +                                                                                               Else If nIns=2
.head 6 -                                                                                               If SqlPrepareAndExecute( hSqlAux2(),
"SELECT cb.alt_bic, ad.swo_ref, substr(cb.BIC||' '|| cb.mfo||' '||c.NMK,1,60), 
       c.nd ||' '|| to_char(cb.dat_nd  ,'dd/mm/yyyy')|| '   REF: ' || d.cc_id,
       to_char(d.ND), decode(v.tipd,1,'L','B'), 
       to_char(d.sdate ,'dd/mm/yyyy')||' '||to_char(ad.wdate,'dd/mm/yyyy')||' '||to_char(d.wdate ,'dd/mm/yyyy'), 
       t.lcv,d.limit, ad.INT_AMOUNT,
       acrn.FPROC(ad.accs, ad.wdate), nvl(b.NAME_MB, b.name), 
       decoce(ad.kv,:n980,sMFO,ad.swi_acc), 
       decoce(ad.kv,:n980,'',ad.swi_bic),
       decoce(ad.kv,:n980,acckred,ad.swo_acc), 
       decoce(ad.kv,:n980,mfokred,ad.swo_bic), 
       Substr(c.nmk,1,38), c.okpo 
 INTO :TLXNUM_, :nSWRef, :TO_,:ATTIN_, :P20_, :P17_,:P30_, :P32_, :nSA, :nSB,
      :nRat,:P14_, :P57A_1_1, :P57A_1_2, :P57A_2_1, :P57A_2_2,:P57A_2_3,:P57A_2_4
 FROM cc_add ad, custbank cb, customer c, cc_deal d, cc_vidd v,tabval t,
      int_accn n, basey b
 WHERE d.nd=:nDealTag and ad.adds=0 and ad.nd=d.nd 
   and d.rnk=c.rnk and c.rnk=cb.rnk and d.vidd=v.vidd and ad.kv=t.kv 
   and n.acc=ad.accs and n.basey=b.basey ") 
and SqlFetchNext( hSqlAux2(), nFetchRes)
.head 5 -  ! !!
.head 5 -  ! строка данных 
.head 5 -  ! Если есть входящее сообщение, получаем его референс
.head 5 +                                                                                               If nSWRef != NUMBER_Null 
.head 6 -                                                                                               If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT substr(value, 1, 16) INTO :P21_ FROM sw_operw WHERE swref=:nSWRef and tag='20' and opt is null" )
 and  SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 5 -                                                                                               Set sTmp1 = SalStrLeftX( GetGlobalOption('BICCODE')||' '||sMFO||' '||GetBankName(),60 )
.head 5 -                                                                                               Set sTmp=TLXNUM_||'~'||sTmp1||'~'||TO_||'~'||SalFmtFormatDateTime(SalDateCurrent(),'dd/MM/yyyy')||'~'||ATTIN_ 
.head 5 +                                                                                               If nIns=1
.head 6 -  !
.head 6 -                                                                                               Set sTmp = sTmp ||'~300'||'~'||P20_||'~'||P21_||'~'|| IifS(P21_=STRING_Null, 'NEWT', 'EXOP') 
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| P30_||'~'||SalNumberToStrX( nRat,4)||'~' || P32R_||SalNumberToStrX( nSA,2)||'~'|| P57A1_ ||'~'|| P57A2_ 
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| GetBankName()||'~' || GetBankOkpoS() 
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| P33P_||SalNumberToStrX( nSB,2)||'~'|| P57B1_||'~' || P57B2_||'~' || P57B3_||'~' || P57B4_ 
.head 5 +                                                                                               Else If nIns=2
.head 6 -                                                                                               Set sTmp = sTmp ||'~320'||'~'||P20_||'~'||P21_||'~'|| IifS(P21_=STRING_Null, 'NEWT', 'EXOP') 
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| sTmp1||'~' ||TO_||'~'||P17_||'~'||P30_
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| P32_||SalNumberToStrX( nSA,2)||'~'||P32_||SalNumberToStrX( nSB,2)
.head 6 -                                                                                               Set sTmp = sTmp ||'~'|| SalNumberToStrX( nRat,4)||'~' ||P14_ ||'~' || P57A_1_1||'~' || P57A_1_2|| '~' ||
           GetBankName()||'~'||GetBankOkpoS() 
.head 6 -                                                                                               Set sTmp = sTmp ||'~' ||P57A_2_1 ||'~' ||P57A_2_2||'~'|| P57A_2_3 ||'~' || P57A_2_4 
.head 5 -                                                                                               Set sTmp = sTmp || '~' ||'~' || GetUserRealName()
.head 5 -  !
.head 5 -                                                                                               Call DosReport ( strTempl, strReport,  sQRD, sTmp, 0)
.head 5 +                                                                                               If SalFileOpen( hFile, strReport, 0 )
.head 6 -                                                                                               Call SalFileRead( hFile, sTiket, VisFileGetSize( strReport ) )
.head 6 +                                                                                               If SqlPrepare( hSql(),
 "INSERT into BARS.TELEX_FILE (TELEX,ins,nd) values (:sTiket,:nIns,:nDealTag) " )
and SqlSetLongBindDatatype(1, BLOB_BYTE)
and SqlExecute(hSql())
.head 7 -                                                                                               Call SalFileClose( hFile )
.head 7 -                                                                                               Call SqlCommitEx(hSql(), "TELEX создан " || Str(nDealTag) )
.head 5 -                                                                                               Return TRUE
.head 3 +  Function: F_READ
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), sSql ) and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set ml_TXT = sTiket1
.head 6 -  ! Call SalDisableWindow( pbCreate )
.head 5 +  Else
.head 6 -  Call MessageNoWait("Неможливо знайти поле-TELEX в архіві ! " ,'',2,1)
.head 2 +  Window Parameters
.head 3 -  Number: nDealTag
.head 3 -  Number: nIns 
.head 2 +  Window Variables
.head 3 -  String: strReport
.head 3 -  Long String: sTiket1
.head 3 -  String: sTmp
.head 3 -  File Handle: hFile
.head 3 -  String: sSql
.head 3 -  !
.head 3 -  Number: nSWRef
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! ! прочитать из архива этот ND и его показать
.head 4 -  Set sSql = 
"SELECT telex INTO :sTiket1 from TELEX_FILE 
 where nd=:nDealTag and ins=:nIns " 
.head 4 -  Call F_READ()
.head 4 -  Call SalSetFocus( pbClose )
.head 1 +  Dialog Box: dlg_MSG
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Реквизиты введены
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 20948
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    0.052"
.head 5 -  Width:  7.257"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.76"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 20949
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    1.875"
.head 5 -  Width:  7.257"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.688"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! cFieldLabel: tbgSave	!Сохранить сделку с назначением
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    0.219"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -                           Message Actions 
.head 3 -  Background Text: Подтвердите
.head 4 -  Resource Id: 29644
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: tbgSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlTxt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.531"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk	! Сохранить
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.8"
.head 5 -  Top:    1.99"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sNazn = mlTxt
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbClose	! Отменить
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.0"
.head 5 -  Top:    1.99"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.448"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sNazn
.head 3 -  String: sText
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MSG.cTWndTitle'))
.head 4 -  !
.head 4 -  Call SalSetWindowLabelText(tbgSave, sText)
.head 4 -  Set mlTxt = sNazn
.head 4 -  Call SalSetFocus(pbOk)
.head 1 +  Form Window: FXUPD
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Изменение параметров сделки FOREX
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.788"
.head 4 -  Top:    0.938"
.head 4 -  Width:  11.267"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.036"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: System Text Color
.head 3 -  Background Color: Default
.head 2 -  Description: Изменение реквизитов договора FOREX
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Сохранить изменения'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FXUPD.cBTipSave')
.head 6 +  On SAM_Click
.head 7 +  If SqlPLSQLCommand( hSql(), "fx_update(Val(DEAL_TAG), BICKA, SSLA, BICKB, SSLB, dfB56A, dfB57A)" )
.head 8 -  Call SqlCommit(hSql())
.head 8 -  ! Disable controls
.head 8 -  Call SalDisableWindow(BICKA)
.head 8 -  Call SalDisableWindow(SSLA)
.head 8 -  Call SalDisableWindow(NBKA)
.head 8 -  Call SalDisableWindow(BICKB)
.head 8 -  Call SalDisableWindow(SSLB)
.head 8 -  Call SalDisableWindow(pb_SearchBICB)
.head 8 -  Call SalDisableWindow(pb_SearchBIC2)
.head 8 -  Call SalDisableWindow(dfB57A)
.head 8 -  Call SalDisableWindow(dfA56A)
.head 8 -  Call SalDisableWindow(dfB56A)
.head 4 -  !
.head 4 -  !
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Выйти'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('FXUPD.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Contents
.head 3 +  Data Field: DEAL_TAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Дата сделки'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipDEALTAG') )
.head 3 +  Data Field: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.667"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Дата сделки'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipDAT') )
.head 3 -  !
.head 3 -  Background Text: Валюта  А  - ПОКУПКА
.head 4 -  Resource Id: 56050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.155"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 56051
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.405"
.head 5 -  Width:  4.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Код покупаемой валюты'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipKVA') )
.head 3 +  Data Field: ISOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAMVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.8"
.head 6 -  Top:    0.452"
.head 6 -  Width:  2.886"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.714"
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Дата поступления'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipDATA') )
.head 3 +  Data Field: SUMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.8"
.head 6 -  Top:    0.726"
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Сумма поступления'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipSUMA') )
.head 3 -  !
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 56052
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    0.405"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BICA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.012"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NBA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    1.024"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Трасса платежа входящего
.head 4 -  Resource Id: 56054
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    1.476"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTrassaA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: BICKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.738"
.head 6 -  Width:  1.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set BICKA=SalStrUpperX( BICKA )
.head 6 +  If BICKA !=STRING_Null and SSLA !=STRING_Null 
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT to_Number(a.nls), a.nms INTO :SSA, :NBKA  
   FROM accounts a, BIC_ACC b 
   WHERE UPPER(b.THEIR_ACC) =:SSLA and b.bic=:BICKA and a.acc=b.acc " ) 
and not SqlFetchNext( hSql(), nFetchRes) 
.head 8 -  ! 'Лоро '
.head 8 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('FOREX.cTErrLoro') || BICKA ||' + '||SSLA, 
CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'BIC нашего банка-корреспонд'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipBICKA') )
.head 3 +  Data Field: SSLA !! лоро
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    1.738"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set SSLA=SalStrUpperX( SSLA )
.head 6 +  If BICKA != STRING_Null and SSLA != STRING_Null 
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT a.nls, a.nms INTO :sAccLoro, :sAccLoroName
       FROM accounts a, bic_acc b 
    WHERE upper(b.their_acc) =:SSLA and b.bic=:BICKA and a.acc=b.acc " ) 
and not SqlFetchNext( hSql(), nFetchRes) 
.head 8 -  ! 'Лоро '
.head 8 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('FXUPD.cTMsgErrLoro') || SSLA || ' BIC: ' || BICKA, 
CurrentLangTable.GetAtomTitle('FXUPD.cTErr'), 0 )
.head 7 +  Else
.head 8 -  Set NBKA = sAccLoroName
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Счет VOSTRO у нашего банка-корреспонд'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipSSLA') )
.head 3 +  Combo Box: NBKA
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.988"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.964"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nAcc = NBKA.GetKey(SalListQuerySelection(NBKA))
.head 6 +  If nAcc !=NUMBER_Null 
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT a.nms, b.bic, b.THEIR_ACC INTO :NBKA, :BICKA , :SSLA
   FROM  bic_acc b, accounts a
   WHERE to_number(a.nls)=:nAcc and a.kv=:KVA and a.dazs is null and a.acc=b.acc " ) 
and not SqlFetchNext( hSql(), nFetchRes) 
.head 8 -  ! 'Корсчет-А '
.head 8 -  Call SalMessageBox ( CurrentLangTable.GetAtomTitle('FXUPD.cTErrSSA')|| Str(nAcc), 
CurrentLangTable.GetAtomTitle('FXUPD.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Наименование счета для входа вал-A'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipNBKA') )
.head 3 -  !
.head 3 -  Background Text: Валюта  Б  - ПРОДАЖА
.head 4 -  Resource Id: 56055
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.433"
.head 5 -  Top:    0.155"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Код продаваемой валюты'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipKVB') )
.head 3 +  Data Field: ISOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    0.452"
.head 6 -  Width:  0.757"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAMVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.75"
.head 6 -  Top:    0.452"
.head 6 -  Width:  3.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DATB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Дата отправки'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipDATB') )
.head 3 +  Data Field: SUMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Общ.Сумма отправки'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipSUMB') )
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 56057
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    1.679"
.head 5 -  Width:  5.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BICB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.988"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'BIC партнера'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipBICB') )
.head 3 +  Data Field: NBB 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.988"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Трасса платежа исходящего
.head 4 -  Resource Id: 56058
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    1.476"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTrassaB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 56059
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.655"
.head 5 -  Width:  4.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.976"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BICKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    1.762"
.head 6 -  Width:  1.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set BICKB=SalStrUpperX( BICKB )
.head 6 +  If BICKB !=STRING_Null
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT name INTO :NBKB FROM sw_banks WHERE bic=:BICKB " ) 
and not SqlFetchNext( hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox (BICKB, 
CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'BIC банка-корреспонд партнера'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipBICKB') )
.head 3 +  Data Field: SSLB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.183"
.head 6 -  Top:    1.762"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SSLB != STRING_Null
.head 7 -  Set SSLB=SalStrUpperX( SSLB )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Счет VOSTRO партнера у его банка-корреспонд'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipSSLB') )
.head 3 +  Data Field: NBKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    2.024"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pb_SearchBICB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.283"
.head 5 -  Top:    1.655"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! 'Поиск партнера'
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FXUPD.cBTipSearchBICB')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGetFiltered('SW_BANKS','NAME','', BICKB, NBKB)
.head 3 +  Pushbutton: pb_SearchBIC2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.25"
.head 5 -  Top:    3.595"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! 'Поиск партнера'
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('FXUPD.cBTipSearchBICB')
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGetFiltered('SW_BANKS','NAME','', sTmpBIC, sTmpName)
.head 6 +  If sTmpBIC !=STRING_Null
.head 7 +  If dfB56A != STRING_Null
.head 8 -  Set dfB56A = dfB56A || SalNumberToChar(13) || SalNumberToChar(10) || sTmpBIC
.head 7 +  Else
.head 8 -  Set dfB56A = sTmpBIC
.head 3 +  Multiline Field: dfB57A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    2.321"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Альтернативный ввод трассы'
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('FXUPD.cFTipAltPartyB') )
.head 3 -  Background Text: Посредник
.head 4 -  Resource Id: 58531
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.345"
.head 5 -  Width:  4.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIntermA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Посредник
.head 4 -  Resource Id: 58530
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.183"
.head 5 -  Top:    3.345"
.head 5 -  Width:  4.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIntermB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfB56A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    3.655"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 3 +  Multiline Field: dfA56A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    3.655"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 3 -  Frame
.head 4 -  Resource Id: 38150
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.571"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 38151
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.183"
.head 5 -  Top:    3.571"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  ! Function: F_SAVE
.head 4 -                                                                                                                                    Description: 
.head 4 -                                                                                                                                    Returns 
.head 4 -                                                                                                                                    Parameters 
.head 4 -                                                                                                                                    Static Variables 
.head 4 +                                                                                                                                    Local variables 
.head 5 -  ! String: sNazn
.head 5 -                                                                                                                                    String: sBankDay
.head 5 -                                                                                                                                    Number: B_KV_B
.head 5 -                                                                                                                                    Number: nSa
.head 5 -                                                                                                                                    Number: nVob_FX1
.head 5 -                                                                                                                                    Number: nVob_FX2
.head 5 -                                                                                                                                    Number: nVob_FX3
.head 5 -                                                                                                                                    Number: nVob_FX4
.head 5 -                                                                                                                                    Number: nVob_FX6
.head 5 -                                                                                                                                    Number: nSb
.head 5 -                                                                                                                                    String: sKb
.head 5 -                                                                                                                                    String: sKURS_FX3
.head 5 -                                                                                                                                    Date/Time: DATT
.head 5 -                                                                                                                                    Number: nVobVal
.head 4 +                                                                                                                                    Actions 
.head 5 -                                                                                                                                    Set nRef   = NUMBER_Null
.head 5 -                                                                                                                                    Set nRef1  = NUMBER_Null
.head 5 -                                                                                                                                    Set nRef2  = NUMBER_Null
.head 5 -                                                                                                                                    Set nRef22 = NUMBER_Null
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(),
  "SELECT NVL(min(vob),6) INTO :nVob_FX1 from tts_vob WHERE tt='FX1'" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(),
  "SELECT NVL(min(vob),6) INTO :nVob_FX2 from tts_vob WHERE tt='FX2'" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(),
  "SELECT NVL(min(vob),6) INTO :nVob_FX3 from tts_vob WHERE tt='FX3'" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(),
  "SELECT NVL(min(vob),6) INTO :nVob_FX4 from tts_vob WHERE tt='FX4'" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(),
  "SELECT NVL(min(vob),6) INTO :nVob_FX6 from tts_vob WHERE tt='FX6'" )
and  SqlFetchNext( hSql(), nFetchRes)
.head 5 -  ! Set nVobVal = IifN(nVob_VZAL=0,6,IifN(KVA=GetBaseVal() AND KVA=KVB,6,nVob_VZAL))
.head 5 -                                                                                                                                    Set nVobVal = IifN(nVob_VZAL=0,6,nVob_VZAL)
.head 5 +                                                                                                                                    If DATA < DATB
.head 6 -                                                                                                                                    Set DATT= DATA
.head 5 +                                                                                                                                    Else 
.head 6 -                                                                                                                                    Set DATT= DATB
.head 5 -                                                                                                                                    Set sBankDay= SalFmtFormatDateTime(DATT,'MM/dd/yyyy')  
.head 5 -  !
.head 5 +  ! If cb_No
.head 6 -                                                                                                                                                                                Set sNazn="СПОТ-угода з" ||NBB||'.'||
  Str(KVA)|| "/" ||Str(KVB) || " "||NTIK || " від " ||SalFmtFormatDateTime(DAT,'dd/MM/yyyy') 
.head 5 +  ! Else
.head 6 -                                                                                                                                                                                Set sNazn=IifS(KVB=n980,'Купівля вал у ',IifS(KVA=n980,'Продаж вал ','Конверсія вал з '))||NBB||'.'||
  Str(KVA)|| '/' ||Str(KVB) || ' '||NTIK || ' ' ||
 "FOREX угода від " ||SalFmtFormatDateTime(DAT,'dd/MM/yyyy') 
.head 5 -                                                                                                                                    Set FL_4 = IifN( KVB=n980,FALSE,TRUE)
.head 5 -  ! !!!!!!!!!!!!!!!!!!!!!!!!!!! Вставка в OPER nRef
.head 5 +                                                                                                                                    If DAT < DATA and  DAT < DATB   ! FX5 - внебаланс откріть-закріть
.head 6 -  ! 2 референса на 2 даты валютирования ( АВИАТЕК-вариант). Оп FX5 не имеет доч обратной 
.head 6 +                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT * FROM ttsap WHERE tt='FX5' and TTAP='FX5' and dk=1 " )
and not SqlFetchNext( hSql(), nFetchRes)
.head 7 -                                                                                                                                    Call cDoc.SetDoc(nRef, 'FX5', 1, 16, NTIK,
     DAT, DAT, DAT, DAT,
     sA, NBA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sB, NBB, MFOA, '', KVB, SUMB*SalNumberPower(10,nDigB), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    If cDoc.oDoc()
.head 8 -  ! Set nRef5=cDoc.m_nRef
.head 8 -                                                                                                                                    Call cDoc.SetDoc(nRef, 'FX5', 0, 16, NTIK,
     DAT, DAT, DATT, DATT,
     sA, NBA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sB, NBB, MFOA, '', KVB, SUMB*SalNumberPower(10,nDigB), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 8 +                                                                                                                                    If cDoc.oDoc()
.head 9 -                                                                                                                                    Set nRef = cDoc.m_nRef
.head 9 -  ! Call SqlPrepareAndExecute( hSql(),"UPDATE oper SET refl=:nRef where ref=:nRef5 ")
.head 9 +                                                                                                                                    If not cb_No
.head 10 -                                                                                                                                    Set FL= cDoc.PayV(0,nRef,DATT,'FX2',1, KVA,B_1819,SUMA*SalNumberPower(10,nDigA), KVA,Str(T_1819),SUMA*SalNumberPower(10,nDigA) )
    and cDoc.PayV(0,nRef,DATT,'FX2',0, KVB,B_1919,SUMB*SalNumberPower(10,nDigB), KVB,Str(T_1819),SUMB*SalNumberPower(10,nDigB) )
.head 10 -  ! Set FL=    
    In_Pay(0, nRef, sBankDay, 'FX2', KVA, 0, Val(B_1819), SUMA*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVA, 1,     T_1819,  SUMA*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVB, 0,     T_1819,  SUMB*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVB, 1, Val(B_1919), SUMB*100, 0, 'FOREX')
.head 9 +                                                                                                                                    Else 
.head 10 -                                                                                                                                    Set FL= TRUE
.head 6 -  ! 1 референс на 2 даты валютирования ( нормальный вариант) Оп FX5 имеет доч обратную
.head 6 +                                                                                                                                    Else 
.head 7 -                                                                                                                                    Call cDoc.SetDoc(nRef, 'FX5', 1, 16, NTIK,
     DAT, DAT, DAT, DATT,
     sA, NBA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sB, NBB, MFOA, '', KVB, SUMB*SalNumberPower(10,nDigB), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    If cDoc.oDoc()
.head 8 -                                                                                                                                    Set nRef = cDoc.m_nRef
.head 8 +                                                                                                                                    If not cb_No
.head 9 -                                                                                                                                    Set FL= cDoc.PayV(0,nRef,DATT,'FX2',1, KVA,B_1819,SUMA*SalNumberPower(10,nDigA), KVA,Str(T_1819),SUMA*SalNumberPower(10,nDigA) )
    and cDoc.PayV(0,nRef,DATT,'FX2',0, KVB,B_1919,SUMB*SalNumberPower(10,nDigB), KVB,Str(T_1819),SUMB*SalNumberPower(10,nDigB) )
.head 9 -  ! Set FL=    
    In_Pay(0, nRef, sBankDay, 'FX2', KVA, 0, Val(B_1819), SUMA*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVA, 1,     T_1819,  SUMA*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVB, 0,     T_1819,  SUMB*100, 0, 'FOREX')
and In_Pay(0, nRef, sBankDay, 'FX2', KVB, 1, Val(B_1919), SUMB*100, 0, 'FOREX')
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Set FL= TRUE
.head 5 +                                                                                                                                    Else !!!!!!!!!! FX2 - pаскрыть торговый по А
.head 6 +                                                                                                                                    If not cb_No
.head 7 +                                                                                                                                    If KVA != n980 AND KVB != n980
.head 8 +                                                                                                                                    If nVob_FX2V
.head 9 -                                                                                                                                    Set nVob_FX2 = nVob_FX2V
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Set nVob_FX2 = nVobVal
.head 7 +                                                                                                                                    Else If KVA = n980 AND KVB != n980
.head 8 +                                                                                                                                    If nVob_FX2GV
.head 9 -                                                                                                                                    Set nVob_FX2 = nVob_FX2GV
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Set nVob_FX2 = nVobVal
.head 7 +                                                                                                                                    Else If KVA != n980 AND KVB = n980
.head 8 +                                                                                                                                    If nVob_FX2VG
.head 9 -                                                                                                                                    Set nVob_FX2 = nVob_FX2VG
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Set nVob_FX2 = nVobVal
.head 7 -  ! Call cDoc.SetDoc(nRef, 'FX2', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX2,nVobVal), NTIK,
     DAT, DAT, DAT, DAT,
     B_1819,     NBA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     Str(T_1819),NBB, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 -                                                                                                                                    Call cDoc.SetDoc(nRef, 'FX2', 1, nVob_FX2, NTIK,
     DAT, DAT, DAT, DAT,
     B_1819,     NBA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     Str(T_1819),NBB, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    If cDoc.oDoc()
.head 8 -                                                                                                                                    Set nRef = cDoc.m_nRef
.head 8 -                                                                                                                                    Set FL= cDoc.PayV(0,nRef,DATT,'FX2',1, KVB,Str(T_1819),SUMB*SalNumberPower(10,nDigB), KVB,B_1919,SUMB*SalNumberPower(10,nDigB) )
.head 6 +                                                                                                                                    Else 
.head 7 -                                                                                                                                    Set FL= TRUE
.head 5 +                                                                                                                                    If not cb_No
.head 6 -  ! поступление вал Вставка в OPER nRef1  not cb_SWIFT
.head 6 +                                                                                                                                    If FL and not cb_NoKsA and ( not cb_SWIFT and SSA != NUMBER_Null or 
   cb_KS and KVA = n980 and Subs(Str(SSA),1,2)='29') 
.head 7 -                                                                                                                                    Set nRef1 = NUMBER_Null
.head 7 -                                                                                                                                    Call cDoc.SetDoc(nRef1, 'FX3', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX3,nVobVal), NTIK,
     DAT, DAT, DATA, DATA,
     Str(SSA), NBKA, MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     B_1819,   NBA,  MFOA, '', KVA, SUMA*SalNumberPower(10,nDigA), GetBankOkpoS(),
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 -                                                                                                                                    Set FL = cDoc.oDoc()
.head 7 -                                                                                                                                    Set nRef1 = cDoc.m_nRef
.head 7 +                                                                                                                                    If KOD_BB !=STRING_Null
.head 8 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
"INSERT INTO operw (ref,tag,value) VALUES (:nRef1,'KOD_B', :KOD_BB)" )
.head 7 +                                                                                                                                    If KOD_GB !=STRING_Null
.head 8 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
        "UPDATE operw SET value=:KOD_GB WHERE ref=:nRef1 and tag='KOD_G'")
.head 7 +                                                                                                                                    If KOD_NA !=STRING_Null
.head 8 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(), "DELETE FROM operw WHERE ref=:nRef1 and tag='KOD_N' ") 
    and  SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef1,'KOD_N', :KOD_NA)" )        
.head 7 -                                                                                                                                    If KVA != n980 
and SqlPrepareAndExecute( hSql(), 
   "SELECT gl.p_icurval(:KVB,:SUMB, bankdate) * NOMINAL/ :SUMA
    INTO :sKURS_FX3  FROM tabval WHERE kv=:KVA " ) 
and  SqlFetchNext( hSql(), nFetchRes)
.head 7 -                                                                                                                                    Set FL=SqlPrepareAndExecute(hSql(),
"UPDATE operw SET value=:sKURS_FX3 WHERE ref=:nRef1 and tag='KURS' ")
.head 6 -  ! платежи по ВАЛ-Б Вставка в OPER nRef2
.head 6 +                                                                                                                                    If not cb2
.head 7 -                                                                                                                                    Set SUMB1=SUMB
.head 6 +                                                                                                                                    If FL and not cb_NoKsB
.head 7 -                                                                                                                                    Set nRef2 = NUMBER_Null
.head 7 +                                                                                                                                    If KVB=n980 AND Subs(SSB,1,2) !='29'  ! проплата грн через СЭП
.head 8 -                                                                                                                                    Call cDoc.SetDoc(nRef2, 'FX1', 1, nVob_FX1, NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,NBA, MFOA, '', KVB, SUMB1*SalNumberPower(10,nDigB), GetBankOkpoS(),
     NLSB,  NBB, MFOB, '', KVB, SUMB1*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    Else ! проплата вал или грн внутр
.head 8 +                                                                                                                                    If SalStrTrimX( BICA ) = SalStrTrimX( BICKB ) 
.head 9 -  ! Call Debug('6')
.head 9 -                                                                                                                                    Call cDoc.SetDoc(nRef2, 'FX6', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX6,nVobVal), NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,NBA, MFOA, '', KVB, SUMB1*SalNumberPower(10,nDigB), GetBankOkpoS(),
     SSB,   NBB, MFOA, '', KVB, SUMB1*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Call cDoc.SetDoc(nRef2, 'FX4', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX4,nVobVal), NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,  NBA, MFOA, '', KVB, SUMB1*SalNumberPower(10,nDigB), GetBankOkpoS(),
     sNLS_FX4,NBB, MFOA, '', KVB, SUMB1*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    If cDoc.oDoc()
.head 8 -                                                                                                                                    Set nRef2 = cDoc.m_nRef
.head 8 -                                                                                                                                    Call F_DOPR(nRef2)
.head 7 +                                                                                                                                    Else 
.head 8 -                                                                                                                                    Set FL=FALSE
.head 6 +                                                                                                                                    If cb2 and FL and SUMB2 > 0 and not cb_NoKsB
.head 7 -                                                                                                                                    Set nRef22 = NUMBER_Null
.head 7 +                                                                                                                                    If KVB=n980 ! проплата грн
.head 8 -                                                                                                                                    Call cDoc.SetDoc(nRef22, 'FX1', 1, nVob_FX1, NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,NBA, MFOA, '', KVB, SUMB2*SalNumberPower(10,nDigB), GetBankOkpoS(),
     NLSB,  NBB, MFOB, '', KVB, SUMB2*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    Else ! проплата вал
.head 8 +                                                                                                                                    If SalStrTrimX( BICA ) = SalStrTrimX( BICKB )
.head 9 -                                                                                                                                    Call cDoc.SetDoc(nRef22, 'FX6', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX6,nVobVal), NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,NBA, MFOA, '', KVB, SUMB2*SalNumberPower(10,nDigB), GetBankOkpoS(),
     SSB,   NBB, MFOA, '', KVB, SUMB2*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 8 +                                                                                                                                    Else 
.head 9 -                                                                                                                                    Call cDoc.SetDoc(nRef22, 'FX4', 1, IifN(KVA=GetBaseVal() AND KVA=KVB,nVob_FX4,nVobVal), NTIK,
     DAT, DAT, DATB, DATB,
     B_1919,  NBA, MFOA, '', KVB, SUMB2*SalNumberPower(10,nDigB), GetBankOkpoS(),
     sNLS_FX4,NBB, MFOA, '', KVB, SUMB2*SalNumberPower(10,nDigB), OKPOB,
     sNazn, '',     GetIdOper(), '', NUMBER_Null, 0)
.head 7 +                                                                                                                                    If cDoc.oDoc()
.head 8 -                                                                                                                                    Set nRef22 = cDoc.m_nRef
.head 8 -                                                                                                                                    Call F_DOPR(nRef22)
.head 7 +                                                                                                                                    Else 
.head 8 -                                                                                                                                    Set FL=FALSE
.head 5 +                                                                                                                                    If FL  ! запомнить сделку в fx_deal
.head 6 -                                                                                                                                    Set nSa=SUMA*SalNumberPower(10,nDigA)
.head 6 -                                                                                                                                    Set nSb=SUMB*SalNumberPower(10,nDigB)
.head 6 -  ! Set sKb=IifS( KVB=GetBaseVal(), MFOB, BICB )
.head 6 -                                                                                                                                    Set sKb=SalStrTrimX( IifS(KVB=n980,MFOB,BICB ))
.head 6 -                                                                                                                                    Call SqlPrepareAndExecute(hSql(),
"SELECT s_fx_deal.NEXTVAL INTO :nDealTag FROM dual")
.head 6 -                                                                                                                                    Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -                                                                                                                                    Set FL= SqlPrepareAndExecute( hSql(),
  "INSERT into fx_deal
  (DEAL_TAG,NTIK, DAt, DAT_A, KVA, sUMA, KVB, DAT_B, sUMB,  ref,  refa, refb,  refb2,  kodb, swi_ref, swi_bic, swi_acc, swo_bic, swo_acc) values 
  (:nDealTag,:NTIK,:DAT,:DATA, :KVA, :nSa,:KVB,:DATB, :nSb,:nRef,:nRef1,:nRef2,:nRef22,:sKb, :nSWRef, :BICKA, :SSLA, :BICKB, :SSB)" )
.head 5 -  ! !!!!!!!!!!!!!!!!! commit
.head 5 +                                                                                                                                    If FL
.head 6 -                                                                                                                                    Call SqlCommit(hSql())
.head 6 -                                                                                                                                    Call SalEnableWindow( pb_Tiket ) 
.head 6 -                                                                                                                                    Call SalEnableWindow( pb_Print2 )
.head 6 -                                                                                                                                    Call SalEnableWindow( pb_Buch )
.head 6 -                                                                                                                                    Call SalEnableWindow( pb_Alien )
.head 6 -                                                                                                                                    Call SalEnableWindow( pbPrintDeal )
.head 6 -                                                                                                                                    Call SalEnableWindow( pbCreateSWT )
.head 6 -                                                                                                                                    Call SalEnableWindow( pbCreateSWT2 )
.head 6 -                                                                                                                                    Call SalDisableWindow( pb_OK ) 
.head 6 -                                                                                                                                    Call SalDisableWindow( pbFromSWT )
.head 5 +                                                                                                                                    Else 
.head 6 -                                                                                                                                    Call SqlRollback(hSql())
.head 5 -                                                                                                                                    Return FL
.head 3 +  ! Function: F_POISK
.head 4 -                                                                                                                                    Description: 
.head 4 -                                                                                                                                    Returns 
.head 4 -                                                                                                                                    Parameters 
.head 4 -                                                                                                                                    Static Variables 
.head 4 -                                                                                                                                    Local variables 
.head 4 +                                                                                                                                    Actions 
.head 5 +                                                                                                                                    If SqlPrepareAndExecute( hSql(),
   "SELECT  nvl(a.lim,0)/100, rnk_ostb(a.rnk)/100,  nvl(a.lim,0)/100 - rnk_ostb(a.rnk)/100
    INTO    :colLim, :colOstBQ, :colPLBQ
  FROM customer a WHERE a.okpo=:OKPOB" )
and SqlFetchNext( hSql(), nFetchRes)
.head 6 +                                                                                                                                    If colPLBQ < 0 and colLim > 0
.head 7 -                                                                                                                                    Set cb2 = TRUE
.head 7 -                                                                                                                                    Call SalSendMsg( cb2, SAM_Click, 0, 0 )
.head 5 +                                                                                                                                    If cb_KS and SSB !=STRING_Null 
.head 6 +                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT nms INTO :NBB  FROM accounts WHERE kv=:KVB and nls=:SSB" ) 
and SqlFetchNext( hSql(), nFetchRes) 
and KVA != NUMBER_Null
and SqlPrepareAndExecute( hSql(),"SELECT nms INTO :NBKA FROM accounts WHERE kv=:KVA and nls=:SSB" ) 
and SqlFetchNext( hSql(), nFetchRes) 
.head 7 -                                                                                                                                    Set SSA = Val(SSB)
.head 3 +  ! Function: F_DOPR
.head 4 -                                                                                                                                    Description: 
.head 4 -                                                                                                                                    Returns 
.head 4 +                                                                                                                                    Parameters 
.head 5 -                                                                                                                                    Number: Ref
.head 4 -                                                                                                                                    Static Variables 
.head 4 +                                                                                                                                    Local variables 
.head 5 -                                                                                                                                    String: sKURS_FX4
.head 4 +                                                                                                                                    Actions 
.head 5 +                                                                                                                                    If FL_4 
.head 6 +                                                                                                                                    If BICKB != STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
   "INSERT INTO operw (ref,tag,value) VALUES (:Ref,'54', :BICKB)" )
.head 6 +                                                                                                                                    If SSB != STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
   "INSERT INTO operw (ref,tag,value) VALUES (:Ref,'58', :SSB)" ) 
.head 6 +                                                                                                                                    If BICB !=STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
"UPDATE operw SET value=:BICB WHERE ref=:Ref and tag='57'")
.head 6 +                                                                                                                                    If KOD_BB !=STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
"INSERT INTO operw (ref,tag,value) VALUES (:Ref,'KOD_B', :KOD_BB)" )
.head 6 +                                                                                                                                    If KOD_GB !=STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(),
"UPDATE operw SET value=:KOD_GB WHERE ref=:Ref and tag='KOD_G'")
.head 6 +                                                                                                                                    If KOD_NB !=STRING_Null
.head 7 -                                                                                                                                    Set FL = SqlPrepareAndExecute(hSql(), "DELETE FROM operw WHERE ref=:Ref and tag='KOD_N' " )
    and  SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:Ref,'KOD_N', :KOD_NB)" )        
.head 6 -                                                                                                                                    If KVB != n980 
and SqlPrepareAndExecute( hSql(), 
   "SELECT gl.p_icurval(:KVA,:SUMA, bankdate) * NOMINAL /:SUMB 
    INTO :sKURS_FX4
    FROM tabval WHERE kv=:KVB " ) 
and  SqlFetchNext( hSql(), nFetchRes)
.head 6 -                                                                                                                                    Set FL=SqlPrepareAndExecute(hSql(),
"UPDATE operw SET value=:sKURS_FX4 WHERE ref=:Ref and tag='KURS' ")
.head 5 -                                                                                                                                    Return TRUE
.head 3 +  ! Function: F_RESULTAT
.head 4 -                                                                                                                                    Description: 
.head 4 -                                                                                                                                    Returns 
.head 4 -                                                                                                                                    Parameters 
.head 4 -                                                                                                                                    Static Variables 
.head 4 +                                                                                                                                    Local variables 
.head 5 -                                                                                                                                    Number: nSa
.head 5 -                                                                                                                                    Number: nSb
.head 4 +                                                                                                                                    Actions 
.head 5 +                                                                                                                                    If cb2
.head 6 -                                                                                                                                    Set SUMB = SUMB1 + SUMB2
.head 5 +                                                                                                                                    If SUMB !=NUMBER_Null and 
   SUMA !=NUMBER_Null and 
   KVA  !=NUMBER_Null and 
   KVB  !=NUMBER_Null 
.head 6 -                                                                                                                                    Set KURSA=SUMA /SUMB
.head 6 -                                                                                                                                    Set KURSB=SUMB /SUMA
.head 6 -                                                                                                                                    Set nSa=SUMA*SalNumberPower(10,nDigA)
.head 6 -                                                                                                                                    Set nSb=SUMB*SalNumberPower(10,nDigB)
.head 6 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT
 ( gl.p_icurval(:KVA,:nSa,:DAT)-gl.p_icurval(:KVB,:nSb,:DAT) ) /100
   INTO :Resultat FROM dual" ) 
and SqlFetchNext( hSql(), nFetchRes) 
.head 6 -                                                                                                                                    Call SalColorSet( Resultat, 8, IifN(Resultat>0,COLOR_DarkBlue,COLOR_DarkRed) )
.head 5 -                                                                                                                                    Return TRUE
.head 3 +  ! Function: F_CLEAR
.head 4 -                                                                                                                                    Description: 
.head 4 -                                                                                                                                    Returns 
.head 4 -                                                                                                                                    Parameters 
.head 4 -                                                                                                                                    Static Variables 
.head 4 -                                                                                                                                    Local variables 
.head 4 +                                                                                                                                    Actions 
.head 5 -                                                                                                                                    Set cb_NoKsA = FALSE
.head 5 -                                                                                                                                    Call SalSendMsg( cb_NoKsA, SAM_Click, 0, 0 )
.head 5 -                                                                                                                                    Set cb_NoKsB = FALSE
.head 5 -                                                                                                                                    Call SalSendMsg( cb_NoKsB, SAM_Click, 0, 0 )
.head 5 -  !
.head 5 -                                                                                                                                    Call SalDisableWindow( pb_Tiket ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pb_Print2 ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pb_Poisk )
.head 5 -                                                                                                                                    Call SalDisableWindow(pb_SearchBICB)
.head 5 -                                                                                                                                    Call SalDisableWindow( pb_Buch ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pb_Alien ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pbPrintDeal ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pbCreateSWT ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( pbCreateSWT2 )
.head 5 -                                                                                                                                    Call SalEnableWindow( pb_OK ) 
.head 5 -                                                                                                                                    Call SalEnableWindow( pbFromSWT ) 
.head 5 -  ! Set df_Arch='Архив'
.head 5 -                                                                                                                                    Set df_Arch=CurrentLangTable.GetAtomTitle('FOREX.cTArch')
.head 5 -                                                                                                                                    Set DAT=GetBankDate()
.head 5 -                                                                                                                                    Set Resultat=NUMBER_Null
.head 5 -                                                                                                                                    Set DATA = DAT
.head 5 -                                                                                                                                    Set DATB = DAT
.head 5 -                                                                                                                                    Set cb_SWIFT = FL_SWIFT
.head 5 -                                                                                                                                    Set cb2 = FALSE
.head 5 -                                                                                                                                    Set cb_No = FALSE
.head 5 -                                                                                                                                    Set cb_KS = FALSE
.head 5 -                                                                                                                                    Call SalDisableWindow( SUMB1 )
.head 5 -                                                                                                                                    Call SalDisableWindow( SUMB2 )
.head 5 -                                                                                                                                    Call SalEnableWindow( SUMB )
.head 5 -                                                                                                                                    Set SUMB1 = 0
.head 5 -                                                                                                                                    Set SUMB2 = 0
.head 5 -                                                                                                                                    Set NLSA = B_1819
.head 5 -                                                                                                                                    Set NBA  = GetBankName()
.head 5 -                                                                                                                                    Set MFOA = GetBankMfo()
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT val INTO :BICA FROM params WHERE par='BICCODE' " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT val INTO :KOD_BA FROM params WHERE par='1_PB' " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT nlsm, nlsk INTO :sA, :sB FROM tts WHERE tt='FX5' " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT p.val,b.COUNTRY INTO :KOD_GA,:NGA 
 FROM params p, bopcount b WHERE p.par='KOD_G' and p.val=b.KODC" ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -  !
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), 
"SELECT v.val, b.TRANSDESC  INTO :KOD_NA, :s_KOD_NA FROM op_rules v, bopcode b
 WHERE v.tt='FX3' and v.tag='KOD_N' and ltrim(rtrim(v.val))=ltrim(rtrim(b.TRANSCODE)) " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -                                                                                                                                    If SqlPrepareAndExecute( hSql(), 
"SELECT v.val, b.TRANSDESC  INTO :KOD_NB, :s_KOD_NB FROM op_rules v, bopcode b
 WHERE v.tt='FX4' and v.tag='KOD_N' and ltrim(rtrim(v.val))=ltrim(rtrim(b.TRANSCODE)) " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 5 -  !
.head 5 -                                                                                                                                    Set OKPOA = Str(GetBankOkpo())
.head 5 -                                                                                                                                    Set KVA   = NUMBER_Null
.head 5 -                                                                                                                                    Set NTIK  = STRING_Null
.head 5 -                                                                                                                                    Set ISOA  = STRING_Null
.head 5 -                                                                                                                                    Set NAMVA = STRING_Null
.head 5 -                                                                                                                                    Set SUMA  = NUMBER_Null
.head 5 -                                                                                                                                    Set KURSA = NUMBER_Null
.head 5 -                                                                                                                                    Set BICKA = STRING_Null
.head 5 -                                                                                                                                    Set NBKA  = STRING_Null
.head 5 -                                                                                                                                    Set SSA   = NUMBER_Null
.head 5 -                                                                                                                                    Set SSLA  = STRING_Null
.head 5 -  !
.head 5 -                                                                                                                                    Set KVB   = NUMBER_Null
.head 5 -                                                                                                                                    Set ISOB  = STRING_Null
.head 5 -                                                                                                                                    Set NAMVB = STRING_Null
.head 5 -                                                                                                                                    Set SUMB  = NUMBER_Null
.head 5 -                                                                                                                                    Set KURSB = NUMBER_Null
.head 5 -                                                                                                                                    Set BICB  = STRING_Null
.head 5 -                                                                                                                                    Set MFOB  = STRING_Null
.head 5 -                                                                                                                                    Set NBB   = STRING_Null
.head 5 -                                                                                                                                    Set NLSB  = STRING_Null
.head 5 -                                                                                                                                    Set KOD_GB = STRING_Null
.head 5 -                                                                                                                                    Set KOD_BB = STRING_Null
.head 5 -                                                                                                                                    Set NGB   = STRING_Null
.head 5 -                                                                                                                                    Set OKPOB = STRING_Null
.head 5 -  !
.head 5 -                                                                                                                                    Set BICKB = STRING_Null
.head 5 -                                                                                                                                    Set NBKB  = STRING_Null
.head 5 -                                                                                                                                    Set SSB   = STRING_Null
.head 5 -  !
.head 5 -                                                                                                                                    Call SalDisableWindow( BICB )
.head 5 -                                                                                                                                    Call SalDisableWindow( MFOB )
.head 5 -                                                                                                                                    Call SalDisableWindow( KOD_BB)
.head 5 -                                                                                                                                    Call SalDisableWindow( OKPOB )
.head 5 -                                                                                                                                    Call SalDisableWindow( KOD_GB ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( NLSB ) 
.head 5 -                                                                                                                                    Call SalDisableWindow( BICKB )
.head 5 -                                                                                                                                    Call SalDisableWindow( SSB )
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nDealId !! идентификатор договора
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  String: sAccLoro
.head 3 -  String: sAccLoroName
.head 3 -  String: sBicA
.head 3 -  String: sAccA
.head 3 -  String: sTmpName
.head 3 -  String: sTmpBIC
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('FXUPD.cTWndTitle')  )
.head 4 -  ! Получаем данные
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT f.deal_tag, f.dat, 
f.kva, ta.lcv, ta.name, f.dat_a, f.suma,
f.kvb, tb.lcv, tb.name, f.dat_b, f.sumb, f.bicb,
f.swi_bic, f.swi_acc, f.swo_bic, f.swo_acc, f.interm_b, f.alt_partyb
INTO :DEAL_TAG, :DAT, :KVA, :ISOA, :NAMVA, :DATA, :SUMA, 
:KVB, :ISOB, :NAMVB, :DATB, :SUMB, :BICB,
:sBicA, :sAccA, :BICKB, :SSLB, :dfB56A, :dfB57A
   FROM fx_deal f, tabval ta, tabval tb 
WHERE f.deal_tag = :nDealId
      AND f.kva = ta.kv
      AND f.kvb = tb.kv")
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes)
.head 4 -  If SqlPrepareAndExecute( hSql(), "SELECT val INTO :BICA FROM params WHERE par='BICCODE' " ) 
and  SqlFetchNext( hSql(), nFetchRes) 
.head 4 -  Set NBA = GetBankName()
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT name INTO :NBB FROM sw_banks WHERE bic=:BICB" ) 
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes) 
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT name INTO :NBKB FROM sw_banks WHERE bic=:BICKB" ) 
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes) 
.head 4 -  Call NBKA.Init(NBKA)
.head 4 -  Call NBKA.Populate(hSql(),
"NLS","SUBSTR(NMS,1,38)","ACCOUNTS",
"WHERE KV="||Str(KVA)||
" AND DAZS IS NULL AND ACC IN (SELECT ACC FROM BIC_ACC) ORDER BY NLS ")
.head 4 -  ! Call SalListSetSelect(NBKA, 0)
.head 4 -  ! Call SalSendMsg( NBKA, SAM_Click, 0, 0)
.head 4 -  Set BICKA = sBicA
.head 4 -  Set SSLA = sAccA
.head 1 +  Form Window: FREE
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  15.217"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.321"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbOpenA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: А
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.05"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call OpenAcc('A', nKvA)
.head 4 +  Pushbutton: pbOpenB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Б
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    0.05"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call OpenAcc('B', nKvB)
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Custom Control: cSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOst
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! KVA - Валюта та банківські метали до отримання за умовами спот/за форвардними контрактами
.head 5 +  Column: colAcc9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOst9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select a.acc, a.nls, a.ostc/power(10,t.dig)
   into :colAcc, :colNls, :colOst
   from fx_deal_acc f, accounts a, tabval t
  where f.acc3 = a.acc
    and a.kv = t.kv
    and f.rnk = :nRnk
    and f.fx_type = :sForexType
    and f.kv_type = 'A'
    and f.kv = :nKvA
    and f.sos = 0", TBL_FillAll)
.head 3 +  Child Table: tblB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.155"
.head 6 -  Width:  5.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOst
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! KVB - Валюта та банківські метали до відправлення за умовами спот/за форвардними контрактами
.head 5 +  Column: colAcc9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOst9
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select a.acc, a.nls, a.ostc/power(10,t.dig)
   into :colAcc, :colNls, :colOst
   from fx_deal_acc f, accounts a, tabval t
  where f.acc3 = a.acc
    and a.kv = t.kv
    and f.rnk = :nRnk
    and f.fx_type = :sForexType
    and f.kv_type = 'B'
    and f.kv = :nKvB
    and f.sos = 0", TBL_FillAll)
.head 2 +  Functions
.head 3 +  Function: OpenAcc
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sKvType
.head 5 -  Number: nKv
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalMessageBox('Открыть счета в валюте' || PutCrLf() || '   ' || Str(nKv) ||
   'к сделке' || PutCrLf() || '   ' || sForexType ||
   'для клиента' || PutCrLf() || '   ' || Str(nRnk), '', MB_YesNo) = IDNO
.head 6 -  Return TRUE
.head 5 +  If not SqlPLSQLCommand(hSql(), "forex.open_acc(nRnk, sForexType, sKvType, nKv)")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hSql())
.head 5 +  If sKvType = 'A'
.head 6 -  Call SalSendMsg(tblA, UM_Populate, 0, 0)
.head 5 +  Else
.head 6 -  Call SalSendMsg(tblB, UM_Populate, 0, 0)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  ! nMode: 1-Открытие счетов, 2-Выбор счетов
.head 3 -  Number: nMode
.head 2 +  Window Variables
.head 3 -  Number: nRnk
.head 3 -  String: sForexType
.head 3 -  Number: nKvA
.head 3 -  Number: nKvB
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If nMode = 1
.head 5 -  Call SalDisableWindow(pbOk)
.head 4 +  Else If nMode = 2
.head 5 -  Call SalDisableWindow(pbOpenA)
.head 5 -  Call SalDisableWindow(pbOpenB)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbOk)
.head 5 -  Call SalDisableWindow(pbOpenA)
.head 5 -  Call SalDisableWindow(pbOpenB)
.head 4 -  Call cSpl.setBarSize(5)
.head 4 -  Call cSpl.setLeftFrame(tblA)
.head 4 -  Call cSpl.setRightFrame(tblB)
.head 4 -  Call cSpl.setBarPosition(500)
.head 3 +  On SAM_CreateComplete
.head 4 +  If GetForexTypeParam(nRnk, sForexType, nKvA, nKvB)
.head 5 -  Call SalSendMsg(tblA, UM_Populate, 0, 0)
.head 5 -  Call SalSendMsg(tblB, UM_Populate, 0, 0)
.head 4 +  Else
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Dialog Box: dlgFreeAcc
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметри угоди
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.3"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.4"
.head 5 -  Top:    0.09"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\SEARCH.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Поиск
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('dlgFreeAcc.pbSearch'))
.head 5 +  On SAM_Click
.head 6 -  ! wParam=1, если ввели ОКПО, а клиентов с таким ОКПО несколько
.head 6 +  If FunNSIGetFiltered('customer', 'rnk', "customer.custtype=1", sPK, sSem)
.head 7 -  Set dfRnk = Val(sPK)
.head 7 -  Call SearchCustomer(dfRnk)
.head 3 -  Background Text: РНК
.head 4 -  Resource Id: 33093
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.15"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfNmk  = ''
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfRnk)
.head 7 +  If not SearchCustomer(dfRnk)
.head 8 -  Set dfRnk  = NUMBER_Null
.head 8 +  If SalMessageBox('Клієнта не знайдено! Вибрати з довідника?', 'Увага!', MB_IconExclamation | MB_YesNo) = IDYES
.head 9 -  Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.5"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 33092
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.85"
.head 5 -  End X:  8.0"
.head 5 -  End Y:  0.85"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Background Text: Дата угоди
.head 4 -  Resource Id: 33098
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.05"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.0"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfFxType = GetForexType(DAT, DATA, DATB)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Дата надходження
.head 4 -  Resource Id: 33099
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.35"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: DATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.3"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfFxType = GetForexType(DAT, DATA, DATB)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Дата відправки
.head 4 -  Resource Id: 33095
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.65"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: DATB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.6"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfFxType = GetForexType(DAT, DATA, DATB)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfFxType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.9"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 33094
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  2.3"
.head 5 -  End X:  6.4"
.head 5 -  End Y:  2.3"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Background Text: Валюта-А КУПІВЛЯ
.head 4 -  Resource Id: 33097
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.5"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.45"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(KVA)
.head 7 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :NAMVA FROM tabval WHERE kv=:KVA") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! 'ВАЛ-А'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrKVA'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NAMVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    2.5"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Валюта-Б ПРОДАЖ
.head 4 -  Resource Id: 33096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.8"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.75"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(KVA)
.head 7 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :NAMVB FROM tabval WHERE kv=:KVB") 
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! 'ВАЛ-Б'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FOREX.cTErrKVB'), 
     CurrentLangTable.GetAtomTitle('FOREX.cTErr'), 0 )
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NAMVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    2.8"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 33100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  3.15"
.head 5 -  End X:  6.4"
.head 5 -  End Y:  3.15"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   3.4"
.head 5 -  Top:    3.3"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sMsg = STRING_Null
.head 6 +  If SalIsNull(dfRnk)
.head 7 -  Set sMsg = 'РНК'
.head 7 -  Set hField = dfRnk
.head 6 +  Else If SalIsNull(DAT)
.head 7 -  Set sMsg = 'Дата угоди'
.head 7 -  Set hField = DAT
.head 6 +  Else If SalIsNull(DATA)
.head 7 -  Set sMsg = 'Дата надходження'
.head 7 -  Set hField = DATA
.head 6 +  Else If SalIsNull(DATB)
.head 7 -  Set sMsg = 'Дата відправки'
.head 7 -  Set hField = DATB
.head 6 +  Else If SalIsNull(KVA)
.head 7 -  Set sMsg = 'Валюта-А КУПІВЛЯ'
.head 7 -  Set hField = KVA
.head 6 +  Else If SalIsNull(KVB)
.head 7 -  Set sMsg = 'Валюта-Б ПРОДАЖ'
.head 7 -  Set hField = KVB
.head 6 +  If sMsg != STRING_Null
.head 7 -  Call SalMessageBox('', 'Не заполнено ' || sMsg, MB_Ok)
.head 7 -  Call SalSetFocus(hField)
.head 7 -  Return FALSE
.head 6 -  Set nRnk = dfRnk
.head 6 -  ! If SalMessageBox('Показать свободные счета клиента ' || PutCrLf() || '   ' || dfNmk || PutCrLf() ||
'по сделке ' || GetForexType(DAT, DATA, DATB) || ' ?', '', MB_YesNo) = IDYES
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    3.3"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Background Text: Тип FOREX-угоди
.head 4 -  Resource Id: 14843
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.95"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: SearchCustomer
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPrepareAndExecute(hSql(), "select nmk into :dfNmk from v_customer where rnk = :dfRnk")
.head 6 -  Return FALSE
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Receive Number: nRnk
.head 3 -  Receive String: sForexType
.head 3 -  Receive Number: nKvA
.head 3 -  Receive Number: nKvB
.head 2 +  Window Variables
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 3 -  String: sMsg
.head 3 -  Window Handle: hField
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set DAT  = GetBankDate()
.head 4 -  Set DATA = DAT
.head 4 -  Set DATB = DAT
.head 4 -  Set dfFxType = GetForexType(DAT, DATA, DATB)
