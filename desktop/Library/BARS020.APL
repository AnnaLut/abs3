Application Description: ! Факторинг + Фючерс
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B30000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 020000000019453A 5C4261727339385C 62696E5C42415253 3032302E65786519
0020: 453A5C4261727339 385C62696E5C4241 52533032302E646C 6C19453A5C426172
0040: 7339385C62696E5C 424152533032302E 6170630000010101 1D453A5C42617273
0060: 39385C4C49425241 52595C4241525330 32302E72756E1D45 3A5C426172733938
0080: 5C4C494252415259 5C42415253303230 2E646C6C1D453A5C 4261727339385C4C
00A0: 4942524152595C42 4152533032302E61 7063000001010118 5C6261727339385C
00C0: 42494E5C42415253 3032302E61706420 175C626172733938 5C42494E5C424152
00E0: 533032302E646C6C 175C626172733938 5C42494E5C424152 533032302E617063
0100: 00000101011D453A 5C4261727339385C 4C4942524152595C 424152533032302E
0120: 61706C1D453A5C42 61727339385C4C49 42524152595C4241 52533032302E646C
0140: 6C1D453A5C426172 7339385C4C494252 4152595C42415253 3032302E61706300
0160: 00010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: Nsiapi.apd
		Dynalib: FListApi.apd
		! Dynalib: Bars011.apd
		Dynalib: Bars010.apd
		File Include: Docfun6.apl
		! File Include: DocWis6.apl
		File Include: GENTBL.APL
		File Include: GENTBLF.APL
		File Include: Gentbls.apl
		File Include: Genlist.apl
		File Include: Vtmeter.apl
		File Include: Vtfile.apl
		File Include: Vtarray.apl
		File Include: Vtmsgbox.apl
		File Include: Vttblwin.apl
		File Include: Vtdos.apl
		File Include: XSALCPT.APL
		File Include: XSALSPL.APL
		!
		Dynalib: Custacnt.apd
		Dynalib: Cc_doc.apd
		Dynalib: Docview.apd
		Dynalib: Otcn.apd
		! Dynalib: Bars017.apd
		! !
		Dynalib: PRINTAPI.apd
		Dynalib: DEPO.apd
		! ! ! !
		! File Include: Winapi.apl
		File Include: vttblwin.apl
		File Include: Genlabel.apl
		File Include: XSALIMG.APL
		File Include: qckdvc.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd-MM
			Date/Time: dd/MM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum = '20'
				String: ApdVer = '01'
		Resources
		Variables
.data RESOURCE 0 0 1 1463251235
0000: 380000001C000000 0000000000000000 0200000200000014 010000E002040000
0020: 00FF3F1801820001 0D000000FFFF
.enddata
			String: sDecimal2  ! симв десятичной точки alt
			String: sDecimal   ! симв десятичной точки
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin5 
			Window Handle: h_AG2
			Window Handle: h_AG3
			Number: nFetchRes
			Boolean: bApdInited
			! ! Окна факторинга
			String: NBS_SP ! Бал.сч Просрочки (м.б.2062)
			String: NBS_SPN ! Бал.сч Просрочки %(м.б.2068) 
			String: NLS_6111
			String: NMS_6111
			String: NLS_3619
			String: NMS_3619
			String: NLS_9900
			String: NMS_9900 
			String: NOT_2036 
			String: SD6023 
			String: KOM_AVA2
			Window Handle: h_FA0
			Window Handle: h_FA1
			Window Handle: h_XCP
			Window Handle: h_XCP_XSL
			Window Handle: h_XCR
			Window Handle: h_FA2
			Window Handle: h_FA3
			Window Handle: h_FA4
			Window Handle: h_FA5
			Window Handle: h_FA6
			Window Handle: h_FA7 
			! Window Handle: h_FA8 
			Window Handle: h_X1
			Window Handle: h_L1
			Window Handle: h_L2
			! !
			Window Handle: hWinPK
			Window Handle: hTA2
		Internal Functions
			Function: f_Tochka
				Description:
				Returns
				Parameters
					Window Handle: hWnd
				Static Variables
					String: sTmp
				Local variables
				Actions
					If sDecimal = STRING_Null OR sDecimal2 = STRING_Null
						Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
						Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
					Set sTmp=SalStrRepeatX( ' ', 20 )
					Call SalGetWindowText ( hWnd, sTmp, 20 )
					While SalStrScan(sTmp, sDecimal2) > 0
						Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					Call SalFmtStrToField ( hWnd, sTmp, TRUE)
			Function: Sel020				! __exported
				Description: Bars020_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
				Actions
					! надо вставить инициализацию apd
					Call Ini020() ! инициализация
					If nMode >= 303 and  nMode <= 353 
						! Договора о хранении ЦБ в депозирарии банка (для УПБ)
						If IsWindow(h_XCP)
							Call SalDestroyWindow(h_XCP )
						Set h_XCP = SalCreateWindow( XCP, hWndParent, nMode, nPar, strPar01,strPar02 )
					Else
						If NBS_SP = STRING_Null
							If SqlPrepareAndExecute( hSql(),
									"select '2030' into :NBS_SP from fak_param where par='NBS_SP' and val='1'" ) 
									and SqlFetchNext(hSql(), nFetchRes) 
								Set NBS_SPN = '2039'
							Else
								Set NBS_SP  = '2063' !!2062
								Set NBS_SPN = '2068'
						If KOM_AVA2 = STRING_Null
							If SqlPrepareAndExecute( hSql(),
									  "Select Substr(val,1,1) into :KOM_AVA2 from FAK_PARAM where par='KOM_AVA2'" )
									and NOT SqlFetchNext(hSql(), nFetchRes) 
								Set KOM_AVA2 = '0'
						Select Case nMode
							! Фючерс
							Case 1  ! Регистрация договоров и ввод заявок
								If not IsWindow(hWin0)
									Set hWin0 = SalCreateWindow( T0, hWndParent, nMode, nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( T0 )
								Break
							Case 2  ! Авторизация заявок
								If not IsWindow(hWin3)
									Set hWin3 = SalCreateWindow( frm_TA, hWndParent, nMode, nPar, strPar01,strPar02 )
									! Set hWin3 = SalCreateWindow( TA, hWndParent, nMode, nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( hWin3 )
								Break
							Case 3  ! Позиції клієнтів
								If not IsWindow(hWinPK)
									Set hWinPK = SalCreateWindow( TPK, hWndParent, nMode, nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( TPK )
								Break
							! !!!!!!!!!!!!
							Case 100 ! ! Лимиты по холдингу
								If not IsWindow(h_X1)
									Set h_X1 = SalCreateWindow( XL1, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_X1 )
								Break
							Case 101 ! ! Лимиты на банки
								If not IsWindow(h_L1)
									Set h_L1 = SalCreateWindow( L1, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_L1 )
								Break
							! Факторинг
							Case 200 ! Картотека Инвойсов
								If not IsWindow(h_FA5)
									Set h_FA5 = SalCreateWindow( FA5, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA5 )
								Break
							! Case 201 ! ФАКТОРИНГ.НЕраспознанные поступления (только привязка)
								                                                                                                                                  If not IsWindow(h_FA6)
									                                                                                                                                  Set h_FA6 = SalCreateWindow( FA6, hWndMDI, nMode, nPar , strPar01, strPar02 )
								                                                                                                                                  Else 
									                                                                                                                                  Call SalBringWindowToTop ( h_FA6 )
								                                                                                                                                  Break 
							Case 201 ! ФАКТОРИНГ.НЕраспознанные поступления привязка с указанием сумм
								If not IsWindow(h_FA7)
									Set h_FA7 = SalCreateWindow( FA7, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA7 )
								Break
							Case 203 ! Договора факторинга Портфель
								If not IsWindow(h_FA1)
									Set h_FA1 = SalCreateWindow( FA1, hWndParent, nMode, nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA1 )
								Break
							Case 204 ! Договора факторинга Один ДОГОВОР
								If not IsWindow(h_FA2)
									Set h_FA2 = SalCreateWindow( FA2, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA2 )
								Break
							Case 205 ! Контракти дебитора
								If not IsWindow(h_FA3)
									Set h_FA3 = SalCreateWindow( FA3, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA3 )
								Break
							Case 206 ! Инвойсы Контракта
								If not IsWindow(h_FA4)
									Set h_FA4 = SalCreateWindow( FA4, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA4 )
								Break
							! Case 208! Особая комиссия по шкале отсрочки (кол дней)
								                                                                If not IsWindow(h_FA8)
									                                                                Set h_FA8 = SalCreateWindow( FA8, hWndMDI, nMode, nPar , strPar01, strPar02 )
								                                                                Else 
									                                                                Call SalBringWindowToTop ( h_FA8 )
								                                                                Break 
							Case 210 ! Архив погашений инвойсов
								If not IsWindow(h_FA0)
									Set h_FA0= SalCreateWindow( FA0, hWndMDI, nMode, nPar , strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( h_FA0 )
								Break
							!
							Case 503 ! Аналіз КП по ЮО у розрізі фінанс.стану позичальника (АЖИО-методика)
								If not IsWindow(h_AG2)
									Set h_AG2 = SalCreateWindow( AG2, hWndParent, nMode, nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( h_AG2 )
								Break
							Default
								Break
					Return TRUE
			Function: Ini020
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						! Инициализация LNG-файла
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars020.lng"
						If (not strLangId) or (not CurrentLangTable.InitFromFile(strFileName, strLangId))
							Call CurrentLangTable.Init()
						! Call DocWisInit('frmDoc.')
						Set bApdInited = TRUE
					Return bApdInited
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength(strText, 160)
					Set nLength = SalGetWindowText(hWndForm, strText, 160)
					Call SalSetWindowText(hWndForm, ApdNum || sWin || ApdVer || ' ' || SalStrTrimX(strText))
			Function: FA_NLS
				Description:
				Returns
					Boolean:
				Parameters
					! String: p6023
				Static Variables
				Local variables
				Actions
					If NLS_6111 = STRING_Null
						If SqlPrepareAndExecute( hSql(),
								"Select a.nls,substr(a.nms,1,38) into :NLS_6111,:NMS_6111 from accounts a,fak_param p
								 where a.dazs is null and p.par='S6111' and p.val=a.nls and a.kv="||Str(GetBaseVal()) )
								and not SqlFetchNext(hSql(), nFetchRes) 
							Call SalMessageBox("Не указан (или ош.) счет 6111*", "Внимание, ошибка в настройках ", MB_IconStop)
							Return FALSE
					If NLS_3619 = STRING_Null
						If SqlPrepareAndExecute( hSql(),
								"Select a.nls,substr(a.nms,1,38) into :NLS_3619,:NMS_3619 from accounts a,fak_param p
								 where a.dazs is null and p.par='S3619' and p.val=a.nls and a.kv="||Str(GetBaseVal()) )
								and not SqlFetchNext(hSql(), nFetchRes) 
							Call SalMessageBox("Не указан (или ош.) счет 3619*", "Внимание, ошибка в настройках ", MB_IconStop)
							Return FALSE
					If NLS_9900 = STRING_Null
						If SqlPrepareAndExecute( hSql(),
								"Select a.nls,substr(a.nms,1,38) into :NLS_9900,:NMS_9900 from accounts a,fak_param p
								 where a.dazs is null and p.par='S9900' and p.val=a.nls and a.kv="||Str(GetBaseVal()) )
								and not SqlFetchNext(hSql(), nFetchRes) 
							Call SalMessageBox("Не указан (или ош.) счет 9900*" ,"Внимание, ошибка в настройках ", MB_IconStop)
							Return FALSE
					Return TRUE
			Function: F_ASG
				Description:
				Returns
					Boolean:
				Parameters
					String: sTmp
				Static Variables
				Local variables
					String: sErr
				Actions
					Call SalWaitCursor(TRUE)
					Set sErr = 'Выполнена процедура'||sTmp
					If SqlPLSQLCommand( hSql(), sTmp )
						Call SqlCommit( hSql())
						Call SalWaitCursor(FALSE)
						Call MessageNoWait( sErr, 'Сообщение', 3, 0)
					Else
						Call SqlRollback(hSql())
						Call SalWaitCursor(FALSE)
						Call MessageNoWait('НE '||sErr, 'Ошибка', 0, 1)
			Function: DEB_2030
				Description: Выдача аванса по инвойсу ( без комиссии всегда !!! )
				Returns
				Parameters
					Number: ND 
					Number: RNK_D 
					Number: SA 
					Number: SAVA 
					Number: NI
					Date/Time: DDOC
					String: NDOC
					Number: SDOC
					String: NLS_D 
					String: NMK_D
					String: OKPO_D
					Number: RNK_K 
					String: NLS_K
					String: NMK_K
					String: OKPO_K
					Number: ACCD
				Static Variables
				Local variables
					Number: nSA 
					Date/Time: bDat
					String: sBankMfo
					!
					Number: n980
					Number: nRef
					String: s9129
					String: s9900
					: cDoc
						Class: cDoc
					!
					String: sNlsK
					String: sMfoK
					String: sTT
				Actions
					Set bDat = GetBankDate()
					Set n980 = GetBaseVal()
					Set sBankMfo = GetBankMfo()
					If SqlPrepareAndExecute( hSql(),
							"SELECT nlsa, Substr(FAKTOR.NLS(:ND,:RNK_D,'9129'),1,15)
							 INTO :s9900, :s9129 from tts where tt='CR9' " )
							and SqlFetchNext(hSql(), nFetchRes)
						Set nSA = SA *100
						! Д-2030  К-2600  nSA  
						If NLS_K = STRING_Null
							Set sTT = 'KK2'
							If SqlPrepareAndExecute( hSql(),
									"SELECT MFO, NLS INTO :sMfoK, :sNlsK 
									 from CORPS_ACC where rnk=:RNK_K and NLS like '26%' and kv=:n980 " )
									and SqlFetchNext(hSql(), nFetchRes)
						Else
							Set sNlsK = NLS_K
							Set sMfoK = sBankMfo
							Set sTT = 'KK1'
						Call cDoc.SetDoc
								(nRef, sTT, 1, 1, Str(NI),
								     DDOC, SalDateCurrent(), bDat, bDat ,
								     NLS_D, NMK_D, sBankMfo, '', n980, nSA, OKPO_D,
								     sNlsK, NMK_K, sMfoK, '', n980, nSA, OKPO_K,
								     "Перерахування авансу за уступленим документом № "||NDOC ||
								     " від "||SalFmtFormatDateTime( DDOC, "dd/MM/yyyy" ) ||
								     " на суму "|| SalNumberToStrX( SDOC,2),
								     '',     GetIdOper(), '', NUMBER_Null, 0)
						If cDoc.oDoc()
							Set nRef = cDoc.m_nRef
							If cDoc.PayTT(0,nRef, bDat, 'CR9', 1, n980, s9900, nSA,n980,s9129, nSA )
								Set nSA = SAVA*100 + nSA
								If SqlPrepareAndExecute( hSql(),"UPDATE FAK_Invoice set SAVA=:nSA,SOS=2,dAVA=:bDat where ni=:NI") 
									Return TRUE
								! If SqlPrepareAndExecute( hSql(),"UPDATE FAK_Invoice set SAVA=:nSA,SOS=2,dAVA=:bDat where ni=:NI") 
										and SqlPLSQLCommand( hSql(),"FAKTOR.MDATE_2030(ACCD,NI)" )
									                                                               Return TRUE
					Return FALSE
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbExecute
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_StrId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: XCP
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Договора о хранении ЦБ в депозитарии банка
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.952"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Option Button: op_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.488"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: White
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые договора' )
						On SAM_Click
							If op_Clos
								Set hWndForm.XCP.sFilter0 = " = "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pb_XSL )
								Call SalDisableWindow( pb_2909 )
								Call SalDisableWindow( pb_2909r) 
								Call SalDisableWindow( pb_Prosr) 
								Call SalDisableWindow( pb_2600 )
								!
							Else
								Set hWndForm.XCP.sFilter0 = " < "
								Call SalEnableWindow( pbIns )
								Call SalEnableWindow( pbUpdate )
								Call SalEnableWindow( pbDel )
								Call SalEnableWindow( pb_XSL )
								Call SalEnableWindow( pb_2909 )
								Call SalEnableWindow( pb_2909r) 
								Call SalEnableWindow( pb_Prosr) 
								Call SalEnableWindow( pb_2600 )
								! Call SalEnableWindow( hWndForm )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 50757
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  8.5"
						Width Editable? Yes
						Height: 0.833"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Открыть Новый договор с Клиентом '
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть действующий договор с Клиентом '
						On SAM_Click
							If hWndForm.XCP.F_Close()
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт Клиента (просмотр)'
						On SAM_Click
							If hWndForm.XCP.TYPE = 2 and hWndForm.XCP.RNK > 0
								Call EditCustCorps ( hWndForm.XCP.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
							Else If hWndForm.XCP.TYPE = 3 and hWndForm.XCP.RNK > 0
								Call EditCustPerson( hWndForm.XCP.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
							Else If hWndForm.XCP.TYPE = 1 and hWndForm.XCP.RNK > 0
								Call EditCustBanks ( hWndForm.XCP.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Табличная форма счетов договора (С редактированием)"
						On SAM_Click
							If hWndForm.XCP.ND != NUMBER_Null
								Set hWndForm.XCP.sTmp = 
										" ( a.tip in ('SK0','SK9') and a.acc in (select acc from nd_acc WHERE nd=" || 
										Str(hWndForm.XCP.ND)||"))"
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, hWndForm.XCP.sTmp )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Background Text: Договора
					Resource Id: 38107
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.883"
						Top:    0.512"
						Width:  1.667"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: dKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.488"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Общее количество Договоров')
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Line
					Resource Id: 1524
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 1525
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 1526
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Frame
					Resource Id: 38106
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  4.8"
						Width Editable? Yes
						Height: 0.833"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Data Field: NLS_2909
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						! On SAM_TooltipSetText
							                                           Return XSalTooltipSetText( lParam, 'Общее количество Договоров факторинга')
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '"Котловой" Счет гашения')
						On SAM_SetFocus
							Set hWndForm.XCP.sTmpE = hWndForm.XCP.NLS_2909
						On SAM_AnyEdit
							Set hWndForm.XCP.NLS_2909 = hWndForm.XCP.sTmpE
				Data Field: OST_2909С
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.483"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Факт.Остаток на счете гашения '|| hWndForm.XCP.NLS_2909)
				Data Field: dKV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.155"
							Width:  0.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код валюты счета гашения '|| hWndForm.XCP.NLS_2909)
						On SAM_Validate
							Return hWndForm.XCP.F_2909()
				Data Field: OST_2909
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'План.Остаток на счете гашения '|| hWndForm.XCP.NLS_2909)
				Data Field: XCP_OST
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.483"
							Top:    0.488"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Остаток на счете гашения по картотеке XCP_Ref' )
				!
				Pushbutton: pb_XSL ! Принять начисления
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Принять Начисления из локальной задачи'
						On SAM_Click
							If IsWindow( h_XCP_XSL )
								Call SalDestroyWindow( h_XCP_XSL )
							Set h_XCP_XSL = 
									SalCreateWindow( XCP_XLS, hWndMDI, 
									                          hWndForm.XCP.nMode, hWndForm.XCP.pGrp, strTip, 
									                          hWndForm.XCP.pXCP || hWndForm.XCP.strPar02 )
				Background Text: <---->
					Resource Id: 38102
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.283"
						Top:    0.262"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_2909 ! Разобрать счет гашения
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Разобрать счет гашения '|| hWndForm.XCP.NLS_2909
						On SAM_Click
							Call F1_Select(13,
									"xcp.XCP_POG("||Str(hWndForm.XCP.nMode)||",'" || hWndForm.XCP.NLS_2909 || "');" || 
									strTip || 
									" ?;Разбор завершен !" )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pb_2909r ! Разобрать ВРУЧНУЮ счет гашения
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Разобрать ВРУЧНУЮ счет гашения '|| hWndForm.XCP.NLS_2909
						On SAM_Click
							If IsWindow( h_XCR )
								Call SalDestroyWindow( h_XCR )
							Set h_XCR = SalCreateWindow( XCR, 
									                             hWndMDI, 
									                             hWndForm.XCP.nMode, hWndForm.XCP.pGrp, hWndForm.XCP.pXCP, strTip, 
									                             hWndForm.XCP.NLS_2909 )
				!
				Pushbutton: pb_Prosr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip =
									'Перенос комиссионного долга на просрочку'
						On SAM_Click
							Call F1_Select(13,
									"xcp.XCP_PRS("||Str(hWndForm.XCP.nMode)||",STRING_Null);" || 
									strTip ||
									" ?;Перенос завершен !" )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Background Text: <---->
					Resource Id: 38105
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.283"
						Top:    0.595"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_2600 ! Взыскать c расчетных сч
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Взыскать просроченную задолженность с расчетных счетов'
						On SAM_Click
							Call F1_Select(13,
									"xcp.XCP_POG("||Str(hWndForm.XCP.nMode)||",STRING_Null);" || 
									strTip || 
									" ?;Взыскание завершено !" )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Background Text: Комиссия
					Resource Id: 38103
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.383"
						Top:    0.512"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Pushbutton: Del_ACC2600
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\CANCEL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Dark Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Отвязать от догорора Р/счет клиента
									( в тч закрытый )'
						On SAM_Click
							If hWndForm.XCP.ACC_2600_OLD != NUMBER_Null
								If SqlPrepareAndExecute( hSqlAux2(), 
										"DELETE from nd_acc where nd= :hWndForm.XCP.ND and acc=:hWndForm.XCP.ACC_2600_OLD" )
										and SqlCommitEx( hSql(), "Отвязан счет "|| hWndForm.XCP.NLS_2600|| 
										" от дог.,реф="||Str(hWndForm.XCP.ND) )
									Set NLS_2600 = STRING_Null
									Set OST_2600 =NUMBER_Null
									Set OST_2600C=NUMBER_Null
									Set ACC_2600 =NUMBER_Null
									Set ACC_2600_OLD =NUMBER_Null
		Contents
			Column: TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If ND = NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER","NMK", " CUSTOMER.custtype > 0 and CUSTOMER.DATE_OFF is null",sTmp,NMK)
							If sTmp  != STRING_Null
								Set RNK = Val(sTmp)
								Set DAT1= bDat
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.
						№ дог.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						 Нач
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT1 > DAT4 and DAT4 != DATETIME_Null
							Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
									"Внимание, ошибка !", MB_IconStop)
							Set DAT1 = DAT4
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						кон
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT4 < DAT1 and DAT1 != DATETIME_Null
							Call SalMessageBox("Дата-завершения МЕНЬШЕ Даты-начала",
									"Внимание, ошибка !", MB_IconStop)
							Set DAT4 = DAT1
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If KV = NUMBER_Null 
							Set KV = n980 
					On SAM_Validate
						If KV != n980 
							If SqlPrepareAndExecute( hSql(),
									"SELECT name into :sTmp from tabval where kv=:KV and D_CLOSE is null")
									and SqlFetchNext(hSql(), nFetchRes) 
									and SalMessageBox("Внимание! Выбрано валюту ? ",sTmp, MB_IconQuestion | MB_YesNo) = IDYES
								Return VALIDATE_Ok
							Else
								Call SalMessageBox('Ошибочный код валюты', "Ошибка ! ", MB_IconStop)
								! Set KV = n980 
								Return VALIDATE_Cancel
			Column: NLS_3578
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3578
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NLS_3578 = STRING_Null and RNK > 0 and ND > 0
							If SqlPrepareAndExecute( hSql(),
									"SELECT substr(f_newnls2(null,:pXCP,'3578',:RNK,NULL,:KV),1,14)
									 INTO :NLS_3578 from dual") 
									and SqlFetchNext(hSql(), nFetchRes) 
									and NLS_3578 != STRING_Null
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm),ROW_Edited,TRUE )
						Else
							Set sNls = NLS_3578
					On SAM_Validate
						If NLS_3578 != STRING_Null 
							If ACC_3578 = NUMBER_Null
								If SqlPrepareAndExecute( hSql(),
										"SELECT acc from accounts where kv=:KV and nls =:NLS_3578 
										    and (rnk<>:RNK or dazs is not null) ")
										and SqlFetchNext(hSql(), nFetchRes)
									Call SalMessageBox('Cчет '||NLS_3578||' принадлежжит др.клиенту или закрыт', 
											"Ошибка ! ", MB_IconStop)
									Set NLS_3578 = sNls
			Column: OST_3578C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.ост.
						3578
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_3578
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пл.ост.
						3578
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_3579
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3579
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NLS_3579 = STRING_Null and RNK > 0 and ND > 0
							If SqlPrepareAndExecute( hSql(),
									"SELECT substr(f_newnls2(null,:pXCP,'3578',:RNK,NULL,:KV),1,14)
									 INTO :NLS_3579 from dual") 
									and SqlFetchNext(hSql(), nFetchRes) 
									and NLS_3579 != STRING_Null
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm),ROW_Edited,TRUE )
						Else
							Set sNls = NLS_3579
					On SAM_Validate
						If NLS_3579 != STRING_Null 
							If ACC_3579 = NUMBER_Null
								If SqlPrepareAndExecute( hSql(),
										"SELECT acc from accounts where kv=:KV and nls =:NLS_3579 
										    and (rnk<>:RNK or dazs is not null) ")
										and SqlFetchNext(hSql(), nFetchRes)
									Call SalMessageBox('Cчет '||NLS_3579||' принадлежжит др.клиенту или закрыт', 
											"Ошибка ! ", MB_IconStop)
									Set NLS_3579 = sNls
			Column: OST_3579C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.ост.
						3579
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_3579
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пл.ост.
						3579
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_2600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Р/Счет
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If RNK != NUMBER_Null and KV != NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("ACCOUNTS","NLS", 
									"ACCOUNTS.nbs in ('2600','2650','2620') and ACCOUNTS.DAZS is null and "||
									"ACCOUNTS.kv="||Str(KV)||" and ACCOUNTS.rnk="||Str(RNK),
									sTmp,sNls2)
							If sTmp  != STRING_Null
								If ACC_2600_OLD = NUMBER_Null OR ACC_2600_OLD != ACC_2600
									Set ACC_2600 = Val(sTmp)
									Set NLS_2600 = sNls2
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm),ROW_Edited,TRUE)
			Column: OST_2600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: П.плат.ресурс
						2600
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_2600C
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ф.плат.ресурс
						2600
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC_3578
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3578
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_3579
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3578
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_2600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3578
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_2600_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						3578
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_2909
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.XCP.dKV != hWndForm.XCP.n980 
						If SqlPrepareAndExecute( hSql(),"SELECT name into :sTmp from tabval where kv=:dKV ")
								and NOT SqlFetchNext(hSql(), nFetchRes) 
							Call SalMessageBox('Ошибочный код валюты', "Ошибка ! ", MB_IconStop)
							Return VALIDATE_Cancel
					If SqlPrepareAndExecute( hSql(),
							"SELECT ostC/100, ostB/100,  XCP.XCP_OST(KV,NLS)/ 100  
							 INTO :hWndForm.XCP.OST_2909С, :hWndForm.XCP.OST_2909, :hWndForm.XCP.XCP_OST 
							 from accounts where kv = :hWndForm.XCP.dKV and nls = :hWndForm.XCP.NLS_2909 ")
							and SqlFetchNext(hSql(), nFetchRes)
						Return VALIDATE_Ok
					! !!!!
					Call SalMessageBox('Не открыт счет ' || hWndForm.XCP.NLS_2909 || 
							' по коду валюты ' || Str(hWndForm.XCP.dKV), "Ошибка ! ", MB_IconStop)
					Return VALIDATE_Cancel
			Function: F_Close
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sErr
				Actions
					Set sErr = STRING_Null
					If hWndForm.XCP.DAT4 != DATETIME_Null AND hWndForm.XCP.DAT4 > hWndForm.XCP.bDat
						Set sErr = "Дата завершения дог.№ " || hWndForm.XCP.CC_ID || "
								 " || SalFmtFormatDateTime( hWndForm.XCP.DAT4, "dd/MM/yyyy" ) ||" еще НЕ наступила !"
					Else If 
							(hWndForm.XCP.OST_3578C != NUMBER_Null and hWndForm.XCP.OST_3578C>0 OR 
							 hWndForm.XCP.OST_3578  != NUMBER_Null and hWndForm.XCP.OST_3578 >0 OR
							 hWndForm.XCP.OST_3579C != NUMBER_Null and hWndForm.XCP.OST_3579C>0 OR
							 hWndForm.XCP.OST_3579  != NUMBER_Null and hWndForm.XCP.OST_3579 >0 )
						Set sErr = "По сч. дог.№ " || hWndForm.XCP.CC_ID || " есть НЕНУЛЕВЫЕ остатки ! "
					Else If 
							SqlPrepareAndExecute( hSql(),
							"select 1 from saldoa 
							 where fdat = :hWndForm.XCP.bDat 
							   and acc in ( :hWndForm.XCP.ACC_3578 , :hWndForm.XCP.ACC_3579 )") 
							and SqlFetchNext( hSql(), nFetchRes)
						Set sErr = "По сч. дог.№ " || hWndForm.XCP.CC_ID || " есть обороты за текущий день ! "
					! !!
					If sErr = STRING_Null
						If SalMessageBox(
								"Выполнить закрытие дог № " || hWndForm.XCP.CC_ID || 
								" от " || SalFmtFormatDateTime( hWndForm.XCP.DAT1, "dd/MM/yyyy" )|| " 
								с одновременным закрытием счетов ? ",
								"Внимание !", MB_IconQuestion | MB_YesNo) = IDYES
							If SqlPrepareAndExecute( hSql(), 
									"UPDATE accounts set dazs = :hWndForm.XCP.bDat where acc = :hWndForm.XCP.ACC_3578 " )
									and SqlPrepareAndExecute( hSql(), 
									"UPDATE accounts set dazs = :hWndForm.XCP.bDat where acc = :hWndForm.XCP.ACC_3579 " )
									and SqlPrepareAndExecute( hSql(), 
									"UPDATE cc_deal set sos=15 where nd = :hWndForm.XCP.ND " )
									and SqlCommitEx( hSql(), 'Закрыт дог.'|| CC_ID )
								Call MessageNoWait( 'Закрыт дог.'|| hWndForm.XCP.CC_ID ,'Сообщение',3,0)
								Return TRUE
							Else
								Call SqlRollback( hSql() )
					If sErr != STRING_Null
						Call SalMessageBox( sErr , "Закрытие дог НЕВОЗМОЖНО ! ", MB_IconExclamation )
					Return FALSE
		Window Parameters
			Number: nMode ! VIDD
			Number: pGrp ! Группа доступа 
			String: pNLS_2909 ! котловой счет гашения
			String: strPar02 ! Сч доходов для проводки Деб.3578 - Крд.NLS6
		Window Variables
			!
			Number: nRed
			Number: nZel
			Number: n980
			Date/Time: bDat
			Date/Time: DAZS
			String: aMfo
			String: sTmp
			! Number: ACC_2909
			Number: nRet
			Number: nAcc
			String: sNls
			String: sFilter
			String: sSql
			Number: nRow
			String: sNls2
			!
			String: sTmpE
			String: sGrp ! Группа доступа 
			Number: nGrp ! Группа доступа 
			String: sIsp ! Исполнитель
			Number: nIsp ! Исполнитель по счету 35*
			Number: nUser
			String: sFilter0
			String: NLS6 ! Сч доходов для проводки Деб.3578 - Крд.NLS6
			String: pXCP ! префикс модуля
			String: tXCP ! наименование модуля
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				! Set pXCP = Subs(strPar02,1,3)
				! Set NLS6 = Subs(strPar02,4,14)
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT tip, name1 into :hWndForm.XCP.pXCP, :hWndForm.XCP.tXCP 
						 from xcp_mod where nmode=:hWndForm.XCP.nMode " )
						and SqlFetchNext( hSqlAux2(), nFetchRes)
					!
					Call SalSetWindowText( hWndForm, hWndForm.XCP.tXCP )
					!
					Set hWndForm.XCP.NLS6 = hWndForm.XCP.strPar02
					Set hWndForm.XCP.aMfo = GetBankMfo()
					Set hWndForm.XCP.n980 = GetBaseVal()
					Set hWndForm.XCP.dKV = n980
					Set hWndForm.XCP.bDat = GetBankDate()
					Set hWndForm.XCP.aMfo = GetBankMfo()
					Set hWndForm.XCP.nUser = GetUserId()
					Set hWndForm.XCP.NLS_2909 = hWndForm.XCP.pNLS_2909
					Set hWndForm.XCP.nRed = SalColorFromRGB( 255,210,210 )
					Set hWndForm.XCP.nZel = SalColorFromRGB( 230,255,230 )
					Call PrepareWindow( hWndForm )
					Call SetWindowFullSize(hWndForm)
					Call SalTblSetLockedColumns( hWndForm, 8 )
					Set hWndForm.XCP.nTabInstance = 2
					!
					Set hWndForm.XCP.op_Clos = FALSE
					Set hWndForm.XCP.sFilter0 = " < "
					!
					Set hWndForm.XCP..strFilterTblName = hWndForm.XCP.pXCP
					Set hWndForm.XCP.strPrintFileName = hWndForm.XCP.pXCP
					!
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString
							 (hWndForm.XCP.pXCP, hWndForm.XCP.pXCP||'_ISP', Str(GetUserId()), 
							  hWndForm.XCP.sIsp, GetIniFileName() )
					Set hWndForm.XCP.nIsp = Val(hWndForm.XCP.sIsp)
					!
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString
							 (hWndForm.XCP.pXCP, hWndForm.XCP.pXCP ||'_GRP', Str(hWndForm.XCP.pGrp),
							  hWndForm.XCP.sGrp, GetIniFileName() )
					Set hWndForm.XCP.nGrp = Val(hWndForm.XCP.sGrp)
					!
					Call SalSendClassMessage(SAM_Create, 0, 0)
				!
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call hWndForm.XCP.F_2909()
				! Call SalSendMsg( dKV, SAM_Validate, 0, 0 )
				Set hWndForm.XCP.dKol =0
				Set hWndForm.XCP.sFilter = ""
				Set hWndForm.XCP.sFilter = cF.GetFilterWhereClause( FALSE )
				Set hWndForm.XCP.sSql =
						"SELECT XCP.RNK,  XCP.NMK,  XCP.OKPO,  XCP.CC_ID,  XCP.ND,  XCP.DAT1,
						        XCP.DAT4, XCP.ACC_3578,  XCP.NLS_3578,  XCP.TYPE,  XCP.OST_3578,
						        XCP.OST_3578C,  XCP.KV
						 INTO  :hWndForm.XCP.RNK,  :hWndForm.XCP.NMK, :hWndForm.XCP.OKPO, 
						       :hWndForm.XCP.CC_ID,:hWndForm.XCP.ND, :hWndForm.XCP.DAT1,
						       :hWndForm.XCP.DAT4, :hWndForm.XCP.ACC_3578, :hWndForm.XCP.NLS_3578, 
						       :hWndForm.XCP.TYPE, :hWndForm.XCP.OST_3578, :hWndForm.XCP.OST_3578C,
						       :hWndForm.XCP.KV
						 FROM (SELECT d.RNK, c.NMK, c.OKPO, d.CC_ID, d.ND, d.sdate DAT1, d.wdate DAT4,
						         n.ACC ACC_3578, n.nls NLS_3578, -n.ostB/100 OST_3578, -n.ostC/100 OST_3578C,
						         c.CUSTTYPE TYPE, n.KV
						       FROM CC_DEAL d, CUSTOMER c , 
							   (SELECT  n.nd, n.acc, a.nls, a.ostb, a.ostc, a.kv 
							    FROM ACCOUNTS a, ND_ACC n  WHERE n.acc=a.acc AND a.tip='SK0' AND a.dazs IS NULL
						           ) n
						       WHERE d.sos " || hWndForm.XCP.sFilter0 || " 15 and d.nd=n.nd(+) 
						         AND d.vidd =" || Str(hWndForm.XCP.nMode) || " 
						         AND d.rnk=c.rnk 
						       ) XCP " || IifS (hWndForm.XCP.sFilter = "", ""," 
						 WHERE "|| hWndForm.XCP.sFilter ) || "
						 ORDER BY ND desc "
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.XCP.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set hWndForm.XCP.nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, hWndForm.XCP.nRow,  ROW_New | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, hWndForm.XCP.nRow)
					If SalTblQueryRowFlags( hWndForm, hWndForm.XCP.nRow, ROW_New )
						If SqlPrepareAndExecute( hSql(),
								  "SELECT BARS.S_CC_DEAL.NEXTVAL into :hWndForm.XCP.ND from dual") 
								and SqlFetchNext(hSql(), nFetchRes) 
								and SqlPrepareAndExecute( hSql(),
								   "INSERT into cc_deal(nd,SOS,CC_ID,SDATE,WDATE,rnk,VIDD,LIMIT,USER_ID) values 
								(:hWndForm.XCP.ND, 10, :hWndForm.XCP.CC_ID, :hWndForm.XCP.DAT1,
								 :hWndForm.XCP.DAT4, :hWndForm.XCP.RNK, :hWndForm.XCP.nMode, 0, :hWndForm.XCP.nUser ) ")
								and SqlCommitEx( hSql(), "Введен дог.,реф="||Str(hWndForm.XCP.ND) )
					Else
						If SqlPrepareAndExecute( hSql(),
								 "Update cc_deal set cc_id = :hWndForm.XCP.CC_ID, 
								                     SDATE = :hWndForm.XCP.DAT1,
								                     WDATE = :hWndForm.XCP.DAT4 
								  where nd=:hWndForm.XCP.ND" )
								and SqlCommitEx( hSql(), "Обновлен дог.,реф="||Str(hWndForm.XCP.ND) )
					! При открытии 3578 и 3579 должны ставиться спецпараметры:
							      3578    R011=Z, R013=3, S180=5, S240=5
							      3579    R011=Z, R013=1
					If hWndForm.XCP.NLS_3578 != STRING_Null and hWndForm.XCP.ACC_3578 = NUMBER_Null
						! Открываем /Обновляем счет
						If Op_Reg(9,0,0,hWndForm.XCP.nGrp, hWndForm.XCP.nRet, hWndForm.XCP.RNK, 
								                hWndForm.XCP.NLS_3578, hWndForm.XCP.KV, hWndForm.XCP.NMK,
								         'SK0', hWndForm.XCP.nIsp, hWndForm.XCP.ACC_3578 )
							! Связываем счет с дог
							If SqlPrepareAndExecute( hSql(),
									 "INSERT into nd_acc(nd,acc) values (:hWndForm.XCP.ND,:hWndForm.XCP.ACC_3578)") 
								! Если в спец.парам нет- то вставляем туда
								If SqlPrepareAndExecute(hSql(),
										"select 1 from specparam where acc=:hWndForm.XCP.ACC_3578") 
										and NOT SqlFetchNext( hSql(), nFetchRes)
									If SqlPrepareAndExecute(hSql(),
											  "INSERT into specparam(acc,R011,R013,S180,S240) values 
											( :hWndForm.XCP.ACC_3578, 'Z','3','5','5')") 
							! соммит
							Call SqlCommitEx( hSql(), 
									"Привязан счет "|| hWndForm.XCP.NLS_3578||" к дог.,реф="||Str(hWndForm.XCP.ND) ) 
					If hWndForm.XCP.NLS_3579 != STRING_Null and hWndForm.XCP.ACC_3579 = NUMBER_Null
						If Op_Reg(9,0,0,hWndForm.XCP.nGrp, hWndForm.XCP.nRet, hWndForm.XCP.RNK, 
								                hWndForm.XCP.NLS_3579, hWndForm.XCP.KV, hWndForm.XCP.NMK, 
								         'SK9', hWndForm.XCP.nIsp, hWndForm.XCP.ACC_3579 )
							If SqlPrepareAndExecute( hSql(),
									  "INSERT into nd_acc(nd,acc) values (:hWndForm.XCP.ND,:hWndForm.XCP.ACC_3579)") 
									AND SqlPrepareAndExecute(hSql(),
									  "INSERT into specparam(acc,R011,R013) values ( :hWndForm.XCP.ACC_3579, 'Z', '1' )") 
									and SqlCommitEx( hSql(), "Привязан счет "||hWndForm.XCP.NLS_3579||" к дог.,реф="||Str(hWndForm.XCP.ND) )
					If hWndForm.XCP.ACC_2600 != NUMBER_Null 
						If hWndForm.XCP.ACC_2600_OLD != NUMBER_Null  
							If SqlPrepareAndExecute( hSql(),
									"delete from nd_acc N where N.nd=:hWndForm.XCP.ND and exists
									 (select 1 from accounts where nbs like '26%' and acc=N.ACC)") 
						If SqlPrepareAndExecute( hSql(),"insert into nd_acc(nd,acc) values 
								 ( :hWndForm.XCP.ND, :hWndForm.XCP.ACC_2600 )") 
								and SqlCommitEx( hSql(), "Привязан счет "||hWndForm.XCP.NLS_2600|| " к дог.,реф="||Str(hWndForm.XCP.ND) )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set hWndForm.XCP.dKol = hWndForm.XCP.dKol + 1
				! Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
				If hWndForm.XCP.DAT4 <= hWndForm.XCP.bDat
					Call XSalTblSetCellBackColor( hWndForm.XCP.DAT4, hWndForm.XCP.nRed )
				If hWndForm.XCP.CC_ID = STRING_Null
					Call XSalTblSetCellBackColor( hWndForm.XCP.CC_ID, hWndForm.XCP.nRed )
				If hWndForm.XCP.DAT1 = DATETIME_Null OR hWndForm.XCP.DAT1 > hWndForm.XCP.bDat
					Call XSalTblSetCellBackColor( hWndForm.XCP.DAT1, hWndForm.XCP.nRed )
				If hWndForm.XCP.NLS_3578 = STRING_Null
					Call XSalTblSetCellBackColor( hWndForm.XCP.NLS_3578, hWndForm.XCP.nRed )
				Else
					If hWndForm.XCP.OST_3578 != hWndForm.XCP.OST_3578C
						Call XSalTblSetCellBackColor( hWndForm.XCP.OST_3578, hWndForm.XCP.nZel )
				! 2600
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT a.acc, a.NLS, (a.ostB+a.LIM)/100, (a.ostC+a.LIM)/100 , a.dazs 
						 into :hWndForm.XCP.ACC_2600_OLD, :hWndForm.XCP.NLS_2600, :hWndForm.XCP.OST_2600, 
						      :hWndForm.XCP.OST_2600C, :hWndForm.XCP.DAZS 
						 from accounts a, nd_acc n 
						 where a.rnk = :hWndForm.XCP.RNK and a.nbs in ('2600','2650','2620') 
						   and a.acc = n.acc and n.nd = :hWndForm.XCP.ND" )
						and SqlFetchNext( hSqlAux2(), nFetchRes)
					If hWndForm.XCP.OST_2600 != hWndForm.XCP.OST_2600C
						Call XSalTblSetCellBackColor( hWndForm.XCP.OST_2600, hWndForm.XCP.nZel )
					If hWndForm.XCP.DAZS != DATETIME_Null
						Call XSalTblSetCellBackColor( hWndForm.XCP.NLS_2600, COLOR_Gray )
				! 3579
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT a.acc, a.NLS, -a.ostB/100, -a.ostC/100
						 into :hWndForm.XCP.ACC_3579, :hWndForm.XCP.NLS_3579, 
						      :hWndForm.XCP.OST_3579, :hWndForm.XCP.OST_3579C
						 from accounts a, nd_acc n where n.nd=:ND and n.acc=a.acc 
						  and a.tip='SK9' and a.kv =:hWndForm.XCP.KV  and a.dazs is null " )
						and SqlFetchNext( hSqlAux2(), nFetchRes)
					If hWndForm.XCP.OST_3579 != hWndForm.XCP.OST_3579C
						Call XSalTblSetCellBackColor( hWndForm.XCP.OST_3579, hWndForm.XCP.nZel )
	Table Window: XCP_XLS
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.3"
				Top:    0.917"
				Width:  16.683"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31279
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть порожденный документ'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31280
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31281
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.6"
						Begin Y:  Class Default
						End X:  2.6"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить идентификацию и генерацию проводок'
						On SAM_Click
							Call F_Opl()
				Data Field: dNLS6
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.783"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Set dNLS6 = NLS6
						On SAM_Validate
							Call F_NLS6()
				Data Field: NMS6
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.071"
							Width:  4.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование кл
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK_ABS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование кл
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.код
						B
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № дог
						C
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата дог.
						D
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.15"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма пл
						E
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф 
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ERR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ошибка или
						соответствующий счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: N_AKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № акта
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D_AKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата акта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nKv
					Number: nNd
					String: sCC_ID
					String: sNls
					String: sNms 
					String: sNazn1
					String: sNazn
					String: sNaz1
					String: sNaz2
					Number: nRef
					!
					Number: nS
					Number: nSq
					!
					Number: nRet
					String: cFA
				Actions
					If SqlPrepareAndExecute( hSqlAux2(),
							"SELECT nazn1, nazn2 
							 into :sNaz1, :sNaz2 
							 from xcp_mod where nmode=:nMode " )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
						Set nRow = TBL_MinRow
						Set sNazn1 = sNaz1 || " за " ||
								GetMonthName(SalDateMonth(bDat),FALSE)||" мiс. "|| 
								Str(SalDateYear(bDat))|| "р. по акту № "
						Set nRet = 0
						While SalTblFindNextRow( hWndForm, nRow, ROW_New, 0)
							Call SalWaitCursor(TRUE)
							Call SalTblSetContext(hWndForm, nRow)
							Set ERR = STRING_Null
							Set REF = NUMBER_Null
							If SqlPrepareAndExecute( hSqlAux2(),
									  "SELECT c.nmk, c.rnk 
									   INTO :NMK_ABS, :RNK 
									   FROM customer c
									   WHERE to_number(c.okpo)=to_number(:OKPO) and c.DATE_OFF is null ")
									and SqlFetchNext( hSqlAux2(), nFetchRes)
								If SqlPrepareAndExecute( hSqlAux2(), 
										"SELECT d.nd, c.nmk, c.rnk
										 INTO :nNd, :NMK_ABS, :RNK 
										 FROM cc_deal d, customer c
										 WHERE d.sos<15 and d.vidd=:nMode and d.rnk=c.rnk and to_number(c.okpo)=to_number(:OKPO) and c.DATE_OFF is null " )
										and SqlFetchNext( hSqlAux2(), nFetchRes)
									If SqlPrepareAndExecute( hSqlAux2(),
											"SELECT d.nd, d.CC_ID ,c.nmk, c.rnk
											 INTO :nNd, :sCC_ID, :NMK_ABS, :RNK 
											 FROM cc_deal d, customer c 
											 WHERE d.sos<15 and d.vidd=:nMode and d.rnk=c.rnk and to_number(c.okpo)=to_number(:OKPO) and c.DATE_OFF is null 
											   and UPPER(d.cc_id)=UPPER(:CC_ID)" )
											and SqlFetchNext( hSqlAux2(), nFetchRes)
										If SqlPrepareAndExecute( hSqlAux2(),
												"SELECT d.nd, d.CC_ID ,c.nmk, c.rnk
												 INTO :nNd, :sCC_ID, :NMK_ABS, :RNK 
												 FROM cc_deal d, customer c 
												 WHERE  d.sos<15 and d.vidd=:nMode and d.rnk=c.rnk and to_number(c.okpo)=to_number(:OKPO) and c.DATE_OFF is null 
												   and d.cc_id=:sCC_ID and d.sdate=:DAT1 " )
												and SqlFetchNext( hSqlAux2(), nFetchRes)
											!
											Set nS = S * 100
											If SqlPrepareAndExecute( hSqlAux2(),
													  "SELECT a.kv,a.nls,substr(a.nms,1,38), gl.p_icurval(a.kv, :nS,:bDat ) 
													   INTO :nKv,:sNls,:sNms, :nSq 
													   FROM nd_acc n, accounts a
													   WHERE n.nd=:nNd and n.acc=a.acc and a.tip='SK0' and a.nls like '3578%' and a.dazs is null " )
													and SqlFetchNext( hSqlAux2(), nFetchRes)
												Set sNazn = 
														Subs( sNazn1 ||
														N_AKT || " вiд "|| D_AKT || 
														" зг. Дог. " || sNaz2 || " № " || CC_ID ||
														" вiд " ||SalFmtFormatDateTime(DAT1,"dd/MM/yyyy"),1,160) 
												Set ERR = Str(nKv)||'/'||sNls||' '|| sNms
												Set nRef= NUMBER_Null
												!
												Call cDoc.SetDoc( nRef, "XCP", 1, 6, Str(nRef), bDat, bDat, bDat, bDat,
														     sNls, sNms, GetBankMfo(),'', nKv , nS, OKPO,
														     NLS6, NMS6, GetBankMfo(),'', n980, nSq,GetBankOkpoS(),
														     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
												If not cDoc.oDoc()
													Call SqlRollback( hSql() )
													Set ERR = "6) Ош.оплаты"
													Set nRet = nRet + 1
												Else
													Call SqlCommit( hSql() )
													Set REF = cDoc.m_nRef
													Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
											Else
												Set ERR = "5) Не найден сч.3578 по договору"
												Set nRet = nRet + 1
										Else
											Set ERR = "4) Дата договора "
											Set nRet = nRet + 1
									Else
										Set ERR = "3) № договора "
										Set nRet = nRet + 1
								Else
									Set ERR = "2) Не найден ни один договор с клиентом"
									Set nRet = nRet + 1
							Else
								Set ERR = "1) Не найден клиент с Ид.код(ОКПО)"
								Set nRet = nRet + 1
							Call SalWaitCursor(FALSE)
						Set cFA = IifS(nRet>0,sBak,sOk) || '\\'|| strFileName 
						If VisFileRename(sFile, cFA) < 0
							Call SalMessageBox('Не удалось перенести файл ' || cFA, 'Ошибка !', MB_Ok)
						Set sFile = sIn || '\\'|| strFileName
					Return TRUE
			Function: F_NLS6
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If dNLS6 = STRING_Null 
							OR SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT substr(nms,1,38) into :NMS6 from accounts 
							   where kv=:n980 and nls=:dNLS6 and dazs is null " )
							and NOT SqlFetchNext( hSqlAux2(), nFetchRes)
						Call SalMessageBox("Не найден счет начисленных доходов "|| dNLS6 ,"Ошибка ! ", MB_IconStop)
			Function: Imp_3578
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					!
					String: strFilters[*]
					Number: nIndex
					!
					Number: Kol_Col  ! Количество столбцов
					String: Name_Sec ! Имя секции
					String: Telo [*,99999]
					! Telo [*,0] - наименование кл
					! Telo [*,1] - ОКПО кл (без ведущих нулей)
					! Telo [*,2] - № договора
					! Telo [*,3] - Дата договора
					! Telo [*,4] - Сумма начисления
					! Telo [*,5] - № акта 
					! Telo [*,6] - Дата акта
					Number: n   
					Number: i   
					!
					String: sFileM[*]
				Actions
					Call SalWaitCursor(FALSE)
					!
					Call SalFileSetCurrentDirectory(sIn)
					If VisDosEnumFiles( sFile, FA_Standard, sFileM)>0
					Else
						Set strFilters[0] = Titl || ' (*.csv)'
						If sIn != ''
							Set strFilters[1] = sIn || '\\*.csv'
						Else
							Set strFilters[1] = '*.csv'
						Set nIndex = 1
						! Call Debug (strFileName) 
						! Call Debug (sIn) 
						If NOT SalDlgOpenFile ( hWndForm, 'Выбор файла из Лок.задачи',
								 strFilters, 2, nIndex,
								 strFileName, sIn )
							Call SalMessageBox("Не выбран файл !","Ошибка ! ", MB_IconStop)
							Return FALSE
					! ~!!!!
					Set Kol_Col =7
					Set Name_Sec = '1'
					Set i = 0
					! Set n = ImportXLS (sFile, Kol_Col, Name_Sec, Telo )
					Set n = ImportCSV (sFile, ';', Telo )
					!
					If n = -1 !  нет файла
						Call SalMessageBox("Файл "|| sFile || " Не найден ! ","Ошибка ! ", MB_IconStop)
						Return FALSE
					If n > 0
						Call SalWaitCursor(TRUE)
						While i < n
							Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
							Set NMK = Telo [i,0]
							! Set OKPO = SalStrRightX( '0000'||Telo [i,1], 8)
							Set OKPO = Telo [i,1]
							Set CC_ID = SalStrTrimX( Telo [i,2] )
							Set DAT1 = SalStrToDate( Telo [i,3] )
							Set S = Val(Telo [i,4])
							Set N_AKT = SalStrTrimX( Telo [i,5] )
							Set D_AKT = SalStrTrimX( Telo [i,6] )
							Set i = i + 1
							Set NPP = i
						Return TRUE
					!
					Call SalMessageBox("Ош.импорта, код="||Str(n),"Ошибка ! ", MB_IconStop)
					Return FALSE
		Window Parameters
			Number: nMode ! VIDD
			Number: pGrp ! Группа доступа 
			String: Titl
			String: strPar02 ! префикс модуля ||Сч доходов для проводки Деб.3578 - Крд.NLS6
		Window Variables
			String: pXCP ! префикс модуля
			String: NLS6 ! Сч доходов для проводки Деб.3578 - Крд.NLS6
			!
			Number: n980
			Date/Time: bDat
			: cDoc
				Class: cDoc
			!
			String: sIn
			String: strFileName
			String: sFile
			String: sOk
			String: sBak
			String: sIni
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Set pXCP = Subs(strPar02,1,3)
				Set NLS6 = Subs(strPar02,4,14)
				Call SetWindowFont( hWndForm )
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Call SalSetWindowText( hWndForm, pXCP || ':' || Titl )
				Set XCP_XLS.strPrintFileName = pXCP ||'_1'
				!
				Call SalUseRegistry(FALSE, '')
				Set sIni = GetIniFileName()
				! sBak = XCP_BAK 
				Call SalGetProfileString( pXCP, pXCP ||'_BAK','', sBak, sIni )
				If SalFileSetCurrentDirectory( sBak )
				Else
					Call MessageAttention('Нет каталога для ' || pXCP ||'_BAK = ' || sBak )
				! sOk = XCP_OK
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString( pXCP, pXCP ||'_OK', '', sOk, sIni )
				If SalFileSetCurrentDirectory( sOk )
				Else
					Call MessageAttention('Нет каталога для ' || pXCP ||'_OK = ' || sOk )
				! sIn = XCP_IN
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString( pXCP, pXCP ||'_IN', '', sIn, sIni)
				If SalFileSetCurrentDirectory( sIn )
				Else
					Call MessageAttention('Нет каталога для '|| pXCP ||'_IN = ' || sIn)
				! strFileName = XCP_FILE
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString( pXCP, pXCP ||'_FILE','', strFileName, sIni )
				Set sFile = sIn || '\\'|| strFileName
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				! !!!!!!!!!!!!!!!!!!!!!!
			On UM_Populate
				If Imp_3578()
					Call SalWaitCursor(FALSE)
					Call F_NLS6()
			On SAM_DoubleClick
				If REF != NUMBER_Null
					Call DocViewContentsEx(hWndForm, REF )
	Dialog Box: dlg_AVA
		Class:
		Property Template:
		Class DLL Name:
		Title: Подтведите или измените Сумму Аванса
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.844"
				Width:  9.383"
				Width Editable? Yes
				Height: 3.69"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dLIMIT_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения Лимита на Дебитора')
			Data Field: nLIMIT_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Лимит на Дебитора')
			Background Text: =
				Resource Id: 8661
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    0.095"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Data Field: nOST_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Использовано Лимита на Дебитора')
			Background Text: +
				Resource Id: 8660
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.683"
					Top:    0.095"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: nSVOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.283"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'НЕ использовано Лимита на Дебитора')
			!
			Data Field: dLIMIT_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения Лимита на Клиента')
			Data Field: nLIMIT_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Лимит на Клиента')
			Data Field: nOST_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.683"
						Top:    0.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Использовано Лимита на Клиента')
			Data Field: nSVOB_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.283"
						Top:    0.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'НЕ использовано Лимита на Клиента')
			Data Field: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.738"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения договора с ФАКТОРОМ')
			Data Field: DAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения Контракта')
			Data Field: DOPL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата оплаты Инвойса')
			!
			Frame
				Resource Id: 30071
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.183"
					Top:    0.738"
					Width:  4.4"
					Width Editable? Yes
					Height: 1.44"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Pushbutton: pbOk	! Сохранить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   3.2"
					Top:    1.488"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If AVA_LIM ()
							Set nS = dAVA
							Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbClose	! Отменить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   4.583"
					Top:    1.488"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nS = 0
						Call SalEndDialog( hWndForm, FALSE )
			Data Field: dAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    0.988"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Call f_Tochka ( dAVA )
						If AVA_LIM ()
							Return VALIDATE_Ok
						Return VALIDATE_Cancel
			Data Field: dAVA_LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    2.321"
						Width:  7.3"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set dAVA_LIM = " АВАНС > Cвоб.лимита Дебитора "
		Functions
			Function: AVA_LIM
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If dAVA > nSVOB 
						Call SalMessageBox
								("Сумма аванса не может быть БОЛЬШЕ свободного лимита на Дебитора ! ",
								"Ошибка ! ", MB_IconStop)
						Set dAVA = nSVOB
						Call AVA_LIM0 ()
						Return FALSE
					Return TRUE
			Function: AVA_LIM0
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If dAVA > nSVOB 
						Call SalColorSet ( dAVA, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
						Call SalShowWindow( dAVA_LIM )
						Return FALSE
					Else
						Call SalColorSet ( dAVA, COLOR_IndexWindow, COLOR_Sky  )
						Call SalHideWindow( dAVA_LIM )
						Return TRUE
		Window Parameters
			Number: ND
			Number: RNK_D
			Date/Time: pDAT_END
			Date/Time: pDOPL
			Receive Number: nS
		Window Variables
			Number: n980
			String: sErr
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SetWindowFont( hWndForm )
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set DAT_END =pDAT_END
				Set DOPL = pDOPL
			On SAM_CreateComplete
				Set dAVA = nS
				If SqlPrepareAndExecute( hSql(),
						"select -a.ostX/100, -a.ostc/100 , a.MDATE
						 Into :nLIMIT_D, :nOST_D ,:dLIMIT_D
						 FROM nd_acc n, accounts a, cust_acc u
						 WHERE n.nd=:ND and a.acc=n.acc and a.nbs='2030' and u.acc=a.acc and 
						    a.dazs is null and u.RNK=:RNK_D")
						and NOT SqlFetchNext(hSql(), nFetchRes)
				Set nSVOB = nLIMIT_D - nOST_D
				If SqlPrepareAndExecute( hSql(),
						"SELECT d.wdate,  -a8.ostX/100, -a8.ostc/100, a8.MDATE
						 INTO  :DAT4,:nLIMIT_K,:nOST_K,:dLIMIT_K
						 FROM cc_deal d,  accounts a8
						 WHERE d.nd=:ND and a8.nls like '8999_'||d.nd and a8.kv=:n980 ")
						and NOT SqlFetchNext(hSql(), nFetchRes)
				Set nSVOB_K = nLIMIT_K - nOST_K
				Set sErr = ' '
				If dLIMIT_D <= bDat 
					Set sErr = sErr ||"
							Дата завершения Лимита на Дебитора истекла ! "
				If dLIMIT_K <= bDat 
					Set sErr = sErr ||"
							Дата завершения Лимита на Клиента истекла ! "
				If DAT4 <= bDat 
					Set sErr = sErr ||"
							Дата завершения договора с ФАКТОРОМ истекла ! "
				If DAT_END <= bDat 
					Set sErr = sErr ||"
							Дата завершения Контракта истекла ! "
				If DOPL <= bDat 
					Set sErr = sErr ||"
							Дата оплаты Инвойса истекла ! "
				If sErr != ' '
					Call SalDisableWindow( pbOk )
					Call SalDisableWindow( dAVA )
					Call SalMessageBox( sErr, "Внимание ! ", MB_IconStop)
					Set nS = 0
					Call SalEndDialog( hWndForm, FALSE )
				!
				Call AVA_LIM0 ()
				Call SalSetFocus( pbOk )
	Dialog Box: dlg_CreateDoc
		Class:
		Property Template:
		Class DLL Name:
		Title: Новый документ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.429"
				Width Editable? Yes
				Height: 4.385"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Номер дополнительного соглашения:
				Resource Id: 30072
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.177"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			List Box: lbAdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenListBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    0.146"
					Width:  1.186"
					Width Editable? Class Default
					Height: 0.229"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Yes
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					! On SAM_Create
						                                                                                                                                                                                                        Call SalListPopulate( lbAdd, hSql(), "
								SELECT
								adds
								FROM
								cc_add
								WHERE
								nd = :nND ")
			Child Table: tblTemplates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.186"
						Top:    0.74"
						Width:  8.0"
						Width Editable? Yes
						Height: 2.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Идентификатор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.771"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.614"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						If SalTblPopulate( dlg_CreateDoc.tblTemplates, hSql(),
								"SELECT r.id,s.name
								 INTO :dlg_CreateDoc.tblTemplates.colId,:dlg_CreateDoc.tblTemplates.colName
								 FROM doc_root r, doc_scheme s
								 WHERE  r.vidd =:nVidd AND s.id = r.id ", TBL_FillAll )
						If SalTblAnyRows( tblTemplates, 0, 0 ) != TRUE
							Call SalMessageBox( 'Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok  )
							Call SalEndDialog( dlg_CreateDoc, 0 )
						Else
							Call SalTblSetContext( tblTemplates, TBL_MinRow )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Создать
				Window Location and Size
					Left:   5.686"
					Top:    3.573"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
							If sDoc
								! Показываем документ с редактированием
								If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
									! Сохраняем документ в БД
									If NOT cdoc_SetDocText(hSql(), TRUE,
											  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
										Call SqlRollback(hSql())
									Else
										Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:' || SalNumberToStrX(lbAdd.GetCurrentKey(),0) || ' сохранен в БД!')
									! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
											 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
										                                                                                                          If SqlSetLongBindDatatype( 3, 23 )
											                                                                                                          If SqlExecute( hSql() )
												                                                                                                          Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
												! Return 1
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.086"
					Top:    3.573"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Group Box: Выбор шаблона
				Resource Id: 30073
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.49"
					Width:  8.2"
					Width Editable? Yes
					Height: 3.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
		Window Parameters
			Number: nND
			Number: nVidd
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCnc2
				Class: cABSConnect
			Long String: sDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 'Новый документ к договору №'||
						                      SalNumberToStrX( nND, 0 ) )
				Call SalCenterWindow( hWndForm )
	Dialog Box: dlg_MSG
		Class:
		Property Template:
		Class DLL Name:
		Title: Дополнительные сведения
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.117"
				Width Editable? Yes
				Height: 3.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 30074
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.052"
					Width:  8.7"
					Width Editable? Yes
					Height: 1.76"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 30075
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.875"
					Width:  7.257"
					Width Editable? Yes
					Height: 0.688"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			! cFieldLabel: tbgSave	!Сохранить сделку с назначением
				                                                                                                                                                                Message Actions
			Multiline Field: mlTxt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 160
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.2"
						Top:    0.531"
						Width:  8.383"
						Width Editable? Yes
						Height: 1.2"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					On SAM_Validate
						Set mlTxt = SalStrTrimX( mlTxt )
						If SalStrLength( mlTxt ) < 3
							Call SalMessageBox(
									"Призначення платежу менше 3-х знаків неможливе !",
									 "Помилка !",
									MB_IconStop)
							Set mlTxt = sNazn
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
			Pushbutton: pbOk	! Сохранить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   4.8"
					Top:    1.99"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sNazn = mlTxt
						Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbClose	! Отменить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   6.0"
					Top:    1.99"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
		Functions
		Window Parameters
			Receive String: sNazn
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SetWindowFont( hWndForm )
				! Присваиваем значения многоязыковым объектам
				! Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				!
				! Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_MSG.cTWndTitle')  )
				!
				Set mlTxt = sNazn
				Call SalSetFocus( pbOk )
	Form Window: F1
		Class:
		Property Template:
		Class DLL Name:
		Title: Ввод нових заявок на ФК
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.975"
				Top:    1.604"
				Width:  11.3"
				Width Editable? Yes
				Height: 5.798"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: ЗАЯВКА-ДОРУЧЕННЯ №
				Resource Id: 30076
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.617"
					Top:    0.155"
					Width:  3.35"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.083"
						Top:    0.119"
						Width:  2.283"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Клієнтський № заявки')
					On SAM_Validate
			Background Text: Від
				Resource Id: 30077
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.4"
					Top:    0.143"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.233"
						Top:    0.119"
						Width:  2.283"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Клієнтська дата заявки')
					On SAM_Validate
			Background Text: На торгівлю в секції строкового ринку УМВБ
				Resource Id: 30078
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.633"
					Top:    0.417"
					Width:  8.867"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold-Italic
				Text Color: Default
				Background Color: Default
			Background Text: Клієнт
				Resource Id: 30079
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.617"
					Top:    0.738"
					Width:  2.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.6"
						Top:    0.655"
						Width:  3.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Ідент.Код клієнта
				Resource Id: 30080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.617"
					Top:    1.0"
					Width:  2.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dOKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.6"
						Top:    0.917"
						Width:  3.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Специфікація
				Resource Id: 30081
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.617"
					Top:    1.262"
					Width:  2.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Combo Box: cmb_Spec
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.6"
					Top:    1.179"
					Width:  3.867"
					Width Editable? Yes
					Height: 2.429"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(  hSqlAux(),
								  "SELECT id_spec from FK_ut_V ORDER BY id_spec INTO :sTmpM " )
							While SqlFetchNext(  hSqlAux(), nFetchRes )
								Call SalListAdd( cmb_Spec, sTmpM )
					On SAM_Click
						If SqlPrepareAndExecute( hSql(),
								  "SELECT id_ins, id_ser, dato from FK_ut where id_spec=:cmb_Spec INTO :ID_INS, :ID_SER, :DATO " )
								and SqlFetchNext(hSql(), nFetchRes)
								and SqlPrepareAndExecute( hSql(),
								   "SELECT b.cina_Cl - u.lim,  b.cina_Cl + u.lim
								    INTO :C_MIN, :C_MAX
								    FROM fk_bz b, fk_ut u
								   where u.id_spec=b.id_spec and b.id_spec=:cmb_Spec and
								    (b.id_spec,b.fdat)=
								   (select id_spec,max(fdat) from fk_bz where id_spec=u.id_spec group by id_spec) ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set CINK = C_MIN
							Set CINP = C_MAX
						Else
							Set C_MIN =NUMBER_Null
							Set C_MAX =NUMBER_Null
						Set CINK = C_MIN
						Set CINP = C_MAX
			Background Text: Ціновий коридор
				Resource Id: 30082
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.617"
					Top:    1.524"
					Width:  2.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: C_MIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.6"
						Top:    1.44"
						Width:  1.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: C_MAX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.533"
						Top:    1.452"
						Width:  1.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Group Box: Напрямок
				Resource Id: 30083
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.517"
					Top:    1.905"
					Width:  5.017"
					Width Editable? Yes
					Height: 0.69"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КУПИТИ
				Window Location and Size
					Left:   3.683"
					Top:    2.036"
					Width:  1.933"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Sky
				Message Actions
					On SAM_Click
						Call F_Rb()
			Radio Button: rbP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПРОДАТИ
				Window Location and Size
					Left:   3.667"
					Top:    2.31"
					Width:  1.933"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Light Green
				Message Actions
					On SAM_Click
						Call F_Rb()
			!
			Background Text: Наказ
				Resource Id: 30084
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.767"
					Top:    2.69"
					Width:  1.85"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmb_Nakaz
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.667"
					Top:    2.607"
					Width:  1.933"
					Width Editable? Yes
					Height: 1.81"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						Call SalListAdd( cmb_Nakaz, 'Limit' )
						Call SalListAdd( cmb_Nakaz, 'Market' )
						Call SalListAdd( cmb_Nakaz, 'Stop' )
						Call SalListSetSelect ( cmb_Nakaz, 0 )
						Call SalSendMsg( cmb_Nakaz, SAM_Click, 0, 0 )
					On SAM_Click
						If rbK
							Set cbK = IifN ( cmb_Nakaz = 'Market' ,TRUE, FALSE )
							If cbK = TRUE
								Call SalHideWindow( CINK )
								Call SalHideWindow( txtK )
							Else
								Call SalShowWindow( CINK )
								Call SalShowWindow( txtK )
						Else
							Set cbP = IifN ( cmb_Nakaz = 'Market' ,TRUE, FALSE )
							If cbP = TRUE
								Call SalHideWindow( CINP )
								Call SalHideWindow( txtP )
							Else
								Call SalShowWindow( CINP )
								Call SalShowWindow( txtP)
			Check Box: cbK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По поточній ціні
				Window Location and Size
					Left:   1.033"
					Top:    2.857"
					Width:  2.583"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Sky
				Message Actions
			Data Field: txtK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    2.857"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
			Data Field: CINK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.667"
						Top:    2.869"
						Width:  1.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'МАКСимальна ціна')
					On SAM_Validate
						If CINK < C_MIN or CINK > C_MAX
							Call SalMessageBox("Порушено ціновий коридор !", "Помилка !", MB_IconStop)
							Set CINK = C_MIN
			Check Box: cbP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По поточній ціні
				Window Location and Size
					Left:   1.033"
					Top:    2.857"
					Width:  2.583"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Light Green
				Message Actions
			Data Field: txtP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    2.857"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
			Data Field: CINP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.667"
						Top:    2.869"
						Width:  1.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'МІНімальна ціна')
					On SAM_Validate
						If CINP < C_MIN or CINP > C_MAX
							Call SalMessageBox("Порушено ціновий коридор !", "Помилка !", MB_IconStop)
							Set CINP = C_MAX
			!
			!
			!
			Frame
				Resource Id: 30085
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.967"
					Top:    3.155"
					Width:  9.033"
					Width Editable? Yes
					Height: 1.083"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: Обсяг (контрактів)
				Resource Id: 30086
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.2"
					Top:    3.25"
					Width:  2.317"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.567"
						Top:    3.25"
						Width:  0.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If MIN_KOL = NUMBER_Null
							Set MIN_KOL = KOL
						If KOL = NUMBER_Null or KOL<=0 or  MIN_KOL > KOL
							Call SalMessageBox( "Кількість контрактів ! ", "Помилка !", MB_IconStop)
							Set MIN_KOL = KOL
							Return VALIDATE_Cancel
			Background Text: але не менше ніж
				Resource Id: 30087
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.567"
					Top:    3.262"
					Width:  2.017"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: MIN_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.617"
						Top:    3.25"
						Width:  0.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Call SalSendMsg( KOL, SAM_Validate, 0, 0 )
			Background Text: Тип
				Resource Id: 30088
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.883"
					Top:    3.548"
					Width:  1.617"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Check Box: cbTip
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відкритий
				Window Location and Size
					Left:   3.55"
					Top:    3.512"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set cbTip = TRUE
						Call SalSendMsg( cbTip, SAM_Click, 0, 0 )
					On SAM_Click
						If cbTip
							Set WDATE = DATO
							Call SalDisableWindow( WDATE )
						Else
							Call SalEnableWindow( WDATE )
			Background Text: Доручення дійсне до
				Resource Id: 30089
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.25"
					Top:    3.798"
					Width:  2.267"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: WDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.55"
						Top:    3.798"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Термін дії доручення')
					On SAM_Validate
						If WDATE != DATETIME_Null and WDATE > DATO
							Call SalMessageBox("Останній день торгів ! ", "Помилка !", MB_IconStop)
							Set WDATE =  DATO
			Data Field: DATO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.583"
						Top:    3.798"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Останній день торгів')
			!
			Data Field: NLS_FCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.633"
						Top:    4.262"
						Width:  2.667"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Торговий рахунк клієнта')
			Data Field: OSTB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.333"
						Top:    4.262"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Залишок на торговому рахунку клієнта')
			Data Field: PZTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.233"
						Top:    4.262"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Розрахункова сумма залишку')
			Data Field: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.117"
						Top:    4.262"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Надлишки + , Недостача -')
			!
			Pushbutton: pb_Ins
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.633"
					Top:    4.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Нова заявка'
					On SAM_Click
						Call F_Null()
			Pushbutton: pb_Save
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.1"
					Top:    4.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Зберегти введену заявку'
					On SAM_Click
						Call F_Save()
			Pushbutton: pb_Prn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.583"
					Top:    4.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Надрукувати тікет заявки'
			Data Field: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.333"
						Top:    4.512"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Референс введенної заявки')
			Pushbutton: pb_Exit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.067"
					Top:    4.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Завершити'
					On SAM_Click
						Call SalSendMsg( hWndForm, SAM_Destroy, 0, 0 )
		Functions
			Function: F_Null
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					!
					Call F_Rb()
					Set NDOC = STRING_Null
					Set KOL = NUMBER_Null
					Set REF = NUMBER_Null
					Set MIN_KOL= NUMBER_Null
					Set WDATE = DATETIME_Null
					Set cmb_Spec = STRING_Null
					Set CINK = NUMBER_Null
					Set CINP = NUMBER_Null
					Set cbK = NUMBER_Null
					Set cbP = NUMBER_Null
					Call SalMapEnterToTab( TRUE )
					Call SalEnableWindow( NDOC )
					Call SalEnableWindow( DATD )
					Call SalEnableWindow( cmb_Spec )
					Call SalEnableWindow( rbK )
					Call SalEnableWindow( rbP )
					Call SalEnableWindow( CINK )
					Call SalEnableWindow( CINP )
					!
					Call SalEnableWindow( KOL )
					Call SalEnableWindow( MIN_KOL )
					Call SalEnableWindow( WDATE )
					!
					Call SalDisableWindow( pb_Prn )
					Call SalEnableWindow( pb_Ins )
					Call SalEnableWindow( pb_Save )
					Return TRUE
			Function: F_Save
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: OP
					Number: RATE
				Actions
					If cmb_Spec = STRING_Null
						Call SalMessageBox("Не вибрано специфікацію !", "Помилка !", MB_IconStop)
						Call SalSetFocus( cmb_Spec )
						Return FALSE
					Call SalSendMsg( NDOC, SAM_Validate, 0, 0 )
					Call SalSendMsg( DATD, SAM_Validate, 0, 0 )
					Call SalSendMsg( CINK, SAM_Validate, 0, 0 )
					Call SalSendMsg( CINP, SAM_Validate, 0, 0 )
					Call SalSendMsg( KOL, SAM_Validate, 0, 0 )
					Call SalSendMsg( WDATE, SAM_Validate, 0, 0 )
					!
					If rbK and not cbK and CINK=NUMBER_Null or
							rbP and not cbP and CINP=NUMBER_Null or
							KOL = NUMBER_Null or MIN_KOL=NUMBER_Null
						Call SalMessageBox("Помилка !","Не задані всі обов`язкові реквізити ! ", MB_IconStop)
						Return FALSE
					If WDATE = DATETIME_Null
						Set WDATE = DATO
					If cbK
						Set CINK=NUMBER_Null
					If cbP
						Set CINP=NUMBER_Null
					Set OP = IifN ( rbK, IifN( cbK,1,2), IifN( cbP,3,4) )
					Set RATE =  IifN ( rbK, CINK, CINP )
					If SqlPLSQLCommand( hSql(),
							"fk.INP_ZAY (RNK, cmb_Spec, OP, RATE,KOL,MIN_KOL,WDATE,DATD,NDOC,REF, cmb_Nakaz )" )
							 and SqlCommitEx(  hSql(), "Введено заявку ФК "|| cmb_Spec )
						Call SalDisableWindow( NDOC )
						Call SalDisableWindow( DATD )
						Call SalDisableWindow( cmb_Spec )
						Call SalDisableWindow( rbK )
						Call SalDisableWindow( rbP )
						Call SalDisableWindow( cbK )
						Call SalDisableWindow( cbP )
						Call SalDisableWindow( CINK )
						Call SalDisableWindow( CINP )
						!
						Call SalDisableWindow( KOL )
						Call SalDisableWindow( MIN_KOL )
						Call SalDisableWindow( WDATE )
						!
						Call SalEnableWindow( pb_Prn )
						Call SalEnableWindow( pb_Ins )
						Call SalDisableWindow( pb_Save )
						Call F_PZTR()
						Return TRUE
					Else
						Set REF = NUMBER_Null
						Return FALSE
			Function: F_Rb
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If rbK
						Call SalHideWindow( cbP )
						Call SalHideWindow( CINP )
						Call SalHideWindow( txtP )
						Call SalShowWindow( txtK )
						Call SalShowWindow( cbK )
						Call SalShowWindow( CINK )
						Call SalColorSet ( KOL, COLOR_IndexWindow, COLOR_Sky )
						Call SalColorSet ( MIN_KOL, COLOR_IndexWindow, COLOR_Sky )
						Call SalColorSet ( WDATE, COLOR_IndexWindow, COLOR_Sky )
						Call SalColorSet ( REF, COLOR_IndexWindow, COLOR_Sky )
					Else
						Call SalHideWindow( cbK )
						Call SalHideWindow( CINK )
						Call SalShowWindow( cbP )
						Call SalShowWindow( CINP )
						Call SalHideWindow( txtK )
						Call SalShowWindow( txtP )
						Call SalColorSet ( KOL, COLOR_IndexWindow, COLOR_LightGreen )
						Call SalColorSet ( MIN_KOL, COLOR_IndexWindow, COLOR_LightGreen )
						Call SalColorSet ( WDATE, COLOR_IndexWindow, COLOR_LightGreen )
						Call SalColorSet ( REF, COLOR_IndexWindow, COLOR_LightGreen )
					Return TRUE
			Function: F_PZTR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							  "SELECT nls, ostb/100, fk.PZTR(:RNK) INTO :NLS_FCH, :OSTB, :PZTR from accounts where acc=:ACC")
							and not SqlFetchNext(hSql(), nFetchRes)
						Set NLS_FCH = STRING_Null
						Set OSTB = NUMBER_Null
						Set PZTR = NUMBER_Null
					Set DEL = OSTB - PZTR
					Call SalColorSet( DEL, COLOR_IndexWindow, IifN(DEL<0, SalColorFromRGB(255,210,250), COLOR_White) )
					Return TRUE
		Window Parameters
			Number: RNK
			Number: ACC
			String: NMK
			String: OKPO
			Window Handle: hW
			!
		Window Variables
			String: sTmpM
			String: ID_INS
			String: ID_SER
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call SalDisableWindow( cbK )
				Call SalDisableWindow( cbP )
				Set txtK = 'По ціні не вище'
				Set txtP = 'По ціні не нижче'
				Call F_Null()
				Call SalMapEnterToTab( TRUE )
				Set DATD = GetBankDate()
				Set rbK=TRUE
				Set dNMK = NMK
				Set dOKPO= OKPO
				Call F_PZTR()
				Call SalWaitCursor( FALSE )
			On SAM_Destroy
				Call SalSendMsg( hW, SAM_Click, 0, 0 )
				Call SalDestroyWindow(hWndForm)
	Table Window: FA0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Архив оплаты инвойсов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.714"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1521
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1522
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1523
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbAccHistory
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								If ACC_ = NUMBER_Null
									If SqlPrepareAndExecute( hSql(),
											"select nls, acc into :NLS_3739,:ACC_ from accounts 
											 where kv=:n980 and nls=Substr(FAKTOR.NLS(:dND,:dRNK_K,'3739'),1,15) " )
											and  SqlFetchNext(hSql(), nFetchRes)
								If ACC_ != NUMBER_Null
									Call Show_Sal_Day_P( ACC_, NLS_3739, n980, DATN, DATK )
									! Call Show_Sal_DayHist( ACC_ , NLS_3739, n980 )  ! (Mik-hist)
						On SAM_Create
							Set strTip = 'История счета гашения'
				!
				! 1 ряд
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.783"
							Top:    0.155"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.Договора Факторинга')
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.883"
							Top:    0.155"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ Договора Факторинга')
				Data Field: dDAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.155"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала ')
				! 2 ряд
				Data Field: dRNK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    0.155"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег № Клиента')
				Data Field: dNMK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.155"
							Width:  4.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Клиента')
				! 3 ряд
				Data Field: dRNK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    0.405"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег № Дебитора ')
				Data Field: dNMK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.405"
							Width:  4.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Дебитора ')
		Contents
			!
			Column: NI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						номинала
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.467"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						номинала
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SA    
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						процентов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						комиссии
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Переч.
						клиенту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состояние
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						погаш
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Первое
						погаш
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.317"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Послед
						погаш
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max РЕФ
						погаш
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						
						ФД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						
						ФД
				Visible? No
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-1
						
						
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег
						№
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег
						№
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_3739
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						гашения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_ZAG
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! 1 ряд
					Set dND = ND 
					Set dCC_ID = CC_ID
					Set dDAT1 = SDATE
					! 2 ряд
					Set dRNK_K = RNK_K
					Set dNMK_K = NMK_K
					! 3 ряд
					Set dRNK_D = RNK_D
					Set dNMK_D = NMK_D
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: strPar01
			String: strPar02
		Window Variables
			Number: nRed
			Number: nRow
			Number: n980
			String: sFilter
			!
			Number: II
			Number: IDOC
			Number: IAVA
			Number: IN
			Number: IA
			Number: IP
			Number: IB
			Number: IK
		Message Actions
			On SAM_Create
				Call SalTblSetLockedColumns( hWndForm, 5 )
				Set nRed = SalColorFromRGB( 255,245,255 )
				Set n980 = GetBaseVal()
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set FA0.nTabInstance = 1
				Set FA0.strPrintFileName = 'FA0'
				Set FA0.fFilterAtStart = 1
				Set FA0.strFilterTblName = 'FA5'
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If FA0.fFilterAtStart
					Set FA0.fFilterAtStart = NOT FA0.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set FA0.strSqlPopulate =
						"SELECT FA5.NI, FA5.NDOC, FA5.DDOC, FA5.SDOC, FA5.SAVA,g.sn,g.sa, g.sp, g.sb , 
						    FA5.ND, FA5.CC_ID, FA5.SDATE, g.KOL, g.DATN, g.DATK,g.REF,
						    FA5.RNKD, FA5.RNK, FA5.NMK_D, FA5.NMK_K,FA5.SOS, s.NAME    
						 INTO :FA0.NI,:FA0.NDOC,:FA0.DDOC,:FA0.SDOC,:FA0.SAVA,:FA0.SN,:FA0.SA,:FA0.SP,:FA0.SB,
						      :FA0.ND,:FA0.CC_ID, :FA0.SDATE, :FA0.KOL, :FA0.DATN, :FA0.DATK, :FA0.REF,
						      :FA0.RNK_D,:FA0.RNK_K,:FA0.NMK_D,:FA0.NMK_K,:FA0.SOS,:FA0.SOS_NAME
						FROM fak_sos s,
						 (select ni,sum(sn)/100 SN,sum(sa)/100 SA,sum(sp)/100 SP,sum(sb)/100 SB,
						         count(*) KOL, min(fdat) DATN, max(fdat) DATK, max(ref) REF 
						  from fak_pog group by ni) g, 
						 (SELECT i.NI, i.NDOC, i.SDOC/100 SDOC,i.SAVA/100 SAVA, i.DDOC,
						         e.ND,E.CC_ID, E.SDATE,t.RNKD, E.rnk RNK, d.nmk NMK_D, k.nmk NMK_K,i.SOS
						  FROM FAK_Invoice I, FAK_KONTR T, cc_deal E,customer K,customer D
						  WHERE i.nk=t.NK and i.sos>=9 and t.nd=E.nd and t.rnkd=d.rnk and E.rnk=k.rnk " ||
						    IifS (nPar2 >0," and E.nd=:nPar2","") || ") FA5 
						WHERE FA5.ni = g.ni (+) and FA5.sos=s.sos " || 
						IifS (sFilter = "", ""," and"|| sFilter ) || "
						ORDER BY NI desc "
				Set II = 0
				Set IDOC = 0
				Set IAVA = 0
				Set IN = 0
				Set IA = 0
				Set IP = 0
				Set IB = 0
				Set IK = 0
				Call SalTblPopulate(hWndForm, hSql(), FA0.strSqlPopulate, TBL_FillAll)
				! Итог 
				Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set NI = II
				Set SDOC = IDOC 
				Set SAVA = IAVA 
				Set SN = IN
				Set SA = IA
				Set SP = IP 
				Set SB = IB 
				Set SK = IK 
				Set NDOC = 'Итог'
				!
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If SOS = 9 !! Погашен частично Деб   СЛАБО-СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 239,247,247) )
				! Else If SOS = 10 !! Погашен Дебитором СЕРЫЙ
					                                                                                  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS = 11 !! Выставлен регресс Кл СЛАБО-КРАСНЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ))
				!
				Set SK = SN - SA - SP - SB 
				Set II = II + 1
				Set IDOC = IDOC + SDOC
				Set IAVA = IAVA + SAVA
				Set IN = IN + SN
				Set IA = IA + SA
				Set IP = IP + SP
				Set IB = IB + SB
				Set IK = IK + SK
			On SAM_DoubleClick
				If REF > 0
					If KOL = 1 
						Call DocViewContentsEx(hWndForm, REF )
					Else
						! Call DocViewList( hWndMDI,
								" a.ref in (select ref from fak_pog where ni="||Str(NI)||")", 
								"Оплата инв."||Str(NI) || ":"|| NDOC ||"(" || NMK_D || "->"||NMK_K||")" )
						Call DocViewListInt( hWndMDI," a.ref in (select ref from fak_pog where ni="||Str(NI)||")", 
								"Оплата инв."||Str(NI) || ":"|| NDOC ||"(" || NMK_D || "->"||NMK_K||")" )
			On SAM_TblDoDetails
				If ND > 0
					Call F_ZAG ()
	Table Window: FA1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Договора факторинга
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.643"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Открыть Новый договор с Клиентом '
				Pushbutton: pb_Autor
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Attach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Авторизовать Дог.Факт.'
						On SAM_Click
							If not SalIsNull(ND) and SOS=0 and LIMIT =0
								If RNK  != NUMBER_Null 
										and CC_ID != STRING_Null 
										and DAT1 != DATETIME_Null 
										and DAT4 != DATETIME_Null 
										and IR != NUMBER_Null 
										and IR > 0
										and NLS_2600 != STRING_Null 
									Set sTmp = 'Авторизация ФД реф='||Str(ND)||' '|| GetUserRealName()|| ' '||
											           SalFmtFormatDateTime ( SalDateCurrent(  ), 'dd/MM/yyyy hh:mm:ss ' )
									If SalModalDialog( dlg_MSG, hWndForm, sTmp ) = 1
										If SqlPLSQLCommand( hSql(), "FAKTOR.AUTOR_FD(ND,sTmp )")
												and SqlCommitEx( hSql(), "Авторизован ФД "||Str(ND) )
											Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
										Else
											Call SqlRollback(hSql())
											Call SalMessageBox('Невозможно Авторизовать ФД' , 'Ошибка', MB_IconExclamation)
								Else
									Call SalMessageBox('Не заданы обязательные параметры' , 'Ошибка', MB_IconExclamation)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pb_LIM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LIMS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Изменить ЛИМИТ и его дату '
						On SAM_Click
							If not SalIsNull(ND) 
									and not SalIsNull(LIMIT) 
									and LIMIT > 0 
									and not SalIsNull(DAT4L) 
									and SOS = 10 
								If SqlPLSQLCommand( hSql(), "FAKTOR.LIMIT_FD(ND, ACC8, LIMIT, DAT4L)")
										and F_Opl_1()
										and SqlCommitEx( hSql(), "Изменен лимит ФД "||Str(ND) )
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Selected, TRUE )
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE )
								Else
									Call SqlRollback(hSql())
									Call SalMessageBox('Невозможно Изменить лимит' , 'Ошибка', MB_IconExclamation)
				Pushbutton: pb_POG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: White
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Контроль погашения инвойсов '
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) AND 
									not SalIsNull(ND) and dNls_3739 != STRING_Null AND dSum_3739 > 0 
								If IsWindow( h_FA7 )
									Call SalDestroyWindow(h_FA7 )
								Set h_FA7 = SalCreateWindow( FA7, hWndMDI, 201, ND , "", "" )
								! Sel020(hWndMDI,201,0," "," ")
				Pushbutton: pb_ARC
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.55"
						Top:    0.179"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SORT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: White
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Архив погашения инвойсов '
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) AND 
									not SalIsNull(ND) 
								If IsWindow( h_FA0 )
									Call SalDestroyWindow(h_FA0 )
								Set h_FA0= SalCreateWindow( FA0, hWndMDI, 210, ND ,  "", "" )
				Data Field: dNls_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    0.155"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет 3739*')
						On SAM_SetFocus
							Set sTmpE = dNls_3739
						On SAM_AnyEdit
							Set dNls_3739 = sTmpE
				Data Field: dSum_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   14.083"
							Top:    0.155"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Остаток на сч.3739*')
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Дебиторы Клиента'
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Табличная форма счетов ФД (с редактированием)"
						On SAM_Click
							Set sTmp =
									" a.acc in (select acc from nd_acc WHERE nd="||Str(ND)||" union all
									  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(ND) || "))"
							If nTip_F  = 90 ! Полный просмотр (Без транзакций)
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
							Else
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, sTmp )
										
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Печать договора факторинга'
						On SAM_Click
							Call PrintFAKTORData()
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Light Green
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые договора ' )
						On SAM_Click
							If pb_Clos
								Set sFilter0 = " = 15 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pb_Autor )
								Call SalDisableWindow( pbUpdate )
								! Call SalDisableWindow( pb_Proc )
								! Call SalDisableWindow( pbAcc )
							Else
								Set sFilter0 = " < 15 "
								If nTip_F < 90
									Call SalEnableWindow( pbIns )
									Call SalEnableWindow( pb_Autor )
									Call SalEnableWindow( pbUpdate )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт Клиента (просмотр)'
						On SAM_Click
							If TYPE=2 and RNK >0
								Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
							Else If TYPE=3 and RNK > 0
								Call EditCustPerson(RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pb_T8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Финансовое состояние Клиента (просмотр)'
						On SAM_Click
							If Val(OKPO) > 0
								Call DEPO( hWndMDI, -1, Val(OKPO) )
				Pushbutton: pb_PUSTO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				!
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.217"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть действующий договор с Клиентом '
						On SAM_Click
							If not SalIsNull(ND) 
								If LIMIT > 0 
									Call SalMessageBox("Лимит на клиента НЕ=0", 'Невозможно '||strTip ,  MB_IconExclamation)
								Else
									If SqlPLSQLCommand( hSql(), "FAKTOR.CLOSE_FD(ND, sErr)")
											and sErr= STRING_Null
											and SqlCommitEx( hSql(), "Закрыт договор ФД "||Str(ND) )
										Call SalMessageBox( "Закрыт договор ФД "||Str(ND), 'Внимание', MB_Ok )
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Call SqlRollback(hSql())
										Call SalMessageBox(sErr,'Невозможно '||strTip ,  MB_IconExclamation)
				Line
					Resource Id: 50750
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 50751
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 50752
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				!
				Data Field: dKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.683"
							Top:    0.155"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Общее количество Договоров факторинга')
				Data Field: dSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.383"
							Top:    0.155"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Суммарная задолженность по всем Договорам факторинга')
				Frame
					Resource Id: 50753
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  4.1"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 50754
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.283"
						Top:    0.071"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 50755
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.183"
						Top:    0.071"
						Width:  4.9"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 50756
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pb_Proc ! Пока ОдноОконная (в Bars010.apd)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '
									2.Начисление % по выданным авансам (2030),
									3.Начисление % по выставленным регрессам,
									4.Амортизация Дисконта (2036)'
						On SAM_Click
							! Set sFilter_Pr =
									" AND (s.nbs in ('2030','2036') OR s.acc in (select acc from FAK_REGRESS) ) "
							! Set sFilter_Pr =
									" AND (
									s.nls like '203%' 
									OR 
									s.acc in (select acc from FAK_REGRESS)
									 ) "
							Set sFilter_Pr =
									" AND s.nls like '20%' AND (
									s.acc in (select n.acc from nd_acc n, cc_deal d where d.vidd=203 and d.nd=n.nd  ) 
									OR 
									s.acc in (select acc from FAK_REGRESS)
									 ) "
							Call Sel010(hWndMDI, 0, IifN( nTip_F=90, 1, 0 ), sFilter_Pr, "SA" )
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							Set strTip = 'Доп.реквизиты по ФД (для СПЕЦ.отчетов)'
						On SAM_Click
							If not SalIsNull(hWndForm.FA1.ND)
								If nTip_F  = 90 ! Полный просмотр (Без транзакций)
									Call DOP_MOS ( hWndForm.FA1.ND, hWndForm.FA1.CC_ID,
											hWndForm.FA1.NMK, 'ReadOnly')
								Else
									Call DOP_MOS (hWndForm.FA1.ND, hWndForm.FA1.CC_ID, hWndForm.FA1.NMK, 'All')
		Contents
			Column: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кр.
						инсп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состояние
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сост
						ФД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If ND = NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER","NMK", " (custtype=2 or sed=91) and DATE_OFF is null",sTmp,NMK)
							If sTmp != STRING_Null
								Set RNK=Val(FA1.sTmp)
								Set DAT1=FA1.bDat
								Set INSP=FA1.nUser
								Set LIMIT = 0
			Column: TYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.
						ФД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REGR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: I
						С
						регр
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 203
						Uncheck Value: 204
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						ФД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						 Нач
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT1 > DAT4 and DAT4 != DATETIME_Null
							Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
									"Внимание, ошибка !", MB_IconStop)
							Set DAT1 = DAT4
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						кон
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT4 < DAT1 and DAT1 != DATETIME_Null
							Call SalMessageBox("Дата-завершения МЕНЬШЕ Даты-начала",
									"Внимание, ошибка !", MB_IconStop)
							Set DAT4 = DAT1
						Else
							Set DAT4L = DAT4
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
						на
						клиента
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMIT = NUMBER_Null
							Set LIMIT = 0
					On SAM_Validate
						Call f_Tochka ( LIMIT )
			Column: DAT4L
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заверш
						лимита
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						ст
						ФД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ком
						с
						НДС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_2600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Р/Счет
						Клиента
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NLS_2600 = STRING_Null and RNK > 0
							If SqlPrepareAndExecute( hSql(),
									"SELECT a.nls into :NLS_2600 from accounts a, cust_acc u
									 where a.kv=:n980 and a.nbs='2600' and a.dazs is null
									   and a.acc=u.acc and u.rnk=:RNK ")
									and SqlFetchNext(hSql(), nFetchRes)
								Set MFO_2600 = aMfo
								If ND > 0
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
			Column: MFO_2600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						Р/Счет
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол
						 деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						 задолж
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC8
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! !! Резевр доп-рекв
			! Column: REZ
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резерв
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                        List Values 
				                                                                                                        Message Actions 
		Functions
			Function: F_Opl_1 ! Лимит на клиента (с комиссией)
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: LIMIT100
					Number: nS
					Number: nRef
					String: sNLSB
					String: sNMSB
					String: sOKPOB
					String: sNazn
				Actions
					If (MFO_2600 = sBankMfo OR MFO_2600 = STRING_Null ) and NLS_2600 != STRING_Null
						Set LIMIT100 = LIMIT * 100
						If SqlPrepareAndExecute( hSql(),
								  "SELECT F_TARIF( :KOM_LIM_,:n980,:NLS_2600,:LIMIT100 ) into :nS from dual" )
								and SqlFetchNext(hSql(), nFetchRes) 
							Set sOKPOB= GetBankOkpoS()
							If nS > 0
								Set sNazn = Subs( 
										"Стягнення комісії за розгляд документів і встановлення ліміту Факторинга" ,1, 160)
								If NDS = 1 
									Set sNLSB = NLS_3619
									Set sNMSB = NMS_3619
									Set sNazn = sNazn || ", в тч ПДВ " 
									! Set nS = SalNumberRound(  nS *(100+pNDS )/ 100  ) 
								Else
									Set sNLSB = NLS_6111
									Set sNMSB = NMS_6111
									Set nS = SalNumberRound(  nS*100/(100+pNDS ) ) 
									Set sNazn = sNazn 
								Call cDoc.SetDoc
										(nRef, 'KK1', 1, 1, Subs(CC_ID,1,10),
										     bDat,SalDateCurrent(), bDat, bDat, 
										     NLS_2600, NMK, sBankMfo, '', n980, nS, OKPO,
										     sNLSB, sNMSB, sBankMfo, '', n980, nS, sOKPOB,
										     sNazn , '', GetIdOper(), '', NUMBER_Null, 0)
								Return cDoc.oDoc()
					Return TRUE
			Function: PrintFAKTORData
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
					String: sValue
				Actions
					If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
							" ID LIKE 'FAKTOR_%' ", sTemplateId )
						Return 0
					If sTemplateId
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  ND, 0)
							If sDoc
								Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			! String: p6023
			String: strPar02
		Window Variables
			Number: n980
			Number: pNDS
			Number: KOM_LIM_
			! Number: nMode
			String: sBankMfo
			String: sErr
			String: NOT_2600
			Date/Time: bDat
			Number: nUser
			Number: nRet
			Number: nAcc
			String: sTmp
			String: sFilter_Pr
			String: sBlok
			String: aMfo
			String: sFilter
			String: sFilter0
			String: sSql
			String: s8889
			Number: nRow
			Number: nTip_K
			Number: nTip_F
			: cDoc
				Class: cDoc
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				! ! ! strPar01 = FK
				! ! ! ! F - функциональность
						      = 0 - ПОЛНАЯ
						      = 9 - Просмотр
				! ! ! ! K - параметр пока не задействован, на будущее
						      = 0
				Set aMfo = GetBankMfo()
				Set nTip_K = SalNumberMod(Val(strPar01), 10)
				Set nTip_F = Val(strPar01) - nTip_K
				If nTip_F  = 90 ! Полный просмотр (Без транзакций)
					Call SalDisableWindow( FA1.pbIns )
					Call SalDisableWindow( FA1.pb_Autor )
					Call SalDisableWindow( FA1.pbUpdate )
					Call SalDisableWindow( FA1.pb_LIM )
					! Call SalDisableWindow( FA1.pbTabAcc )
				Set FA1.strFilterTblName = 'FA1'
				Set n980 = GetBaseVal()
				If SqlPrepareAndExecute( hSql(),
						  "SELECT t.kod into :KOM_LIM_ from tarif t, fak_param p
						   where p.par='KOM_LIM' and p.val=to_char(t.kod)" )
						and NOT SqlFetchNext(hSql(), nFetchRes)  
					Call SalMessageBox('Не описан тариф за лимит' , 'Ошибка', MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
					Return FALSE
				If SqlPrepareAndExecute( hSql(),
						  "SELECT '1' into :NOT_2600 from  fak_param  where par='NOT_2600' and val='1'" )
						and NOT SqlFetchNext(hSql(), nFetchRes)  
					Set NOT_2600 = '0'
				If SqlPrepareAndExecute( hSql(),
						  "SELECT to_number(val) into :pNDS from params where par='NDS_20' " )
						and NOT SqlFetchNext(hSql(), nFetchRes)  
					Set pNDS = 20
				If not FA_NLS ()
					Call SalDestroyWindow(hWndForm)
				Else
					Call SalWaitCursor( TRUE )
					Call PrepareWindow( hWndForm )
					Call SetWindowFullSize(hWndForm)
					Call SalTblSetLockedColumns( hWndForm, 3 )
					Set FA1.nTabInstance = 1
					Set FA1.strPrintFileName = 'FA1'
					Set bDat = GetBankDate()
					Set sBankMfo = GetBankMfo()
					Set nUser = GetUserId()
					Call SalSendMsg( pb_Clos, SAM_Click, 0, 0 )
					!
					Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set dKol =0
				Set dSum =0
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set s8889 = '8999%'
				Set FA1.sSql =
						"SELECT FA1.REGR, FA1.custtype, FA1.RNK, FA1.NMK, FA1.OKPO, FA1.CC_ID,
						        FA1.ND, FA1.DAT1, FA1.DAT4, FA1.INSP, FA1.LIMIT, FA1.SOS, FA1.OSTC, 
						        s.name, FA1.ACC8, FA1.IR, FA1.DAT4L,           
						        Substr(FAKTOR.NLS(FA1.ND,FA1.RNK,'2600'),1,15),
						        To_number(Substr(FAKTOR.TAG(FA1.ND,'NDS'),1,1) )
						 INTO  :FA1.REGR,:FA1.TYPE, :FA1.RNK, :FA1.NMK, :FA1.OKPO,:FA1.CC_ID,
						       :FA1.ND,  :FA1.DAT1, :FA1.DAT4,
						       :FA1.INSP,:FA1.LIMIT,:FA1.SOS ,:FA1.OSTC,:FA1.sSOS,
						       :FA1.ACC8,:FA1.IR, :FA1.DAT4L ,:FA1.NLS_2600, :FA1.NDS
						 FROM (SELECT d.vidd REGR, c.custtype,
						              d.RNK, c.NMK, c.OKPO, d.CC_ID, d.ND, d.sdate DAT1, d.wdate DAT4,
						         d.user_id INSP,  d.SOS, -a8.ostc/100 OSTC, 
						         a8.MDATE DAT4L, -a8.ostX/100 LIMIT, acrn.FPROCN(a8.acc,0,:FA1.bDat) IR, a8.acc ACC8
						       FROM cc_deal d, customer c, accounts a8, nd_acc  n8 
						       WHERE n8.nd=d.nd and n8.acc=a8.acc and a8.nls like :FA1.s8889 and a8.kv=:FA1.n980
						         and d.sos " || sFilter0|| " and d.vidd =203 and d.rnk=c.rnk 
						       ) FA1, cc_sos s WHERE s.sos=FA1.sos " || IifS (sFilter = "", ""," and "|| sFilter ) || "
						 ORDER BY ND desc "
				Call SalTblPopulate(hWndForm, hSql(), FA1.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
						If SqlPLSQLCommand( hSql(),
								   "FAKTOR.OPEN_FD
								(ND,RNK,CC_ID,DAT1,DAT4,n980,0,DAT4,REGR,INSP,IR,NLS_2600,NDS,NUMBER_Null,MFO_2600,ACC8)" )
								and SqlCommitEx( hSql(), "Введен ФД "||Str(ND) )
					Else
						If SqlPLSQLCommand( hSql(), "FAKTOR.UPDATE_FD
								(ND,ACC8,CC_ID,DAT1,DAT4,INSP,IR,NLS_2600,NDS,SOS, MFO_2600 )" )
								and SqlCommitEx( hSql(), "Обновлен ФД "||Str(ND) )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set FA1.dKol = FA1.dKol + 1
				Set FA1.dSum = FA1.dSum + FA1.OSTC
				Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
				If FA1.DAT4L <= bDat 
					! Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ) )
					Call XSalTblSetCellBackColor( FA1.DAT4L, SalColorFromRGB( 255,210,210 ) )
				If FA1.DAT4 <= bDat
					! Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ) )
					Call XSalTblSetCellBackColor( FA1.DAT4, SalColorFromRGB( 255,210,210 ) )
				If NLS_2600 = STRING_Null
					If SqlPrepareAndExecute( hSqlAux2(),
							"SELECT MFO, NLS into :MFO_2600, :NLS_2600 
							 from CORPS_ACC where rnk = :RNK and NLS like '26%' and kv=:n980" )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
			On SAM_DoubleClick
				If ND > 0 and SOS=10
					Call Sel020( hWndForm, 204, ND, strPar01, Str(ACC8) )
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm, FA1.ND, 203 )
			On SAM_TblDoDetails
				! If IsWindow( h_FA8 )
					                                                                Call SalDestroyWindow(h_FA8 )
				If IsWindow( h_FA4 )
					Call SalDestroyWindow(h_FA4 )
				If IsWindow( h_FA3 )
					Call SalDestroyWindow(h_FA3 )
				If IsWindow( h_FA2 )
					Call SalDestroyWindow(h_FA2 )
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT NLS, ostb/100 into :dNls_3739, :dSum_3739 
						 from accounts where nls=Substr(FAKTOR.NLS(:FA1.ND,:FA1.RNK,'3739'),1,14)" )
						and SqlFetchNext( hSqlAux2(), nFetchRes)
	Table Window: FA5
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Управление картотекой инвойсов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.381"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Предварительный ввод новых инвойсов '
				Pushbutton: pb_Nominal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Взятие на учет новых инвойсов '
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow,  0, 0) 
								Call SalTblSetContext(hWndForm, nRow)
								If SOS = -1
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,0)" ) 
											and SqlPrepareAndExecute( hSql(),"update FAK_INVOICE set sos=0 where ni=:NI and sos=-1" )
											and SqlCommitEx( hSql(), " Взят на учет Инвойс "||NDOC )
										Set SOS = 0
							!
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть инвойс '
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\APPLY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выдать аванс'
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
									and RAVA > SAVA and SOS >=0
								Set nSA = RAVA - SAVA
								Call SalModalDialog( dlg_AVA, hWndForm, ND, RNK_D, DAT_END, DOPL, nSA )
								If nSA > 0
									If DEB_2030
											(ND,RNK_D,nSA,SAVA,NI,DDOC,NDOC,SDOC,
											 NLS_D,NMK_D,OKPO_D,RNK_K, NLS_K,NMK_K,OKPO_K, ACCD )
										Call SqlCommitEx( hSql(), " Аванс по Инвойсу "||NDOC )
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Call SqlRollback( hSql() )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1531
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1532
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Import
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Импорт НОМИНАЛОВ инвойсов из задачи "Доктор Фактор" '
						On SAM_Click
							Call F_Import ()
				Pushbutton: pb_Import_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_M1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Импорт АВАНСОВ по инвойсам из задачи "Доктор Фактор" '
						On SAM_Click
							If not IsWindow(h_FA6)
								Set h_FA6 = SalCreateWindow( FA6, hWndMDI, nPar1, nPar2 , strPar01, strTip )
							Else
								Call SalBringWindowToTop ( h_FA6 )
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 1533
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.905"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество откр.Инвойсов')
				Frame
					Resource Id: 1534
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  3.8"
						Width Editable? Yes
						Height: 1.083"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 1535
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Frame
					Resource Id: 1536
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.883"
						Top:    0.071"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pb_REGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Выставить регресс по одному инвойсу "
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
									and DOPL < bDat and SAVA > PAVA
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), "FAKTOR.REGR_K(NI)" )
									Call SqlCommit( hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Регресс выставлен по инвойсу '||Str(NI),'Сообщение',3,0)
								Else
									Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Неуспешное выставление регресса', 'Ошибка', 0, 1)
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.488"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые Инвойсы ' )
						On SAM_Click
							If pb_Clos
								Set sFilter0 = " = 15 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pb_Opl )
								Call SalDisableWindow( pb_REGR )
							Else
								Set sFilter0 = " < 15 "
								Call SalEnableWindow( pbIns )
								Call SalEnableWindow( pbDel )
								Call SalEnableWindow( pbUpdate )
								Call SalEnableWindow( pb_Opl )
								Call SalEnableWindow( pb_REGR )
								! Call SalEnableWindow( hWndForm )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pb_Vz
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Взыскать Инвойс с Дебитора'
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
									and NAVA > 0
								If F_VZK_3()
									Set sTmp = " Взыскан Инвойс "||NDOC 
									Call SqlCommitEx( hSql(), sTmp )
									! Call Debug (sTmp)
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Else
									Call SqlRollback( hSql() )
				!
				Frame
					Resource Id: 1537
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.183"
						Top:    0.071"
						Width:  11.8"
						Width Editable? Yes
						Height: 1.25"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				! 1 ряд
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.155"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.Договора Факторинга')
						On SAM_SetFocus
							Set nTmpE = dND
						On SAM_AnyEdit
							Set dND = nTmpE
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ Договора Факторинга')
						On SAM_SetFocus
							Set sTmpE = dCC_ID
						On SAM_AnyEdit
							Set dCC_ID = sTmpE
				Data Field: dDAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала договора с ФАКТОРОМ ')
						On SAM_SetFocus
							Set dTmpE = dDAT1
						On SAM_AnyEdit
							Set dDAT1 = dTmpE
				Data Field: dDAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения договора с ФАКТОРОМ ')
						On SAM_SetFocus
							Set dTmpE = dDAT4
						On SAM_AnyEdit
							Set dDAT4 = dTmpE
				Data Field: dDAT4L
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.783"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения лимина на Клиента')
						On SAM_SetFocus
							Set dTmpE = dDAT4L
						On SAM_AnyEdit
							Set dDAT4L = dTmpE
				Data Field: dLIM_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   13.483"
							Top:    0.405"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Лимит на Клиента')
						On SAM_SetFocus
							Set nTmpE = dLIM_K
						On SAM_AnyEdit
							Set dLIM_K = nTmpE
				! 2 ряд
				Data Field: dRNK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.405"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег № Клиента')
						On SAM_SetFocus
							Set nTmpE = dRNK_K
						On SAM_AnyEdit
							Set dRNK_K = nTmpE
				Data Field: dOKPO_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.405"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ОКПО Клиента')
						On SAM_SetFocus
							Set sTmpE = dOKPO_K
						On SAM_AnyEdit
							Set dOKPO_K = sTmpE
				Data Field: dNMK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.405"
							Width:  4.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Клиента')
						On SAM_SetFocus
							Set sTmpE = dNMK_K
						On SAM_AnyEdit
							Set dNMK_K = sTmpE
				Data Field: dNLS_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   13.483"
							Top:    0.655"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет Клиента')
						On SAM_SetFocus
							Set sTmpE = dNLS_K
						On SAM_AnyEdit
							Set dNLS_K = sTmpE
				Data Field: NLS_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   13.483"
							Top:    0.155"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет гашения ')
						On SAM_SetFocus
							Set sTmpE = NLS_3739
						On SAM_AnyEdit
							Set NLS_3739 = sTmpE
				Data Field: OST_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.783"
							Top:    0.155"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Остаток на счете гашения Клиенета')
						On SAM_SetFocus
							Set nTmpE = OST_3739
						On SAM_AnyEdit
							Set OST_3739 = nTmpE
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = "Табличная форма счетов Клиента и Дебитора "
						On SAM_Click
							Set sTmp =
									" a.RNK in (" || Str(dRNK_K)|| "," || Str(dRNK_D) ||")
									 and a.acc in (select acc from nd_acc WHERE nd=" || Str(dND)||")"
							! Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, sTmp )
									
				! 3 ряд
				Data Field: dRNK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.655"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег № Дебитора ')
						On SAM_SetFocus
							Set nTmpE = dRNK_D
						On SAM_AnyEdit
							Set dRNK_D = nTmpE
				Data Field: dOKPO_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.655"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ОКПО Дебитора ')
						On SAM_SetFocus
							Set sTmpE = dOKPO_D
						On SAM_AnyEdit
							Set dOKPO_D = sTmpE
				Data Field: dNMK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.655"
							Width:  3.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Дебитора ')
						On SAM_SetFocus
							Set sTmpE = dNMK_D
						On SAM_AnyEdit
							Set dNMK_D = sTmpE
				Data Field: dNLS_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   13.483"
							Top:    0.905"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет Дебитора ')
						On SAM_SetFocus
							Set sTmpE = dNLS_D
						On SAM_AnyEdit
							Set dNLS_D = sTmpE
				Data Field: dMDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.655"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения лимина на Дебитора')
						On SAM_SetFocus
							Set dTmpE = dMDATE
						On SAM_AnyEdit
							Set dMDATE = dTmpE
				Data Field: dAVA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.783"
							Top:    0.655"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Размер Аванса ( % от суммы Инвойса) ')
				! 4 Ряд
				Data Field: dNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.905"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Реф.Контракта')
				Data Field: dIDK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.905"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № Контракта')
				Data Field: dDATK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.905"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата НАЧАЛА Контракта')
				Data Field: dDAT_END
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.783"
							Top:    0.905"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата ЗАВЕРШЕНИЯ Контракта')
				Data Field: dSROK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.383"
							Top:    0.905"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Отсрочка платежа (дней) ')
				Data Field: dSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.783"
							Top:    0.905"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма Контракта')
		Contents
			!
			Column: NI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						
						Инв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						
						Инв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NDOC = STRING_Null and NI = NUMBER_Null
							Set NDOC = '№'
					On SAM_Validate
						If NDOC = STRING_Null and NI = NUMBER_Null and NK != NUMBER_Null
							Call SalMessageBox("№ документа инвойса не может быть ПУСТЫМ",
									"Ошибка ! ", MB_IconStop)
							Set NDOC = '№'
			Column: DDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						
						Инв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If DDOC = DATETIME_Null and NI = NUMBER_Null
							Set DDOC = bDat
					On SAM_Validate
						If NI = NUMBER_Null and NK != NUMBER_Null
							If DDOC+SROK <=bDat 
								Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								Set DDOC = bDat
							If DDOC < DATK 
								Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								Set DDOC = bDat
			Column: SDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						НОМИНАЛА
						Инв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SDOC = NUMBER_Null and NI = NUMBER_Null
							! Set SDOC = 0
							Set SDOC1=SDOC
					On SAM_KillFocus
						Call f_Tochka ( SDOC )
						If NI = NUMBER_Null and NK != NUMBER_Null
							If SDOC > SK 
								Call SalMessageBox("Сумма инвойса не может быть БОЛЬШЕ Суммы контракта="|| SalNumberToStrX( SK,2),
										"Ошибка ! ", MB_IconStop)
								Set SDOC = SDOC1
							If SDOC <= 0 or SDOC = NUMBER_Null
								Call SalMessageBox("Сумма инвойса должна быть БОЛЬШЕ 0",
										"Ошибка ! ", MB_IconStop)
			!
			Column: DOPL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата
						опл.Инв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NNOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						НОМИНАЛА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.
						сумма
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.
						сумма
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						Дата
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DPAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Погаш.
						Инв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						АВАНСА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состояние
						
						Инв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						
						ФД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						
						ФД
				Visible? No
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RNK_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег
						№
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.
						счет
						Кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RNK_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег
						№
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						задолж.
						Деб
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: AVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						
						Аван
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отср
						плат
						(дней)
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						контракта
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IDK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						контракта
				Visible? No
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						
						Контр.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						
						Контр
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: DAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						завешр.
						Контр
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: SDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-1
						
						
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null and NK != NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: WDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-4
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null and NK != NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: DAT4L
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-4L
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null and NK != NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: MDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-DL
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                              If DDOC = DATETIME_Null and NI = NUMBER_Null
							                                                                              Set DDOC = bDat
					! On SAM_Validate
						                                                                              If NI = NUMBER_Null and NK != NUMBER_Null
							                                                                              If DDOC+SROK <=bDat 
								                                                                              Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
							                                                                              If DDOC < DATK 
								                                                                              Call SalMessageBox("Дата инвойса меньше даты контракта ",
										"Ошибка ! ", MB_IconStop)
								                                                                              Set DDOC = bDat
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лим на кл
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF_DOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						DF
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						DF
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_VZK_3
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRef
					Number: nS
					String: s2600d
					String: s3739k
					!
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT nls, Substr(FAKTOR.NLS(:ND,:RNK_K,'3739'),1,15)
							 INTO :s2600d, :s3739k
							 from accounts a, cust_acc u 
							 where a.acc=u.acc and u.rnk=:RNK_D and a.nbs='2600' and a.dazs is null" )
							and SqlFetchNext(hSql(), nFetchRes)
						Set nS = NAVA *100
						Call cDoc.SetDoc
								(nRef, 'KK1', 1, 1, Str(NI),
								     DDOC, SalDateCurrent(), bDat, bDat ,
								     s2600d, NMK_D, sBankMfo, '', n980, nS, OKPO_D,
								     s3739k, NMK_K, sBankMfo, '', n980, nS, OKPO_K,
								     "Стягнення непогашеної суми Інвойсу з Дебітора за уступленим документом № "||NDOC ||
								     " від "||SalFmtFormatDateTime( DDOC, "dd/MM/yyyy" ) ||
								     " на суму "|| SalNumberToStrX( SDOC,2),
								     '',     GetIdOper(), '', NUMBER_Null, 0)
						Return cDoc.oDoc()
					Else
						Call SalMessageBox("Не найден Р/С (2600) Дебитора",
								"Ошибка ! ", MB_IconStop)
						Return FALSE
			Function: F_ZAG
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SOS > 9 or SOS = -1 
						Call SalDisableWindow( pb_REGR )
						Call SalDisableWindow( pb_Opl )  
					Else
						Call SalEnableWindow( pb_REGR )  
						Call SalEnableWindow( pb_Opl )  
					! 1 ряд
					Set dND = ND 
					Set dCC_ID = CC_ID
					Set dDAT1 = SDATE
					Set dDAT4 = WDATE
					Set dDAT4L = DAT4L
					Set dLIM_K=LIMIT
					If dDAT4 <= bDat 
						Call SalColorSet( dDAT4, COLOR_IndexWindow, nColR )
					Else
						Call SalColorSet( dDAT4, COLOR_IndexWindow, nCol1 )
					If dDAT4L <= bDat 
						Call SalColorSet( dDAT4L, COLOR_IndexWindow, nColR )
					Else
						Call SalColorSet( dDAT4L, COLOR_IndexWindow, nCol2 )
					!
					! 2 ряд
					Set dRNK_K = RNK_K
					Set dOKPO_K = OKPO_K
					Set dNMK_K = NMK_K
					Set dNLS_K = NLS_K
					! 3 ряд
					Set dRNK_D = RNK_D
					Set dOKPO_D = OKPO_D
					Set dNMK_D = NMK_D
					Set dNLS_D = NLS_D
					Set dAVA = AVA
					Set dMDATE = MDATE
					If dMDATE <= bDat 
						Call SalColorSet( dMDATE, COLOR_IndexWindow, nColR )
					Else
						Call SalColorSet( dMDATE, COLOR_IndexWindow, nCol3 )
					! 4 ряд
					Set dNK = NK
					Set dIDK = IDK
					Set dDATK = DATK
					Set dDAT_END = DAT_END
					Set dSROK = SROK
					Set dSK = SK
					If dDAT_END <= bDat 
						Call SalColorSet( dDAT_END, COLOR_IndexWindow, nColR )
					Else
						Call SalColorSet( dDAT_END, COLOR_IndexWindow, nCol4 )
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT nls, ostb/100
							   into :NLS_3739, :OST_3739 
							   from accounts where Substr(FAKTOR.NLS(:ND,:RNK_K,'3739'),1,15) =nls and kv=:n980 " )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
			Function: F_STROKA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set KOL = KOL + 1
					Set RAVA = SDOC * AVA/100
					! Set NAVA = SDOC - PAVA
					Set NAVA = SAVA - PAVA
					If DOPL = bDat
						Call XSalTblSetCellBackColor( DOPL, SalColorFromRGB( 230,255,230 ) )
					Else If DOPL < bDat
						Call XSalTblSetCellBackColor( DOPL, COLOR_Green )
			Function: F_Import
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: CC_ID_
					String: OKPOK_
					String: OKPOD_
					String: IDK_
					String: NDOC_
					Date/Time: DDOC_
					Number: SDOC_
					Number: PR_
					Number: REF_DOC_
				Actions
					Set KOL = 0
					Call SalTblReset( hWndForm )
					!
					If SqlPrepareAndExecute( hSql(),
							"select CC_ID , OKPOD,  IDK,  NDOC,  DDOC , SDOC/100, ref_doc
							 into  :CC_ID_,:OKPOD_,:IDK_,:NDOC_,:DDOC_,:SDOC_,:REF_DOC_
							 from bars_f_invoice 
							 where ref_doc not in (select ref_doc from DF_BARS_INVOICE)
							 order by DDOC " )
						While SqlFetchNext( hSql(), nFetchRes)
							Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
							Call SalTblSetContext(hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE  )
							Set FA5.NDOC = NDOC_
							Set FA5.DDOC = DDOC_
							Set FA5.SDOC = SDOC_
							Set FA5.CC_ID= CC_ID_
							Set FA5.IDK  = IDK_
							! Set FA5.OKPO_K=OKPOK_
							Set FA5.OKPO_D=OKPOD_
							Set FA5.SOS_NAME='ДФ'
							If CC_ID_ != STRING_Null 
									and SqlPrepareAndExecute( hSqlAux2(),
									  "SELECT E.nd, E.rnk, E.SDATE, E.WDATE, E.LIMIT, K.nmk, k.OKPO   
									   into :FA5.ND,:FA5.RNK_K,:FA5.SDATE,:FA5.WDATE,:FA5.LIMIT,:FA5.NMK_K,:FA5.OKPO_K
									   from cc_deal E, customer K
									   where E.sos<15 and E.vidd=203 and E.rnk=K.rnk and E.cc_id=:CC_ID_ " )
									and SqlFetchNext( hSqlAux2(), nFetchRes)
								If IDK_ != STRING_Null and OKPOD_ != STRING_Null 
										and SqlPrepareAndExecute( hSqlAux2(),
										  "SELECT T.nk, T.RNKD, D.nmk, T.SROK, AD.acc, AD.nls,
										          T.SK, T.DATK, To_NUMBER(AD.nlsalt)/100
										   into :FA5.NK, :FA5.RNK_D,:FA5.NMK_D, :FA5.SROK, :FA5.ACCD,:FA5.NLS_D,
										        :FA5.SK, :FA5.DATK, :FA5.AVA
										   from FAK_KONTR T, customer D, accounts AD, nd_acc N, cust_acc U 
										   where T.rnkd=D.rnk and D.okpo=:OKPOD_ and T.ND=:FA5.ND and T.idk=:IDK_ 
										     and N.nd=T.ND and N.acc=AD.acc 
										     and U.acc=AD.acc and U.rnk=D.rnk and AD.nbs='2030' ") 
										and SqlFetchNext( hSqlAux2(), nFetchRes) 
									Set FA5.DOPL = DDOC_ + FA5.SROK
									Set FA5.REF_DOC = REF_DOC_ 
									If NDOC_= STRING_Null or DDOC_= DATETIME_Null and SDOC_<= 0
										Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.NDOC/DDOC/SDOC'
									Else
										Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, TRUE  )
										Call F_STROKA()
								Else
									Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.OKPOD/IDK'
							Else
								Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.CC_ID'
					Call SalWaitCursor(FALSE)
			! Function: F_Import_A
				                                                                                                      Description: 
				                                                                                                      Returns 
				                                                                                                      Parameters 
				                                                                                                      Static Variables 
				                                                                                                      Local variables 
					                                                                                                      String: CC_ID_
					                                                                                                      String: OKPOK_
					                                                                                                      String: OKPOD_
					                                                                                                      String: IDK_
					                                                                                                      String: NDOC_
					                                                                                                      Date/Time: DDOC_
					                                                                                                      Number: SDOC_
					                                                                                                      Number: PR_
					                                                                                                      Number: REF_DOC_
				                                                                                                      Actions 
					                                                                                                      If SqlPrepareAndExecute( hSql(),
							"select CC_ID , OKPOD,  IDK,  NDOC,  DDOC , SDOC/100, ref_doc
							 into  :CC_ID_,:OKPOD_,:IDK_,:NDOC_,:DDOC_,:SDOC_,:REF_DOC_
							 from bars_f_invoice 
							 where ref_doc not in (select ref_doc from DF_BARS_INVOICE)
							 order by DDOC " )
						                                                                                                      While SqlFetchNext( hSql(), nFetchRes)
							                                                                                                      Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
							                                                                                                      Call SalTblSetContext(hWndForm, nRow )
							                                                                                                      Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE  )
							                                                                                                      Set FA5.NDOC = NDOC_
							                                                                                                      Set FA5.DDOC = DDOC_
							                                                                                                      Set FA5.SDOC = SDOC_
							                                                                                                      Set FA5.CC_ID= CC_ID_
							                                                                                                      Set FA5.IDK  = IDK_
							! Set FA5.OKPO_K=OKPOK_
							                                                                                                      Set FA5.OKPO_D=OKPOD_
							                                                                                                      Set FA5.SOS_NAME='ДФ'
							                                                                                                      If CC_ID_ != STRING_Null 
									and SqlPrepareAndExecute( hSqlAux2(),
									  "SELECT E.nd, E.rnk, E.SDATE, E.WDATE, E.LIMIT, K.nmk, k.OKPO   
									   into :FA5.ND,:FA5.RNK_K,:FA5.SDATE,:FA5.WDATE,:FA5.LIMIT,:FA5.NMK_K,:FA5.OKPO_K
									   from cc_deal E, customer K
									   where E.sos<15 and E.vidd=203 and E.rnk=K.rnk and E.cc_id=:CC_ID_ " )
									and SqlFetchNext( hSqlAux2(), nFetchRes)
								                                                                                                      If IDK_ != STRING_Null and OKPOD_ != STRING_Null 
										and SqlPrepareAndExecute( hSqlAux2(),
										  "SELECT T.nk, T.RNKD, D.nmk, T.SROK, AD.nls,
										          T.SK, T.DATK, To_NUMBER(AD.nlsalt)/100
										   into :FA5.NK, :FA5.RNK_D,:FA5.NMK_D, :FA5.SROK, :FA5.NLS_D,
										        :FA5.SK, :FA5.DATK, :FA5.AVA
										   from FAK_KONTR T, customer D, accounts AD, nd_acc N, cust_acc U 
										   where T.rnkd=D.rnk and D.okpo=:OKPOD_ and T.ND=:FA5.ND and T.idk=:IDK_ 
										     and N.nd=T.ND and N.acc=AD.acc 
										     and U.acc=AD.acc and U.rnk=D.rnk and AD.nbs='2030' ") 
										and SqlFetchNext( hSqlAux2(), nFetchRes) 
									                                                                                                      Set FA5.DOPL = DDOC_ + FA5.SROK
									                                                                                                      Set FA5.REF_DOC = REF_DOC_ 
									                                                                                                      If NDOC_= STRING_Null or DDOC_= DATETIME_Null and SDOC_<= 0
										                                                                                                      Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.NDOC/DDOC/SDOC'
									                                                                                                      Else 
										                                                                                                      Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, TRUE  )
										                                                                                                      Call F_STROKA()
								                                                                                                      Else 
									                                                                                                      Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.OKPOD/IDK'
							                                                                                                      Else 
								                                                                                                      Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.CC_ID'
					                                                                                                      Call SalWaitCursor(FALSE)
			! Function: F_Import
				                                                                                                       Description: 
				                                                                                                       Returns 
				                                                                                                       Parameters 
				                                                                                                       Static Variables 
				                                                                                                       Local variables 
					                                                                                                       String: CC_ID_
					                                                                                                       String: OKPOK_
					                                                                                                       String: OKPOD_
					                                                                                                       String: IDK_
					                                                                                                       String: NDOC_
					                                                                                                       Date/Time: DDOC_
					                                                                                                       Number: SDOC_
					                                                                                                       Number: PR_
				                                                                                                       Actions 
					                                                                                                       Set KOL = 0
					                                                                                                       Call SalTblReset( hWndForm )
					                                                                                                       If SqlPrepareAndExecute( hSql(),
							"select CC_ID , OKPOK , OKPOD,  IDK,  NDOC,  DDOC , SDOC,  0 
							 into  :CC_ID_,:OKPOK_,:OKPOD_,:IDK_,:NDOC_,:DDOC_,:SDOC_,:PR_ 
							 from bars_invoice 
							 where (OKPOK,CC_ID,OKPOD,IDK,NDOC,DDOC,SDOC) not in 
							(select  OKPOK, CC_ID,OKPOD,IDK,NDOC,DDOC,SDOC from DF_BARS_INVOICE)
							 order by DDOC " )
						                                                                                                       While SqlFetchNext( hSql(), nFetchRes)
							                                                                                                       Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
							                                                                                                       Call SalTblSetContext(hWndForm, nRow )
							                                                                                                       Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE  )
							                                                                                                       Set FA5.NDOC = NDOC_
							                                                                                                       Set FA5.DDOC = DDOC_
							                                                                                                       Set FA5.SDOC = SDOC_
							                                                                                                       Set FA5.CC_ID= CC_ID_
							                                                                                                       Set FA5.IDK  = IDK_
							                                                                                                       Set FA5.OKPO_K=OKPOK_
							                                                                                                       Set FA5.OKPO_D=OKPOD_
							                                                                                                       Set FA5.SOS_NAME='ДФ'
							                                                                                                       If CC_ID_ != STRING_Null and OKPOK_ != STRING_Null 
									and SqlPrepareAndExecute( hSqlAux2(),
									  "SELECT E.nd, E.rnk, E.SDATE, E.WDATE, E.LIMIT, K.nmk, 
									    Substr(FAKTOR.NLS(E.ND,E.RNK,'2600'),1,15)   
									   into :FA5.ND, :FA5.RNK_K, :FA5.SDATE, :FA5.WDATE, :FA5.LIMIT, :FA5.NMK_K,:FA5.NLS_K, 
									   from cc_deal E, customer K
									   where E.sos<15 and E.vidd=203 and E.rnk=K.rnk and E.cc_id=:CC_ID_ and K.okpo=:OKPOK_ " )
									and SqlFetchNext( hSqlAux2(), nFetchRes)
								                                                                                                       If IDK_ != STRING_Null and OKPOD_ != STRING_Null 
										and SqlPrepareAndExecute( hSqlAux2(),
										  "SELECT T.nk, T.RNKD, D.nmk, T.SROK, AD.nls,
										          T.SK, T.DATK, To_NUMBER(AD.nlsalt)/100
										   into :FA5.NK, :FA5.RNK_D,:FA5.NMK_D, :FA5.SROK, :FA5.NLS_D,
										        :FA5.SK, :FA5.DATK, :FA5.AVA
										   from FAK_KONTR T, customer D, accounts AD, nd_acc N, cust_acc U 
										   where T.rnkd=D.rnk and D.okpo=:OKPOD_ and T.ND=:FA5.ND and T.idk=:IDK_ 
										     and N.nd=T.ND and N.acc=AD.acc 
										     and U.acc=AD.acc and U.rnk=D.rnk and AD.nbs='2030' ") 
										and SqlFetchNext( hSqlAux2(), nFetchRes) 
									                                                                                                       Set FA5.DOPL = DDOC_ + FA5.SROK
									                                                                                                       If NDOC_= STRING_Null or DDOC_= DATETIME_Null and SDOC_<= 0
										                                                                                                       Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.NDOC/DDOC/SDOC'
									                                                                                                       Else 
										                                                                                                       Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, TRUE  )
										                                                                                                       Call F_STROKA()
								                                                                                                       Else 
									                                                                                                       Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.OKPOD/IDK'
							                                                                                                       Else 
								                                                                                                       Set FA5.SOS_NAME = FA5.SOS_NAME || ' ош.OKPOK/CC_ID'
					                                                                                                       Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: bDat
			String: sBankMfo
			Number: nCol1
			Number: nCol2
			Number: nCol3
			Number: nCol4
			Number: nColR
			Number: nUser 
			Number: NI_ 
			Number: DOC_FAKT
			Number: nKol
			Number: n980
			String: sFilter
			String: sTmp
			String: sNLSD
			Number: nSA
			Number: nTmp
			: cDoc
				Class: cDoc
			String: sSql
			String: sFilter0
			!
			Number: nRow
			Number: SDOC1
			String: sFil_K
			!
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
			!
		Message Actions
			On SAM_Create
				Call SalTblSetLockedColumns( hWndForm, 4 )
				! Set nRed = SalColorFromRGB( 255,245,255 )
				! Set sFilterDF = ''
				If SqlPrepareAndExecute( hSql(),
						"SELECT to_number(val) into :DOC_FAKT from FAK_PARAM where par='DOC_FAKT' ") 
						and NOT SqlFetchNext(hSql(), nFetchRes)
					Call SalDisableWindow( pb_Import )
					Call SalDisableWindow( pb_Import_A )
					Call SalHideWindow( REF_DOC )
				! Call DebugN(DOC_FAKT)
				!
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set nCol1 =SalColorGet ( dDAT4, COLOR_IndexWindow )
				Set nCol2 =SalColorGet ( dDAT4L, COLOR_IndexWindow )
				Set nCol3 =SalColorGet ( dMDATE, COLOR_IndexWindow )
				Set nCol4 =SalColorGet ( dDAT_END, COLOR_IndexWindow )
				Set nColR = SalColorFromRGB( 255,210,210 )
				Set sFil_K =
						" DAT_END >= to_date('" || SalFmtFormatDateTime( bDat, "dd/MM/yyyy") || "','dd/MM/yyyy') " || 
						" and MDATE> to_date('" || SalFmtFormatDateTime( bDat, "dd/MM/yyyy") || "','dd/MM/yyyy') "
				! Call Debug(sFil_K)
				Set sBankMfo = GetBankMfo()
				Set nUser = GetUserId()
				Set FA5.nTabInstance = 1
				Set FA5.strPrintFileName = 'FA5'
				Set FA5.fFilterAtStart = 1
				Set FA5.strFilterTblName = 'FA5'
				!
				Set sFilter0 = " < 15 "
				! Call SalSendMsg( pb_Clos, SAM_Click, 0, 0 )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				! Set FA5.fFilterAtStart = 1
				                                                                                            Call SalWaitCursor(FALSE)
			On UM_Populate
				If FA5.fFilterAtStart
					Set FA5.fFilterAtStart = NOT FA5.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				Call SalWaitCursor(TRUE)
				Set KOL=0
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set sSql =
						"SELECT FA5.NI,FA5.NDOC,  FA5.DDOC,  FA5.SDOC, FA5.SAVA, FA5.DAVA, FA5.PAVA,
						    FA5.DPAVA, FA5.ND,    FA5.RNK_D,FA5.CC_ID, FA5.RNK_K, FA5.NMK_D,
						    FA5.NMK_K, FA5.OKPO_D,FA5.OKPO_K,FA5.SROK, To_NUMBER(FA5.AVA)/100 AVA, 
						    FA5.ACCD,  FA5.NLS_D, FA5.NLS_K, FA5.SOS,  FA5.DOPL, FA5.NK, FA5.IDK, FA5.SK,
						    FA5.DATK,  FA5.DAT_END, FA5.SDATE, FA5.WDATE, FA5.LIMIT,s.NAME, 
						    FA5.SDOC - nvl(g.sn,0)/100, FA5.MDATE , a8.mdate
						 INTO :FA5.NI,:FA5.NDOC,:FA5.DDOC,:FA5.SDOC,:FA5.SAVA,  :FA5.DAVA, :FA5.PAVA,
						 :FA5.DPAVA,  :FA5.ND, :FA5.RNK_D,:FA5.CC_ID,:FA5.RNK_K,:FA5.NMK_D,
						 :FA5.NMK_K,:FA5.OKPO_D,:FA5.OKPO_K,:FA5.SROK,:FA5.AVA,
						 :FA5.ACCD, :FA5.NLS_D,:FA5.NLS_K, :FA5.SOS,  :FA5.DOPL,:FA5.NK, :FA5.IDK, :FA5.SK,
						 :FA5.DATK, :FA5.DAT_END,:FA5.SDATE, :FA5.WDATE,:FA5.LIMIT,:FA5.SOS_NAME, :FA5.NNOM,
						 :FA5.MDATE,:FA5.DAT4L
						FROM fak_sos s, accounts a8, 
						 (select ni,sum(sn) SN from fak_pog group by ni) g, 
						 (SELECT i.NI, i.NDOC, i.DDOC, i.SDOC/100 SDOC,i.SAVA/100 SAVA,i.DAVA,i.PAVA/100 PAVA,
						         i.DPAVA, t.ND,t.RNKD RNK_D,
						         E.CC_ID, E.SDATE, E.WDATE, E.LIMIT, E.rnk RNK_K, d.nmk NMK_D,
						         k.nmk NMK_K, d.okpo OKPO_D,k.okpo OKPO_K, t.SROK, ad.nlsalt AVA,
						         ad.acc ACCD, ad.nls NLS_D,
						         Substr(FAKTOR.NLS(E.ND,E.RNK,'2600'),1,15) NLS_K, t.NK, t.IDK, t.SK, t.DATK,
						         t.DAT_END, i.SOS, (i.DDOC+ t.SROK) DOPL, ad.mdate MDATE
						       FROM FAK_Invoice I, FAK_KONTR T, cc_deal E,customer K,customer D, accounts AD,nd_acc ND
						       WHERE i.nk=t.NK and nvl(t.sos,0)<15
						         and i.sos" || sFilter0 || " 
						         and t.nd=E.nd and t.rnkd=d.rnk and E.rnk=k.rnk
						       and nd.nd=E.ND and nd.acc=ad.acc and ad.rnk=d.rnk and ad.nbs='2030' ) FA5 
						  WHERE a8.nls like '8999_'||FA5.ND and FA5.ni = g.ni (+) 
						    and FA5.sos=s.sos " ||IifS (sFilter = "", ""," and "|| sFilter ) || "
						  ORDER BY RNK_K,RNK_D,NK,NI "
				! Call Debug('читка')
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call F_STROKA()
				If SOS = 9 !! Погашен частично  СЛАБО-СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 239,247,247) )
				Else If SOS = 10 !! Погашен  СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS = 11 !! Выставлен регресс СЛАБО-КРАСНЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ))
				Else If SOS = -1 !! Предварительный ввод  СЛАБО-Желтый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
				!
				If DOC_FAKT != NUMBER_Null and DOC_FAKT > 0
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT REF_DOC into :FA5.REF_DOC from DF_BARS_INVOICE where REF_BARS =:FA5.NI " )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
			On SAM_DoubleClick
				If NI = NUMBER_Null and SOS_NAME = STRING_Null
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							( "FAK_K_D_K", "NMK_D", sFil_K, sTmp, IDK )
					If sTmp != STRING_Null
						Set NK = Val(sTmp)
						If SqlPrepareAndExecute( hSql(),
								"Select ND,cc_id, rnk_K, NMK_K, OKPO_K, RNK_D, NMK_D, OKPO_D, IDK, SK, DATK
								 into :ND,:CC_ID,:RNK_K,:NMK_K,:OKPO_K,:RNK_D,:NMK_D,:OKPO_D,:IDK,:SK,:DATK
								 from FAK_K_D_K where nk=:NK" ) 
								and SqlFetchNext(hSql(), nFetchRes)
						Call F_ZAG()
			! On UM_Update
				                                                                       Set nRow = TBL_MinRow
				                                                                       While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted, 0) 
						  and SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
					                                                                       Call SalTblSetContext(hWndForm, nRow)
					                                                                       If SalTblQueryRowFlags( hWndForm, nRow, ROW_New ) 
							and NK !=NUMBER_Null and NI=NUMBER_Null
						                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.OPEN_INV( NK, NDOC, DDOC, SDOC, NI_ )" )
							                                                                       Set NI = NI_ 
							                                                                       If FA5.SOS_NAME='ДФ' and SqlPrepareAndExecute( hSql(),
									"insert into DF_BARS_INVOICE ( REF_DOC, REF_BARS )
									Values (:REF_DOC, :NI_ )") 
							                                                                       Call SqlCommitEx( hSql(), " Введен Инвойс "||NDOC )
					                                                                       Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted ) 
							and  NI != NUMBER_Null
						                                                                       Set nTmp = 0 
						                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
								and SqlFetchNext( hSql(), nFetchRes) 
						                                                                       If nTmp < SDOC
							                                                                       Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
						                                                                       Else 
							                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
									and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
				                                                                       Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted | ROW_Edited, 0) 
					Call SalTblSetContext(hWndForm, nRow)
					If SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
						! Предварительный ввод - ROW_New
						If SalTblQueryRowFlags( hWndForm, nRow, ROW_New ) 
								and NK !=NUMBER_Null and NI=NUMBER_Null
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "insert into FAK_INVOICE(NK,NDOC,DDOC,SDOC,SOS) values (:NK,:NDOC,:DDOC,:nTmp,-1)" )
						! Удаление или Закрытие - ROW_MarkDeleted
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted) 
							! Удаление из Предварительно введенных
							If SOS = -1 and NI != NUMBER_Null
								If SqlPrepareAndExecute(hSql(),
										  "delete from FAK_INVOICE where ni=:NI" )
							! Закрытие погашенных
							Else
								Set nTmp = 0 
								If SqlPrepareAndExecute( hSql(),
										  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
										and SqlFetchNext( hSql(), nFetchRes) 
								If nTmp < SDOC
									Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
								Else
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
											and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
						! Корректировка Предварительно введенных ROW_Edited
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited) AND SOS = -1 AND NI != NUMBER_Null
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "update FAK_INVOICE set NDOC=:NDOC,DDOC=:DDOC,SDOC=:nTmp where ni=:NI and sos=-1" )
				Call SqlCommit( hSql() )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_TblDoDetails
				Call F_ZAG ()
	Table Window: FA2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Договор факторинга и его  ДЕБИТОРЫ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  13.15"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.25"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить Дебитора '
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Исключить Дебитора '
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pb_L
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LIMS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Изменить ЛИМИТ на Дебитора (Сумму или Дату) '
						On SAM_Click
							If not SalIsNull(ACCD)
								Set nDel = 0
								If SqlPLSQLCommand( hSql(), "FAKTOR.LIMIT_DEB(ND, RNKD, ACCD, LIMITD, MDATE, nDel )")
										and  ( nDel=0 or F_Opl_2() )
										and SqlCommitEx( hSql(), "Изменен лимит на ДеБ= "||Str(RNKD) )
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Selected, TRUE )
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE )
								Else
									Call SqlRollback(hSql())
									Call SalMessageBox('Невозможно Изменить лимит' , 'Ошибка', MB_IconExclamation)
				Line
					Resource Id: 30097
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Контракты Клиента и Дебитора'
				Pushbutton: pb2 ! Паспорт дебитора
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт Дебитора (просмотр)'
						On SAM_Click
							If RNKD != NUMBER_Null
								If TYP=2
									Call EditCustCorps(RNKD,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If TYP=3
									Call EditCustPerson(RNKD,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pb_T8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Финансовое состояние Дебитора (просмотр)'
						On SAM_Click
							If Val(OKPOD) > 0
								Call DEPO( hWndMDI, -1, Val(OKPOD) )
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = "Табличная форма счетов Дебитора (с редактированием)"
						On SAM_Click
							Set sTmp =
									" a.RNK=" || Str(RNKD)||
									" and a.acc in
									 (select acc from nd_acc WHERE nd=" || Str(ND)||"
									  union all
									  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(ND) || ")
									  )"
							If nTip_F  = 90 ! Полный просмотр (Без транзакций)
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
							Else
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, sTmp )
										
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Line
					Resource Id: 30098
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Line
					Resource Id: 30099
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: RNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.655"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег № Клиента')
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.655"
							Width:  2.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Клиента')
				Data Field: OKPO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.983"
							Top:    0.655"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ОКПО Клиента')
				Data Field: NLS_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.655"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет Клиента')
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.905"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ Договора Факторинга')
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.905"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.Договора Факторинга')
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.905"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала ')
				Data Field: DAT4L
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.983"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения лимита на Клиента')
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения договора с ФАКТОРОМ ')
				Data Field: LIMIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Лимит на Клиента')
				!
				Data Field: LIMIT_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.683"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Суммарный лимит на Дебиторов')
				!
				Data Field: KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.905"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество Дебиторов')
				Data Field: OSTC
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Суммарная задолженность по дебиторам')
				Frame
					Resource Id: 30100
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  3.233"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 30101
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 30102
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.683"
						Top:    0.071"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pb_P
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Frame
					Resource Id: 30103
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
		Contents
			Column: RNKD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMKD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If ACCD = NUMBER_Null
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER","NMK",
									" (custtype = 2 or sed = 91 ) and DATE_OFF is null and
									  customer.rnk <> "||Str(RNK), sTmp, NMKD )
							If sTmp !=STRING_Null
								Set RNKD=Val(sTmp)
			Column: AVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						Аванса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TYP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код ОКПО
						дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						задолженности
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						откр. сч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIMITD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит на
						 дебитора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.567"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMITD = NUMBER_Null
							Set LIMITD = 0
					On SAM_Validate
						Call f_Tochka ( LIMITD )
			Column: MDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заверш.Лим
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If MDATE >DAT4
							Set MDATE = DAT4
							Return VALIDATE_Cancel
			!
			Column: OSTD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тек.Задолж.
						 дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол
						контр
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						неисп.лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Opl_2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nS
					Number: nRef
					Number: nDk
				Actions
					If nDel < 0
						Set nDel = - nDel
						Set nDk = 0
					Else
						Set nDk = 1
					Set nS = nDel * 100
					Call cDoc.SetDoc
							(nRef, 'KK1', nDk, 1, Subs(CC_ID,1,10),
							     bDat, SalDateCurrent(), bDat, bDat ,
							     NLS9, NMKD, sBankMfo, '', n980, nS, OKPOD,
							     NLS_9900, NMS_9900, sBankMfo, '', n980, nS, GetBankOkpoS(),
							     "Оприходування зобов`язань по Факторингу " ,
							     '', GetIdOper(), '', NUMBER_Null, 0)
					Return cDoc.oDoc()
			Function: ZAGL_1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set dND = ND
					If SqlPrepareAndExecute( hSql(),
							"select d.rnk, c.nmk, c.okpo, d.cc_id, d.sdate, d.wdate, -a8.ostX/100,
							    Substr(FAKTOR.NLS(d.ND,d.RNK,'2600'),1,15), a8.MDATE 
							Into :RNK, :NMK, :OKPO, :CC_ID, :DAT1, :DAT4, :LIMIT, :NLS_K, :DAT4L
							from cc_deal d, customer c, accounts a8
							WHERE a8.nls like '8999_'||d.nd and a8.kv=:n980 and d.nd=:ND and d.rnk=c.rnk " )
							and  SqlFetchNext(hSql(), nFetchRes)
					If DAT4 <= bDat 
						Call SalColorSet( DAT4, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
					If DAT4L <= bDat 
						Call SalColorSet( DAT4L, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
		Window Parameters
			Number: nMode
			Number: ND
			String: strPar01
			String: sACC8
		Window Variables
			Number: n980
			Number: ACC8
			String: sBankMfo
			Date/Time: bDat
			Number: nUser
			Number: nKol
			String: sFilter
			String: sTmp
			String: sNLSD
			Number: nRow
			Number: nDel
			Number: nTip_K
			Number: nTip_F
			: cDoc
				Class: cDoc
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				! ! ! strPar01 = FK
				! ! ! ! F - функциональность
						      = 0 - ПОЛНАЯ
						      = 9 - Просмотр
				! ! ! ! K - параметр пока не задействован, на будущее
						      = 0
				Call SalTblSetLockedColumns( hWndForm, 3 )
				Set nTip_K = SalNumberMod(Val(strPar01), 10)
				Set nTip_F = Val(strPar01) - nTip_K
				If nTip_F  = 90 ! Полный просмотр (Без транзакций)
					Call SalDisableWindow( FA2.pbIns )
					Call SalDisableWindow( FA2.pbDel )
					Call SalDisableWindow( FA2.pbUpdate )
					Call SalDisableWindow( FA2.pb_L )
					! Call SalDisableWindow( FA2.pbTabAcc )
				!
				Set FA2.strFilterTblName = 'FA2'
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				Set nUser = GetUserId()
				!
				Call ZAGL_1()
				!
				Set ACC8=Val(sACC8)
				Call SalSetWindowText( hWndForm, "ФД № "||CC_ID ||" Клиента "|| NMK || " и его Дебиторы" )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				If SqlPrepareAndExecute( hSql(),
						"SELECT  -sum(a.ostc)/100, count(*), -sum(ostx)/100 INTO :OSTC,:KOL, :LIMIT_D
						 FROM nd_acc n, accounts a
						 WHERE a.nbs='2030' and a.acc=n.acc and n.nd=:FA2.ND ")
						and SqlFetchNext(hSql(), nFetchRes)
				Set FA2.strSqlPopulate =
						"SELECT FA2.custtype, FA2.rnk, FA2.nmk, FA2.okpo, FA2.lim, FA2.nls, FA2.ost, FA2.acc,
						        FA2.daos, FA2.mdate,FA2.kolk, FA2.nlsalt, FA2.nls9
						   INTO :FA2.TYP, :FA2.RNKD, :FA2.NMKD,:FA2.OKPOD,:FA2.LIMITD,:FA2.NLSD,:FA2.OSTD,:FA2.ACCD,
						        :FA2.DAOS,:FA2.MDATE,:FA2.KOLK,:FA2.sTmp, :FA2.NLS9
						   FROM 
						       (SELECT c.custtype,c.rnk,c.nmk,c.okpo,-a.ostx/100 LIM,a.nls,-a.ostc/100 ost,a.acc,
						               a.daos, a.mdate, k.KOLK, a.nlsalt,
						               Substr(FAKTOR.NLS(n.nd,c.rnk,'9129'),1,15) NLS9
						          FROM nd_acc n, accounts a , customer c, cust_acc u,
						               (select ND,RNKD,count(*) KOLK from fak_kontr where nd=:FA2.ND group by nd, rnkd) k
						         WHERE n.nd=:FA2.ND and k.rnkd(+)=c.RNK and u.acc=a.acc
						           and a.accc=:FA2.ACC8 and a.acc=n.acc and a.tip='SS '
						           and u.rnk=c.rnk and a.dazs is null and c.RNK<> :FA2.RNK ) FA2 "|| IifS (sFilter = "", ""," where "|| sFilter ) 
				Call SalTblPopulate(hWndForm, hSql(), FA2.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				If RNKD > 0 and ACCD>0
					Call Sel020( hWndForm, 205, ND, strPar01,Str(RNKD) )
			On SAM_TblDoDetails
				! If IsWindow( h_FA8 )
					                                                                Call SalDestroyWindow(h_FA8 )
				If IsWindow( h_FA4 )
					Call SalDestroyWindow(h_FA4 )
				If IsWindow( h_FA3 )
					Call SalDestroyWindow(h_FA3 )
			On SAM_FetchRowDone
				Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) )
				If FA2.MDATE <= bDat
					! Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ) )
					Call XSalTblSetCellBackColor( FA2.MDATE, SalColorFromRGB( 255,210,210 ) )
				Set AVA = Val(sTmp)/100
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
						If SqlPLSQLCommand( hSql(), "FAKTOR.OPEN_DEB( ND, RNKD, AVA, ACCD )" )
								and SqlCommitEx( hSql(), " ФД = "||Str(ND)||", Введен Дебитор "||Str(RNKD) )
					Else
						If SqlPLSQLCommand( hSql(), "FAKTOR.UPDATE_DEB(ND,RNKD,AVA,ACCD )" )
								and SqlCommitEx( hSql(), "Обновлен Дебитор "||Str(RNKD) )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
	Table Window: FA3
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Контракты Дебитора
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  16.967"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.167"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить Контракт '
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_CLSD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть контракт в Архив '
						On SAM_Click
							Call F_Close()
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Line
					Resource Id: 30104
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Line
					Resource Id: 30105
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
				Line
					Resource Id: 30106
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Frame
					Resource Id: 30107
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 30108
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  2.133"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 30109
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.283"
							Top:    0.571"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Реф дог.Факторинга')
				Data Field: RNK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.571"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег.№ Клиента')
				Data Field: NMK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.083"
							Top:    0.571"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Клиента')
				Data Field: OKPO_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.571"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Клиента')
				Data Field: NLS_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.571"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет Клиента')
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.183"
							Top:    0.571"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № дог.Факторинга')
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала дог.Факторинга')
				Data Field: DAT4L
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.983"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения лимита на Клиента')
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.983"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения дог.Факторинга')
				!
				Data Field: RNK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.821"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Рег.№ Дебитора ')
				Data Field: NMK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.083"
							Top:    0.821"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Дебитора')
				Data Field: OKPO_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.821"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Дебитора')
				Data Field: NLS_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.821"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет Дебитора')
				Data Field: LIMIT_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.183"
							Top:    0.821"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Лимит на Дебитора ')
				Data Field: DAOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.821"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата открытия Дебитора')
				Data Field: MDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.983"
							Top:    0.821"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завеш.действующего лимита на Дебитора')
				Data Field: OST_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.283"
							Top:    0.821"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Текущая задолженность Дебитора ')
				Data Field: KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество Контрактов')
				Frame
					Resource Id: 30110
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.583"
						Top:    0.071"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Check Box: cb_TXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Скрыть/Показать Детали Контракта
					Window Location and Size
						Left:   6.183"
						Top:    0.238"
						Width:  4.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_TXT = 1
								Call SalHideWindow( TXT )
							Else
								Call SalShowWindow( TXT )
		Contents
			Column: NK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						контр.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IDK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						контракта
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата нач
						контр
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.25"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата заверш
						контр
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						контракта
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SK = NUMBER_Null
							Set SK = 0
					On SAM_Validate
						Call f_Tochka ( SK )
			Column: SROK0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ожида
						ние
						(дней)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оконч.
						Отсроч
						(дней)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_KillFocus
						If SROK0 > SROK and SROK0 != NUMBER_Null and SROK != NUMBER_Null 
							Call SalMessageBox("Срок ожидания БОЛЬШЕ Срока отсрочки платежа",
									"Внимание, ошибка !", MB_IconStop)
							Set SROK0 = NUMBER_Null
							Set SROK = NUMBER_Null
			!
			Column: TAR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тариф
						(коп) 
						за инв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % 
						суммы
						инв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SMIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: MIN
						(коп) 
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SMAX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: MAX
						(коп) 
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						факт.проплат
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Детали контракта
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ZAGL_1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set dND = ND
					If SqlPrepareAndExecute( hSql(),
							"select d.rnk,c.nmk,c.okpo,d.cc_id,d.sdate,d.wdate,
							  Substr(FAKTOR.NLS(d.ND,d.RNK,'2600'),1,15), a8.MDATE
							 Into :RNK_K, :NMK_K, :OKPO_K, :CC_ID, :DAT1,:DAT4, :NLS_K, :DAT4L
							 from cc_deal d, customer c, accounts a8
							 WHERE d.nd=:ND and d.rnk=c.rnk and a8.nls like '8999_'||d.nd " )
							and SqlFetchNext(hSql(), nFetchRes)
					If DAT4 <= bDat 
						Call SalColorSet( DAT4, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
					If DAT4L <= bDat 
						Call SalColorSet( DAT4L, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
			Function: ZAGL_2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set RNK_D = Val(sRNKD)
					If SqlPrepareAndExecute( hSql(),
							"select a.nls, c.nmk, c.okpo, -a.ostX/100, a.daos, a.mdate, -a.ostc/100
							Into :NLS_D, :NMK_D, :OKPO_D, :LIMIT_D, :DAOS,:MDATE, :OST_D
							FROM nd_acc n, accounts a, customer c, cust_acc u
							WHERE n.nd=:ND and a.acc=n.acc and a.nbs='2030' and u.acc=a.acc 
							   and u.rnk=c.rnk and a.dazs is null and c.RNK=:RNK_D")
							and  SqlFetchNext(hSql(), nFetchRes)
					If MDATE <= bDat 
						Call SalColorSet( MDATE, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
			Function: F_Close
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: Soob
				Actions
					If NK >0 and NK != NUMBER_Null
						Set Soob = "Закрытие контракта "||IDK 
						If SqlPrepareAndExecute( hSql(), 
								"select 1 from FAK_Invoice where nk=:NK and sos <15 " ) 
								and SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox( Soob || " невозможно, 
									т.к. есть НЕзакрытые инвойсы !", 
									"Внимание ! ", MB_IconStop)
						Else
							If SalMessageBox(Soob || " ? " ,
									"Внимание ! ", MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(), "update FAK_KONTR set sos =15 where nk=:NK " ) 
									Call SqlCommitEx( hSql(), Soob )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Else
									Call SqlRollback( hSql() )
						!
					Return FALSE
		Window Parameters
			Number: nMode
			Number: ND
			String: strPar01
			String: sRNKD
		Window Variables
			Date/Time: bDat
			String: sBankMfo
			Number: nUser
			! Number: n980
			Number: nKol
			String: sFilter
			String: sTmp
			String: sNLSD
			Number: nTip_K
			Number: nTip_F
			Number: nColJ
		Message Actions
			On SAM_Create
				! ! ! strPar01 = FK
				! ! ! ! F - функциональность
						      = 0 - ПОЛНАЯ
						      = 9 - Просмотр
				! ! ! ! K - параметр пока не задействован, на будущее
						      = 0
				Call SetWindowFullSize(hWndForm)
				Set nTip_K = SalNumberMod(Val(strPar01), 10)
				Set nTip_F = Val(strPar01) - nTip_K
				Set bDat  = GetBankDate()
				Set cb_TXT = 1
				Set nColJ =SalColorGet ( pbIns, COLOR_IndexWindow )
				If nTip_F  = 90 ! Полный просмотр (Без транзакций)
					Call SalDisableWindow( FA3.pbIns )
					Call SalDisableWindow( FA3.pbDel )
					Call SalDisableWindow( FA3.pbUpdate )
				!
				Set FA3.strFilterTblName = 'FA3'
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				!
				Call SalTblSetLockedColumns( hWndForm, 7 )
				!
				Call ZAGL_1()
				Call ZAGL_2()
				Set sBankMfo= GetBankMfo()
				Set nUser = GetUserId()
				Call SalSetWindowText( hWndForm, "ФД № "||CC_ID ||" Кл."|| NMK_K || ", Деб."||NMK_D|| " и их Контракты" )
				Set FA3.nTabInstance = 1
				Set FA3.strPrintFileName = 'FA3'
				If KOM_AVA2 != '1'
					Call SalHideWindow( SROK0 )
				Set FA3.strSqlUpdate =
						"update FAK_KONTR  SET 
						  DAT_END= :FA3.DAT_END, 
						  TAR = :FA3.TAR,
						  PR  = :FA3.PR,
						  SMIN= :FA3.SMIN,
						  SMAX= :FA3.SMAX,
						  IDK =:FA3.IDK, 
						  DATK=:FA3.DATK, 
						  SK  =:FA3.SK,
						  SROK=:FA3.SROK,  SROK0=:FA3.SROK0, 
						  txt =:FA3.TXT
						 where NK=:FA3.NK "
				Set FA3.strSqlDelete = "DELETE from FAK_KONTR where NK=:FA3.NK"
				Set FA3.strSqlInsert =
						 "Insert into FAK_KONTR 
						(IDK,DATK,SK,SROK,SROK0,nd,rnkd,txt,DAT_END,TAR,PR,SMIN,SMAX)
						  values
						 (:FA3.IDK,:FA3.DATK, :FA3.SK, :FA3.SROK, :FA3.SROK0, 
						  :FA3.ND, :FA3.sRNKD,:FA3.TXT,:FA3.DAT_END,:FA3.TAR,:FA3.PR,:FA3.SMIN,:FA3.SMAX) "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set FA3.strSqlPopulate =
						"SELECT FA3.NK,  FA3.DATK, FA3.SK, FA3.SROK, FA3.SROK0, FA3.IDK,  
						        FA3.TXT, FA3.TAR,  FA3.PR, FA3.SMIN, FA3.SMAX,  FA3.DAT_END, 
						        FAKTOR.SF_KONTR(NK)/100
						  INTO :FA3.NK, :FA3.DATK,:FA3.SK,:FA3.SROK,:FA3.SROK0,:FA3.IDK, 
						       :FA3.TXT,:FA3.TAR, :FA3.PR,:FA3.SMIN,:FA3.SMAX, :FA3.DAT_END,
						       :FA3.SF 
						 FROM FAK_KONTR FA3 
						 WHERE nvl(sos,0)<15 and  nd=:FA3.ND 
						   and rnkd=:FA3.sRNKD "|| IifS (sFilter = "", ""," and "|| sFilter ) ||"
						 order by NK desc"
				Set KOL=0
				Call SalTblPopulate(hWndForm, hSql(), FA3.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				! Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_TblDoDetails
				! If IsWindow( h_FA8 )
					                                                                Call SalDestroyWindow(h_FA8 )
				If IsWindow( h_FA4 )
					Call SalDestroyWindow(h_FA4 )
				If DAT_END < bDat 
					Call SalShowWindow( pb_Close )
				Else
					Call SalHideWindow( pb_Close )
			On SAM_FetchRowDone
				Set KOL = KOL + 1
				Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,255,220) )
				Call XSalTblSetCellBackColor( FA3.TAR, nColJ )
				Call XSalTblSetCellBackColor( FA3.PR,  nColJ )
				Call XSalTblSetCellBackColor( FA3.SMIN,nColJ )
				Call XSalTblSetCellBackColor( FA3.SMAX,nColJ )
				If FA3.DAT_END <= bDat
					Call XSalTblSetCellBackColor( FA3.DAT_END, SalColorFromRGB( 255,210,210 ) )
			On SAM_DoubleClick
				If NK > 0
					Call Sel020( hWndForm, 206, NK, strPar01,"" )
	Table Window: FA8
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Инвойсы по Контракту
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.369"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Предварительный ввод новых инвойсов '
				Pushbutton: pb_Nominal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Взятие на учет новых инвойсов '
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow,  0, 0) 
								Call SalTblSetContext(hWndForm, nRow)
								If SOS = -1
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,0)" ) 
											and SqlPrepareAndExecute( hSql(),"update FAK_INVOICE set sos=0 where ni=:NI and sos=-1" )
											and SqlCommitEx( hSql(), " Взят на учет Инвойс "||NDOC )
										Set SOS = 0
							!
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть инвойс '
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\APPLY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выдать аванс '
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
									and RAVA > SAVA and SOS >=0
								Set nSA = RAVA - SAVA
								Call SalModalDialog( dlg_AVA, hWndForm, dND, RNK_D, DAT_END,DOPL, nSA )
								If nSA > 0
									If DEB_2030 
											(dND,RNK_D,nSA,SAVA,NI,DDOC,NDOC,SDOC,
											 NLS_D,NMK_D,OKPO_D,RNK_K,NLS_K,NMK_K,OKPO_K, ACCD )
										Call SqlCommitEx( hSql(), " Аванс по Инвойсу "||NDOC )
										Set OST_D = OST_D + nSA/100
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Call SqlRollback( hSql() )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10795
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10796
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10797
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Frame
					Resource Id: 10798
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  3.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 10799
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые Инвойсы ' )
						On SAM_Click
							If pb_Clos
								Set sFilter0 = " = 15 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pb_Opl )
								Call SalDisableWindow( pb_REGR )
							Else
								Set sFilter0 = " < 15 "
								If nTip_F < 90
									Call SalEnableWindow( pbIns )
									Call SalEnableWindow( pbDel )
									Call SalEnableWindow( pbUpdate )
									Call SalEnableWindow( pb_Opl )
									Call SalEnableWindow( pb_REGR )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 10800
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Реф дог.Факторинга')
						On SAM_SetFocus
							Set nTmpE = dND
						On SAM_AnyEdit
							Set dND = nTmpE
				Data Field: RNK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.571"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег.№ Клиента')
						On SAM_SetFocus
							Set nTmpE = RNK_K
						On SAM_AnyEdit
							Set RNK_K = nTmpE
				Data Field: NMK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.571"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Клиента')
						On SAM_SetFocus
							Set sTmpE = NMK_K
						On SAM_AnyEdit
							Set NMK_K = sTmpE
				Data Field: OKPO_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.571"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Клиента')
						On SAM_SetFocus
							Set sTmpE = OKPO_K
						On SAM_AnyEdit
							Set OKPO_K = sTmpE
				Data Field: NLS_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет Клиента')
						On SAM_SetFocus
							Set sTmpE = NLS_K
						On SAM_AnyEdit
							Set NLS_K = sTmpE
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № дог.Факторинга')
						On SAM_SetFocus
							Set sTmpE = CC_ID
						On SAM_AnyEdit
							Set CC_ID = sTmpE
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.571"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала дог.Факторинга')
						On SAM_SetFocus
							Set dTmpE = DAT1
						On SAM_AnyEdit
							Set DAT1 = dTmpE
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.571"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения дог.Факторинга')
						On SAM_SetFocus
							Set dTmpE = DAT4
						On SAM_AnyEdit
							Set DAT4 = dTmpE
				!
				Data Field: RNK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.821"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Рег.№ Дебитора ')
				Data Field: NMK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.821"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Дебитора')
				Data Field: OKPO_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.821"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Дебитора')
				Data Field: NLS_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет Дебитора')
						On SAM_SetFocus
							Set sTmpE = NLS_D
						On SAM_AnyEdit
							Set NLS_D = sTmpE
				Data Field: LIMIT_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Лимит на Дебитора ')
						On SAM_SetFocus
							Set nTmpE = LIMIT_D
						On SAM_AnyEdit
							Set LIMIT_D = nTmpE
				Data Field: DAOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.821"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата открытия Дебитора')
						On SAM_SetFocus
							Set dTmpE = DAOS
						On SAM_AnyEdit
							Set DAOS = dTmpE
				Data Field: MDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.821"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завеш.действующего лимита на Дебитора')
						On SAM_SetFocus
							Set dTmpE = MDATE
						On SAM_AnyEdit
							Set MDATE = dTmpE
				Data Field: OST_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Текущая задолженность Дебитора ')
						On SAM_SetFocus
							Set nTmpE = OST_D
						On SAM_AnyEdit
							Set OST_D = nTmpE
				Data Field: AVA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.321"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Размер Аванса ( % от суммы Инвойса) ')
				Data Field: KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    1.071"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество откр.Инвойсов по Контракту')
				!
				Data Field: IDK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    1.071"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № Контракта')
				Data Field: DATK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: DateTime
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Дата НАЧАЛА контракта')
				Data Field: DAT_END
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: DateTime
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Дата ЗАВЕРШЕНИЯ контракта')
				Data Field: SK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма контракта')
				Data Field: SROK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    1.071"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Отсрочка платежа (дней) ')
				Frame
					Resource Id: 10801
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.883"
						Top:    0.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Pushbutton: pb_REGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Выставить регресс по одному инвойсу "
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
									and DOPL < bDat and SAVA > PAVA
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), "FAKTOR.REGR_K(NI)" )
									Call SqlCommit( hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Регресс выставлен по инвойсу '||Str(NI),'Сообщение',3,0)
								Else
									Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Неуспешное выставление регресса', 'Ошибка', 0, 1)
				Pushbutton: pb_Import
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Предварительный ИМПОРТ новых инвойсов ( Invoice.dbf )'
						On SAM_Click
							Call Imp_Dbf_New(hWndForm,1, 0, 'Invoice', '' )
							If SqlPrepareAndExecute( hSql(),
									"insert into fak_invoice(NK, NDOC, DDOC, SDOC, SOS) select            
									 :NK, NDOC, DDOC, SDOC*100, -1 from Invoice " )
									and SqlCommit( hSql())
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: NI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NDOC = STRING_Null
							Set NDOC = '№'
					On SAM_Validate
						If NDOC = STRING_Null
							Call SalMessageBox("№ документа инвойса не может быть ПУСТЫМ",
									"Ошибка ! ", MB_IconStop)
							Set NDOC = '№'
			Column: DDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If DDOC = DATETIME_Null
							Set DDOC = bDat
					On SAM_Validate
						If DDOC+SROK <=bDat 
							Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
									"Ошибка ! ", MB_IconStop)
							Set DDOC = bDat
						If DDOC < DATK
							Call SalMessageBox("Дата инвойса меньше даты контракта ",
									"Ошибка ! ", MB_IconStop)
							Set DDOC = bDat
			Column: SDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SDOC = NUMBER_Null
							Set SDOC = 0
						Set SDOC1=SDOC
					On SAM_KillFocus
						If SDOC > SK
							Call SalMessageBox("Сумма инвойса не может быть БОЛЬШЕ Суммы контракта="|| SalNumberToStrX( SK,2),
									"Ошибка ! ", MB_IconStop)
							Set SDOC = SDOC1
						If SDOC <= 0
							Call SalMessageBox("Сумма инвойса должна быть БОЛЬШЕ 0",
									"Ошибка ! ", MB_IconStop)
			!
			Column: DOPL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата
						оплаты
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NNOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						НОМИНАЛА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.
						сумма
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.
						сумма
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						Дата
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DPAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Погаш.
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состояние
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						АВАНСА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ZAGL_1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT k.Nd, k.idk, k.DATK, k.SK, k.SROK, k.rnkd, c.RNK, c.NMK, c.OKPO, d.CC_ID, 
							        Substr(FAKTOR.NLS(d.ND,d.RNK,'2600'),1,15),
							        d.sdate, d.wdate, acrn.FPROCN(a8.acc,0,:FA4.bDat), k.DAT_END
							 INTO :dND, :IDK, :DATK, :SK, :SROK, :RNK_D, :RNK_K, :NMK_K, :OKPO_K, :CC_ID,
							      :NLS_K, :DAT1, :DAT4, :IR, :DAT_END 
							 FROM cc_deal d, customer c, accounts a8, FAK_KONTR k
							 WHERE a8.nls like '8999_'||d.nd and a8.kv=:n980 and d.rnk=c.rnk and d.nd=k.ND and
							 k.nk=:NK ")
							and SqlFetchNext(hSql(), nFetchRes)
			Function: ZAGL_2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					If SqlPrepareAndExecute( hSql(),
							"select a.acc, a.nls, c.nmk, c.okpo, -a.ostX/100, a.daos, a.mdate, -a.ostc/100, a.nlsalt
							Into :ACCD, :NLS_D, :NMK_D, :OKPO_D, :LIMIT_D, :DAOS, :MDATE, :OST_D, :sTmp
							FROM nd_acc n, accounts a, customer c, cust_acc u
							WHERE n.nd=:dND and a.acc=n.acc and a.nbs='2030' and u.acc=a.acc 
							   and u.rnk=c.rnk and a.dazs is null and c.RNK=:RNK_D")
							and  SqlFetchNext(hSql(), nFetchRes)
						Set AVA = Val(sTmp)/100
		Window Parameters
			Number: nMode
			Number: NK
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: bDat
			String: sBankMfo
			Number: nUser
			Number: nTmp
			Number: NI_
			Number: n980
			String: sFilter
			String: sTmp
			Number: nRow
			String: sNLSD
			Number: nSA
			: cDoc
				Class: cDoc
			!
			Number: nRed
			Number: SDOC1
			Number: nTip_K
			Number: nTip_F
			String: sFilter0
			String: sPopulate
			Number: ACCD
			!
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				! ! ! strPar01 = FK
				! ! ! ! F - функциональность
						      = 0 - ПОЛНАЯ
						      = 9 - Просмотр
				! ! ! ! K - параметр пока не задействован, на будущее
						      = 0
				Set nTip_K = SalNumberMod(Val(strPar01), 10)
				Set nTip_F = Val(strPar01) - nTip_K
				!
				Set FA4.strFilterTblName = 'FA4'
				Set nRed = SalColorFromRGB( 255,245,255 )
				!
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				Set nUser = GetUserId()
				!
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Call ZAGL_1()
				If nTip_F  = 90 ! Полный просмотр (Без транзакций)
					Call SalDisableWindow( FA4.pbIns )
					Call SalDisableWindow( FA4.pbDel )
					Call SalDisableWindow( FA4.pbUpdate )
					Call SalDisableWindow( FA4.pb_Opl )
					Call SalDisableWindow( FA4.pb_REGR )
				Call ZAGL_2()
				!
				Call SalSetWindowText( hWndForm, "ФД № "||CC_ID ||" Кл."|| NMK_K || ", Деб."||NMK_D|| ", Контракт "||IDK )
				Set FA4.nTabInstance = 1
				Set FA4.strPrintFileName = 'FA4'
				!
				!
				Call SalSendMsg( pb_Clos, SAM_Click, 0, 0 )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set KOL=0
				If DAT_END < bDat
					Call SalDisableWindow( FA4.pbIns )
					! Call SalDisableWindow( FA4.pbDel )
					! Call SalDisableWindow( FA4.pbUpdate )
					Call SalDisableWindow( FA4.pb_Opl )
					! Call SalDisableWindow( FA4.pb_REGR )
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set FA4.sPopulate =
						" SELECT FA4.Ni, FA4.NDOC, FA4.DDOC, FA4.SDOC, FA4.SAVA, FA4.DAVA,
						         FA4.PAVA, FA4.DPAVA, FA4.sos, FA4.NAME, FA4.NNOM 
						    INTO :FA4.NI,:FA4.NDOC,:FA4.DDOC,:FA4.SDOC,:FA4.SAVA,:FA4.DAVA,
						         :FA4.PAVA,:FA4.DPAVA, :FA4.SOS, :FA4.SOS_NAME, :FA4.NNOM 
						    FROM
						         ( SELECT i.Ni, i.NDOC, i.DDOC, i.SDOC/100 SDOC, i.SAVA/100 SAVA, i.DAVA,
						                  i.PAVA/100 PAVA, i.DPAVA, i.sos, s.NAME, 
						                  (i.SDOC-nvl(g.SN,0))/100 NNOM
						             FROM FAK_Invoice i, fak_sos s, 
						                 (select ni,sum(sn) SN from fak_pog group by ni) g
						            WHERE i.ni=g.ni(+) and s.sos=i.sos 
						              and i.nk=:FA4.NK and i.sos"|| sFilter0 ||" ) FA4"||
						                  IifS (sFilter = "", ""," where "|| sFilter ) 
				Call SalTblPopulate(hWndForm, hSql(), FA4.sPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_TblDoDetails
			On SAM_FetchRowDone
				! Call XSalTblSetRowBackColor( hWndForm, lParam, nRed )
				Set KOL = KOL + 1
				Set DOPL = DDOC + SROK
				Set RAVA = SDOC * AVA/100
				If SOS = 9 !! Погашен частично    СЛАБО-СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 239,247,247) )
				Else If SOS = 10 !! Погашен  СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS = 11 !! Выставлен регресс  СЛАБО-КРАСНЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ))
				Else If SOS = -1 !! Предварительный ввод  СЛАБО-Желтый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
				If DOPL = bDat
					Call XSalTblSetCellBackColor( DOPL, SalColorFromRGB( 230,255,230 ) )
				Else If DOPL < bDat
					Call XSalTblSetCellBackColor( DOPL, COLOR_Green )
				Set NAVA = SAVA - PAVA
				! Set NAVA = SDOC - PAVA
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
						! Предварительный ввод - ROW_New
						If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "insert into FAK_INVOICE(NK,NDOC,DDOC,SDOC,SOS) values (:NK,:NDOC,:DDOC,:nTmp,-1)" )
						! Удаление или Закрытие - ROW_MarkDeleted
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted) 
							! Удаление из Предварительно введенных
							If SOS = -1 and NI != NUMBER_Null
								If SqlPrepareAndExecute(hSql(),
										  "delete from FAK_INVOICE where ni=:NI" )
							! Закрытие погашенных
							Else
								Set nTmp = 0 
								If SqlPrepareAndExecute( hSql(),
										  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
										and SqlFetchNext( hSql(), nFetchRes) 
								If nTmp < SDOC
									Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
								Else
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
											and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
						! Корректировка Предварительно введенных ROW_Edited
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited) AND SOS = -1 AND NI != NUMBER_Null
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "update FAK_INVOICE set NDOC=:NDOC,DDOC=:DDOC,SDOC=:nTmp where ni=:NI and sos=-1" )
				Call SqlCommit( hSql() )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			! On UM_Update
				                                                                       Set nRow = TBL_MinRow
				                                                                       While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted, 0) 
						  and SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
					                                                                       Call SalTblSetContext(hWndForm, nRow)
					                                                                       If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
						                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.OPEN_INV( NK, NDOC, DDOC, SDOC, NI_ )" )
								and SqlCommitEx( hSql(), " Введен Инвойс "||NDOC )
						                                                                       Set NI = NI_
					                                                                       Else 
						                                                                       Set nTmp = 0 
						                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
								and SqlFetchNext( hSql(), nFetchRes) 
						                                                                       If nTmp < SDOC
							                                                                       Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
						                                                                       Else 
							                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
									and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
				                                                                       Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
	Table Window: FA4
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Инвойсы по Контракту
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    1.448"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.369"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Предварительный ввод новых инвойсов '
				Pushbutton: pb_Nominal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Взятие на учет новых инвойсов '
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow,  0, 0) 
								Call SalTblSetContext(hWndForm, nRow)
								If SOS = -1
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,0)" ) 
											and SqlPrepareAndExecute( hSql(),"update FAK_INVOICE set sos=0 where ni=:NI and sos=-1" )
											and SqlCommitEx( hSql(), " Взят на учет Инвойс "||NDOC )
										Set SOS = 0
							!
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрыть инвойс '
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\APPLY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выдать аванс по ОДНОМУ инвойсу (с диалогом) '
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
									and RAVA > SAVA and SOS >=0
								Set nSA = RAVA - SAVA
								Call SalModalDialog( dlg_AVA, hWndForm, dND, RNK_D, DAT_END,DOPL, nSA )
								If nSA > 0
									If DEB_2030 
											(dND,RNK_D,nSA,SAVA,NI,DDOC,NDOC,SDOC,
											 NLS_D,NMK_D,OKPO_D,RNK_K,NLS_K,NMK_K,OKPO_K, ACCD )
										Call SqlCommitEx( hSql(), " Аванс по Инвойсу "||NDOC )
										Set OST_D = OST_D + nSA/100
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Call SqlRollback( hSql() )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40100
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40101
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40102
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Frame
					Resource Id: 40103
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  3.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 40104
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые Инвойсы ' )
						On SAM_Click
							If pb_Clos
								Set sFilter0 = " = 15 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pb_Opl )
								Call SalDisableWindow( pb_REGR )
							Else
								Set sFilter0 = " < 15 "
								If nTip_F < 90
									Call SalEnableWindow( pbIns )
									Call SalEnableWindow( pbDel )
									Call SalEnableWindow( pbUpdate )
									Call SalEnableWindow( pb_Opl )
									Call SalEnableWindow( pb_REGR )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 40105
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Реф дог.Факторинга')
						On SAM_SetFocus
							Set nTmpE = dND
						On SAM_AnyEdit
							Set dND = nTmpE
				Data Field: RNK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.571"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег.№ Клиента')
						On SAM_SetFocus
							Set nTmpE = RNK_K
						On SAM_AnyEdit
							Set RNK_K = nTmpE
				Data Field: NMK_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.571"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Клиента')
						On SAM_SetFocus
							Set sTmpE = NMK_K
						On SAM_AnyEdit
							Set NMK_K = sTmpE
				Data Field: OKPO_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.571"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Клиента')
						On SAM_SetFocus
							Set sTmpE = OKPO_K
						On SAM_AnyEdit
							Set OKPO_K = sTmpE
				Data Field: NLS_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Счет Клиента')
						On SAM_SetFocus
							Set sTmpE = NLS_K
						On SAM_AnyEdit
							Set NLS_K = sTmpE
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.571"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № дог.Факторинга')
						On SAM_SetFocus
							Set sTmpE = CC_ID
						On SAM_AnyEdit
							Set CC_ID = sTmpE
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала дог.Факторинга')
						On SAM_SetFocus
							Set dTmpE = DAT1
						On SAM_AnyEdit
							Set DAT1 = dTmpE
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения дог.Факторинга')
						On SAM_SetFocus
							Set dTmpE = DAT4
						On SAM_AnyEdit
							Set DAT4 = dTmpE
				Data Field: DAT4L
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения лимита на Клиента')
						On SAM_SetFocus
							Set dTmpE = DAT4
						On SAM_AnyEdit
							Set DAT4 = dTmpE
				!
				Data Field: RNK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.821"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Рег.№ Дебитора ')
						On SAM_SetFocus
							Set nTmpE = RNK_D
						On SAM_AnyEdit
							Set RNK_D = nTmpE
				Data Field: NMK_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.821"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Наименование Дебитора')
						On SAM_SetFocus
							Set sTmpE = NMK_D
						On SAM_AnyEdit
							Set NMK_D = sTmpE
				Data Field: OKPO_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.821"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' ОКПО Дебитора')
						On SAM_SetFocus
							Set sTmpE = OKPO_D
						On SAM_AnyEdit
							Set OKPO_D = sTmpE
				Data Field: NLS_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет Дебитора')
						On SAM_SetFocus
							Set sTmpE = NLS_D
						On SAM_AnyEdit
							Set NLS_D = sTmpE
				Data Field: LIMIT_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Лимит на Дебитора ')
						On SAM_SetFocus
							Set nTmpE = LIMIT_D
						On SAM_AnyEdit
							Set LIMIT_D = nTmpE
				Data Field: DAOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.821"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата открытия Дебитора')
						On SAM_SetFocus
							Set dTmpE = DAOS
						On SAM_AnyEdit
							Set DAOS = dTmpE
				Data Field: MDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.821"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завеш.действующего лимита на Дебитора')
						On SAM_SetFocus
							Set dTmpE = MDATE
						On SAM_AnyEdit
							Set MDATE = dTmpE
				Data Field: OST_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Текущая задолженность Дебитора ')
						On SAM_SetFocus
							Set nTmpE = OST_D
						On SAM_AnyEdit
							Set OST_D = nTmpE
				Data Field: AVA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Размер Аванса ( % от суммы Инвойса) ')
						On SAM_SetFocus
							Set nTmpE = AVA
						On SAM_AnyEdit
							Set AVA = nTmpE
				Data Field: KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество откр.Инвойсов по Контракту')
				!
				Data Field: IDK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    1.071"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' № Контракта')
						On SAM_SetFocus
							Set sTmpE = IDK
						On SAM_AnyEdit
							Set IDK = sTmpE
				Data Field: DATK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Дата НАЧАЛА контракта')
						On SAM_SetFocus
							Set dTmpE = DATK
						On SAM_AnyEdit
							Set DATK = dTmpE
				Data Field: DAT_END
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Дата ЗАВЕРШЕНИЯ контракта')
						On SAM_SetFocus
							Set dTmpE = DAT_END
						On SAM_AnyEdit
							Set DAT_END = dTmpE
				Data Field: SK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.983"
							Top:    1.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма контракта')
				Data Field: SROK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Отсрочка платежа (дней) ')
				Frame
					Resource Id: 40106
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.883"
						Top:    0.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? No
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Pushbutton: pb_REGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Выставить регресс по одному инвойсу "
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
									and DOPL < bDat and SAVA > PAVA and SOS <10
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), "FAKTOR.REGR_K(NI)" )
									Call SqlCommit( hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Регресс выставлен по инвойсу '||Str(NI),'Сообщение',3,0)
								Else
									Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Неуспешное выставление регресса', 'Ошибка', 0, 1)
				Pushbutton: pb_Import
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Предварительный ИМПОРТ новых инвойсов ( Invoice.dbf )'
						On SAM_Click
							! If SqlPrepareAndExecute( hSql(),"DELETE from INVOICE " )
								! Call Imp_Dbf_New(hWndForm, NUMBER_Null, 0, 'INVOICE', '' )
								                                                          Call Imp_KL_NBU(hWndMDI)
								                                                          If SqlPrepareAndExecute( hSql(),
										"insert into fak_invoice(NK, NDOC, DDOC, SDOC, SOS) select            
										 :NK, NDOC, DDOC, SDOC*100, -1 from INVOICE " )
										and SqlCommit( hSql())
								                                                          Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							! Call Imp_Dbf_New(hWndForm, NUMBER_Null, 0, 'INVOICE', '' )
							Call Imp_KL_NBU(hWndMDI)
							If SqlPrepareAndExecute( hSql(),
									"insert into fak_invoice(NK, NDOC, DDOC, SDOC, SOS)
									 select :NK, NDOC, DDOC, SDOC*100, -1 from INVOICE " )
									and SqlPrepareAndExecute( hSql(),"DELETE from INVOICE " )
									and SqlCommit( hSql())
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: NI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NDOC = STRING_Null
							Set NDOC = '№'
					On SAM_Validate
						If NDOC = STRING_Null
							Call SalMessageBox("№ документа инвойса не может быть ПУСТЫМ",
									"Ошибка ! ", MB_IconStop)
							Set NDOC = '№'
			Column: DDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If DDOC = DATETIME_Null
							Set DDOC = bDat
					On SAM_Validate
						If DDOC+SROK <=bDat 
							Call SalMessageBox("Дата инвойса - "||Str(SROK) ||" меньше банковской даты ",
									"Ошибка ! ", MB_IconStop)
							Set DDOC = bDat
						If DDOC < DATK
							Call SalMessageBox("Дата инвойса меньше даты контракта ",
									"Ошибка ! ", MB_IconStop)
							Set DDOC = bDat
			Column: SDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						инвойса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SDOC = NUMBER_Null
							Set SDOC = 0
						Set SDOC1=SDOC
					On SAM_KillFocus
						Call f_Tochka ( SDOC )
						If SDOC > SK
							Call SalMessageBox("Сумма инвойса не может быть БОЛЬШЕ Суммы контракта="|| SalNumberToStrX( SK,2),
									"Ошибка ! ", MB_IconStop)
							Set SDOC = SDOC1
						If SDOC <= 0
							Call SalMessageBox("Сумма инвойса должна быть БОЛЬШЕ 0",
									"Ошибка ! ", MB_IconStop)
			!
			Column: DOPL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата
						оплаты
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NNOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						НОМИНАЛА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.
						сумма
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.
						сумма
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						Дата
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DPAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Погаш.
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состояние
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						погашено
						АВАНСА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ZAGL_1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT k.Nd, k.idk, k.DATK, k.SK, k.SROK, k.rnkd, c.RNK, c.NMK, c.OKPO, d.CC_ID, 
							        Substr(FAKTOR.NLS(d.ND,d.RNK,'2600'),1,15),
							        d.sdate, d.wdate, acrn.FPROCN(a8.acc,0,:FA4.bDat), k.DAT_END, a8.MDATE
							 INTO :dND, :IDK, :DATK, :SK, :SROK, :RNK_D, :RNK_K, :NMK_K, :OKPO_K, :CC_ID,
							      :NLS_K, :DAT1, :DAT4, :IR, :DAT_END ,:DAT4L
							 FROM cc_deal d, customer c, accounts a8, FAK_KONTR k
							 WHERE a8.nls like '8999_'||d.nd and a8.kv=:n980 and d.rnk=c.rnk and d.nd=k.ND and
							 k.nk=:NK ")
							and SqlFetchNext(hSql(), nFetchRes)
					If DAT4 <= bDat 
						Call SalColorSet( DAT4, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
					If DAT4L <= bDat 
						Call SalColorSet( DAT4L, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
					If DAT_END <= bDat 
						Call SalColorSet( DAT_END, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
			Function: ZAGL_2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					If SqlPrepareAndExecute( hSql(),
							"select a.acc, a.nls, c.nmk, c.okpo, -a.ostX/100, a.daos, a.mdate, -a.ostc/100, a.nlsalt
							Into :ACCD, :NLS_D, :NMK_D, :OKPO_D, :LIMIT_D, :DAOS, :MDATE, :OST_D, :sTmp
							FROM nd_acc n, accounts a, customer c, cust_acc u
							WHERE n.nd=:dND and a.acc=n.acc and a.nbs='2030' and u.acc=a.acc 
							   and u.rnk=c.rnk and a.dazs is null and c.RNK=:RNK_D")
							and  SqlFetchNext(hSql(), nFetchRes)
						Set AVA = Val(sTmp)/100
					If MDATE <= bDat 
						Call SalColorSet( MDATE, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ) )
		Window Parameters
			Number: nMode
			Number: NK
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: bDat
			String: sBankMfo
			Number: nUser
			Number: nTmp
			Number: NI_
			Number: n980
			String: sFilter
			String: sTmp
			Number: nRow
			String: sNLSD
			Number: nSA
			: cDoc
				Class: cDoc
			!
			Number: nRed
			Number: SDOC1
			Number: nTip_K
			Number: nTip_F
			String: sFilter0
			String: sPopulate
			Number: ACCD
			!
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
			!
		Message Actions
			On SAM_Create
				! ! ! strPar01 = FK
				! ! ! ! F - функциональность
						      = 0 - ПОЛНАЯ
						      = 9 - Просмотр
				! ! ! ! K - параметр пока не задействован, на будущее
						      = 0
				Set nTip_K = SalNumberMod(Val(strPar01), 10)
				Set nTip_F = Val(strPar01) - nTip_K
				!
				Set FA4.strFilterTblName = 'FA4'
				Set nRed = SalColorFromRGB( 255,245,255 )
				!
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				Set nUser = GetUserId()
				!
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Call ZAGL_1()
				If nTip_F  = 90 ! Полный просмотр (Без транзакций)
					Call SalDisableWindow( FA4.pbIns )
					Call SalDisableWindow( FA4.pbDel )
					Call SalDisableWindow( FA4.pbUpdate )
					Call SalDisableWindow( FA4.pb_Opl )
					Call SalDisableWindow( FA4.pb_REGR )
				Call ZAGL_2()
				!
				Call SalSetWindowText( hWndForm, "ФД № "||CC_ID ||" Кл."|| NMK_K || ", Деб."||NMK_D|| ", Контракт "||IDK )
				Set FA4.nTabInstance = 1
				Set FA4.strPrintFileName = 'FA4'
				!
				!
				Call SalSendMsg( pb_Clos, SAM_Click, 0, 0 )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set KOL=0
				If DAT_END < bDat
					Call SalDisableWindow( FA4.pbIns )
					! Call SalDisableWindow( FA4.pbDel )
					! Call SalDisableWindow( FA4.pbUpdate )
					Call SalDisableWindow( FA4.pb_Opl )
					! Call SalDisableWindow( FA4.pb_REGR )
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set FA4.sPopulate =
						" SELECT FA4.Ni, FA4.NDOC, FA4.DDOC, FA4.SDOC, FA4.SAVA, FA4.DAVA,
						         FA4.PAVA, FA4.DPAVA, FA4.sos, FA4.NAME, FA4.NNOM 
						    INTO :FA4.NI,:FA4.NDOC,:FA4.DDOC,:FA4.SDOC,:FA4.SAVA,:FA4.DAVA,
						         :FA4.PAVA,:FA4.DPAVA, :FA4.SOS, :FA4.SOS_NAME, :FA4.NNOM 
						    FROM
						         ( SELECT i.Ni, i.NDOC, i.DDOC, i.SDOC/100 SDOC, i.SAVA/100 SAVA, i.DAVA,
						                  i.PAVA/100 PAVA, i.DPAVA, i.sos, s.NAME, 
						                  (i.SDOC-nvl(g.SN,0))/100 NNOM
						             FROM FAK_Invoice i, fak_sos s, 
						                 (select ni,sum(sn) SN from fak_pog group by ni) g
						            WHERE i.ni=g.ni(+) and s.sos=i.sos 
						              and i.nk=:FA4.NK and i.sos"|| sFilter0 ||" ) FA4"||
						                  IifS (sFilter = "", ""," where "|| sFilter ) 
				Call SalTblPopulate(hWndForm, hSql(), FA4.sPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_TblDoDetails
				If SOS > 9 or SOS = -1 
					Call SalDisableWindow( pb_REGR )
					Call SalDisableWindow( pb_Opl )  
				Else
					Call SalEnableWindow( pb_REGR )  
					Call SalEnableWindow( pb_Opl )  
			On SAM_FetchRowDone
				! Call XSalTblSetRowBackColor( hWndForm, lParam, nRed )
				Set KOL = KOL + 1
				Set DOPL = DDOC + SROK
				Set RAVA = SDOC * AVA/100
				If SOS = 9 !! Погашен частично    СЛАБО-СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 239,247,247) )
				Else If SOS = 10 !! Погашен  СЕРЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS = 11 !! Выставлен регресс  СЛАБО-КРАСНЫЙ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ))
				Else If SOS = -1 !! Предварительный ввод  СЛАБО-Желтый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
				If DOPL = bDat
					Call XSalTblSetCellBackColor( DOPL, SalColorFromRGB( 230,255,230 ) )
				Else If DOPL < bDat
					Call XSalTblSetCellBackColor( DOPL, COLOR_Green )
				Set NAVA = SAVA - PAVA
				! Set NAVA = SDOC - PAVA
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
						! Предварительный ввод - ROW_New
						If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "insert into FAK_INVOICE(NK,NDOC,DDOC,SDOC,SOS) values (:NK,:NDOC,:DDOC,:nTmp,-1)" )
						! Удаление или Закрытие - ROW_MarkDeleted
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted) 
							! Удаление из Предварительно введенных
							If SOS = -1 and NI != NUMBER_Null
								If SqlPrepareAndExecute(hSql(),
										  "delete from FAK_INVOICE where ni=:NI" )
							! Закрытие погашенных
							Else
								Set nTmp = 0 
								If SqlPrepareAndExecute( hSql(),
										  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
										and SqlFetchNext( hSql(), nFetchRes) 
								If nTmp < SDOC
									Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
								Else
									If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
											and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
						! Корректировка Предварительно введенных ROW_Edited
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited) AND SOS = -1 AND NI != NUMBER_Null
							Set nTmp = SDOC * 100 
							If SqlPrepareAndExecute( hSql(),
									  "update FAK_INVOICE set NDOC=:NDOC,DDOC=:DDOC,SDOC=:nTmp where ni=:NI and sos=-1" )
				Call SqlCommit( hSql() )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			! On UM_Update
				                                                                       Set nRow = TBL_MinRow
				                                                                       While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_MarkDeleted, 0) 
						  and SDOC > 0 and DDOC != DATETIME_Null and NDOC !=STRING_Null 
					                                                                       Call SalTblSetContext(hWndForm, nRow)
					                                                                       If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
						                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.OPEN_INV( NK, NDOC, DDOC, SDOC, NI_ )" )
								and SqlCommitEx( hSql(), " Введен Инвойс "||NDOC )
						                                                                       Set NI = NI_
					                                                                       Else 
						                                                                       Set nTmp = 0 
						                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT NVL(sum(SN),0)/100 INTO :nTmp from FAK_POG where ni=:NI " )
								and SqlFetchNext( hSql(), nFetchRes) 
						                                                                       If nTmp < SDOC
							                                                                       Call MessageError('Невозможно закрыть непогашенный инвойс №'||Str(NI))
						                                                                       Else 
							                                                                       If SqlPLSQLCommand( hSql(), "FAKTOR.INV_9800(NI,1)" )
									and SqlCommitEx( hSql(), " Закрыт Инвойс "||NDOC )
				                                                                       Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
	! cGenericTableSpl: XL1
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.winattr class Form Window:
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name: vti11.dll;0;3145728;;;
		Title: Овердрафт холдинга
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.8"
				Top:    1.073"
				Width:  15.333"
				Width Editable? Yes
				Height: 6.095"
				Height Editable? Yes
			Form Size
				Width:  -1.0"
				Height: -1.0"
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                 Description: 
		                                                 Named Menus 
		                                                 Menu 
		                                                 Tool Bar 
			                                                 Contents 
				                                                 Frame 
				                                                 Pushbutton: pbIns
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Открыть овердрафт выбранному Холдингу'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 ) and tbl.ACC8 = NUMBER_Null 
								                                                 Call tbl.OP_1()
				                                                 Pushbutton: pbUpdate
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Сохранить установки по дочерним счетам'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 ) and tbl.ACC8 != NUMBER_Null 
								                                                 Call tbl2.OP_2()
				                                                 Pushbutton: pbAccHistory2
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'История выбранного доч.счета'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl2, ROW_Selected, 0 ) and tbl2.ACC > 0
								                                                 Call Show_Sal_Day_P (tbl2.ACC, tbl2.NLS, tbl2.KV, DAT1, DAT2)
				                                                 Pushbutton: pb_PR
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Процентная карточка выбранного доч.счета'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl2, ROW_Selected, 0 ) and tbl2.ACC > 0
								                                                 Call SetProcParN(tbl2.ACC, tbl2.KV, "", "" )
				!
				                                                 Pushbutton: pb_Sum
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Установить суммарный остаток на консолидированном счете'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 ) and tbl.ACC8 != NUMBER_Null 
								                                                 Call tbl.OST_1()
				                                                 Data Field: DAT1
					                                                 Message Actions 
						                                                 On SAM_TooltipSetText
							                                                 Return XSalTooltipSetText( lParam, 'Дата "С" ')
				                                                 Data Field: DAT2
					                                                 Message Actions 
						                                                 On SAM_TooltipSetText
							                                                 Return XSalTooltipSetText( lParam, 'Дата "По" ')
				                                                 Check Box: cb2
					                                                 Message Actions 
						                                                 On SAM_TooltipSetText
							                                                 Return XSalTooltipSetText( lParam, 'Только вкл.счета / Все счета')
				                                                 Pushbutton: pb_PR_ALL
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Расчетные Проценты за период'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 )
								                                                 Call tbl2.PR_2 ()
				                                                 Data Field: PR_A
					                                                 Message Actions 
						                                                 On SAM_TooltipSetText
							                                                 Return XSalTooltipSetText( lParam, 'Расчетные % по АКТ в нац.вал')
				                                                 Data Field: PR_P
					                                                 Message Actions 
						                                                 On SAM_TooltipSetText
							                                                 Return XSalTooltipSetText( lParam, 'Расчетные % по ПАС в нац.вал')
				!
				                                                 Pushbutton: pbDel
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Изъять Документ из картотеки'
				                                                 Pushbutton: pbDetails
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Счета, входящие в Холдинг'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 ) 
								                                                 Call tbl2.NAS_2()
				                                                 Pushbutton: pbRefresh
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Перечитать нераспределенные документы-поступления'
						                                                 On SAM_Click
							                                                 Call tbl.NAS_1( )
				                                                 Line 
				                                                 Pushbutton: pbSearch
					                                                 Message Actions 
				                                                 Pushbutton: pbFilter
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Установить фильтр на документы (верхняя таблица)'
						                                                 On SAM_Click
							                                                 Set sFilter = ""
							                                                 If NOT SetQueryFilter( cF )
								                                                 Call SalDestroyWindow( hWndForm )
							                                                 Set sFilter = cF.GetFilterWhereClause( FALSE )
							                                                 Call Debug(sFilter)
				                                                 Pushbutton: pbPrint
					                                                 Message Actions 
				                                                 Line 
				                                                 Pushbutton: pbExit
					                                                 Message Actions 
				                                                 Line 
				!
		                                                 Contents 
			                                                 Custom Control: ccSplitter
				                                                 Message Actions 
			                                                 Child Table: tbl ! Холдинги
				                                                 Contents 
					!
					                                                 Column: RNKP
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: NMKP 
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: KOLK
						                                                 List Values 
						                                                 Message Actions 
					!
					                                                 Column: NLSP 
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: KOL
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: DOS
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: KOS
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: OSTC
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: OSTB
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: ACC8
						                                                 List Values 
						                                                 Message Actions 
				                                                 Functions 
					                                                 Function: NAS_1
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
						                                                 Actions 
							                                                 Call SalTblSetTableFlags ( tbl, TBL_Flag_SingleSelection, TRUE )
							                                                 Call SalTblSetLockedColumns( tbl, 3 )
							                                                 Set sSql1 =
									"SELECT k.RNKP, c.NMK,  k.KOLK, a.acc, a.nls, a.ostc, a.ostb
									INTO :tbl.RNKP,:tbl.NMKP,:tbl.KOLK, :tbl.ACC8,:tbl.NLSP, :tbl.OSTC, :tbl.OSTB
									  FROM customer c, 
									     (select rnkp, count(*) KOLK from customer where rnkp is not null group by rnkp having count(*) >1 ) k,
									  (select u.rnk, a.acc, a.nls, a.ostc/100 OSTC, a.ostb/100 OSTB           
									   from  accounts a, cust_acc u where u.acc=a.acc and a.nls  like '8026_'||u.rnk and a.kv =:n980 ) a
									  WHERE c.rnk=k.rnkp  and c.rnk=a.rnk (+) " ||
									 IifS (sFilter = "", ""," and "|| sFilter ) || " ORDER BY c.rnk"
							                                                 Call SalTblPopulate( tbl, hSql(), sSql1, TBL_FillAll )
							                                                 Call SalTblReset( tbl2 )
					                                                 Function: OP_1
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
							                                                 Number: nRet
							                                                 String: sNls
						                                                 Actions 
							                                                 Set sNls = KeyAccount( sBankMfo, '80260'||Str(tbl.RNKP) )
							                                                 If Op_Reg(99,0,0,0,nRet, tbl.RNKP, sNls, n980, tbl.NMKP, 'ODB', nId, tbl.ACC8 )
								                                                 Set tbl.NLSP = sNls
								                                                 Call SqlCommitEx( hSql(),"Открыт "||sNls )
								                                                 Call OPEN_1()
								                                                 Call SalShowWindow( tbl2.OP )
								                                                 Call SalShowWindow( tbl2.LIM)
								                                                 Call XSalTblSetCellBackColor( RNKP, nCol1 ) 
								                                                 Call XSalTblSetCellBackColor( NMKP, nCol1 )
								                                                 Call XSalTblSetCellBackColor( KOLK, nCol1 )
								                                                 Call XSalTblSetCellBackColor( NLSP, nCol1 )
							                                                 Else 
								                                                 Call SqlRollback( hSql() )
					                                                 Function: OST_1
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
							! Number: nRet
							! String: sNls
						                                                 Actions 
							                                                 If SqlPrepareAndExecute( hSql(), 
									"UPDATE accounts set 
									  ostC = (select NVL(sum(gl.p_Icurval(kv,ostC,:bDat)),0) from accounts where accc=:ACC8),
									  ostB = (select NVL(sum(gl.p_Icurval(kv,ostB,:bDat)),0) from accounts where accc=:ACC8)
									 WHERE acc=:ACC8 " )
								                                                 Call SqlCommitEx( hSql(),"Уст.остатки на "|| NLSP )
								                                                 Call tbl2.NAS_2()
							                                                 Else 
								                                                 Call SqlRollback( hSql() )
					                                                 Function: OPEN_1
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
						                                                 Actions 
							                                                 If tbl.ACC8 = NUMBER_Null 
								                                                 Call SalEnableWindow( pbIns )
								                                                 Call SalDisableWindow( pbUpdate )
								                                                 Call SalDisableWindow( pb_Sum )
								                                                 Call SalHideWindow( tbl2.OP )
								                                                 Call SalHideWindow( tbl2.LIM )
							                                                 Else 
								                                                 Call SalDisableWindow( pbIns )
								                                                 Call SalEnableWindow( pbUpdate )
								                                                 Call SalEnableWindow( pb_Sum )
								                                                 Call SalShowWindow( tbl2.OP )
								                                                 Call SalShowWindow( tbl2.LIM)
				                                                 Window Variables 
				                                                 Message Actions 
					                                                 On SAM_DoubleClick
						                                                 Call tbl2.NAS_2()
					                                                 On SAM_TblDoDetails
						                                                 Call SalTblReset( tbl2 )
						                                                 Set tbl.KOL = 0
						                                                 Set PR_A = NUMBER_Null
						                                                 Set PR_P = NUMBER_Null
						!
						                                                 Call OPEN_1()
					                                                 On SAM_FetchRowDone
						                                                 If NLSP != STRING_Null
							                                                 Call XSalTblSetCellBackColor( RNKP, nCol1 ) 
							                                                 Call XSalTblSetCellBackColor( NMKP, nCol1 )
							                                                 Call XSalTblSetCellBackColor( KOLK, nCol1 )
							                                                 Call XSalTblSetCellBackColor( NLSP, nCol1 )
						!
			                                                 Child Table: tbl2 ! Дочерние предприятия
				                                                 Contents 
					!
					                                                 Column: RNK
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: NMK
						                                                 List Values 
						                                                 Message Actions 
					!
					                                                 Column: KV
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: NLS
						                                                 List Values 
						                                                 Message Actions 
							                                                 On SAM_SetFocus
								                                                 Set NLS2 = NLS
							                                                 On SAM_KillFocus
								                                                 Set NLS = NLS2
					                                                 Column: LIM
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: OP
						                                                 List Values 
						                                                 Message Actions 
							! On SAM_AnyEdit
								                                                                                                                       Call OP_2()
					                                                 Column: DOS2
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: KOS2
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: OSTC2
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: OSTB2
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: IR_A
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: IR_P
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: NP_A
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: NP_P
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: ACCC
						                                                 List Values 
						                                                 Message Actions 
					                                                 Column: ACC
						                                                 List Values 
						                                                 Message Actions 
				                                                 Functions 
					                                                 Function: NAS_2
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
						                                                 Actions 
							                                                 Call SalTblSetTableFlags ( tbl2, TBL_Flag_SingleSelection, TRUE )
							                                                 Set sSql2=
									"SELECT c.RNK, c.NMK, a.acc, a.accc, a.kv, a.nls, a.lim/100, a.ostC/100, a.ostB/100,
									  decode(a.dapp, BANKDATE_G, a.dos,0)/100, decode(a.dapp, BANKDATE_G, a.kos,0)/100,
									  acrn.FPROCN(a.acc,0,:bDat), acrn.FPROCN(a.acc,1,:bDat)
									 INTO :tbl2.RNK,  :tbl2.NMK,  :tbl2.ACC,
									      :tbl2.ACCC, :tbl2.KV,   :tbl2.NLS, :tbl2.LIM , 
									      :tbl2.OSTC2,:tbl2.OSTB2,:tbl2.DOS2,:tbl2.KOS2, 
									      :tbl2.IR_A, :tbl2.IR_P 
									  FROM customer c, accounts a, cust_acc u 
									  where c.rnkp=:tbl.RNKP and c.rnk=u.rnk and u.acc=a.acc 
									     and a.nls like '2600%'||u.rnk and a.dazs is null 
									     and a.acc not in (select acc from ACC_OVER )   
									 ORDER BY c.rnk"
							                                                 Set tbl.KOL  = 0
							                                                 Set tbl.DOS  = 0
							                                                 Set tbl.KOS  = 0
							                                                 Set tbl.OSTC = 0
							                                                 Set tbl.OSTB = 0
							                                                 Call SalTblPopulate( tbl2, hSql(), sSql2 , TBL_FillAll )
							                                                 Call SalTblSetLockedColumns( tbl2, 2 )
					                                                 Function: OP_2
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
							                                                 String: sTmp
							                                                 String: sSql
							                                                 Number: nLim
						                                                 Actions 
							                                                 Set nRow = TBL_MinRow
							                                                 While SalTblFindNextRow( tbl2, nRow, ROW_Edited, 0)
								                                                 Call SalTblSetContext( tbl2, nRow)
								                                                 Set nLim = LIM * 100
								                                                 If OP = 1 and ( ACCC = NUMBER_Null  or ACCC = tbl.ACC8)
									                                                 Set sSql ="Update accounts set lim=:nLim, accc=:tbl.ACC8  where acc=:ACC"
								                                                 Else If OP = 0 and ACCC = tbl.ACC8 
									                                                 Set sSql ="Update accounts set lim=0, accc=null where acc=:ACC"
								                                                 Set sTmp = IifS (OP = 1, "Включить", "Исключить") ||" счет "||Str(KV)||'/'||NLS 
								                                                 If SqlPrepareAndExecute( hSql(), sSql )
									                                                 Call SqlCommitEx( hSql(),sTmp  )
									                                                 Set ACCC = IifN ( OP = 1, tbl.ACC8, NUMBER_Null)
								                                                 Else 
									                                                 Call SqlRollback( hSql() )
							                                                 Call NAS_2()
					                                                 Function: PR_2
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
							                                                 Number: nTmp_0
							                                                 Number: nTmp_1
						                                                 Actions 
							                                                 Set PR_A = 0
							                                                 Set PR_P = 0
							                                                 Set nRow = TBL_MinRow
							                                                 While SalTblFindNextRow( tbl2, nRow,  0, 0 )
								                                                 Call SalTblSetContext( tbl2, nRow)
								                                                 If (cb2 and OP = 1 and ACCC = tbl.ACC8)  or (not cb2)
									                                                 Set NP_A = - p_intN( ACC, 0, DAT1, DAT2, NUMBER_Null, 0)
									                                                 Set NP_P = p_intN( ACC, 1, DAT1, DAT2, NUMBER_Null, 0)
									                                                 If KV = n980
										                                                 Set nTmp_0 = NP_A
										                                                 Set nTmp_1 = NP_P
									                                                 Else 
										                                                 If SqlPrepareAndExecute( hSql(),
												"select gl.p_Icurval(:KV,:NP_A,:bDat), gl.p_Icurval(:KV,:NP_P,:bDat) 
												 into :nTmp_0, :nTmp_1 from dual" )
												and SqlFetchNext(hSql(), nFetchRes)
									                                                 If nTmp_0 != 0
										                                                 Set PR_A = PR_A + nTmp_0 /100
										                                                 Set NP_A = NP_A /100
										                                                 Call SalTblSetCellTextColor(NP_A, COLOR_Red,FALSE )
									                                                 Else 
										                                                 Set NP_A = NUMBER_Null
									                                                 If nTmp_1 != 0
										                                                 Set PR_P = PR_P + nTmp_1 /100
										                                                 Set NP_P = NP_P /100
										                                                 Call SalTblSetCellTextColor(NP_P, COLOR_DarkBlue,FALSE )
									                                                 Else 
										                                                 Set NP_P = NUMBER_Null
									!
				                                                 Window Variables 
					                                                 String: NLS2
					! String: sProcText
				                                                 Message Actions 
					                                                 On SAM_FetchRowDone
						                                                 If tbl.ACC8 != NUMBER_Null and ACCC !=NUMBER_Null and ACCC = tbl.ACC8  
							                                                 Call XSalTblSetCellBackColor( KV,  nCol2 )
							                                                 Call XSalTblSetCellBackColor( NLS, nCol2 ) 
							                                                 Set tbl.KOL = tbl.KOL + 1
							                                                 Set tbl.DOS = tbl.DOS + DOS2
							                                                 Set tbl.DOS = tbl.DOS + KOS2
							                                                 Set tbl.OSTC = tbl.OSTC + OSTC2
							                                                 Set tbl.OSTB = tbl.OSTB + OSTB2
							! Call XSalTblSetCellBackColor( DOS, nCol2 )
							! Call XSalTblSetCellBackColor( KOS, nCol2 )
							! Call XSalTblSetCellBackColor( OSTC,nCol2 ) 
							! Call XSalTblSetCellBackColor( OSTB,nCol2 )
							                                                 Set OP= 1
						                                                 Else 
							                                                 Set OP= 0
					                                                 On SAM_DoubleClick
						                                                 Call SetProcParN(tbl2.ACC, tbl2.KV, "", "" )
		                                                 Functions 
		                                                 Window Parameters 
			                                                 Number: nPar1
			                                                 Number: nPar2
			                                                 String: strPar01
			                                                 String: strPar02
		                                                 Window Variables 
			                                                 Number: nId
			                                                 Number: nCol1
			                                                 Number: nCol2
			                                                 Number: n980
			                                                 Date/Time: bDat
			! Number: nMax
			                                                 Number: nRow
			                                                 String: NLS_B1
			                                                 String: sSql1
			                                                 String: sSql2 
			                                                 String: sBankMfo 
			                                                 String: sFilter
			                                                 : cF
		                                                 Message Actions 
			                                                 On SAM_Create
				!
				                                                 Set XL1.nTabInstance1 = 1
				                                                 Set XL1.nTabInstance2 = 1
				                                                 Set XL1.strFilterTblName = 'CUSTOMER'
				! Set XL1.fFilterAtStart = FALSE
				                                                 Set n980 = GetBaseVal()
				                                                 Set bDat = GetBankDate()
				                                                 Set sBankMfo = GetBankMfo()
				                                                 Set nId = GetUserId()
				                                                 Set DAT2 = bDat
				                                                 Set DAT1 = AddMonths( DAT2, -1 )
				! Set nMax = 100000000000
				                                                 Set nCol1= SalColorFromRGB( 220,255,255 )
				                                                 Set nCol2= SalColorFromRGB( 230,255,230 )
				                                                 Call PrepareWindowEx( hWndForm )
				                                                 Call SetWindowFullSize( hWndForm )
				                                                 Call SalSendClassMessage( SAM_Create, 0, 0 )
				                                                 Call tbl.NAS_1( )
	Form Window: FA7
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Контроль погашения инвойсов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    0.177"
				Width:  16.2"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.56"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Изъять Документ из картотеки'
						On SAM_Click
							If SalMessageBox(
									"ВЫ действительно желаете изъять 
									из Контрольной таблицы документ с Ref="||Str(tbl.REF) ||' ? ',
									" Внимание ! Подлежит ручной обработке ! ",
									MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(),
										"DELETE from FAK_REF where ref1=:tbl.REF " )
									Call SqlCommitEx( hSql(),"Изъят документ Ref="||Str(tbl.REF) )
									Call SalTblDeleteRow( tbl, SalTblQueryContext(tbl), TBL_Adjust )
									Call SalTblReset( tbl2 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитать нераспределенные документы-поступления'
						On SAM_Click
							Call tbl.NAS_DOK( )
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Сохранить подобранные Инвойсы'
				Line
					Resource Id: 55367
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  6.783"
						Begin Y:  Class Default
						End X:  6.783"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установить фильтр на документы (верхняя таблица)'
						On SAM_Click
							Set sFilter = ""
							If NOT SetQueryFilter( cF )
								Call SalDestroyWindow( hWndForm )
							Set sFilter = cF.GetFilterWhereClause( FALSE )
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть детально выбранный документ'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Call DocViewContentsEx( hWndMDI,tbl.REF )
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.933"
						Top:    0.143"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55368
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.733"
						Begin Y:  Class Default
						End X:  3.733"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55369
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  4.617"
						Begin Y:  0.44"
						End X:  4.617"
						End Y:  0.024"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				! ctb_pbGetValue: pb_SG
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.583"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\SORT.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Light Green
.end
					                                                                    Message Actions 
						                                                                    On SAM_Create
							                                                                    Set strTip = 'Погасить все привязанные платежи '
							                                                                    Call SalDisableWindow( pb_SG )
						                                                                    On SAM_Click
							                                                                    Call SalWaitCursor(TRUE)
							                                                                    If SqlPLSQLCommand( hSql(), "FAKTOR.ASG_K(0)" )
								                                                                    Call SqlCommit( hSql())
								                                                                    Call SalWaitCursor(FALSE)
								                                                                    Call MessageNoWait('Погашены связанные инвойсы','Сообщение',3,0)
							                                                                    Else 
								                                                                    Call SqlRollback(hSql())
								                                                                    Call SalWaitCursor(FALSE)
								                                                                    Call MessageNoWait('Неуспешный Разбор', 'Ошибка', 0, 1)
				! ctb_pbGetValue: pb_REGR
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.083"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOL.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Light Green
.end
					                                                                    Message Actions 
						                                                                    On SAM_Create
							                                                                    Set strTip = 'Выставить регресы по просроченным инвойсам'
							                                                                    Call SalDisableWindow( pb_REGR )
						                                                                    On SAM_Click
							                                                                    Call SalWaitCursor(TRUE)
							                                                                    If SqlPLSQLCommand( hSql(), "FAKTOR.REGR_K(0)" )
								                                                                    Call SqlCommit( hSql())
								                                                                    Call SalWaitCursor(FALSE)
								                                                                    Call MessageNoWait('Регрессы выставлены','Сообщение',3,0)
							                                                                    Else 
								                                                                    Call SqlRollback(hSql())
								                                                                    Call SalWaitCursor(FALSE)
								                                                                    Call MessageNoWait('Неуспешное выставление регресса', 'Ошибка', 0, 1)
				!
				Pushbutton: pb_F1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Все Инвойсы по ОКПО-А 
									/ плательщика из документа (по Дебитору)'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Call NAS_2( 1 )
				Pushbutton: pb_F2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Все Инвойсы по счету-Б 
									/получалеля из документа (по Клиенту)'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Call NAS_2( 2 )
				Data Field: rOPL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.383"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Учтенная сумма к оплате')
				Data Field: sOPL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.583"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Свободная сумма к оплате')
				Data Field: NLS_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.183"
							Top:    0.155"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет оплаты 3739* ')
				Data Field: OST_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'План-остаток на 3739* ')
				Data Field: KOL_I
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.155"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество незакрытых инвойсов')
				Data Field: NOM_I
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.883"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Непогашенная сумма номинала инвойсов')
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.333"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl ! Поступления на счета гаш
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.817"
						Width Editable? Class Default
						Height: 2.333"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					!
					Column: REF
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф-1
								док
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО-А
								из док
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								плат.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  0.983"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAM_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Плательщик
								из документа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Нач.Сумма
								платежа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.583"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Свободная
								Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.583"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OPL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: OK
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Set nOPL = OPL
							On SAM_AnyEdit
								If OPL = 1 and tbl.KOL > 0 and rOPL > 0 
									If F_OPL()
										Call SqlCommitEx( hSql(),"Привязка док ref="||Str(tbl.REF)||" к инвойсам" )
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Set OPL = 0
										Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
								Else
									Set OPL = 0
					Column: NAZN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назначение
								платежа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.75"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО-Б
								из док
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.933"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAM_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Получатель
								из документа
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сч-Б
								из док
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OST_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пл.Ост
								Сч-Б
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.05"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во
								инв
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: RNK_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: RNK
								Кл
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наим Кл
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  2.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: CC_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ид
								 ФД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.75"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ND
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф 
								ФД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: NAS_DOK
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblSetTableFlags ( tbl, TBL_Flag_SingleSelection, TRUE )
							Call SalTblSetLockedColumns( tbl, 6 )
							Set sSql=
									"SELECT r.ref1, OPER.vdat, OPER.s/100, (OPER.S - nvl(r.S,0))/100, 
									       OPER.nazn, OPER.nam_a, OPER.id_a, 
									       OPER.id_b, OPER.nam_b, OPER.nlsb,
									       ck.rnk, ck.nmk, d.nd, d.cc_id, ak.acc, ak.ostb/100 
									 INTO :tbl.REF,  :tbl.VDAT, :tbl.S1, :tbl.S,   :tbl.NAZN, :tbl.NAM_A, 
									      :tbl.ID_A, :tbl.ID_B, :tbl.NAM_B,:tbl.NLS_B,
									      :tbl.RNK_K,:tbl.NMK_K,:tbl.ND,:tbl.CC_ID,:tbl.ACC, :tbl.OST_B
									 FROM FAK_ref r, OPER, customer ck, accounts ak, cust_acc uk,  cc_deal d, nd_acc n 
									 WHERE OPER.ref=r.ref1 AND OPER.sos=5 
									   AND Nvl(r.s,0) < OPER.S  AND r.ref2 IS NULL 
									   AND ak.nls=OPER.NLSB and ak.kv=:n980 
									   and ak.acc=uk.acc and uk.rnk=ck.rnk 
									   and n.acc=ak.acc and n.nd=d.nd " ||
									 IifS (nPar2 = 0 , ""," and d.ND=:nPar2" ) ||
									 IifS (sFilter = "", ""," and "|| sFilter ) || "
									 ORDER BY OPER.id_a, OPER.vdat, r.ref1"
							Call SalTblPopulate( tbl, hSql(), sSql, TBL_FillAll )
							Call SalTblReset( tbl2 )
				Window Variables
				Message Actions
					On SAM_DoubleClick
						Call NAS_2( 1 )
					On SAM_TblDoDetails
						! Call SalTblReset( tbl2 )
						! Set tbl.KOL=0
						! Set sOPL = tbl.S 
						! Set NLS_3739 = tbl.NLS_B
						! Set OST_3739 = tbl.OST_B
						Call NAS_2( 1 )
					On SAM_FetchRowDone
						! If NMK_D = STRING_Null
							                                                                                          Call XSalTblSetCellBackColor( ID_A, SalColorFromRGB(255,210,250 ) )
							                                                                                          Call XSalTblSetCellBackColor( NMK_D, SalColorFromRGB(255,210,250 ) )
							                                                                                          Call XSalTblSetCellBackColor( NAM_A, SalColorFromRGB(255,210,250 ) )
						Call XSalTblSetCellBackColor( S, SalColorFromRGB( 230,255,230 ) )
						!
			Child Table: tbl2 ! Инвойсы, пожходящие под поступления
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.405"
						Width:  14.817"
						Width Editable? Class Default
						Height: 2.155"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					!
					Column: IDK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Конт
								ракт
								
						Visible? Yes
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NI
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф
								инвойса
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NDOC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: №
								инвойса
						Visible? Yes
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DDOC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								инв.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SDOC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								НОМИНАЛА
								инвойса
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.517"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: К оплате
								инвойса
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If tbl2.SR = NUMBER_Null
									Set tbl2.SR = SalNumberMin( tbl2.NNOM, sOPL ) 
									! Set tbl2.SR = SalNumberMin( tbl2.NNOM, rOPL ) 
									! Set tbl2.SR = SalNumberMin( tbl2.NNOM, tbl.S  ) 
									Call SalTblSetRowFlags( tbl2, SalTblQueryContext(tbl2), ROW_Edited, TRUE )
									Call SalSendMsg( tbl2.SR, SAM_Validate, 0, 0 )
							On SAM_Validate
								Call f_Tochka ( SR )
								If tbl2.SR < 0 or tbl2.SR > tbl.S ! Явная ошибка суммы
									Call SalMessageBox("Ош.Сумма ! ", "Внимание ! ", MB_IconStop)
									Set tbl2.SR = SalNumberMin( tbl2.NNOM, tbl.S  ) 
									Return VALIDATE_Cancel
								Else If tbl2.SR > tbl2.NNOM and tbl2.SR <= tbl.S ! Переплата по согласованию
									! If SalMessageBox('
											Введенная сумма к ОПЛАТЕ ('|| SalNumberToStrX(tbl2.SR,2)||' )
											БОЛЬШЕ непогашенной суммы НОМИНАЛА ('||SalNumberToStrX(tbl2.NNOM ,2) ||') 
											Принять к ОПЛАТЕ ?' , 
											'Внимание! ',
											MB_IconQuestion | MB_YesNo) != IDYES
										                                                                 Set tbl2.SR = SR2
										                                                                 Return VALIDATE_Cancel
									Call SalMessageBox
											('Введенная сумма к ОПЛАТЕ ('|| SalNumberToStrX(tbl2.SR,2)||' )
											БОЛЬШЕ непогашенной суммы НОМИНАЛА ('||SalNumberToStrX(tbl2.NNOM ,2) ||') ! ',
											 "Внимание ! ", MB_IconStop)
									Set tbl2.SR = SalNumberMin( tbl2.NNOM, tbl.S  ) 
									Return VALIDATE_Cancel
								Set rOPL = SalTblColumnSum( tbl2, SalTblQueryColumnID(tbl2.SR ), ROW_Edited, 0 )
								Set sOPL = tbl.S - rOPL
								Return VALIDATE_Ok
					Column: DOPL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План-
								Дата
								опл.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.283"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NNOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Не 
								погашено
								НОМИНАЛА
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					!
					Column: SAVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт.
								сумма
								аванса
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.45"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт
								Дата
								Аванса
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.117"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PAVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Погашено
								аванса 
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.433"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DPAVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.3"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAVA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: НЕ
								погашено
								АВАНСА
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								сост
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактический 
								Дебитор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  2.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Состояние
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OKPO_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО 
								Деб
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: NK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф
								контр
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						If SOS = 9 !! Погашен частично Деб   СЛАБО-СЕРЫЙ
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 239,247,247) )
						Else If SOS = 10 !! Погашен Дебитором СЕРЫЙ
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
						Else If SOS = 11 !! Выставлен регресс Кл СЛАБО-КРАСНЫЙ
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ))
						If DOPL = bDat
							Call XSalTblSetCellBackColor( DOPL, SalColorFromRGB( 230,255,230 ) )
						Else If DOPL < bDat
							Call XSalTblSetCellBackColor( DOPL, COLOR_Green )
						! Set NAVA = SDOC - PAVA
						Set tbl.KOL = tbl.KOL + 1
						Set NAVA = SAVA - PAVA
						Set NOM_I = NOM_I + NAVA
						! Call XSalTblSetCellBackColor( SR, SalColorFromRGB( 230,255,230 ) )
						Call XSalTblSetCellBackColor( SR, COLOR_LightGreen )
						! If tbl.NI = tbl2.NI 
							                                                                                                 Set tbl2.SR =tbl.S
							                                                                                                 Call SalTblSetRowFlags( tbl2, SalTblQueryContext(tbl2), ROW_Edited,  TRUE )
						! If tbl.RNK_D>0
							                                                                                                                                Set tbl2.OKPO_D = tbl.ID_A
							                                                                                                                                Set tbl2.NMK_D = tbl.NMK_D
						If tbl2.OKPO_D != tbl.ID_A
							Call XSalTblSetCellBackColor( OKPO_D, SalColorFromRGB(255,210,250 ) )
							Call XSalTblSetCellBackColor( NMK_D, SalColorFromRGB(255,210,250 ) )
		Functions
			Function: NAS_2
				Description:
				Returns
				Parameters
					Number: nF
				Static Variables
				Local variables
				Actions
					Call SalTblReset( tbl2 )
					Set tbl.KOL=0
					Set sOPL = tbl.S 
					Set NLS_3739 = tbl.NLS_B
					Set OST_3739 = tbl.OST_B
					! Залочить реф 
					! If SqlPrepareAndExecute( hSql(),
							  "select ref2 from FAK_REF 
							   where ref1=:tbl.REF  AND ref2 IS NULL 
							   FOR UPDATE OF ref2 NOWAIT ") 
							and NOT SqlFetchNext( hSql(), nFetchRes) 
						                                                          Call SqlRollback(  hSql() )
						                                                          Return FALSE
					!
					Call SalTblSetTableFlags ( tbl2, TBL_Flag_SingleSelection, TRUE )
					Set tbl.KOL=0
					Set NOM_I = 0
					Set rOPL = 0 
					! Set sOPL = 0 
					Call SalTblPopulate( 
							tbl2,
							hSql(), 
							sSql20 || IifS( nF = 1, " and c.okpo=:tbl.ID_A ", "") || " ORDER BY (i.DDOC+t.SROK) ",
							TBL_FillAll )
					Set KOL_I = tbl.KOL
					Call SalTblSetLockedColumns( tbl2, 5 )
			Function: F_OPL
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nSR2
					Number: nS
					Number: nKolI
					Number: nT2
				Actions
					Call SalWaitCursor(TRUE)
					Set nT2 = SalTblColumnSum( tbl2, SalTblQueryColumnID(tbl2.SR ), ROW_Edited, 0 )
					If nT2  > tbl.S
						Call SalMessageBox(
								"ПРЕВЫШЕНИЕ частных сумм нижней табл = " || SalNumberToStrX( nT2, 2 ) || " 
								 СВОБОДНОЙ суммы док-та верхней табл = " || SalNumberToStrX(tbl.S, 2 ) ,
								"Ошибка ! ", 
								MB_IconStop)
						Return FALSE
					! If SalTblColumnSum( tbl2, nT2 , ROW_Edited, 0 ) > tbl.S
						                                                    Call SalMessageBox("ПРЕВЫШЕНИЕ частных сумм  СВОБОДНОЙ суммы документа ! ",
								"Ошибка ! ", MB_IconStop)
						                                                    Return FALSE
					!
					Set nRow = TBL_MinRow
					Set nS = 0 
					Set nKolI = 0
					While SalTblFindNextRow( tbl2, nRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl2, nRow)
						If tbl2.SR > 0
							Set nSR2 = tbl2.SR*100 
							Set nS = nS + nSR2
							If NOT ASG_K ( )
								Return FALSE
							Set nKolI = nKolI + 1 
							! If SqlPLSQLCommand( hSql(),"FAKTOR.REF_NI( tbl.REF, tbl2.NI, nSR2, tbl.ACC )" )
								                                                                                          Set nS = nS + nSR2
								!
								                                                                                          If NOT ASG_K ( )
									                                                                                          Return FALSE
								                                                                                          Set nKolI = nKolI + 1 
							! Else
								                                                                                          Return FALSE
					If nKolI > 0
						Call SalTblDeleteRow( tbl, SalTblQueryContext(tbl), TBL_Adjust )
						Call SalTblReset( tbl2 )
					Return TRUE
			Function: ASG_K
				Description:
				Returns
					Boolean:
				Parameters
					! Number: nNI
				Static Variables
				Local variables
					Number: nSOS
					Number: ND_ ! Реф дог
					Number: RNK_D_ ! РНК Дебитора
					Number: nS
					Number: bR !  регрес без текущего инвойса
					Number: nSKOM
					String: OKPO_K ! клиента
					Number: SA_ ! сумма погашения аванса в коп
					Number: SN_ ! Расчетная сумма погашения нач процентов в коп
					Number: SB_ ! Сумма комиссии банку
					Number: SO_ ! Общая сумма погашения
					Number: SK_ ! Переслать клиенту
					Number: SI_ ! Погашено всего номинала инвойса
					!
					Number: IR_2030 ! Год % ставка за аванс
					String: NLS_2030 ! сч 2030
					String: NMS_2030 ! и его наименование
					String: NLS_2038 ! сч 2038
					String: NLS_9129 ! сч 9129
					!
					String: NAZN_ ! назнач пл
					Number: REF_ 
					Number: nTmp 
					Number: SOS_ 
					String: NLS_2600 
					String: MFO_2600
					String: TT_
					Number: nSROK0
				Actions
					If SqlPrepareAndExecute( hSqlAux2(),
							"SELECT  nvl(i.SKOM,0), ck.okpo, i.SOS  INTO :nSKOM, :OKPO_K, :nSOS
							 FROM FAK_INVOICE i, customer ck  WHERE i.NI =:tbl2.NI and ck.rnk=:tbl.RNK_K")
							AND SqlFetchNext( hSqlAux2(), nFetchRes) 
						!
						If SqlPrepareAndExecute( hSql(),
								  "SELECT acrn.FPROCN(a.acc,0,:bDat),          
								         Substr(FAKTOR.NLS( o.ND, :tbl.RNK_K, '2600'),1,15),
								         a.nls, substr(a.nms,1,38),
								         Substr(FAKTOR.NLS(o.ND,o.RNKD,'2038'),1,15),
								         Substr(FAKTOR.NLS(o.ND,o.RNKD,'9129'),1,15),
								         o.ND, o.RNKD, nvl(o.SROK0,0)
								   INTO :IR_2030,:NLS_2600,:NLS_2030,:NMS_2030,:NLS_2038,:NLS_9129,:ND_,:RNK_D_,:nSROK0
								   FROM FAK_KONTR o, nd_acc n, accounts a, cust_acc u
								   WHERE o.nk=:tbl2.NK and o.nd=n.nd and n.acc=a.acc and a.tip='SS ' 
								     and a.acc=u.acc and u.rnk=o.RNKD") 
								AND NOT SqlFetchNext( hSql(), nFetchRes) 
							Return FALSE
						!
						If NLS_2600 = STRING_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT MFO, NLS INTO :MFO_2600, :NLS_2600 
									 from CORPS_ACC where rnk=:tbl.RNK_K and NLS like '26%' and kv=:n980" )
									and SqlFetchNext(hSql(), nFetchRes)
							Set TT_ = 'KK2'
						Else
							Set MFO_2600 = aMfo
							Set TT_ = 'KK1'
						If MFO_2600 = STRING_Null OR NLS_2600 = STRING_Null 
							Return FALSE
						! Есть ли сумма регресса 
								 по Этому ФД(клиенту) и Этому дебитору, по этому или по другим контрактам 
								(без текущего инвойса)
						If SqlPrepareAndExecute( hSql(),
								"Select 1 into :bR  from FAK_INVOICE i, FAK_KONTR o 
								 where o.RNKD = :RNK_D_ and i.nk=o.nk and o.nd=:ND_ and i.NI <> :tbl2.NI and i.sos=11 ") 
								AND NOT SqlFetchNext( hSql(), nFetchRes) 
							Set bR = 0
						!
						If nSOS = 11 
							If SqlPrepareAndExecute( hSql(),
									  "SELECT acrn.FPROCN(acc,0,:bDat), nls, substr(nms,1,38),
									         Substr(FAKTOR.NLS(:ND_,:tbl.RNK_K,:NBS_SPN),1,15)         
									   INTO :IR_2030, :NLS_2030,:NMS_2030, :NLS_2038       
									   FROM  accounts 
									   WHERE nls=Substr(FAKTOR.NLS(:ND_,:tbl.RNK_K,:NBS_SP),1,15)") 
									AND NOT SqlFetchNext( hSql(), nFetchRes) 
								Return FALSE
						!
						Set nS = tbl2.SR*100  ! Выделенная сумма для погашения долгов по инвойсу
						! Call Debug('1/ nS='||Str(nS) ) 
						Set SA_ = tbl2.NAVA *100 !  -- НЕ погашенная Сумма аванса  
						! Call Debug('2/ SA_='||Str(SA_) ) 
						Set SN_ = SalNumberRound( SA_* IR_2030 * ( bDat - tbl2.DAVA ) / 36500 ) ! -- Сумма % в коп
						! Call Debug('3/ SN_='||Str(SN_) ) 
						Set SB_ = 0
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT F_TARIF(t.kod,:n980,:tbl.NLS_B,:SA_ ) INTO :SB_
								   FROM FAK_PARAM p, tarif t
								   WHERE p.par='KOM_AVA' and to_char(t.kod)=p.val ")
								AND SqlFetchNext( hSql(), nFetchRes )  
						If KOM_AVA2 = '1'  ! --комиссия за аванс сверх ожмдания
							If nSROK0 >0 and SB_ > 0 
								Set nSROK0 = bDat - (tbl2.DDOC+nSROK0 )
							Set SB_ = IifN( nSROK0 > 0, SB_*nSROK0, 0)
						Set REF_ = NUMBER_Null
						Set NAZN_ ='Погашення '|| IifS(nSOS = 11 , 'регресованої ','')
								||'заборгованностi по ФД ' || tbl.CC_ID ||
								  ', iнвойс № '||tbl2.NDOC||' вiд '|| SalFmtFormatDateTime( tbl2.DDOC, 'dd/MM/yyyy' )
						! Долг перед банком (SO_)
						Set SO_ = SA_ + SN_ + SB_ !  -- Общая Расчетная : аванс + % + комис    
						! Call Debug('4/ SO_='||Str(SO_) ) 
						!
						If SO_ > 0 !  Есть долг  перед банком
							! Сумма долгов БОЛЬШЕ, чем Выделенная сумма для погашения долгов, 
									! ПереДелим ее в удельном весе
							If SO_ > nS  
								Set SN_ = SalNumberRound( nS * (SN_/SO_) )
								! Call Debug('5/ SN_='||Str(SN_) ) 
								Set SB_ = SalNumberRound( nS * (SB_/SO_) )
								! Call Debug('6/ SB_='||Str(SB_) ) 
								Set SA_ = nS -  SN_ - SB_
								! Call Debug('7/ SA_='||Str(SA_) ) 
								Set SK_ = 0
							Else
								! Если есть регресс то клиенту номинал не отдавать, а менять nS
								If bR = 1
									Set nS = SO_
								Set SK_ = nS - SO_
							Call cDoc.SetDoc
									(REF_, 'ASG', 1, 6, STRING_Null, bDat, SalDateCurrent(), bDat, bDat ,
									 tbl.NLS_B, tbl.NAM_A, aMfo, '', n980, SA_, OKPO_K,
									 NLS_2030,   NMS_2030, aMfo, '', n980, SA_, GetBankOkpoS(),  
									 NAZN_, '', GetIdOper(), '', NUMBER_Null, 0)  
							! погашення боргу авансу та вiдновлення лiмiту авансу
							If NOT cDoc.oDoc() 
									OR NOT cDoc.PayTT(0,cDoc.m_nRef,bDat,'CR9',0,n980,s9900,SA_,n980,NLS_9129,SA_)
									OR NOT SqlPrepareAndExecute( hSql(),
									"INSERT into fak_POG(NI,fdat,ref,sn,sa,SP,SB) values
									 (:tbl2.NI, :bDat, :cDoc.m_nRef,:nS,:SA_,:SN_,:SB_)")
								Return FALSE
							Set REF_ = cDoc.m_nRef
							! погашення боргу по %%
							If SN_ > 0 AND  
									NOT cDoc.PayTT(0,cDoc.m_nRef,bDat,'ASG',1,n980,tbl.NLS_B,SN_,n980,NLS_2038,SN_)
								Return FALSE
							! погаш комиссии за аванс
							If SB_ > 0 AND  
									NOT cDoc.PayTT(0,cDoc.m_nRef,bDat,'ASG',1,n980,tbl.NLS_B,SB_,n980,SD6023_,SB_)
								Return FALSE
							! что-то осталось и клиенту, это надо делать отдельным REF
							If NOT ASG_KK (SK_,TT_,MFO_2600,OKPO_K,NLS_2600,NAZN_,REF_)
								Return FALSE
							!
						Else ! Есть долг только перед клиентом
							Set SN_ =0
							Set SB_ = 0
							Set SA_ = 0
							Set SO_ =0
							Set SK_ = nS  - SO_ ! -- остаток клиенту
							If NOT ASG_KK (SK_,TT_,MFO_2600,OKPO_K,NLS_2600,NAZN_,REF_) 
									OR NOT SqlPrepareAndExecute( hSql(),"INSERT into fak_POG(NI,fdat,ref,sn,sa,SP,SB) values
									       (:tbl2.NI, :bDat, :REF_,:nS,:SA_,:SN_,:SB_)")
								Return FALSE
							Set SK_ = 0
						!
						! Всего погашено аванса
						Set SA_ = tbl2.PAVA *100 + SA_
						! Всего погашено номинала
						Set SI_=0
						If SqlPrepareAndExecute( hSql(),
								"select nvl(sum(sn),0) into :SI_ from fak_POG where ni=:tbl2.NI") 
								and SqlFetchNext( hSql(), nFetchRes )  
								and SI_ < tbl2.SDOC * 100 ! Номинал по Инвойсу частично погашен 
							Set SOS_ = IifN( nSOS = 11,11,9)
						Else ! Номинал по Инвойсу полностью погашен
							Set SOS_ =10
						! ----
						Set nSKOM = nSKOM + SB_
						If NOT SqlPrepareAndExecute( hSql(), 
								  "update FAK_INVOICE set PAVA=:SA_, DPAVA=:bDat, SKOM=:nSKOM, sos=:SOS_ where ni=:tbl2.NI")
								OR NOT SqlPrepareAndExecute( hSql(), 
								  "Update fak_REF set s = nvl(s,0) + :nS where ref1=:tbl.REF ")  
								OR NOT 
								  "Update fak_REF f set f.ref2=:REF_ 
								   where f.ref1=:tbl.REF and f.s =(select s from oper where ref=f.ref1)"        
							Return FALSE
						If SOS_ =10 ! Номинал по Инвойсу полностью погашен
							If CLS_98_ ='1' AND 
									NOT SqlPLSQLCommand( hSql(),"FAKTOR.INV_9800( tbl2.NI,1)"  ) 
								Return FALSE
						Return TRUE
					!
					Return FALSE
			Function: ASG_KK
				Description:
				Returns
					Boolean:
				Parameters
					Number: SK_
					String: TT_
					String: MFO_2600
					String: OKPO_K
					String: NLS_2600
					String: NAZN_
					Receive Number: REF_
					!
				Static Variables
				Local variables
					Number: SB2_
					Number: SK2_
					Number: SDOC_
				Actions
					If SK_ > 0 ! Остатки клиенту
						Set REF_ = NUMBER_Null
						Set SB2_ = 0 
						! Удержание комиссии за номинал, если в др.банке
						Set SDOC_ = tbl2.SDOC*100
						If aMfo != MFO_2600 
							If SqlPrepareAndExecute( hSql(), 
									   "SELECT Nvl(F_TARIF( to_number(val), :n980, :tbl.NLS_B, :SDOC_ ),0) 
									    INTO :SB2_ from FAK_PARAM 
									    where par='KOM_INV'" )  
									AND SqlFetchNext( hSql(), nFetchRes) 
						!
						Set SK2_ = SalNumberMax( SK_- SB2_, 0)
						If SK2_ > 0
							Call cDoc.SetDoc
									(REF_, TT_, 1, 6, STRING_Null, bDat, SalDateCurrent(), bDat, bDat ,
									 tbl.NLS_B, tbl.NAM_A, aMfo,     '', n980, SK2_, OKPO_K,
									 NLS_2600,  tbl.NMK_K, MFO_2600, '', n980, SK2_, OKPO_K, 
									 NAZN_, '', GetIdOper(), '', NUMBER_Null, 0)  
							If NOT cDoc.oDoc() 
								Return FALSE
							If SB2_ > 0 AND 
									NOT cDoc.PayTT(0,cDoc.m_nRef, bDat,'ASG',1,n980,tbl.NLS_B,SB2_,n980,SD6023_, SB2_) 
								Return FALSE
						Else
							Call cDoc.SetDoc
									(REF_, 'KKA', 1, 6, STRING_Null, bDat, SalDateCurrent(), bDat, bDat ,
									 tbl.NLS_B, tbl.NAM_A, aMfo, '', n980, SB2_, OKPO_K,
									 SD6023_,GetBankName(),aMfo, '', n980, SB2_, GetBankOkpoS(), 
									 NAZN_, '', GetIdOper(), '', NUMBER_Null, 0)  
							If NOT cDoc.oDoc() 
								Return FALSE
						Set REF_ = cDoc.m_nRef
					Return TRUE
					!
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: strPar01
			String: strPar02
		Window Variables
			Number: nOPL
			Number: nS2
			Number: SR2
			Number: n980
			Date/Time: bDat
			String: aMfo
			String: ID_A1
			String: NLS_B1
			String: sSql
			String: sSql2 
			String: sSql20 
			String: sFilter
			String: s9900 
			String: SD6023_ 
			String: CLS_98_
			: cF
				Class: cGenFilter
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set sSql20 =
						"SELECT t.IDK, i.NK,   i.NI,  i.NDOC, i.DDOC, i.SDOC/100, i.SAVA/100, i.DAVA,
						   i.PAVA/100, i.DPAVA,i.SOS,(i.DDOC+t.SROK), s.NAME, c.NMK,  c.okpo ,
						   (i.SDOC-nvl(g.sn,0) )/100 
						 INTO :tbl2.IDK, :tbl2.NK,  :tbl2.NI,   :tbl2.NDOC,:tbl2.DDOC,:tbl2.SDOC,:tbl2.SAVA, 
						      :tbl2.DAVA,:tbl2.PAVA,:tbl2.DPAVA,:tbl2.SOS, :tbl2.DOPL, 
						      :tbl2.SOS_NAME,     :tbl2.NMK_D,:tbl2.OKPO_D,:tbl2.NNOM 
						 FROM FAK_Invoice I, FAK_KONTR T, fak_sos s, customer c,
						   (select ni,sum(sn) SN from fak_pog group by ni) g
						 WHERE i.nk=t.NK and i.sos<15 and t.nd=:tbl.ND and t.rnkd=c.rnk 
						   and i.sos=s.sos and i.SDOC > nvl(i.PAVA,0) 
						   and i.SAVA is not null 
						   and i.ni=g.ni(+) "
				!
				Set FA7.nTabInstance1 = 1
				Set FA7.nTabInstance2 = 1
				Set FA7.strFilterTblName = 'OPER'
				! Set FA7.fFilterAtStart = FALSE
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set aMfo = GetBankMfo()
				If SqlPrepareAndExecute( hSql(),
						"SELECT t.nlsa, p1.val, p2.val 
						 INTO :s9900, :SD6023_, :CLS_98_ 
						 FROM fak_param p1, fak_param p2, tts t 
						 WHERE p1.par='SD6023' and t.tt='CR9' and p2.par='CLS_98' " )
						and SqlFetchNext(hSql(), nFetchRes)
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call tbl.NAS_DOK( )
	Form Window: frm_TA
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.025"
				Top:    0.052"
				Width:  16.717"
				Width Editable? Class Default
				Height: 6.976"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відмінити введену заявку'
						On SAM_Click
							If tbl.OP < 20
								!
								Set sTmp =  STRING_Null
								Call FunNSIGetFiltered( "FK_ERR", "TXT"," txt is not null " , sTmp, sErr )
								If sTmp !=  STRING_Null
									If SalMessageBox(" Відмінити введену ФК-заявку "|| Str(tbl.REFZ)||" ?", sErr || " !", MB_IconQuestion | MB_YesNo) = IDYES
										If SqlPrepareAndExecute( hSql(),
												   "update fk_zay set op=-op where ref=:tbl.REFZ and rnk=:tbl.RNK " )
												and SqlPrepareAndExecute( hSql(),
												   "insert into fk_ret (ref,serr, usid, DATR) values (:tbl.REFZ,:sErr,:UID,sysdate)" )
												and SqlCommitEx(  hSql(), "Відмінено ФК-заявку"||Str(frm_TA.tbl.REFZ))
											Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.617"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.45"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти відмітки про авторизацію '||sAvt
				Line
					Resource Id: 30128
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.067"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.967"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Line
					Resource Id: 30129
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  2.483"
						Begin Y:  0.464"
						End X:  2.483"
						End Y:  0.048"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30130
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  4.983"
						Begin Y:  0.44"
						End X:  4.983"
						End Y:  0.024"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pbSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SUMM.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Позиції клієнтів'
						On SAM_Click
							Call Sel020(hWndMDI, 3, 0, '','' )
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати пакет бухгалтерських операцій'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							!
							While SalTblFindNextRow( tbl, nRow, 0, 0 )
								Call SalTblSetContext( tbl, nRow )
								If nRow >=0 and SqlPLSQLCommand( hSqlAux(), "FK.BUCH_MOD (tbl.REFZ, tbl.REFO OUT int ) ")
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( 'Виконано пакет бухгалтерських операцій' ,'',2,0)
				! Line
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.583"
						Begin Y:  -0.06"
						End X:  2.583"
						End Y:  0.405"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
.end
				Pushbutton: pbExport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.15"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_M1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Вигрузити ТРЕЙДЕРУ авторизовані ОПЕРАЦІОНІСТОМ заявки'
						On SAM_Click
				Pushbutton: pbInport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Прийняти від ТРЕЙДЕРА виконані заявки'
						On SAM_Click
				!
				Data Field: nKolD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.65"
							Top:    0.119"
							Width:  0.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість угод')
				Data Field: nKolZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.483"
							Top:    0.119"
							Width:  0.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість Заявок')
				Data Field: nSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.65"
							Top:    0.119"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума на торгов.рахунках клієнтів')
				Data Field: nSumB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.65"
							Top:    0.119"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума на загальгному торгов.рахунку')
				Data Field: dNLS_FCHB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.65"
							Top:    0.119"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Загальний торговий рахунк банку')
		Contents
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  16.25"
						Width Editable? Class Default
						Height: 5.69"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Оп
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реєст.
								№ кл
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва кл
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_FCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Торговий
								рахунок
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт-зал.
								торг.рах
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PZTR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Розрах.
								сума зал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DEL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Надлишки +
								Недостача -
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: TRATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ціна
								трейдера
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								Set nOP = SalNumberMod( OP, 10 )
								If RATE != NUMBER_Null and TRATE != NUMBER_Null
									If (nOP < 3 and TRATE > RATE) or (nOP >=3 and TRATE < RATE )
										Call SalMessageBox("Порушено ціну клієнта !", "Помилка !", MB_IconStop)
										Set TRATE = NUMBER_Null
								!
								If TRATE = NUMBER_Null
									Set OTM = 0
					Column: TKOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: К-сть
								ФКт
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If TKOL > KOL or TKOL < MIN_KOL
									Call SalMessageBox("Порушено кількість клієнта !", "Помилка !", MB_IconStop)
									Set TKOL = NUMBER_Null
								If TKOL = NUMBER_Null
									Set OTM = 0
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Авто-
								ризація
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If OTM=1 and DEL <0
									Set OTM = 0
					!
					Column: REFZ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DATP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата, час
								заявки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.7"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: WDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Темін
								дії
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Специфікація
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: sOP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Операція
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: RATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ціна
								клієнта
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: К-сть
								ФКк
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: MIN_KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Min
								К-сть
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAKAZ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наказ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.983"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: sSOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фіксов.
								стан
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.983"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REFO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф
								опл
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nColID
							Window Handle: hWndCol
							Number: nNewRow
							String: strColTag
							String: strColVal
						Actions
							If not IsWindow(hTA2)
								Set hTA2 = SalCreateWindow( TA2, hWndForm )
							Call SalSetWindowText( TA2, frm_TA.tbl.NMK || ', реф.№' || Str(frm_TA.tbl.REFZ ))
							Call SalTblReset( TA2 )
							Set nColID = 3
							Loop
								Set hWndCol = SalTblGetColumnWindow ( frm_TA.tbl, nColID, COL_GetID )
								If hWndCol = hWndNULL
									Return TRUE
								! Заголовок колонки
								Call SalTblGetColumnTitle( hWndCol, strColTag, 100 )
								! Тип и значение в Str колонки
								Call SalTblGetColumnText( frm_TA.tbl, nColID, strColVal )
								!
								Set nNewRow = SalTblInsertRow(  TA2, TBL_MaxRow )
								Call SalTblSetContext(  TA2, nNewRow )
								Call SalTblSetRowFlags( TA2, nNewRow, ROW_New, FALSE )
								Set TA2.TAG = VisStrSubstitute( strColTag, PutCrLf(), ' ' )
								Set TA2.VAL = strColVal
								If frm_TA.tbl.sOP = 'Купівля'
									Call XSalTblSetRowBackColor( TA2, nNewRow, COLOR_Sky )
								Else
									Call XSalTblSetRowBackColor( TA2, nNewRow, SalColorFromRGB( 230,255,230 ) )
								Set nColID = nColID + 1
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						Set nOP = SalNumberMod( OP, 10 )
						Set nSOS = OP - nOP
						If nSOS = 0
							Set sSOS= 'Введено'
						Else If nSOS = 10
							Set sSOS= 'Операціоніст'
						Else If nSOS = 20
							Set sSOS= 'Трейдер'
						Else If nSOS = 30
							Set sSOS= 'Бухгалтер'
						Set OTM = 0
						If nOP < 3
							Set sOP = 'Купівля'
							Call XSalTblSetRowBackColor( frm_TA.tbl, lParam, COLOR_Sky )
						Else If nOP < 5
							Set sOP = 'Продаж'
							Call XSalTblSetRowBackColor( frm_TA.tbl, lParam, SalColorFromRGB( 230,255,230 ) )
						Set DEL = OSTC - PZTR
						If DEL < 0
							! недоплата - розовый
							Call XSalTblSetCellBackColor( DEL, SalColorFromRGB(255,210,250 ) )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set FK_ZAY =
								"(SELECT d.RNK,c.NMK,d.NLS_FCH,a.OSTC,a.ACC,z.REF,z.DATP,z.WDATE,
								         z.ID_INS, z.ID_SER, z.OP,z.RATE,z.KOL,z.MIN_KOL,z.TRATE, z.nakaz
								  FROM fk_zay z, customer c, fk_deal d, accounts a
								  WHERE c.rnk=d.rnk and d.rnk=z.rnk and d.NLS_FCH=a.nls and a.kv =:n980 and "||
								IifS( nPar >20, " op>0 and op<30 ",
								                " z.op>:nPar and z.op-10 <:nPar" ) || " ) FK_ZAY "
						Set sf=""
						Set sf = cF.GetFilterWhereClause( FALSE )
						Set frm_TA.strSqlPopulate =
								"SELECT RNK, NMK,NLS_FCH, OSTC/100,ACC, fk.PZTR(RNK),
								        REF,DATP,WDATE,ID_INS||'/'||ID_SER,OP,RATE,KOL,MIN_KOL,TRATE, nakaz
								 INTO  :tbl.RNK, :tbl.NMK, :tbl.NLS_FCH, :tbl.OSTC, :tbl.ACC, :tbl.PZTR,
								       :tbl.REFZ,:tbl.DATP,:tbl.WDATE  , :tbl.ID,    :tbl.OP, :tbl.RATE,
								       :tbl.KOL, :tbl.MIN_KOL,:tbl.TRATE,:tbl.NAKAZ
								 FROM  "||FK_ZAY|| IifS( sf="", "", " WHERE "||sf ) || " ORDER BY REF "
						!
						Call SalTblPopulate(frm_TA.tbl, hSql(), frm_TA.strSqlPopulate, TBL_FillAll)
						If not IsWindow(hTA2)
							Set hTA2 = SalCreateWindow( TA2, hWndForm )
						Else
							Call SalBringWindowToTop ( hTA2 )
						Call SalTblSetContext(frm_TA.tbl, 0)
						Call SalPostMsg(frm_TA.tbl, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
						!
					On SAM_TblDoDetails
						Call F1()
		Functions
		Window Parameters
			Number: nMode
			Number: nPar !!
					= 0 Операціоніст
					= 10 трейдер
					= 20 Бухгалтер
					= просмотр
					
			String: NLS_FCHB ! загальний торгов.рахунок
			String: strPar02
		Window Variables
			Number: nOP
			Number: nRow
			Number: nSOS
			Number: n980
			Number: UID
			String: sAvt
			String: sTmp
			String: sErr
			String: sErrP
			String: FK_ZAY
			String: sf
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set UID = GetUserId()
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set dNLS_FCHB = NLS_FCHB
				If SqlPrepareAndExecute( hSql(),
						  "SELECT ostc/100 INTO :nSumB from accounts where kv=:n980  and nls=:NLS_FCHB " )
						and not SqlFetchNext(hSql(), nFetchRes)
					Call SalWaitCursor(TRUE)
					Call SalMessageBox("В парметрах виклику не указано загальний торгов.рахунок ",
							"УВАГА ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				If SqlPrepareAndExecute( hSql(),
						  "SELECT NVL(count(*),0), NVL(sum(ostc)/100 ,0)
						   INTO :nKolD, :nSum FROM accounts WHERE kv=:n980  and tip='FCH' and dazs is null " )
						and SqlFetchNext(hSql(), nFetchRes)
				If SqlPrepareAndExecute( hSql(),
						  "SELECT NVL(count(*),0)  INTO :nKolZ FROM fk_zay
						   WHERE " || IifS( nPar >20, " op>0 and op<30 "," op>:nPar and op-10 <:nPar" ) )
						and SqlFetchNext(hSql(), nFetchRes)
				Set sAvt = IifS( nPar=0, "Операціоністом",
						           IifS( nPar=10,"трейдером",
						           IifS( nPar=20,"Бухгалтером","Перегляд стану заявок") )  )
				Set frm_TA.strSqlUpdate =
						"UPDATE fk_zay set op = op+ (10 * :frm_TA.tbl.OTM ), TRATE=:frm_TA.tbl.TRATE, TKOL=:frm_TA.tbl.TKOL where ref=:frm_TA.tbl.REFZ"
				Call SalSetWindowText( hWndForm, IifS (nPar<=20,"Авторизація заявок ","") || sAvt )
				Call SalTblSetLockedColumns( frm_TA.tbl, 12 )
				Set frm_TA.strFilterTblName = 'FK_ZAY'
				Set frm_TA.strPrintFileName = 'FKA_ZAY'
				If nPar =0 !! Операціоніст
					Call SalHideWindow( frm_TA.tbl.TRATE )
					Call SalHideWindow( frm_TA.tbl.TKOL )
					Call SalHideWindow( frm_TA.tbl.sSOS )
					Call SalHideWindow( frm_TA.tbl.REFO )
					!
					Call SalHideWindow( pbRun )
					Call SalHideWindow( pbExport )
					Call SalHideWindow( pbInport )
					Set frm_TA.nTabInstance = 4
				Else If nPar =10 !! трейдер
					Call SalEnableWindow( frm_TA.tbl.TRATE )
					Call SalHideWindow( frm_TA.tbl.sSOS )
					Call SalHideWindow( pbRun )
					Call SalHideWindow( frm_TA.tbl.REFO )
					Set frm_TA.nTabInstance = 2
				Else If nPar =20 !! Бухгалтер
					Call SalHideWindow( frm_TA.tbl.OTM )
					Call SalHideWindow( frm_TA.tbl.sSOS )
					Call SalHideWindow( pbUpdate )
					Call SalHideWindow( pbExport )
					Call SalHideWindow( pbInport )
					Call SalHideWindow( pbDel )
					Set frm_TA.nTabInstance = 3
				Else !! просмотр
					Call SalHideWindow( frm_TA.tbl.OTM )
					Call SalHideWindow( pbInport )
					Call SalHideWindow( pbRun )
					Call SalHideWindow( pbUpdate )
					Call SalHideWindow( pbExport )
					Set frm_TA.nTabInstance = 1
				!
				Call SalSendClassMessage(SAM_Create,0,0)
			On SAM_Destroy
				Call SalDestroyWindow(hTA2)
				Call SalSendClassMessage(SAM_Destroy,0,0)
	Table Window: T0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Угоди з клієнтами на ведення банком операцій з  Ф`ЮЧЕРСНИМИ  контрактами
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  12.617"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.476"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відкрити нову угоду (Добавити нового клієнта)'
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Завершити діючу угоду'
						On SAM_Click
							If OSTB =0 and OSTC=0
								If SalMessageBox(" Завершити діючу угоду з "|| NMK ||" ?","Увага !", MB_IconQuestion | MB_YesNo) = IDYES
									If SqlPrepareAndExecute( hSql(),
											  "update fk_deal set wdate=:T0.bDat where nd=:T0.ND" )
											 and SqlCommitEx(  hSql(), "Закрито ФК "||Str(ND))
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.6"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.95"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30131
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.1"
						Begin Y:  0.012"
						End X:  5.1"
						End Y:  0.476"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.467"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.9"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Діючі Заявки-Доручення клієнта '
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.45"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Тексти документів угоди'
						On SAM_Click
							If ND != NUMBER_Null
								Call cdoc_ShowAllDocs( ND, hWndForm )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.9"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30132
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.433"
						Begin Y:  0.012"
						End X:  4.433"
						End Y:  0.476"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.567"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30133
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.417"
						Begin Y:  0.0"
						End X:  1.417"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: nKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.183"
							Top:    0.143"
							Width:  0.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість угод')
				Data Field: nSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.15"
							Top:    0.143"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума на торгов.рахунках клієнтів')
				Data Field: nSumB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.167"
							Top:    0.143"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума на загальгному торгов.рахунку')
				Data Field: dNLS_FCHB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.167"
							Top:    0.143"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Загальний торговий рахунк банку')
		Contents
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If T0.ND = NUMBER_Null
							Set T0.sTmp=STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER","NMK",
									" DATE_OFF is null and customer.rnk not in (select rnk from fk_deal )",  T0.sTmp, T0.NMK)
							If T0.sTmp !=STRING_Null
								Set T0.RNK=Val(T0.sTmp)
								! If SqlPrepareAndExecute( hSql(),"SELECT custtype, sab INTO :T0.TYP,:T0.SAB FROM customer where rnk=:T0.RNK " )
										and SqlFetchNext( hSql(), nFetchRes )
										and SqlPrepareAndExecute( hSql(),
										  "SELECT min(a.acc) INTO :T0.ACC_26
										   FROM accounts a, cust_acc u
										   WHERE u.rnk=:T0.RNK  and u.acc=a.acc(+) and
										         a.kv =:T0.n980 and a.nbs like '26_0' and a.dazs is null " )
										and SqlFetchNext( hSql(), nFetchRes )
										and SqlPrepareAndExecute( hSql(), "SELECT nls INTO :T0.NLS26 FROM accounts WHERE acc=:T0.ACC_26 " )
										and SqlFetchNext( hSql(), nFetchRes )
									                                                                                                                                                                                                              Set DEB_26 = 'Y'
									                                                                                                                                                                                                              Set T0.DAT1 = T0.bDat
									                                                                                                                                                                                                              Set T0.DAT4 = T0.DATP_
									                                                                                                                                                                                                              If SqlPrepareAndExecute( hSql(),
											  "SELECT min(a.nls) INTO :T0.NLS36 FROM accounts a, cust_acc u
											   WHERE u.rnk=:T0.RNK and u.acc=a.acc(+) and
											         a.kv=:T0.n980 and a.nbs=3600 and a.dazs is null " )
											and SqlFetchNext( hSql(), nFetchRes )
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If T0.ND = NUMBER_Null
							Set T0.sTmp=STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER","NMK",
									" DATE_OFF is null and customer.rnk not in (select rnk from fk_deal )",  T0.sTmp, T0.NMK)
							If T0.sTmp !=STRING_Null
								Set T0.RNK=Val(T0.sTmp)
								! If SqlPrepareAndExecute( hSql(),"SELECT custtype, sab INTO :T0.TYP,:T0.SAB FROM customer where rnk=:T0.RNK " )
										and SqlFetchNext( hSql(), nFetchRes )
										and SqlPrepareAndExecute( hSql(),
										  "SELECT min(a.acc) INTO :T0.ACC_26
										   FROM accounts a, cust_acc u
										   WHERE u.rnk=:T0.RNK  and u.acc=a.acc(+) and
										         a.kv =:T0.n980 and a.nbs like '26_0' and a.dazs is null " )
										and SqlFetchNext( hSql(), nFetchRes )
										and SqlPrepareAndExecute( hSql(), "SELECT nls INTO :T0.NLS26 FROM accounts WHERE acc=:T0.ACC_26 " )
										and SqlFetchNext( hSql(), nFetchRes )
									                                                                                                                                                                                                              Set DEB_26 = 'Y'
									                                                                                                                                                                                                              Set T0.DAT1 = T0.bDat
									                                                                                                                                                                                                              Set T0.DAT4 = T0.DATP_
									                                                                                                                                                                                                              If SqlPrepareAndExecute( hSql(),
											  "SELECT min(a.nls) INTO :T0.NLS36 FROM accounts a, cust_acc u
											   WHERE u.rnk=:T0.RNK and u.acc=a.acc(+) and
											         a.kv=:T0.n980 and a.nbs=3600 and a.dazs is null " )
											and SqlFetchNext( hSql(), nFetchRes )
			Column: CF_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ідент.
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.25"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT1= DATETIME_Null
							Set DAT1 = bDat
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						угоди
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_FCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Торговий
						рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SalIsNull(T0.NLS_FCH) and not SalIsNull(T0.ND )
							If SqlPrepareAndExecute(hSql(), "SELECT BARS.F_NEWNLS2(NULL,'FCH',null,:RNK,NULL) INTO :NLS_FCH FROM dual")
									and SqlFetchNext(hSql(), nFetchRes)
								Call SalSendMsg( T0.NLS_FCH, SAM_Validate, 0, 0 )
					On SAM_Validate
						If SalIsNull(T0.ND )
							Return VALIDATE_Ok
						! !!!!!!!
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox("Нецифра в номере счета", "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						Set NLS_FCH = Val(KeyAccount( sBankMfo, Str(T0.NLS_FCH) ))
						Call F_NEW()
						Return VALIDATE_Ok
			Column: OSTB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Зал.на
						торг.рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PZTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розрах.
						сума зал.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Надлишки +
						Недостача -
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-зал.
						торг.рах
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_NEW
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nAcc
					Number: nRet
					Number: nGr
					Number: nIsp
					String: sNms
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT acc INTO :nAcc FROM accounts WHERE kv=:T0.n980 and nls=:T0.NLS_FCH ")
							and not SqlFetchNext(hSql(), nFetchRes)
						! ! согласны на авто-открытие
						If SalMessageBox('Счет '||Str(T0.NLS_FCH)||'/'||Str(T0.n980)||' не открыт.'||PutCrLf()||
								   ' Открыть ?', NMK || '. Внимание!', MB_YesNo | MB_IconHand) = IDYES
							!
							Set sNms = Subs('Торгов.по ФК '||T0.NMK, 1, 38 )
							Set nAcc = NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									  "SELECT a.isp INTO :nIsp FROM accounts a, cust_acc u
									   WHERE a.acc=u.acc and u.rnk=:T0.RNK and a.nbs like '26__' ")
									and not SqlFetchNext(hSql(), nFetchRes)
								Set nIsp = GetUserId()
							Set nGr  = T0.pGr
							! Call DebugN(nIsp)
							! Call DebugN(nGr)
							If Op_Reg(99, 0, 0, nGr, nRet, T0.RNK, Str(T0.NLS_FCH), T0.n980, sNms, 'FCH', nIsp, nAcc)
									and SqlPrepareAndExecute( hSql(),"UPDATE FK_deal set NLS_FCH =:T0.NLS_FCH where nd=:T0.ND")
								Call SqlCommit(hSql())
							! If Op_Reg(99, 0, 0, nGr, nRet, T0.RNK, Str(T0.NLS_FCH), T0.n980, sNms, 'FCH', nIsp, nAcc)
								                                                                                                                                                                                                      Call SqlCommit(hSql())
								                                                                                                                                                                                                      Call Debug('nAcc='||Str(nAcc) )
							! If SqlPrepareAndExecute( hSql(),"UPDATE FK_deal set NLS_FCH =:T0.NLS_FCH where nd=:T0.ND")
								                                                                                                                                                                                                      Call SqlCommit(hSql())
								                                                                                                                                                                                                      Call Debug('T0.ND='||Str(T0.ND) )
							Else
								Call SqlRollback(hSql())
								Call SalMessageBox('Невозможно откыть счет ' || Str(T0.NLS_FCH), 'Ошибка', MB_IconExclamation)
		Window Parameters
			Number: nMode
			Number: pGr !! группа доступа для торг.счетов
			String: NLS_FCHB ! загальний торгов.рахунок
			String: strPar02
		Window Variables
			Number: n980
			String: sBankMfo
			Date/Time: bDat
			Number: nUser
			String: sTmp
			String: sf
			Number: nTmp
			Date/Time: DATP_
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set dNLS_FCHB = NLS_FCHB
				Call PrepareWindow( hWndForm )
				Call SalTblSetLockedColumns( hWndForm, 6 )
				Set T0.nTabInstance = 1
				Call SetWindowFullSize(hWndForm)
				Set T0.strFilterTblName = 'CUSTOMER'
				Set T0.strPrintFileName = 'FK'
				Set T0.n980 = GetBaseVal()
				Set T0.bDat = GetBankDate()
				Set T0.sBankMfo = GetBankMfo()
				Set T0.nUser = GetUserId()
				Set T0.strSqlUpdate = "update fk_deal set Cf_ID=:T0.CF_ID, sdate=:T0.DAT1 where nd=:T0.ND"
				!
				Set T0.strSqlInsert =
						"Insert into fk_deal (nd, Cf_ID, SDATE, RNK ) values (0, :T0.CF_ID, :T0.DAT1, :T0.RNK )"
				Set T0.strSqlPopulate =
						"SELECT f.ND,f.CF_ID,f.SDATE,f.RNK, customer.NMK, customer.OKPO,
						        f.nls_fch, a.ostb/100, a.ostc/100,  a.acc, fk.PZTR(f.RNK)
						 INTO  :T0.ND, :T0.CF_ID, :T0.DAT1, :T0.RNK, :T0.NMK, :T0.OKPO,
						       :T0.NLS_FCH, :T0.OSTB, :T0.OSTC, :T0.ACC, :T0.PZTR
						 FROM  customer, fk_deal f, accounts a
						 WHERE  customer.rnk=f.rnk and f.wdate is null and a.kv(+)=:T0.n980 and a.nls(+)= f.nls_fch"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set nKol =0
				Set nSum =0
				If SqlPrepareAndExecute( hSql(),
						  "SELECT ostc/100 INTO :nSumB from accounts where kv=:T0.n980  and nls=:T0.NLS_FCHB " )
						and not SqlFetchNext(hSql(), nFetchRes)
					Call SalWaitCursor(TRUE)
					Call SalMessageBox("В парметрах виклику не указано загальний торгов.рахунок ",
							"УВАГА ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set nKol = nKol + 1
				Set nSum = nSum + OSTB
				If OSTB != OSTC
					! План не = факт на 36 - бледно-зеленый
					Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB(230,255,230)  )
				!
				Set DEL = OSTB - PZTR
				If DEL < 0
					! недоплата - розовый
					Call XSalTblSetCellBackColor( DEL, SalColorFromRGB(255,210,250 ) )
			On SAM_DoubleClick
				If ND > 0
					If not IsWindow(hWin1)
						Set hWin1 = SalCreateWindow( T1, hWndMDI, RNK, ACC, NMK, OKPO )
					Else
						Call SalBringWindowToTop ( T1 )
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm, T0.ND, 300 )
	Table Window: T1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    0.917"
				Width:  14.8"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Ввести нову заявку'
						On SAM_Click
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow( F1, hWndMDI, RNK, ACC, NMK, OKPO, pbRefresh )
							Else
								Call SalBringWindowToTop ( F1 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити полилково введену заявку'
						On SAM_Click
							If OP < 10
								If SalMessageBox("Вилучити полилково введену заявку "|| Str(REF)||" ?","Увага !", MB_IconQuestion | MB_YesNo) = IDYES
									If SqlPrepareAndExecute( hSql(), "delete from fk_zay where ref=:REF and rnk=:RNK " )
											 and SqlCommitEx(  hSql(), "Відмінено ФК-заявку"||Str(REF))
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30134
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30135
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30136
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: NLS_FCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.65"
							Top:    0.071"
							Width:  1.783"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Торговий рахунк клієнта')
				Data Field: OSTB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.433"
							Top:    0.071"
							Width:  1.783"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Залишок на торговому рахунку клієнта')
				Data Field: PZTR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.2"
							Top:    0.071"
							Width:  1.783"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Розрахункова сумма залишку')
				Data Field: DEL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.071"
							Width:  1.783"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Надлишки + , Недостача -')
		Contents
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата, час
						заявки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.867"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: WDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Темін
						дії
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Специфікація
						(Інструмент/
						Серія)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Операція
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ціна
						клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: К-сть
						ФК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MIN_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Min
						К-сть
						ФК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAKAZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наказ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стан
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TRATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ціна
						трейдера
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
		Window Parameters
			Number: RNK
			Number: ACC
			String: NMK
			String: OKPO
		Window Variables
			Number: nOP
			Number: nSOS
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call SalDisableWindow( pbUpdate )
				Call SalSetWindowText( hWndForm, 'Діючі Заявки-Доручення клієнта '||NMK||' '||OKPO)
				Call SalTblSetLockedColumns( hWndForm, 8 )
				Set T1.nTabInstance = 1
				Set T1.strSqlPopulate =
						"SELECT REF, DATP, ID_INS||'/'||ID_SER, OP, RATE, KOL, MIN_KOL, WDATE,TRATE, nakaz
						 INTO  :T1.REF,:T1.DATP,:T1.ID,:T1.OP,:T1.RATE,:T1.KOL,:T1.MIN_KOL,:T1.WDATE,:T1.TRATE,:T1.NAKAZ
						 FROM  fk_zay WHERE op>0 and op< 30 and rnk=:T1.RNK order by ref"
				Set T1.strPrintFileName = 'FK_ZAY'
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Set nOP = SalNumberMod( OP, 10 )
				Set nSOS = OP - nOP
				If nSOS = 0
					Set sSOS= 'Введено'
				Else If nSOS = 10
					Set sSOS= 'Операціоніст'
				Else If nSOS = 20
					Set sSOS= 'Трейдер'
				Else If nSOS = 30
					Set sSOS= 'Бухгалтер'
				If nOP < 3
					Set sOP = 'Купівля'
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
				Else If nOP < 5
					Set sOP = 'Продаж'
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
			On UM_Populate
				If SqlPrepareAndExecute( hSql(),
						  "SELECT nls, ostb/100, fk.PZTR(:RNK) INTO :NLS_FCH, :OSTB, :PZTR from accounts where acc=:ACC")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set NLS_FCH = STRING_Null
					Set OSTB = NUMBER_Null
					Set PZTR = NUMBER_Null
				Set DEL = OSTB - PZTR
				Call SalColorSet( DEL, COLOR_IndexWindow, IifN(DEL<0, SalColorFromRGB(255,210,250), COLOR_White) )
				Call SalSendClassMessage(UM_Populate, 0, 0)
	Table Window: TA2
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   7.825"
				Top:    2.292"
				Width:  6.15"
				Width Editable? Yes
				Height: 5.19"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? Yes
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Column: TAG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Колонка
						осн.таблицы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Значение
						колонки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
		Message Actions
	Table Window: TPK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Позиції клієнтів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.113"
				Top:    0.135"
				Width:  10.9"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.233"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.2"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30137
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.2"
						Begin Y:  -0.071"
						End X:  5.2"
						End Y:  0.393"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.667"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.1"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.567"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.967"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30138
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.583"
						Begin Y:  -0.06"
						End X:  6.583"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.433"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30139
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.15"
						Begin Y:  -0.036"
						End X:  2.15"
						End Y:  0.429"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
		Contents
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_FCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Торговий
						рахунок
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSC_FCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-зал.
						торг.рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Специфікація
						(Інструмент/
						Серія)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Операція
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: К-сть
						ФК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sPOZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Позиція
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nOP
			Number: n980
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set n980 = GetBaseVal()
				Call SalTblSetLockedColumns( hWndForm, 10 )
				Set TPK.nTabInstance = 1
				Set TPK.strFilterTblName = 'FK_ZAY'
				!
				Set TPK.strPrintFileName = 'FKP_ZAY'
				!
				Set TPK.strSqlPopulate =
						"SELECT d.RNK, c.NMK, d.NLS_FCH, a.OSTC/100, a.ACC, z.ID_INS||'/'||z.ID_SER,
						        mod(OP,10), sum(z.KOL)
						 INTO  :TPK.RNK, :TPK.NMK,:TPK.NLS_FCH, :TPK.OSC_FCH,:TPK.ACC, :TPK.ID,:TPK.OP,:TPK.KOL
						 FROM  FK_ZAY z, customer c, fk_deal d, accounts a
						 WHERE z.op>10 and z.op<20 and c.rnk=d.rnk and d.rnk=z.rnk and d.NLS_FCH=a.nls and a.kv =:TPK.n980
						 GROUP BY d.RNK, c.NMK, d.NLS_FCH, a.OSTC/100, a.ACC, z.ID_INS, z.ID_SER, mod(OP,10)"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If OP < 3
					Set sOP = 'Купівля'
					Set sPOZ ='Довга     '
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
				Else If nOP < 5
					Set sOP = 'Продаж'
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
					Set sPOZ ='Коротка'
	Table Window: FA6
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить проект проводок'
						On SAM_Click
							Call F_OPL()
				Line
					Resource Id: 14900
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 14901
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 14902
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						Аванса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDOC 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						инвойса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №.
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DDOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сч.2030
						Дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сч.9129
						Дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMKD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дебитор
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						Дебитора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMKK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Клиент
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: NAZN
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                      List Values 
				                                                                                                      Message Actions 
			!
			Column: REF_DOC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф инв
						ДФ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф инв
						АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф инв
						АБС
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SAVA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						инвойса
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_OPL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nS
					String: sTT
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If REF = NUMBER_Null and NLSK != STRING_Null 
							Set nS = S * 100
							If MFOK = STRING_Null
								Set MFOK = aMfo
							If MFOK = aMfo
								Set sTT ='KK1'
							Else
								Set sTT ='KK2'
							Call cDoc.SetDoc (REF, sTT, 1, 1, Str(NI),
									     DDOC, SalDateCurrent(), bDat, bDat ,
									     NLSD, NMKD, aMfo, '', n980, nS, OKPOD,
									     NLSK, NMKK, MFOK, '', n980, nS, OKPOK,
									     "Перерахування авансу за уступленим документом № "||NDOC ||
									     " від "||SalFmtFormatDateTime( DDOC, "dd/MM/yyyy" ) ||
									     " на суму "|| SalNumberToStrX( SDOC,2),
									     '',     GetIdOper(), '', NUMBER_Null, 0)
							If cDoc.oDoc()
								Set REF = cDoc.m_nRef
								If cDoc.PayTT(0,REF, bDat, 'CR9', 1, n980, s9900, nS,n980,NLS9, nS )
									Set nS = SAVA*100 + nS
									If SqlPrepareAndExecute( hSql(),"UPDATE FAK_Invoice set SAVA = :nS, SOS=2, dAVA=:bDat where ni=:NI")
											and SqlPrepareAndExecute( hSql(),"UPDATE DF_BARS_INVOICE set SOS=2 where REF_DOC=:REF_DOC")
										Call SqlCommitEx( hSql(), "Выдан аванс по REF_DOC="||Str(REF_DOC))
					Return TRUE
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: strPar01
			String: strPar02
		Window Variables
			Number: n980
			String: aMfo
			Date/Time: bDat
			String: s9900
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set bDat = GetBankDate()
				Set FA6.strPrintFileName = 'DF_AV.txt'
				Set FA6.nTabInstance = 1
				If SqlPrepareAndExecute( hSql(),"SELECT nlsa INTO :s9900 from tts where tt='CR9' " )
						and SqlFetchNext(hSql(), nFetchRes)
					Set FA6.strSqlPopulate = 
							"SELECT f.S/100, i.SDOC, i.NDOC, i.DDOC,  
							        Substr(FAKTOR.NLS(e.ND,d.RNK,'2030'),1,14),
							        Substr(FAKTOR.NLS(e.ND,d.RNK,'9129'),1,14),
							        d.NMK, d.okpo,  
							        Substr(FAKTOR.NLS(e.ND,k.RNK,'2600'),1,14),
							        k.NMK, k.okpo, k.rnk, f.REF_DOC, i.ni , nvl(i.SAVA,0) 
							 INTO :FA6.S,:FA6.SDOC,:FA6.NDOC,:FA6.DDOC,:FA6.NLSD,:FA6.NLS9,:FA6.NMKD,:FA6.OKPOD,
							      :FA6.NLSK,:FA6.NMKK,:FA6.OKPOK,:FA6.RNKK,:FA6.REF_DOC, :FA6.NI, :FA6.SAVA
							 FROM BARS_f_INVOICE_A f , DF_BARS_INVOICE b, fak_invoice i,
							      FAK_KONTR t, cc_deal e, customer k, customer d 
							 WHERE f.ref_doc = b.REF_DOC and b.sos is null
							   and i.ni=b.REF_BARS and i.nk=t.nk and t.nd=e.nd and e.rnk=k.rnk 
							   and t.rnkd=d.rnk"
				! Set FA6.strFilterTblName = 'FA6'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If NLSK != STRING_Null
					Set MFOK= aMfo
				Else
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT MFO, NLS into :MFOK, :NLSK from CORPS_ACC where rnk=:RNKK")
							and SqlFetchNext( hSqlAux2(), nFetchRes)
	Table Window: L1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Управление лимитами на банки
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.083"
				Width:  15.983"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31113
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Связь лимитируемых счетов '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31114
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.717"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31115
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.048"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Управленческие счета '
						On SAM_Click
							Set sTmp =
									" a.nls like '8997%' and a.kv ="||Str(n980) 
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
							! Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, sTmp )
									
		Contents
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Контро
						лировать
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег №
						Контраг.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						банка
				Visible? Yes
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						контрагента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						Ген.согл
				Visible? Yes
				Editable? No
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						kлимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал.
						лим
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит на 
						АКТ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_AnyEdit
						                                                                                Set LIM = - OSTX * 100 
					On SAM_Validate
						Set LIM = - OSTX * 100 
					On SAM_KillFocus
						Set LIM = - OSTX * 100 
			Column: OSTC  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						использовано
						лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTB  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						Использовано
						лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не испол.
						лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит на 
						АКТ
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: aMfo
			String: aOkpo
			Number: n980
			String: sSql
			Number: nRow
			Number: nRet
			Number: nUserId
			String: sFilter 
			String: sTmp
		Message Actions
			On SAM_Create
				Set aMfo = GetBankMfo()
				Set L1.strFilterTblName = 'L1'
				Set n980 = GetBaseVal()
				Set aOkpo = GetBankOkpoS()
				Set nUserId = GetUserId()
				Set L1.strFilterTblName = 'CUSTOMER'
				Set L1.fFilterAtStart = 1
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				If L1.fFilterAtStart
					Set L1.fFilterAtStart = NOT L1.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set L1.sSql =
						"SELECT CUSTOMER.rnk, CUSTOMER.nmk, CUSTOMER.nd,
						       a.acc, a.nls, a.kv, -a.ostx/100, -a.ostc/100, -a.ostb/100
						 INTO :L1.RNK,:L1.NMK,:L1.CC_ID,:L1.ACC8,:L1.NLS8,:L1.KV8,:L1.OSTX,:L1.OSTC,:L1.OSTB
						 FROM CUSTOMER, custbank b,
						(select acc,rnk,kv,nls,ostx,ostc,ostb from accounts where nls like '8997_'||rnk and dazs is null) a 
						 WHERE CUSTOMER.rnk=b.rnk and CUSTOMER.rnk=a.RNK (+) 
						   and CUSTOMER.date_off is null and CUSTOMER.okpo<>:aOkpo 
						  " || IifS (sFilter = "", ""," and "|| sFilter ) || "
						 ORDER BY a.acc "
				Call SalTblPopulate(hWndForm, hSql(), L1.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					! Открыть счет 8997_RNK
					If OTM = 1 and ACC8 = NUMBER_Null
						Set NLS8 = Vkrz2( aMfo, '89970'||Str(RNK) )
						If NOT Op_Reg(99,0,0,0,nRet,RNK, NLS8, n980, NMK, 'LIM', nUserId, ACC8 )
							Call SqlRollback(hSql())
							Call SalMessageBox('Невозможно откыть счет LIM ' ||  NLS8, 'Ошибка', MB_IconExclamation)
					If OTM = 1 and LIM != NUMBER_Null
						If NOT SqlPrepareAndExecute( hSql(),"update accounts set ostx = :LIM where acc=:ACC8" )
							Call SqlRollback(hSql())
							Call SalMessageBox('Невозможно  утановить LIM на ' ||  NLS8, 'Ошибка', MB_IconExclamation)
					! Update 
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				If ACC8 != NUMBER_Null
					Set OTM = 1
					Set DEL = OSTX - OSTB 
					If DEL <0 
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,210 ) )
			On SAM_DoubleClick
				If IsWindow(h_L2)
					Call SalDestroyWindow(h_L2 )
				Set h_L2 = SalCreateWindow( L2, hWndMDI, RNK, ACC8, NMK, NLS8 )
	Form Window: L2
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.675"
				Top:    0.219"
				Width:  13.5"
				Width Editable? Class Default
				Height: 6.762"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If F_LIM (sErr)
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
								Call SalMessageBox(sErr, 'Ошибка', MB_IconExclamation)
				Line
					Resource Id: 34237
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 34238
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 34239
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.583"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  12.983"
						Width Editable? Class Default
						Height: 2.155"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Исключить
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.033"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.033"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт ном
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План ном
								Остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: QSTC  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт экв
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: QSTB  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План экв
								Остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: NAS
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor(TRUE)
							Call SalTblDefineSplitWindow(tbl, 0, FALSE)
							Call SalTblPopulate(tbl, hSql(), 
									"SELECT acc,kv,nls, nms, ostc/100, ostb/100,
									 gl.p_icurval(kv,ostc,:bDat)/100, gl.p_icurval(kv,ostb,:bDat)/100 
									INTO :ACC, :KV, :NLS,:NMS,:OSTC,:OSTB, :QSTC,:QSTB 
									from accounts where accc=:ACC8 and dazs is null and nls not like '8997%' 
									order by ostc ", TBL_FillAll )
							Call SalTblSetContext(tbl, 0)
							! Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor(FALSE)
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						If OSTC < 0
							Call XSalTblSetRowBackColor( tbl, lParam, SalColorFromRGB( 255,210,210 ) )
						Else If OSTC >0 
							Call XSalTblSetRowBackColor( tbl, lParam, SalColorFromRGB( 220,255,255 ) )
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.738"
						Width:  12.983"
						Width Editable? Class Default
						Height: 2.94"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Включить
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.017"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План
								Остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: QSTC  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт экв
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: QSTB  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План экв
								Остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: NAS
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor(TRUE)
							Call SalTblDefineSplitWindow(tbl2, 0, FALSE)
							Call SalTblPopulate(tbl2, hSql(), 
									"SELECT acc,kv,nls, nms, ostc/100, ostb/100,
									 gl.p_icurval(kv,ostc,:bDat)/100, gl.p_icurval(kv,ostb,:bDat)/100 
									INTO :ACC, :KV, :NLS,:NMS,:OSTC,:OSTB, :QSTC,:QSTB 
									from accounts where accc is null and rnk=:RNK and dazs is null and nls not like '8997%' 
									order by ostc ", TBL_FillAll )
							Call SalTblSetContext(tbl2, 0)
							! Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor(FALSE)
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						If OSTC < 0
							Call XSalTblSetRowBackColor( tbl2, lParam, SalColorFromRGB( 255,210,210 ) )
						Else If OSTC >0 
							Call XSalTblSetRowBackColor( tbl2, lParam, SalColorFromRGB( 220,255,255 ) )
		Functions
			Function: F_LIM
				Description:
				Returns
					Boolean:
				Parameters
					Receive String: sErr
				Static Variables
				Local variables
					Number: nRow
				Actions
					!
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl, nRow,  ROW_Edited, 0)
						Call SalTblSetContext(tbl, nRow)
						If tbl.OTM = 1 
							If NOT SqlPrepareAndExecute( hSql(), "Update accounts set accc=null where acc=:tbl.ACC" )
								Set sErr = 'Невозможно Исключить счет ' || tbl.NLS || '/'|| Str(tbl.KV )
								Return FALSE
					!
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow,  ROW_Edited, 0)
						Call SalTblSetContext(tbl2, nRow)
						If tbl2.OTM = 1 
							If NOT SqlPrepareAndExecute( hSql(), "Update accounts set accc=:ACC8 where acc=:tbl2.ACC" )
								Set sErr = 'Невозможно Bключить счет ' || tbl2.NLS || '/'|| Str(tbl2.KV )
								Return FALSE
					!
					If NOT SqlPrepareAndExecute( hSql(),
							 "Update accounts a set 
							   a.ostC=(select NVL(sum(gl.p_icurval(kv,ostC,:bDat)),0) from accounts where accc=:ACC8),
							   a.ostB=(select NVL(sum(gl.p_icurval(kv,ostB,:bDat)),0) from accounts where accc=:ACC8)
							 where a.acc=:ACC8 ")
						Set sErr = 'Невозможно установить остатки на счете консолидации ' ||NLS8 
						Return FALSE
					Call tbl.NAS()
					Call tbl2.NAS()
					Return TRUE
		Window Parameters
			Number: RNK
			Number: ACC8
			String: NMK
			String: NLS8
		Window Variables
			Date/Time: bDat
			String: sErr
		Message Actions
			On SAM_Create
				Set bDat = GetBankDate()
				Call SalSetWindowText( L2, 'Связь лимитируемых счетов для '|| NMK )
				Call tbl.NAS()
				Call tbl2.NAS()
	Form Window: XL1
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Овердрафт холдинга
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.8"
				Top:    1.073"
				Width:  15.333"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.631"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Frame
					Resource Id: 7360
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  10.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Открыть овердрафт выбранному Холдингу'
						On SAM_Click
							Call tbl.F_New()
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Сохранить установки по дочерним счетам'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 ) and tbl.ACC8 != NUMBER_Null 
								Call tbl2.OP_2()
				Pushbutton: pbAccHistory2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'История выбранного доч.счета'
						On SAM_Click
							If SalTblAnyRows( tbl2, ROW_Selected, 0 ) and tbl2.ACC > 0
								Call Show_Sal_Day_P (tbl2.ACC, tbl2.NLS, tbl2.KV, DAT1, DAT2)
				Pushbutton: pb_PR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: (none)
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Процентная карточка выбранного доч.счета'
						On SAM_Click
							If SalTblAnyRows( tbl2, ROW_Selected, 0 ) and tbl2.ACC > 0
								Call SetProcParN(tbl2.ACC, tbl2.KV, "", "" )
				!
				! ctb_pbGetValue: pb_Sum
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\SUMM.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Sky
.end
					                                                 Message Actions 
						                                                 On SAM_Create
							                                                 Set strTip = 'Установить суммарный остаток на консолидированном счете'
						                                                 On SAM_Click
							                                                 If SalTblAnyRows( tbl, ROW_Selected, 0 ) and tbl.ACC8 != NUMBER_Null 
								                                                 Call tbl.OST_1()
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.783"
							Top:    0.155"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "С" ')
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.683"
							Top:    0.155"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "По" ')
				Check Box: cb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вкл
					Window Location and Size
						Left:   9.483"
						Top:    0.238"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Только вкл.счета / Все счета')
				Pushbutton: pb_PR_ALL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: (none)
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CALS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Расчетные Проценты за период'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Call tbl2.PR_2 ()
				Data Field: PR_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Расчетные % по АКТ в нац.вал')
				Data Field: PR_P
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Расчетные % по ПАС в нац.вал')
				!
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Изъять Документ из картотеки'
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Счета, входящие в Холдинг'
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 ) 
								Call tbl2.NAS_2()
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитать нераспределенные документы-поступления'
						On SAM_Click
							Call tbl.NAS_1( )
				Line
					Resource Id: 7361
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  6.783"
						Begin Y:  Class Default
						End X:  6.783"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установить фильтр на Холдингт с овердрафтом (верхняя таблица)'
							Call cF1.Init('CUSTOMER','CUSTOMER')
						On SAM_Click
							If SetQueryFilter(cF1 )
								Set sFilter = cF1.GetFilterWhereClause( FALSE )
								Call tbl.NAS_1( )
							Else
								Set sFilter = ""
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.933"
						Top:    0.143"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7362
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.733"
						Begin Y:  Class Default
						End X:  3.733"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7363
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  4.617"
						Begin Y:  0.44"
						End X:  4.617"
						End Y:  0.024"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.333"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl ! Холдинги
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.817"
						Width Editable? Class Default
						Height: 1.821"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					!
					Column: RNKP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: РНК 
								холдинга
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.833"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMKP 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование холдинга
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOLK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								кл.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.667"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: NLSP 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
								консолидации
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								включен.
								дочерних сч
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Суммарный
								экв-Дебет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Суммарный
								экв-Кредит
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.3"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Суммарный
								экв-Остаток
								фактический
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.383"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Суммарный
								экв-Остаток
								плановый
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.333"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC8
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								входящих
								 клиентов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: NAS_1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblSetTableFlags ( tbl, TBL_Flag_SingleSelection, TRUE )
							Call SalTblSetLockedColumns( tbl, 3 )
							! Set sFilter = ""
							! Set sFilter = cF.GetFilterWhereClause( FALSE )
							Call SalTblDefineSplitWindow (tbl, 0, FALSE )
							Set sSql1 =
									"SELECT CUSTOMER.RNK, CUSTOMER.NMK,  a.acc, a.nls, a.ostc/100, a.ostb/100
									INTO :tbl.RNKP,:tbl.NMKP, :tbl.ACC8,:tbl.NLSP, :tbl.OSTC, :tbl.OSTB
									  FROM CUSTOMER,  accounts a     
									  WHERE CUSTOMER.rnk=a.rnk and a.nls  like '8026_'||a.rnk and a.kv =:n980 " ||
									 IifS (sFilter = "", ""," and "|| sFilter ) || " ORDER BY CUSTOMER.rnk"
							Call SalTblPopulate( tbl, hSql(), sSql1, TBL_FillAll )
							Call SalTblReset( tbl2 )
					Function: OP_1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nRet
							String: sNls
						Actions
							Set sNls = KeyAccount( sBankMfo, '80260'||Str(tbl.RNKP) )
							If Op_Reg(99,0,0,0,nRet, tbl.RNKP, sNls, n980, tbl.NMKP, 'ODB', nId, tbl.ACC8 )
								Set tbl.NLSP = sNls
								Call SqlCommitEx( hSql(),"Открыт "||sNls )
								! Call OPEN_1()
								Call SalShowWindow( tbl2.OP )
								Call SalShowWindow( tbl2.LIM)
								Call XSalTblSetCellBackColor( RNKP, nCol1 ) 
								Call XSalTblSetCellBackColor( NMKP, nCol1 )
								Call XSalTblSetCellBackColor( KOLK, nCol1 )
								Call XSalTblSetCellBackColor( NLSP, nCol1 )
							Else
								Call SqlRollback( hSql() )
					Function: OST_1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							! Number: nRet
							! String: sNls
						Actions
							If SqlPrepareAndExecute( hSql(), 
									"UPDATE accounts set 
									  ostC = (select NVL(sum(gl.p_Icurval(kv,ostC,:bDat)),0) from accounts where accc=:ACC8),
									  ostB = (select NVL(sum(gl.p_Icurval(kv,ostB,:bDat)),0) from accounts where accc=:ACC8)
									 WHERE acc=:ACC8 " )
								Call SqlCommitEx( hSql(),"Уст.остатки на "|| NLSP )
								Call tbl2.NAS_2()
							Else
								Call SqlRollback( hSql() )
					! Function: OPEN_1
						                                                 Description: 
						                                                 Returns 
						                                                 Parameters 
						                                                 Static Variables 
						                                                 Local variables 
						                                                 Actions 
							                                                 Call SalEnableWindow( pbUpdate )
							                                                 Call SalShowWindow( tbl2.OP )
							                                                 Call SalShowWindow( tbl2.LIM)
					Function: F_New
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sTmp
							String: sNmk
						Actions
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER",
									 "NMK", 
									" custtype=2 
									 and DATE_OFF is null 
									 and rnk in (select RNKP from customer ) 
									 and rnkp not in (select rnk from accounts where nls like '8026%' and kv="||Str(n980)||")",
									 sTmp,sNmk)
							If sTmp != STRING_Null
								Call SalTblDefineSplitWindow (tbl, 1, TRUE)
								Set nRow = SalTblInsertRow(tbl, TBL_MinRow)
								Call SalTblSetRowFlags(tbl, nRow, ROW_New, FALSE)
								Call SalTblSetContext(tbl, nRow)
								Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
								Set tbl.RNKP = Val(sTmp)
								Set tbl.NMKP = sNmk
								Call tbl.OP_1()
								Call tbl2.NAS_2()
				Window Variables
				Message Actions
					On SAM_DoubleClick
						Call tbl2.NAS_2()
					On SAM_TblDoDetails
						Call SalTblReset( tbl2 )
						Set tbl.KOL = 0
						Set PR_A = NUMBER_Null
						Set PR_P = NUMBER_Null
						!
						! Call OPEN_1()
					! On SAM_FetchRowDone
						                                                 If NLSP != STRING_Null
							                                                 Call XSalTblSetCellBackColor( RNKP, nCol1 ) 
							                                                 Call XSalTblSetCellBackColor( NMKP, nCol1 )
							                                                 Call XSalTblSetCellBackColor( KOLK, nCol1 )
							                                                 Call XSalTblSetCellBackColor( NLSP, nCol1 )
						!
			Child Table: tbl2 ! Дочерние предприятия
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    1.821"
						Width:  14.817"
						Width Editable? Class Default
						Height: 2.583"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					!
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: РНК 
								доч.клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.833"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование доч.клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет 
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Set NLS2 = NLS
							On SAM_KillFocus
								Set NLS = NLS2
					Column: LIM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Личный лимит 
								в вал счета
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.567"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вкл
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							! On SAM_AnyEdit
								                                                                                                                       Call OP_2()
					Column: DOS2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тек.Дебет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KOS2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тек.Кредит
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.283"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Остаток
								фактический
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.417"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Остаток
								плановый
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.317"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: IR_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: % cт
								АКТ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: IR_P
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: % ст
								ПАС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NP_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Расч.%
								по АКТ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.95"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NP_P
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Расч.%
								по ПАС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.933"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACCC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								входящих
								 клиентов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								входящих
								 клиентов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: NAS_2
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblSetTableFlags ( tbl2, TBL_Flag_SingleSelection, TRUE )
							Set sSql2=
									"SELECT c.RNK, c.NMK, a.acc, a.accc, a.kv, a.nls, a.lim/100, a.ostC/100, a.ostB/100,
									  decode(a.dapp, BANKDATE_G, a.dos,0)/100, decode(a.dapp, BANKDATE_G, a.kos,0)/100,
									  acrn.FPROCN(a.acc,0,:bDat), acrn.FPROCN(a.acc,1,:bDat)
									 INTO :tbl2.RNK,  :tbl2.NMK,  :tbl2.ACC,
									      :tbl2.ACCC, :tbl2.KV,   :tbl2.NLS, :tbl2.LIM , 
									      :tbl2.OSTC2,:tbl2.OSTB2,:tbl2.DOS2,:tbl2.KOS2, 
									      :tbl2.IR_A, :tbl2.IR_P 
									  FROM customer c, accounts a
									  where c.rnkp=:tbl.RNKP and c.rnk=a.rnk  
									     and a.nls like '2600%' and a.dazs is null 
									     and a.acc not in (select acc from ACC_OVER )   
									 ORDER BY c.rnk"
							Set tbl.KOL  = 0
							Set tbl.DOS  = 0
							Set tbl.KOS  = 0
							Set tbl.OSTC = 0
							Set tbl.OSTB = 0
							Call SalTblPopulate( tbl2, hSql(), sSql2 , TBL_FillAll )
							Call SalTblSetLockedColumns( tbl2, 2 )
					Function: OP_2
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sTmp
							String: sSql
							Number: nLim
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tbl2, nRow, ROW_Edited, 0)
								Call SalTblSetContext( tbl2, nRow)
								Set nLim = LIM * 100
								If OP = 1 and ( ACCC = NUMBER_Null  or ACCC = tbl.ACC8)
									Set sSql ="Update accounts set lim=:nLim, accc=:tbl.ACC8  where acc=:ACC"
								Else If OP = 0 and ACCC = tbl.ACC8 
									Set sSql ="Update accounts set lim=0, accc=null where acc=:ACC"
								Set sTmp = IifS (OP = 1, "Включить", "Исключить") ||" счет "||Str(KV)||'/'||NLS 
								If SqlPrepareAndExecute( hSql(), sSql )
									Call SqlCommitEx( hSql(),sTmp  )
									Set ACCC = IifN ( OP = 1, tbl.ACC8, NUMBER_Null)
								Else
									Call SqlRollback( hSql() )
							Call tbl.OST_1()
							Call NAS_2()
					Function: PR_2
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nTmp_0
							Number: nTmp_1
						Actions
							Set PR_A = 0
							Set PR_P = 0
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tbl2, nRow,  0, 0 )
								Call SalTblSetContext( tbl2, nRow)
								If (cb2 and OP = 1 and ACCC = tbl.ACC8)  or (not cb2)
									Set NP_A = - p_intN( ACC, 0, DAT1, DAT2, NUMBER_Null, 0)
									Set NP_P = p_intN( ACC, 1, DAT1, DAT2, NUMBER_Null, 0)
									If KV = n980
										Set nTmp_0 = NP_A
										Set nTmp_1 = NP_P
									Else
										If SqlPrepareAndExecute( hSql(),
												"select gl.p_Icurval(:KV,:NP_A,:bDat), gl.p_Icurval(:KV,:NP_P,:bDat) 
												 into :nTmp_0, :nTmp_1 from dual" )
												and SqlFetchNext(hSql(), nFetchRes)
									If nTmp_0 != 0
										Set PR_A = PR_A + nTmp_0 /100
										Set NP_A = NP_A /100
										Call SalTblSetCellTextColor(NP_A, COLOR_Red,FALSE )
									Else
										Set NP_A = NUMBER_Null
									If nTmp_1 != 0
										Set PR_P = PR_P + nTmp_1 /100
										Set NP_P = NP_P /100
										Call SalTblSetCellTextColor(NP_P, COLOR_DarkBlue,FALSE )
									Else
										Set NP_P = NUMBER_Null
									!
				Window Variables
					String: NLS2
					! String: sProcText
					Number: qDOS
					Number: qKOS
					Number: qOSTC
					Number: qOSTB
				Message Actions
					On SAM_FetchRowDone
						If tbl.ACC8 != NUMBER_Null and ACCC !=NUMBER_Null and ACCC = tbl.ACC8  
							Call XSalTblSetCellBackColor( KV,  nCol2 )
							Call XSalTblSetCellBackColor( NLS, nCol2 ) 
							If SqlPrepareAndExecute( hSqlAux2(),
									"SELECT 
									 gl.p_icurval(:KV,:DOS2,:bDat) , gl.p_icurval(:KV,:KOS2,:bDat),
									 gl.p_icurval(:KV,:OSTC2,:bDat),gl.p_icurval(:KV,:OSTB2,:bDat) 
									into :qDOS,:qKOS,:qOSTC, :qOSTB from dual " ) 
									and SqlFetchNext( hSqlAux2(),nFetchRes) 
							Set tbl.KOL = tbl.KOL + 1
							Set tbl.DOS = tbl.DOS + qDOS
							Set tbl.KOS = tbl.KOS + qKOS
							Set tbl.OSTC = tbl.OSTC + qOSTC
							Set tbl.OSTB = tbl.OSTB + qOSTB
							! Call XSalTblSetCellBackColor( DOS, nCol2 )
							! Call XSalTblSetCellBackColor( KOS, nCol2 )
							! Call XSalTblSetCellBackColor( OSTC,nCol2 ) 
							! Call XSalTblSetCellBackColor( OSTB,nCol2 )
							Set OP= 1
						Else
							Set OP= 0
					On SAM_DoubleClick
						Call SetProcParN(tbl2.ACC, tbl2.KV, "", "" )
		Functions
		Window Parameters
			Number: nPar1
			Number: nPar2
			String: strPar01
			String: strPar02
		Window Variables
			Number: nId
			Number: nCol1
			Number: nCol2
			Number: n980
			Date/Time: bDat
			! Number: nMax
			Number: nRow
			String: NLS_B1
			String: sSql1
			String: sSql2 
			String: sBankMfo 
			String: sFilter
			: cF1
				Class: cGenFilter
		Message Actions
			On SAM_Create
				!
				Set XL1.nTabInstance1 = 1
				Set XL1.nTabInstance2 = 1
				Set XL1.strFilterTblName = 'CUSTOMER'
				! Set XL1.fFilterAtStart = FALSE
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				Set nId = GetUserId()
				Set DAT2 = bDat
				Set DAT1 = AddMonths( DAT2, -1 )
				! Set nMax = 100000000000
				Set nCol1= SalColorFromRGB( 220,255,255 )
				Set nCol2= SalColorFromRGB( 230,255,230 )
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call tbl.NAS_1( )
	Table Window: XCR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    1.375"
				Width:  15.6"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.821"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17642
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть ПЕРВИЧНЫЙ документ'
						On SAM_Click
							Call DocViewContentsEx(hWndForm, REF )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17643
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17644
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Opl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить перекредитовку документа'
						On SAM_Click
							If F_OPL ()
								Set sNls = STRING_Null
								Set sNms = STRING_Null
								Set nS100= NUMBER_Null
				Pushbutton: pb_Doc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть ПОРОЖДЕННЫЙ документ'
						On SAM_Click
							If REF2 != NUMBER_Null
								Call DocViewContentsEx(hWndForm, REF2 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Отметить документ на изъятие из картотеки необработанных'
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить изъятие из картотеки необработанных'
				Data Field: sNls
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет-3578*/3579*')
						! On SAM_Validate
				Data Field: sNms
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.071"
							Width:  4.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Счета 3578*/3579*')
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Счета 3578*/3579*')
				Data Field: SDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.183"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование Счета 3578*/3579*')
				Data Field: nS100
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Остаток Счета 3578*/3579*')
		Contents
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РЕФ
						перв.
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						перв.
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: XS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НЕ 
						использ.
						Сумма
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						плательщика
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAM_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						плательщика
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назначение пл
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  4.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РЕФ
						порожд.
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_OPL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					! String: sNls
					! String: sNms
					String: sNazn
					Number: nS
					Number: nAcc
					Number: nRef
					! String: CC_ID
					! String: SDATE
				Actions
					If REF2 != NUMBER_Null
						Return TRUE
					! !!
					If XS > 0 
						If sNls = STRING_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("XCPV","NLS", 
									     "XCPV.vidd="||Str(nMode)||
									" and XCPV.kv=  "||Str(KV)   ||
									" and XCPV.okpo='"||ID_A||"'" ,sTmp,sNls)
							If sTmp  != STRING_Null 
								Set nAcc = Val(sTmp)
								If SqlPrepareAndExecute( hSql(),
										  "SELECT a.nls,substr(a.nms,1,38), -a.ostb, d.CC_ID, to_char(d.SDATE,'dd/mm/yyyy')
										   into :sNls,:sNms, :nS, :CC_ID, :SDATE
										   From accounts a, nd_acc n, cc_deal d
										   where a.acc=:nAcc and a.acc=n.acc and n.nd=d.nd " )
										and SqlFetchNext( hSql(), nFetchRes)
							Else
								Return FALSE
						Else
							If SqlPrepareAndExecute( hSql(),
									  "SELECT a.acc, substr(a.nms,1,38), -a.ostb, d.CC_ID, to_char(d.SDATE,'dd/mm/yyyy')
									   into :nAcc,:sNms, :nS, :CC_ID, :SDATE
									   From accounts a, nd_acc n, cc_deal d
									   where a.nls=:sNls and a.acc=n.acc and n.nd=d.nd and a.kv=:KV " )
									and NOT SqlFetchNext( hSql(), nFetchRes)
								Set sNms = 'Рахунок не знайдено !'
								Return FALSE
						Set nS100 = nS /100
						If SalMessageBox(
								'Вы действительно хотите погасить счет 
								' || sNls || ' ?',
								'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) != IDYES
							Return FALSE
						! Set sNazn = 
								"Розподiл плати за депозитарнi послуги зг. Дог про вiдкр. рах. цiнних паперiв № "||
								CC_ID ||" вiд "||SDATE 
						Set sNazn = Subs("Розподiл пл. :" || NAZN,1,160)
						Set nRef= NUMBER_Null
						Set nS = SalNumberMin( nS , XS *100)
						Call cDoc.SetDoc( nRef, "XCP", 0, 6, Str(nRef), bDat, bDat, bDat, bDat,
								     sNls, sNms, GetBankMfo(),'', KV , nS , ID_A,
								     NLS_2909, NMS_2909, GetBankMfo(),'', KV, nS, GetBankOkpoS(),
								     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
						If not cDoc.oDoc()
							Call SqlRollback( hSql() )
							Return FALSE
						Else
							If SqlPrepareAndExecute( hSql(),
									IifS(XS-nS/100=0, "delete from xcp_ref ","update xcp_ref set s=s-"||Str(nS))
									||"  where ref1=:XCR.REF" ) 
									and SqlCommit( hSql() )
								Set REF2 = cDoc.m_nRef
								Set XS= XS - nS/100
							Call XSalTblSetCellBackColor( REF2, SalColorFromRGB( 230,255,230 ) )
							Return TRUE
					Else
						Return FALSE
		Window Parameters
			Number: nMode ! VIDD
			Number: pGrp ! Группа доступа 
			String: pXCP ! префикс модуля
			String: Titl
			String: NLS_2909
		Window Variables
			Number: n980
			Date/Time: bDat
			: cDoc
				Class: cDoc
			String: NMS_2909
			!
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call SalCenterWindow( hWndForm )
				Call SetWindowFont( hWndForm )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Call SalSetWindowText( hWndForm, pXCP||':'||Titl )
				Set XCR.strPrintFileName = 'XCR'||'_'||pXCP
				Set XCR.strFilterTblName = 'OPER'
				If SqlPrepareAndExecute( hSql(),
						  "SELECT substr(nms,1,38) into :NMS_2909 From accounts where kv=:n980 and nls=:NLS_2909 ")
						and SqlFetchNext( hSql(), nFetchRes)
				Call SalTblSetLockedColumns( hWndForm, 7 )
				! Было :счет отправителя не похож на 2902
				! Set XCR.strSqlPopulate = 
						"SELECT oper.REF, oper.KV, oper.S/100, x.S/100, oper.ID_A, oper.NAM_A,oper.NAZN 
						 INTO :XCR.REF, :XCR.KV, :XCR.S, :XCR.XS, :XCR.ID_A, :XCR.NAM_A, :XCR.NAZN 
						 FROM oper, xcp_ref x 
						 WHERE x.s>0 and x.ref1=oper.ref 
						   and oper.nlsa not like '2902%'
						   and exists (select 1 from opl where ref=oper.ref and dk=1 and nls=:NLS_2909 )   
						 ORDER by oper.KV, oper.ID_A"
				! Стало : 29-09-2010- Маршавина.  Не анализ.счет отправителя не похож на 2902
				Set XCR.strSqlPopulate = 
						"SELECT oper.REF, oper.KV, oper.S/100, x.S/100, oper.ID_A, oper.NAM_A,oper.NAZN 
						 INTO :XCR.REF, :XCR.KV, :XCR.S, :XCR.XS, :XCR.ID_A, :XCR.NAM_A, :XCR.NAZN 
						 FROM oper, xcp_ref x 
						 WHERE x.s>0 and x.ref1=oper.ref 
						   and exists (select 1 from opl where ref=oper.ref and dk=1 and nls=:NLS_2909 )   
						 ORDER by oper.KV, oper.ID_A"
				!
				Set XCR.strSqlDelete = "DELETE from xcp_ref where ref1=:XCR.REF"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				If F_OPL ()
					Set sNls = STRING_Null
					Set sNms = STRING_Null
					Set nS100= NUMBER_Null
	Table Window: AG2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналіз КП по ЮО у розрізі фінансового стану позичальника (АЖИО-методика)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  13.733"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти в Архіві'
						On SAM_Click
							If SqlPrepareAndExecute( hSql(),"INSERT INTO FIN_ARCH select * from FIN_AG2_TMP")
									and SqlCommitEx(hSql(),"Выполнено накопление в архив FIN_ARCH за "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy" ) )
							! If SqlPrepareAndExecute( hSql(), "delete from FIN_ARCH where adat=:DAT ")
									and SqlPrepareAndExecute( hSql(),"INSERT INTO FIN_ARCH select * from FIN_AG2_TMP")
									and SqlCommitEx(hSql(),"Выполнено накопление в архив FIN_ARCH за "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy" ) )
				Line
					Resource Id: 18303
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  Class Default
						End X:  5.75"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Детально про Суму кред.зоб. та Суму резерву вибраного позичальника'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 18304
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 18305
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.071"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Set sErr = "Не выполнен расчет резервов на дату "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy") 
							If SqlPrepareAndExecute( hSql(), 
									  "select  max(p.DAT) into :D_REZ_  from REZ_PROTOCOL p  
									   where p.dat <= :DAT and to_char(p.dat,'yyyymm')=to_char(:DAT,'yyyymm')
									     and exists (select 1 from TMP_REZ_RISK where DAT= p.DAT and id=p.USERID)" ) 
									and SqlFetchNext(hSql(), nFetchRes)  
							If D_REZ_ = DATETIME_Null
								Call SalMessageBox( sErr, "Внимание ! ", MB_IconStop)
								Set DAT = DATETIME_Null
							Else
								Set DAT = D_REZ_
				! ctb_pbExecute: pb11
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                      Message Actions 
				Check Box: cb_Arc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все із Архіву
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_Arc OR cb_Arc=1
								Set sFil2 =""
								Set DAT = DATETIME_Null
							Else
								Set sFil2 = " and z.adat=:AG2.DAT "
				! !!
				Pushbutton: pb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF5_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = ' "Загальна інформація" '
						On SAM_Click
							Call F_Fi_Ex (  0, strTip, 2, RNK, OKPO,NMK,FDAT )
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Cyan
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Баланс". Форма № 1 '
						On SAM_Click
							Call F_Fi_Ex (  1, strTip, 2,  RNK, OKPO,NMK,FDAT )
				Pushbutton: pb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Фiнансовi результати". Форма № 2 '
						On SAM_Click
							Call F_Fi_Ex (  2, strTip, 2, RNK, OKPO,NMK,FDAT )
				Pushbutton: pb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F3
					Font Name: Arial Narrow
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Light Periwinkle
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Додатковi данi про "Грошові потоки" '
						On SAM_Click
							Call F_Fi_Ex (  3, strTip, 2, RNK, OKPO,NMK,FDAT )
				Pushbutton: pb_4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Початкові данi про "Кредит" '
						On SAM_Click
							Call F_Fi_Ex (  4, strTip, 2, RNK, OKPO,NMK,FDAT )
				!
		Contents
			Column: ADAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Звітна
						Дата
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.
						№
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід.
						код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CLASS_R
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Клас
						по
						розрах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CLASS_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Клас
						в
						БД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						кред.зоб.
						в екв.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						резерву
						в екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Ф-1, Ф-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUM_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заг.
						ФІНАЛ.
						БАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ1
						
						
						Знач
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ1 
						мит.
						лікв
						Бал
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ2
						
						
						Знач
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ2
						пот.
						лікв
						Бал
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ3
						
						
						Знач
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛ3
						заг.
						лікв
						Бал
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КМ
						
						
						Знач
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КМ
						мане
						врен
						Бал
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КН
						
						
						Знач
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КН
						неза
						лежн
						Бал
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВОК
						
						
						Знач
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВОК
						вл.об.
						кошти
						Бал
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: К
						
						
						Знач
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: К
						чис.надх
						/борг
						Бал
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обсяг
						реаліз
						за кв.
						Бал
						8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Віднош
						реал
						/собів
						Бал
						9
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						
						
						Знач
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Баланс
						прибуток
						
						Бал
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прибуток
						(збиток)
						за кв
						Бал
						11
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рентаб
						активів
						
						Бал
						12
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B13
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рентаб
						продаж
						
						Бал
						13
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z14
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						
						
						Знач
						14
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B14
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
						обороту
						коштів
						Бал
						14
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Z15
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						
						
						Знач
						15
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B15
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Віднош
						(ДЗ+ТМЗ)
						/КЗ
						Бал
						15
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B16
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Власні
						кошти
						
						Бал
						16
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B171
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Власні
						ОЗ
						Нерухом
						Бал
						17.1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B172
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Власні
						ОЗ
						Рухом
						Бал
						17.2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B18
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обороти 
						за
						рахунк
						Бал
						18
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B19
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ракунки
						в інш.
						банках
						Бал
						19
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B20
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кредитна
						історія
						
						Бал
						20
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B21
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обслуг
						діючих
						кредитів
						Бал
						21
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ринкова
						прзиція
						
						Бал
						22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B23
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Взаємо-
						дія з
						постач
						Бал
						23
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B24
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Диверси
						фікація
						ризиків
						Бал
						24
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B25
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Термін
						діяль-
						ності
						Бал
						25
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рівень
						менедж
						
						Бал
						26
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: B27
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ступінь
						довіри
						
						Бал
						27
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: DAT1 
			! Number: U_REZ_ ! юзер  по реальному расчету резервов
			Date/Time: D_REZ_ ! дата по реальному расчету резервов
			Number: nCol[2]
			Number: i
			Number: nRed
			Number: nRnk1
			String: sSoob
			String: sSel
			String: sFil1
			String: sFil2
			String: sErr
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set i = 0
				Set nCol[0] = SalColorFromRGB( 230,245,240 ) ! бледнфиолет
				Set nCol[1] = SalColorFromRGB( 255,255,220)  !  желтій
				Set cb_Arc=FALSE
				Set sFil2 = " and z.adat=:AG2.DAT "
				Set nRed = SalColorFromRGB( 255,210,210 )
				Set AG2.strFilterTblName = 'CUSTOMER'
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 10 )
				Set AG2.nTabInstance = 1
				Set AG2.strPrintFileName = 'FIN_AG2'
				Set sSel = 
						"SELECT z.ADAT,
						 z.RNK, z.OKPO,z.NMK, z.SK/100,z.SZ/100,z.FDAT,z.CLASS_R,z.CLASS_B, z.SUM_B,
						 z.Z1 , z.B1 , z.Z2 , z.B2 , z.Z3 , z.B3 , z.Z4 , z.B4 ,
						 z.Z5 , z.B5 , z.Z6 , z.B6 , z.Z7 , z.B7 , z.B8 , z.B9 , 
						 z.Z10, z.B10, z.B11, z.B12, z.B13, z.Z14, z.B14, z.Z15, z.B15, 
						 z.B16, z.B18, z.B19, z.B20, z.B21, z.B22, z.B23, 
						 z.B24, z.B25, z.B26, z.B27,z.B171, z.B172 
						INTO :AG2.ADAT, :AG2.RNK, :AG2.OKPO, :AG2.NMK, :AG2.SK, :AG2.SZ, :AG2.FDAT, 
						     :AG2.CLASS_R, :AG2.CLASS_B, :AG2.SUM_B,
						 :AG2.Z1 ,:AG2.B1 ,:AG2.Z2 ,:AG2.B2 ,:AG2.Z3 ,:AG2.B3 ,:AG2.Z4 ,:AG2.B4 ,
						 :AG2.Z5 ,:AG2.B5 ,:AG2.Z6 ,:AG2.B6 ,:AG2.Z7 ,:AG2.B7 ,:AG2.B8 ,:AG2.B9 ,
						 :AG2.Z10,:AG2.B10,:AG2.B11,:AG2.B12,:AG2.B13,:AG2.Z14,:AG2.B14,:AG2.Z15,:AG2.B15,
						 :AG2.B16,:AG2.B18,:AG2.B19,:AG2.B20,:AG2.B21,:AG2.B22,:AG2.B23,
						 :AG2.B24,:AG2.B25,:AG2.B26,:AG2.B27,:AG2.B171,:AG2.B172 
						FROM FIN_ARCH z, customer  where customer.rnk=z.rnk "
				! Set AG2.strSqlPopulate  = sSel || " and z.adat=:AG2.DAT ORDER BY z.RNK, z.ADAT "
				Set AG2.fFilterAtStart = TRUE
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalWaitCursor( FALSE )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalSetWindowText( hWndForm, 
						"Аналіз КП по ЮО у розрізі фінансового стану позичальника на дату "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy" ) )
				If sFil2 != ""
					If DAT != DATETIME_Null AND ( DAT1 = DATETIME_Null OR DAT != DAT1 )
						! Населяем всегда из архива
						! ! Сначала ищем в архиве и, если нет, копим в архив, населяем 
						If SqlPrepareAndExecute( hSql(), "select 1 from FIN_ARCH where adat=:DAT ")
								and NOT SqlFetchNext(hSql(), nFetchRes) 
							If SqlPLSQLCommand( hSql(), " FIN_2.AG2 ( DAT ) " ) 
									and SqlPrepareAndExecute( hSql(),
									"INSERT INTO FIN_ARCH (ADAT, RNK,OKPO,NMK,SK,SZ,FDAT,CLASS_R,CLASS_B,SUM_B,
									  Z1 , B1 , Z2 ,B2 , Z3 ,  B3 , Z4 , B4 , Z5, B5,  Z6,  B6,
									  Z7 , B7 , Z8 ,B8 , Z9 ,  B9 , Z10, B10, Z11,B11, Z12,
									  B12 ,Z13 ,B13,Z14, B14 , Z15, B15, Z16, B16,Z171,B171,
									  Z172,B172,Z18,B18, Z19,  B19, Z20, B20, Z21,B21,
									  Z22, B22, Z23,B23, Z24,  B24, Z25, B25, Z26,B26, Z27, B27 ) 
									select :DAT, RNK,OKPO,NMK,SK,SZ,FDAT,CLASS_R,CLASS_B,SUM_B,
									  Z1 , B1 , Z2 ,B2 , Z3 ,  B3 , Z4 , B4 , Z5, B5,  Z6,  B6,
									  Z7 , B7 , Z8 ,B8 , Z9 ,  B9 , Z10, B10, Z11,B11, Z12,
									  B12 ,Z13 ,B13,Z14, B14 , Z15, B15, Z16, B16,Z171,B171,
									  Z172,B172,Z18,B18, Z19,  B19, Z20, B20, Z21,B21,
									  Z22, B22, Z23,B23, Z24,  B24, Z25, B25, Z26,B26, Z27, B27 
									from FIN_AG2_TMP")
								Set sSoob = "Выполнено накопление в архив FIN_ARCH за "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy" )
								If SqlCommitEx(hSql(),sSoob )
									Call MessageNoWait( sSoob,'Сообщение',0.1,0)
						! If SqlPrepareAndExecute( hSql(), 
								  "select min(p.USERID), max(p.DAT) into :U_REZ_, :D_REZ_  from REZ_PROTOCOL p  
								   where p.dat <= :DAT and to_char(p.dat,'yyyymm')=to_char(:DAT,'yyyymm')
								     and exists (select 1 from TMP_REZ_RISK where DAT= p.DAT and id=p.USERID)" ) 
								and SqlFetchNext(hSql(), nFetchRes)  
						Set DAT1 = DAT
				!
				If AG2.fFilterAtStart
					Set AG2.fFilterAtStart = NOT AG2.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
					!
				Set sFil1 = ""
				Set sFil1 = cF.GetFilterWhereClause(FALSE)
				Set AG2.strSqlPopulate = sSel || IifS(sFil1 = "",""," and "||sFil1 ) || sFil2 || 
						" ORDER BY z.RNK, z.ADAT desc "
				!
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set nRnk1 = -1
				Call SalTblPopulate(hWndForm, hSql(), AG2.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
				! Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_DoubleClick
				If IsWindow( h_AG3 )
					Call SalDestroyWindow(h_AG3 )
				Set h_AG3 = SalCreateWindow( AG3, hWndMDI, NUMBER_Null, DATETIME_Null, ADAT, RNK, NMK )
				! Set h_AG3 = SalCreateWindow( AG3, hWndMDI, U_REZ_, D_REZ_, ADAT, RNK, NMK )
			On SAM_FetchRowDone
				If CLASS_R = STRING_Null or CLASS_B = STRING_Null OR CLASS_R != CLASS_B
					Call XSalTblSetCellBackColor( CLASS_R, nRed )
					Call XSalTblSetCellBackColor( CLASS_B, nRed )
				If nRnk1 != RNK
					Set nRnk1 = RNK
					Set i = 1 - i
				Call XSalTblSetCellBackColor( RNK, nCol[i] )
				Call XSalTblSetCellBackColor( OKPO, nCol[i] )
				Call XSalTblSetCellBackColor( NMK, nCol[i])
				Call XSalTblSetCellBackColor( ADAT, nCol[i])
	Table Window: AG3
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.433"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.95"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 35471
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.45"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 35472
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 35473
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заборг в ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SKQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заборг в екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резерв в ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SZQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резерв в екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar 
			Date/Time: dPar
			Date/Time: DAT
			Number: RNK
			String: NMK
		Window Variables
			String: sSQL
			Number: nSKQ
			Number: nSZQ
			Number: U_REZ_
			Date/Time: D_REZ_
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				If SqlPrepareAndExecute( hSql(), 
						  "select min(p.USERID), max(p.DAT) into :U_REZ_, :D_REZ_  from REZ_PROTOCOL p  
						   where p.dat <= :DAT and to_char(p.dat,'yyyymm')=to_char(:DAT,'yyyymm')
						     and exists (select 1 from TMP_REZ_RISK where DAT= p.DAT and id=p.USERID)" ) 
						and SqlFetchNext(hSql(), nFetchRes)  
				Call SalSetWindowText( hWndForm, 
						"Детально про Суму кред.зоб. та Суму резерву "|| NMK || " на дату "|| SalFmtFormatDateTime( DAT, "dd/MM/yyyy" ) )
				Set AG3.sSQL  = "
						SELECT a.NLS, a.KV, t.sz/100, t.SZQ /100,
						 -(s.ostf-s.dos+s.kos)/100,
						 -gl.p_icurval(a.kv,(s.ostf-s.dos+s.kos),:DAT)/100
						INTO :NLS, :KV, :SZ, :SZQ, :SK, :SKQ
						 from accounts a, saldoa s,  KL_R020 k,
						      (select acc,SZ, SZQ from TMP_REZ_RISK where id=:U_REZ_ and dat=:D_REZ_) t      
						 where a.acc = t.acc(+)  AND k.prem='КБ' AND k.f_11='1' and a.nbs = k.r020
						  and a.rnk=:RNK  and (s.ostf-s.dos+s.kos) <0 
						  and a.acc=s.acc and (s.acc,s.fdat)=
						     (select acc,max(fdat) from saldoa where acc=s.acc and fdat<=:DAT group by acc)"
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 2)
				! Set AG3.nTabInstance = 1
				Set AG3.strPrintFileName = 'FIN_AG3'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set nSKQ =0 
				Set nSZQ =0 
				Call SalTblPopulate(hWndForm, hSql(), AG3.sSQL, TBL_FillAll )
				Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
				Set NLS = 'Разом в екв'
				Set SKQ = nSKQ
				Set SZQ = nSZQ
				Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_New, FALSE)
				!
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set nSKQ = nSKQ + SKQ
				If nSZQ != NUMBER_Null
					Set nSZQ = nSZQ + SZQ
