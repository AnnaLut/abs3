/*
    AUTOGENERATED! Do not modify this code.
*/

using System;
using System.Collections;
using System.Collections.Generic;
using System.Text;
using System.Collections.Specialized;
using System.Data;
using System.Web.Configuration;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;
using ibank.core;

namespace Bars.ObjLayer.CbiRep
{
    public partial class VCbirepReplist
    {
        public Boolean CheckAccess(Decimal? REP_ID)
        {
            this.Filter.REP_ID.Equal(REP_ID);
            return Select().Count > 0;
        }
        public VCbirepReplistRecord SelectCbirepRep(Decimal? REP_ID)
        {
            this.Filter.REP_ID.Equal(REP_ID);
            return this.Select()[0];
        }
        public List<VCbirepReplistRecord> SelectCbirepReplist(String CODEAPP, String FOLDER_ID, Decimal? REP_ID, String REP_DESC, String SortExpression, int maximumRows, int startRowIndex)
        {
            this.Filter.CODEAPP.Equal(CODEAPP);

            if (!String.IsNullOrEmpty(FOLDER_ID))
                this.Filter.FOLDER_ID.Equal(Convert.ToDecimal(FOLDER_ID));
            if (REP_ID.HasValue)
                this.Filter.REP_ID.Equal(REP_ID);
            if (!String.IsNullOrEmpty(REP_DESC))
                this.Filter.REP_DESC.LikeBoth(REP_DESC.Trim().ToUpper(), CaseFlags.UpperCase);

            // первоначальная сортировка по REP_ID
            return this.Select(String.IsNullOrEmpty(SortExpression) ? "REP_ID" : SortExpression, (maximumRows == 0 ? -1 : maximumRows), startRowIndex);
        }
    }
}