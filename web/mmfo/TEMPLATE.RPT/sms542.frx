<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="01/27/2014 08:49:30" ReportInfo.Modified="01/12/2018 15:13:12" ReportInfo.CreatorVersion="2014.1.2.0">
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqJOsxPO45Mfc7mc0tWCiv9R+LArR6Vu/4+69t/DeoCTtsqLdccDxV87RKeUsHcRjgYr795hadhInLMaY6veeysw==" CommandTimeout="500">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="  SELECT ac.kf, &#13;&#10;         ac.branch,&#13;&#10;         ac.kv,&#13;&#10;         c.nmk,&#13;&#10;         substr(m.phone,4,3)||'XXXXX'|| substr(m.phone,6,2) phone,&#13;&#10;         c.rnk,&#13;&#10;         c.OKPO,&#13;&#10;         ac.nls,&#13;&#10;         CASE&#13;&#10;            WHEN m.status = 'SUBMITTED'&#13;&#10;            THEN 'Надіслано'&#13;&#10;            WHEN m.status = 'EXPIRED'&#13;&#10;            THEN 'Закінчився термін дії'&#13;&#10;            WHEN m.status = 'ERROR'&#13;&#10;            THEN 'Помилкових'&#13;&#10;         END status,&#13;&#10;         COUNT (*)&#13;&#10;    FROM bars.acc_msg a,&#13;&#10;         bars.accounts ac,&#13;&#10;         bars.msg_submit_data m,&#13;&#10;         bars.customer c&#13;&#10;   WHERE     m.msg_id = a.msg_id&#13;&#10;         AND ac.acc = a.acc&#13;&#10;         -- and change_time between  to_date('01/01/2015_00:00','DD/MM/YYYY_HH24:MI')  AND to_date('31/03/2015_23:59','DD/MM/YYYY_HH24:MI')&#13;&#10;         AND change_time BETWEEN :Dat1 AND :Dat2 + 1&#13;&#10;         AND ac.rnk = c.rnk&#13;&#10;         AND ac.branch LIKE DECODE ( :branch, '%', ac.branch, NULL, ac.branch, :branch) || '%'&#13;&#10;         AND c.rnk = DECODE ( :rnk,  '%', c.rnk,  NULL, c.rnk,  :rnk)&#13;&#10;         AND c.custtype = DECODE ( :ctype, '%', c.custtype, NULL, c.custtype, 4, 3, :ctype)&#13;&#10;         AND c.sed = DECODE ( :ctype, 4, 91, c.sed)&#13;&#10;GROUP BY ac.nls,&#13;&#10;         c.rnk,&#13;&#10;         ac.branch,&#13;&#10;         c.OKPO,&#13;&#10;         ac.kv,&#13;&#10;         status,&#13;&#10;         m.phone,&#13;&#10;         c.nmk,ac.kf&#13;&#10;ORDER BY 6&#13;&#10;&#13;&#10;">
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="NMK" DataType="System.String"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="NLS" DataType="System.String"/>
        <Column Name="KV" DataType="System.Decimal"/>
        <Column Name="PHONE" DataType="System.String"/>
        <Column Name="STATUS" DataType="System.String"/>
        <Column Name="COUNT(*)" DataType="System.Decimal"/>
        <Column Name="BRANCH" DataType="System.String"/>
        <Column Name="KF" DataType="System.String"/>
        <CommandParameter Name="rnk" DataType="126" Expression="[rnk]"/>
        <CommandParameter Name="rnk" DataType="126" Expression="[rnk]"/>
        <CommandParameter Name="branch" DataType="126" Expression="[branch]"/>
        <CommandParameter Name="branch" DataType="126" Expression="[branch]"/>
        <CommandParameter Name="rnk" DataType="126" Expression="[rnk]"/>
        <CommandParameter Name="branch" DataType="126" Expression="[branch]"/>
        <CommandParameter Name="dat1" DataType="106" Expression="[sFdat1]" DefaultValue="01.01.2015"/>
        <CommandParameter Name="dat2" DataType="106" Expression="[sFdat2]" DefaultValue="30.01.2015"/>
        <CommandParameter Name="ctype" DataType="126" Expression="[ctype]" DefaultValue="%"/>
      </TableDataSource>
      <TableDataSource Name="Table2" DataType="System.Int32" Enabled="true" SelectCommand="select &#13;&#10;    case when :ctype='%' or :ctype is null then &#13;&#10;              (select 'ВСІ' as name from dual)&#13;&#10;         else &#13;&#10;              (select name from bars.custt where custtype=:ctype)&#13;&#10;    end as name&#13;&#10;from dual   ">
        <Column Name="NAME" DataType="System.String"/>
        <CommandParameter Name="ctype" DataType="126" Expression="[ctype]" DefaultValue="%"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="sFdat1" DataType="System.DateTime" Expression="ToDateTime(&quot;01/12/2014&quot;)"/>
    <Parameter Name="sFdat2" DataType="System.DateTime" Expression="ToDateTime(&quot;31/12/2014&quot;)"/>
    <Parameter Name="rnk" DataType="System.String"/>
    <Parameter Name="branch" DataType="System.String"/>
    <Parameter Name="ctype" DataType="System.Int32" Expression="2"/>
    <Total Name="Total" Expression="[Table.STATUS]" Evaluator="Data3"/>
    <Total Name="Total1" Expression="[Table.COUNT(*)]" Evaluator="Data3" PrintOn="GroupFooter12"/>
    <Total Name="T_Branch" Expression="[Table.COUNT(*)]" Evaluator="Data3" PrintOn="GroupFooter10"/>
    <Total Name="T_RNK" Expression="[Table.COUNT(*)]" Evaluator="Data3" PrintOn="GroupFooter11"/>
  </Dictionary>
  <ReportPage Name="Page3">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="75.6">
      <TextObject Name="Text3" Left="9.45" Width="548.1" Height="56.7" Text="Звіт про кількість надісланих смс повідомлень&#13;&#10;за період [sFdat1]р. по [sFdat2]р.&#13;&#10;тип клієнта: [Table2.NAME]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt, style=Bold">
        <Formats>
          <DateFormat/>
          <DateFormat/>
        </Formats>
      </TextObject>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader10" Top="78.8" Width="718.2" Height="30.24" KeepWithData="true" RepeatOnEveryPage="true" Condition="[Table.KF]">
      <TextObject Name="Text12" Left="11.34" Top="11.34" Width="453.6" Height="18.9" Text="[Table.KF]" Font="Times New Roman, 10pt"/>
      <ChildBand Name="Child1" Top="112.24" Width="718.2" Height="37.8">
        <TextObject Name="Text11" Left="7.56" Top="1.89" Width="94.5" Height="18.9" Text="Відділення:" Font="Times New Roman, 10pt"/>
        <TextObject Name="Text10" Left="102.06" Top="1.89" Width="453.6" Height="18.9" Text="[Table.BRANCH]" Font="Times New Roman, 10pt"/>
        <TableObject Name="Table1" Left="9.45" Top="18.9" Width="549.99" Height="18.9">
          <TableColumn Name="Column53" Width="105.84"/>
          <TableColumn Name="Column54" Width="340.2"/>
          <TableColumn Name="Column55" Width="103.95"/>
          <TableRow Name="Row11">
            <TableCell Name="Cell53" Border.Lines="All" Text="РНК" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell54" Border.Lines="All" Text="Назва клієнта" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell55" Border.Lines="All" Text="ОКПО" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          </TableRow>
        </TableObject>
      </ChildBand>
      <GroupHeaderBand Name="GroupHeader11" Top="153.24" Width="718.2" Height="94.5" CanGrow="true" CanShrink="true" Guides="0,66.15,66.15" Condition="[Table.RNK]" SortOrder="Descending">
        <TableObject Name="Table1" Left="9.45" Top="56.7" Width="549.99" Height="37.8">
          <TableColumn Name="Column59" Width="105.84"/>
          <TableColumn Name="Column60" Width="94.5"/>
          <TableColumn Name="Column61" Width="103.95"/>
          <TableColumn Name="Column62" Width="141.75"/>
          <TableColumn Name="Column63" Width="103.95"/>
          <TableRow Name="Row13" Height="37.8" AutoSize="true">
            <TableCell Name="Cell59" Border.Lines="All" Text="Рахунок" Padding="2, 0, 2, 0" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell60" Border.Lines="All" Text="Валюта" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell61" Border.Lines="All" Text="Номер&#13;&#10;телефону" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell62" Border.Lines="All" Text="Статус&#13;&#10;повідомлення" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell63" Border.Lines="All" Text="Кількість&#13;&#10;повідомлень" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          </TableRow>
        </TableObject>
        <TableObject Name="Table3" Left="9.45" Width="549.99" Height="56.7">
          <TableColumn Name="Column84" Width="105.84"/>
          <TableColumn Name="Column85" Width="94.5"/>
          <TableColumn Name="Column86" Width="103.95"/>
          <TableColumn Name="Column87" Width="141.75"/>
          <TableColumn Name="Column88" Width="103.95"/>
          <TableRow Name="Row18" Height="56.7" AutoSize="true">
            <TableCell Name="Cell84" Border.Lines="All" Text="[Table.RNK]" Padding="2, 0, 2, 0" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell85" Border.Lines="All" Text="[Table.NMK]" HorzAlign="Center" VertAlign="Center" WordWrap="false" Font="Times New Roman, 10pt, style=Bold" ColSpan="3"/>
            <TableCell Name="Cell86" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell87" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell88" Border.Lines="All" Text="[Table.OKPO]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          </TableRow>
        </TableObject>
        <GroupHeaderBand Name="GroupHeader12" Top="250.94" Width="718.2" Condition="[Table.STATUS]">
          <DataBand Name="Data3" Top="254.14" Width="718.2" Height="18.9" CanGrow="true" CanShrink="true" DataSource="Table">
            <TableObject Name="Table1" Left="9.45" Width="549.99" Height="18.9" GrowToBottom="true">
              <TableColumn Name="Column64" Width="105.84"/>
              <TableColumn Name="Column65" Width="94.5"/>
              <TableColumn Name="Column66" Width="103.95"/>
              <TableColumn Name="Column67" Width="141.75"/>
              <TableColumn Name="Column68" Width="103.95"/>
              <TableRow Name="Row14" AutoSize="true">
                <TableCell Name="Cell64" Border.Lines="All" Text="[Table.NLS]" Padding="2, 0, 2, 0" VertAlign="Center" Font="Times New Roman, 10pt"/>
                <TableCell Name="Cell65" Border.Lines="All" Text="[Table.KV]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
                <TableCell Name="Cell66" Border.Lines="All" Text="[Table.PHONE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
                <TableCell Name="Cell67" Border.Lines="All" Text="[Table.STATUS]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
                <TableCell Name="Cell68" Border.Lines="All" Text="[Table.COUNT(*)]" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 10pt"/>
              </TableRow>
            </TableObject>
          </DataBand>
          <GroupFooterBand Name="GroupFooter12" Top="276.24" Width="718.2" Height="18.9" CanGrow="true" CanShrink="true" KeepWithData="true">
            <TableObject Name="Table1" Left="9.45" Width="549.99" Height="18.9">
              <TableColumn Name="Column69" Width="105.84"/>
              <TableColumn Name="Column70" Width="94.5"/>
              <TableColumn Name="Column71" Width="103.95"/>
              <TableColumn Name="Column72" Width="141.75"/>
              <TableColumn Name="Column73" Width="103.95"/>
              <TableRow Name="Row15">
                <TableCell Name="Cell69" Border.Lines="All" Text="Всього по &quot;[Table.STATUS]&quot; :" VertAlign="Bottom" Font="Times New Roman, 10pt, style=Bold" ColSpan="4"/>
                <TableCell Name="Cell70" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
                <TableCell Name="Cell71" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
                <TableCell Name="Cell72" Border.Lines="All" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
                <TableCell Name="Cell73" Border.Lines="All" Text="[Total1]" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
              </TableRow>
            </TableObject>
          </GroupFooterBand>
        </GroupHeaderBand>
        <GroupFooterBand Name="GroupFooter11" Top="298.34" Width="718.2" Height="28.35" CanGrow="true" CanShrink="true">
          <TableObject Name="Table1" Left="9.45" Width="549.99" Height="18.9">
            <TableColumn Name="Column79" Width="105.84"/>
            <TableColumn Name="Column80" Width="94.5"/>
            <TableColumn Name="Column81" Width="103.95"/>
            <TableColumn Name="Column82" Width="141.75"/>
            <TableColumn Name="Column83" Width="103.95"/>
            <TableRow Name="Row17">
              <TableCell Name="Cell79" Border.Lines="All" Text="Всього по клієнту:" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold" ColSpan="4"/>
              <TableCell Name="Cell80" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
              <TableCell Name="Cell81" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
              <TableCell Name="Cell82" Border.Lines="All" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
              <TableCell Name="Cell83" Border.Lines="All" Text="[T_RNK]" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            </TableRow>
          </TableObject>
        </GroupFooterBand>
      </GroupHeaderBand>
      <GroupFooterBand Name="GroupFooter10" Top="329.89" Width="718.2" Height="43.47" CanGrow="true" CanShrink="true">
        <TableObject Name="Table1" Left="9.45" Top="18.9" Width="549.99" Height="18.9">
          <TableColumn Name="Column74" Width="105.84"/>
          <TableColumn Name="Column75" Width="94.5"/>
          <TableColumn Name="Column76" Width="103.95"/>
          <TableColumn Name="Column77" Width="141.75"/>
          <TableColumn Name="Column78" Width="103.95"/>
          <TableRow Name="Row16">
            <TableCell Name="Cell74" Border.Lines="All" Text="Всього по відділеню:" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold" ColSpan="4"/>
            <TableCell Name="Cell75" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell76" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell77" Border.Lines="All" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell78" Border.Lines="All" Text="[T_Branch]" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          </TableRow>
        </TableObject>
      </GroupFooterBand>
    </GroupHeaderBand>
  </ReportPage>
</Report>
