<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="12/06/2015 18:16:55" ReportInfo.Modified="01/13/2016 16:25:23" ReportInfo.CreatorVersion="2014.1.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    public String PERIOD
    {
      get 
      {
        DateTime DateFrom = Convert.ToDateTime((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;));
        DateTime DateTo = Convert.ToDateTime((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;));

        // Difference in days, hours, and minutes.
        TimeSpan ts = DateTo - DateFrom;

        // Difference in days.
        int differenceInDays = ts.Days;
        
        if (differenceInDays == 0)
        {
          return (&quot;Виписка за: &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)));
        }
        else
        {
          return (&quot;Виписка за період: &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)).ToString(&quot;dd/MM/yyyy&quot;, new System.Globalization.CultureInfo(&quot;UK-ua&quot;)) + &quot; по &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;)).ToString(&quot;dd/MM/yyyy&quot;, new System.Globalization.CultureInfo(&quot;UK-ua&quot;)));
        }
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="Connection" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoXawgQMNksAJZokM+/w71Mdp8ugUsrBVKBM5QPN21u5Dg==">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select CHAR00 FIO, CHAR01 SRT, NUM00 DKSRT, NUM01 VOBSRT, CHAR02 NMK, CHAR03 OKPO, NUM02 ACC, CHAR04 NLS, NUM03 KV, CHAR05 LCV, DAT00 FDAT, DAT01 DAPP, NUM04 OSTF, CHAR06 NMS, NUM05 S, NUM06 SQ, NUM07 DOSS, NUM08 KOSS, CHAR07 ND, CHAR08 MFO, CHAR09 NB, CHAR10 MFO2, CHAR11 NB2, CHAR12 NLS2, CHAR13 NMK2, CHAR14 OKPO2, CHAR15 NAZN, NUM09 BIS, NUM10 DK, CHAR16 TT, NUM11 ISP, NUM12 REF from rs_tmp_report_data where session_id=:SESSION_ID order by id">
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="SRT" DataType="System.String"/>
        <Column Name="DKSRT" DataType="System.Decimal"/>
        <Column Name="VOBSRT" DataType="System.Decimal"/>
        <Column Name="NMK" DataType="System.String"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="ACC" DataType="System.Decimal"/>
        <Column Name="NLS" DataType="System.String"/>
        <Column Name="KV" DataType="System.Decimal"/>
        <Column Name="LCV" DataType="System.String"/>
        <Column Name="FDAT" DataType="System.DateTime"/>
        <Column Name="DAPP" DataType="System.DateTime"/>
        <Column Name="OSTF" DataType="System.Decimal"/>
        <Column Name="NMS" DataType="System.String"/>
        <Column Name="S" DataType="System.Decimal"/>
        <Column Name="SQ" DataType="System.Decimal"/>
        <Column Name="DOSS" DataType="System.Decimal"/>
        <Column Name="KOSS" DataType="System.Decimal"/>
        <Column Name="ND" DataType="System.String"/>
        <Column Name="MFO" DataType="System.String"/>
        <Column Name="NB" DataType="System.String"/>
        <Column Name="MFO2" DataType="System.String"/>
        <Column Name="NB2" DataType="System.String"/>
        <Column Name="NLS2" DataType="System.String"/>
        <Column Name="NMK2" DataType="System.String"/>
        <Column Name="OKPO2" DataType="System.String"/>
        <Column Name="NAZN" DataType="System.String"/>
        <Column Name="BIS" DataType="System.Decimal"/>
        <Column Name="DK" DataType="System.Decimal"/>
        <Column Name="TT" DataType="System.String"/>
        <Column Name="ISP" DataType="System.Decimal"/>
        <Column Name="REF" DataType="System.Decimal"/>
        <CommandParameter Name="session_id" DataType="112" Expression="[session_id]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table3" Alias="Header" DataType="System.Int32" Enabled="true" SelectCommand="SELECT (SELECT fio&#13;&#10;          FROM staff$base&#13;&#10;         WHERE id = :user_id)&#13;&#10;          user_fio&#13;&#10;  FROM DUAL">
        <Column Name="USER_FIO" DataType="System.String"/>
        <CommandParameter Name="user_id" DataType="126" Expression="[user_id]"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="session_id" DataType="System.Int32"/>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
    <Parameter Name="user_id" DataType="System.String"/>
    <Total Name="Total_Debit_by_Period" Expression="[Table.S]" Evaluator="Data1" PrintOn="GroupFooter1" ResetOnReprint="true" EvaluateCondition="[Table.DK] == 0"/>
    <Total Name="Total_Crebit_by_Period" Expression="[Table.S]" Evaluator="Data1" PrintOn="GroupFooter1" ResetOnReprint="true" EvaluateCondition="[Table.DK] == 1"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="376.5" PaperHeight="210" FirstPageSource="15" OtherPagesSource="15">
    <GroupHeaderBand Name="GroupHeader1" Top="20" Width="1347.57" Height="179.55" Border.Lines="Top" Condition="[Table.ACC]">
      <TextObject Name="Text4" Width="1341.9" Height="132.3" Text="Назва клієнта: [Table.NMK]&#13;&#10;Код клієнта: [Table.OKPO]&#13;&#10;Назва банку: [Table.NB]&#13;&#10;МФО банку:[Table.MFO] &#13;&#10;Рахунок клієнта: [Table.NLS] ([Table.LCV]) [Table.NMS]&#13;&#10;[PERIOD]&#13;&#10;Дата останнього руху коштів: [Table.DAPP]&#13;&#10;Початковий залишок коштів на [sFdat1]: [Abs([Table.OSTF])] [Switch([Table.OSTF] &lt; 0, &quot;Дб&quot;, [Table.OSTF] &gt; 0, &quot;Кр&quot;)]">
        <Formats>
          <DateFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <DateFormat/>
          <DateFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </TextObject>
      <TableObject Name="Table1" Top="132.3" Width="1343.79" Height="47.25" Border.Lines="Top, Bottom">
        <TableColumn Name="Column1" Width="47.25"/>
        <TableColumn Name="Column2" Width="85.05"/>
        <TableColumn Name="Column23" Width="85.05"/>
        <TableColumn Name="Column3" Width="132.3"/>
        <TableColumn Name="Column4" Width="132.3"/>
        <TableColumn Name="Column13" Width="189"/>
        <TableColumn Name="Column15" Width="103.95"/>
        <TableColumn Name="Column16" Width="105.84"/>
        <TableColumn Name="Column11" Width="463.05"/>
        <TableRow Name="Row1" Height="47.25">
          <TableCell Name="Cell1" Border.Lines="Left, Right" Text="№ п/п" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell2" Border.Lines="Right" Text="№ док-та" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell33" Border.Lines="Right" Text="Дата складання " HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell3" Border.Lines="Right" Text="ДТ рахунку" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell4" Border.Lines="Right" Text="КТ рахунку" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell18" Border.Lines="Right" Text="Назва контрагента" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell20" Border.Lines="Right" Text="Код контрангента" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell21" Border.Lines="Right" Text="Рахунок&#13;&#10;контрагента" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell16" Border.Lines="Right" Text="Призначення платежу" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
        </TableRow>
      </TableObject>
      <DataBand Name="Data1" Top="219.55" Width="1347.57" Height="18.9" CanGrow="true" DataSource="Table">
        <TableObject Name="Table2" Width="1343.79" Height="18.9" GrowToBottom="true">
          <TableColumn Name="Column6" Width="47.25"/>
          <TableColumn Name="Column7" Width="85.05"/>
          <TableColumn Name="Column24" Width="85.05"/>
          <TableColumn Name="Column8" Width="132.3"/>
          <TableColumn Name="Column9" Width="132.3"/>
          <TableColumn Name="Column14" Width="189"/>
          <TableColumn Name="Column17" Width="103.95"/>
          <TableColumn Name="Column18" Width="105.84"/>
          <TableColumn Name="Column12" Width="463.05"/>
          <TableRow Name="Row2" AutoSize="true">
            <TableCell Name="Cell6" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text=" [Row#]" Padding="0, 1, 0, 1" VertAlign="Center"/>
            <TableCell Name="Cell7" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[Table.ND]" VertAlign="Center"/>
            <TableCell Name="Cell34" Border.Lines="Bottom" Border.Style="Dash" Text="[Table.FDAT]" Format="Date" Format.Format="d" HorzAlign="Center" VertAlign="Center"/>
            <TableCell Name="Cell8" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[IIf([Table.DOSS] == 0, &quot;&quot;, -1 * [Table.DOSS])]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell9" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[IIf([Table.KOSS] == 0 , &quot;&quot;, [Table.KOSS])]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell19" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[Table.NMK2]" VertAlign="Center"/>
            <TableCell Name="Cell22" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[Table.OKPO2]" HorzAlign="Center" VertAlign="Center"/>
            <TableCell Name="Cell23" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[Table.NLS2]" VertAlign="Center"/>
            <TableCell Name="Cell17" Border.Lines="Left, Right, Bottom" Border.Style="Dash" Text="[Table.NAZN]" VertAlign="Center"/>
          </TableRow>
        </TableObject>
        <Sort>
          <Sort Expression="[Table.DK]"/>
          <Sort Expression="[Table.FDAT]"/>
        </Sort>
      </DataBand>
      <GroupFooterBand Name="GroupFooter1" Top="258.45" Width="1347.57" Height="47.25">
        <TableObject Name="Table4" Width="417.69" Height="47.25">
          <TableColumn Name="Column19" Width="64.26"/>
          <TableColumn Name="Column20" Width="73.71"/>
          <TableColumn Name="Column21" Width="130.41"/>
          <TableColumn Name="Column22" Width="149.31"/>
          <TableRow Name="Row3" Height="28.35">
            <TableCell Name="Cell24" Text="Оборотів за період:" VertAlign="Bottom" ColSpan="2"/>
            <TableCell Name="Cell25" VertAlign="Bottom"/>
            <TableCell Name="Cell26" Text="[-1 * [Total_Debit_by_Period]]" Format="Number" Format.UseLocale="true" VertAlign="Bottom"/>
            <TableCell Name="Cell27" Text="[Total_Crebit_by_Period]" VertAlign="Bottom"/>
          </TableRow>
          <TableRow Name="Row4">
            <TableCell Name="Cell29" Text="Вихідний залишок на [sFdat2]:" Format="Date" Format.Format="d" ColSpan="3"/>
            <TableCell Name="Cell30"/>
            <TableCell Name="Cell31"/>
            <TableCell Name="Cell32" Text="[Abs(ToDecimal([Table.OSTF] + [Total_Debit_by_Period] + [Total_Crebit_by_Period]))] [Switch([Table.OSTF] + [Total_Debit_by_Period] + [Total_Crebit_by_Period] &lt; 0, &quot;Дб&quot;, [Table.OSTF] + [Total_Debit_by_Period] + [Total_Crebit_by_Period] &gt; 0, &quot;Кр&quot;)]"/>
          </TableRow>
        </TableObject>
      </GroupFooterBand>
    </GroupHeaderBand>
  </ReportPage>
</Report>
