<?xml version="1.0" encoding="utf-8" ?>
<xmlform caption="Коди класифікатора послуг" captiontype="OnlyTitle">
  <grids>
    <grid id="gv" pagesize="10" showpagesizebox="true" title="Коди класифікатора послуг">
      <datasource>
        <sql>
          select * from cim_ape_servicecode order by CODE_ID
        </sql>
      </datasource>
      <editform style="Dialog" title="Редагування типу"  width="800" height="350" >
        <buttons defaulttype="Link">
          <button id="cmdInsert" caption="Додати рядок|Зберегти|Вiдмiнити" hint="Додати рядок|Зберегти рядок|Вiдмiнити додавання">
            <command type="Insert" successmessage="Дані збережено">
               <sql>insert into cim_ape_servicecode(CODE_ID, CODE_NAME, delete_date) values(:CODE_ID, :CODE_NAME, :DELETE_DATE)</sql>
              <parameters>
                <parameter type="DataField" name="CODE_ID" />
                <parameter type="DataField" name="CODE_NAME" />
                <parameter type="DataField" name="DELETE_DATE" />
              </parameters>
            </command>
          </button>
          <button id="cmdEdit" caption="Редагувати|Зберегти|Вiдмiнити" hint="Редагувати|Зберегти|Вiдмiнити">
            <command type="Edit">
              <sql>update cim_ape_servicecode set CODE_NAME=:CODE_NAME, DELETE_DATE=:DELETE_DATE where CODE_ID =:CODE_ID</sql>
              <parameters>
                <parameter type="DataField" name="CODE_NAME" />
                <parameter type="DataField" name="DELETE_DATE" />
                <parameter type="DataField" name="CODE_ID" />
              </parameters>
            </command>
          </button>
          <button id="cmdDel" caption="Видалити" hint="Видалити" confirmmessage="Ви дійсно хочете видалити класифікатор ?">
            <command type="Delete">
              <sql> begin 
              		 begin 
                      delete from cim_ape_servicecode where CODE_ID =:CODE_ID;
                     exception when others then  
                     	update cim_ape_servicecode set DELETE_DATE=sysdate where CODE_ID =:CODE_ID; 
                     end;	
                    end; </sql>
              <parameters>
                <parameter type="DataField" name="CODE_ID" />
              </parameters>
            </command>
          </button>
          <button id="cmdClose" caption="Закрити" hint="Закрити форму">
            <command type="Close"/>
          </button>
        </buttons>
      </editform>
      <fields>
        <field datatype="String" name="CODE_ID" key="true" >
          <column show="true" caption="Код" />
          <form rwmode="RW" required="true">
            <uicontrol></uicontrol>
          </form>
        </field>
        <field datatype="String" name="CODE_NAME">
          <column show="true" align="Left" caption="Назва" />
          <form rwmode="RW" required="true">
            <uicontrol controlwidth="650" linescount="6"></uicontrol>
          </form>
        </field>
        <field datatype="DateTime" name="delete_date">
          <column show="true" align="Center" caption="Дата видалення" formatstring="{0:dd.MM.yyyy}" />
          <form rwmode="RW">
            <uicontrol controlwidth="70"></uicontrol>
          </form>
        </field>
      </fields>
      <rowselection method="SingleRow" />
    </grid>
  </grids>
</xmlform>