<?xml version="1.0" encoding="utf-8" ?>
<xmlform caption="Типи ліцензій мінекономіки" captiontype="OnlyTitle">
  <grids>
    <grid id="gv" pagesize="10" showpagesizebox="true" title="Типи ліцензій мінекономіки">
      <datasource>
        <sql>
          select * from cim_license_type order by type_id
        </sql>
      </datasource>
      <editform style="Dialog" title="Редагування типу"  width="550" height="180" >
        <buttons defaulttype="Link">
          <button id="cmdInsert" caption="Додати рядок|Зберегти|Вiдмiнити" hint="Додати рядок|Зберегти рядок|Вiдмiнити додавання">
            <command type="Insert" successmessage="Дані збережено">
               <sql>insert into cim_license_type(type_id, type_name, delete_date) values(:TYPE_ID, :TYPE_NAME, :DELETE_DATE)</sql>
              <parameters>
                <parameter type="DataField" name="TYPE_ID" />
                <parameter type="DataField" name="TYPE_NAME" />
                <parameter type="DataField" name="DELETE_DATE" />
              </parameters>
            </command>
          </button>
          <button id="cmdEdit" caption="Редагувати|Зберегти|Вiдмiнити" hint="Редагувати|Зберегти|Вiдмiнити">
            <command type="Edit">
              <sql>update cim_license_type set TYPE_NAME=:TYPE_NAME, DELETE_DATE=:DELETE_DATE where TYPE_ID =:TYPE_ID</sql>
              <parameters>
                <parameter type="DataField" name="TYPE_NAME" />
                <parameter type="DataField" name="DELETE_DATE" />
                <parameter type="DataField" name="TYPE_ID" />
              </parameters>
            </command>
          </button>
          <button id="cmdDel" caption="Видалити" hint="Видалити" confirmmessage="Ви дійсно хочете видалити тип ?">
            <command type="Delete">
              <sql> begin 
              		 begin 
                      delete from cim_license_type where TYPE_ID =:TYPE_ID;
                     exception when others then  
                     	update cim_license_type set DELETE_DATE=sysdate where TYPE_ID =:TYPE_ID; 
                     end;	
                    end; </sql>
              <parameters>
                <parameter type="DataField" name="TYPE_ID" />
              </parameters>
            </command>
          </button>
          <button id="cmdClose" caption="Закрити" hint="Закрити форму">
            <command type="Close"/>
          </button>
        </buttons>
      </editform>
      <fields>
        <field datatype="Int64" name="TYPE_ID" key="true" >
          <column show="true" caption="Код" />
          <form rwmode="RW" required="true">
            <uicontrol></uicontrol>
          </form>
        </field>
        <field datatype="String" size="256" name="TYPE_NAME">
          <column show="true" align="Left" caption="Назва" />
          <form rwmode="RW" required="true">
            <uicontrol controlwidth="400" linescount="2"></uicontrol>
          </form>
        </field>
        <field datatype="DateTime" name="delete_date">
          <column show="true" align="Center" caption="Дата видалення" formatstring="{0:dd.MM.yyyy}" />
          <form rwmode="RW">
            <uicontrol controlwidth="70"></uicontrol>
          </form>
        </field>
      </fields>
      <rowselection method="SingleRow" />
    </grid>
  </grids>
</xmlform>