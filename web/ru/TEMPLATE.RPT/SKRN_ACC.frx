<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" UseFileCache="true" StartReportEvent="_StartReport" ReportInfo.Created="06/24/2014 16:54:08" ReportInfo.Modified="12/21/2017 17:40:06" ReportInfo.CreatorVersion="2014.1.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using System.Data.Sql;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;


namespace FastReport
{
  public class ReportScript
  {
    
    public string TicDoc_attr(string Var)
    {
      // Обработка параметрів
      Parameter p_nd = Report.GetParameter(&quot;p_nd&quot;);
      String p_value1 = &quot;&quot;;
      String p_value2 = &quot;&quot;;
      String p_value3 = &quot;&quot;;

      OracleDataConnection frxcon = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection con = (OracleConnection)frxcon.GetConnection();
      OracleCommand cmd = con.CreateCommand();
      
      cmd.CommandType = CommandType.StoredProcedure;
      cmd.CommandText = &quot;cc_doc_get_var_value2&quot;;
         
      cmd.Parameters.Add(&quot;p_tag&quot;,     OracleDbType.Varchar2, Var,           ParameterDirection.Input);       //0
      cmd.Parameters.Add(&quot;p_dealnum&quot;, OracleDbType.Decimal, p_nd.Value,     ParameterDirection.Input);       //1
      cmd.Parameters.Add(&quot;p_agrmnum&quot;, OracleDbType.Decimal, 0,             ParameterDirection.Input);        //2
      cmd.Parameters.Add(&quot;p_value1&quot;, OracleDbType.Varchar2, 2000, p_value1, ParameterDirection.InputOutput); //3
      cmd.Parameters.Add(&quot;p_value2&quot;, OracleDbType.Varchar2, 2000, p_value2, ParameterDirection.InputOutput); //4
      cmd.Parameters.Add(&quot;p_value3&quot;, OracleDbType.Varchar2, 2000, p_value3, ParameterDirection.InputOutput); //5
                                 
      con.Open();
      try
      {
        cmd.ExecuteNonQuery();
        
        p_value1 = cmd.Parameters[&quot;p_value1&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value2&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value3&quot;].Value.ToString();

      }
      finally
      {
        con.Close();
      }
      
      return   p_value1;
      
    }
    
    
    // Получение значения параметра тикета
    public string GetVal(string Var)
    {
      try
      {
        string p_val = TicDoc_attr(Var);
        
        if (!String.IsNullOrEmpty(p_val) &amp;&amp; p_val != &quot;null&quot;)
          return p_val;
        else 
          return &quot;&quot;;
      }
      catch (Exception) {  return &quot;&quot;; }
    }  
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="Connection" ConnectionString="rijcmlqIEnsMSbpo3gQbTFwv+dS5Y3Neg7DvdR2Vu1DbZYHDJIJHEDEQst4kKpqTLmpSao9Fh7KdSnx2Iv4GEv1AmBOyVEcJbxOcOJim+pPvGgzlCc=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select f_ourokpo() as ourokpo  from dual">
        <Column Name="OUROKPO" DataType="System.String"/>
      </TableDataSource>
      <TableDataSource Name="Table4" Alias="tariff" DataType="System.Int32" Enabled="true" SelectCommand="select t.name,  daysfrom, daysto, t2.s as sump,t.s  , s.nd, decode(t2.s,S.SD/100,1,0) as t&#13;&#10;  from skrynka_tip t, skrynka_tariff tf, skrynka_tariff2 t2 , skrynka_nd s &#13;&#10;  where t.o_sk = tf.o_sk&#13;&#10;    and TF.TARIFF = T2.TARIFF&#13;&#10;    and (t2.tariff, t2.tariff_date)&#13;&#10;       in  ( select tariff, max(tariff_date)&#13;&#10;               from skrynka_tariff2&#13;&#10;              where tariff_date &lt;= S.DAT_BEGIN and tariff = t2.tariff group by tariff )&#13;&#10;     and S.ND = :nd&#13;&#10;     and S.TARIFF = T2.TARIFF&#13;&#10;  Order by T.O_SK, daysfrom ">
        <Column Name="NAME" DataType="System.String"/>
        <Column Name="DAYSFROM" DataType="System.Decimal"/>
        <Column Name="DAYSTO" DataType="System.Decimal"/>
        <Column Name="SUMP" DataType="System.Decimal"/>
        <Column Name="S" DataType="System.Double"/>
        <Column Name="ND" DataType="System.Decimal"/>
        <Column Name="T" DataType="System.Decimal"/>
        <CommandParameter Name="nd" DataType="113" Expression="[p_nd]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="Table1" DataType="System.Int32" Enabled="true" SelectCommand="select l.ndoc,&#13;&#10;     F_DAT_LIT(  l.dat_begin) dat_begin,&#13;&#10;       l.coun_day,&#13;&#10;       l.dataz,&#13;&#10;       l.datapo,&#13;&#10;       to_char(l.sum_pdv_day / 100,'999999.99') sd,&#13;&#10;       to_char(((l.sum_pdv_per - l.pdv_per)/ l.coun_day)/100,'999999.99') sd_b_pdv,&#13;&#10;       to_char(l.sum_pdv_per / 100,'999999.99') spd,&#13;&#10;       to_char(l.pdv_per / 100,'999999.99') pd,&#13;&#10;       to_char(round((l.sum_pdv_per - l.pdv_per) / 100, 2),'999999.99') s,&#13;&#10;       substr(f_sumpr(gl.p_icurval(980, (l.sum_pdv_per / 100), bankdate) * 100,'980','F'),1,100) sum_all,&#13;&#10;       substr(f_sumpr(gl.p_icurval(980, (l.pdv_per / 100), bankdate) * 100,'980','F'),1,100) sum_pdv,&#13;&#10;       substr(f_sumpr(gl.p_icurval(980,(round(l.sum_pdv_per - l.pdv_per) / 100),bankdate) * 100,'980','F'),1,100) suma&#13;&#10;  from (select m.ndoc,&#13;&#10;               m.dat_begin,&#13;&#10;               m.coun_day,&#13;&#10;               m.dataz,&#13;&#10;               m.datapo,&#13;&#10;               m.sum_pdv_day,&#13;&#10;               round(m.sum_pdv_day * m.coun_day) sum_pdv_per,&#13;&#10;               round((m.sum_pdv_day * m.coun_day) / 6) pdv_per&#13;&#10;          from (select n.ndoc,&#13;&#10;                       n.dat_begin,&#13;&#10;                       n.sd sum_pdv_day,&#13;&#10;                       to_date(:date_from,'DD.MM.YYYY') dataz,&#13;&#10;                       to_date(:date_to,'DD.MM.YYYY') datapo,&#13;&#10;                       to_number(to_date(:date_to,'DD/MM/YYYY') - to_date(:date_from,'DD/MM/YYYY') + 1) coun_day&#13;&#10;                  from skrynka_nd n&#13;&#10;                 where 1 = 1&#13;&#10;                   and n.sos &lt;&gt; 15&#13;&#10;                   and n.nd = :nd&#13;&#10;                   and to_date(:date_to,'DD/MM/YYYY') between n.dat_begin and n.dat_end&#13;&#10;                   and to_date(:date_from,'DD/MM/YYYY') between n.dat_begin and n.dat_end) m) l">
        <Column Name="NDOC" DataType="System.String"/>
        <Column Name="DAT_BEGIN" DataType="System.String"/>
        <Column Name="COUN_DAY" DataType="System.Decimal"/>
        <Column Name="DATAZ" DataType="System.DateTime" Format="Date"/>
        <Column Name="DATAPO" DataType="System.DateTime" Format="Date"/>
        <Column Name="SD" DataType="System.String"/>
        <Column Name="SD_B_PDV" DataType="System.String"/>
        <Column Name="SPD" DataType="System.String"/>
        <Column Name="PD" DataType="System.String"/>
        <Column Name="S" DataType="System.String"/>
        <Column Name="SUM_ALL" DataType="System.String"/>
        <Column Name="SUM_PDV" DataType="System.String"/>
        <Column Name="SUMA" DataType="System.String"/>
        <CommandParameter Name="nd" DataType="113" Expression="[p_nd]" DefaultValue="0"/>
        <CommandParameter Name="date_from" DataType="126" Size="10" Expression="[date_from]" DefaultValue="01.01.1900"/>
        <CommandParameter Name=":date_to" DataType="126" Size="10" Expression="[date_to]" DefaultValue="01.01.1900"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_nd" DataType="System.Int64" Expression="15201282611"/>
    <Parameter Name="date_from" DataType="System.String" Expression="&quot;01.05.2017&quot;"/>
    <Parameter Name="date_to" DataType="System.String" Expression="&quot;25.05.2017&quot;"/>
  </Dictionary>
  <ReportPage Name="Page1" RawPaperSize="9" LeftMargin="20" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="680.4" Height="85.05">
      <TableObject Name="Table5" Top="9.45" Width="680.4" Height="75.6">
        <TableColumn Name="Column42" Width="292.95"/>
        <TableColumn Name="Column43" Width="387.45"/>
        <TableRow Name="Row128">
          <TableCell Name="Cell316" HorzAlign="Right" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell317" Text="Додаток №4" HorzAlign="Right" Font="Times New Roman, 10pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row129">
          <TableCell Name="Cell318" HorzAlign="Right" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell319" Text="до Договору оренди індивідуального сейфа " HorzAlign="Right" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row130">
          <TableCell Name="Cell320"/>
          <TableCell Name="Cell321" BeforePrintEvent="Cell321_BeforePrint" Text="№[Table1.NDOC] від [Table1.DAT_BEGIN]" HorzAlign="Right" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row131">
          <TableCell Name="Cell322" HorzAlign="Right" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell323" Text="(Типова форма)" HorzAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="87.85" Width="680.4" Height="274.05">
      <TableObject Name="Table1" Left="9.45" Top="9.45" Width="359.1" Height="151.2" Border.Lines="All">
        <TableColumn Name="Column44" Width="359.1"/>
        <TableRow Name="Row132">
          <TableCell Name="Cell324" Text="Постачальник &lt;b&gt;АТ &quot;Ощадбанк&quot;&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row133">
          <TableCell Name="Cell329" Text="Адреса &lt;b&gt; [GetVal(&quot;SKRN_STAF_ADRESS&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row134">
          <TableCell Name="Cell334" Text="Р/рахунок " Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row135">
          <TableCell Name="Cell339" Text="в &lt;b&gt;АТ &quot;Ощадбанк&quot;&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row136">
          <TableCell Name="Cell344" Text="Код банку &lt;b&gt; [GetVal(&quot;SKRN_STAF_MFO&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row137">
          <TableCell Name="Cell349" Text="ЄДРПОУ &lt;b&gt; [GetVal(&quot;OKPO1&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row138">
          <TableCell Name="Cell354" Text="Телефон &lt;b&gt;[GetVal(&quot;SKRN_STAF_TELEFON&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row139">
          <TableCell Name="Cell359" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text1" Left="396.9" Top="18.9" Width="274.05" Height="18.9" Text="РАХУНОК-ФАКТУРА" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text2" Left="396.9" Top="56.7" Width="94.5" Height="18.9" Text="N" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text6" Left="491.4" Top="56.7" Width="94.5" Height="18.9" Border.Lines="All" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text7" Left="396.9" Top="85.05" Width="274.05" Height="18.9" Text="від  &quot;__&quot;   __________   20___p." Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text8" Left="396.9" Top="103.95" Width="151.2" Height="18.9" Text="до платіжн. вимоги N" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text9" Left="548.1" Top="103.95" Width="94.5" Height="18.9" Border.Lines="All" Font="Times New Roman, 10pt, style=Bold"/>
      <TableObject Name="Table3" Left="9.45" Top="198.45" Width="652.04" Height="28.35" Border.Lines="All">
        <TableColumn Name="Column45" Width="359.11"/>
        <TableColumn Name="Column46" Width="292.93"/>
        <TableRow Name="Row140" Height="28.35">
          <TableCell Name="Cell360" Border.Lines="Right" Text="Платник [GetVal(&quot;SKRN_FIO&quot;)]" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell361" Text="Доповнення         Зг. дог.   №        від" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
      <TableObject Name="Table5" Left="9.45" Top="245.7" Width="652.05" Height="28.35" Border.Lines="All">
        <TableColumn Name="Column47" Width="330.75"/>
        <TableColumn Name="Column48" Width="94.5"/>
        <TableColumn Name="Column49" Width="75.6"/>
        <TableColumn Name="Column50" Width="75.6"/>
        <TableColumn Name="Column51" Width="75.6"/>
        <TableRow Name="Row141" Height="28.35">
          <TableCell Name="Cell362" Border.Lines="Right" Text="Найменування" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold, Italic"/>
          <TableCell Name="Cell363" Border.Lines="All" Text="Од. вим." HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold, Italic"/>
          <TableCell Name="Cell364" Border.Lines="All" Text="К-сть" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold, Italic"/>
          <TableCell Name="Cell365" Border.Lines="All" Text="Ціна" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold, Italic"/>
          <TableCell Name="Cell366" Border.Lines="All" Text="Сума" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold, Italic"/>
        </TableRow>
      </TableObject>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="364.69" Width="680.4" Height="330.77">
      <TableObject Name="Table5" Left="9.45" Width="652.05" Height="170.1" Border.Lines="All">
        <TableColumn Name="Column52" Width="330.75"/>
        <TableColumn Name="Column53" Width="94.5"/>
        <TableColumn Name="Column54" Width="75.6"/>
        <TableColumn Name="Column55" Width="75.6"/>
        <TableColumn Name="Column56" Width="75.6"/>
        <TableRow Name="Row142" Height="37.8">
          <TableCell Name="Cell367" Border.Lines="All" Text="Послуги за надання в оренду індивідуального сейфа за період з [date_from] р. по [date_to] р." Font="Times New Roman, 10pt">
            <Formats>
              <DateFormat/>
              <DateFormat/>
            </Formats>
          </TableCell>
          <TableCell Name="Cell368" Border.Lines="All" Text="послуга" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell369" Border.Lines="All" Text="[Table1.COUN_DAY]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell370" Border.Lines="All" Text="[Table1.SD]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell371" Border.Lines="All" Text="[Table1.SPD]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row143">
          <TableCell Name="Cell372" Border.Lines="All"/>
          <TableCell Name="Cell373" Border.Lines="All"/>
          <TableCell Name="Cell374" Border.Lines="All"/>
          <TableCell Name="Cell375" Border.Lines="All"/>
          <TableCell Name="Cell376" Border.Lines="All"/>
        </TableRow>
        <TableRow Name="Row144">
          <TableCell Name="Cell377" Border.Lines="All"/>
          <TableCell Name="Cell378" Border.Lines="All"/>
          <TableCell Name="Cell379" Border.Lines="All"/>
          <TableCell Name="Cell380" Border.Lines="All"/>
          <TableCell Name="Cell381" Border.Lines="All"/>
        </TableRow>
        <TableRow Name="Row145">
          <TableCell Name="Cell382" Border.Lines="All"/>
          <TableCell Name="Cell383" Border.Lines="All"/>
          <TableCell Name="Cell384" Border.Lines="All"/>
          <TableCell Name="Cell385" Border.Lines="All"/>
          <TableCell Name="Cell386" Border.Lines="All"/>
        </TableRow>
        <TableRow Name="Row146">
          <TableCell Name="Cell387" Border.Lines="All"/>
          <TableCell Name="Cell388" Border.Lines="All"/>
          <TableCell Name="Cell389" Border.Lines="All"/>
          <TableCell Name="Cell390" Border.Lines="All"/>
          <TableCell Name="Cell391" Border.Lines="All"/>
        </TableRow>
        <TableRow Name="Row147">
          <TableCell Name="Cell392" Border.Lines="All" ColSpan="4"/>
          <TableCell Name="Cell393" Border.Lines="All"/>
          <TableCell Name="Cell394" Border.Lines="All"/>
          <TableCell Name="Cell395" Border.Lines="All"/>
          <TableCell Name="Cell396" Border.Lines="All"/>
        </TableRow>
        <TableRow Name="Row148">
          <TableCell Name="Cell397" Border.Lines="All" Text="Податок на додану вартість (ПДВ)" Font="Times New Roman, 10pt, style=Bold" ColSpan="4"/>
          <TableCell Name="Cell398" Border.Lines="All" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell399" Border.Lines="All" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell400" Border.Lines="All" Font="Arial, 10pt, style=Bold"/>
          <TableCell Name="Cell401" Border.Lines="All" Text="[Table1.PD]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row149">
          <TableCell Name="Cell402" Border.Lines="All" Text="Загальна сума з ПДВ" Font="Times New Roman, 10pt, style=Bold" ColSpan="4"/>
          <TableCell Name="Cell403" Border.Lines="All"/>
          <TableCell Name="Cell404" Border.Lines="All"/>
          <TableCell Name="Cell405"/>
          <TableCell Name="Cell406" Border.Lines="All" Text="[Table1.SPD]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text10" Left="9.45" Top="189" Width="652.05" Height="37.8" Text="Загальна сума, що підлягає оплаті [Table1.SUM_ALL]" Font="Times New Roman, 10pt, style=Bold"/>
      <TableObject Name="Table6" Left="9.45" Top="264.6" Width="650.96" Height="37.8">
        <TableColumn Name="Column57" Width="217.83"/>
        <TableColumn Name="Column58" Width="217.83"/>
        <TableColumn Name="Column59" Width="215.3"/>
        <TableRow Name="Row150" Height="37.8">
          <TableCell Name="Cell407" Text="Керуючий відділенням"/>
          <TableCell Name="Cell408" Text="[GetVal(&quot;SKRN_STAF_STAFF&quot;)]" HorzAlign="Center"/>
          <TableCell Name="Cell409" Text="___________________________"/>
        </TableRow>
      </TableObject>
    </DataBand>
  </ReportPage>
</Report>
