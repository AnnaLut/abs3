@using BarsWeb.HtmlHelpers
@inherits System.Web.Mvc.WebViewPage<IEnumerable<BarsWeb.Areas.Security.Models.AuditMessage>>
@{
  ViewBag.Title = "Журнал";
  Layout = null;
}
<script type="text/javascript">
  $(function () {
    $('#auditList').slimScroll({
      //height: 'auto',
      railVisible: true,
      size: '8px',
      height: '350px'
    });
  });
  function loadAudit(page, elem) {
      elem.load('/barsroot/security/account/audit/', { pageNum: page }, function () {
      elem.parent().loader('remove');
    });
  }
</script>
<h2 style="margin-top: 0; margin-left: 5px;">
    Журнал подій користувача
    <button title="Перечитити" class="btn-refresh button" onclick=" reloadAudit(); ">
        <img src="/barsroot/content/Themes/ModernUI/css/images/16/refresh.png" />
    </button>
</h2>

<div id="auditList" class="messages-list">
  @foreach (var item in Model)
  {
    <div class="messages">
      <table style="width: 100%;">
        <tr>
          <td>
            <div class="title">
              <div class="messages-title">@item.TypeComment</div>
              <div class="messages-date">@item.SystemDate</div>
            </div>
            <div class="messages-text">
              <b>@item.Id</b> : @item.Message
            </div>
          </td>
        </tr>
      </table>
    </div>
  }
  @{
    decimal count = ViewBag.count;
    decimal pageNum = ViewBag.pageNum;
    decimal pageSize = ViewBag.pageSize;
    decimal displaedPage = 5;

    const string funcOnClick = "var auditBlock = $('#userAudit'); auditBlock.parent().loader(); loadAudit($(this).data('pagenum'), auditBlock);return false;";
  }
  @HtmlHelpers.Pager(count: count, pageNum: pageNum, pageSize: pageSize, funcOnClick: funcOnClick)
</div>