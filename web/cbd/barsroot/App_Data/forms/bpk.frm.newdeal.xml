<?xml version="1.0" encoding="utf-8"?>
<xmlform captiontype="OnlyTitle" caption="Реєстрація нової картки">
  <customforms>
    <customform name="frmBpkDeal" title="Реєстрація нової картки" buttonsposition="Top" columnscount="3">
      <customfields>
        <!-- Клиент -->
        <customfield name="RNK" datatype="Int64" required="true" index="1" label="РНК" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="135" type="ReadOnlyReference" formname="bpk.ref.customer" formfieldname="rnk" formwidth="700" formheight="400">
            <rels>
              <rel destname="OKPO" srcname="okpo"></rel>
              <rel destname="CTYPE" srcname="ctype"></rel>
              <rel destname="NMK" srcname="nmk"></rel>
              <rel destname="ADR" srcname="adr"></rel>
              <rel destname="DOC" srcname="doc"></rel>
              <rel destname="ISSUER" srcname="issuer"></rel>
              <rel destname="BDAY" srcname="bdayplace"></rel>
              <rel destname="DM_NAME" srcname="pk_name"></rel>
            </rels>
          </uicontrol>
        </customfield>
        <customfield name="OKPO" datatype="String" index="2" label="ЗКПО" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="CTYPE" datatype="String" index="3" label="Тип клієнта" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="NMK" datatype="String" index="4" label="ПІБ (назва)" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true" linescount="2"></uicontrol>
        </customfield>
        <customfield name="ADR" datatype="String" index="5" label="Адреса" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true" linescount="2"></uicontrol>
        </customfield>
        <customfield name="DOC" datatype="String" index="6" label="Документ" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true" linescount="2"></uicontrol>
        </customfield>
        <customfield name="ISSUER" datatype="String" index="7" label="Виданий" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true" linescount="2"></uicontrol>
        </customfield>
        <customfield name="BDAY" datatype="String" index="8" label="Дата, місце народження" columnindex="1" groupname="Клієнт">
          <uicontrol controlwidth="170" readonly="true" linescount="2"></uicontrol>
        </customfield>
        <!-- Картка -->
        <customfield name="PRODUCT_ID" datatype="Int64" required="true" index="1" label="Код продукту" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="135" type="ReadOnlyReference" formname="bpk.ref.product" formfieldname="id" formwidth="700" formheight="400">
            <rels>
              <rel destname="PRODUCT_NAME" srcname="name"></rel>
              <rel destname="ACCTYPE" srcname="type_name"></rel>
              <rel destname="LCV" srcname="kv"></rel>
              <rel destname="KK" srcname="kk"></rel>
              <rel destname="OB22" srcname="ob22"></rel>
              <rel destname="CONDSET" srcname="cond_set"></rel>
              <rel destname="CVALID" srcname="c_validity"></rel>
              <rel destname="DEBINTR" srcname="deb_intr"></rel>
              <rel destname="OLIMINTR" srcname="olim_intr"></rel>
              <rel destname="CREDINTR" srcname="cred_intr"></rel>
            </rels>
          </uicontrol>
        </customfield>
        <customfield name="PRODUCT_NAME" datatype="String" index="2" label="Назва продукту" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="ACCTYPE" datatype="String" index="3" label="Карткова система" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="LCV" datatype="String" index="4" label="Валюта" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="KK" datatype="String" index="5" label="Категорія клієнта" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="OB22" datatype="String" index="6" label="ОБ22" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="CONDSET" datatype="String" index="7" label="Код умови" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="CVALID" datatype="String" index="8" label="Тривалість (в місяцях)" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="DEBINTR" datatype="String" index="9" label="Вартість корист.кред." columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="OLIMINTR" datatype="String" index="10" label="Стягнення за овердр." columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="CREDINTR" datatype="String" index="11" label="Відсоток на залишок" columnindex="2" groupname="Картка">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <!-- Demand -->
        <customfield name="DM_NAME" datatype="String" required="true" index="1" label="Ім'я та прізв. на картці" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_MNAME" datatype="String" required="true" index="2" label="Дівоче прізв.матері" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WORK" datatype="String" required="true" index="3" label="Місце роботи" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_OFFICE" datatype="String" required="true" index="4" label="Посада" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WPHONE" datatype="String" index="5" label="Телефон" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WCNTRY" datatype="String" index="6" label="Держава" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WPCODE" datatype="String" index="7" label="Почтовий індекс" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WCITY" datatype="String" index="8" label="Місто" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_WSTREET" datatype="String" index="9" label="Вулиця" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170"></uicontrol>
        </customfield>
        <customfield name="DM_FCODE" datatype="String" required="true" index="10" label="Код філії" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="135" type="ReadOnlyReference" formname="bpk.ref.fcodes" formfieldname="code" formwidth="500" formheight="400">
            <rels>
              <rel destname="BRANCH" srcname="branch"></rel>
              <rel destname="BRANCH_NAME" srcname="branch_name"></rel>
            </rels>
          </uicontrol>
        </customfield>
        <customfield name="BRANCH" datatype="String" required="true" index="11" label="Відділення" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
        <customfield name="BRANCH_NAME" datatype="String" index="12" label="Відділення" columnindex="3" groupname="Demand">
          <uicontrol controlwidth="170" readonly="true"></uicontrol>
        </customfield>
      </customfields>
      <buttons defaulttype="Button">
        <button id="btnOpenCard" caption="Зареєструвати картку" hint="Реєстрація картки">
          <command type="PlSqlBlock" successmessage="Картку зареєстровано">
            <sql>
              declare
              l_nd number;
              begin
              bars_bpk.open_card(:RNK, :PRODUCT_ID, :DM_FCODE, 0, 0, :BRANCH,
              :DM_NAME, :DM_MNAME, :DM_WORK, :DM_OFFICE, :DM_WPHONE, :DM_WCNTRY,
              :DM_WPCODE, :DM_WCITY, :DM_WSTREET, l_nd);
              end;
            </sql>
            <parameters>
              <parameter type="FormField" name="RNK"></parameter>
              <parameter type="FormField" name="PRODUCT_ID"></parameter>
              <parameter type="FormField" name="DM_FCODE"></parameter>
              <parameter type="FormField" name="BRANCH"></parameter>
              <parameter type="FormField" name="DM_NAME"></parameter>
              <parameter type="FormField" name="DM_MNAME"></parameter>
              <parameter type="FormField" name="DM_WORK"></parameter>
              <parameter type="FormField" name="DM_OFFICE"></parameter>
              <parameter type="FormField" name="DM_WPHONE"></parameter>
              <parameter type="FormField" name="DM_WCNTRY"></parameter>
              <parameter type="FormField" name="DM_WPCODE"></parameter>
              <parameter type="FormField" name="DM_WCITY"></parameter>
              <parameter type="FormField" name="DM_WSTREET"></parameter>
            </parameters>
          </command>
        </button>
        <button id="btnBackToPortfolio" caption="Повернутися до портфелю" hint="Повернутися до портфелю">
          <command type="Redirect" url="/barsroot/barsweb/dynform.aspx?form=bpk.frm.portfolio"></command>
        </button>
      </buttons>
    </customform>
  </customforms>
</xmlform>