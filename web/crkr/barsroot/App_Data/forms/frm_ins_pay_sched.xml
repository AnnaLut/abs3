<?xml version="1.0" encoding="utf-8" ?>
<xmlform captiontype="OnlyTitle">
  <grids>
    <grid id="gv" pagesize="10" showpagesizebox="true" title="Графік платежів за договором" showfilter="true">
      <datasource>
        <sql>select t.*, deal_id as ID from INS_PAYMENTS_SCHEDULE t</sql>
        <parameters>
          <parameter name="DEAL_ID" type="QueryString"></parameter>
        </parameters>
      </datasource>
      <buttons defaulttype="Button">
        <!--#include(frm_ins_btnpay_inc.xml)-->
      </buttons>
      <rowselection method="SingleRow" />
      <editform style="Dialog" title="" height="300" width="450" columnscount="1">
        <buttons defaulttype="button">
          <button id="btnEdit" caption="Редагувати|Зберегти|Вiдмiнити" hint="Редагувати рядок|Зберегти рядок|Вiдмiнити редагування" confirmmessage="">
            <command type="Edit">
              <sql>update INS_PAYMENTS_SCHEDULE set PLAN_SUM=:PLAN_SUM where DEAL_ID =:ID and PLAN_DATE = :PLAN_DATE</sql>
              <parameters>
                <parameter type="DataField" name="ID" />
                <parameter type="DataField" name="PLAN_DATE" />
                <parameter type="DataField" name="PLAN_SUM" />
              </parameters>
            </command>
          </button>
          <button id="btnInsert" caption="Додати|Зберегти|Вiдмiнити" hint="Додати рядок|Зберегти рядок|Вiдмiнити додавання" confirmmessage="">
            <command type="Insert">
              <sql>insert into INS_PAYMENTS_SCHEDULE(DEAL_ID, PLAN_DATE, PLAN_SUM) values (:ID, :PLAN_DATE, :PLAN_SUM)</sql>
              <parameters>
                <parameter type="DataField" name="ID" />
                <parameter type="DataField" name="PLAN_DATE" />
                <parameter type="DataField" name="PLAN_SUM" />
              </parameters>
            </command>
          </button>
          <button id="btnDel" caption="Видалити|Зберегти|Вiдмiнити" hint="Видалити рядок|Зберегти рядок|Вiдмiнити видалення" confirmmessage="Необхідно підтвердити видалення рядка">
            <command type="Delete">
              <sql>delete from INS_PAYMENTS_SCHEDULE where DEAL_ID=:ID and PLAN_DATE=:PLAN_DATE</sql>
              <parameters>
                <parameter type="DataField" name="ID" />
                <parameter type="DataField" name="PLAN_DATE" />
              </parameters>
            </command>
          </button>
          <button caption="Закрити" id="btnClose">
            <command type="Close" />
          </button>
        </buttons>
      </editform>
      <fields>
        <field name="ID" key="true" datatype="Int64" sort="default">
          <column show="false" caption="Ідентифікатор договору страхування" align="right" />
          <form show="true" rwmode="RO" required="true">
            <uicontrol type="Text">
              <defaultvalue type="QueryString" value="deal_id"/>
            </uicontrol>
          </form>
        </field>
        <field name="PLAN_DATE" key="true" datatype="DateTime" sort="default">
          <column show="true" caption="Планова дата платежу" align="center" />
          <form show="true" rwmode="ROI" required="true">
            <uicontrol type="Text" />
          </form>
        </field>
        <field name="PLAN_SUM" key="false" datatype="Decimal" sort="default">
          <column show="true" caption="Планова сума платежу" align="right" />
          <form show="true" rwmode="RW" required="true">
            <uicontrol type="Text" />
          </form>
        </field>        
        <field name="FACT_DATE" key="false" datatype="DateTime" sort="default">
          <column show="true" caption="Фактична дата платежу" align="center" />
          <form show="false" rwmode="RW">
            <uicontrol type="Text" />
          </form>
        </field>
        <field name="FACT_SUM" key="false" datatype="Decimal" sort="default">
          <column show="true" caption="Фактична сума платежу" align="right" />
          <form show="false" rwmode="RW">
            <uicontrol type="Text" />
          </form>
        </field>
        <field name="ALERTDAYS" key="false" datatype="Int64" sort="default">
          <column show="false" caption="Кількість днів за скільки треба розіслати нагадування про необхідність платежу" align="right" />
          <form show="false" rwmode="RW">
            <uicontrol type="Text" />
          </form>
        </field>
      </fields>
    </grid>
  </grids>
</xmlform>